import{j as e}from"./ui-6244b3df.js";import{r as h}from"./vendor-499a370b.js";import{d as A,t as S,z as g,u as E,b as U,U as u,o as C,D}from"./index-6112b649.js";import{U as O}from"./UserAvatar-b4225c28.js";import{A as p}from"./AppHeader-78d14113.js";import{b as _}from"./format-ae98e2f4.js";import{A as z}from"./activity-3ea54dab.js";import{P as R}from"./pen-line-d6794a46.js";import"./utils-17ec81d9.js";import"./utils-a40dfe8b.js";function q(d){const n=A(),a=async()=>{try{await S.auth.signOut(),g.success("Signed out"),n("/")}catch(i){console.error(i),g.error("Failed to sign out. Please try again.")}};return e.jsx("button",{type:"button",onClick:a,"data-qa":"signout",className:"w-full rounded-xl border border-black/10 bg-white px-4 py-3 text-sm font-medium hover:bg-white/80 active:scale-[0.99]",...d,children:"Sign Out"})}const Y=({onNavigateBack:d,userId:n})=>{const{user:a,isAuthenticated:i}=E(),{getUserPredictionEntries:b,getUserCreatedPredictions:j}=U(),[f,N]=h.useState(!i),o=!n||n===a?.id,t=a;h.useEffect(()=>{i&&a?.id&&N(!1)},[i,a?.id]);const l=b(a?.id||"")||[],v=j(a?.id||"")||[],c=l.filter(s=>s?.status==="won"||s?.status==="lost"),x=l.filter(s=>s?.status==="won"),y=l.reduce((s,r)=>s+(r?.amount||0),0),w=x.reduce((s,r)=>s+(r?.actual_payout||0),0),P=c.length>0?Math.round(x.length/c.length*100):0,k=w-y,m=[...l,...v].sort((s,r)=>new Date(r.created_at||0).getTime()-new Date(s.created_at||0).getTime()).slice(0,5);return i?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(p,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsx("div",{className:"space-y-4",children:f?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(z,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Predictions"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:l.length})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Win Rate"})]}),e.jsxs("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:[P,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(D,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Balance"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:_(k)})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Overview"}),o&&e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(O,{email:t?.email,username:t?.firstName||t?.email?.split("@")[0],avatarUrl:t?.avatar,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t?.firstName&&t?.lastName?`${t.firstName} ${t.lastName}`:t?.email?.split("@")[0]||"User"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["@",t?.email?.split("@")[0]||"user"]}),e.jsxs("div",{className:"flex space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[c.length," completed"]}),e.jsxs("span",{children:[l.filter(s=>s.status==="active").length," active"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Recent Activity"}),m.length>0?e.jsx("div",{className:"space-y-3",children:m.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"question"in s?s.question:"Prediction Entry"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at||0).toLocaleDateString()})]}),e.jsx("div",{className:"text-right",children:"status"in s&&e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.status==="won"?"bg-green-100 text-green-800":s.status==="lost"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})})]},r))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No recent activity"}),e.jsx("p",{className:"text-sm",children:"Your prediction activity will appear here."})]})]}),o&&e.jsx("div",{className:"mt-4",children:e.jsx(q,{})})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(p,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-12 px-4",children:[e.jsx("div",{className:"mb-4 text-gray-300",children:e.jsx(u,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view your profile"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6 max-w-sm",children:"Customize your handle, avatar, and preferences."}),e.jsx("button",{onClick:async()=>{try{await C({intent:"edit_profile"})}catch(s){console.error("Auth gate error:",s)}},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"})]})})]})};export{Y as default};
