var ro=Object.defineProperty;var io=(r,e,s)=>e in r?ro(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var ee=(r,e,s)=>(io(r,typeof e!="symbol"?e+"":e,s),s);import{j as t,A as xe,m as T,c as no,P as xr,u as oo,a as Vs,S as ao}from"./ui-25d22b63.js";import{a as Ci,r as p,b as lo,c as co,d as be,R as re}from"./vendor-3a7118c2.js";import{s as Pi,c as Ve,f as uo}from"./utils-6e8550a1.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();var Gs={},Mr=Ci;Gs.createRoot=Mr.createRoot,Gs.hydrateRoot=Mr.hydrateRoot;function ho(r,e){if(r instanceof RegExp)return{keys:!1,pattern:r};var s,i,n,o,a=[],l="",d=r.split("/");for(d[0]||d.shift();n=d.shift();)s=n[0],s==="*"?(a.push(s),l+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):s===":"?(i=n.indexOf("?",1),o=n.indexOf(".",1),a.push(n.substring(1,~i?i:~o?o:n.length)),l+=~i&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(l+=(~i?"?":"")+"\\"+n.substring(o))):l+="/"+n;return{keys:a,pattern:new RegExp("^"+l+(e?"(?=$|/)":"/?$"),"i")}}const po=lo["useInsertionEffect"],fo=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mo=fo?p.useLayoutEffect:p.useEffect,go=po||mo,Ei=r=>{const e=p.useRef([r,(...s)=>e[0](...s)]).current;return go(()=>{e[0]=r}),e[1]},xo="popstate",br="pushState",yr="replaceState",bo="hashchange",Fr=[xo,br,yr,bo],yo=r=>{for(const e of Fr)addEventListener(e,r);return()=>{for(const e of Fr)removeEventListener(e,r)}},Ti=(r,e)=>Pi.useSyncExternalStore(yo,r,e),vo=()=>location.search,wo=({ssrSearch:r=""}={})=>Ti(vo,()=>r),Br=()=>location.pathname,jo=({ssrPath:r}={})=>Ti(Br,r?()=>r:Br),ko=(r,{replace:e=!1,state:s=null}={})=>history[e?yr:br](s,"",r),No=(r={})=>[jo(r),ko],Wr=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Wr]>"u"){for(const r of[br,yr]){const e=history[r];history[r]=function(){const s=e.apply(this,arguments),i=new Event(r);return i.arguments=arguments,dispatchEvent(i),s}}Object.defineProperty(window,Wr,{value:!0})}const _o=(r,e)=>e.toLowerCase().indexOf(r.toLowerCase())?"~"+e:e.slice(r.length)||"/",Ai=(r="")=>r==="/"?"":r,So=(r,e)=>r[0]==="~"?r.slice(1):Ai(e)+r,Co=(r="",e)=>_o(Hr(Ai(r)),Hr(e)),Hr=r=>{try{return decodeURI(r)}catch{return r}},Ii={hook:No,searchHook:wo,parser:ho,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:r=>r},$i=p.createContext(Ii),Vt=()=>p.useContext($i),Ri={},Oi=p.createContext(Ri),Po=()=>p.useContext(Oi),fs=r=>{const[e,s]=r.hook(r);return[Co(r.base,e),Ei((i,n)=>s(So(i,r.base),n))]},de=()=>fs(Vt()),Li=(r,e,s,i)=>{const{pattern:n,keys:o}=e instanceof RegExp?{keys:!1,pattern:e}:r(e||"*",i),a=n.exec(s)||[],[l,...d]=a;return l!==void 0?[!0,(()=>{const c=o!==!1?Object.fromEntries(o.map((h,f)=>[h,d[f]])):a.groups;let u={...d};return c&&Object.assign(u,c),u})(),...i?[l]:[]]:[!1,null]},zi=({children:r,...e})=>{const s=Vt(),i=e.hook?Ii:s;let n=i;const[o,a]=e.ssrPath?.split("?")??[];a&&(e.ssrSearch=a,e.ssrPath=o),e.hrefs=e.hrefs??e.hook?.hrefs;let l=p.useRef({}),d=l.current,c=d;for(let u in i){const h=u==="base"?i[u]+(e[u]||""):e[u]||i[u];d===c&&h!==c[u]&&(l.current=c={...c}),c[u]=h,(h!==i[u]||h!==n[u])&&(n=c)}return p.createElement($i.Provider,{value:n,children:r})},qr=({children:r,component:e},s)=>e?p.createElement(e,{params:s}):typeof r=="function"?r(s):r,Eo=r=>{let e=p.useRef(Ri);const s=e.current;return e.current=Object.keys(r).length!==Object.keys(s).length||Object.entries(r).some(([i,n])=>n!==s[i])?r:s},ve=({path:r,nest:e,match:s,...i})=>{const n=Vt(),[o]=fs(n),[a,l,d]=s??Li(n.parser,r,o,e),c=Eo({...Po(),...l});if(!a)return null;const u=d?p.createElement(zi,{base:d},qr(i,c)):qr(i,c);return p.createElement(Oi.Provider,{value:c,children:u})};p.forwardRef((r,e)=>{const s=Vt(),[i,n]=fs(s),{to:o="",href:a=o,onClick:l,asChild:d,children:c,className:u,replace:h,state:f,...m}=r,x=Ei(b=>{b.ctrlKey||b.metaKey||b.altKey||b.shiftKey||b.button!==0||(l?.(b),b.defaultPrevented||(b.preventDefault(),n(a,r)))}),g=s.hrefs(a[0]==="~"?a.slice(1):s.base+a,s);return d&&p.isValidElement(c)?p.cloneElement(c,{onClick:x,href:g}):p.createElement("a",{...m,onClick:x,href:g,className:u?.call?u(i===a):u,children:c,ref:e})});const Di=r=>Array.isArray(r)?r.flatMap(e=>Di(e&&e.type===p.Fragment?e.props.children:e)):[r],Vr=({children:r,location:e})=>{const s=Vt(),[i]=fs(s);for(const n of Di(r)){let o=0;if(p.isValidElement(n)&&(o=Li(s.parser,n.props.path,e||i,n.props.nest))[0])return p.cloneElement(n,{match:o})}return null},To="modulepreload",Ao=function(r){return"/"+r},Gr={},Nt=function(e,s,i){if(!s||s.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(s.map(o=>{if(o=Ao(o),o in Gr)return;Gr[o]=!0;const a=o.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!i)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===o&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":To,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o})},Io=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...s)=>Nt(()=>Promise.resolve().then(()=>_t),void 0).then(({default:i})=>i(...s)):e=fetch,(...s)=>e(...s)};class vr extends Error{constructor(e,s="FunctionsError",i){super(e),this.name=s,this.context=i}}class $o extends vr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Jr extends vr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Kr extends vr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Js;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Js||(Js={}));var Ro=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};class Oo{constructor(e,{headers:s={},customFetch:i,region:n=Js.Any}={}){this.url=e,this.headers=s,this.region=n,this.fetch=Io(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,s={}){var i;return Ro(this,void 0,void 0,function*(){try{const{headers:n,method:o,body:a}=s;let l={},{region:d}=s;d||(d=this.region);const c=new URL(`${this.url}/${e}`);d&&d!=="any"&&(l["x-region"]=d,c.searchParams.set("forceFunctionRegion",d));let u;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(l["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(l["Content-Type"]="application/json",u=JSON.stringify(a)));const h=yield this.fetch(c.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:u}).catch(g=>{throw new $o(g)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new Jr(h);if(!h.ok)throw new Kr(h);let m=((i=h.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield h.json():m==="application/octet-stream"?x=yield h.blob():m==="text/event-stream"?x=h:m==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof Kr||n instanceof Jr?n.context:void 0}}})}}var fe={},wr={},ms={},Gt={},gs={},xs={},Lo=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},wt=Lo();const zo=wt.fetch,Ui=wt.fetch.bind(wt),Mi=wt.Headers,Do=wt.Request,Uo=wt.Response,_t=Object.freeze(Object.defineProperty({__proto__:null,Headers:Mi,Request:Do,Response:Uo,default:Ui,fetch:zo},Symbol.toStringTag,{value:"Module"})),Mo=co(_t);var bs={};Object.defineProperty(bs,"__esModule",{value:!0});let Fo=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};bs.default=Fo;var Fi=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xs,"__esModule",{value:!0});const Bo=Fi(Mo),Wo=Fi(bs);let Ho=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Bo.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,s){return this.headers=Object.assign({},this.headers),this.headers[e]=s,this}then(e,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let n=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var a,l,d;let c=null,u=null,h=null,f=o.status,m=o.statusText;if(o.ok){if(this.method!=="HEAD"){const w=await o.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=w:u=JSON.parse(w))}const g=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(l=o.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&b&&b.length>1&&(h=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,f=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const g=await o.text();try{c=JSON.parse(g),Array.isArray(c)&&o.status===404&&(u=[],c=null,f=200,m="OK")}catch{o.status===404&&g===""?(f=204,m="No Content"):c={message:g}}if(c&&this.isMaybeSingle&&(!((d=c?.details)===null||d===void 0)&&d.includes("0 rows"))&&(c=null,f=200,m="OK"),c&&this.shouldThrowOnError)throw new Wo.default(c)}return{error:c,data:u,count:h,status:f,statusText:m}});return this.shouldThrowOnError||(n=n.catch(o=>{var a,l,d;return{error:{message:`${(a=o?.name)!==null&&a!==void 0?a:"FetchError"}: ${o?.message}`,details:`${(l=o?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(d=o?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,s)}returns(){return this}overrideTypes(){return this}};xs.default=Ho;var qo=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(gs,"__esModule",{value:!0});const Vo=qo(xs);let Go=class extends Vo.default{select(e){let s=!1;const i=(e??"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:s=!0,nullsFirst:i,foreignTable:n,referencedTable:o=n}={}){const a=o?`${o}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${e}.${s?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:s,referencedTable:i=s}={}){const n=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,s,{foreignTable:i,referencedTable:n=i}={}){const o=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(a,`${s-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:s=!1,settings:i=!1,buffers:n=!1,wal:o=!1,format:a="text"}={}){var l;const d=[e?"analyze":null,s?"verbose":null,i?"settings":null,n?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${d};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};gs.default=Go;var Jo=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Gt,"__esModule",{value:!0});const Ko=Jo(gs);let Yo=class extends Ko.default{eq(e,s){return this.url.searchParams.append(e,`eq.${s}`),this}neq(e,s){return this.url.searchParams.append(e,`neq.${s}`),this}gt(e,s){return this.url.searchParams.append(e,`gt.${s}`),this}gte(e,s){return this.url.searchParams.append(e,`gte.${s}`),this}lt(e,s){return this.url.searchParams.append(e,`lt.${s}`),this}lte(e,s){return this.url.searchParams.append(e,`lte.${s}`),this}like(e,s){return this.url.searchParams.append(e,`like.${s}`),this}likeAllOf(e,s){return this.url.searchParams.append(e,`like(all).{${s.join(",")}}`),this}likeAnyOf(e,s){return this.url.searchParams.append(e,`like(any).{${s.join(",")}}`),this}ilike(e,s){return this.url.searchParams.append(e,`ilike.${s}`),this}ilikeAllOf(e,s){return this.url.searchParams.append(e,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(e,s){return this.url.searchParams.append(e,`ilike(any).{${s.join(",")}}`),this}is(e,s){return this.url.searchParams.append(e,`is.${s}`),this}in(e,s){const i=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${i})`),this}contains(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cs.{${s.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(s)}`),this}containedBy(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cd.{${s.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(s)}`),this}rangeGt(e,s){return this.url.searchParams.append(e,`sr.${s}`),this}rangeGte(e,s){return this.url.searchParams.append(e,`nxl.${s}`),this}rangeLt(e,s){return this.url.searchParams.append(e,`sl.${s}`),this}rangeLte(e,s){return this.url.searchParams.append(e,`nxr.${s}`),this}rangeAdjacent(e,s){return this.url.searchParams.append(e,`adj.${s}`),this}overlaps(e,s){return typeof s=="string"?this.url.searchParams.append(e,`ov.${s}`):this.url.searchParams.append(e,`ov.{${s.join(",")}}`),this}textSearch(e,s,{config:i,type:n}={}){let o="";n==="plain"?o="pl":n==="phrase"?o="ph":n==="websearch"&&(o="w");const a=i===void 0?"":`(${i})`;return this.url.searchParams.append(e,`${o}fts${a}.${s}`),this}match(e){return Object.entries(e).forEach(([s,i])=>{this.url.searchParams.append(s,`eq.${i}`)}),this}not(e,s,i){return this.url.searchParams.append(e,`not.${s}.${i}`),this}or(e,{foreignTable:s,referencedTable:i=s}={}){const n=i?`${i}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,s,i){return this.url.searchParams.append(e,`${s}.${i}`),this}};Gt.default=Yo;var Zo=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ms,"__esModule",{value:!0});const It=Zo(Gt);let Qo=class{constructor(e,{headers:s={},schema:i,fetch:n}){this.url=e,this.headers=s,this.schema=i,this.fetch=n}select(e,{head:s=!1,count:i}={}){const n=s?"HEAD":"GET";let o=!1;const a=(e??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",a),i&&(this.headers.Prefer=`count=${i}`),new It.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:s,defaultToNull:i=!0}={}){const n="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((l,d)=>l.concat(Object.keys(d)),[]);if(a.length>0){const l=[...new Set(a)].map(d=>`"${d}"`);this.url.searchParams.set("columns",l.join(","))}}return new It.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:s,ignoreDuplicates:i=!1,count:n,defaultToNull:o=!0}={}){const a="POST",l=[`resolution=${i?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const d=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(d.length>0){const c=[...new Set(d)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new It.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:s}={}){const i="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),s&&n.push(`count=${s}`),this.headers.Prefer=n.join(","),new It.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const s="DELETE",i=[];return e&&i.push(`count=${e}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new It.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ms.default=Qo;var ys={},vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.version=void 0;vs.version="0.0.0-automated";Object.defineProperty(ys,"__esModule",{value:!0});ys.DEFAULT_HEADERS=void 0;const Xo=vs;ys.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Xo.version}`};var Bi=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(wr,"__esModule",{value:!0});const ea=Bi(ms),ta=Bi(Gt),sa=ys;let ra=class Wi{constructor(e,{headers:s={},schema:i,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},sa.DEFAULT_HEADERS),s),this.schemaName=i,this.fetch=n}from(e){const s=new URL(`${this.url}/${e}`);return new ea.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Wi(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,s={},{head:i=!1,get:n=!1,count:o}={}){let a;const l=new URL(`${this.url}/rpc/${e}`);let d;i||n?(a=i?"HEAD":"GET",Object.entries(s).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(a="POST",d=s);const c=Object.assign({},this.headers);return o&&(c.Prefer=`count=${o}`),new ta.default({method:a,url:l,headers:c,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};wr.default=ra;var St=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fe,"__esModule",{value:!0});fe.PostgrestError=fe.PostgrestBuilder=fe.PostgrestTransformBuilder=fe.PostgrestFilterBuilder=fe.PostgrestQueryBuilder=fe.PostgrestClient=void 0;const Hi=St(wr);fe.PostgrestClient=Hi.default;const qi=St(ms);fe.PostgrestQueryBuilder=qi.default;const Vi=St(Gt);fe.PostgrestFilterBuilder=Vi.default;const Gi=St(gs);fe.PostgrestTransformBuilder=Gi.default;const Ji=St(xs);fe.PostgrestBuilder=Ji.default;const Ki=St(bs);fe.PostgrestError=Ki.default;var ia=fe.default={PostgrestClient:Hi.default,PostgrestQueryBuilder:qi.default,PostgrestFilterBuilder:Vi.default,PostgrestTransformBuilder:Gi.default,PostgrestBuilder:Ji.default,PostgrestError:Ki.default};const{PostgrestClient:na,PostgrestQueryBuilder:Rh,PostgrestFilterBuilder:Oh,PostgrestTransformBuilder:Lh,PostgrestBuilder:zh,PostgrestError:Dh}=ia;class oa{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const s=parseInt(process.versions.node.split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let s=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(s+=`

Suggested solution: ${e.workaround}`),new Error(s)}static createWebSocket(e,s){const i=this.getWebSocketConstructor();return new i(e,s)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const aa="2.15.1",la=`realtime-js/${aa}`,ca="1.0.0",Ks=1e4,da=1e3,ua=100;var Lt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Lt||(Lt={}));var le;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(le||(le={}));var je;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(je||(je={}));var Ys;(function(r){r.websocket="websocket"})(Ys||(Ys={}));var st;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(st||(st={}));class ha{constructor(){this.HEADER_LENGTH=1}decode(e,s){return e.constructor===ArrayBuffer?s(this._binaryDecode(e)):s(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const s=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,s,i)}_decodeBroadcast(e,s,i){const n=s.getUint8(1),o=s.getUint8(2);let a=this.HEADER_LENGTH+2;const l=i.decode(e.slice(a,a+n));a=a+n;const d=i.decode(e.slice(a,a+o));a=a+o;const c=JSON.parse(i.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:d,payload:c}}}class Yi{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Q;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Q||(Q={}));const Yr=(r,e,s={})=>{var i;const n=(i=s.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((o,a)=>(o[a]=pa(a,r,e,n),o),{})},pa=(r,e,s,i)=>{const n=e.find(l=>l.name===r),o=n?.type,a=s[r];return o&&!i.includes(o)?Zi(o,a):Zs(a)},Zi=(r,e)=>{if(r.charAt(0)==="_"){const s=r.slice(1,r.length);return xa(e,s)}switch(r){case Q.bool:return fa(e);case Q.float4:case Q.float8:case Q.int2:case Q.int4:case Q.int8:case Q.numeric:case Q.oid:return ma(e);case Q.json:case Q.jsonb:return ga(e);case Q.timestamp:return ba(e);case Q.abstime:case Q.date:case Q.daterange:case Q.int4range:case Q.int8range:case Q.money:case Q.reltime:case Q.text:case Q.time:case Q.timestamptz:case Q.timetz:case Q.tsrange:case Q.tstzrange:return Zs(e);default:return Zs(e)}},Zs=r=>r,fa=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},ma=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},ga=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},xa=(r,e)=>{if(typeof r!="string")return r;const s=r.length-1,i=r[s];if(r[0]==="{"&&i==="}"){let o;const a=r.slice(1,s);try{o=JSON.parse("["+a+"]")}catch{o=a?a.split(","):[]}return o.map(l=>Zi(e,l))}return r},ba=r=>typeof r=="string"?r.replace(" ","T"):r,Qi=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class As{constructor(e,s,i={},n=Ks){this.channel=e,this.event=s,this.payload=i,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var i;return this._hasReceived(e)&&s((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zr;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Zr||(Zr={}));class zt{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},n=>{const{onJoin:o,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zt.syncState(this.state,n,o,a),this.pendingDiffs.forEach(d=>{this.state=zt.syncDiff(this.state,d,o,a)}),this.pendingDiffs=[],l()}),this.channel._on(i.diff,{},n=>{const{onJoin:o,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=zt.syncDiff(this.state,n,o,a),l())}),this.onJoin((n,o,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:a})}),this.onLeave((n,o,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,i,n){const o=this.cloneDeep(e),a=this.transformState(s),l={},d={};return this.map(o,(c,u)=>{a[c]||(d[c]=u)}),this.map(a,(c,u)=>{const h=o[c];if(h){const f=u.map(b=>b.presence_ref),m=h.map(b=>b.presence_ref),x=u.filter(b=>m.indexOf(b.presence_ref)<0),g=h.filter(b=>f.indexOf(b.presence_ref)<0);x.length>0&&(l[c]=x),g.length>0&&(d[c]=g)}else l[c]=u}),this.syncDiff(o,{joins:l,leaves:d},i,n)}static syncDiff(e,s,i,n){const{joins:o,leaves:a}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return i||(i=()=>{}),n||(n=()=>{}),this.map(o,(l,d)=>{var c;const u=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(d),u.length>0){const h=e[l].map(m=>m.presence_ref),f=u.filter(m=>h.indexOf(m.presence_ref)<0);e[l].unshift(...f)}i(l,u,d)}),this.map(a,(l,d)=>{let c=e[l];if(!c)return;const u=d.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=c,n(l,c,d),c.length===0&&delete e[l]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(i=>s(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,i)=>{const n=e[i];return"metas"in n?s[i]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):s[i]=n,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qr;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Qr||(Qr={}));var Dt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Dt||(Dt={}));var Oe;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Oe||(Oe={}));class jr{constructor(e,s={config:{}},i){this.topic=e,this.params=s,this.socket=i,this.bindings={},this.state=le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new As(this,je.join,this.params,this.timeout),this.rejoinTimer=new Yi(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=le.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(je.reply,{},(n,o)=>{this._trigger(this._replyEventName(o),n)}),this.presence=new zt(this),this.broadcastEndpointURL=Qi(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,s=this.timeout){var i,n;if(this.socket.isConnected()||this.socket.connect(),this.state==le.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,d=(n=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(f=>f.filter))!==null&&n!==void 0?n:[],c=!!this.bindings[Dt.PRESENCE]&&this.bindings[Dt.PRESENCE].length>0,u={},h={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:c}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(f=>e?.(Oe.CHANNEL_ERROR,f)),this._onClose(()=>e?.(Oe.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){e?.(Oe.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,g=(m=x?.length)!==null&&m!==void 0?m:0,b=[];for(let w=0;w<g;w++){const y=x[w],{filter:{event:j,schema:S,table:O,filter:C}}=y,$=f&&f[w];if($&&$.event===j&&$.schema===S&&$.table===O&&$.filter===C)b.push(Object.assign(Object.assign({},y),{id:$.id}));else{this.unsubscribe(),this.state=le.errored,e?.(Oe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(Oe.SUBSCRIBED);return}}).receive("error",f=>{this.state=le.errored,e?.(Oe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e?.(Oe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,i){return this.state===le.joined&&e===Dt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,s,i)}async send(e,s={}){var i,n;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:a}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(i=s.timeout)!==null&&i!==void 0?i:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,d;const c=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=le.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(je.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(n=>{i=new As(this,je.leave,{},e),i.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=le.closed,this.bindings={}}async _fetchWithTimeout(e,s,i){const n=new AbortController,o=setTimeout(()=>n.abort(),i),a=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(o),a}_push(e,s,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new As(this,e,s,i);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ua){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(e,s,i){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,i){var n,o;const a=e.toLocaleLowerCase(),{close:l,error:d,leave:c,join:u}=je;if(i&&[l,d,c,u].indexOf(a)>=0&&i!==this._joinRef())return;let f=this._onMessage(a,s,i);if(s&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var x,g,b;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((b=(g=m.filter)===null||g===void 0?void 0:g.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===a}).map(m=>m.callback(f,i)):(o=this.bindings[a])===null||o===void 0||o.filter(m=>{var x,g,b,w,y,j;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const S=m.id,O=(x=m.filter)===null||x===void 0?void 0:x.event;return S&&((g=s.ids)===null||g===void 0?void 0:g.includes(S))&&(O==="*"||O?.toLocaleLowerCase()===((b=s.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const S=(y=(w=m?.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return S==="*"||S===((j=s?.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:g,table:b,commit_timestamp:w,type:y,errors:j}=x;f=Object.assign(Object.assign({},{schema:g,table:b,commit_timestamp:w,eventType:y,new:{},old:{},errors:j}),this._getPayloadRecords(x))}m.callback(f,i)})}_isClosed(){return this.state===le.closed}_isJoined(){return this.state===le.joined}_isJoining(){return this.state===le.joining}_isLeaving(){return this.state===le.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,i){const n=e.toLocaleLowerCase(),o={type:n,filter:s,callback:i};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(e,s){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&jr.isEqual(n.filter,s))})),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const i in e)if(e[i]!==s[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(je.close,{},e)}_onError(e){this._on(je.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=le.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Yr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Yr(e.columns,e.old_record)),s}}const Xr=()=>{},Qt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ya=[1e3,2e3,5e3,1e4],va=1e4,wa=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ja{constructor(e,s){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ks,this.transport=null,this.heartbeatIntervalMs=Qt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Xr,this.ref=0,this.reconnectTimer=null,this.logger=Xr,this.conn=null,this.sendBuffer=[],this.serializer=new ha,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...a)=>Nt(()=>Promise.resolve().then(()=>_t),void 0).then(({default:l})=>l(...a)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...a)=>o(...a)},!(!((i=s?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${e}/${Ys.websocket}`,this.httpEndpoint=Qi(e),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=oa.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const s=e.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ca}))}disconnect(e,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,s??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,i){this.logger(e,s,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Lt.connecting:return st.Connecting;case Lt.open:return st.Open;case Lt.closing:return st.Closing;default:return st.Closed}}isConnected(){return this.connectionState()===st.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,s={config:{}}){const i=`realtime:${e}`,n=this.getChannels().find(o=>o.topic===i);if(n)return n;{const o=new jr(`realtime:${e}`,s,this);return this.channels.push(o),o}}push(e){const{topic:s,event:i,payload:n,ref:o}=e,a=()=>{this.encode(e,l=>{var d;(d=this.conn)===null||d===void 0||d.send(l)})};this.log("push",`${s} ${i} (${o})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(da,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Qt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,s=>{s.topic==="phoenix"&&s.event==="phx_reply"&&this.heartbeatCallback(s.payload.status==="ok"?"ok":"error"),s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:n,payload:o,ref:a}=s,l=a?`(${a})`:"",d=o.status||"";this.log("receive",`${d} ${i} ${n} ${l}`.trim(),o),this.channels.filter(c=>c._isMember(i)).forEach(c=>c._trigger(n,o,a)),this._triggerStateCallbacks("message",s)})}_clearTimer(e){var s;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var s;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(je.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const i=e.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${e}${i}${n}`}_workerObjectUrl(e){let s;if(e)s=e;else{const i=new Blob([wa],{type:"application/javascript"});s=URL.createObjectURL(i)}return s}_setConnectionState(e,s=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(e=null){let s;e?s=e:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(i=>{const n={access_token:s,version:la};s&&i.updateJoinPayload(n),i.joinedOnce&&i._isJoined()&&i._push(je.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${e}`,s)})}_triggerStateCallbacks(e,s){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(s)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Yi(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var s,i,n,o,a,l,d,c;if(this.transport=(s=e?.transport)!==null&&s!==void 0?s:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:Ks,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:Qt.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:u=>ya[u-1]||va,this.encode=(d=e?.encode)!==null&&d!==void 0?d:(u,h)=>h(JSON.stringify(u)),this.decode=(c=e?.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class kr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ce(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class ka extends kr{constructor(e,s,i){super(e),this.name="StorageApiError",this.status=s,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qs extends kr{constructor(e,s){super(e),this.name="StorageUnknownError",this.originalError=s}}var Na=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};const Xi=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...s)=>Nt(()=>Promise.resolve().then(()=>_t),void 0).then(({default:i})=>i(...s)):e=fetch,(...s)=>e(...s)},_a=()=>Na(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Nt(()=>Promise.resolve().then(()=>_t),void 0)).Response:Response}),Xs=r=>{if(Array.isArray(r))return r.map(s=>Xs(s));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([s,i])=>{const n=s.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[n]=Xs(i)}),e},Sa=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var dt=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};const Is=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ca=(r,e,s)=>dt(void 0,void 0,void 0,function*(){const i=yield _a();r instanceof i&&!s?.noResolveJson?r.json().then(n=>{const o=r.status||500,a=n?.statusCode||o+"";e(new ka(Is(n),o,a))}).catch(n=>{e(new Qs(Is(n),n))}):e(new Qs(Is(r),r))}),Pa=(r,e,s,i)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"||!i?n:(Sa(i)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(i)):n.body=i,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),s))};function Jt(r,e,s,i,n,o){return dt(this,void 0,void 0,function*(){return new Promise((a,l)=>{r(s,Pa(e,i,n,o)).then(d=>{if(!d.ok)throw d;return i?.noResolveJson?d:d.json()}).then(d=>a(d)).catch(d=>Ca(d,l,i))})})}function cs(r,e,s,i){return dt(this,void 0,void 0,function*(){return Jt(r,"GET",e,s,i)})}function Ee(r,e,s,i,n){return dt(this,void 0,void 0,function*(){return Jt(r,"POST",e,i,n,s)})}function er(r,e,s,i,n){return dt(this,void 0,void 0,function*(){return Jt(r,"PUT",e,i,n,s)})}function Ea(r,e,s,i){return dt(this,void 0,void 0,function*(){return Jt(r,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),i)})}function en(r,e,s,i,n){return dt(this,void 0,void 0,function*(){return Jt(r,"DELETE",e,i,n,s)})}var he=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};const Ta={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ei={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Aa{constructor(e,s={},i,n){this.url=e,this.headers=s,this.bucketId=i,this.fetch=Xi(n)}uploadOrUpdate(e,s,i,n){return he(this,void 0,void 0,function*(){try{let o;const a=Object.assign(Object.assign({},ei),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const d=a.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",a.cacheControl),d&&o.append("metadata",this.encodeMetadata(d)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",a.cacheControl),d&&o.append("metadata",this.encodeMetadata(d))):(o=i,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,d&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),n?.headers&&(l=Object.assign(Object.assign({},l),n.headers));const c=this._removeEmptyFolders(s),u=this._getFinalPath(c),h=yield(e=="PUT"?er:Ee)(this.fetch,`${this.url}/object/${u}`,o,Object.assign({headers:l},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(o){if(ce(o))return{data:null,error:o};throw o}})}upload(e,s,i){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,s,i)})}uploadToSignedUrl(e,s,i,n){return he(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),a=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",s);try{let d;const c=Object.assign({upsert:ei.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&i instanceof Blob?(d=new FormData,d.append("cacheControl",c.cacheControl),d.append("",i)):typeof FormData<"u"&&i instanceof FormData?(d=i,d.append("cacheControl",c.cacheControl)):(d=i,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield er(this.fetch,l.toString(),d,{headers:u});return{data:{path:o,fullPath:h.Key},error:null}}catch(d){if(ce(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,s){return he(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const n=Object.assign({},this.headers);s?.upsert&&(n["x-upsert"]="true");const o=yield Ee(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:n}),a=new URL(this.url+o.url),l=a.searchParams.get("token");if(!l)throw new kr("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}})}update(e,s,i){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,s,i)})}move(e,s,i){return he(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}})}copy(e,s,i){return he(this,void 0,void 0,function*(){try{return{data:{path:(yield Ee(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}})}createSignedUrl(e,s,i){return he(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),o=yield Ee(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const a=i?.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${a}`)},{data:o,error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}})}createSignedUrls(e,s,i){return he(this,void 0,void 0,function*(){try{const n=yield Ee(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:e},{headers:this.headers}),o=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${o}`):null})),error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}})}download(e,s){return he(this,void 0,void 0,function*(){const n=typeof s?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(s?.transform||{}),a=o?`?${o}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield cs(this.fetch,`${this.url}/${n}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ce(l))return{data:null,error:l};throw l}})}info(e){return he(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{const i=yield cs(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Xs(i),error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}})}exists(e){return he(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{return yield Ea(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(ce(i)&&i instanceof Qs){const n=i.originalError;if([400,404].includes(n?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,s){const i=this._getFinalPath(e),n=[],o=s?.download?`download=${s.download===!0?"":s.download}`:"";o!==""&&n.push(o);const l=typeof s?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(s?.transform||{});d!==""&&n.push(d);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${i}${c}`)}}}remove(e){return he(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(s){if(ce(s))return{data:null,error:s};throw s}})}list(e,s,i){return he(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Ta),s),{prefix:e||""});return{data:yield Ee(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},i),error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}})}listV2(e,s){return he(this,void 0,void 0,function*(){try{const i=Object.assign({},e);return{data:yield Ee(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const s=[];return e.width&&s.push(`width=${e.width}`),e.height&&s.push(`height=${e.height}`),e.resize&&s.push(`resize=${e.resize}`),e.format&&s.push(`format=${e.format}`),e.quality&&s.push(`quality=${e.quality}`),s.join("&")}}const Ia="2.11.0",$a={"X-Client-Info":`storage-js/${Ia}`};var ht=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};class Ra{constructor(e,s={},i,n){const o=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},$a),s),this.fetch=Xi(i)}listBuckets(){return ht(this,void 0,void 0,function*(){try{return{data:yield cs(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}})}getBucket(e){return ht(this,void 0,void 0,function*(){try{return{data:yield cs(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(s){if(ce(s))return{data:null,error:s};throw s}})}createBucket(e,s={public:!1}){return ht(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}})}updateBucket(e,s){return ht(this,void 0,void 0,function*(){try{return{data:yield er(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}})}emptyBucket(e){return ht(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(ce(s))return{data:null,error:s};throw s}})}deleteBucket(e){return ht(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(ce(s))return{data:null,error:s};throw s}})}}class Oa extends Ra{constructor(e,s={},i,n){super(e,s,i,n)}from(e){return new Aa(this.url,this.headers,e,this.fetch)}}const La="2.55.0";let Ot="";typeof Deno<"u"?Ot="deno":typeof document<"u"?Ot="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ot="react-native":Ot="node";const za={"X-Client-Info":`supabase-js-${Ot}/${La}`},Da={headers:za},Ua={schema:"public"},Ma={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Fa={};var Ba=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};const Wa=r=>{let e;return r?e=r:typeof fetch>"u"?e=Ui:e=fetch,(...s)=>e(...s)},Ha=()=>typeof Headers>"u"?Mi:Headers,qa=(r,e,s)=>{const i=Wa(s),n=Ha();return(o,a)=>Ba(void 0,void 0,void 0,function*(){var l;const d=(l=yield e())!==null&&l!==void 0?l:r;let c=new n(a?.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${d}`),i(o,Object.assign(Object.assign({},a),{headers:c}))})};var Va=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};function Ga(r){return r.endsWith("/")?r:r+"/"}function Ja(r,e){var s,i;const{db:n,auth:o,realtime:a,global:l}=r,{db:d,auth:c,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},d),n),auth:Object.assign(Object.assign({},c),o),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(s=h?.headers)!==null&&s!==void 0?s:{}),(i=l?.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>Va(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const tn="2.71.1",xt=30*1e3,tr=3,$s=tr*xt,Ka="http://localhost:9999",Ya="supabase.auth.token",Za={"X-Client-Info":`gotrue-js/${tn}`},sr="X-Supabase-Api-Version",sn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Qa=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Xa=10*60*1e3;class Nr extends Error{constructor(e,s,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=i}}function B(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class el extends Nr{constructor(e,s,i){super(e,s,i),this.name="AuthApiError",this.status=s,this.code=i}}function tl(r){return B(r)&&r.name==="AuthApiError"}class rn extends Nr{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class Ge extends Nr{constructor(e,s,i,n){super(e,i,n),this.name=s,this.status=i}}class We extends Ge{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function sl(r){return B(r)&&r.name==="AuthSessionMissingError"}class Xt extends Ge{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class es extends Ge{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ts extends Ge{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function rl(r){return B(r)&&r.name==="AuthImplicitGrantRedirectError"}class ti extends Ge{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rr extends Ge{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function Rs(r){return B(r)&&r.name==="AuthRetryableFetchError"}class si extends Ge{constructor(e,s,i){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=i}}class ir extends Ge{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ri=` 	
\r=`.split(""),il=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<ri.length;e+=1)r[ri[e].charCodeAt(0)]=-2;for(let e=0;e<ds.length;e+=1)r[ds[e].charCodeAt(0)]=e;return r})();function ii(r,e,s){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;s(ds[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;s(ds[i]),e.queuedBits-=6}}function nn(r,e,s){const i=il[r];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function ni(r){const e=[],s=a=>{e.push(String.fromCodePoint(a))},i={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=a=>{al(a,i,s)};for(let a=0;a<r.length;a+=1)nn(r.charCodeAt(a),n,o);return e.join("")}function nl(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function ol(r,e){for(let s=0;s<r.length;s+=1){let i=r.charCodeAt(s);if(i>55295&&i<=56319){const n=(i-55296)*1024&65535;i=(r.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}nl(i,e)}}function al(r,e,s){if(e.utf8seq===0){if(r<=127){s(r);return}for(let i=1;i<6;i+=1)if(!(r>>7-i&1)){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function ll(r){const e=[],s={queue:0,queuedBits:0},i=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)nn(r.charCodeAt(n),s,i);return new Uint8Array(e)}function cl(r){const e=[];return ol(r,s=>e.push(s)),new Uint8Array(e)}function dl(r){const e=[],s={queue:0,queuedBits:0},i=n=>{e.push(n)};return r.forEach(n=>ii(n,s,i)),ii(null,s,i),e.join("")}function ul(r){return Math.round(Date.now()/1e3)+r}function hl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const we=()=>typeof window<"u"&&typeof document<"u",Ye={tested:!1,writable:!1},on=()=>{if(!we())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ye.tested)return Ye.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Ye.tested=!0,Ye.writable=!0}catch{Ye.tested=!0,Ye.writable=!1}return Ye.writable};function pl(r){const e={},s=new URL(r);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,o)=>{e[o]=n})}catch{}return s.searchParams.forEach((i,n)=>{e[n]=i}),e}const an=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...s)=>Nt(()=>Promise.resolve().then(()=>_t),void 0).then(({default:i})=>i(...s)):e=fetch,(...s)=>e(...s)},fl=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",bt=async(r,e,s)=>{await r.setItem(e,JSON.stringify(s))},Ze=async(r,e)=>{const s=await r.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Me=async(r,e)=>{await r.removeItem(e)};class ws{constructor(){this.promise=new ws.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}ws.promiseConstructor=Promise;function Os(r){const e=r.split(".");if(e.length!==3)throw new ir("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!Qa.test(e[i]))throw new ir("JWT not in base64url format");return{header:JSON.parse(ni(e[0])),payload:JSON.parse(ni(e[1])),signature:ll(e[2]),raw:{header:e[0],payload:e[1]}}}async function ml(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function gl(r,e){return new Promise((i,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const a=await r(o);if(!e(o,null,a)){i(a);return}}catch(a){if(!e(o,a)){n(a);return}}})()})}function xl(r){return("0"+r.toString(16)).substr(-2)}function bl(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=s.length;let n="";for(let o=0;o<56;o++)n+=s.charAt(Math.floor(Math.random()*i));return n}return crypto.getRandomValues(e),Array.from(e,xl).join("")}async function yl(r){const s=new TextEncoder().encode(r),i=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(i);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function vl(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const s=await yl(r);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pt(r,e,s=!1){const i=bl();let n=i;s&&(n+="/PASSWORD_RECOVERY"),await bt(r,`${e}-code-verifier`,n);const o=await vl(i);return[o,i===o?"plain":"s256"]}const wl=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jl(r){const e=r.headers.get(sr);if(!e||!e.match(wl))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function kl(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Nl(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const _l=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ft(r){if(!_l.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ls(){const r={};return new Proxy(r,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function oi(r){return JSON.parse(JSON.stringify(r))}var Sl=globalThis&&globalThis.__rest||function(r,e){var s={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(s[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(s[i[n]]=r[i[n]]);return s};const et=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Cl=[502,503,504];async function ai(r){var e;if(!fl(r))throw new rr(et(r),0);if(Cl.includes(r.status))throw new rr(et(r),r.status);let s;try{s=await r.json()}catch(o){throw new rn(et(o),o)}let i;const n=jl(r);if(n&&n.getTime()>=sn["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?i=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(i=s.error_code),i){if(i==="weak_password")throw new si(et(s),r.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new We}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((o,a)=>o&&typeof a=="string",!0))throw new si(et(s),r.status,s.weak_password.reasons);throw new el(et(s),r.status||500,i)}const Pl=(r,e,s,i)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),s))};async function V(r,e,s,i){var n;const o=Object.assign({},i?.headers);o[sr]||(o[sr]=sn["2024-01-01"].name),i?.jwt&&(o.Authorization=`Bearer ${i.jwt}`);const a=(n=i?.query)!==null&&n!==void 0?n:{};i?.redirectTo&&(a.redirect_to=i.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",d=await El(r,e,s+l,{headers:o,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(d):{data:Object.assign({},d),error:null}}async function El(r,e,s,i,n,o){const a=Pl(e,i,n,o);let l;try{l=await r(s,Object.assign({},a))}catch(d){throw console.error(d),new rr(et(d),0)}if(l.ok||await ai(l),i?.noResolveJson)return l;try{return await l.json()}catch(d){await ai(d)}}function Re(r){var e;let s=null;$l(r)&&(s=Object.assign({},r),r.expires_at||(s.expires_at=ul(r.expires_in)));const i=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:s,user:i},error:null}}function li(r){const e=Re(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0)&&(e.data.weak_password=r.weak_password),e}function He(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Tl(r){return{data:r,error:null}}function Al(r){const{action_link:e,email_otp:s,hashed_token:i,redirect_to:n,verification_type:o}=r,a=Sl(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:s,hashed_token:i,redirect_to:n,verification_type:o},d=Object.assign({},a);return{data:{properties:l,user:d},error:null}}function Il(r){return r}function $l(r){return r.access_token&&r.refresh_token&&r.expires_in}const zs=["global","local","others"];var Rl=globalThis&&globalThis.__rest||function(r,e){var s={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(s[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(s[i[n]]=r[i[n]]);return s};class Ol{constructor({url:e="",headers:s={},fetch:i}){this.url=e,this.headers=s,this.fetch=an(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,s=zs[0]){if(zs.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${zs.join(", ")}`);try{return await V(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(B(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,s={}){try{return await V(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:He})}catch(i){if(B(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:s}=e,i=Rl(e,["options"]),n=Object.assign(Object.assign({},i),s);return"newEmail"in i&&(n.new_email=i?.newEmail,delete n.newEmail),await V(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Al,redirectTo:s?.redirectTo})}catch(s){if(B(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await V(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:He})}catch(s){if(B(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,i,n,o,a,l,d;try{const c={nextPage:null,lastPage:0,total:0},u=await V(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(s=e?.page)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:"",per_page:(o=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:Il});if(u.error)throw u.error;const h=await u.json(),f=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(d=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&d!==void 0?d:[];return m.length>0&&(m.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(x.split(";")[1].split("=")[1]);c[`${b}Page`]=g}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(B(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){ft(e);try{return await V(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:He})}catch(s){if(B(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){ft(e);try{return await V(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:He})}catch(i){if(B(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,s=!1){ft(e);try{return await V(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:He})}catch(i){if(B(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){ft(e.userId);try{const{data:s,error:i}=await V(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:i}}catch(s){if(B(s))return{data:null,error:s};throw s}}async _deleteFactor(e){ft(e.userId),ft(e.id);try{return{data:await V(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(B(s))return{data:null,error:s};throw s}}}function ci(r={}){return{getItem:e=>r[e]||null,setItem:(e,s)=>{r[e]=s},removeItem:e=>{delete r[e]}}}function Ll(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const mt={debug:!!(globalThis&&on()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ln extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class zl extends ln{}async function Dl(r,e,s){mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),mt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async n=>{if(n){mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await s()}finally{mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw mt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new zl(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(mt.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}Ll();const Ul={url:Ka,storageKey:Ya,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Za,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function di(r,e,s){return await s()}const gt={};class Ut{constructor(e){var s,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ut.nextInstanceID,Ut.nextInstanceID+=1,this.instanceID>0&&we()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Ul),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Ol({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=an(n.fetch),this.lock=n.lock||di,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:we()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=Dl:this.lock=di,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:on()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ci(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=ci(this.memoryStorage)),we()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,s;return(s=(e=gt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){gt[this.storageKey]=Object.assign(Object.assign({},gt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=gt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){gt[this.storageKey]=Object.assign(Object.assign({},gt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const s=pl(window.location.href);let i="none";if(this._isImplicitGrantCallback(s)?i="implicit":await this._isPKCECallback(s)&&(i="pkce"),we()&&this.detectSessionInUrl&&i!=="none"){const{data:n,error:o}=await this._getSessionFromURL(s,i);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),rl(o)){const d=(e=o.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:a,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return B(s)?{error:s}:{error:new rn("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,i,n;try{const o=await V(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(s=e?.options)===null||s===void 0?void 0:s.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Re}),{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};const d=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(o){if(B(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var s,i,n;try{let o;if("email"in e){const{email:u,password:h,options:f}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await pt(this.storage,this.storageKey)),o=await V(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:h,data:(s=f?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:x},xform:Re})}else if("phone"in e){const{phone:u,password:h,options:f}=e;o=await V(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(i=f?.data)!==null&&i!==void 0?i:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Re})}else throw new es("You must provide either an email or phone number and a password");const{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};const d=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(o){if(B(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let s;if("email"in e){const{email:o,password:a,options:l}=e;s=await V(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:li})}else if("phone"in e){const{phone:o,password:a,options:l}=e;s=await V(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:li})}else throw new es("You must provide either an email or phone number and a password");const{data:i,error:n}=s;return n?{data:{user:null,session:null},error:n}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Xt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:n})}catch(s){if(B(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(e){var s,i,n,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;if(s==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(e){var s,i,n,o,a,l,d,c,u,h,f,m;let x,g;if("message"in e)x=e.message,g=e.signature;else{const{chain:b,wallet:w,statement:y,options:j}=e;let S;if(we())if(typeof w=="object")S=w;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))S=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!j?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=w}const O=new URL((s=j?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in S&&S.signIn){const C=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),y?{statement:y}:null));let $;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")$=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)$=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in $&&"signature"in $&&(typeof $.signedMessage=="string"||$.signedMessage instanceof Uint8Array)&&$.signature instanceof Uint8Array)x=typeof $.signedMessage=="string"?$.signedMessage:new TextDecoder().decode($.signedMessage),g=$.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${O.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(n=(i=j?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=j?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((a=j?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((l=j?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((d=j?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((c=j?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((h=(u=j?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...j.signInWithSolana.resources.map($=>`- ${$}`)]:[]].join(`
`);const C=await S.signMessage(new TextEncoder().encode(x),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:b,error:w}=await V(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:dl(g)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Re});if(w)throw w;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new Xt}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:w})}catch(b){if(B(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(e){const s=await Ze(this.storage,`${this.storageKey}-code-verifier`),[i,n]=(s??"").split("/");try{const{data:o,error:a}=await V(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Re});if(await Me(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Xt}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:a})}catch(o){if(B(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:s,provider:i,token:n,access_token:o,nonce:a}=e,l=await V(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:n,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Re}),{data:d,error:c}=l;return c?{data:{user:null,session:null},error:c}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Xt}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:c})}catch(s){if(B(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(e){var s,i,n,o,a;try{if("email"in e){const{email:l,options:d}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await pt(this.storage,this.storageKey));const{error:h}=await V(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=d?.data)!==null&&s!==void 0?s:{},create_user:(i=d?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:d}=e,{data:c,error:u}=await V(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(o=d?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(a=d?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new es("You must provide either an email or phone number.")}catch(l){if(B(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var s,i;try{let n,o;"options"in e&&(n=(s=e.options)===null||s===void 0?void 0:s.redirectTo,o=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:a,error:l}=await V(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:Re});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const d=a.session,c=a.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(n){if(B(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var s,i,n;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=await pt(this.storage,this.storageKey)),await V(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&i!==void 0?i:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:Tl})}catch(o){if(B(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:i}=e;if(i)throw i;if(!s)throw new We;const{error:n}=await V(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(B(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:i,type:n,options:o}=e,{error:a}=await V(this.fetch,"POST",s,{headers:this.headers,body:{email:i,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:i,type:n,options:o}=e,{data:a,error:l}=await V(this.fetch,"POST",s,{headers:this.headers,body:{phone:i,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new es("You must provide either an email or phone number and a type")}catch(s){if(B(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await i,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=s();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await Ze(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<$s:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const a=await Ze(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=Ls()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,c,u))})}return{data:{session:e},error:null}}const{session:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await V(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:He}):await this._useSession(async s=>{var i,n,o;const{data:a,error:l}=s;if(l)throw l;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new We}:await V(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:He})})}catch(s){if(B(s))return sl(s)&&(await this._removeSession(),await Me(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async i=>{const{data:n,error:o}=i;if(o)throw o;if(!n.session)throw new We;const a=n.session;let l=null,d=null;this.flowType==="pkce"&&e.email!=null&&([l,d]=await pt(this.storage,this.storageKey));const{data:c,error:u}=await V(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:d}),jwt:a.access_token,xform:He});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(i){if(B(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new We;const s=Date.now()/1e3;let i=s,n=!0,o=null;const{payload:a}=Os(e.access_token);if(a.exp&&(i=a.exp,n=i<=s),n){const{session:l,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:d}=await this._getUser(e.access_token);if(d)throw d;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:i-s,expires_at:i},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(s){if(B(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var i;if(!e){const{data:a,error:l}=s;if(l)throw l;e=(i=a.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new We;const{session:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(B(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(e,s){try{if(!we())throw new ts("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ts(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new ti("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ts("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ti("No code detected.");const{data:y,error:j}=await this._exchangeCodeForSession(e.code);if(j)throw j;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:n,access_token:o,refresh_token:a,expires_in:l,expires_at:d,token_type:c}=e;if(!o||!l||!a||!c)throw new ts("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;d&&(f=parseInt(d));const m=f-u;m*1e3<=xt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const x=f-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,u);const{data:g,error:b}=await this._getUser(o);if(b)throw b;const w={provider_token:i,provider_refresh_token:n,access_token:o,expires_in:h,expires_at:f,refresh_token:a,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(i){if(B(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await Ze(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var i;const{data:n,error:o}=s;if(o)return{error:o};const a=(i=n.session)===null||i===void 0?void 0:i.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(tl(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Me(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const s=hl(),i={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async s=>{var i,n;try{const{data:{session:o},error:a}=s;if(a)throw a;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,s={}){let i=null,n=null;this.flowType==="pkce"&&([i,n]=await pt(this.storage,this.storageKey,!0));try{return await V(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(o){if(B(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:s,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(s){if(B(s))return{data:null,error:s};throw s}}async linkIdentity(e){var s;try{const{data:i,error:n}=await this._useSession(async o=>{var a,l,d,c,u;const{data:h,error:f}=o;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await V(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return we()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(i?.url),{data:{provider:e.provider,url:i?.url},error:null}}catch(i){if(B(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async unlinkIdentity(e){try{return await this._useSession(async s=>{var i,n;const{data:o,error:a}=s;if(a)throw a;return await V(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(B(s))return{data:null,error:s};throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const i=Date.now();return await gl(async n=>(n>0&&await ml(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await V(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Re})),(n,o)=>{const a=200*Math.pow(2,n);return o&&Rs(o)&&Date.now()+a-i<xt})}catch(i){if(this._debug(s,"error",i),B(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",i),we()&&!s.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,s;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const n=await Ze(this.storage,this.storageKey);if(n&&this.userStorage){let a=await Ze(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await bt(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a?.user)!==null&&e!==void 0?e:Ls()}else if(n&&!n.user&&!n.user){const a=await Ze(this.storage,this.storageKey+"-user");a&&a?.user?(n.user=a.user,await Me(this.storage,this.storageKey+"-user"),await bt(this.storage,this.storageKey,n)):n.user=Ls()}if(this._debug(i,"session from storage",n),!this._isValidSession(n)){this._debug(i,"session is not valid"),n!==null&&await this._removeSession();return}const o=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<$s;if(this._debug(i,`session has${o?"":" not"} expired with margin of ${$s}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Rs(a)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(n.access_token);!l&&a?.user?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(i,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(i,"error",n),console.error(n);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var s,i;if(!e)throw new We;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ws;const{data:o,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new We;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),B(o)){const a={session:null,error:o};return Rs(o)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,s,i=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",s,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:s});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,s)}catch(d){o.push(d)}});if(await Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const s=Object.assign({},e),i=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&s.user&&await bt(this.userStorage,this.storageKey+"-user",{user:s.user});const n=Object.assign({},s);delete n.user;const o=oi(n);await bt(this.storage,this.storageKey,o)}else{const n=oi(s);await bt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Me(this.storage,this.storageKey),await Me(this.storage,this.storageKey+"-code-verifier"),await Me(this.storage,this.storageKey+"-user"),this.userStorage&&await Me(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&we()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),xt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:i}}=s;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((i.expires_at*1e3-e)/xt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${xt}ms, refresh threshold is ${tr} ticks`),n<=tr&&await this._callRefreshToken(i.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ln)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!we()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,i){const n=[`provider=${encodeURIComponent(s)}`];if(i?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&n.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[o,a]=await pt(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(l.toString())}if(i?.queryParams){const o=new URLSearchParams(i.queryParams);n.push(o.toString())}return i?.skipBrowserRedirect&&n.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var i;const{data:n,error:o}=s;return o?{data:null,error:o}:await V(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token})})}catch(s){if(B(s))return{data:null,error:s};throw s}}async _enroll(e){try{return await this._useSession(async s=>{var i,n;const{data:o,error:a}=s;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:c}=await V(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=d?.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(s){if(B(s))return{data:null,error:s};throw s}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var i;const{data:n,error:o}=s;if(o)return{data:null,error:o};const{data:a,error:l}=await V(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(s){if(B(s))return{data:null,error:s};throw s}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var i;const{data:n,error:o}=s;return o?{data:null,error:o}:await V(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token})})}catch(s){if(B(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(e){const{data:s,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const i=e?.factors||[],n=i.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=i.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:i,totp:n,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var s,i;const{data:{session:n},error:o}=e;if(o)return{data:null,error:o};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Os(n.access_token);let l=null;a.aal&&(l=a.aal);let d=l;((i=(s=n.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(d="aal2");const u=a.amr||[];return{data:{currentLevel:l,nextLevel:d,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,s={keys:[]}){let i=s.keys.find(l=>l.kid===e);if(i)return i;const n=Date.now();if(i=this.jwks.keys.find(l=>l.kid===e),i&&this.jwks_cached_at+Xa>n)return i;const{data:o,error:a}=await V(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,i=o.keys.find(l=>l.kid===e),!i)?null:i}async getClaims(e,s={}){try{let i=e;if(!i){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};i=m.session.access_token}const{header:n,payload:o,signature:a,raw:{header:l,payload:d}}=Os(i);s?.allowExpired||kl(o.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!c){const{error:m}=await this.getUser(i);if(m)throw m;return{data:{claims:o,header:n,signature:a},error:null}}const u=Nl(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,a,cl(`${l}.${d}`)))throw new ir("Invalid JWT signature");return{data:{claims:o,header:n,signature:a},error:null}}catch(i){if(B(i))return{data:null,error:i};throw i}}}Ut.nextInstanceID=0;const Ml=Ut;class Fl extends Ml{constructor(e){super(e)}}var Bl=globalThis&&globalThis.__awaiter||function(r,e,s,i){function n(o){return o instanceof s?o:new s(function(a){a(o)})}return new(s||(s=Promise))(function(o,a){function l(u){try{c(i.next(u))}catch(h){a(h)}}function d(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):n(u.value).then(l,d)}c((i=i.apply(r,e||[])).next())})};class Wl{constructor(e,s,i){var n,o,a;if(this.supabaseUrl=e,this.supabaseKey=s,!e)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const l=Ga(e),d=new URL(l);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const c=`sb-${d.hostname.split(".")[0]}-auth-token`,u={db:Ua,realtime:Fa,auth:Object.assign(Object.assign({},Ma),{storageKey:c}),global:Da},h=Ja(i??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(o=h.global.headers)!==null&&o!==void 0?o:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=qa(s,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new na(new URL("rest/v1",d).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Oa(this.storageUrl.href,this.headers,this.fetch,i?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Oo(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,s={},i={}){return this.rest.rpc(e,s,i)}channel(e,s={config:{}}){return this.realtime.channel(e,s)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,s;return Bl(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(s=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:s,detectSessionInUrl:i,storage:n,storageKey:o,flowType:a,lock:l,debug:d},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Fl({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:o,autoRefreshToken:e,persistSession:s,detectSessionInUrl:i,storage:n,flowType:a,lock:l,debug:d,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ja(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,i)=>{this._handleTokenChanged(s,"CLIENT",i?.access_token)})}_handleTokenChanged(e,s,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:e==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Hl=(r,e,s)=>new Wl(r,e,s);function ql(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}ql()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Vl="https://ihtnsyhknvltgrksffun.supabase.co",Gl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlodG5zeWhrbnZsdGdya3NmZnVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM2NzA2MzYsImV4cCI6MjA2OTI0NjYzNn0.ZmoZ5cGVHfhDwTvkmaw9LSVHm_awoyMOTyQKewr7rYo";console.log(" Supabase Config Check:");console.log("URL:"," Present");console.log("Anon Key:"," Present");const W=Hl(Vl,Gl,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},db:{schema:"public"},global:{headers:{"X-Client-Info":"fanclubz-web@1.0.0"}}}),Ds={signUp:async(r,e,s={})=>{try{const{data:i,error:n}=await W.auth.signUp({email:r,password:e,options:{data:s,emailRedirectTo:"https://app.fanclubz.app/auth/callback"}});return n&&console.error("Auth signUp error:",n),{data:i,error:n}}catch(i){return console.error("Auth signUp exception:",i),{data:null,error:{message:i.message||"An unexpected error occurred"}}}},signIn:async(r,e)=>{try{const{data:s,error:i}=await W.auth.signInWithPassword({email:r,password:e});return i&&console.error("Auth signIn error:",i),{data:s,error:i}}catch(s){return console.error("Auth signIn exception:",s),{data:null,error:{message:s.message||"An unexpected error occurred"}}}},signOut:async()=>{try{const{error:r}=await W.auth.signOut();return r&&console.error("Auth signOut error:",r),{error:r}}catch(r){return console.error("Auth signOut exception:",r),{error:{message:r.message||"An unexpected error occurred"}}}},getCurrentUser:async()=>{try{const{data:{user:r},error:e}=await W.auth.getUser();return e&&console.error("Auth getCurrentUser error:",e),{user:r,error:e}}catch(r){return console.error("Auth getCurrentUser exception:",r),{user:null,error:{message:r.message||"An unexpected error occurred"}}}},onAuthStateChange:r=>W.auth.onAuthStateChange(r)},js=Ve()((r,e)=>({balances:[{currency:"USD",available:1e3,reserved:0,total:1e3}],transactions:[],isLoading:!1,error:null,get balance(){return e().balances.find(n=>n.currency==="USD")?.available||0},get totalBalance(){return e().balances.find(n=>n.currency==="USD")?.total||0},get reservedBalance(){return e().balances.find(n=>n.currency==="USD")?.reserved||0},initializeWallet:async()=>{console.log(" Initializing wallet..."),r({isLoading:!0,error:null});try{const{data:{user:s}}=await W.auth.getUser();if(!s){console.log(" No authenticated user found"),r({balances:[],isLoading:!1,error:"User not authenticated"});return}console.log(" Fetching wallet for user:",s.id);const{data:i,error:n}=await W.from("wallets").select("*").eq("user_id",s.id);if(n&&n.code!=="PGRST116"){console.error(" Error fetching wallet data:",n),r({balances:[],isLoading:!1,error:"Failed to fetch wallet data"});return}const o=i?.map(c=>({currency:c.currency,available:Number(c.available_balance)||0,reserved:Number(c.reserved_balance)||0,total:Number(c.available_balance||0)+Number(c.reserved_balance||0)}))||[];if(o.length===0){console.log(" Creating initial wallet in database");try{await W.from("wallets").insert({user_id:s.id,currency:"USD",available_balance:0,reserved_balance:0,total_deposited:0,total_withdrawn:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),o.push({currency:"USD",available:0,reserved:0,total:0}),console.log(" Initial wallet created in database")}catch(c){console.error(" Failed to create initial wallet:",c),r({balances:[],isLoading:!1,error:"Failed to create wallet"});return}}else console.log(" Using real wallet data from database:",o[0]);const{data:a,error:l}=await W.from("wallet_transactions").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(50);l&&console.error(" Error fetching transaction history:",l);const d=(a||[]).map(c=>({id:c.id,type:c.type,amount:Number(c.amount),description:c.description,date:new Date(c.created_at),status:c.status,reference:c.reference,currency:c.currency,fee:c.fee?Number(c.fee):void 0,fromUser:c.from_user,toUser:c.to_user,predictionId:c.prediction_id}));r({balances:o,transactions:d,isLoading:!1,error:null}),console.log(" Wallet initialized successfully"),console.log(" Balance:",o[0]?.available||0),console.log(" Transactions:",d.length)}catch(s){console.error(" Error initializing wallet:",s),r({balances:[{currency:"USD",available:1e3,reserved:0,total:1e3}],isLoading:!1,error:null})}},refreshWalletData:async()=>{await e().initializeWallet()},lockFunds:async(s,i="USD")=>{try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const o=e().balances.find(c=>c.currency===i);if(!o||o.available<s)throw new Error("Insufficient funds");const a=o.available-s,l=o.reserved+s,d={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"prediction",amount:s,description:"Funds locked for prediction",date:new Date,status:"pending",reference:`LOCK_${Date.now()}`,currency:i,fee:0};r(c=>({balances:c.balances.map(u=>u.currency===i?{...u,available:a,reserved:l,total:a+l}:u),transactions:[d,...c.transactions],error:null})),console.log(" Funds locked successfully with transaction record:",s,i);try{const{data:{user:c}}=await W.auth.getUser();c&&await W.from("wallets").upsert({user_id:c.id,currency:i,available_balance:a,reserved_balance:l,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"})}catch{console.log(" Could not update database, using local state only")}}catch(n){const o=n instanceof Error?n.message:"Failed to lock funds";throw r({error:o}),n}},addFunds:async(s,i="USD",n="Bank Transfer")=>{r({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const a=e().balances.find(u=>u.currency===i),l=(a?.available||0)+s,d=l+(a?.reserved||0),c={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"deposit",amount:s,description:`${n} Deposit`,date:new Date,status:"completed",reference:`DEP_${Date.now()}`,currency:i,fee:0};r(u=>({balances:u.balances.map(h=>h.currency===i?{...h,available:l,total:d}:h),transactions:[c,...u.transactions],isLoading:!1,error:null}));try{const{data:{user:u}}=await W.auth.getUser();u&&(await W.from("wallets").upsert({user_id:u.id,currency:i,available_balance:l,reserved_balance:a?.reserved||0,total_deposited:(a?.available||0)+s,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await W.from("wallet_transactions").insert({user_id:u.id,type:c.type,currency:c.currency,amount:c.amount,status:c.status,reference:c.reference,description:c.description,created_at:new Date().toISOString()}),console.log(" Funds added and saved to database:",s,i))}catch(u){console.error(" Failed to save to database:",u)}return c}catch(o){const a=o instanceof Error?o.message:"Failed to add funds";throw r({isLoading:!1,error:a}),o}},withdraw:async(s,i="USD",n="Bank Account")=>{r({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const a=e().balances.find(u=>u.currency===i);if(!a||a.available<s)throw new Error("Insufficient funds");const l=a.available-s,d=l+a.reserved,c={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"withdraw",amount:s,description:`Withdrawal to ${n}`,date:new Date,status:"completed",reference:`WTH_${Date.now()}`,currency:i,fee:0};return r(u=>({balances:u.balances.map(h=>h.currency===i?{...h,available:l,total:d}:h),transactions:[c,...u.transactions],isLoading:!1,error:null})),console.log(" Withdrawal successful:",s,i),c}catch(o){const a=o instanceof Error?o.message:"Failed to withdraw funds";throw r({isLoading:!1,error:a}),o}},makePrediction:async(s,i,n,o="USD")=>{r({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const l=e().balances.find(f=>f.currency===o);if(!l||l.available<s)throw new Error("Insufficient funds");const d=l.available-s,c=l.reserved+s,u=d+c,h={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"prediction",amount:s,description:i,date:new Date,status:"completed",reference:`PRED_${Date.now()}`,currency:o,fee:0,predictionId:n};return r(f=>({balances:f.balances.map(m=>m.currency===o?{...m,available:d,reserved:c,total:u}:m),transactions:[h,...f.transactions],isLoading:!1,error:null})),console.log(" Prediction made successfully:",s,o),h}catch(a){const l=a instanceof Error?a.message:"Failed to make prediction";throw r({isLoading:!1,error:l}),a}},recordWin:async(s,i,n,o="USD")=>{r({isLoading:!0,error:null});try{const l=e().balances.find(f=>f.currency===o),d=(l?.available||0)+s,c=Math.max(0,(l?.reserved||0)-s),u=d+c,h={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"win",amount:s,description:i,date:new Date,status:"completed",reference:`WIN_${Date.now()}`,currency:o,fee:0,predictionId:n};return r(f=>({balances:f.balances.map(m=>m.currency===o?{...m,available:d,reserved:c,total:u}:m),transactions:[h,...f.transactions],isLoading:!1,error:null})),console.log(" Win recorded successfully:",s,o),h}catch(a){const l=a instanceof Error?a.message:"Failed to record win";throw r({isLoading:!1,error:l}),a}},recordLoss:async(s,i,n,o="USD")=>{r({isLoading:!0,error:null});try{const l=e().balances.find(h=>h.currency===o),d=Math.max(0,(l?.reserved||0)-s),c=(l?.available||0)+d,u={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"loss",amount:s,description:i,date:new Date,status:"completed",reference:`LOSS_${Date.now()}`,currency:o,fee:0,predictionId:n};return r(h=>({balances:h.balances.map(f=>f.currency===o?{...f,reserved:d,total:c}:f),transactions:[u,...h.transactions],isLoading:!1,error:null})),console.log(" Loss recorded successfully:",s,o),u}catch(a){const l=a instanceof Error?a.message:"Failed to record loss";throw r({isLoading:!1,error:l}),a}},transferFunds:async(s,i,n,o="USD")=>{r({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const l=e().balances.find(h=>h.currency===o);if(!l||l.available<s)throw new Error("Insufficient funds");const d=l.available-s,c=d+l.reserved,u={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"transfer_out",amount:s,description:n||`Transfer to ${i}`,date:new Date,status:"completed",reference:`TRF_${Date.now()}`,currency:o,fee:0,toUser:i};return r(h=>({balances:h.balances.map(f=>f.currency===o?{...f,available:d,total:c}:f),transactions:[u,...h.transactions],isLoading:!1,error:null})),console.log(" Transfer successful:",s,o),u}catch(a){const l=a instanceof Error?a.message:"Failed to transfer funds";throw r({isLoading:!1,error:l}),a}},getBalance:(s="USD")=>e().balances.find(o=>o.currency===s)?.available||0,getTransactionHistory:s=>{let n=[...e().transactions];return s?.type&&(n=n.filter(o=>o.type===s.type)),s?.currency&&(n=n.filter(o=>o.currency===s.currency)),s?.limit&&(n=n.slice(0,s.limit)),n},clearError:()=>{r({error:null})}})),nr=new Map,ss=r=>{const e=nr.get(r);return e?Object.fromEntries(Object.entries(e.stores).map(([s,i])=>[s,i.getState()])):{}},Jl=(r,e,s)=>{if(r===void 0)return{type:"untracked",connection:e.connect(s)};const i=nr.get(s.name);if(i)return{type:"tracked",store:r,...i};const n={connection:e.connect(s),stores:{}};return nr.set(s.name,n),{type:"tracked",store:r,...n}},Kl=(r,e={})=>(s,i,n)=>{const{enabled:o,anonymousActionType:a,store:l,...d}=e;let c;try{c=(o??!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!c)return r(s,i,n);const{connection:u,...h}=Jl(l,c,d);let f=!0;n.setState=(g,b,w)=>{const y=s(g,b);if(!f)return y;const j=w===void 0?{type:a||"anonymous"}:typeof w=="string"?{type:w}:w;return l===void 0?(u?.send(j,i()),y):(u?.send({...j,type:`${l}/${j.type}`},{...ss(d.name),[l]:n.getState()}),y)};const m=(...g)=>{const b=f;f=!1,s(...g),f=b},x=r(n.setState,i,n);if(h.type==="untracked"?u?.init(x):(h.stores[h.store]=n,u?.init(Object.fromEntries(Object.entries(h.stores).map(([g,b])=>[g,g===h.store?x:b.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let g=!1;const b=n.dispatch;n.dispatch=(...w)=>{b(...w)}}return u.subscribe(g=>{var b;switch(g.type){case"ACTION":if(typeof g.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Us(g.payload,w=>{if(w.type==="__setState"){if(l===void 0){m(w.state);return}Object.keys(w.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const y=w.state[l];if(y==null)return;JSON.stringify(n.getState())!==JSON.stringify(y)&&m(y);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(w)});case"DISPATCH":switch(g.payload.type){case"RESET":return m(x),l===void 0?u?.init(n.getState()):u?.init(ss(d.name));case"COMMIT":if(l===void 0){u?.init(n.getState());return}return u?.init(ss(d.name));case"ROLLBACK":return Us(g.state,w=>{if(l===void 0){m(w),u?.init(n.getState());return}m(w[l]),u?.init(ss(d.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Us(g.state,w=>{if(l===void 0){m(w);return}JSON.stringify(n.getState())!==JSON.stringify(w[l])&&m(w[l])});case"IMPORT_STATE":{const{nextLiftedState:w}=g.payload,y=(b=w.computedStates.slice(-1)[0])==null?void 0:b.state;if(!y)return;m(l===void 0?y:y[l]),u?.send(null,w);return}case"PAUSE_RECORDING":return f=!f}return}}),x},Yl=Kl,Us=(r,e)=>{let s;try{s=JSON.parse(r)}catch(i){console.error("[zustand devtools middleware] Could not parse the received json",i)}s!==void 0&&e(s)};function cn(r,e){let s;try{s=r()}catch{return}return{getItem:n=>{var o;const a=d=>d===null?null:JSON.parse(d,e?.reviver),l=(o=s.getItem(n))!=null?o:null;return l instanceof Promise?l.then(a):a(l)},setItem:(n,o)=>s.setItem(n,JSON.stringify(o,e?.replacer)),removeItem:n=>s.removeItem(n)}}const Mt=r=>e=>{try{const s=r(e);return s instanceof Promise?s:{then(i){return Mt(i)(s)},catch(i){return this}}}catch(s){return{then(i){return this},catch(i){return Mt(i)(s)}}}},Zl=(r,e)=>(s,i,n)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:b=>b,version:0,merge:(b,w)=>({...w,...b}),...e},a=!1;const l=new Set,d=new Set;let c;try{c=o.getStorage()}catch{}if(!c)return r((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),s(...b)},i,n);const u=Mt(o.serialize),h=()=>{const b=o.partialize({...i()});let w;const y=u({state:b,version:o.version}).then(j=>c.setItem(o.name,j)).catch(j=>{w=j});if(w)throw w;return y},f=n.setState;n.setState=(b,w)=>{f(b,w),h()};const m=r((...b)=>{s(...b),h()},i,n);let x;const g=()=>{var b;if(!c)return;a=!1,l.forEach(y=>y(i()));const w=((b=o.onRehydrateStorage)==null?void 0:b.call(o,i()))||void 0;return Mt(c.getItem.bind(c))(o.name).then(y=>{if(y)return o.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==o.version){if(o.migrate)return o.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var j;return x=o.merge(y,(j=i())!=null?j:m),s(x,!0),h()}).then(()=>{w?.(x,void 0),a=!0,d.forEach(y=>y(x))}).catch(y=>{w?.(void 0,y)})};return n.persist={setOptions:b=>{o={...o,...b},b.getStorage&&(c=b.getStorage())},clearStorage:()=>{c?.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>g(),hasHydrated:()=>a,onHydrate:b=>(l.add(b),()=>{l.delete(b)}),onFinishHydration:b=>(d.add(b),()=>{d.delete(b)})},g(),x||m},Ql=(r,e)=>(s,i,n)=>{let o={storage:cn(()=>localStorage),partialize:g=>g,version:0,merge:(g,b)=>({...b,...g}),...e},a=!1;const l=new Set,d=new Set;let c=o.storage;if(!c)return r((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),s(...g)},i,n);const u=()=>{const g=o.partialize({...i()});return c.setItem(o.name,{state:g,version:o.version})},h=n.setState;n.setState=(g,b)=>{h(g,b),u()};const f=r((...g)=>{s(...g),u()},i,n);n.getInitialState=()=>f;let m;const x=()=>{var g,b;if(!c)return;a=!1,l.forEach(y=>{var j;return y((j=i())!=null?j:f)});const w=((b=o.onRehydrateStorage)==null?void 0:b.call(o,(g=i())!=null?g:f))||void 0;return Mt(c.getItem.bind(c))(o.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==o.version){if(o.migrate)return[!0,o.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var j;const[S,O]=y;if(m=o.merge(O,(j=i())!=null?j:f),s(m,!0),S)return u()}).then(()=>{w?.(m,void 0),m=i(),a=!0,d.forEach(y=>y(m))}).catch(y=>{w?.(void 0,y)})};return n.persist={setOptions:g=>{o={...o,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c?.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:g=>(l.add(g),()=>{l.delete(g)}),onFinishHydration:g=>(d.add(g),()=>{d.delete(g)})},o.skipHydration||x(),m||f},Xl=(r,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?Zl(r,e):Ql(r,e),dn=Xl,_r=Ve()(dn((r,e)=>({notifications:[],unreadCount:0,toasts:[],settings:{predictionOutcomes:!0,comments:!0,marketClosing:!0,payouts:!0,pushNotifications:!0,emailNotifications:!1,frequency:"immediate"},addNotification:s=>{const i={...s,id:crypto.randomUUID(),createdAt:new Date().toISOString(),read:!1};r(n=>({notifications:[i,...n.notifications],unreadCount:n.unreadCount+1})),["prediction_outcome","payout"].includes(i.type)&&e().addToast({type:"success",title:i.title,message:i.message,duration:5e3}),e().settings.pushNotifications&&e().sendPushNotification(i)},markAsRead:s=>{r(i=>({notifications:i.notifications.map(n=>n.id===s?{...n,read:!0}:n),unreadCount:Math.max(0,i.unreadCount-1)}))},markAllAsRead:()=>{r(s=>({notifications:s.notifications.map(i=>({...i,read:!0})),unreadCount:0}))},deleteNotification:s=>{r(i=>{const n=i.notifications.find(a=>a.id===s),o=n&&!n.read;return{notifications:i.notifications.filter(a=>a.id!==s),unreadCount:o?Math.max(0,i.unreadCount-1):i.unreadCount}})},clearAllNotifications:()=>{r({notifications:[],unreadCount:0})},updateSettings:s=>{r(i=>({settings:{...i.settings,...s}}))},addToast:s=>{const i={...s,id:crypto.randomUUID()};r(n=>({toasts:[...n.toasts,i]}))},removeToast:s=>{r(i=>({toasts:i.toasts.filter(n=>n.id!==s)}))},clearToasts:()=>{r({toasts:[]})},requestPermission:async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.warn("This browser does not support notifications"),!1),subscribeToPush:async()=>{if(!await e().requestPermission())throw new Error("Notification permission denied");console.log("Push notifications subscribed"),r(i=>({settings:{...i.settings,pushNotifications:!0}}))},unsubscribeFromPush:async()=>{console.log("Push notifications unsubscribed"),r(s=>({settings:{...s.settings,pushNotifications:!1}}))},sendPushNotification:s=>{if(!("Notification"in window)||Notification.permission!=="granted")return;const i=new Notification(s.title,{body:s.message,icon:"/icon-192x192.png",badge:"/icon-badge.png",tag:s.id,renotify:!1});i.onclick=()=>{window.focus(),i.close(),s.data?.predictionId&&(window.location.href=`/predictions/${s.data.predictionId}`)},setTimeout(()=>{i.close()},5e3)}}),{name:"fanclubz-notifications",partialize:r=>({notifications:r.notifications,settings:r.settings})})),Qe=(r,e)=>{_r.getState().addToast({type:"success",title:e||"Success",message:r,duration:3e3})},Xe=(r,e)=>{_r.getState().addToast({type:"error",title:e||"Error",message:r,duration:5e3})},tt=r=>{if(!r)return null;const e=r.user_metadata||{},s=r.app_metadata||{};let i="",n="",o="";if(e.full_name){const a=e.full_name.split(" ");i=a[0]||"",n=a.slice(1).join(" ")||""}else i=e.firstName||e.first_name||e.given_name||"User",n=e.lastName||e.last_name||e.family_name||"";return e.avatar_url?o=e.avatar_url:e.picture?o=e.picture:e.photo&&(o=e.photo),{id:r.id,email:r.email||"",firstName:i,lastName:n,phone:r.phone,avatar:o,provider:s.provider||"email",bio:e.bio,totalEarnings:e.totalEarnings||0,totalInvested:e.totalInvested||0,winRate:e.winRate||0,activePredictions:e.activePredictions||0,totalPredictions:e.totalPredictions||0,rank:e.rank||0,level:e.level||"New Predictor",createdAt:r.created_at||new Date().toISOString()}};let ui=!1,Ms=!1,hi="",pi=0;const ie=Ve()(dn((r,e)=>({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!1,lastAuthCheck:0,initializeAuth:async()=>{const s=e(),i=Date.now();if(Ms){console.log(" Auth initialization already in progress, waiting...");return}if(s.initialized&&i-s.lastAuthCheck<3e4){console.log(" Auth recently checked, skipping initialization");return}if(s.isAuthenticated&&s.user&&s.token&&i-s.lastAuthCheck<3e5){s.initialized||console.log(" Using cached auth state for:",s.user.firstName),r({loading:!1,initialized:!0,lastAuthCheck:i});return}if(s.loading){console.log(" Auth check already in progress...");return}Ms=!0,r({loading:!0,lastAuthCheck:i});try{console.log(" Initializing authentication...");const{data:{session:n},error:o}=await W.auth.getSession();if(o){console.log(" Session check error:",o.message),r({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:i});return}if(n?.user){const a=tt(n.user);s.initialized||console.log(" Found active session for:",a?.firstName),r({isAuthenticated:!0,user:a,token:n.access_token,loading:!1,initialized:!0,lastAuthCheck:i})}else s.initialized||console.log(" No active session found"),r({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:i})}catch(n){console.error(" Auth initialization error:",n.message),r({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:i})}finally{Ms=!1}},login:async(s,i)=>{r({loading:!0});try{console.log(" Logging in user:",s);const{data:n,error:o}=await Ds.signIn(s,i);if(o){console.error(" Login error:",o.message);let a="Login failed. Please check your credentials.";throw o.message.includes("Invalid login credentials")?a="Invalid email or password. Please try again.":o.message.includes("Email not confirmed")&&(a="Please check your email and click the confirmation link."),r({loading:!1}),Xe(a),new Error(a)}if(n.user&&n.session){const a=tt(n.user);console.log(" Login successful for:",a?.firstName),r({isAuthenticated:!0,user:a,token:n.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),Qe(`Welcome back, ${a?.firstName}!`)}}catch(n){throw console.error(" Login exception:",n.message),r({loading:!1}),n}},register:async(s,i,n,o)=>{r({loading:!0});try{if(console.log(" Registering user:",s),i.length<6)throw new Error("Password must be at least 6 characters long");const a={data:{firstName:n,lastName:o,first_name:n,last_name:o,full_name:`${n} ${o}`}},{data:l,error:d}=await Ds.signUp(s,i,a);if(d){console.error(" Registration error:",d.message);let c="Registration failed. Please try again.";throw d.message.includes("User already registered")?c="An account with this email already exists. Please sign in instead.":d.message.includes("Password should be at least")&&(c="Password must be at least 6 characters long."),r({loading:!1}),Xe(c),new Error(c)}if(l.user){const c=tt(l.user);console.log(" Registration successful for:",c?.firstName),l.session?(r({isAuthenticated:!0,user:c,token:l.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),Qe(`Welcome to Fan Club Z, ${c?.firstName}!`)):(r({isAuthenticated:!0,user:c,token:null,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),Qe(`Welcome to Fan Club Z, ${c?.firstName}! Please check your email to verify your account.`))}}catch(a){throw console.error(" Registration exception:",a.message),r({loading:!1}),a}},loginWithOAuth:async s=>{r({loading:!0});try{console.log(` Starting ${s} OAuth login...`);const i=window.location.origin,n=`${i}/auth/callback`;console.log(" Current origin:",i),console.log(" OAuth redirect URL:",n);const{data:o,error:a}=await W.auth.signInWithOAuth({provider:s,options:{redirectTo:n,queryParams:{access_type:"offline",prompt:"consent"}}});if(a)throw console.error(` ${s} OAuth error:`,a.message),r({loading:!1}),Xe(`${s} sign-in failed. Please try again.`),new Error(a.message);console.log(` ${s} OAuth initiated, redirecting...`)}catch(i){throw console.error(` ${s} OAuth exception:`,i.message),r({loading:!1}),i}},handleOAuthCallback:async()=>{try{console.log(" Handling OAuth callback...");const{data:s,error:i}=await W.auth.getSession();if(i)throw console.error(" OAuth callback error:",i.message),Xe("Authentication failed. Please try again."),new Error(i.message);if(s.session?.user){const n=tt(s.session.user);console.log(" OAuth authentication successful for:",n?.firstName),r({isAuthenticated:!0,user:n,token:s.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()});const o=n?.provider?.charAt(0).toUpperCase()+n?.provider?.slice(1);return Qe(`Welcome ${n?.firstName}! Signed in with ${o}.`),n}else throw new Error("No user session found after OAuth callback")}catch(s){throw console.error(" OAuth callback exception:",s.message),r({loading:!1}),s}},logout:async()=>{r({loading:!0});try{console.log(" Logging out...");const{error:s}=await Ds.signOut();s&&console.error(" Logout error:",s.message),r({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:0}),Qe("Signed out successfully")}catch(s){console.error(" Logout exception:",s.message),r({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:0})}},updateProfile:async s=>{r({loading:!0});try{const i=e().user;if(!i)throw new Error("No user logged in");console.log(" Updating profile...");const{data:n,error:o}=await W.auth.updateUser({data:{firstName:s.firstName||i.firstName,lastName:s.lastName||i.lastName,bio:s.bio!==void 0?s.bio:i.bio}});if(o)throw new Error(o.message);if(n.user){const a=tt(n.user);r({user:a,loading:!1,lastAuthCheck:Date.now()}),Qe("Profile updated successfully!")}}catch(i){throw console.error(" Profile update error:",i.message),r({loading:!1}),Xe(i.message||"Failed to update profile"),i}},uploadAvatar:async s=>{const i=e();if(!i.user)throw new Error("No user logged in");const n=i.user.id,o=s.name.split(".").pop()?.toLowerCase()||"jpg",a=`${n}/${Date.now()}.${o}`,{data:l,error:d}=await W.storage.from("avatars").upload(a,s,{cacheControl:"3600",upsert:!0,contentType:s.type});if(d)throw Xe("Failed to upload image."),d;const{data:c}=W.storage.from("avatars").getPublicUrl(l.path),u=c.publicUrl,{data:h,error:f}=await W.auth.updateUser({data:{avatar_url:u}});if(f)throw Xe("Failed to save avatar to profile."),f;await clientDb.users.updateProfile(n,{avatar_url:u});const m=tt(h.user);return r({user:m,lastAuthCheck:Date.now()}),Qe("Profile photo updated."),u}}),{name:"fanclubz-auth-storage",storage:cn(()=>localStorage),partialize:r=>({isAuthenticated:r.isAuthenticated,user:r.user,token:r.token,initialized:r.initialized,lastAuthCheck:r.lastAuthCheck}),version:5}));typeof window<"u"&&!ui&&(ui=!0,console.log(" Setting up auth state listener..."),W.auth.onAuthStateChange((r,e)=>{const s=Date.now();if(!(hi===r&&s-pi<1e3)){if(hi=r,pi=s,console.log(" Auth state change:",r),r==="SIGNED_OUT")console.log(" User signed out"),ie.setState({isAuthenticated:!1,user:null,token:null,lastAuthCheck:0});else if(r==="TOKEN_REFRESHED"&&e?.user){console.log(" Token refreshed");const i=tt(e.user);ie.setState({user:i,token:e.access_token,lastAuthCheck:s})}}}));const Sr=Ve((r,e)=>({likedPredictions:new Set,likeCounts:{},loading:!1,error:null,initializeLikes:async()=>{try{const{data:{user:s}}=await W.auth.getUser();if(!s){console.log(" No authenticated user, skipping like initialization");return}console.log(" Initializing like store for user:",s.id);const{data:i,error:n}=await W.from("prediction_likes").select("prediction_id").eq("user_id",s.id);n&&console.error(" Error fetching user likes:",n);const{data:o,error:a}=await W.from("predictions").select("id, likes_count");a&&console.error(" Error fetching like counts:",a);const l=new Set(i?.map(c=>c.prediction_id)||[]),d=Object.fromEntries(o?.map(c=>[c.id,c.likes_count||0])||[]);r({likedPredictions:l,likeCounts:d,error:null}),console.log(" Like store initialized successfully:",{likedCount:l.size,totalPredictions:Object.keys(d).length,userLikes:Array.from(l)})}catch(s){console.error(" Error initializing likes:",s),r({error:"Failed to load likes"})}},refreshLikeCounts:async()=>{try{const{data:s,error:i}=await W.from("predictions").select("id, likes_count");if(i){console.error("Error refreshing like counts:",i);return}const n=Object.fromEntries(s?.map(o=>[o.id,o.likes_count||0])||[]);r({likeCounts:n}),console.log(" Like counts refreshed:",Object.keys(n).length,"predictions")}catch(s){console.error("Error refreshing like counts:",s)}},toggleLike:async s=>{const{likedPredictions:i,likeCounts:n}=e(),o=i.has(s),a=n[s]||0,l=new Set(i),d={...n};o?(l.delete(s),d[s]=Math.max(0,a-1)):(l.add(s),d[s]=a+1),r({likedPredictions:l,likeCounts:d,loading:!0});try{const{data:{user:c}}=await W.auth.getUser();if(!c)throw new Error("User not authenticated");if(o){const{error:u}=await W.from("prediction_likes").delete().eq("prediction_id",s).eq("user_id",c.id);if(u)throw u;const{error:h}=await W.from("predictions").update({likes_count:Math.max(0,a-1),updated_at:new Date().toISOString()}).eq("id",s);h&&console.error("Error updating prediction likes count:",h)}else{const{error:u}=await W.from("prediction_likes").insert({prediction_id:s,user_id:c.id,created_at:new Date().toISOString()});if(u&&!u.message.includes("duplicate"))throw u;const{error:h}=await W.from("predictions").update({likes_count:a+1,updated_at:new Date().toISOString()}).eq("id",s);h&&console.error("Error updating prediction likes count:",h)}r({loading:!1,error:null}),console.log(" Like toggled successfully:",{predictionId:s,wasLiked:!o})}catch(c){throw console.error("Error toggling like:",c),r({likedPredictions:i,likeCounts:n,loading:!1,error:"Failed to update like"}),c}},checkIfLiked:s=>e().likedPredictions.has(s),getLikeCount:s=>{const n=e().likeCounts[s];return n!==void 0?n:0},clearError:()=>{r({error:null})},debugLikeState:s=>{const i=e();console.log(` Debug like state for prediction ${s}:`,{isLiked:i.likedPredictions.has(s),likeCount:i.likeCounts[s]||0,allLikedPredictions:Array.from(i.likedPredictions),allLikeCounts:i.likeCounts,loading:i.loading,error:i.error})}}));function ut(){const r=window.location.hostname,e=window.location.protocol;if(console.log(" Environment Detection:"),console.log("  - Hostname:",r),console.log("  - Protocol:",e),console.log("  - VITE_API_URL:","https://fan-club-z.onrender.com"),console.log("  - MODE:","production"),r==="app.fanclubz.app"||r==="fanclubz.app"||r==="www.fanclubz.app"){const s={apiUrl:"https://fan-club-z.onrender.com",socketUrl:"https://fan-club-z.onrender.com",environment:"production",isDevelopment:!1,isProduction:!0};return console.log(" Production environment detected (single service):",s),s}if(r==="dev.fanclubz.app"){const s={apiUrl:"https://fan-club-z.onrender.com",socketUrl:"https://fan-club-z.onrender.com",environment:"staging",isDevelopment:!1,isProduction:!1};return console.log(" Development environment detected (single service):",s),s}if(r.includes("vercel.app")){const s={apiUrl:"https://fan-club-z.onrender.com",socketUrl:"https://fan-club-z.onrender.com",environment:"production",isDevelopment:!1,isProduction:!0};return console.log(" Vercel deployment detected, using single service:",s),s}{const s={apiUrl:"https://fan-club-z.onrender.com",socketUrl:"https://fan-club-z.onrender.com",environment:"production",isDevelopment:!1,isProduction:!0};return console.log(" Using VITE_API_URL:",s),s}}function ec(){return ut().apiUrl}function tc(){const r=ut();return console.log(" Socket URL configuration:",{hostname:window.location.hostname,configuredUrl:r.socketUrl,environment:r.environment,isDevelopment:r.isDevelopment,isProduction:r.isProduction}),r.socketUrl}function sc(){return ut().isDevelopment}function rc(){return ut().isProduction}const ic=Object.freeze(Object.defineProperty({__proto__:null,getApiUrl:ec,getEnvironmentConfig:ut,getSocketUrl:tc,isDevelopment:sc,isProduction:rc},Symbol.toStringTag,{value:"Module"})),Fs=ut().apiUrl,Cr=Ve()(Yl((r,e)=>({commentsByPrediction:{},commentCounts:{},loading:{},errors:{},submitting:{},fetchedPredictions:new Set,lastFetched:{},initialized:!1,initialize:()=>{e().initialized||(console.log(" Initializing unified comment store"),r({initialized:!0}))},initializeCommentCounts:s=>{console.log(" Initializing comment counts:",s),r(i=>({commentCounts:{...i.commentCounts,...s}}))},updateCommentCount:(s,i)=>{if(!s?.trim()){console.warn(" Cannot update comment count: invalid predictionId");return}console.log(` Updating comment count for ${s}: ${i}`),r(n=>({commentCounts:{...n.commentCounts,[s]:i}}))},getCommentCount:s=>{if(!s?.trim())return 0;const i=e(),n=i.commentsByPrediction[s];return n&&Array.isArray(n)?n.length:i.commentCounts[s]!==void 0?i.commentCounts[s]:0},getComments:s=>s?.trim()?e().commentsByPrediction[s]||[]:[],clearError:s=>{s?.trim()&&r(i=>({errors:{...i.errors,[s]:null}}))},fetchComments:async s=>{if(!s?.trim()){console.warn(" Cannot fetch comments: invalid predictionId");return}const i=e(),n=i.lastFetched[s],o=Date.now()-5*60*1e3;if(n&&n>o&&i.commentsByPrediction[s]){console.log(` Using cached comments for prediction ${s} (${i.commentsByPrediction[s]?.length||0} comments)`);return}if(i.loading[s]){console.log(` Already loading comments for prediction ${s}`);return}if(i.fetchedPredictions.has(s)&&!i.errors[s]){console.log(` Comments already fetched for prediction ${s}`);return}console.log(` Fetching comments for prediction ${s}`),r(a=>({loading:{...a.loading,[s]:!0},errors:{...a.errors,[s]:null}}));try{const a=await fetch(`${Fs}/api/v2/social/predictions/${s}/comments`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`API responded with ${a.status}`);const d=(await a.json()).comments||[];console.log(` Loaded ${d.length} comments for prediction ${s}`),r(c=>{const u=new Set(c.fetchedPredictions);return u.add(s),{commentsByPrediction:{...c.commentsByPrediction,[s]:d},commentCounts:{...c.commentCounts,[s]:d.length},fetchedPredictions:u,lastFetched:{...c.lastFetched,[s]:Date.now()},loading:{...c.loading,[s]:!1}}})}catch(a){console.error(" Failed to fetch comments:",a),r(l=>({commentsByPrediction:{...l.commentsByPrediction,[s]:[]},commentCounts:{...l.commentCounts,[s]:0},loading:{...l.loading,[s]:!1},errors:{...l.errors,[s]:"Failed to load comments. Please try again later."}}))}},addComment:async(s,i,n,o)=>{if(!s?.trim())throw new Error("Cannot add comment: invalid predictionId");if(!i?.trim())throw new Error("Comment content cannot be empty");console.log(` Adding comment to prediction ${s}`),r(a=>({submitting:{...a.submitting,[s]:!0},errors:{...a.errors,[s]:null}}));try{const a=await fetch(`${Fs}/api/v2/social/predictions/${s}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:i.trim(),parent_comment_id:n||null,user:o||null})});if(!a.ok)throw new Error(`API responded with ${a.status}`);const l=await a.json();r(d=>{const c=d.commentsByPrediction[s]||[];let u,h;return n?(u=c.map(f=>f.id===n?{...f,replies:[l,...f.replies||[]],replies_count:(f.replies_count||0)+1}:f),h=d.commentCounts[s]||0):(u=[l,...c],h=(d.commentCounts[s]||0)+1),{commentsByPrediction:{...d.commentsByPrediction,[s]:u},commentCounts:{...d.commentCounts,[s]:h},submitting:{...d.submitting,[s]:!1}}}),console.log(` Added comment to prediction ${s}`)}catch(a){throw console.error(" Failed to add comment:",a),r(l=>({submitting:{...l.submitting,[s]:!1},errors:{...l.errors,[s]:"Failed to post comment. Please try again."}})),a}},toggleCommentLike:async(s,i)=>{if(!s?.trim()||!i?.trim()){console.warn(" Cannot toggle comment like: invalid parameters");return}try{r(o=>{const a=o.commentsByPrediction[i]||[],l=d=>d.id===s?{...d,is_liked:!d.is_liked,likes_count:d.is_liked?Math.max(0,d.likes_count-1):d.likes_count+1}:d.replies?{...d,replies:d.replies.map(l)}:d;return{commentsByPrediction:{...o.commentsByPrediction,[i]:a.map(l)}}}),(await fetch(`${Fs}/api/v2/social/comments/${s}/like`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?console.log(" Like synced with server"):console.warn(" Failed to sync like with server, but UI updated optimistically")}catch(n){console.error(" Failed to toggle like:",n)}}}),{name:"unified-comment-store",partialize:r=>({commentCounts:r.commentCounts,initialized:r.initialized})})),Pr=r=>{const e=Cr(),s=p.useMemo(()=>r?.trim()||"",[r]),i=p.useCallback(()=>s?e.fetchComments(s):(console.warn(" Cannot fetch comments: no prediction ID provided"),Promise.resolve()),[e.fetchComments,s]),n=p.useCallback((l,d,c)=>s?e.addComment(s,l,d,c):(console.warn(" Cannot add comment: no prediction ID provided"),Promise.resolve()),[e.addComment,s]),o=p.useCallback(l=>s?e.toggleCommentLike(l,s):(console.warn(" Cannot toggle like: no prediction ID provided"),Promise.resolve()),[e.toggleCommentLike,s]),a=p.useCallback(()=>{s&&e.clearError(s)},[e.clearError,s]);return p.useMemo(()=>s?{comments:e.getComments(s),commentCount:e.getCommentCount(s),isLoading:e.loading[s]||!1,error:e.errors[s]||null,isSubmitting:e.submitting[s]||!1,fetchComments:i,addComment:n,toggleCommentLike:o,clearError:a}:{comments:[],commentCount:0,isLoading:!1,error:null,isSubmitting:!1,fetchComments:i,addComment:n,toggleCommentLike:o,clearError:a},[s,e.commentsByPrediction[s],e.commentCounts[s],e.loading[s],e.errors[s],e.submitting[s],i,n,o,a])};let nc={data:""},oc=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||nc,ac=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,lc=/\/\*[^]*?\*\/|  +/g,fi=/\n+/g,qe=(r,e)=>{let s="",i="",n="";for(let o in r){let a=r[o];o[0]=="@"?o[1]=="i"?s=o+" "+a+";":i+=o[1]=="f"?qe(a,o):o+"{"+qe(a,o[1]=="k"?"":e)+"}":typeof a=="object"?i+=qe(a,e?e.replace(/([^,])+/g,l=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,l):l?l+" "+d:d)):o):a!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=qe.p?qe.p(o,a):o+":"+a+";")}return s+(e&&n?e+"{"+n+"}":n)+i},Ie={},un=r=>{if(typeof r=="object"){let e="";for(let s in r)e+=s+un(r[s]);return e}return r},cc=(r,e,s,i,n)=>{let o=un(r),a=Ie[o]||(Ie[o]=(d=>{let c=0,u=11;for(;c<d.length;)u=101*u+d.charCodeAt(c++)>>>0;return"go"+u})(o));if(!Ie[a]){let d=o!==r?r:(c=>{let u,h,f=[{}];for(;u=ac.exec(c.replace(lc,""));)u[4]?f.shift():u[3]?(h=u[3].replace(fi," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][u[1]]=u[2].replace(fi," ").trim();return f[0]})(r);Ie[a]=qe(n?{["@keyframes "+a]:d}:d,s?"":"."+a)}let l=s&&Ie.g?Ie.g:null;return s&&(Ie.g=Ie[a]),((d,c,u,h)=>{h?c.data=c.data.replace(h,d):c.data.indexOf(d)===-1&&(c.data=u?d+c.data:c.data+d)})(Ie[a],e,i,l),a},dc=(r,e,s)=>r.reduce((i,n,o)=>{let a=e[o];if(a&&a.call){let l=a(s),d=l&&l.props&&l.props.className||/^go/.test(l)&&l;a=d?"."+d:l&&typeof l=="object"?l.props?"":qe(l,""):l===!1?"":l}return i+n+(a??"")},"");function ks(r){let e=this||{},s=r.call?r(e.p):r;return cc(s.unshift?s.raw?dc(s,[].slice.call(arguments,1),e.p):s.reduce((i,n)=>Object.assign(i,n&&n.call?n(e.p):n),{}):s,oc(e.target),e.g,e.o,e.k)}let hn,or,ar;ks.bind({g:1});let Le=ks.bind({k:1});function uc(r,e,s,i){qe.p=e,hn=r,or=s,ar=i}function Je(r,e){let s=this||{};return function(){let i=arguments;function n(o,a){let l=Object.assign({},o),d=l.className||n.className;s.p=Object.assign({theme:or&&or()},l),s.o=/ *go\d+/.test(d),l.className=ks.apply(s,i)+(d?" "+d:""),e&&(l.ref=a);let c=r;return r[0]&&(c=l.as||r,delete l.as),ar&&c[0]&&ar(l),hn(c,l)}return e?e(n):n}}var hc=r=>typeof r=="function",us=(r,e)=>hc(r)?r(e):r,pc=(()=>{let r=0;return()=>(++r).toString()})(),pn=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),fc=20,Er="default",fn=(r,e)=>{let{toastLimit:s}=r.settings;switch(e.type){case 0:return{...r,toasts:[e.toast,...r.toasts].slice(0,s)};case 1:return{...r,toasts:r.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:i}=e;return fn(r,{type:r.toasts.find(a=>a.id===i.id)?1:0,toast:i});case 3:let{toastId:n}=e;return{...r,toasts:r.toasts.map(a=>a.id===n||n===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...r,pausedAt:e.time};case 6:let o=e.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+o}))}}},as=[],mn={toasts:[],pausedAt:void 0,settings:{toastLimit:fc}},Te={},gn=(r,e=Er)=>{Te[e]=fn(Te[e]||mn,r),as.forEach(([s,i])=>{s===e&&i(Te[e])})},xn=r=>Object.keys(Te).forEach(e=>gn(r,e)),mc=r=>Object.keys(Te).find(e=>Te[e].toasts.some(s=>s.id===r)),Ns=(r=Er)=>e=>{gn(e,r)},gc={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},xc=(r={},e=Er)=>{let[s,i]=p.useState(Te[e]||mn),n=p.useRef(Te[e]);p.useEffect(()=>(n.current!==Te[e]&&i(Te[e]),as.push([e,i]),()=>{let a=as.findIndex(([l])=>l===e);a>-1&&as.splice(a,1)}),[e]);let o=s.toasts.map(a=>{var l,d,c;return{...r,...r[a.type],...a,removeDelay:a.removeDelay||((l=r[a.type])==null?void 0:l.removeDelay)||r?.removeDelay,duration:a.duration||((d=r[a.type])==null?void 0:d.duration)||r?.duration||gc[a.type],style:{...r.style,...(c=r[a.type])==null?void 0:c.style,...a.style}}});return{...s,toasts:o}},bc=(r,e="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...s,id:s?.id||pc()}),Kt=r=>(e,s)=>{let i=bc(e,r,s);return Ns(i.toasterId||mc(i.id))({type:2,toast:i}),i.id},se=(r,e)=>Kt("blank")(r,e);se.error=Kt("error");se.success=Kt("success");se.loading=Kt("loading");se.custom=Kt("custom");se.dismiss=(r,e)=>{let s={type:3,toastId:r};e?Ns(e)(s):xn(s)};se.dismissAll=r=>se.dismiss(void 0,r);se.remove=(r,e)=>{let s={type:4,toastId:r};e?Ns(e)(s):xn(s)};se.removeAll=r=>se.remove(void 0,r);se.promise=(r,e,s)=>{let i=se.loading(e.loading,{...s,...s?.loading});return typeof r=="function"&&(r=r()),r.then(n=>{let o=e.success?us(e.success,n):void 0;return o?se.success(o,{id:i,...s,...s?.success}):se.dismiss(i),n}).catch(n=>{let o=e.error?us(e.error,n):void 0;o?se.error(o,{id:i,...s,...s?.error}):se.dismiss(i)}),r};var yc=1e3,vc=(r,e="default")=>{let{toasts:s,pausedAt:i}=xc(r,e),n=p.useRef(new Map).current,o=p.useCallback((h,f=yc)=>{if(n.has(h))return;let m=setTimeout(()=>{n.delete(h),a({type:4,toastId:h})},f);n.set(h,m)},[]);p.useEffect(()=>{if(i)return;let h=Date.now(),f=s.map(m=>{if(m.duration===1/0)return;let x=(m.duration||0)+m.pauseDuration-(h-m.createdAt);if(x<0){m.visible&&se.dismiss(m.id);return}return setTimeout(()=>se.dismiss(m.id,e),x)});return()=>{f.forEach(m=>m&&clearTimeout(m))}},[s,i,e]);let a=p.useCallback(Ns(e),[e]),l=p.useCallback(()=>{a({type:5,time:Date.now()})},[a]),d=p.useCallback((h,f)=>{a({type:1,toast:{id:h,height:f}})},[a]),c=p.useCallback(()=>{i&&a({type:6,time:Date.now()})},[i,a]),u=p.useCallback((h,f)=>{let{reverseOrder:m=!1,gutter:x=8,defaultPosition:g}=f||{},b=s.filter(j=>(j.position||g)===(h.position||g)&&j.height),w=b.findIndex(j=>j.id===h.id),y=b.filter((j,S)=>S<w&&j.visible).length;return b.filter(j=>j.visible).slice(...m?[y+1]:[0,y]).reduce((j,S)=>j+(S.height||0)+x,0)},[s]);return p.useEffect(()=>{s.forEach(h=>{if(h.dismissed)o(h.id,h.removeDelay);else{let f=n.get(h.id);f&&(clearTimeout(f),n.delete(h.id))}})},[s,o]),{toasts:s,handlers:{updateHeight:d,startPause:l,endPause:c,calculateOffset:u}}},wc=Le`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,jc=Le`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,kc=Le`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Nc=Je("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${wc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${jc} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${kc} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_c=Le`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Sc=Je("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${_c} 1s linear infinite;
`,Cc=Le`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Pc=Le`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Ec=Je("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Cc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Pc} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Tc=Je("div")`
  position: absolute;
`,Ac=Je("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Ic=Le`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,$c=Je("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Ic} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Rc=({toast:r})=>{let{icon:e,type:s,iconTheme:i}=r;return e!==void 0?typeof e=="string"?p.createElement($c,null,e):e:s==="blank"?null:p.createElement(Ac,null,p.createElement(Sc,{...i}),s!=="loading"&&p.createElement(Tc,null,s==="error"?p.createElement(Nc,{...i}):p.createElement(Ec,{...i})))},Oc=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Lc=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,zc="0%{opacity:0;} 100%{opacity:1;}",Dc="0%{opacity:1;} 100%{opacity:0;}",Uc=Je("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Mc=Je("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Fc=(r,e)=>{let s=r.includes("top")?1:-1,[i,n]=pn()?[zc,Dc]:[Oc(s),Lc(s)];return{animation:e?`${Le(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Le(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Bc=p.memo(({toast:r,position:e,style:s,children:i})=>{let n=r.height?Fc(r.position||e||"top-center",r.visible):{opacity:0},o=p.createElement(Rc,{toast:r}),a=p.createElement(Mc,{...r.ariaProps},us(r.message,r));return p.createElement(Uc,{className:r.className,style:{...n,...s,...r.style}},typeof i=="function"?i({icon:o,message:a}):p.createElement(p.Fragment,null,o,a))});uc(p.createElement);var Wc=({id:r,className:e,style:s,onHeightUpdate:i,children:n})=>{let o=p.useCallback(a=>{if(a){let l=()=>{let d=a.getBoundingClientRect().height;i(r,d)};l(),new MutationObserver(l).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[r,i]);return p.createElement("div",{ref:o,className:e,style:s},n)},Hc=(r,e)=>{let s=r.includes("top"),i=s?{top:0}:{bottom:0},n=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:pn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(s?1:-1)}px)`,...i,...n}},qc=ks`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,rs=16,Vc=({reverseOrder:r,position:e="top-center",toastOptions:s,gutter:i,children:n,toasterId:o,containerStyle:a,containerClassName:l})=>{let{toasts:d,handlers:c}=vc(s,o);return p.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:rs,left:rs,right:rs,bottom:rs,pointerEvents:"none",...a},className:l,onMouseEnter:c.startPause,onMouseLeave:c.endPause},d.map(u=>{let h=u.position||e,f=c.calculateOffset(u,{reverseOrder:r,gutter:i,defaultPosition:e}),m=Hc(h,f);return p.createElement(Wc,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?qc:"",style:m},u.type==="custom"?us(u.message,u):n?n(u):p.createElement(Bc,{toast:u,position:h}))}))},G=se;const rt=class rt{constructor(){ee(this,"scrollPositions",new Map);ee(this,"currentRoute","");ee(this,"scrollTimeout",null);ee(this,"isNavigating",!1);ee(this,"restoreTimeout",null);typeof window<"u"&&(this.currentRoute=window.location.pathname,this.setupNavigationListeners())}static getInstance(){return rt.instance||(rt.instance=new rt),rt.instance}setupNavigationListeners(){let e=window.location.pathname;new MutationObserver(()=>{const i=window.location.pathname;i!==e&&(console.log(` Route change detected: ${e}  ${i}`),this.handleRouteChange(e,i),e=i)}).observe(document.documentElement,{subtree:!0,childList:!0}),window.addEventListener("popstate",()=>{console.log(" Browser navigation detected"),this.isNavigating=!0,setTimeout(()=>{this.restoreScrollPosition(window.location.pathname),this.isNavigating=!1},100)}),window.addEventListener("beforeunload",()=>{this.saveCurrentScrollPosition()})}handleRouteChange(e,s){e!==s&&(this.saveScrollPosition(e),this.currentRoute=s,this.scheduleScrollRestore(s))}scheduleScrollRestore(e){this.restoreTimeout&&clearTimeout(this.restoreTimeout),this.restoreTimeout=window.setTimeout(()=>{this.isNavigating||this.restoreScrollPosition(e)},150)}saveScrollPosition(e){const s=e||this.currentRoute,i=this.getCurrentScrollPosition();i>50&&(this.scrollPositions.set(s,{scrollY:i,timestamp:Date.now(),route:s}),console.log(` Saved scroll position for ${s}: ${i}px`))}saveCurrentScrollPosition(){this.saveScrollPosition(this.currentRoute)}restoreScrollPosition(e){const s=this.scrollPositions.get(e);return s?Date.now()-s.timestamp<10*60*1e3?(console.log(` Restoring scroll position for ${e}: ${s.scrollY}px`),this.scrollToPosition(s.scrollY,"smooth"),!0):(console.log(` Scroll position for ${e} is too old, ignoring`),this.scrollPositions.delete(e),!1):(console.log(` No saved scroll position for ${e}`),!1)}getCurrentScrollPosition(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}scrollToPosition(e,s="smooth"){try{requestAnimationFrame(()=>{window.scrollTo({top:e,left:0,behavior:s}),s==="smooth"&&setTimeout(()=>{const i=this.getCurrentScrollPosition();Math.abs(i-e)>100&&window.scrollTo(0,e)},300)})}catch(i){console.warn("Scroll API failed, using fallback:",i),window.scrollTo(0,e),document.documentElement.scrollTop=e,document.body.scrollTop=e}}scrollToTop(e={}){const{behavior:s="smooth",delay:i=0}=e;this.scrollTimeout&&window.clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.scrollToPosition(0,s),this.scrollTimeout=null},i)}scrollToElement(e,s={}){const{behavior:i="smooth",offset:n=0}=s;this.scrollTimeout&&window.clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{const o=document.getElementById(e);if(o){const a=o.offsetTop-n;this.scrollToPosition(a,i)}this.scrollTimeout=null},50)}clearOldPositions(){const e=Date.now(),s=10*60*1e3;for(const[i,n]of this.scrollPositions.entries())e-n.timestamp>s&&(this.scrollPositions.delete(i),console.log(` Cleared old scroll position for ${i}`))}markNavigationAsIntentional(){this.isNavigating=!0,setTimeout(()=>{this.isNavigating=!1},500)}getDebugInfo(){return{currentRoute:this.currentRoute,savedPositions:Array.from(this.scrollPositions.entries()).map(([e,s])=>({route:e,scrollY:s.scrollY,age:Date.now()-s.timestamp})),isNavigating:this.isNavigating}}destroy(){this.scrollTimeout&&window.clearTimeout(this.scrollTimeout),this.restoreTimeout&&window.clearTimeout(this.restoreTimeout),this.scrollPositions.clear()}};ee(rt,"instance");let lr=rt;const _s=lr.getInstance(),yt=r=>{_s.scrollToTop(r)},lt=r=>{_s.saveScrollPosition(r)},jt=()=>{_s.markNavigationAsIntentional()};setInterval(()=>{_s.clearOldPositions()},5*60*1e3);const Gc=({type:r,message:e,duration:s=5e3,onClose:i,show:n=!0})=>{const[o,a]=p.useState(n);if(p.useEffect(()=>{a(n)},[n]),p.useEffect(()=>{if(o&&s>0){const c=setTimeout(()=>{a(!1),i?.()},s);return()=>clearTimeout(c)}},[o,s,i]),!o)return null;const l=()=>{switch(r){case"success":return t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},d=()=>{const c={position:"fixed",top:"20px",right:"20px",zIndex:9999,padding:"16px 20px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.15)",display:"flex",alignItems:"center",gap:"12px",maxWidth:"400px",minWidth:"300px",animation:"slideIn 0.3s ease-out",border:"1px solid",backdropFilter:"blur(10px)",fontSize:"14px",fontWeight:"600",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'};switch(r){case"success":return{...c,backgroundColor:"rgba(16, 185, 129, 0.95)",color:"white",borderColor:"rgba(16, 185, 129, 0.3)"};case"error":return{...c,backgroundColor:"rgba(239, 68, 68, 0.95)",color:"white",borderColor:"rgba(239, 68, 68, 0.3)"};case"warning":return{...c,backgroundColor:"rgba(245, 158, 11, 0.95)",color:"white",borderColor:"rgba(245, 158, 11, 0.3)"};case"info":return{...c,backgroundColor:"rgba(59, 130, 246, 0.95)",color:"white",borderColor:"rgba(59, 130, 246, 0.3)"}}};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
          
          @keyframes slideOut {
            from {
              transform: translateX(0);
              opacity: 1;
            }
            to {
              transform: translateX(100%);
              opacity: 0;
            }
          }
        `}),t.jsxs("div",{style:d(),children:[t.jsx("div",{style:{flexShrink:0},children:l()}),t.jsx("div",{style:{flex:1},children:e})]})]})},bn=()=>{const{notifications:r,removeNotification:e}=_r();return t.jsx(t.Fragment,{children:r.map((s,i)=>t.jsx(Gc,{type:s.type,message:s.message,duration:s.duration,onClose:()=>e(s.id),show:!0},s.id))})};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Jc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),z=(r,e)=>{const s=p.forwardRef(({color:i="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:l="",children:d,...c},u)=>p.createElement("svg",{ref:u,...Jc,width:n,height:n,stroke:i,strokeWidth:a?Number(o)*24/Number(n):o,className:["lucide",`lucide-${Kc(r)}`,l].join(" "),...c},[...e.map(([h,f])=>p.createElement(h,f)),...Array.isArray(d)?d:[d]]));return s.displayName=`${r}`,s};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=z("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=z("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=z("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=z("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=z("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=z("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=z("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=z("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=z("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=z("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=z("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=z("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=z("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=z("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=z("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=z("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=z("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=z("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=z("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=z("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=z("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=z("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=z("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=z("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=z("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=z("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=z("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=z("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=z("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dd=z("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=z("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=z("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=z("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=z("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=z("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=z("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=z("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=z("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=z("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=z("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=z("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=z("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=z("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=z("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=z("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=z("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=z("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=z("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=z("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=z("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=z("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=z("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=z("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=z("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=z("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),it=class it{constructor(){ee(this,"deferredPrompt",null);ee(this,"isInstalled",!1);this.init()}static getInstance(){return it.instance||(it.instance=new it),it.instance}init(){this.registerServiceWorker(),this.checkInstallStatus(),this.setupInstallPrompt()}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered successfully:",e),e.addEventListener("updatefound",()=>{const s=e.installing;s&&s.addEventListener("statechange",()=>{s.state==="installed"&&navigator.serviceWorker.controller&&this.showUpdateAvailable()})})}catch(e){console.error("Service Worker registration failed:",e)}}checkInstallStatus(){this.isInstalled=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.deferredPrompt=e,window.dispatchEvent(new CustomEvent("pwa-installable",{detail:{canInstall:!0}}))}),window.addEventListener("appinstalled",()=>{this.isInstalled=!0,this.deferredPrompt=null,this.trackInstallation(),window.dispatchEvent(new CustomEvent("pwa-installed"))})}async promptInstall(){if(!this.deferredPrompt)return!1;try{await this.deferredPrompt.prompt();const e=await this.deferredPrompt.userChoice;return this.deferredPrompt=null,e.outcome==="accepted"}catch(e){return console.error("Install prompt failed:",e),!1}}canInstall(){return!!this.deferredPrompt&&!this.isInstalled}isAppInstalled(){return this.isInstalled}isIOSDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}isAndroidDevice(){return/Android/.test(navigator.userAgent)}showUpdateAvailable(){const e=new CustomEvent("pwa-update-available",{detail:{message:"A new version of Fan Club Z is available. Refresh to update.",action:()=>window.location.reload()}});window.dispatchEvent(e)}trackInstallation(){typeof gtag<"u"&&gtag("event","pwa_install",{event_category:"engagement",event_label:"app_install"})}async requestNotificationPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?!1:await Notification.requestPermission()==="granted":!1}async subscribeToPushNotifications(){try{const e=await navigator.serviceWorker.ready,s=await e.pushManager.getSubscription();if(s)return s;const i=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array({}.VITE_VAPID_PUBLIC_KEY||"")});return await this.sendSubscriptionToServer(i),i}catch(e){return console.error("Push subscription failed:",e),null}}urlBase64ToUint8Array(e){const s="=".repeat((4-e.length%4)%4),i=(e+s).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(i),o=new Uint8Array(n.length);for(let a=0;a<n.length;++a)o[a]=n.charCodeAt(a);return o}async sendSubscriptionToServer(e){try{await fetch("/api/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(s){console.error("Failed to send subscription to server:",s)}}};ee(it,"instance");let dr=it;const me=dr.getInstance(),wd=()=>{const[r,e]=p.useState(!1),[s,i]=p.useState(!1);p.useEffect(()=>{const l=()=>{if(me.isAppInstalled()){e(!1);return}const u=me.isIOSDevice(),h=localStorage.getItem(u?"ios-install-dismissed":"pwa-banner-dismissed"),f=h?parseInt(h):0,m=(Date.now()-f)/(24*60*60*1e3),g=!h||m>(u?3:1),b=sessionStorage.getItem("pwa-banner-session-dismissed");g&&!b&&(u?setTimeout(()=>e(!0),5e3):i(me.canInstall()))},d=()=>{i(!0),localStorage.getItem("pwa-banner-dismissed")||e(!0)},c=()=>{e(!1),i(!1)};return window.addEventListener("pwa-installable",d),window.addEventListener("pwa-installed",c),l(),()=>{window.removeEventListener("pwa-installable",d),window.removeEventListener("pwa-installed",c)}},[]);const n=async()=>{me.isIOSDevice()?(window.dispatchEvent(new CustomEvent("show-ios-install")),e(!1)):(await me.promptInstall()||localStorage.setItem("pwa-banner-dismissed",Date.now().toString()),e(!1))},o=()=>{e(!1);const l=me.isIOSDevice()?"ios-install-dismissed":"pwa-banner-dismissed";localStorage.setItem(l,Date.now().toString()),sessionStorage.setItem("pwa-banner-session-dismissed","true")};if(!r)return null;const a=me.isIOSDevice();return t.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-purple-500 to-teal-600 text-white shadow-lg animate-in slide-in-from-top duration-300",children:t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 max-w-md mx-auto",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"bg-white/20 p-2 rounded-lg backdrop-blur-sm",children:t.jsx(Nn,{className:"w-5 h-5"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-semibold text-sm",children:a?"Add to Home Screen":"Install Fan Club Z"}),t.jsx("p",{className:"text-xs text-green-100",children:a?"Get quick access and offline features":"Faster loading  Offline access  Notifications"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:n,className:"bg-white text-teal-600 px-3 py-1.5 rounded-md text-sm font-medium hover:bg-teal-50 active:bg-teal-100 transition-colors flex items-center space-x-1 shadow-sm",children:[t.jsx(ps,{className:"w-4 h-4"}),t.jsx("span",{children:a?"How To":"Install"})]}),t.jsx("button",{onClick:o,className:"text-green-100 hover:text-white transition-colors p-1 rounded","aria-label":"Dismiss install banner",children:t.jsx(De,{className:"w-5 h-5"})})]})]})})},jd=({isOpen:r,onClose:e})=>r?t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex flex-col ios-install-modal",onClick:e,style:{zIndex:1e4},children:t.jsx("div",{className:"flex-1 flex items-center justify-center p-4 pb-24",children:t.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200 flex flex-col max-h-[calc(100vh-8rem)]",onClick:s=>s.stopPropagation(),style:{zIndex:10001},children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-center text-white relative rounded-t-2xl flex-shrink-0",children:[t.jsx("button",{onClick:e,className:"absolute top-3 right-3 text-white/80 hover:text-white transition-colors p-1 rounded-full hover:bg-white/20","aria-label":"Close modal",children:t.jsx(De,{className:"w-5 h-5"})}),t.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-white/20 rounded-full mb-3",children:t.jsx(Nn,{className:"w-6 h-6"})}),t.jsx("h2",{className:"text-lg font-bold mb-1",children:"Install Fan Club Z"}),t.jsx("p",{className:"text-green-100 text-sm",children:"Get the full app experience with offline access and notifications"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain",children:t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"1"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:"Tap the Share button"}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[t.jsx(cr,{className:"w-4 h-4"}),t.jsx("span",{children:"Usually found at the bottom of Safari"})]})]})]}),t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"2"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:'Select "Add to Home Screen"'}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[t.jsx(ct,{className:"w-4 h-4"}),t.jsx("span",{children:"Scroll down in the share menu to find this option"})]})]})]}),t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"3"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:'Tap "Add" to confirm'}),t.jsx("p",{className:"text-sm text-gray-600",children:"Fan Club Z will appear on your home screen like a native app"})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-3 text-base",children:"Why install?"}),t.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[t.jsx("li",{children:" Faster loading and smoother experience"}),t.jsx("li",{children:" Works offline for viewing your predictions"}),t.jsx("li",{children:" Push notifications for important updates"}),t.jsx("li",{children:" Easy access from your home screen"})]})]}),t.jsx("div",{className:"h-4"})]})}),t.jsx("div",{className:"border-t border-gray-100 p-4 flex-shrink-0 rounded-b-2xl",children:t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors text-base",children:"Maybe Later"}),t.jsx("button",{onClick:()=>{e(),localStorage.setItem("ios-install-dismissed",Date.now().toString())},className:"flex-1 px-4 py-3 bg-teal-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-base",children:"Got It!"})]})})]})})}):null,kd=({onInstall:r,onDismiss:e})=>{const[s,i]=p.useState(!1);p.useEffect(()=>{const a=setTimeout(()=>i(!0),100);return()=>clearTimeout(a)},[]);const n=()=>{i(!1),setTimeout(r,300)},o=()=>{i(!1),setTimeout(e,300)};return t.jsx("div",{className:`
      fixed inset-x-4 top-20 max-w-sm mx-auto transition-all duration-300 ease-out pwa-install-prompt
      ${s?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-4"}
    `,style:{zIndex:1e4},children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:t.jsx(ps,{className:"w-4 h-4"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-sm",children:"Install Fan Club Z"}),t.jsx("p",{className:"text-xs text-green-100",children:"Get the full app experience"})]})]}),t.jsx("button",{onClick:o,className:"text-green-100 hover:text-white transition-colors p-1 rounded",children:t.jsx(De,{className:"w-4 h-4"})})]})}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-400 to-teal-500 rounded-lg flex items-center justify-center",children:t.jsx(Sn,{className:"w-4 h-4 text-teal-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Faster Performance"}),t.jsx("p",{className:"text-xs text-gray-600",children:"Lightning-fast loading and smooth animations"})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx(yn,{className:"w-4 h-4 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),t.jsx("p",{className:"text-xs text-gray-600",children:"Get notified about prediction results and updates"})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx(Ss,{className:"w-4 h-4 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Offline Access"}),t.jsx("p",{className:"text-xs text-gray-600",children:"View your predictions even without internet"})]})]})]}),t.jsxs("div",{className:"p-4 pt-0 flex space-x-2",children:[t.jsx("button",{onClick:o,className:"flex-1 py-2.5 px-4 text-gray-700 bg-gray-100 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors",children:"Maybe Later"}),t.jsxs("button",{onClick:n,className:"flex-1 py-2.5 px-4 bg-teal-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(ps,{className:"w-4 h-4"}),t.jsx("span",{children:"Install"})]})]})]})})},Nd=()=>{const[r,e]=p.useState(!1),[s,i]=p.useState(0);p.useEffect(()=>{let l=0;const d=["click","scroll","touchstart","keydown"],c=()=>{l++,i(l),l>=5&&!localStorage.getItem("install-prompt-shown")&&n()};return d.forEach(u=>{document.addEventListener(u,c,{passive:!0})}),()=>{d.forEach(u=>{document.removeEventListener(u,c)})}},[]);const n=()=>{if(me.isAppInstalled())return;const l=localStorage.getItem("install-prompt-dismissed"),d=l?parseInt(l):0,c=24*60*60*1e3;if(!l||Date.now()-d>c){const u=Date.now()-parseInt(localStorage.getItem("session-start")||"0"),h=localStorage.getItem("has-created-prediction"),f=localStorage.getItem("has-placed-prediction");u>3e4&&(h||f)&&(e(!0),localStorage.setItem("install-prompt-shown","true"))}},o=async()=>{me.isIOSDevice()?window.dispatchEvent(new CustomEvent("show-ios-install")):await me.promptInstall()||localStorage.setItem("install-prompt-dismissed",Date.now().toString()),e(!1)},a=()=>{e(!1),localStorage.setItem("install-prompt-dismissed",Date.now().toString())};return r?t.jsx(kd,{onInstall:o,onDismiss:a}):null},_d=({isVisible:r,onUpdate:e,onDismiss:s})=>{const[i,n]=p.useState(!1),o=()=>{n(!0),setTimeout(s,300)},a=()=>{n(!0),setTimeout(e,200)};return!r&&!i?null:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`
        fixed inset-0 bg-black/10 backdrop-blur-sm transition-opacity duration-300 update-notification
        ${r&&!i?"opacity-100":"opacity-0"}
      `,style:{zIndex:1e4}}),t.jsx("div",{className:`
        fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 update-notification
        w-[calc(100vw-32px)] max-w-sm max-h-[90vh] overflow-y-auto
        transition-all duration-300 ease-out
        ${r&&!i?"opacity-100 scale-100":"opacity-0 scale-95"}
      `,style:{zIndex:10001},children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white relative",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:t.jsx(Bt,{className:"w-5 h-5"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"font-bold text-base flex items-center space-x-2",children:[t.jsx("span",{children:"Update Available!"}),t.jsx(Ss,{className:"w-4 h-4"})]}),t.jsx("p",{className:"text-sm text-green-100",children:"New features and improvements ready"})]})]}),t.jsx("button",{onClick:o,className:"absolute top-3 right-3 text-green-100 hover:text-white transition-colors p-1 rounded-full hover:bg-white/10","aria-label":"Dismiss update notification",children:t.jsx(De,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[" ",t.jsx("strong",{children:"What's New:"})]}),t.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 ml-2",children:[t.jsx("li",{children:" Improved performance and stability"}),t.jsx("li",{children:" Enhanced user interface"}),t.jsx("li",{children:" Bug fixes and optimizations"})]})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs("button",{onClick:a,className:"flex-[2] bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold text-sm hover:bg-green-700 active:bg-green-800 transition-colors flex items-center justify-center space-x-2 shadow-lg",children:[t.jsx(Bt,{className:"w-4 h-4"}),t.jsx("span",{children:"Update Now"})]}),t.jsx("button",{onClick:o,className:"flex-1 py-3 px-4 text-gray-600 hover:text-gray-800 transition-colors text-sm font-medium hover:bg-gray-50 rounded-xl border border-gray-200",children:"Later"})]})]})]})})]})},Sd=()=>{const[r,e]=p.useState(!1),[s,i]=p.useState(!1);p.useEffect(()=>{localStorage.getItem("session-start")||localStorage.setItem("session-start",Date.now().toString());const a=()=>{e(!0)},l=f=>{i(!0)},d=()=>{setTimeout(async()=>{const f=localStorage.getItem("user-has-interacted"),m=localStorage.getItem("notification-permission-requested");if(f&&!m){const x=await me.requestNotificationPermission();localStorage.setItem("notification-permission-requested","true"),x&&await me.subscribeToPushNotifications()}},15e3)};window.addEventListener("show-ios-install",a),window.addEventListener("pwa-update-available",l);const c=()=>{localStorage.setItem("user-has-interacted","true"),d()},u=["click","scroll","touchstart"];return u.forEach(f=>{document.addEventListener(f,c,{once:!0,passive:!0})}),(()=>{const f=parseInt(localStorage.getItem("visit-count")||"0")+1;localStorage.setItem("visit-count",f.toString()),localStorage.setItem("last-visit",Date.now().toString()),f>1&&localStorage.setItem("is-returning-user","true")})(),()=>{window.removeEventListener("show-ios-install",a),window.removeEventListener("pwa-update-available",l),u.forEach(f=>{document.removeEventListener(f,c)})}},[]);const n=()=>{typeof gtag<"u"&&gtag("event","pwa_update_accepted",{event_category:"engagement",event_label:"app_update"}),window.location.reload()},o=()=>{i(!1),typeof gtag<"u"&&gtag("event","pwa_update_dismissed",{event_category:"engagement",event_label:"app_update"})};return t.jsxs(t.Fragment,{children:[t.jsx(wd,{}),t.jsx(Nd,{}),t.jsx(jd,{isOpen:r,onClose:()=>e(!1)}),t.jsx(_d,{isVisible:s,onUpdate:n,onDismiss:o})]})};let Cd=class extends p.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("PageWrapper Error Boundary caught an error:",e,s)}render(){return this.state.hasError?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"text-center max-w-md",children:[t.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Something went wrong"}),t.jsx("p",{className:"text-gray-600 mb-4",children:this.state.error?.message||"An unexpected error occurred while loading this page."}),t.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:void 0}),this.props.onRetry()},className:"bg-teal-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Try Again"})]})}):this.props.children}};const Pd=({title:r="Loading..."})=>t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:r})]})}),ze=({children:r,title:e="Loading...",fallback:s})=>{const[i,n]=re.useState(0),o=()=>{n(a=>a+1)};return t.jsx(Cd,{onRetry:o,children:t.jsx(p.Suspense,{fallback:s||t.jsx(Pd,{title:e}),children:t.jsx("div",{children:r},i)})})},Ed=()=>{const[r,e]=p.useState(()=>{try{const u=localStorage.getItem("fcz_onboarding_state_v3");return u?JSON.parse(u):{isActive:!1,currentStep:0,completed:!1,skipped:!1,userPreferences:{hasSeenOnboarding:!1,preferredTourStyle:"full",completedSteps:[]}}}catch{return{isActive:!1,currentStep:0,completed:!1,skipped:!1,userPreferences:{hasSeenOnboarding:!1,preferredTourStyle:"full",completedSteps:[]}}}}),[s,i]=p.useState(null),n=p.useCallback(u=>{e(h=>{const f=typeof u=="function"?u(h):u,m={...h,...f};try{localStorage.setItem("fcz_onboarding_state_v3",JSON.stringify(m))}catch(x){console.warn("Failed to save onboarding state:",x)}return m})},[]),o=p.useCallback(u=>{i(u),n({isActive:!0,currentStep:0,completed:!1,skipped:!1})},[n]),a=p.useCallback(async()=>{if(!s)return;const u=s.steps[r.currentStep];if(u?.onNext)try{await u.onNext()}catch(h){console.warn("Step onNext handler failed:",h)}n(h=>{const f=h.currentStep>=(s?.steps.length||0)-1,m=u?.id?[...h.userPreferences.completedSteps,u.id]:h.userPreferences.completedSteps;return f?{isActive:!1,completed:!0,userPreferences:{...h.userPreferences,hasSeenOnboarding:!0,completedSteps:m}}:{currentStep:h.currentStep+1,userPreferences:{...h.userPreferences,completedSteps:m}}})},[s,r.currentStep,n]),l=p.useCallback(async()=>{const u=s?.steps[r.currentStep];if(u?.onPrev)try{await u.onPrev()}catch(h){console.warn("Step onPrev handler failed:",h)}r.currentStep>0&&n(h=>({currentStep:Math.max(0,h.currentStep-1)}))},[s,r.currentStep,n]),d=p.useCallback(()=>{n(u=>({isActive:!1,skipped:!0,userPreferences:{...u.userPreferences,hasSeenOnboarding:!0,preferredTourStyle:"minimal"}}))},[n]),c=p.useCallback(()=>{try{localStorage.removeItem("fcz_onboarding_state_v3"),e({isActive:!1,currentStep:0,completed:!1,skipped:!1,userPreferences:{hasSeenOnboarding:!1,preferredTourStyle:"full",completedSteps:[]}})}catch(u){console.warn("Failed to reset onboarding state:",u)}},[]);return{state:r,config:s,startOnboarding:o,nextStep:a,prevStep:l,skipOnboarding:d,resetOnboarding:c}},Td=(r,e,s="auto")=>{const i={width:window.innerWidth,height:window.innerHeight},n={top:44,bottom:100,left:16,right:16},o=16,a={top:{x:Math.max(n.left,Math.min(r.left+(r.width-e.width)/2,i.width-e.width-n.right)),y:Math.max(n.top,r.top-e.height-o)},bottom:{x:Math.max(n.left,Math.min(r.left+(r.width-e.width)/2,i.width-e.width-n.right)),y:Math.min(i.height-e.height-n.bottom,r.bottom+o)},left:{x:Math.max(n.left,r.left-e.width-o),y:Math.max(n.top,Math.min(r.top+(r.height-e.height)/2,i.height-e.height-n.bottom))},right:{x:Math.min(i.width-e.width-n.right,r.right+o),y:Math.max(n.top,Math.min(r.top+(r.height-e.height)/2,i.height-e.height-n.bottom))},center:{x:(i.width-e.width)/2,y:(i.height-e.height)/2}};if(s!=="auto")return a[s]||a.center;const l={top:r.top-n.top,bottom:i.height-r.bottom-n.bottom,left:r.left-n.left,right:i.width-r.right-n.right},d={top:l.top>=e.height+o,bottom:l.bottom>=e.height+o,left:l.left>=e.width+o,right:l.right>=e.width+o};return d.bottom?a.bottom:d.top?a.top:d.right&&e.width<300?a.right:d.left&&e.width<300?a.left:a.center},Ad=({step:r,position:e,onNext:s,onPrev:i,onSkip:n,isFirst:o,isLast:a,stepNumber:l,totalSteps:d,canSkip:c})=>{const u=p.useCallback(()=>{console.log("Next button clicked, calling onNext"),s()},[s]),h=p.useCallback(()=>{console.log("Previous button clicked, calling onPrev"),i()},[i]),f=p.useCallback(()=>{console.log("Skip button clicked, calling onSkip"),n()},[n]);return t.jsxs(T.div,{className:"fixed bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden max-w-sm z-[25000]",style:{left:e.x,top:e.y,width:"min(calc(100vw - 32px), 380px)"},initial:{scale:.8,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:10},transition:{duration:.2,ease:"easeOut"},children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[r.icon&&t.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:r.icon}),t.jsx("h3",{className:"font-semibold text-lg",children:r.title})]}),c&&t.jsx("button",{onClick:f,className:"p-1 rounded-lg hover:bg-white/10 transition-colors","aria-label":"Skip tour",children:t.jsx(De,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsx("div",{className:"flex-1 bg-white/20 rounded-full h-2",children:t.jsx("div",{className:"bg-white rounded-full h-2 transition-all duration-300",style:{width:`${(l+1)/d*100}%`}})}),t.jsxs("span",{className:"text-xs font-medium",children:[l+1," of ",d]})]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("p",{className:"text-gray-700 text-sm leading-relaxed mb-4",children:r.description}),t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("button",{onClick:h,disabled:o,className:"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-100 text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200 transition-colors text-sm font-medium min-w-[80px] justify-center",children:[t.jsx(Ct,{className:"w-4 h-4"}),"Previous"]}),t.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:d},(m,x)=>t.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${x===l?"bg-teal-500":"bg-gray-200"}`},x))}),t.jsx("button",{onClick:u,className:"flex items-center gap-1 px-4 py-2 rounded-xl bg-teal-500 text-white hover:bg-teal-600 transition-colors text-sm font-medium min-w-[80px] justify-center",children:a?t.jsxs(t.Fragment,{children:[t.jsx(Ft,{className:"w-4 h-4"}),"Finish"]}):t.jsxs(t.Fragment,{children:["Next",t.jsx(ge,{className:"w-4 h-4"})]})})]})]})]})},Id=({targetRect:r})=>{const e=p.useMemo(()=>`spotlight-${Math.random().toString(36).substr(2,9)}`,[]);if(!r)return null;const s=Math.max(r.width,r.height)/2+20,i=r.left+r.width/2,n=r.top+r.height/2;return t.jsx("div",{className:"fixed inset-0 z-[24000] pointer-events-none",children:t.jsxs("svg",{width:"100%",height:"100%",className:"absolute inset-0",children:[t.jsx("defs",{children:t.jsxs("mask",{id:e,children:[t.jsx("rect",{width:"100%",height:"100%",fill:"white"}),t.jsx("circle",{cx:i,cy:n,r:s,fill:"black"})]})}),t.jsx("rect",{width:"100%",height:"100%",fill:"rgba(0,0,0,0.7)",mask:`url(#${e})`})]})})},$d=({isActive:r,config:e,currentStep:s,onNext:i,onPrev:n,onSkip:o})=>{const[a,l]=p.useState(null),[d,c]=p.useState(null),[u,h]=p.useState({x:0,y:0}),f=p.useRef(null),m=p.useRef(null),x=p.useRef(null),g=e?.steps[s];if(p.useEffect(()=>{if(!r||!g?.target){l(null),c(null);return}const w=()=>{try{const S=document.querySelector(`[data-tour-id="${g.target}"]`);if(S){const O=S.getBoundingClientRect();l(S),c(O),S.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}else console.warn(`Onboarding target not found: ${g.target}`),l(null),c(null)}catch(S){console.warn("Error updating target position:",S)}};x.current&&clearTimeout(x.current),x.current=setTimeout(w,g.delay||100);const y=()=>w(),j=()=>w();return window.addEventListener("resize",y),window.addEventListener("scroll",j,!0),window.addEventListener("orientationchange",y),m.current&&m.current.disconnect(),m.current=new ResizeObserver(w),()=>{x.current&&clearTimeout(x.current),window.removeEventListener("resize",y),window.removeEventListener("scroll",j,!0),window.removeEventListener("orientationchange",y),m.current&&m.current.disconnect()}},[r,g,s]),p.useEffect(()=>{if(d&&f.current){let y=Td(d,{width:380,height:200},g?.placement||"auto");g?.offset&&(y={x:y.x+(g.offset.x??0),y:y.y+(g.offset.y??0)}),h(y)}},[d,g?.placement]),p.useEffect(()=>{if(r){const w=setTimeout(()=>{const y=document.querySelector("[data-onboarding-tooltip]");y&&y.focus()},100);return()=>clearTimeout(w)}},[r,s]),!r||!e||!g)return null;const b=t.jsx(xe,{mode:"wait",children:t.jsxs(T.div,{className:"fixed inset-0 z-[23000]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[g.action==="spotlight"&&d?t.jsx(Id,{targetRect:d}):t.jsx("div",{className:"absolute inset-0 bg-black/40"}),d&&g.target&&t.jsx(T.div,{className:"absolute border-4 border-teal-400 rounded-xl pointer-events-none shadow-lg",style:{left:Math.max(0,d.left-4),top:Math.max(0,d.top-4),width:Math.min(window.innerWidth,d.width+8),height:d.height+8},initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3,delay:.1}}),t.jsx("div",{ref:f,"data-onboarding-tooltip":!0,tabIndex:-1,children:t.jsx(Ad,{step:g,position:u,onNext:i,onPrev:n,onSkip:o,isFirst:s===0,isLast:s===e.steps.length-1,stepNumber:s,totalSteps:e.steps.length,canSkip:e.allowSkip!==!1})})]},`onboarding-${s}`)});return Ci.createPortal(b,document.body)},Rd=({isOpen:r,onStartTour:e,onSkip:s,onMinimalTour:i})=>{const n=p.useCallback(()=>{console.log("Welcome modal: Start Tour clicked"),e()},[e]),o=p.useCallback(()=>{console.log("Welcome modal: Quick Overview clicked"),i()},[i]),a=p.useCallback(()=>{console.log("Welcome modal: Skip clicked"),s()},[s]);return t.jsx(xe,{children:r&&t.jsxs("div",{className:"fixed inset-0 z-[26000] flex items-center justify-center p-4",children:[t.jsx(T.div,{className:"absolute inset-0 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),t.jsxs(T.div,{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden w-full max-w-md",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},children:[t.jsxs("div",{className:"bg-gradient-to-br from-purple-500 via-teal-600 to-teal-600 p-6 text-white text-center relative overflow-hidden",children:[t.jsx(T.div,{className:"absolute inset-0 bg-white/10",animate:{background:["radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%)","radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 0%, transparent 50%)","radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"linear"}}),t.jsxs("div",{className:"relative z-10",children:[t.jsx(T.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.3},className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:t.jsx(Ss,{className:"w-8 h-8"})}),t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to Fan Club Z!"}),t.jsx("p",{className:"text-teal-100 text-sm",children:"Ready to discover the future of social predictions?"})]})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-400 to-teal-500 rounded-xl flex items-center justify-center flex-shrink-0",children:t.jsx(Tr,{className:"w-5 h-5 text-teal-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Discover Predictions"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Explore trending markets and join the community"})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:t.jsx(ls,{className:"w-5 h-5 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Make Your Predictions"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Put your knowledge to the test and earn rewards"})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0",children:t.jsx(Ht,{className:"w-5 h-5 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Manage Everything"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Track your performance and manage your wallet"})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:n,className:"w-full bg-teal-500 hover:bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold transition-colors flex items-center justify-center gap-2",children:[t.jsx(ud,{className:"w-4 h-4"}),"Take the Tour"]}),t.jsx("button",{onClick:o,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-4 rounded-xl font-medium transition-colors",children:"Quick Overview"}),t.jsxs("button",{onClick:a,className:"w-full text-gray-500 hover:text-gray-700 py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-1",children:[t.jsx(td,{className:"w-4 h-4"}),"Skip for now"]})]})]})]})]})})},Od=p.createContext(void 0),gi=[{id:"welcome-discover",title:"Welcome to Discover",description:"This is where you'll find trending predictions and explore new markets. Scroll through the list to see all available predictions.",target:"discover-list",placement:"bottom",offset:{y:24},icon:t.jsx(Tr,{className:"w-5 h-5"}),delay:500},{id:"search-feature",title:"Search Predictions",description:"Use the search bar to find specific topics, events, or types of predictions that interest you.",target:"search-bar",placement:"bottom",icon:t.jsx(kn,{className:"w-5 h-5"})},{id:"category-filters",title:"Browse by Category",description:"Filter predictions by category - Sports, Pop Culture, Tech, Finance, and more. Find what you're passionate about.",target:"category-filters",placement:"bottom",icon:t.jsx(sd,{className:"w-5 h-5"})},{id:"create-prediction",title:"Create Your Own",description:"Ready to share your insights? Tap the plus button to create your own prediction and invite others to participate.",target:"create-fab",placement:"left",offset:{y:-100},icon:t.jsx(ct,{className:"w-5 h-5"})},{id:"my-bets-tab",title:"Track Your Predictions",description:"View all your active predictions, ones you've created, and your completed predictions with results.",target:"tab-bets",placement:"top",offset:{y:-60},icon:t.jsx(ke,{className:"w-5 h-5"}),onNext:async()=>{const r=window.__router_navigate;r&&(r("/predictions"),await new Promise(e=>setTimeout(e,300)))}},{id:"bets-management",title:"Organize Your Activity",description:"Switch between Active (ongoing), Created (your predictions), and Completed (finished) to stay organized.",target:"bets-tabs",placement:"bottom",icon:t.jsx(Qc,{className:"w-5 h-5"})},{id:"wallet-tab",title:"Manage Your Wallet",description:"Keep track of your balance, view transaction history, and manage your funds securely.",target:"tab-wallet",placement:"top",offset:{y:-40},icon:t.jsx(Ht,{className:"w-5 h-5"}),onNext:async()=>{const r=window.__router_navigate;r&&(r("/wallet"),await new Promise(e=>setTimeout(e,300)))}},{id:"wallet-balance",title:"Your Balance",description:"Your current balance is displayed here. In demo mode, you can add test funds to try out predictions.",target:"wallet-balance-card",placement:"bottom",offset:{y:40},icon:t.jsx(Ht,{className:"w-5 h-5"})},{id:"profile-tab",title:"Your Profile",description:"Access your settings, view achievements, manage notifications, and track your performance stats.",target:"tab-profile",placement:"top",offset:{y:-40},icon:t.jsx(Ir,{className:"w-5 h-5"}),onNext:async()=>{const r=window.__router_navigate;r&&(r("/profile"),await new Promise(e=>setTimeout(e,300)))}},{id:"profile-completion",title:"Complete Your Profile",description:"Take a moment to complete your profile information and adjust your preferences for the best experience.",target:"profile-card",placement:"bottom",icon:t.jsx(Wt,{className:"w-5 h-5"}),onNext:async()=>{const r=window.__router_navigate;r&&(r("/"),await new Promise(e=>setTimeout(e,200)))}}],Ld=[{id:"quick-discover",title:"Discover Predictions",description:"Browse and participate in predictions from the community.",target:"tab-discover",placement:"top",icon:t.jsx(Tr,{className:"w-5 h-5"})},{id:"quick-create",title:"Create Predictions",description:"Share your insights by creating your own predictions.",target:"create-fab",placement:"left",icon:t.jsx(ct,{className:"w-5 h-5"})},{id:"quick-track",title:"Track Progress",description:"Monitor your active and completed predictions.",target:"tab-bets",placement:"top",icon:t.jsx(ke,{className:"w-5 h-5"})},{id:"quick-wallet",title:"Manage Funds",description:"View your balance and transaction history.",target:"tab-wallet",placement:"top",icon:t.jsx(Ht,{className:"w-5 h-5"})}],zd=()=>{try{const r=localStorage.getItem("fcz_onboarding_state_v3");return r?!JSON.parse(r).userPreferences?.hasSeenOnboarding:!0}catch{return!0}},Dd=()=>new URLSearchParams(window.location.search).get("welcome")==="1"||zd(),Ud=({children:r})=>{const[e,s]=de(),{state:i,config:n,startOnboarding:o,nextStep:a,prevStep:l,skipOnboarding:d,resetOnboarding:c}=Ed(),[u,h]=p.useState(!1);p.useEffect(()=>(window.__router_navigate=s,()=>{delete window.__router_navigate}),[s]),p.useEffect(()=>{const w=setTimeout(()=>{Dd()&&h(!0)},1e3);return()=>clearTimeout(w)},[]),p.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("tour");y==="full"?f():y==="quick"&&m()},[e]);const f=p.useCallback(()=>{h(!1),e!=="/"&&e!=="/discover"?(s("/"),setTimeout(()=>{o({steps:gi,allowSkip:!0,showProgress:!0,persistent:!0})},500)):o({steps:gi,allowSkip:!0,showProgress:!0,persistent:!0})},[e,s,o]),m=p.useCallback(()=>{h(!1),o({steps:Ld,allowSkip:!0,showProgress:!0,persistent:!1})},[o]),x=p.useCallback(()=>{h(!1),d()},[d]),g=p.useCallback(()=>{c(),h(!0)},[c]),b={isActive:i.isActive,showWelcome:u,startFullTour:f,startQuickTour:m,skipOnboarding:x,resetOnboarding:g,hasSeenOnboarding:i.userPreferences.hasSeenOnboarding,currentStep:i.currentStep,totalSteps:n?.steps.length||0};return t.jsxs(Od.Provider,{value:b,children:[r,t.jsx(Rd,{isOpen:u,onStartTour:f,onMinimalTour:m,onSkip:x}),t.jsx($d,{isActive:i.isActive,config:n,currentStep:i.currentStep,onNext:a,onPrev:l,onSkip:d})]})},Md="2.0.67",Fd={version:Md,name:"Fan Club Z",description:"Social Prediction Platform",api:{url:ut().apiUrl,timeout:15e3,retries:3},frontend:{url:{}.VITE_FRONTEND_URL||"https://app.fanclubz.app"},features:{realTimeUpdates:!0,socialEngagement:!0,walletIntegration:!0,settlementSystem:!0,clubSystem:!0},limits:{maxStakeAmount:1e4,minStakeAmount:1,maxDescriptionLength:500,maxCommentLength:280},ui:{theme:{primaryColor:"#22c55e",brandColors:{green:{50:"#f0fdf4",500:"#22c55e",600:"#16a34a",700:"#15803d"}}},animations:{duration:{fast:200,normal:300,slow:500}}}},pe=()=>Fd.api.url,xi={maxRetries:3,initialDelay:1e3,maxDelay:1e4,backoffFactor:2},Bd=r=>new Promise(e=>setTimeout(e,r)),Wd=(r,e,s)=>e>=s?!1:!!(r.name==="TypeError"&&r.message.includes("Failed to fetch")||r.name==="HTTPError"&&r.status>=500||r.name==="AbortError"||r.name==="TimeoutError"),Hd=(r,e)=>{const s=e.initialDelay*Math.pow(e.backoffFactor,r-1);return Math.min(s,e.maxDelay)},is=async(r,e={})=>{const{timeout:s=15e3,retryOptions:i=xi,...n}=e,o={...xi,...i};let a;for(let l=1;l<=o.maxRetries+1;l++)try{console.log(` API Request (attempt ${l}/${o.maxRetries+1}): ${r}`);const d=new AbortController,c=setTimeout(()=>d.abort(),s),u=await fetch(r,{...n,signal:d.signal,headers:{"Content-Type":"application/json",Accept:"application/json",...n.headers}});if(clearTimeout(c),!u.ok){const h=new Error(`HTTP error! status: ${u.status} ${u.statusText}`);throw h.name="HTTPError",h.status=u.status,h.response=u,h}return console.log(` API Success (attempt ${l}): ${u.status} ${u.statusText}`),u}catch(d){if(a=d,console.warn(` API Error (attempt ${l}):`,d.message),Wd(d,l,o.maxRetries)){const c=Hd(l,o);console.log(` Retrying in ${c}ms...`),await Bd(c);continue}break}throw console.error(` API Failed after ${o.maxRetries+1} attempts:`,a),a},ns={get:async(r,e={})=>{const s=`${pe()}${r}`;return(await is(s,{method:"GET",...e})).json()},post:async(r,e,s={})=>{const i=`${pe()}${r}`;return(await is(i,{method:"POST",body:e?JSON.stringify(e):void 0,...s})).json()},put:async(r,e,s={})=>{const i=`${pe()}${r}`;return(await is(i,{method:"PUT",body:e?JSON.stringify(e):void 0,...s})).json()},delete:async(r,e={})=>{const s=`${pe()}${r}`;return(await is(s,{method:"DELETE",...e})).json()}},os={predictions:[],trendingPredictions:[],userPredictions:[],createdPredictions:[],completedPredictions:[],userPredictionEntries:[],userCreatedPredictions:[],loading:!1,loadingMore:!1,error:null,initialized:!1,lastFetchTime:0,platformStats:null,statsLoading:!1,pagination:{page:1,limit:20,total:0,hasNext:!1,hasPrev:!1},filters:{category:"all",search:""}},Pt=Ve((r,e)=>({...os,fetchPredictions:async(s={})=>{const{page:i=1,category:n=e().filters.category,search:o=e().filters.search,append:a=!1}=s,l=Date.now(),{lastFetchTime:d,predictions:c}=e();if(!a&&i===1&&l-d<3e4&&c.length>0){console.log(" Using cached predictions");return}const u=a&&i>1;r({[u?"loadingMore":"loading"]:!0,error:null});try{console.log(` Fetching predictions: page=${i}, category=${n}, search=${o}, append=${a}`);const h=new URLSearchParams({page:i.toString(),limit:"20",...n!=="all"&&{category:n},...o.trim()&&{search:o.trim()}}),f=await ns.get(`/api/v2/predictions?${h}`,{timeout:1e4,retryOptions:{maxRetries:3}}),m=f.data||[],x=f.pagination||{};console.log(` Predictions fetched successfully: ${m.length} items (${x.total} total)`),r(g=>({predictions:a?[...g.predictions,...m]:m,loading:!1,loadingMore:!1,error:null,initialized:!0,lastFetchTime:l,pagination:{page:x.page||i,limit:x.limit||20,total:x.total||0,hasNext:x.hasNext||!1,hasPrev:x.hasPrev||!1},filters:{category:n,search:o}}))}catch(h){console.error(" Error fetching predictions:",h),r({loading:!1,loadingMore:!1,error:h instanceof Error?h.message:"Failed to fetch predictions"})}},loadMorePredictions:async()=>{const{pagination:s,loadingMore:i}=e();if(i||!s.hasNext){console.log(" Load more skipped:",{loadingMore:i,hasNext:s.hasNext});return}console.log(` Loading more predictions: page ${s.page+1}`),await e().fetchPredictions({page:s.page+1,append:!0})},setFilters:s=>{const n={...e().filters,...s};console.log(" Setting filters:",n),r(o=>({filters:n,pagination:{...o.pagination,page:1},predictions:[]})),e().fetchPredictions({category:n.category,search:n.search})},resetPagination:()=>{console.log(" Resetting pagination"),r(s=>({pagination:{...os.pagination},filters:{...os.filters},predictions:[]}))},refreshPredictions:async(s=!1)=>{const{lastFetchTime:i}=e(),n=Date.now();if(!s&&n-i<1e4){console.log(" Using cached predictions (refresh)");return}r(o=>({lastFetchTime:0,pagination:{...o.pagination,page:1},predictions:[]}));try{await e().fetchPredictions(),console.log(" Predictions refreshed successfully")}catch(o){throw console.error(" Error refreshing predictions:",o),o}},fetchTrendingPredictions:async()=>{r({loading:!0});try{const s=await fetch(`${pe()}/api/v2/predictions/trending`);if(!s.ok)throw new Error(`Failed to fetch trending predictions: ${s.statusText}`);const n=(await s.json()).data||[];r({trendingPredictions:n,loading:!1,error:null}),console.log(" Trending predictions fetched:",n.length)}catch(s){console.error(" Error fetching trending predictions:",s),r({loading:!1,error:s instanceof Error?s.message:"Failed to fetch trending predictions"})}},fetchUserPredictions:async s=>{r({loading:!0});try{const i=await fetch(`${pe()}/api/v2/predictions/user/${s}`);if(!i.ok)throw new Error(`Failed to fetch user predictions: ${i.statusText}`);const o=(await i.json()).data||[];r({userPredictions:o,loading:!1,error:null})}catch(i){console.error(" Error fetching user predictions:",i),r({loading:!1,error:i instanceof Error?i.message:"Failed to fetch user predictions"})}},fetchCreatedPredictions:async s=>{r({loading:!0});try{const i=await fetch(`${pe()}/api/v2/predictions/created/${s}`);if(!i.ok)throw new Error(`Failed to fetch created predictions: ${i.statusText}`);const o=(await i.json()).data||[];r({createdPredictions:o,loading:!1,error:null})}catch(i){console.error(" Error fetching created predictions:",i),r({loading:!1,error:i instanceof Error?i.message:"Failed to fetch created predictions"})}},fetchPredictionById:async s=>{try{console.log(` Fetching prediction by ID: ${s}`);const{predictions:i}=e(),n=i.find(c=>c.id===s);if(n)return console.log(" Found prediction in store:",n.title),n;await e().fetchPredictions();const{predictions:o}=e(),a=o.find(c=>c.id===s);if(a)return console.log(" Found prediction after fetch:",a.title),a;await e().fetchPredictions({page:2,append:!0});const{predictions:l}=e(),d=l.find(c=>c.id===s);return d?(console.log(" Found prediction on page 2:",d.title),d):(console.log(" Prediction not found:",s),null)}catch(i){return console.error(" Error fetching prediction by ID:",i),null}},createPrediction:async s=>{r({loading:!0,error:null});try{const i=await fetch(`${pe()}/api/v2/predictions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok)throw new Error(`Failed to create prediction: ${i.statusText}`);const n=await i.json();if(!n.data)throw new Error("Invalid response: no prediction data returned");const o=n.data;if(!o||!o.id)throw new Error("Invalid prediction data: missing required fields");r(a=>({predictions:[o,...a.predictions],loading:!1,error:null})),setTimeout(()=>{e().fetchPredictions()},100),r(a=>({userCreatedPredictions:[o,...a.userCreatedPredictions]}));try{const{user:a}=ie.getState();a?.id&&setTimeout(()=>{e().fetchUserCreatedPredictions(a.id)},1e3)}catch(a){console.warn(" Failed to refresh user created predictions:",a)}return console.log(" Prediction created successfully:",o.id),o}catch(i){throw console.error(" Error creating prediction:",i),r({loading:!1,error:i instanceof Error?i.message:"Failed to create prediction"}),i}},placePrediction:async(s,i,n,o)=>{r({loading:!0,error:null});try{const a=await fetch(`${pe()}/api/v2/predictions/${s}/entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({option_id:i,amount:n,user_id:o})});if(!a.ok)throw new Error(`Failed to place prediction: ${a.statusText}`);const l=await a.json();l.prediction?(console.log(" Updating prediction with server data:",{id:l.prediction.id,pool_total:l.prediction.pool_total,participant_count:l.prediction.participant_count,options:l.prediction.options?.length||0}),r(d=>({predictions:d.predictions.map(c=>c.id===s?{...c,...l.prediction,user_entry:l.entry}:c),userPredictions:d.userPredictions.map(c=>c.id===s?{...c,...l.prediction,user_entry:l.entry}:c),createdPredictions:d.createdPredictions.map(c=>c.id===s?{...c,...l.prediction,user_entry:l.entry}:c),loading:!1,error:null}))):r(d=>({predictions:d.predictions.map(c=>c.id===s?{...c,pool_total:l.pool_total||c.pool_total,participant_count:l.participant_count||c.participant_count,user_entry:l.entry}:c),loading:!1,error:null})),console.log(" Prediction placed successfully with updated data")}catch(a){throw console.error(" Error placing prediction:",a),r({loading:!1,error:a instanceof Error?a.message:"Failed to place prediction"}),a}},fetchPlatformStats:async()=>{r({statsLoading:!0});try{console.log(" Fetching platform stats with retry logic...");const s=await ns.get("/api/v2/predictions/stats/platform",{timeout:8e3,retryOptions:{maxRetries:3}});if(s.success&&s.data)r({platformStats:s.data,statsLoading:!1}),console.log(" Platform stats fetched:",s.data);else throw new Error("Invalid stats response format")}catch(s){console.error(" Error fetching platform stats:",s);const{predictions:i}=e(),n={totalVolume:i.reduce((o,a)=>o+(a.pool_total||0),0).toFixed(2),activePredictions:i.filter(o=>o.status==="open").length,totalUsers:i.length>0?"5":"0",rawVolume:i.reduce((o,a)=>o+(a.pool_total||0),0),rawUsers:i.length>0?5:0};r({platformStats:n,statsLoading:!1}),console.log(" Using fallback stats:",n)}},getActivityForPrediction:s=>[],getParticipantsForPrediction:s=>[],clearError:()=>{r({error:null})},fetchUserPredictionEntries:async s=>{try{console.log(" Fetching user prediction entries with retry logic for:",s);const n=(await ns.get(`/api/v2/prediction-entries/user/${s}`,{timeout:1e4,retryOptions:{maxRetries:3}})).data||[];r({userPredictionEntries:n}),console.log(" User prediction entries fetched:",n.length)}catch(i){console.error(" Error fetching user prediction entries:",i)}},fetchUserCreatedPredictions:async s=>{try{console.log(" Fetching user created predictions with retry logic for:",s);const n=(await ns.get(`/api/v2/predictions/created/${s}`,{timeout:1e4,retryOptions:{maxRetries:3}})).data||[];r({userCreatedPredictions:n}),console.log(" User created predictions fetched:",n.length)}catch(i){console.error(" Error fetching user created predictions:",i)}},getUserPredictionEntries:s=>{const{userPredictionEntries:i}=e();return i.filter(n=>n.user_id===s)},getUserCreatedPredictions:s=>{const{userCreatedPredictions:i}=e();return i.filter(n=>n.creator_id===s)},updatePrediction:async(s,i)=>{try{console.log(" Updating prediction:",s,i);const n=await fetch(`${pe()}/api/v2/predictions/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)});if(!n.ok)throw new Error(`Failed to update prediction: ${n.statusText}`);const a=(await n.json()).data;r(l=>({predictions:l.predictions.map(d=>d.id===s?{...d,...a}:d),userCreatedPredictions:l.userCreatedPredictions.map(d=>d.id===s?{...d,...a}:d)})),console.log(" Prediction updated successfully")}catch(n){throw console.error(" Error updating prediction:",n),n}},deletePrediction:async s=>{try{console.log(" Deleting prediction:",s);const i=await fetch(`${pe()}/api/v2/predictions/${s}`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!i.ok)throw new Error(`Failed to delete prediction: ${i.statusText}`);r(n=>({predictions:n.predictions.filter(o=>o.id!==s),createdPredictions:n.createdPredictions.filter(o=>o.id!==s),userCreatedPredictions:n.userCreatedPredictions.filter(o=>o.id!==s),trendingPredictions:n.trendingPredictions.filter(o=>o.id!==s),completedPredictions:n.completedPredictions.filter(o=>o.id!==s)}));try{const{user:n}=ie.getState();await e().refreshPredictions(!0),await e().fetchTrendingPredictions(),n?.id&&(await e().fetchUserCreatedPredictions(n.id),await e().fetchUserPredictionEntries(n.id))}catch(n){console.warn(" Post-delete refresh had an issue:",n)}console.log(" Prediction deleted successfully")}catch(i){throw console.error(" Error deleting prediction:",i),i}},closePrediction:async s=>{try{console.log(" Closing prediction:",s);const i=await fetch(`${pe()}/api/v2/predictions/${s}/close`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!i.ok)throw new Error(`Failed to close prediction: ${i.statusText}`);const o=(await i.json()).data;r(a=>({predictions:a.predictions.map(l=>l.id===s?{...l,status:"closed",...o}:l),userCreatedPredictions:a.userCreatedPredictions.map(l=>l.id===s?{...l,status:"closed",...o}:l)})),console.log(" Prediction closed successfully")}catch(i){throw console.error(" Error closing prediction:",i),i}},fetchPredictionActivity:async s=>{try{console.log(" Fetching prediction activity:",s);const i=await fetch(`${pe()}/api/v2/predictions/${s}/activity`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return i.ok?(await i.json()).data||[]:(console.warn(`Activity endpoint not available: ${i.statusText}`),[])}catch(i){return console.warn("Activity endpoint not implemented yet:",i),[]}},fetchPredictionParticipants:async s=>{try{console.log(" Fetching prediction participants:",s);const i=await fetch(`${pe()}/api/v2/predictions/${s}/participants`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return i.ok?(await i.json()).data||[]:(console.warn(`Participants endpoint not available: ${i.statusText}`),[])}catch(i){return console.warn("Participants endpoint not implemented yet:",i),[]}},reset:()=>{r(os)}})),qt=({username:r,userId:e,displayName:s,className:i="",showAt:n=!0,onClick:o})=>{const[,a]=de(),l=c=>{if(c.stopPropagation(),console.log(" TappableUsername clicked:",{username:r,userId:e,displayName:s}),o){o();return}const u=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(e&&e.trim()!==""&&u.test(e.trim()))console.log(" Navigating to profile with userId:",e),a(`/profile/${e.trim()}`);else if(r&&r.trim()!==""){e&&!u.test(e.trim())&&console.warn(" Invalid userId format, using username instead:",e);const h=r.replace("@","").trim();console.log(" Navigating to profile with username:",h),a(`/profile/${h}`)}else{console.warn(" No valid userId or username provided for profile navigation");return}},d=s||(n?`@${r.replace("@","")}`:r.replace("@",""));return t.jsx(T.button,{className:`inline-flex items-center font-medium text-blue-600 hover:text-blue-700 hover:underline transition-all cursor-pointer rounded-md px-1 py-0.5 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 ${i}`,whileHover:{scale:1.02},whileTap:{scale:.98},onClick:l,type:"button","aria-label":`View profile for ${d}`,children:d})},bi=({children:r,onClose:e,error:s})=>s?t.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9000]",children:t.jsx("div",{className:"bg-white rounded-lg p-6 max-w-sm mx-4",children:t.jsxs("div",{className:"text-red-600 text-center",children:[t.jsx("h3",{className:"font-semibold mb-2",children:" Error"}),t.jsx("p",{className:"text-sm",children:s}),t.jsx("button",{onClick:e,className:"mt-4 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Close"})]})})}):t.jsx(t.Fragment,{children:r}),Bs=({prediction:r,isOpen:e,onClose:s})=>{const{user:i}=ie(),[n,o]=p.useState(""),[a,l]=p.useState(!1);p.useEffect(()=>{l(!0)},[]);const d=r&&r.id&&r.id.trim()!=="",c=e&&d&&a,{comments:u,commentCount:h,isLoading:f,error:m,isSubmitting:x,fetchComments:g,addComment:b,toggleCommentLike:w,clearError:y}=Pr(c?r.id:"");p.useEffect(()=>{c&&g()},[c,g]),p.useEffect(()=>{e||(o(""),d&&y())},[e,y,d]);const j=async()=>{if(!(!d||!n.trim()||!i))try{await b(n.trim()),o(""),G.success("Comment added successfully!")}catch(C){console.error("Failed to add comment:",C),G.error(C.message||"Failed to add comment")}},S=async C=>{if(d)try{await w(C)}catch($){console.error("Failed to toggle comment like:",$),G.error("Failed to update like")}},O=C=>{try{const $=new Date,J=new Date(C),M=Math.floor(($.getTime()-J.getTime())/1e3);return M<60?"Just now":M<3600?`${Math.floor(M/60)}m ago`:M<86400?`${Math.floor(M/3600)}h ago`:`${Math.floor(M/86400)}d ago`}catch{return"Recently"}};return a?e&&!d?t.jsx(bi,{onClose:s,error:"Unable to load comments. Invalid prediction data."}):!e||!r?null:t.jsx(xe,{children:t.jsx(bi,{onClose:s,children:t.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center sm:items-center sm:p-4 z-[9000]",children:t.jsxs(T.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},onClick:C=>C.stopPropagation(),className:"bg-white w-full max-w-lg rounded-t-3xl sm:rounded-3xl overflow-hidden flex flex-col max-h-[90vh] sm:max-h-[80vh]",style:{zIndex:9001},children:[t.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between sticky top-0 bg-white z-10",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ae,{size:20,className:"text-blue-500"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Comments"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[h," ",h===1?"comment":"comments"]})]})]}),t.jsx("button",{onClick:s,className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:t.jsx(De,{size:18})})]}),t.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:[t.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:r.title}),t.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:r.description||"No description available"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:f&&u.length===0?t.jsx("div",{className:"p-4 text-center",children:t.jsx("div",{className:"animate-pulse space-y-3",children:[...Array(3)].map((C,$)=>t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-1"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]},$))})}):m?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Ae,{size:48,className:"text-red-300 mx-auto mb-3"}),t.jsx("p",{className:"text-red-600 font-medium",children:"Failed to load comments"}),t.jsx("p",{className:"text-sm text-red-400 mb-4",children:m}),t.jsx("button",{onClick:()=>g(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Try Again"})]}):u.length===0?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Ae,{size:48,className:"text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500 font-medium",children:"No comments yet"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Be the first to share your thoughts!"})]}):t.jsx("div",{className:"p-4 space-y-4",children:u.map(C=>t.jsx(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3",children:t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"bg-gray-50 rounded-2xl px-4 py-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(qt,{username:C.user?.username||"Anonymous",userId:C.user?.id||"anonymous",className:"font-semibold text-gray-900 text-sm hover:text-blue-600",showAt:!1}),t.jsx("span",{className:"text-xs text-gray-500",children:O(C.created_at)})]}),t.jsx("p",{className:"text-gray-800 text-sm leading-relaxed",children:C.content})]}),t.jsx("div",{className:"flex items-center gap-4 mt-2 ml-4",children:t.jsxs("button",{onClick:()=>S(C.id),className:`flex items-center gap-1 text-xs transition-colors ${C.is_liked?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[t.jsx(at,{size:14,fill:C.is_liked?"currentColor":"none"}),C.likes_count>0&&t.jsx("span",{children:C.likes_count})]})})]})},C.id))})}),i?t.jsx("div",{className:"p-4 border-t border-gray-100 bg-white sticky bottom-0",children:t.jsx("div",{className:"flex gap-3",children:t.jsxs("div",{className:"flex-1 flex gap-2",children:[t.jsx("input",{type:"text",value:n,onChange:C=>o(C.target.value),onKeyPress:C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),j())},placeholder:"Write a comment...",className:"flex-1 px-4 py-2 bg-gray-100 rounded-full focus:ring-2 focus:ring-green-500 focus:bg-white focus:outline-none transition-all text-sm",disabled:x}),t.jsx("button",{onClick:j,disabled:!n.trim()||x,className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center hover:bg-teal-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:t.jsx(fd,{size:14})})]})})}):t.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50 text-center",children:t.jsx("p",{className:"text-gray-600 text-sm",children:"Please log in to join the conversation"})})]})})})}):null};class Cn extends re.Component{constructor(s){super(s);ee(this,"resetError",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,i){console.error("ErrorBoundary caught an error:",s,i),this.setState({error:s,errorInfo:i}),this.props.onError?.(s,i)}render(){if(this.state.hasError){if(this.props.fallback){const s=this.props.fallback;return t.jsx(s,{error:this.state.error,resetError:this.resetError})}return t.jsx(qd,{error:this.state.error,resetError:this.resetError})}return this.props.children}}const qd=({error:r,resetError:e})=>{const s=()=>{e(),window.location.href="/"},i=()=>{e(),window.location.reload()};return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full bg-white rounded-2xl shadow-lg p-8 text-center",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(Zc,{className:"w-8 h-8 text-red-600"})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),t.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"We encountered an unexpected error. This has been logged and our team will investigate."})]}),r&&!1,t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs(T.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:i,className:"flex items-center justify-center gap-2 w-full bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-green-700 transition-colors",children:[t.jsx(Bt,{className:"w-4 h-4"}),"Try Again"]}),t.jsxs(T.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:s,className:"flex items-center justify-center gap-2 w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-xl font-semibold hover:bg-gray-200 transition-colors",children:[t.jsx(jn,{className:"w-4 h-4"}),"Go to Home"]})]})]})})};function Vd(){return Pi.useSyncExternalStore(Gd,()=>!0,()=>!1)}function Gd(){return()=>{}}var $r="Avatar",[Jd,Mh]=no($r),[Kd,Pn]=Jd($r),En=p.forwardRef((r,e)=>{const{__scopeAvatar:s,...i}=r,[n,o]=p.useState("idle");return t.jsx(Kd,{scope:s,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:t.jsx(xr.span,{...i,ref:e})})});En.displayName=$r;var Tn="AvatarImage",An=p.forwardRef((r,e)=>{const{__scopeAvatar:s,src:i,onLoadingStatusChange:n=()=>{},...o}=r,a=Pn(Tn,s),l=Yd(i,o),d=oo(c=>{n(c),a.onImageLoadingStatusChange(c)});return Vs(()=>{l!=="idle"&&d(l)},[l,d]),l==="loaded"?t.jsx(xr.img,{...o,ref:e,src:i}):null});An.displayName=Tn;var In="AvatarFallback",$n=p.forwardRef((r,e)=>{const{__scopeAvatar:s,delayMs:i,...n}=r,o=Pn(In,s),[a,l]=p.useState(i===void 0);return p.useEffect(()=>{if(i!==void 0){const d=window.setTimeout(()=>l(!0),i);return()=>window.clearTimeout(d)}},[i]),a&&o.imageLoadingStatus!=="loaded"?t.jsx(xr.span,{...n,ref:e}):null});$n.displayName=In;function yi(r,e){return r?e?(r.src!==e&&(r.src=e),r.complete&&r.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Yd(r,{referrerPolicy:e,crossOrigin:s}){const i=Vd(),n=p.useRef(null),o=(()=>i?(n.current||(n.current=new window.Image),n.current):null)(),[a,l]=p.useState(()=>yi(o,r));return Vs(()=>{l(yi(o,r))},[o,r]),Vs(()=>{const d=h=>()=>{l(h)};if(!o)return;const c=d("loaded"),u=d("error");return o.addEventListener("load",c),o.addEventListener("error",u),e&&(o.referrerPolicy=e),typeof s=="string"&&(o.crossOrigin=s),()=>{o.removeEventListener("load",c),o.removeEventListener("error",u)}},[o,s,e]),a}var Rn=En,On=An,Ln=$n;function zn(r){var e,s,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(s=zn(r[e]))&&(i&&(i+=" "),i+=s)}else for(s in r)r[s]&&(i&&(i+=" "),i+=s);return i}function Dn(){for(var r,e,s=0,i="",n=arguments.length;s<n;s++)(r=arguments[s])&&(e=zn(r))&&(i&&(i+=" "),i+=e);return i}const Rr="-",Zd=r=>{const e=Xd(r),{conflictingClassGroups:s,conflictingClassGroupModifiers:i}=r;return{getClassGroupId:a=>{const l=a.split(Rr);return l[0]===""&&l.length!==1&&l.shift(),Un(l,e)||Qd(a)},getConflictingClassGroupIds:(a,l)=>{const d=s[a]||[];return l&&i[a]?[...d,...i[a]]:d}}},Un=(r,e)=>{if(r.length===0)return e.classGroupId;const s=r[0],i=e.nextPart.get(s),n=i?Un(r.slice(1),i):void 0;if(n)return n;if(e.validators.length===0)return;const o=r.join(Rr);return e.validators.find(({validator:a})=>a(o))?.classGroupId},vi=/^\[(.+)\]$/,Qd=r=>{if(vi.test(r)){const e=vi.exec(r)[1],s=e?.substring(0,e.indexOf(":"));if(s)return"arbitrary.."+s}},Xd=r=>{const{theme:e,prefix:s}=r,i={nextPart:new Map,validators:[]};return tu(Object.entries(r.classGroups),s).forEach(([o,a])=>{ur(a,i,o,e)}),i},ur=(r,e,s,i)=>{r.forEach(n=>{if(typeof n=="string"){const o=n===""?e:wi(e,n);o.classGroupId=s;return}if(typeof n=="function"){if(eu(n)){ur(n(i),e,s,i);return}e.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(([o,a])=>{ur(a,wi(e,o),s,i)})})},wi=(r,e)=>{let s=r;return e.split(Rr).forEach(i=>{s.nextPart.has(i)||s.nextPart.set(i,{nextPart:new Map,validators:[]}),s=s.nextPart.get(i)}),s},eu=r=>r.isThemeGetter,tu=(r,e)=>e?r.map(([s,i])=>{const n=i.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([a,l])=>[e+a,l])):o);return[s,n]}):r,su=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,s=new Map,i=new Map;const n=(o,a)=>{s.set(o,a),e++,e>r&&(e=0,i=s,s=new Map)};return{get(o){let a=s.get(o);if(a!==void 0)return a;if((a=i.get(o))!==void 0)return n(o,a),a},set(o,a){s.has(o)?s.set(o,a):n(o,a)}}},Mn="!",ru=r=>{const{separator:e,experimentalParseClassName:s}=r,i=e.length===1,n=e[0],o=e.length,a=l=>{const d=[];let c=0,u=0,h;for(let b=0;b<l.length;b++){let w=l[b];if(c===0){if(w===n&&(i||l.slice(b,b+o)===e)){d.push(l.slice(u,b)),u=b+o;continue}if(w==="/"){h=b;continue}}w==="["?c++:w==="]"&&c--}const f=d.length===0?l:l.substring(u),m=f.startsWith(Mn),x=m?f.substring(1):f,g=h&&h>u?h-u:void 0;return{modifiers:d,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:g}};return s?l=>s({className:l,parseClassName:a}):a},iu=r=>{if(r.length<=1)return r;const e=[];let s=[];return r.forEach(i=>{i[0]==="["?(e.push(...s.sort(),i),s=[]):s.push(i)}),e.push(...s.sort()),e},nu=r=>({cache:su(r.cacheSize),parseClassName:ru(r),...Zd(r)}),ou=/\s+/,au=(r,e)=>{const{parseClassName:s,getClassGroupId:i,getConflictingClassGroupIds:n}=e,o=[],a=r.trim().split(ou);let l="";for(let d=a.length-1;d>=0;d-=1){const c=a[d],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=s(c);let x=!!m,g=i(x?f.substring(0,m):f);if(!g){if(!x){l=c+(l.length>0?" "+l:l);continue}if(g=i(f),!g){l=c+(l.length>0?" "+l:l);continue}x=!1}const b=iu(u).join(":"),w=h?b+Mn:b,y=w+g;if(o.includes(y))continue;o.push(y);const j=n(g,x);for(let S=0;S<j.length;++S){const O=j[S];o.push(w+O)}l=c+(l.length>0?" "+l:l)}return l};function lu(){let r=0,e,s,i="";for(;r<arguments.length;)(e=arguments[r++])&&(s=Fn(e))&&(i&&(i+=" "),i+=s);return i}const Fn=r=>{if(typeof r=="string")return r;let e,s="";for(let i=0;i<r.length;i++)r[i]&&(e=Fn(r[i]))&&(s&&(s+=" "),s+=e);return s};function cu(r,...e){let s,i,n,o=a;function a(d){const c=e.reduce((u,h)=>h(u),r());return s=nu(c),i=s.cache.get,n=s.cache.set,o=l,l(d)}function l(d){const c=i(d);if(c)return c;const u=au(d,s);return n(d,u),u}return function(){return o(lu.apply(null,arguments))}}const X=r=>{const e=s=>s[r]||[];return e.isThemeGetter=!0,e},Bn=/^\[(?:([a-z-]+):)?(.+)\]$/i,du=/^\d+\/\d+$/,uu=new Set(["px","full","screen"]),hu=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pu=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fu=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,mu=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gu=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,$e=r=>vt(r)||uu.has(r)||du.test(r),Fe=r=>Et(r,"length",Nu),vt=r=>!!r&&!Number.isNaN(Number(r)),Ws=r=>Et(r,"number",vt),$t=r=>!!r&&Number.isInteger(Number(r)),xu=r=>r.endsWith("%")&&vt(r.slice(0,-1)),H=r=>Bn.test(r),Be=r=>hu.test(r),bu=new Set(["length","size","percentage"]),yu=r=>Et(r,bu,Wn),vu=r=>Et(r,"position",Wn),wu=new Set(["image","url"]),ju=r=>Et(r,wu,Su),ku=r=>Et(r,"",_u),Rt=()=>!0,Et=(r,e,s)=>{const i=Bn.exec(r);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):s(i[2]):!1},Nu=r=>pu.test(r)&&!fu.test(r),Wn=()=>!1,_u=r=>mu.test(r),Su=r=>gu.test(r),Cu=()=>{const r=X("colors"),e=X("spacing"),s=X("blur"),i=X("brightness"),n=X("borderColor"),o=X("borderRadius"),a=X("borderSpacing"),l=X("borderWidth"),d=X("contrast"),c=X("grayscale"),u=X("hueRotate"),h=X("invert"),f=X("gap"),m=X("gradientColorStops"),x=X("gradientColorStopPositions"),g=X("inset"),b=X("margin"),w=X("opacity"),y=X("padding"),j=X("saturate"),S=X("scale"),O=X("sepia"),C=X("skew"),$=X("space"),J=X("translate"),M=()=>["auto","contain","none"],K=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto",H,e],D=()=>[H,e],Z=()=>["",$e,Fe],k=()=>["auto",vt,H],A=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],N=()=>["solid","dashed","dotted","double","none"],E=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],v=()=>["start","end","center","between","around","evenly","stretch"],_=()=>["","0",H],L=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>[vt,H];return{cacheSize:500,separator:":",theme:{colors:[Rt],spacing:[$e,Fe],blur:["none","",Be,H],brightness:P(),borderColor:[r],borderRadius:["none","","full",Be,H],borderSpacing:D(),borderWidth:Z(),contrast:P(),grayscale:_(),hueRotate:P(),invert:_(),gap:D(),gradientColorStops:[r],gradientColorStopPositions:[xu,Fe],inset:I(),margin:I(),opacity:P(),padding:D(),saturate:P(),scale:P(),sepia:_(),skew:P(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",H]}],container:["container"],columns:[{columns:[Be]}],"break-after":[{"break-after":L()}],"break-before":[{"break-before":L()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...A(),H]}],overflow:[{overflow:K()}],"overflow-x":[{"overflow-x":K()}],"overflow-y":[{"overflow-y":K()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",$t,H]}],basis:[{basis:I()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",H]}],grow:[{grow:_()}],shrink:[{shrink:_()}],order:[{order:["first","last","none",$t,H]}],"grid-cols":[{"grid-cols":[Rt]}],"col-start-end":[{col:["auto",{span:["full",$t,H]},H]}],"col-start":[{"col-start":k()}],"col-end":[{"col-end":k()}],"grid-rows":[{"grid-rows":[Rt]}],"row-start-end":[{row:["auto",{span:[$t,H]},H]}],"row-start":[{"row-start":k()}],"row-end":[{"row-end":k()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",H]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",H]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...v()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...v(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...v(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[$]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[$]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",H,e]}],"min-w":[{"min-w":[H,e,"min","max","fit"]}],"max-w":[{"max-w":[H,e,"none","full","min","max","fit","prose",{screen:[Be]},Be]}],h:[{h:[H,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[H,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[H,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[H,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Be,Fe]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ws]}],"font-family":[{font:[Rt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",H]}],"line-clamp":[{"line-clamp":["none",vt,Ws]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",$e,H]}],"list-image":[{"list-image":["none",H]}],"list-style-type":[{list:["none","disc","decimal",H]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...N(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",$e,Fe]}],"underline-offset":[{"underline-offset":["auto",$e,H]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",H]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",H]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...A(),vu]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yu]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ju]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...N(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:N()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...N()]}],"outline-offset":[{"outline-offset":[$e,H]}],"outline-w":[{outline:[$e,Fe]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[$e,Fe]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Be,ku]}],"shadow-color":[{shadow:[Rt]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...E(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":E()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[i]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Be,H]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[j]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",H]}],duration:[{duration:P()}],ease:[{ease:["linear","in","out","in-out",H]}],delay:[{delay:P()}],animate:[{animate:["none","spin","ping","pulse","bounce",H]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[$t,H]}],"translate-x":[{"translate-x":[J]}],"translate-y":[{"translate-y":[J]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",H]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",H]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",H]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[$e,Fe,Ws]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Pu=cu(Cu);function Ne(...r){return Pu(Dn(r))}const Eu=r=>{const e=new Date(r),s=new Date,i=e.getTime()-s.getTime();if(i<=0)return"Ended";const n=Math.floor(i/6e4),o=Math.floor(i/36e5),a=Math.floor(i/864e5),l=Math.floor(a/365);if(o>999)if(l>0){const d=a%365;return d>0?`${l}y ${d}d left`:`${l}y left`}else return`${a}d left`;return a>0?`${a}d ${o%24}h left`:o>0?`${o}h left`:n>0?`${n}m left`:"Ending soon"},Hn=p.forwardRef(({className:r,...e},s)=>t.jsx(Rn,{ref:s,className:Ne("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full border border-border",r),...e}));Hn.displayName=Rn.displayName;const qn=p.forwardRef(({className:r,...e},s)=>t.jsx(On,{ref:s,className:Ne("aspect-square h-full w-full object-cover",r),...e}));qn.displayName=On.displayName;const Vn=p.forwardRef(({className:r,...e},s)=>t.jsx(Ln,{ref:s,className:Ne("flex h-full w-full items-center justify-center rounded-full bg-muted text-sm font-medium text-muted-foreground",r),...e}));Vn.displayName=Ln.displayName;const Tu={sm:"h-8 w-8 text-xs",md:"h-10 w-10 text-sm",lg:"h-16 w-16 text-xl",xl:"h-20 w-20 text-2xl"},hr=({email:r,username:e,avatarUrl:s,className:i,size:n="md"})=>{const o=`${Tu[n]} ${i||""}`.trim(),l=(()=>e&&e.trim()?e.trim().split(" ").map(d=>d.charAt(0)).join("").toUpperCase().slice(0,2):r&&r.trim()?r.trim().split("@")[0].slice(0,2).toUpperCase():"FC")();return t.jsxs(Hn,{className:o,children:[s&&s.trim()?t.jsx(qn,{src:s,alt:e||r||"User avatar"}):null,t.jsx(Vn,{className:"bg-gradient-to-r from-purple-400 to-purple-600 text-white font-bold",children:l})]})},Au=({error:r})=>t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-red-200 p-4 m-2",children:t.jsxs("div",{className:"text-red-600 text-sm",children:[" Error loading prediction",r&&t.jsx("div",{className:"text-xs mt-1 text-gray-500",children:r})]})}),Iu=({prediction:r,entry:e,variant:s="default",onLike:i,onComment:n,onShare:o,onPredict:a,className:l=""})=>{if(!r||!r.id)return console.warn(" PredictionCard: Invalid prediction data received:",r),t.jsx(Au,{error:"Invalid prediction data"});const[,d]=de(),[c,u]=p.useState(!1),[h,f]=p.useState(!1),[m,x]=p.useState(!1);p.useEffect(()=>{u(!0)},[]);const g=()=>{try{const{toggleLike:P,checkIfLiked:R,getLikeCount:F}=Sr();return{toggleLike:P,checkIfLiked:R,getLikeCount:F}}catch(P){return console.warn("Error accessing like store:",P),{toggleLike:async()=>{},checkIfLiked:()=>!1,getLikeCount:()=>0}}},b=()=>{try{const{getCommentCount:P}=Cr();return{getCommentCount:P}}catch(P){return console.warn("Error accessing comment store:",P),{getCommentCount:()=>0}}},{toggleLike:w,checkIfLiked:y,getLikeCount:j}=g(),{getCommentCount:S}=b();if(!c)return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 animate-pulse",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-1"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]}),t.jsx("div",{className:"h-6 bg-gray-200 rounded mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]});const O=y(r.id)||!1,C=j(r.id),$=C??(r.likes_count||r.likes||0),J=S(r.id)||r.comments_count||r.comments||0,M=r.entry_deadline||r.entryDeadline,K=M?Math.max(0,new Date(M).getTime()-Date.now()):0,I=Math.floor(K/(1e3*60*60)),D=I<24&&I>0,Z=r.participant_count||r.entries?.length||0,k=r.options?.reduce((P,R)=>{const F=R.total_staked||R.totalStaked||0;return P+F},0)||r.pool_total||r.poolTotal||0,A=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),N=async()=>{if(!m){console.log(" Like clicked:",r.id,"- Before:",{isLiked:O,likeCount:$});try{x(!0),await w(r.id),i&&i()}catch(P){console.error(" Error toggling like:",P),G.error("Failed to update like")}finally{x(!1)}}},E=()=>{f(!0),n&&n()},v=async()=>{try{const P={title:r.title,text:`Check out this prediction: ${r.title}`,url:`${window.location.origin}/prediction/${r.id}`};if(navigator.share&&navigator.canShare&&navigator.canShare(P))await navigator.share(P);else if(navigator.clipboard)await navigator.clipboard.writeText(P.url),G.success("Link copied to clipboard!");else{const R=document.createElement("textarea");R.value=P.url,document.body.appendChild(R),R.select(),document.execCommand("copy"),document.body.removeChild(R),G.success("Link copied to clipboard!")}o&&o()}catch(P){console.error("Error sharing:",P),G.error("Failed to share")}},_=P=>{const R=P.target;R.closest("button")||R.closest("a")||R.closest(".interactive")||R.closest(".options-clickable")||R.closest('[data-clickable="true"]')||R.closest(".predict-button")||P.defaultPrevented||d(`/prediction/${r.id}`)},L=()=>K<=0?"Ended":I>=24?`${Math.floor(I/24)}d left`:`${I}h left`;if(s==="compact")return t.jsxs(t.Fragment,{children:[t.jsxs(T.div,{className:`bg-white rounded-xl shadow-sm border border-gray-100 p-4 cursor-pointer ${l}`,whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},onClick:_,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(hr,{email:r.creator?.email,username:r.creator?.username,avatarUrl:r.creator?.avatar_url,size:"sm"}),t.jsxs("div",{children:[t.jsx(qt,{username:r.creator?.username||r.creator?.full_name||"Anonymous",userId:r.creator?.id||"anonymous",className:"font-medium text-gray-900 text-sm hover:text-blue-600",showAt:!0}),t.jsx("div",{className:"text-xs text-gray-500",children:L()})]})]}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.category==="sports"?"bg-red-100 text-red-700":r.category==="pop_culture"?"bg-purple-100 text-purple-700":r.category==="esports"?"bg-yellow-100 text-yellow-700":r.category==="politics"?"bg-blue-100 text-blue-700":r.category==="celebrity_gossip"?"bg-pink-100 text-pink-700":"bg-teal-100 text-teal-700"}`,children:r.category?.replace("_"," ")||"General"})]}),t.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 cursor-pointer options-clickable",onClick:P=>{P.stopPropagation(),a&&a()},children:r.title}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-600 cursor-pointer options-clickable",onClick:P=>{P.stopPropagation(),a&&a()},children:[t.jsx("span",{className:"font-medium",children:A(k)}),t.jsx("span",{children:""}),t.jsxs("span",{children:[Array.isArray(r.options)?r.options.length:0," options"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:P=>{P.stopPropagation(),N()},className:`flex items-center gap-1 ${O?"text-red-500":"text-gray-400"} hover:text-red-500 transition-colors`,children:[t.jsx(at,{className:`w-4 h-4 ${O?"fill-current":""}`}),t.jsx("span",{className:"text-gray-600",children:$})]}),t.jsxs("button",{onClick:P=>{P.stopPropagation(),E()},className:"flex items-center gap-1 text-gray-400 hover:text-blue-500 transition-colors",children:[t.jsx(Ae,{className:"w-4 h-4"}),t.jsx("span",{className:"text-gray-600",children:J})]})]})]})]}),t.jsx(Bs,{prediction:r,isOpen:h,onClose:()=>f(!1)})]});if(s==="user-entry"){const P=!!e,R=e?.option_id,F=e?.potential_payout||0,te=e?.actual_payout||0,Y=e?.status||r.status;return t.jsxs(t.Fragment,{children:[t.jsxs(T.div,{className:`bg-white rounded-xl shadow-sm border-l-4 ${Y==="won"?"border-teal-500":Y==="lost"?"border-red-500":Y==="settled"?"border-gray-500":"border-blue-500"} p-4 cursor-pointer ${l}`,whileHover:{scale:1.01,y:-2},onClick:_,children:[t.jsx("div",{className:"flex items-center justify-between mb-3",children:t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 text-base line-clamp-1",children:r.title}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${Y==="won"?"bg-teal-100 text-teal-700":Y==="lost"?"bg-red-100 text-red-700":Y==="settled"?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"}`,children:Y?.toUpperCase()}),t.jsx(kt,{className:"w-3 h-3 text-gray-400"}),t.jsx("span",{className:"text-xs text-gray-500",children:L()})]})]})}),P&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Your Position"}),t.jsx("div",{className:"font-semibold text-gray-900",children:r.options?.find(oe=>oe.id===R)?.label||"Option selected"}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Stake: ",A(e?.amount||0)," ",Y==="won"?` Won: ${A(te)}`:Y==="lost"?" Lost":` Potential: ${A(F)}`]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:N,disabled:m,className:`flex items-center gap-1 ${O?"text-red-500":"text-gray-500"} hover:text-red-500 transition-colors`,children:[t.jsx(at,{className:`w-4 h-4 ${O?"fill-current":""}`}),t.jsx("span",{className:"text-sm",children:$})]}),t.jsxs("button",{onClick:E,className:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",children:[t.jsx(Ae,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:J})]}),t.jsxs("button",{onClick:v,className:"flex items-center gap-1 text-gray-500 hover:text-teal-500 transition-colors",children:[t.jsx(cr,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Share"})]})]}),t.jsx("button",{onClick:a,className:"px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-sm font-medium transition-colors",children:"View Details"})]})]}),t.jsx(Bs,{prediction:r,isOpen:h,onClose:()=>f(!1)})]})}return t.jsxs(t.Fragment,{children:[t.jsxs(T.div,{className:`bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden cursor-pointer ${l}`,whileHover:{scale:1.01,y:-2},initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:_,transition:{duration:.3},children:[t.jsxs("div",{className:"p-4 pb-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-purple-400 to-purple-600 flex items-center justify-center text-white font-bold",children:r.creator?.username?.slice(0,2).toUpperCase()||"FC"}),t.jsxs("div",{children:[t.jsx(qt,{username:r.creator?.username||r.creator?.full_name||"Anonymous",userId:r.creator?.id||"anonymous",className:"font-medium text-gray-900 hover:text-blue-600",showAt:!0}),t.jsx("div",{className:"text-sm text-gray-500",children:r.created_at?new Date(r.created_at).toLocaleDateString():"Recently"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${r.category==="sports"?"bg-red-100 text-red-700":r.category==="pop_culture"?"bg-purple-100 text-purple-700":r.category==="esports"?"bg-yellow-100 text-yellow-700":r.category==="politics"?"bg-blue-100 text-blue-700":r.category==="celebrity_gossip"?"bg-pink-100 text-pink-700":"bg-teal-100 text-teal-700"}`,children:r.category?.replace("_"," ")||"General"}),D&&t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:"Closing Soon"})]})]}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2 leading-tight",children:r.title}),r.description&&t.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:r.description})]}),t.jsx("div",{className:"px-4 mb-4",children:t.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Options"}),t.jsxs("span",{className:"text-xs text-gray-500",children:[Array.isArray(r.options)?r.options.length:0," choices"]})]}),t.jsxs("div",{className:"space-y-2",children:[(r.options||[]).slice(0,3).map((P,R)=>{const F=P.total_staked||P.totalStaked||0,te=Array.isArray(r.options)?r.options.length:0,Y=k>0?F/k*100:te>0?100/te:0,oe=P.current_odds||(F>0?Math.max(k/F,1.01):te||2);return t.jsx(T.button,{className:"w-full p-3 rounded-lg border-2 border-gray-200 bg-white hover:border-teal-300 hover:bg-teal-50 transition-all group",whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>a&&a(),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium text-gray-900 group-hover:text-teal-700",children:P.label}),t.jsxs("div",{className:"text-sm text-gray-500",children:[Y.toFixed(0),"%  ",A(F)]})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-lg font-bold text-teal-600",children:[oe.toFixed(1),"x"]})})]})},P.id)}),(r.options?.length||0)>3&&t.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",(r.options?.length||0)-3," more options available"]})]})]})}),t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"font-semibold text-gray-900",children:A(k)}),t.jsx("span",{className:"text-gray-500",children:"pool"})]}),t.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[t.jsx(_n,{className:"w-4 h-4"}),t.jsx("span",{children:Z})]}),t.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[t.jsx(kt,{className:"w-4 h-4"}),t.jsx("span",{className:D?"text-amber-600 font-medium":"",children:L()})]})]}),Z>5&&t.jsxs("div",{className:"flex items-center gap-1 text-teal-600",children:[t.jsx(ke,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"Trending"})]})]})}),t.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(T.button,{onClick:N,disabled:m,className:`flex items-center gap-2 ${O?"text-red-500":"text-gray-600"} hover:text-red-500 transition-colors`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(at,{className:`w-5 h-5 ${O?"fill-current":""}`}),t.jsx("span",{className:"text-sm font-medium",children:$})]}),t.jsxs(T.button,{onClick:E,className:"flex items-center gap-2 text-gray-600 hover:text-blue-500 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(Ae,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm font-medium",children:J})]}),t.jsxs(T.button,{onClick:v,className:"flex items-center gap-2 text-gray-600 hover:text-teal-500 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(cr,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm font-medium",children:"Share"})]})]}),t.jsx(T.button,{onClick:a,className:"bg-gradient-to-r from-purple-600 to-teal-600 text-white px-6 py-2 rounded-lg font-medium shadow-sm",whileHover:{scale:1.02,boxShadow:"0 8px 25px rgba(123, 47, 247, 0.25)"},whileTap:{scale:.98},children:"Predict Now"})]})})]}),t.jsx(Bs,{prediction:r,isOpen:h,onClose:()=>f(!1)})]})},$u=r=>t.jsx(Cn,{children:t.jsx(Iu,{...r})}),Ru=()=>t.jsxs("div",{className:"bg-white rounded-2xl p-4 mx-4 mb-3 shadow-sm border border-gray-100 animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-1"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]}),t.jsx("div",{className:"ml-3 flex-shrink-0",children:t.jsx("div",{className:"w-16 h-6 bg-gray-200 rounded-full"})})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"p-3 border-2 border-gray-200 rounded-xl",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-12 mb-1"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-8"})]}),t.jsxs("div",{className:"p-3 border-2 border-gray-200 rounded-xl",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-12 mb-1"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-8"})]})]})}),t.jsxs("div",{className:"flex items-center justify-between text-sm mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-10"})]}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-6"})]}),t.jsx("div",{className:"w-20 h-8 bg-gray-200 rounded-lg"})]})]}),ji=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,ki=Dn,Ou=(r,e)=>s=>{var i;if(e?.variants==null)return ki(r,s?.class,s?.className);const{variants:n,defaultVariants:o}=e,a=Object.keys(n).map(c=>{const u=s?.[c],h=o?.[c];if(u===null)return null;const f=ji(u)||ji(h);return n[c][f]}),l=s&&Object.entries(s).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),d=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((c,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(x=>{let[g,b]=x;return Array.isArray(b)?b.includes({...o,...l}[g]):{...o,...l}[g]===b})?[...c,h,f]:c},[]);return ki(r,a,d,s?.class,s?.className)},Lu=Ou("inline-flex items-center justify-center rounded-lg text-sm font-semibold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground shadow-sm",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-3",sm:"h-9 px-4 py-2 text-xs",lg:"h-14 px-8 py-4",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pr=p.forwardRef(({className:r,variant:e,size:s,asChild:i=!1,...n},o)=>{const a=i?ao:"button";return t.jsx(a,{className:Ne(Lu({variant:e,size:s,className:r})),ref:o,...n})});pr.displayName="Button";const Gn=p.forwardRef(({className:r,type:e,...s},i)=>t.jsx("input",{type:e,className:Ne("flex h-12 w-full rounded-lg border border-input bg-background px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:i,...s}));Gn.displayName="Input";const fr=p.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:Ne("rounded-xl border bg-card text-card-foreground shadow-sm",r),...e}));fr.displayName="Card";const zu=p.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:Ne("flex flex-col space-y-1.5 p-6",r),...e}));zu.displayName="CardHeader";const Du=p.forwardRef(({className:r,...e},s)=>t.jsx("h3",{ref:s,className:Ne("font-semibold leading-none tracking-tight",r),...e}));Du.displayName="CardTitle";const Uu=p.forwardRef(({className:r,...e},s)=>t.jsx("p",{ref:s,className:Ne("text-sm text-muted-foreground",r),...e}));Uu.displayName="CardDescription";const mr=p.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:Ne("p-6 pt-0",r),...e}));mr.displayName="CardContent";const Mu=p.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:Ne("flex items-center p-6 pt-0",r),...e}));Mu.displayName="CardFooter";const Pe=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),Fu=(r,e)=>r*e,Ni=(...r)=>r.filter(Boolean).join(" "),Bu=r=>{const e=r.entry_deadline||r.entryDeadline;if(!e)return"Time remaining unknown";const s=Math.max(0,new Date(e).getTime()-Date.now()),i=Math.floor(s/(1e3*60*60));return s<=0?"Ended":i>=24?`${Math.floor(i/24)}d left`:`${i}h left`},Wu=({prediction:r,isOpen:e,onClose:s})=>{if(!r||!e)return null;const[i,n]=p.useState(""),[o,a]=p.useState(""),[l,d]=p.useState(!1),{user:c}=ie(),{getBalance:u,lockFunds:h}=js(),{placePrediction:f}=Pt(),m=u("USD")||0,x=parseFloat(o)||0,g=r?.options?.find(S=>S.id===i),b=g?.current_odds||(g?.total_staked?r?.pool_total/g.total_staked:2),w=g?Fu(x,b):0,y=[5,10,25,50,100,250],j=async()=>{if(!i){G.error("Please select a prediction option (Yes or No)");return}if(!x){G.error("Please enter an amount to stake");return}if(x<r.stake_min){G.error(`Minimum stake is ${Pe(r.stake_min)}. Please increase your amount.`);return}if(r.stake_max&&x>r.stake_max){G.error(`Maximum stake is ${Pe(r.stake_max)}. Please reduce your amount.`);return}if(x>m){G.error(`Insufficient balance. You have ${Pe(m)} available, but tried to stake ${Pe(x)}.`);return}if(!c?.id){G.error("You must be logged in to place predictions");return}d(!0);try{await h(x,"USD"),await f(r.id,i,x,c.id),G.success(`Prediction placed successfully! You staked ${Pe(x)} on ${g?.label}.`),s(),a(""),n("")}catch(S){const O=S?.message||"Unknown error occurred";G.error(`Failed to place prediction: ${O}. Please try again.`)}finally{d(!1)}};return t.jsx(xe,{mode:"wait",initial:!1,children:e&&t.jsxs(t.Fragment,{children:[t.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:s,style:{zIndex:8e3}},"prediction-modal-backdrop"),t.jsx("div",{className:"fixed inset-0 flex items-end justify-center p-4 pb-20",style:{zIndex:8500,pointerEvents:"none"},children:t.jsxs(T.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"w-full max-w-md bg-white rounded-t-2xl shadow-2xl flex flex-col max-h-[75vh]",style:{pointerEvents:"auto"},onClick:S=>S.stopPropagation(),children:[t.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Place Prediction"}),t.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close modal",children:t.jsx(De,{size:20})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"font-semibold text-gray-900 text-base",children:r.title}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[t.jsxs("span",{children:[Pe(r.pool_total||0)," Pool"]}),t.jsx("span",{children:""}),t.jsxs("span",{children:[r.participant_count||0," Players"]}),t.jsx("span",{children:""}),t.jsx("span",{children:Bu(r)})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h4",{className:"font-medium text-gray-900",children:"Select your prediction:"}),t.jsx("div",{className:"space-y-2",children:(r.options||[]).map(S=>{const O=S.total_staked||0,C=r.pool_total||1,$=C>0?Math.min(O/C*100,100):50,J=S.current_odds||(O>0?C/O:2);return t.jsx(fr,{className:Ni("cursor-pointer transition-all border-2",i===S.id?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"),onClick:()=>n(S.id),children:t.jsx(mr,{className:"p-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900",children:S.label}),t.jsxs("div",{className:"text-sm text-gray-500",children:[$.toFixed(1),"%"]})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-lg font-bold text-teal-600",children:[J.toFixed(2),"x"]})})]})})},S.id||Math.random())})})]}),t.jsx(xe,{mode:"wait",children:i&&t.jsxs(T.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stake amount"}),t.jsxs("div",{className:"relative",children:[t.jsx(Gn,{type:"number",placeholder:"0.00",value:o,onChange:S=>a(S.target.value),className:"pl-8 pr-4 h-12 text-lg font-medium",min:r.stake_min,max:r.stake_max||m}),t.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"$"})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[t.jsxs("span",{children:["Balance: ",Pe(m)]}),t.jsx("button",{onClick:()=>a(m.toString()),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Max"})]})]}),t.jsx("div",{children:t.jsx("div",{className:"grid grid-cols-3 gap-2",children:y.map(S=>t.jsxs(pr,{variant:"outline",size:"sm",onClick:()=>a(S.toString()),disabled:S>m,className:"text-sm h-10",children:["$",S]},S))})}),x>0&&t.jsx(fr,{className:"bg-teal-50 border-teal-200",children:t.jsx(mr,{className:"p-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Potential return"}),t.jsx("div",{className:"text-lg font-bold text-teal-600",children:Pe(w)})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Profit"}),t.jsx("div",{className:Ni("font-semibold",w>x?"text-teal-600":"text-red-600"),children:Pe(w-x)})]})]})})})]},`amount-input-${i}`)})]}),t.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-200 bg-white",children:t.jsx(pr,{onClick:j,disabled:!i||!x||l||x>m,className:"w-full h-12 bg-teal-500 hover:bg-teal-600 disabled:bg-gray-400 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg flex items-center justify-center",children:l?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),t.jsx("span",{children:"Placing..."})]}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Sn,{size:16}),t.jsxs("span",{children:["Place Prediction (",Pe(x),")"]})]})})})]},"prediction-modal-content")})]})})},Hu=({hasNext:r,loading:e,onLoadMore:s,threshold:i=200,disabled:n=!1})=>{const o=p.useRef(!1),a=p.useCallback(()=>{if(n||e||!r||o.current)return;const d=window.pageYOffset||document.documentElement.scrollTop,c=document.documentElement.scrollHeight,u=window.innerHeight||document.documentElement.clientHeight,h=c-(d+u);h<=i&&(console.log(" Infinite scroll triggered:",{distanceFromBottom:h,threshold:i,hasNext:r,loading:e}),o.current=!0,s(),setTimeout(()=>{o.current=!1},1e3))},[n,e,r,i,s]);return p.useEffect(()=>{if(n)return;let d;const c=()=>{clearTimeout(d),d=setTimeout(a,100)};return window.addEventListener("scroll",c,{passive:!0}),window.addEventListener("touchmove",c,{passive:!0}),()=>{window.removeEventListener("scroll",c),window.removeEventListener("touchmove",c),clearTimeout(d)}},[a,n]),{triggerLoadMore:p.useCallback(()=>{!n&&!e&&r&&!o.current&&(console.log(" Manual infinite scroll trigger"),o.current=!0,s(),setTimeout(()=>{o.current=!1},1e3))},[n,e,r,s])}},Jn=({size:r="md",variant:e="full",className:s="",onClick:i})=>{const o={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"}[r];return t.jsxs("div",{className:`${o} ${s} ${i?"cursor-pointer":""} flex items-center justify-center`,onClick:i,role:i?"button":void 0,tabIndex:i?0:void 0,children:[t.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("circle",{cx:"50",cy:"50",r:"48",fill:"#00F5D4",stroke:"#00F5D4",strokeWidth:"2"}),t.jsx("path",{d:"M 15 15 Q 15 15 35 15 Q 50 15 50 30 Q 50 50 35 50 L 15 50 Q 15 50 15 85 Q 15 85 35 85 Q 85 85 85 50 Q 85 15 50 15 L 35 15 Z",fill:"#7B2FF7"}),t.jsxs("g",{fill:"white",children:[t.jsx("rect",{x:"22",y:"25",width:"6",height:"28"}),t.jsx("rect",{x:"22",y:"25",width:"18",height:"5"}),t.jsx("rect",{x:"22",y:"36",width:"14",height:"4"})]}),t.jsx("g",{fill:"white",transform:"translate(45, 15)",children:t.jsx("path",{d:"M 15 10 Q 5 10 5 20 L 5 30 Q 5 40 15 40 L 25 40 L 25 35 L 15 35 Q 10 35 10 30 L 10 20 Q 10 15 15 15 L 25 15 L 25 10 Z"})})]}),e==="full"&&r!=="sm"&&t.jsx("span",{className:"ml-2 font-bold text-gray-900 text-lg",children:"Fan Club Z"})]})},qu=Ve((r,e)=>({positions:{},saveScrollPosition:(s,i)=>{r(n=>({positions:{...n.positions,[s]:{path:s,scrollY:i,timestamp:Date.now()}}}))},getScrollPosition:s=>{const i=e().positions[s];return i&&Date.now()-i.timestamp<10*60*1e3?i.scrollY:null},clearOldPositions:()=>{const s=Date.now(),i=10*60*1e3;r(n=>({positions:Object.fromEntries(Object.entries(n.positions).filter(([,o])=>s-o.timestamp<i))}))}})),Vu=(r,e={})=>{const[s]=de(),{saveScrollPosition:i,getScrollPosition:n}=qu(),o=p.useRef(""),{saveOnUnmount:a=!0,restoreOnMount:l=!0,preserveFor:d=10,threshold:c=50}=e,u=p.useCallback(()=>r?.current?r.current:document.querySelector("[data-scroll-container]")||document.documentElement,[r]),h=p.useCallback(()=>{const x=u(),g=x===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:x.scrollTop;g>c&&(console.log(` Saving scroll position for ${s}: ${g}px`),i(s,g))},[s,c,i,u]),f=p.useCallback(()=>{const x=u(),g=n(s);return g!==null&&g>0?(console.log(` Restoring scroll position for ${s}: ${g}px`),setTimeout(()=>{x===document.documentElement?window.scrollTo({top:g,behavior:"smooth"}):x.scrollTo({top:g,behavior:"smooth"})},100),!0):!1},[s,n,u]),m=p.useCallback(x=>{const g=u(),b=g===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:g.scrollTop,w=x||s;b>c&&(console.log(` Manually saving scroll for ${w}: ${b}px`),i(w,b))},[s,c,i,u]);return p.useEffect(()=>{let x;return l&&(x=setTimeout(()=>{f()},50)),()=>{x&&clearTimeout(x),a&&h()}},[l,a,f,h]),p.useEffect(()=>{o.current&&o.current!==s&&console.log(` Location changed from ${o.current} to ${s}`),o.current=s},[s]),{saveScroll:m,restoreScroll:f,saveCurrentScroll:h}},Kn=re.memo(function({selectedCategory:e,onSelect:s}){const i=[{id:"all",label:"All",icon:""},{id:"sports",label:"Sports",icon:""},{id:"pop_culture",label:"Pop Culture",icon:""},{id:"custom",label:"Custom",icon:""},{id:"politics",label:"Politics",icon:""},{id:"crypto",label:"Crypto",icon:""},{id:"tech",label:"Tech",icon:""},{id:"finance",label:"Finance",icon:""}];return t.jsx("div",{className:"category-filters bg-white border-b border-gray-100 px-4 py-3","data-tour-id":"category-filters",children:t.jsx("div",{className:"category-filters-container overflow-x-auto -mx-2 px-2",children:t.jsx("div",{className:"category-filters-flex flex gap-2 pb-1",children:i.map(n=>t.jsxs(T.button,{onClick:()=>s(n.id),className:`
                category-pill flex-shrink-0 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium
                transition-all duration-200 whitespace-nowrap
                ${e===n.id?"active bg-purple-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
              `,whileTap:{scale:.96},children:[t.jsx("span",{className:"text-xs",children:n.icon}),t.jsx("span",{children:n.label})]},n.id))})})})});Kn.displayName="CategoryFilters";const Yn=re.memo(function({user:e,stats:s,searchQuery:i,onSearchChange:n,onNavigateToProfile:o}){return t.jsxs("div",{className:"bg-white border-b border-gray-100 sticky top-0 z-50",children:[t.jsx("div",{className:"h-11"}),t.jsxs("div",{className:"px-4 pb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Jn,{size:"md",variant:"icon"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Discover"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Find your next winning prediction"})]})]}),t.jsx("button",{onClick:o,className:"w-10 h-10 rounded-full bg-gradient-to-r from-purple-400 to-purple-500 flex items-center justify-center text-white font-semibold shadow-lg",children:e?.email?.[0]?.toUpperCase()||"U"})]}),t.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-purple-50 to-teal-50 rounded-2xl p-4 mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),t.jsx("span",{className:"text-sm font-medium text-gray-900",children:"LIVE MARKETS"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["$",s?.totalVolume||"0"]}),t.jsx("div",{className:"text-xs text-gray-600",children:"Volume"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-gray-900",children:s?.activePredictions||"0"}),t.jsx("div",{className:"text-xs text-gray-600",children:"Live"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-gray-900",children:s?.totalUsers||"0"}),t.jsx("div",{className:"text-xs text-gray-600",children:"Players"})]})]})]}),t.jsxs("div",{className:"relative","data-tour-id":"search-bar",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(kn,{className:"h-5 w-5 text-gray-400"})}),t.jsx("input",{type:"text",placeholder:"Search predictions...",value:i,onChange:a=>n(a.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-500 focus:bg-white focus:ring-2 focus:ring-purple-500 focus:outline-none transition-all"})]})]})]})});Yn.displayName="MobileHeader";const Zn=re.memo(function({onNavigateToProfile:e,onNavigateToPrediction:s}){const{user:i}=ie(),{predictions:n,loading:o,loadingMore:a,pagination:l,filters:d,refreshPredictions:c,loadMorePredictions:u,setFilters:h}=Pt(),[f,m]=p.useState(null),[x,g]=p.useState(!1),b=p.useRef(null),{saveScroll:w}=Vu(b,{saveOnUnmount:!0,restoreOnMount:!0,preserveFor:15,threshold:100}),[y,j]=p.useState({totalVolume:"0",activePredictions:0,totalUsers:"0",rawVolume:0,rawUsers:0}),S=p.useCallback(async()=>{try{const{getApiUrl:A}=await Nt(()=>Promise.resolve().then(()=>ic),void 0),N=await fetch(`${A()}/api/v2/predictions/stats/platform`);if(N.ok){const E=await N.json();E.success&&(j(E.data),console.log(" Platform stats fetched:",E.data))}else console.error("Failed to fetch platform stats:",N.status)}catch(A){console.error("Error fetching platform stats:",A)}},[]);Hu({hasNext:l.hasNext,loading:a,onLoadMore:u,threshold:300}),p.useEffect(()=>{c(),S()},[c,S]);const O=p.useMemo(()=>({totalVolume:y.totalVolume,activePredictions:y.activePredictions,totalUsers:y.totalUsers}),[y]),C=p.useMemo(()=>!n||!Array.isArray(n)?(console.log(" DiscoverPage Debug - No valid predictions array:",n),[]):(console.log(` DiscoverPage Debug - Displaying ${n.length} predictions`),n.filter(A=>!A||!A.id||!A.title?(console.warn(" DiscoverPage: Invalid prediction object:",A),!1):!0)),[n]),$=p.useCallback(A=>{m(A),g(!0)},[]),J=p.useCallback(A=>{w("/discover"),s?s(A):window.location.href=`/prediction/${A}`},[s,w]),M=p.useCallback(A=>{se.success("Prediction liked!")},[]),K=p.useCallback(A=>{w("/discover"),J(A)},[J,w]),I=p.useCallback(A=>{const N=`Check out this prediction: ${A.title}`,E=`${window.location.origin}/prediction/${A.id}`;navigator.share?navigator.share({title:A.title,text:N,url:E}).catch(console.error):navigator.clipboard.writeText(`${N}
${E}`).then(()=>se.success("Link copied to clipboard!")).catch(()=>se.error("Failed to copy link"))},[]),D=p.useCallback(A=>{console.log(" Search query changed:",A),h({search:A})},[h]),Z=p.useCallback(A=>{console.log(" Category changed:",A),h({category:A})},[h]),k=p.useCallback(()=>{g(!1),m(null)},[]);return o&&(!n||n.length===0)?t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsxs("div",{className:"bg-white border-b border-gray-100",children:[t.jsx("div",{className:"h-11"}),t.jsxs("div",{className:"px-4 pb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-24 mb-2 loading-skeleton"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 loading-skeleton"})]}),t.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full loading-skeleton"})]}),t.jsxs("div",{className:"bg-gray-200 rounded-2xl p-4 mb-4 loading-skeleton",children:[t.jsx("div",{className:"h-4 bg-gray-300 rounded w-20 mb-3 loading-skeleton"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),t.jsx("div",{className:"h-3 bg-gray-300 rounded w-16 mx-auto loading-skeleton"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),t.jsx("div",{className:"h-3 bg-gray-300 rounded w-12 mx-auto loading-skeleton"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),t.jsx("div",{className:"h-3 bg-gray-300 rounded w-14 mx-auto loading-skeleton"})]})]})]}),t.jsx("div",{className:"h-12 bg-gray-200 rounded-xl loading-skeleton"})]})]}),t.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:t.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[1,2,3,4,5,6].map(A=>t.jsx("div",{className:"h-8 bg-gray-200 rounded-full w-20 flex-shrink-0 loading-skeleton"},A))})}),t.jsxs("div",{className:"py-4",children:[t.jsxs("div",{className:"px-4 mb-6",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 loading-skeleton"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 loading-skeleton"})]}),t.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(A=>t.jsx(Ru,{},A))})]})]}):t.jsxs("div",{ref:b,className:"discover-page content-with-bottom-nav","data-scroll-container":!0,style:{position:"relative",zIndex:1,overflowY:"auto",height:"100vh"},children:[t.jsx("div",{className:"discover-header",children:t.jsx("div",{className:"header-content",children:t.jsx(Yn,{user:i,stats:O,searchQuery:d.search,onSearchChange:D,onNavigateToProfile:e||(()=>{})})})}),t.jsx("div",{className:"category-filters-wrapper",style:{position:"relative",zIndex:45},children:t.jsx(Kn,{selectedCategory:d.category,onSelect:Z})}),t.jsxs("div",{className:"prediction-cards-container",children:[t.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-1","data-tour-id":"discover-list",children:[d.category==="all"?"All Predictions":`${d.category} Predictions`,d.search&&` - "${d.search}"`]}),l.total>0&&t.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",C.length," of ",l.total," predictions",l.hasNext&&"  Scroll for more"]})]}),t.jsx("div",{className:"space-y-2",children:t.jsx(xe,{mode:"wait",children:C.length>0?t.jsxs(t.Fragment,{children:[C.map((A,N)=>!A||!A.id?(console.warn(" DiscoverPage: Skipping invalid prediction at index",N),null):t.jsx($u,{prediction:A,variant:"compact",onPredict:()=>$(A),onLike:()=>M(A.id),onComment:()=>K(A.id),onShare:()=>I(A)},`${A.id}-${N}`)),a&&t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center py-8",children:[t.jsx(id,{className:"w-6 h-6 animate-spin text-purple-500 mr-3"}),t.jsx("span",{className:"text-gray-600",children:"Loading more predictions..."})]}),!l.hasNext&&!a&&C.length>10&&t.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:t.jsx("p",{className:"text-gray-500 text-sm",children:" You've seen all predictions!"})})]}):t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"text-center py-12 px-4",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(ke,{size:24,className:"text-gray-400"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No predictions found"}),t.jsx("p",{className:"text-gray-600",children:d.search?`No predictions match "${d.search}"`:o?"Loading predictions...":"Try adjusting your filters or check back later"}),!o&&!d.search&&t.jsx("button",{onClick:()=>c(!0),className:"mt-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"Refresh Predictions"})]})})})]}),t.jsx(Wu,{prediction:f,isOpen:x,onClose:k})]})});Zn.displayName="DiscoverPage";const Tt=Ve((r,e)=>({approvedSources:[],settlementConfigs:{},settlements:{},playerAcceptances:{},disputes:{},auditTimeline:{},loading:!1,error:null,selectedSource:null,settlementModalOpen:!1,disputeModalOpen:!1,fetchApprovedSources:async s=>{r({loading:!0,error:null});try{let i=W.from("approved_sources").select("*").eq("status","approved").order("name");s&&(i=i.eq("category",s));const{data:n,error:o}=await i;if(o)throw o;r({approvedSources:n||[]})}catch(i){console.error("Error fetching approved sources:",i),r({error:"Failed to fetch approved sources"})}finally{r({loading:!1})}},createSettlementConfig:async(s,i)=>{r({loading:!0,error:null});try{const{data:n,error:o}=await W.from("settlement_configs").insert({prediction_id:s,method:i.method||"manual",primary_source_id:i.primary_source_id,backup_source_id:i.backup_source_id,rule_text:i.rule_text||"",timezone:i.timezone||"Africa/Lagos",contingencies:i.contingencies||{},risk_flags:i.risk_flags||[],badges:i.badges||[]}).select().single();if(o)throw o;r(a=>({settlementConfigs:{...a.settlementConfigs,[s]:n}}))}catch(n){console.error("Error creating settlement config:",n),r({error:"Failed to create settlement configuration"})}finally{r({loading:!1})}},fetchSettlement:async s=>{r({loading:!0,error:null});try{const{data:i,error:n}=await W.from("settlements").select("*").eq("prediction_id",s).single();if(n&&n.code!=="PGRST116")throw n;i&&r(o=>({settlements:{...o.settlements,[s]:i}}))}catch(i){console.error("Error fetching settlement:",i),r({error:"Failed to fetch settlement data"})}finally{r({loading:!1})}},updateSettlementState:async(s,i,n,o)=>{r({loading:!0,error:null});try{const{data:a,error:l}=await W.rpc("update_settlement_state",{prediction_uuid:s,new_state:i,outcome_val:n,proof_data:o||{}});if(l)throw l;await e().fetchSettlement(s)}catch(a){console.error("Error updating settlement state:",a),r({error:"Failed to update settlement state"})}finally{r({loading:!1})}},acceptOutcome:async s=>{r({loading:!0,error:null});try{const{data:{user:i}}=await W.auth.getUser();if(!i)throw new Error("User not authenticated");const{error:n}=await W.rpc("record_player_acceptance",{prediction_uuid:s,user_uuid:i.id,action_val:"accepted"});if(n)throw n;await e().fetchPlayerAcceptances(s)}catch(i){console.error("Error accepting outcome:",i),r({error:"Failed to accept outcome"})}finally{r({loading:!1})}},createDispute:async(s,i,n)=>{r({loading:!0,error:null});try{const{data:{user:o}}=await W.auth.getUser();if(!o)throw new Error("User not authenticated");const{error:a}=await W.rpc("create_dispute",{prediction_uuid:s,user_uuid:o.id,reason_val:i,evidence_data:n||[]});if(a)throw a;await e().fetchDisputes(s)}catch(o){console.error("Error creating dispute:",o),r({error:"Failed to create dispute"})}finally{r({loading:!1})}},fetchPlayerAcceptances:async s=>{try{const{data:i,error:n}=await W.from("player_acceptances").select("*").eq("prediction_id",s).order("timestamp",{ascending:!1});if(n)throw n;r(o=>({playerAcceptances:{...o.playerAcceptances,[s]:i||[]}}))}catch(i){console.error("Error fetching player acceptances:",i)}},fetchDisputes:async s=>{try{const{data:i,error:n}=await W.from("disputes").select("*").eq("prediction_id",s).order("opened_at",{ascending:!1});if(n)throw n;r(o=>({disputes:{...o.disputes,[s]:i||[]}}))}catch(i){console.error("Error fetching disputes:",i)}},fetchAuditTimeline:async s=>{try{const{data:i,error:n}=await W.from("audit_timeline").select("*").eq("prediction_id",s).order("timestamp",{ascending:!1});if(n)throw n;r(o=>({auditTimeline:{...o.auditTimeline,[s]:i||[]}}))}catch(i){console.error("Error fetching audit timeline:",i)}},setSelectedSource:s=>r({selectedSource:s}),setSettlementModalOpen:s=>r({settlementModalOpen:s}),setDisputeModalOpen:s=>r({disputeModalOpen:s}),clearError:()=>r({error:null})})),Gu=({onNavigateBack:r})=>{const[e,s]=p.useState(1),[i,n]=p.useState(!1),[o,a]=p.useState(!1),{createPrediction:l}=Pt(),{user:d,isAuthenticated:c}=ie(),[,u]=de();p.useEffect(()=>{yt({delay:200})},[]);const[h,f]=p.useState(""),[m,x]=p.useState(""),[g,b]=p.useState(""),[w,y]=p.useState("binary"),[j,S]=p.useState([{id:"1",label:"Yes"},{id:"2",label:"No"}]),[O,C]=p.useState(""),[$,J]=p.useState("1"),[M,K]=p.useState("1000"),[I,D]=p.useState("manual"),[Z,k]=p.useState(!1),[A,N]=p.useState(null),[E,v]=p.useState(null),[_,L]=p.useState(""),[P,R]=p.useState("Africa/Lagos"),[F,te]=p.useState({postponed:"auto_void",source_down:"use_backup"}),Y=[{id:"sports",label:"Sports",icon:"",gradient:"from-orange-500 to-red-500"},{id:"politics",label:"Politics",icon:"",gradient:"from-blue-500 to-indigo-500"},{id:"entertainment",label:"Entertainment",icon:"",gradient:"from-purple-500 to-pink-500"},{id:"crypto",label:"Crypto",icon:"",gradient:"from-yellow-500 to-orange-500"},{id:"tech",label:"Technology",icon:"",gradient:"from-purple-500 to-teal-500"},{id:"custom",label:"Custom",icon:"",gradient:"from-gray-500 to-gray-600"}],oe=[{id:"binary",label:"Yes/No",description:"Simple binary outcome prediction",icon:""},{id:"multiple",label:"Multiple Choice",description:"Multiple possible outcomes",icon:""}],_e=p.useCallback(()=>{const U=(j.length+1).toString();S(ae=>[...ae,{id:U,label:""}])},[j.length]),Ps=p.useCallback(U=>{S(ae=>ae.filter(ye=>ye.id!==U))},[]),At=p.useCallback((U,ae)=>{S(ye=>ye.map(ue=>ue.id===U?{...ue,label:ae}:ue))},[]),Se=p.useCallback(U=>{switch(U){case 1:return!!(h.trim()&&g);case 2:return!!(w&&j.every(ae=>ae.label.trim()));case 3:return!!(O&&$);case 4:return!0;default:return!0}},[h,g,w,j,O,$]),Es=p.useCallback(()=>{Se(e)&&e<4&&(s(e+1),yt({delay:150}))},[e,Se]),Yt=p.useCallback(()=>{e>1?(s(e-1),yt({delay:150})):r&&r()},[e,r]),Ts=p.useCallback(async()=>{if(!Se(4)){G.error("Please fill in all required fields");return}n(!0);try{if(!h.trim())throw new Error("Title is required");if(!g)throw new Error("Category is required");if(!O)throw new Error("Entry deadline is required");const U=new Date(O);if(U<=new Date)throw new Error("Entry deadline must be in the future");if(!c||!d?.id)throw new Error("You must be logged in to create predictions");const ae={title:h.trim(),description:m.trim()||void 0,category:g,type:w,options:j.filter(ue=>ue.label.trim()).map(ue=>({id:ue.id,label:ue.label.trim(),totalStaked:0,currentOdds:2})),entryDeadline:U,stakeMin:Math.max(1,parseFloat($)||100),stakeMax:M?Math.max(parseFloat($)||100,parseFloat(M)):void 0,settlementMethod:I,isPrivate:Z,creatorId:d.id};if(ae.options.length<2)throw new Error("At least 2 prediction options are required");console.log("Creating prediction with data:",ae);const ye=await l(ae);if(console.log("Prediction created successfully!",ye),I==="auto"&&ye)try{const{createSettlementConfig:ue}=Tt.getState();await ue(ye.id,{method:"web",primary_source_id:A?.id,backup_source_id:E?.id,rule_text:_||`Check if ${h} by ${O}`,timezone:P,contingencies:F}),console.log("Settlement configuration created successfully!")}catch(ue){console.error("Failed to create settlement configuration:",ue)}G.success(" Prediction created successfully!"),a(!0),setTimeout(()=>{s(1),f(""),x(""),b(""),y("binary"),S([{id:"1",label:"Yes"},{id:"2",label:"No"}]),C(""),J("100"),K("10000"),D("manual"),k(!1),a(!1),n(!1),r&&(r(),setTimeout(()=>{u("/predictions")},100))},2e3)}catch(U){console.error("Failed to create prediction:",U);const ae=U instanceof Error?U.message:"Failed to create prediction. Please try again.";G.error(ae),n(!1)}},[Se,h,g,O,m,w,j,$,M,I,Z,l,r,u]);return o?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-teal-100 flex items-center justify-center px-6",children:t.jsxs(T.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white rounded-3xl p-8 text-center shadow-2xl border border-teal-200",children:[t.jsx(T.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200,damping:10},className:"w-16 h-16 bg-teal-500 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx(mi,{size:32,className:"text-white"})}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Prediction Created!"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Your prediction has been successfully created and is now live."}),t.jsx("div",{className:"text-sm text-teal-600 font-medium",children:"Redirecting to My Predictions..."})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 pb-20 create-prediction-page",children:[t.jsxs("div",{className:"relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 via-green-700 to-teal-600"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 via-transparent to-purple-600/10"}),t.jsx("div",{className:"absolute top-0 right-1/3 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse"}),t.jsx("div",{className:"absolute bottom-0 left-1/3 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),t.jsxs("div",{className:"relative z-10 px-6 pt-14 pb-8",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(T.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:Yt,className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white",children:t.jsx(Ct,{size:20})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white",children:"Create Prediction"}),t.jsxs("p",{className:"text-green-100",children:["Step ",e," of 4"]})]})]}),t.jsx("div",{className:"bg-white/20 rounded-full h-2 mb-6",children:t.jsx(T.div,{initial:{width:0},animate:{width:`${e/4*100}%`},transition:{duration:.5},className:"h-full bg-white rounded-full"})})]})]}),t.jsx("div",{className:"px-6 -mt-4 pb-8 relative z-20",children:t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/90 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-2xl p-6",children:[t.jsxs(xe,{mode:"wait",initial:!1,children:[e===1&&t.jsxs(T.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-teal-600 rounded-2xl flex items-center justify-center",children:t.jsx(Ss,{size:24,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Basic Information"}),t.jsx("p",{className:"text-gray-600",children:"Tell us about your prediction"})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"input-container",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Prediction Title *"}),t.jsx("input",{type:"text",value:h,onChange:U=>f(U.target.value),placeholder:"Will Bitcoin reach $100,000 by end of 2024?",className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-teal-500 focus:outline-none transition-all duration-200 text-gray-900 placeholder-gray-500"})]}),t.jsxs("div",{className:"textarea-container",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description (Optional)"}),t.jsx("textarea",{value:m,onChange:U=>x(U.target.value),placeholder:"Provide additional context and rules for your prediction...",rows:4,className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-teal-500 focus:outline-none transition-all duration-200 text-gray-900 placeholder-gray-500 resize-none"})]}),t.jsxs("div",{className:"form-section",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Category *"}),t.jsx("div",{className:"flex flex-wrap gap-3",children:Y.map(U=>t.jsxs(T.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>b(U.id),className:`motion-button pill-category px-4 py-2.5 rounded-full text-sm font-semibold transition-all flex items-center gap-2 min-h-[40px] ${g===U.id?`bg-gradient-to-r ${U.gradient} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"}`,children:[t.jsx("span",{className:"text-base",children:U.icon}),t.jsx("span",{children:U.label})]},U.id))})]})]})]},"step1"),e===2&&t.jsxs(T.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center",children:t.jsx(Wt,{size:24,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Prediction Setup"}),t.jsx("p",{className:"text-gray-600",children:"Configure your prediction options"})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Prediction Type *"}),t.jsx("div",{className:"space-y-3",children:oe.map(U=>t.jsx(T.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>{y(U.id),U.id==="binary"?S([{id:"1",label:"Yes"},{id:"2",label:"No"}]):U.id==="multiple"&&S([{id:"1",label:""},{id:"2",label:""},{id:"3",label:""}])},className:`motion-button w-full p-4 rounded-2xl border-2 text-left transition-all duration-200 ${w===U.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}`,children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"text-2xl",children:U.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:U.label}),t.jsx("p",{className:"text-sm text-gray-600",children:U.description})]})]})},U.id))})]}),(w==="binary"||w==="multiple")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Prediction Options *"}),t.jsxs("div",{className:"space-y-3",children:[j.map((U,ae)=>t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"input-container flex-1",children:t.jsx("input",{type:"text",value:U.label,onChange:ye=>At(U.id,ye.target.value),placeholder:`Option ${ae+1}`,className:"w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all duration-200"})}),w==="multiple"&&j.length>2&&t.jsx(T.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>Ps(U.id),className:"motion-button w-10 h-10 bg-red-100 text-red-600 rounded-xl flex items-center justify-center hover:bg-red-200 transition-colors",children:t.jsx(De,{size:18})})]},U.id)),w==="multiple"&&j.length<6&&t.jsxs(T.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:_e,className:"motion-button w-full p-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-600 hover:border-blue-400 hover:text-blue-600 transition-all duration-200 flex items-center justify-center gap-2",children:[t.jsx(ct,{size:18}),t.jsx("span",{children:"Add Option"})]})]})]})]})]},"step2"),e===3&&t.jsxs(T.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center",children:t.jsx(hs,{size:24,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Settings & Launch"}),t.jsx("p",{className:"text-gray-600",children:"Final configuration details"})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"input-container",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Entry Deadline *"}),t.jsx("input",{type:"datetime-local",value:O,onChange:U=>C(U.target.value),min:new Date().toISOString().slice(0,16),className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-teal-500 focus:outline-none transition-all duration-200"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"input-container",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Minimum Stake ($)"}),t.jsx("input",{type:"number",value:$,onChange:U=>J(U.target.value),placeholder:"100",min:"1",className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-teal-500 focus:outline-none transition-all duration-200"})]}),t.jsxs("div",{className:"input-container",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Maximum Stake ($)"}),t.jsx("input",{type:"number",value:M,onChange:U=>K(U.target.value),placeholder:"100000",min:$||"1",className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-teal-500 focus:outline-none transition-all duration-200"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Settlement Method"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(T.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>D("manual"),className:`w-full p-4 rounded-2xl border-2 text-left transition-all duration-200 ${I==="manual"?"border-teal-500 bg-teal-50":"border-gray-200 bg-white hover:border-teal-300"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center",children:t.jsx(_n,{size:16,className:"text-teal-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Manual Settlement"}),t.jsx("p",{className:"text-sm text-gray-600",children:"You resolve the prediction manually"})]})]})}),t.jsx(T.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>D("auto"),className:`w-full p-4 rounded-2xl border-2 text-left transition-all duration-200 ${I==="auto"?"border-teal-500 bg-teal-50":"border-gray-200 bg-white hover:border-teal-300"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx(Wt,{size:16,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Automatic Settlement"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Resolved automatically when possible"})]})]})})]})]}),t.jsx("div",{className:"bg-gray-50 rounded-2xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Private Prediction"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Only people with link can participate"})]}),t.jsx(T.button,{whileTap:{scale:.95},onClick:()=>k(!Z),className:`relative w-12 h-6 rounded-full transition-all duration-200 ${Z?"bg-teal-500":"bg-gray-300"}`,children:t.jsx(T.div,{animate:{x:Z?24:2},transition:{type:"spring",stiffness:500,damping:30},className:"absolute top-1 w-4 h-4 bg-white rounded-full shadow"})})]})})]})]},"step3"),e===4&&t.jsxs(T.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center",children:t.jsx(mi,{size:24,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Preview & Confirm"}),t.jsx("p",{className:"text-gray-600",children:"Review your prediction before publishing"})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Prediction Preview"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Title"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:h})]}),m&&t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Description"}),t.jsx("p",{className:"text-gray-700",children:m})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Category"}),t.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:Y.find(U=>U.id===g)?.label||g})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Options"}),t.jsx("div",{className:"space-y-2",children:j.map((U,ae)=>t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[t.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Option ",ae+1,":"]}),t.jsx("span",{className:"font-semibold text-gray-900",children:U.label})]},U.id))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Stake Limits"}),t.jsxs("p",{className:"text-gray-900",children:["$",$," - $",M]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Deadline"}),t.jsx("p",{className:"text-gray-900",children:new Date(O).toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Settlement"}),t.jsx("p",{className:"text-gray-900 capitalize",children:I})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Privacy"}),t.jsx("p",{className:"text-gray-900",children:Z?"Private":"Public"})]})]})]}),t.jsx("div",{className:"bg-teal-50 border border-teal-200 rounded-2xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ft,{size:20,className:"text-teal-600"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-teal-800",children:"Ready to Publish"}),t.jsx("p",{className:"text-sm text-teal-700",children:'Your prediction looks good! Click "Create Prediction" to publish it.'})]})]})})]})]},"step4")]}),t.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[t.jsx(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Yt,className:"px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-all duration-200",children:e===1?"Cancel":"Back"}),e<4?t.jsx(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Es,disabled:!Se(e),className:`px-8 py-3 font-semibold rounded-xl shadow-lg transition-all duration-200 ${Se(e)?"bg-gradient-to-r from-purple-500 to-teal-600 text-white shadow-purple-500/25 hover:shadow-xl hover:shadow-purple-500/30":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:e===3?"Preview":"Continue"}):t.jsx(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Ts,disabled:!Se(4)||i,className:`px-8 py-3 font-semibold rounded-xl shadow-lg transition-all duration-200 flex items-center gap-2 ${Se(4)&&!i?"bg-gradient-to-r from-purple-500 to-teal-600 text-white shadow-purple-500/25 hover:shadow-xl hover:shadow-purple-500/30":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:i?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):"Create Prediction"})]})]})})]})},Ju=({onNavigateToDiscover:r})=>{const[,e]=de(),{predictions:s,getUserCreatedPredictions:i,fetchUserCreatedPredictions:n,fetchUserPredictionEntries:o,getUserPredictionEntries:a,loading:l}=Pt(),{user:d,isAuthenticated:c}=ie(),[u,h]=p.useState("Active"),[f,m]=p.useState(!1),[x,g]=p.useState(null),b=k=>{if(!k)return"2d 14h";const A=new Date().getTime(),N=new Date(k).getTime()-A;if(N<=0)return"Ended";const E=Math.floor(N/(1e3*60*60*24)),v=Math.floor(N%(1e3*60*60*24)/(1e3*60*60));return E>0?`${E}d ${v}h`:`${v}h`},w=k=>{if(!k||!k.options)return 68;const A=k.options.reduce((E,v)=>E+(v.total_staked||0),0);if(A===0)return 68;const N=Math.max(...k.options.map(E=>E.total_staked||0));return Math.round(N/A*100)};p.useEffect(()=>{window.scrollTo({behavior:"instant"})},[]),p.useEffect(()=>{if(!d?.id||!c)return;let k=!0,A=!1;const N=setTimeout(()=>{!k||A||(console.log(" BetsTab: Fetching data for user:",d.id),n(d.id),o(d.id),A=!0)},100);return()=>{k=!1,clearTimeout(N)}},[d?.id,c]);const j=(()=>{if(!c||!d)return{active:0,created:0,completed:0};const k=i(d.id),A=a(d.id),N=A.filter(v=>v.status==="active"),E=A.filter(v=>v.status==="won"||v.status==="lost");return{active:N.length,created:k.length,completed:E.length}})(),S=[{id:"Active",label:"Active",icon:ke,count:j.active},{id:"Created",label:"Created",icon:ls,count:j.created},{id:"Completed",label:"Completed",icon:Ft,count:j.completed}],O=()=>{if(!c||!d)return{Active:[],Created:[],Completed:[]};const k=a(d.id),A=i(d.id),N=k.filter(_=>_.status==="active").map(_=>{const L=_.prediction||s.find(F=>F.id===_.prediction_id);if(!L)return console.warn(" No prediction found for entry:",_.id),null;const P=_.option||L.options?.find(F=>F.id===_.option_id),R=b(L.entry_deadline);return{id:_.id,title:L.title,category:L.category,position:P?.label||"Unknown",stake:_.amount,potentialReturn:_.potential_payout||0,odds:_.potential_payout?`${(_.potential_payout/_.amount).toFixed(2)}x`:"1.00x",timeRemaining:R,status:"active",participants:L.participant_count||0,confidence:w(L)}}).filter(Boolean),E=A.map(_=>{const L=b(_.entry_deadline);return{id:_.id,title:_.title,category:_.category,totalPool:_.pool_total||0,participants:_.participant_count||0,timeRemaining:L,status:_.status,yourCut:_.creator_fee_percentage||3.5,description:_.description,pool_total:_.pool_total,participant_count:_.participant_count,creator_fee_percentage:_.creator_fee_percentage,entry_deadline:_.entry_deadline}}),v=k.filter(_=>_.status==="won"||_.status==="lost").map(_=>{const L=_.prediction||s.find(F=>F.id===_.prediction_id);if(!L)return console.warn(" No prediction found for completed entry:",_.id),null;const P=_.option||L.options?.find(F=>F.id===_.option_id),R=(_.actual_payout||0)-_.amount;return{id:_.id,title:L.title,category:L.category,position:P?.label||"Unknown",stake:_.amount,actualReturn:_.actual_payout||0,profit:R,status:_.status,participants:L.participant_count||0,settledAt:new Date(_.updated_at).toLocaleDateString()}}).filter(Boolean);return{Active:N,Created:E,Completed:v}},$=p.useMemo(()=>{try{return O()}catch(k){return console.error("Error getting user predictions:",k),{Active:[],Created:[],Completed:[]}}},[d?.id,c,s,u])[u]||[],J=k=>{switch(k){case"active":return"bg-emerald-50 text-emerald-700 border-emerald-200";case"winning":return"bg-green-50 text-green-700 border-green-200";case"losing":return"bg-red-50 text-red-700 border-red-200";case"open":return"bg-blue-50 text-blue-700 border-blue-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}},M=k=>({custom:"bg-orange-100 text-orange-700",sports:"bg-blue-100 text-blue-700",esports:"bg-purple-100 text-purple-700",pop_culture:"bg-pink-100 text-pink-700",politics:"bg-red-100 text-red-700",celebrity_gossip:"bg-green-100 text-green-700"})[k]||"bg-gray-100 text-gray-700";if(!c)return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsx("div",{className:"px-6 pt-12 pb-6",children:t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"My Predictions"})})}),t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:t.jsx(ls,{className:"w-10 h-10 text-gray-400"})}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Sign in to view your predictions"}),t.jsx("p",{className:"text-gray-600 text-center mb-8 max-w-sm",children:"Create an account or sign in to track your predictions, manage your portfolio, and engage with the community."}),t.jsxs(T.button,{className:"bg-emerald-500 hover:bg-emerald-600 text-white px-8 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2",onClick:()=>{r&&r()},whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(ct,{className:"w-5 h-5"}),"Explore Predictions"]})]})]});const K=({tab:k})=>t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[t.jsxs("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:[k==="Active"&&t.jsx(ke,{className:"w-10 h-10 text-gray-400"}),k==="Created"&&t.jsx(ls,{className:"w-10 h-10 text-gray-400"}),k==="Completed"&&t.jsx(Ft,{className:"w-10 h-10 text-gray-400"})]}),t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:["No ",k.toLowerCase()," predictions"]}),t.jsxs("p",{className:"text-gray-600 text-center mb-8 max-w-sm",children:[k==="Active"&&"You haven't made any predictions yet. Start by exploring trending topics!",k==="Created"&&"You haven't created any predictions yet. Share your insights with the community!",k==="Completed"&&"Your prediction history will appear here once you complete some predictions."]}),t.jsxs(T.button,{className:"bg-emerald-500 hover:bg-emerald-600 text-white px-8 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2",onClick:()=>{k==="Created"?(e("/create"),window.scrollTo({behavior:"instant"})):r&&r()},whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(ct,{className:"w-5 h-5"}),k==="Created"?"Create Prediction":"Explore Predictions"]})]}),I=({prediction:k})=>t.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-4 hover:shadow-md transition-all duration-200",children:[t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${M(k.category)}`,children:k.category.replace("_"," ")}),t.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium border ${J(k.status)}`,children:"Active"})]}),t.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:k.title})]})}),t.jsxs("div",{className:"bg-emerald-50 rounded-xl p-4 mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-emerald-800",children:"Your Position"}),t.jsx("span",{className:"text-lg font-bold text-emerald-700",children:k.position})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"Staked"}),t.jsxs("p",{className:"font-semibold text-emerald-900",children:["$",k.stake.toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"Potential"}),t.jsxs("p",{className:"font-semibold text-emerald-900",children:["$",k.potentialReturn.toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"Odds"}),t.jsx("p",{className:"font-semibold text-emerald-900",children:k.odds})]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Market Confidence"}),t.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[k.confidence,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:`${k.confidence}%`}})})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[t.jsxs("span",{children:[k.participants," participants"]}),t.jsxs("span",{className:"font-medium text-amber-600",children:[k.timeRemaining," left"]})]})]}),D=({prediction:k})=>t.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-4 hover:shadow-md transition-all duration-200",children:[t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${M(k.category)}`,children:k.category.replace("_"," ")}),t.jsx("span",{className:"px-2 py-1 rounded-lg text-xs font-medium border bg-blue-50 text-blue-700 border-blue-200",children:k.status==="open"?"Open":k.status})]}),t.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:k.title})]})}),t.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-4",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Total Pool"}),t.jsxs("p",{className:"font-semibold text-blue-900",children:["$",k.totalPool.toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Participants"}),t.jsx("p",{className:"font-semibold text-blue-900",children:k.participants})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Your Cut"}),t.jsxs("p",{className:"font-semibold text-blue-900",children:[k.yourCut,"%"]})]})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Closes in ",k.timeRemaining]}),t.jsxs(T.button,{onClick:()=>{g(k),m(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium text-sm flex items-center gap-1 hover:bg-blue-700 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:["Manage ",t.jsx(Wt,{className:"w-4 h-4"})]})]})]}),Z=({prediction:k})=>t.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-4 hover:shadow-md transition-all duration-200",children:[t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${M(k.category)}`,children:k.category.replace("_"," ")}),t.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium border ${k.status==="won"?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:k.status==="won"?"Won":"Lost"})]}),t.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:k.title})]})}),t.jsxs("div",{className:`rounded-xl p-4 mb-4 ${k.status==="won"?"bg-green-50":"bg-red-50"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("span",{className:`text-sm font-medium ${k.status==="won"?"text-green-800":"text-red-800"}`,children:["Your Position: ",k.position]}),t.jsxs("span",{className:`text-lg font-bold ${k.status==="won"?"text-green-700":"text-red-700"}`,children:[k.profit>=0?"+":"","$",Math.abs(k.profit).toLocaleString()]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-xs mb-1 ${k.status==="won"?"text-green-600":"text-red-600"}`,children:"Staked"}),t.jsxs("p",{className:`font-semibold ${k.status==="won"?"text-green-900":"text-red-900"}`,children:["$",k.stake.toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx("p",{className:`text-xs mb-1 ${k.status==="won"?"text-green-600":"text-red-600"}`,children:"Returned"}),t.jsxs("p",{className:`font-semibold ${k.status==="won"?"text-green-900":"text-red-900"}`,children:["$",k.actualReturn.toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx("p",{className:`text-xs mb-1 ${k.status==="won"?"text-green-600":"text-red-600"}`,children:"Profit/Loss"}),t.jsxs("p",{className:`font-semibold ${k.status==="won"?"text-green-900":"text-red-900"}`,children:[k.profit>=0?"+":"","$",Math.abs(k.profit).toLocaleString()]})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[t.jsxs("span",{children:[k.participants," participants"]}),t.jsxs("span",{children:["Settled ",k.settledAt]})]})]});return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsxs("div",{className:"px-6 pt-12 pb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"My Predictions"}),t.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-xl","data-tour-id":"bets-tabs",children:S.map(k=>{const A=k.icon;return t.jsxs("button",{onClick:()=>h(k.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ${u===k.id?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[t.jsx(A,{className:"w-4 h-4"}),t.jsx("span",{children:k.label}),k.count>0&&t.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${u===k.id?"bg-emerald-100 text-emerald-700":"bg-gray-200 text-gray-600"}`,children:k.count})]},k.id)})})]})}),t.jsx("div",{className:"px-6 py-6",children:l?t.jsxs("div",{className:"flex items-center justify-center py-16",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"ml-3 text-gray-600",children:"Loading predictions..."})]}):$.length>0?t.jsxs("div",{className:"space-y-4",children:[u==="Active"&&$.map((k,A)=>!k||typeof k.id>"u"?(console.warn("Invalid prediction object:",k),null):t.jsx(I,{prediction:k},`active-${k.id}-${A}`)),u==="Created"&&$.map((k,A)=>!k||typeof k.id>"u"?(console.warn("Invalid prediction object:",k),null):t.jsx(D,{prediction:k},`created-${k.id}-${A}`)),u==="Completed"&&$.map((k,A)=>!k||typeof k.id>"u"?(console.warn("Invalid prediction object:",k),null):t.jsx(Z,{prediction:k},`completed-${k.id}-${A}`))]}):t.jsx(K,{tab:u})})]})};class Ku{constructor(e){ee(this,"options");ee(this,"element");ee(this,"startY",0);ee(this,"currentY",0);ee(this,"pullDistance",0);ee(this,"isRefreshing",!1);ee(this,"isPulling",!1);ee(this,"rafId",null);ee(this,"indicatorElement",null);ee(this,"disabled",!1);this.options={threshold:80,element:document.body,disabled:!1,...e},this.element=this.options.element,this.disabled=this.options.disabled,this.init()}init(){this.createIndicator(),this.bindEvents()}createIndicator(){this.indicatorElement=document.createElement("div"),this.indicatorElement.className="pull-to-refresh-indicator",this.indicatorElement.innerHTML=`
      <div class="pull-to-refresh-content">
        <div class="pull-to-refresh-icon">
          <svg class="pull-to-refresh-arrow" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12l7-7 7 7"/>
          </svg>
          <svg class="pull-to-refresh-spinner" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-6.219-8.56"/>
          </svg>
        </div>
        <span class="pull-to-refresh-text">Pull to refresh</span>
      </div>
    `;const e=document.createElement("style");e.textContent=`
      .pull-to-refresh-indicator {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 80px;
        background: linear-gradient(135deg, #10b981, #059669);
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-80px);
        transition: transform 0.2s ease;
        z-index: 9999;
        color: white;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .pull-to-refresh-indicator.visible {
        transform: translateY(0);
      }
      
      .pull-to-refresh-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      
      .pull-to-refresh-icon {
        position: relative;
        width: 24px;
        height: 24px;
      }
      
      .pull-to-refresh-arrow,
      .pull-to-refresh-spinner {
        position: absolute;
        top: 0;
        left: 0;
        transition: opacity 0.2s ease, transform 0.2s ease;
      }
      
      .pull-to-refresh-arrow {
        opacity: 1;
        transform: rotate(180deg);
      }
      
      .pull-to-refresh-spinner {
        opacity: 0;
        animation: spin 1s linear infinite;
      }
      
      .pull-to-refresh-indicator.refreshing .pull-to-refresh-arrow {
        opacity: 0;
      }
      
      .pull-to-refresh-indicator.refreshing .pull-to-refresh-spinner {
        opacity: 1;
      }
      
      .pull-to-refresh-indicator.ready .pull-to-refresh-arrow {
        transform: rotate(0deg);
      }
      
      .pull-to-refresh-text {
        font-size: 14px;
        font-weight: 500;
      }
      
      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
    `,document.head.querySelector("#pull-to-refresh-styles")||(e.id="pull-to-refresh-styles",document.head.appendChild(e)),document.body.appendChild(this.indicatorElement)}bindEvents(){this.element.addEventListener("touchstart",this.onTouchStart.bind(this),{passive:!0}),this.element.addEventListener("touchmove",this.onTouchMove.bind(this),{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd.bind(this))}unbindEvents(){this.element.removeEventListener("touchstart",this.onTouchStart.bind(this)),this.element.removeEventListener("touchmove",this.onTouchMove.bind(this)),this.element.removeEventListener("touchend",this.onTouchEnd.bind(this))}findScrollableParent(e){let s=e.parentElement;for(;s;){const n=window.getComputedStyle(s).overflowY;if(n==="auto"||n==="scroll"||s.scrollHeight>s.clientHeight)return s;s=s.parentElement}return null}onTouchStart(e){if(this.disabled||this.isRefreshing||window.scrollY>5)return;const s=e.target,i=this.findScrollableParent(s);i&&i.scrollTop>5||(this.startY=e.touches[0].clientY,this.isPulling=!1)}onTouchMove(e){if(this.disabled||this.isRefreshing)return;this.currentY=e.touches[0].clientY,this.pullDistance=Math.max(0,this.currentY-this.startY);const s=window.scrollY<=5,i=e.target,n=this.findScrollableParent(i),o=!n||n.scrollTop<=5;this.pullDistance>50&&s&&o&&(e.preventDefault(),this.isPulling=!0,this.updateIndicator())}onTouchEnd(){this.disabled||this.isRefreshing||!this.isPulling||(this.pullDistance>=this.options.threshold?this.refresh():this.resetIndicator(),this.isPulling=!1,this.pullDistance=0)}updateIndicator(){if(!this.indicatorElement)return;const e=Math.min(1,this.pullDistance/this.options.threshold),s=Math.min(0,e*80-80);this.indicatorElement.style.transform=`translateY(${s}px)`,this.pullDistance>=this.options.threshold?(this.indicatorElement.classList.add("ready"),this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Release to refresh"):(this.indicatorElement.classList.remove("ready"),this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Pull to refresh")}async refresh(){if(this.indicatorElement){this.isRefreshing=!0,this.indicatorElement.classList.add("refreshing","visible"),this.indicatorElement.style.transform="translateY(0)",this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Refreshing...";try{await this.options.onRefresh()}catch(e){console.error("Pull to refresh error:",e)}await new Promise(e=>setTimeout(e,1e3)),this.resetIndicator()}}resetIndicator(){this.indicatorElement&&(this.isRefreshing=!1,this.indicatorElement.classList.remove("refreshing","ready","visible"),this.indicatorElement.style.transform="translateY(-80px)",this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Pull to refresh")}setDisabled(e){this.disabled=e}destroy(){this.unbindEvents(),this.indicatorElement&&this.indicatorElement.remove(),this.rafId&&cancelAnimationFrame(this.rafId)}}const Yu=(r,e={})=>{const s=re.useRef(null);return re.useEffect(()=>(s.current=new Ku({...e,onRefresh:r}),()=>{s.current?.destroy()}),[r]),{setDisabled:i=>s.current?.setDisabled(i),destroy:()=>s.current?.destroy()}},Zu="2.0.67",Qu=Zu,nt=class nt{constructor(){ee(this,"currentVersion");this.currentVersion=Qu}static getInstance(){return nt.instance||(nt.instance=new nt),nt.instance}getVersion(){return this.currentVersion}incrementPatch(){const[e,s,i]=this.currentVersion.split(".").map(Number);return this.currentVersion=`${e}.${s}.${i+1}`,this.currentVersion}incrementMinor(){const[e,s]=this.currentVersion.split(".").map(Number);return this.currentVersion=`${e}.${s+1}.0`,this.currentVersion}incrementMajor(){const[e]=this.currentVersion.split(".").map(Number);return this.currentVersion=`${e+1}.0.0`,this.currentVersion}setVersion(e){this.currentVersion=e}getVersionInfo(){return{version:this.currentVersion,buildTime:new Date().toISOString(),cacheBuster:`v${this.currentVersion}-${new Date().toISOString().split("T")[0]}-auto`,environment:"production",isProduction:!0}}};ee(nt,"instance");let gr=nt;const Xu=gr.getInstance(),Cs=Xu.getVersion(),eh=new Date().toISOString();`${Cs}${new Date().toISOString().split("T")[0]}`;const th=({onBack:r})=>{ie();const[e,s]=p.useState({twoFactorEnabled:!1,emailNotifications:!0,pushNotifications:!0,marketingEmails:!1,publicProfile:!0,showEarnings:!1}),[i,n]=p.useState(!1),[o,a]=p.useState(""),[l,d]=p.useState(!1);p.useState(!1),p.useState({currentPassword:"",newPassword:"",confirmPassword:""});const[c,u]=p.useState({lastPasswordChange:"3 months ago",loginSessions:1,suspiciousActivity:0}),h=async()=>{o.toLowerCase()==="delete my account"?(d(!0),setTimeout(()=>{alert("Account deletion request submitted. You will receive a confirmation email."),n(!1),a(""),d(!1)},2e3)):alert('Please type "delete my account" to confirm.')},f=async m=>{d(!0),setTimeout(()=>{s({...e,[m]:!e[m]}),d(!1);const x=document.createElement("div");x.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #00F5D4;
        color: white;
        padding: 12px 16px;
        border-radius: 8px;
        z-index: 10000;
        font-size: 14px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      `,x.textContent="Setting updated successfully!",document.body.appendChild(x),setTimeout(()=>{document.body.removeChild(x)},3e3)},500)};return t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[t.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("button",{onClick:r,style:{background:"none",border:"none",cursor:"pointer"},children:t.jsx(Ct,{size:24,style:{color:"#374151"}})}),t.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Account Settings"})]})}),t.jsxs("div",{style:{padding:"24px"},children:[t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Profile Visibility"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Public Profile"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Allow others to see your profile"})]}),t.jsx("button",{onClick:()=>f("publicProfile"),disabled:l,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.publicProfile?"#00F5D4":"#e5e7eb",position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s",opacity:l?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.publicProfile?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Show Earnings"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Display your earnings on profile"})]}),t.jsx("button",{onClick:()=>f("showEarnings"),disabled:l,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.showEarnings?"#00F5D4":"#e5e7eb",position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s",opacity:l?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.showEarnings?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Security Status"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Last Password Change"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:c.lastPasswordChange})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Active Sessions"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:c.loginSessions})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Suspicious Activity"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:c.suspiciousActivity>0?"#dc2626":"#00F5D4"},children:c.suspiciousActivity===0?"None detected":`${c.suspiciousActivity} incidents`})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Account Security"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Two-Factor Authentication"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Add extra security to your account"})]}),t.jsx("button",{onClick:()=>f("twoFactorEnabled"),disabled:l,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.twoFactorEnabled?"#00F5D4":"#e5e7eb",position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s",opacity:l?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.twoFactorEnabled?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Danger Zone"}),t.jsx("div",{style:{marginBottom:"12px"},children:t.jsx("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 12px 0"},children:"Once you delete your account, there is no going back. Please be certain."})}),i?t.jsxs("div",{style:{border:"2px solid #ef4444",borderRadius:"8px",padding:"16px"},children:[t.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#dc2626",margin:"0 0 12px 0"},children:" Confirm Account Deletion"}),t.jsx("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 16px 0"},children:"This action cannot be undone. This will permanently delete your account and all associated data."}),t.jsxs("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 16px 0"},children:["Type ",t.jsx("strong",{children:'"delete my account"'})," to confirm:"]}),t.jsx("input",{type:"text",value:o,onChange:m=>a(m.target.value),placeholder:"Type: delete my account",style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",marginBottom:"16px",boxSizing:"border-box"}}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>{n(!1),a("")},style:{flex:1,padding:"10px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Cancel"}),t.jsx("button",{onClick:h,disabled:l||o.toLowerCase()!=="delete my account",style:{flex:1,padding:"10px",background:o.toLowerCase()==="delete my account"?"#dc2626":"#9ca3af",color:"white",border:"none",borderRadius:"6px",cursor:o.toLowerCase()==="delete my account"&&!l?"pointer":"not-allowed",fontWeight:"500"},children:l?"Processing...":"Delete Account"})]})]}):t.jsx("button",{style:{width:"100%",padding:"12px",background:"rgba(239, 68, 68, 0.1)",color:"#dc2626",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",cursor:"pointer",fontWeight:"500"},onClick:()=>n(!0),children:"Delete Account"})]})]})]})},sh=({onBack:r})=>{const[e,s]=p.useState({pushEnabled:!0,emailEnabled:!0,predictionUpdates:!0,winLossAlerts:!0,clubActivity:!0,socialInteractions:!1,marketingEmails:!1,weeklyDigest:!0}),[i,n]=p.useState(!1),[o,a]=p.useState("default");re.useEffect(()=>{"Notification"in window&&a(Notification.permission)},[]);const l=async()=>{if("Notification"in window){const u=await Notification.requestPermission();a(u),d(u==="granted"?"Notifications enabled successfully!":"You can enable notifications in your browser settings later.")}},d=u=>{const h=document.createElement("div");h.style.cssText=`
      position: fixed;
      top: 20px;
      right: 20px;
      background: #00F5D4;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      z-index: 10000;
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    `,h.textContent=u,document.body.appendChild(h),setTimeout(()=>{document.body.contains(h)&&document.body.removeChild(h)},3e3)},c=async u=>{u==="pushEnabled"&&!e.pushEnabled&&o!=="granted"&&(await l(),o!=="granted")||(n(!0),setTimeout(()=>{s({...e,[u]:!e[u]}),n(!1),d("Notification setting updated!")},500))};return t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[t.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("button",{onClick:r,style:{background:"none",border:"none",cursor:"pointer"},children:t.jsx(Ct,{size:24,style:{color:"#374151"}})}),t.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Notifications"})]})}),t.jsxs("div",{style:{padding:"24px"},children:[o!=="granted"&&t.jsx("div",{style:{background:"rgba(255, 176, 32, 0.1)",border:"1px solid rgba(255, 176, 32, 0.3)",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("div",{style:{width:"24px",height:"24px",background:"#ffb020",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"14px",fontWeight:"bold"},children:"!"}),t.jsxs("div",{style:{flex:1},children:[t.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#b45309",margin:"0 0 4px 0"},children:"Enable Browser Notifications"}),t.jsx("p",{style:{fontSize:"12px",color:"#b45309",margin:0},children:o==="denied"?"Notifications are blocked. You can enable them in your browser settings.":"Click to enable push notifications for real-time updates."})]}),o==="default"&&t.jsx("button",{onClick:l,style:{padding:"6px 12px",background:"#ffb020",color:"white",border:"none",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer"},children:"Enable"})]})}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"General"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Push Notifications"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Receive notifications on your device"})]}),t.jsx("button",{onClick:()=>c("pushEnabled"),disabled:i,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.pushEnabled?"#00F5D4":"#e5e7eb",position:"relative",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.pushEnabled?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Email Notifications"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Receive notifications via email"})]}),t.jsx("button",{onClick:()=>c("emailEnabled"),disabled:i,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.emailEnabled?"#00F5D4":"#e5e7eb",position:"relative",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.emailEnabled?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Prediction Alerts"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Win/Loss Alerts"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Get notified when predictions resolve"})]}),t.jsx("button",{onClick:()=>c("winLossAlerts"),disabled:i,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.winLossAlerts?"#00F5D4":"#e5e7eb",position:"relative",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.winLossAlerts?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Club Activity"}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Activity from clubs you've joined"})]}),t.jsx("button",{onClick:()=>c("clubActivity"),disabled:i,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:e.clubActivity?"#00F5D4":"#e5e7eb",position:"relative",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e.clubActivity?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]})]})]})]})},rh=({onBack:r})=>{const[e,s]=p.useState(!1),[i,n]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[o,a]=p.useState(!1),[l,d]=p.useState({lastPasswordChange:"3 months ago",loginSessions:1,suspiciousActivity:0}),c=async()=>{if(i.newPassword!==i.confirmPassword){alert("New passwords do not match!");return}if(i.newPassword.length<8){alert("Password must be at least 8 characters long!");return}a(!0),setTimeout(()=>{alert("Password changed successfully!"),n({currentPassword:"",newPassword:"",confirmPassword:""}),s(!1),a(!1),d({...l,lastPasswordChange:"Just now"})},2e3)};return t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[t.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("button",{onClick:r,style:{background:"none",border:"none",cursor:"pointer"},children:t.jsx(Ct,{size:24,style:{color:"#374151"}})}),t.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Security & Privacy"})]})}),t.jsxs("div",{style:{padding:"24px"},children:[t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Password & Authentication"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>s(!e),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(nd,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Change Password"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]}),e&&t.jsxs("div",{style:{marginTop:"16px",padding:"16px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[t.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px",margin:"0 0 12px 0"},children:"Change Password"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsx("input",{type:"password",placeholder:"Current Password",value:i.currentPassword,onChange:u=>n({...i,currentPassword:u.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"}}),t.jsx("input",{type:"password",placeholder:"New Password (min 8 characters)",value:i.newPassword,onChange:u=>n({...i,newPassword:u.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"}}),t.jsx("input",{type:"password",placeholder:"Confirm New Password",value:i.confirmPassword,onChange:u=>n({...i,confirmPassword:u.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"}}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:[t.jsx("button",{onClick:()=>{s(!1),n({currentPassword:"",newPassword:"",confirmPassword:""})},style:{flex:1,padding:"8px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"14px"},children:"Cancel"}),t.jsx("button",{onClick:c,disabled:o||!i.currentPassword||!i.newPassword||!i.confirmPassword,style:{flex:1,padding:"8px",background:o||!i.currentPassword||!i.newPassword||!i.confirmPassword?"#9ca3af":"#00F5D4",color:"white",border:"none",borderRadius:"6px",cursor:o||!i.currentPassword||!i.newPassword||!i.confirmPassword?"not-allowed":"pointer",fontWeight:"500",fontSize:"14px"},children:o?"Updating...":"Update Password"})]})]})]}),t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Two-factor authentication setup will be available in the next update!"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Ar,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Two-Factor Authentication"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Privacy Controls"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Privacy settings will be available soon"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Ir,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Profile Privacy"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]}),t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Data management features coming soon"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(vn,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Data & Privacy"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Login Activity"}),t.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},children:"Recent login activity and device management"}),t.jsxs("div",{style:{padding:"12px",background:"#f9fafb",borderRadius:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[t.jsx("span",{style:{fontWeight:"500",fontSize:"14px"},children:"Current Device"}),t.jsx("span",{style:{fontSize:"12px",color:"#00F5D4"},children:"Active Now"})]}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"MacBook Pro  Chrome  Gainesville, GA"})]})]})]})]})},ih=({onBack:r})=>t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[t.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("button",{onClick:r,style:{background:"none",border:"none",cursor:"pointer"},children:t.jsx(Ct,{size:24,style:{color:"#374151"}})}),t.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Help & Support"})]})}),t.jsxs("div",{style:{padding:"24px"},children:[t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Get Help"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("https://help.fanclubz.com/faq","_blank")||alert("FAQ section will open in a new window"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(wn,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Frequently Asked Questions"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]}),t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("mailto:support@fanclubz.com"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(ad,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Contact Support"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]}),t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Live chat will be available 24/7 starting next week!"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Ae,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Live Chat"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Resources"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/terms","_blank")||alert("Terms of Service will open in a new window"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(vn,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Terms of Service"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]}),t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/privacy","_blank")||alert("Privacy Policy will open in a new window"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Ar,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Privacy Policy"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]}),t.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/community-guidelines","_blank")||alert("Community Guidelines will open in a new window"),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(at,{size:20,style:{color:"#6b7280"}}),t.jsx("span",{style:{fontWeight:"500"},children:"Community Guidelines"})]}),t.jsx(ge,{size:16,style:{color:"#9ca3af"}})]})]})]}),t.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[t.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"App Information"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"App Version"}),t.jsxs("span",{style:{fontSize:"14px",fontWeight:"500"},children:["v",Cs]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Build Number"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"2024.07.30"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Last Updated"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"July 30, 2025"})]})]})]})]})]}),Qn=({onNavigateBack:r,userId:e})=>{const{user:s,updateProfile:i,logout:n}=ie(),{getUserPredictionEntries:o,getUserCreatedPredictions:a,fetchUserPredictionEntries:l,fetchUserCreatedPredictions:d}=Pt(),[c,u]=p.useState("overview"),[h,f]=p.useState(!1),[m,x]=p.useState(!1),[g,b]=p.useState(null),[w,y]=p.useState(!1),[j,S]=p.useState({firstName:s?.firstName||"",lastName:s?.lastName||"",email:s?.email||"",bio:s?.bio||""}),O=!e||e===s?.id,$=!O&&!(O||!!g&&!w);re.useEffect(()=>{if(!s){console.log(" Waiting for currentUser to load...");return}try{if(console.log(" ProfilePage useEffect triggered with:",{userId:e,currentUserId:s?.id}),!e||typeof e!="string"||e.trim()===""){console.log(" No valid userId provided, viewing own profile"),m||x(!1),g!==s&&b(s);return}const N=e!==s?.id;console.log(" Profile viewing decision:",{userId:e,currentUserId:s?.id,isViewingOther:N}),m!==N&&x(N),N?(console.log(" Viewing other user profile:",e),(!g||g.id!==e)&&J(e)):(console.log(" Viewing own profile"),g!==s&&b(s))}catch(N){console.error(" Error in profile useEffect:",N),m&&x(!1),g!==s&&b(s)}},[e,s?.id]);const J=re.useCallback(async N=>{if(w){console.log(" Already loading profile, skipping request");return}y(!0);try{console.log(" Fetching profile for user ID:",N),/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(N)||console.warn(" Invalid userId format, but attempting API call anyway:",N);const _=`${pe()}/api/v2/users/${N}`;console.log(" Making API request to:",_);const L=await fetch(_,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(console.log(" API Response status:",L.status,L.statusText),!L.ok){if(L.status===404){console.warn(" User not found:",N),x(!1),b(s),y(!1);return}throw new Error(`HTTP error! status: ${L.status} ${L.statusText}`)}const P=await L.json();if(console.log(" Raw API response:",P),P.error)throw new Error(P.message||"Failed to fetch user profile");const R=P.data;if(!R)throw new Error("No user data in API response");const F={id:R.id,firstName:R.full_name?.split(" ")[0]||R.username||"Unknown",lastName:R.full_name?.split(" ").slice(1).join(" ")||"",email:R.email||"",bio:R.bio||"No bio available",avatar:R.avatar_url||null,totalEarnings:R.stats?.totalEarnings||0,totalInvested:R.stats?.totalInvested||0,winRate:R.stats?.winRate||0,activePredictions:R.stats?.predictionsCreated||0,totalPredictions:R.stats?.predictionsParticipated||0,rank:0,level:R.reputation_score>1e3?"Advanced Predictor":R.reputation_score>500?"Intermediate Predictor":"New Predictor",createdAt:R.created_at,username:R.username||R.full_name||"unknown_user",isVerified:R.is_verified||!1};console.log(" User profile transformed successfully:",F),b(F)}catch(E){console.error(" Error fetching user profile:",E),E.name==="AbortError"?console.log(" Request timed out"):E.message.includes("ERR_BLOCKED_BY_CLIENT")&&console.log(" Request blocked by client (likely ad blocker)");const v={id:N,firstName:"Unknown",lastName:"User",email:"",bio:E instanceof Error?"Profile temporarily unavailable":"Profile not available",avatar:null,totalEarnings:0,totalInvested:0,winRate:0,activePredictions:0,totalPredictions:0,rank:0,level:"Unknown",createdAt:new Date().toISOString(),username:"unknown_user",isVerified:!1};console.log(" Setting fallback user:",v),b(v)}finally{y(!1)}},[w]);re.useEffect(()=>{yt({behavior:"instant"})},[]);const M=re.useCallback(async()=>{console.log("Pull to refresh triggered on Profile page"),await new Promise(N=>setTimeout(N,500))},[]);Yu(M,{threshold:60,disabled:!1}),re.useEffect(()=>{const N=e||s?.id;if(!N||!s)return;let E=!0,v=!1;const _=()=>{if(!(!E||v))try{console.log(" ProfilePage: Fetching data for user:",N),l(N),d(N),v=!0}catch(R){console.error("Error fetching user prediction data:",R)}},{isAuthenticated:L,initialized:P}=ie.getState();if(P&&L)_();else{const R=ie.subscribe(F=>{F.initialized&&F.isAuthenticated&&!v&&(_(),R())});return()=>{E=!1,R()}}return()=>{E=!1}},[e,s?.id]);const K=re.useMemo(()=>{const N=g||s,E=e||s?.id;if(!N||!E)return{totalEarnings:0,totalInvested:0,winRate:0,activePredictions:0,totalPredictions:0,rank:0,joinedDate:"Recently",level:"New Predictor"};try{const v=o(E)||[],_=a(E)||[],L=v.filter(oe=>oe?.status==="active").length,P=v.filter(oe=>oe?.status==="won"||oe?.status==="lost"),R=v.filter(oe=>oe?.status==="won"),F=v.reduce((oe,_e)=>oe+(_e?.amount||0),0),te=R.reduce((oe,_e)=>oe+(_e?.actual_payout||0),0),Y=P.length>0?Math.round(R.length/P.length*100):0;return{totalEarnings:te,totalInvested:F,winRate:Y,activePredictions:L,totalPredictions:v.length+_.length,rank:N.rank||0,joinedDate:N.createdAt?new Date(N.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"Recently",level:L>5?"Expert Predictor":L>0?"Active Predictor":"New Predictor"}}catch(v){return console.error("Error calculating user stats:",v),{totalEarnings:0,totalInvested:0,winRate:0,activePredictions:0,totalPredictions:0,rank:0,joinedDate:"Recently",level:"New Predictor"}}},[g?.id,e,s?.id]),I=re.useMemo(()=>[{id:"account",label:"Account Settings",icon:Wt,description:"Manage your account preferences",action:()=>u("account")},{id:"notifications",label:"Notifications",icon:yn,description:"Control your notification settings",action:()=>u("notifications")},{id:"security",label:"Security & Privacy",icon:Ar,description:"Manage security settings",action:()=>u("security")},{id:"help",label:"Help & Support",icon:wn,description:"Get help and contact support",action:()=>u("help")}],[u]),D=re.useMemo(()=>{const N=e||s?.id;if(!N)return[];try{const E=o(N)||[],v=a(N)||[],_=E.length,L=v.length,P=E.filter(F=>F?.status==="won").length,R=E.filter(F=>F?.status==="won").reduce((F,te)=>F+(te?.actual_payout||0),0);return[{id:1,title:"First Prediction",icon:"",unlocked:_>0,description:"Make your first prediction"},{id:2,title:"Active Predictor",icon:"",unlocked:_>=3,description:`Make 3 predictions (${_}/3)`},{id:3,title:"Top Predictor",icon:"",unlocked:P>=5,description:`Win 5 predictions (${P}/5)`},{id:4,title:"Community Leader",icon:"",unlocked:L>=2,description:`Create 2 predictions (${L}/2)`}]}catch(E){return console.error("Error calculating achievements:",E),[]}},[e,s?.id]),Z=()=>{i({...s,firstName:j.firstName,lastName:j.lastName,email:j.email,bio:j.bio}),f(!1)},k=()=>{S({firstName:s?.firstName||"",lastName:s?.lastName||"",email:s?.email||"",bio:s?.bio||""}),f(!1)},A=()=>{const N=()=>{n(),r&&r()},E=document.createElement("div");E.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    `,E.innerHTML=`
      <div style="
        background: white;
        border-radius: 16px;
        padding: 24px;
        max-width: 320px;
        width: 90%;
        text-align: center;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      ">
        <div style="
          width: 48px;
          height: 48px;
          background: #fef3c7;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 16px;
        ">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
            <path d="M9 12l2 2 4-4"/>
            <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
          </svg>
        </div>
        <h3 style="
          font-size: 18px;
          font-weight: 700;
          color: #111827;
          margin: 0 0 8px 0;
        ">Sign Out</h3>
        <p style="
          font-size: 14px;
          color: #6b7280;
          margin: 0 0 24px 0;
          line-height: 1.5;
        ">Are you sure you want to sign out of your account?</p>
        <div style="
          display: flex;
          gap: 12px;
          justify-content: center;
        ">
          <button onclick="dialog.remove()" style="
            padding: 10px 20px;
            background: #f3f4f6;
            color: #374151;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
          " onmouseover="this.style.backgroundColor='#e5e7eb'" onmouseout="this.style.backgroundColor='#f3f4f6'">
            Cancel
          </button>
          <button onclick="window.confirmLogout()" style="
            padding: 10px 20px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
          " onmouseover="this.style.backgroundColor='#dc2626'" onmouseout="this.style.backgroundColor='#ef4444'">
            Sign Out
          </button>
        </div>
      </div>
    `,window.confirmLogout=()=>{E.remove(),N()},document.body.appendChild(E)};return re.useEffect(()=>{m&&c!=="overview"&&u("overview")},[m,c]),!m&&c==="account"?t.jsx(th,{onBack:()=>u("overview")}):!m&&c==="notifications"?t.jsx(sh,{onBack:()=>u("overview")}):!m&&c==="security"?t.jsx(rh,{onBack:()=>u("overview")}):!m&&c==="help"?t.jsx(ih,{onBack:()=>u("overview")}):m&&w?t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[t.jsxs("div",{style:{background:"linear-gradient(135deg, #00F5D4, #7B2FF7)",minHeight:"300px"},children:[t.jsx("div",{style:{height:"44px"}}),t.jsx("div",{style:{padding:"20px 16px",position:"relative",zIndex:10},children:t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"40px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[r&&t.jsx("button",{onClick:r,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:t.jsx(ot,{size:20,style:{color:"white"}})}),t.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0},children:"Profile"})]})})})]}),t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px"},children:t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{width:"40px",height:"40px",border:"3px solid #00F5D4",borderTop:"3px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}}),t.jsx("p",{style:{color:"#6b7280",fontSize:"16px"},children:"Loading profile..."})]})})]}):m&&!w&&!g?t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[t.jsxs("div",{style:{background:"linear-gradient(135deg, #00F5D4, #7B2FF7)",minHeight:"300px"},children:[t.jsx("div",{style:{height:"44px"}}),t.jsx("div",{style:{padding:"20px 16px",position:"relative",zIndex:10},children:t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"40px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[r&&t.jsx("button",{onClick:r,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:t.jsx(ot,{size:20,style:{color:"white"}})}),t.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0},children:"Profile"})]})})})]}),t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px"},children:t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{width:"48px",height:"48px",background:"#fef3c7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:t.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2",children:t.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",margin:"0 0 8px 0"},children:"Profile Not Found"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"16px",margin:"0 0 24px 0"},children:"The user profile you're looking for doesn't exist or is not available."}),r&&t.jsx("button",{onClick:r,style:{background:"#00F5D4",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"Go Back"})]})})]}):t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[$&&t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 pt-12 pb-6",children:t.jsx("div",{className:"px-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[r&&t.jsx("button",{onClick:r,className:"bg-white/20 p-2 rounded-lg backdrop-blur-sm",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("h1",{className:"text-white text-2xl font-bold",children:"Profile"})]})})}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-24 bg-white rounded-2xl shadow mb-4"}),t.jsx("div",{className:"h-32 bg-white rounded-2xl shadow"})]})})]}),t.jsxs("div",{style:{background:"linear-gradient(135deg, #00F5D4, #7B2FF7)",minHeight:"300px"},"data-tour-id":"profile-header",children:[t.jsx("div",{style:{position:"absolute",top:"20px",right:"20px",width:"100px",height:"100px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",filter:"blur(20px)"}}),t.jsx("div",{style:{position:"absolute",bottom:"20px",left:"30px",width:"80px",height:"80px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",filter:"blur(15px)"}}),t.jsx("div",{style:{height:"44px"}}),t.jsx("div",{style:{padding:"20px 16px",position:"relative",zIndex:10},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"40px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[r&&t.jsx("button",{onClick:r,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:t.jsx(ot,{size:20,style:{color:"white"}})}),t.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0},children:m?"User Profile":"Profile"})]}),!m&&t.jsx("button",{onClick:()=>f(!h),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:h?t.jsx(De,{size:20,style:{color:"white"}}):t.jsx(cd,{size:20,style:{color:"white"}})})]})}),t.jsx("div",{"data-tour-id":"profile-card",style:{margin:"16px",background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",minHeight:"180px"},children:t.jsx(xe,{mode:"wait",children:!m&&h?t.jsxs(T.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",marginBottom:"16px"},children:[t.jsxs("div",{style:{position:"relative",flexShrink:0},children:[t.jsx(hr,{email:j.email,avatarUrl:s?.avatar,size:"xl",className:"ring-4 ring-white"}),t.jsx("button",{style:{position:"absolute",bottom:"0",right:"0",width:"28px",height:"28px",background:"#00F5D4",border:"2px solid white",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},onClick:()=>{const N=document.createElement("input");N.type="file",N.accept="image/*",N.onchange=async E=>{const v=E.target.files?.[0];if(v)try{const _=await ie.getState().uploadAvatar(v);console.log("Avatar uploaded:",_)}catch(_){console.error("Avatar upload failed",_),alert("Failed to upload image. Please try again.")}},N.click()},children:t.jsx(Xc,{size:12,style:{color:"white"}})})]}),t.jsxs("div",{style:{flex:1,minWidth:0,paddingTop:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px"},children:[t.jsx("input",{type:"text",placeholder:"First Name",value:j.firstName,onChange:N=>S({...j,firstName:N.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",fontWeight:"600",outline:"none",transition:"border-color 0.2s",boxSizing:"border-box"},onFocus:N=>N.target.style.borderColor="#00F5D4",onBlur:N=>N.target.style.borderColor="#e5e7eb"}),t.jsx("input",{type:"text",placeholder:"Last Name",value:j.lastName,onChange:N=>S({...j,lastName:N.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",fontWeight:"600",outline:"none",transition:"border-color 0.2s",boxSizing:"border-box"},onFocus:N=>N.target.style.borderColor="#00F5D4",onBlur:N=>N.target.style.borderColor="#e5e7eb"})]}),t.jsx("input",{type:"email",placeholder:"Email",value:j.email,onChange:N=>S({...j,email:N.target.value}),style:{width:"100%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"13px",marginBottom:"6px",outline:"none",boxSizing:"border-box",transition:"border-color 0.2s"},onFocus:N=>N.target.style.borderColor="#00F5D4",onBlur:N=>N.target.style.borderColor="#e5e7eb"}),t.jsx("textarea",{placeholder:"Bio (optional)",value:j.bio,onChange:N=>S({...j,bio:N.target.value}),style:{width:"100%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"13px",resize:"none",height:"50px",outline:"none",boxSizing:"border-box",transition:"border-color 0.2s"},onFocus:N=>N.target.style.borderColor="#00F5D4",onBlur:N=>N.target.style.borderColor="#e5e7eb"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end",marginTop:"16px"},children:[t.jsx("button",{onClick:k,style:{padding:"8px 16px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px",transition:"background-color 0.2s"},onMouseEnter:N=>N.currentTarget.style.backgroundColor="#e5e7eb",onMouseLeave:N=>N.currentTarget.style.backgroundColor="#f3f4f6",children:"Cancel"}),t.jsxs("button",{onClick:Z,style:{padding:"8px 16px",background:"#00F5D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",gap:"4px",transition:"background-color 0.2s"},onMouseEnter:N=>N.currentTarget.style.backgroundColor="#7B2FF7",onMouseLeave:N=>N.currentTarget.style.backgroundColor="#00F5D4",children:[t.jsx(pd,{size:16}),"Save"]})]})]},"editing"):t.jsxs(T.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",marginBottom:"16px"},children:[t.jsx("div",{style:{position:"relative",flexShrink:0},children:t.jsx(hr,{email:g?.email,username:g?.username,avatarUrl:g?.avatar,size:"lg",className:"ring-4 ring-white"})}),t.jsxs("div",{style:{flex:1,minWidth:0,paddingTop:"4px"},children:[t.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",marginBottom:"4px",margin:0,lineHeight:"1.2"},children:g?.firstName&&g?.lastName?`${g.firstName} ${g.lastName}`:g?.email?.split("@")[0]||"User"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"14px",marginBottom:"4px",margin:"4px 0",lineHeight:"1.3"},children:m?"":g?.email||"No email provided"}),g?.bio&&t.jsx("p",{style:{color:"#6b7280",fontSize:"13px",margin:"4px 0",lineHeight:"1.3"},children:g.bio}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"6px"},children:[t.jsx(gd,{size:14,style:{color:"#fbbf24"}}),t.jsxs("span",{style:{fontSize:"12px",color:"#6b7280",fontWeight:"500"},children:["Rank #",K.rank,"  ",K.level]})]})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginTop:"12px"},children:[t.jsxs("div",{style:{textAlign:"center",padding:"6px"},children:[t.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#111827"},children:K.totalPredictions}),t.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Predictions"})]}),t.jsxs("div",{style:{textAlign:"center",padding:"6px"},children:[t.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#00F5D4"},children:[K.winRate,"%"]}),t.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Win Rate"})]}),t.jsxs("div",{style:{textAlign:"center",padding:"6px"},children:[t.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#111827"},children:["$",(K.totalEarnings-K.totalInvested).toLocaleString()]}),t.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Net Profit"})]})]})]},"viewing")})})]}),t.jsxs("div",{style:{padding:"0 24px 100px 24px"},children:[t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[t.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Performance Overview"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(16, 185, 129, 0.1)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:t.jsx(hs,{size:20,style:{color:"#00F5D4"}})}),t.jsxs("div",{style:{minWidth:0},children:[t.jsxs("div",{style:{fontSize:"16px",fontWeight:"700",color:"#111827"},children:["$",K.totalEarnings.toLocaleString()]}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Total Earnings"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(59, 130, 246, 0.1)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:t.jsx(ke,{size:20,style:{color:"#3b82f6"}})}),t.jsxs("div",{style:{minWidth:0},children:[t.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#111827"},children:K.activePredictions}),t.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Active"})]})]})]})]}),t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[t.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Achievements"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px",padding:"0 4px"},children:D.map(N=>t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 8px",borderRadius:"8px",backgroundColor:N.unlocked?"rgba(0, 245, 212, 0.05)":"#f9fafb",opacity:N.unlocked?1:.6,minWidth:0},children:[t.jsx("div",{style:{fontSize:"20px",flexShrink:0},children:N.icon}),t.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden"},children:t.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#111827",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:N.title})}),N.unlocked&&t.jsx("div",{style:{flexShrink:0},children:t.jsx(yd,{size:16,style:{color:"#00F5D4"}})})]},N.id))})]}),!m&&t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[t.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Settings"}),t.jsx("div",{style:{display:"flex",flexDirection:"column"},children:I.map((N,E)=>{const v=N.icon;return t.jsxs("button",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px 12px",background:"none",border:"none",borderRadius:"8px",cursor:"pointer",textAlign:"left",width:"100%",transition:"background-color 0.2s",borderBottom:E<I.length-1?"1px solid #f3f4f6":"none"},onMouseEnter:_=>{_.currentTarget.style.backgroundColor="#f9fafb"},onMouseLeave:_=>{_.currentTarget.style.backgroundColor="transparent"},onClick:N.action,children:[t.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(107, 114, 128, 0.1)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:t.jsx(v,{size:20,style:{color:"#6b7280"}})}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#111827"},children:N.label}),t.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginTop:"2px"},children:N.description})]}),t.jsx(ge,{size:20,style:{color:"#9ca3af",flexShrink:0}})]},N.id)})})]}),!m&&t.jsxs(t.Fragment,{children:[t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[t.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Account Information"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Email"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:s?.email||"Not provided"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Member Since"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:K.joinedDate})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Account Status"}),t.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#00F5D4"},children:"Active"})]})]})]}),t.jsxs(T.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"16px",background:"rgba(239, 68, 68, 0.1)",color:"#dc2626",border:"none",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginBottom:"20px",transition:"background-color 0.2s"},onClick:A,onMouseEnter:N=>N.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.15)",onMouseLeave:N=>N.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(od,{size:20}),t.jsx("span",{children:"Sign Out"})]})]})]})]})},nh=({onNavigateBack:r})=>{const[e,s]=p.useState("overview"),[i,n]=p.useState(!1),[o,a]=p.useState(!1),[l,d]=p.useState(null),[c,u]=p.useState(""),{getBalance:h,getTransactionHistory:f,addFunds:m,resetDemoBalance:x,isDemoMode:g}=js();ie();const[,b]=de();p.useEffect(()=>{yt({delay:200})},[]);const w=h("USD")||0,y=f({currency:"USD"})||[],j=[10,25,50,100],S=async I=>{if(I<=0){G.error("Please enter a valid amount");return}n(!0);try{await m(I,"USD","Demo funds added"),G.success(`Successfully added $${I.toLocaleString()} to your wallet!`),d(null),u("")}catch{G.error("Failed to add funds. Please try again.")}finally{n(!1)}},O=async()=>{a(!0);try{await x(),G.success("Demo balance reset successfully!")}catch{G.error("Failed to reset demo balance. Please try again.")}finally{a(!1)}},C=()=>{r?r():b("/")},$=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(I),J=I=>I.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),M=I=>{switch(I){case"deposit":return t.jsx(ps,{size:16,className:"text-teal-500"});case"withdrawal":return t.jsx(vd,{size:16,className:"text-red-500"});case"prediction":return t.jsx(ke,{size:16,className:"text-blue-500"});case"win":return t.jsx(Ft,{size:16,className:"text-teal-500"});default:return t.jsx(hs,{size:16,className:"text-gray-500"})}},K=I=>{switch(I){case"deposit":case"win":return"text-teal-600";case"withdrawal":case"prediction":return"text-red-600";default:return"text-gray-600"}};return t.jsxs("div",{className:"min-h-screen bg-gray-50 wallet-page",children:[t.jsxs("div",{className:"bg-white border-b border-gray-100",children:[t.jsx("div",{className:"h-11"}),t.jsx("div",{className:"px-4 py-4",children:t.jsxs("div",{className:"flex items-center justify-between","data-tour-id":"wallet-balance",children:[t.jsx("button",{onClick:C,className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:t.jsx(ot,{size:20,className:"text-gray-700"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Wallet"}),g&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Demo Mode"})]}),t.jsx("div",{className:"w-10"})," "]})})]}),g&&t.jsx(T.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mx-4 mt-4 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Yc,{size:20,className:"text-white"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-white font-semibold text-sm",children:"Demo Funds"}),t.jsx("p",{className:"text-blue-100 text-xs",children:"This is a demo wallet. All transactions are simulated."})]})]})}),t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mx-4 mt-4 bg-gradient-to-br from-purple-500 to-teal-600 rounded-2xl p-6 text-white","data-tour-id":"wallet-balance-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-sm font-medium text-green-100 uppercase tracking-wide",children:"Available Balance"}),t.jsx("div",{className:"text-3xl font-bold mt-1",children:$(w)})]}),t.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:t.jsx(hs,{size:24,className:"text-white"})})]}),t.jsxs("div",{className:"flex gap-2","data-tour-id":"wallet-actions",children:[t.jsx("button",{onClick:()=>d(25),className:"flex-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg py-2 px-3 text-sm font-medium transition-all",children:"Add Funds"}),g&&t.jsx("button",{onClick:O,disabled:o,className:"flex-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg py-2 px-3 text-sm font-medium transition-all disabled:opacity-50",children:o?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(Bt,{size:14,className:"animate-spin"}),"Resetting..."]}):"Reset Demo"})]})]}),t.jsx("div",{className:"mx-4 mt-6",children:t.jsxs("div",{className:"bg-white rounded-xl p-1 flex",children:[t.jsx("button",{onClick:()=>s("overview"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${e==="overview"?"bg-teal-500 text-white":"text-gray-600 hover:text-gray-900"}`,children:"Overview"}),t.jsx("button",{onClick:()=>s("transactions"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${e==="transactions"?"bg-teal-500 text-white":"text-gray-600 hover:text-gray-900"}`,children:"Transactions"})]})}),t.jsx("div",{className:"mx-4 mt-4",children:t.jsx(xe,{mode:"wait",children:e==="overview"?t.jsxs(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(ke,{size:16,className:"text-teal-500"}),t.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Total Won"})]}),t.jsx("div",{className:"text-lg font-bold text-gray-900",children:$(y.filter(I=>I.type==="win").reduce((I,D)=>I+D.amount,0))})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(bd,{size:16,className:"text-red-500"}),t.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Total Lost"})]}),t.jsx("div",{className:"text-lg font-bold text-gray-900",children:$(Math.abs(y.filter(I=>I.type==="prediction").reduce((I,D)=>I+D.amount,0)))})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-100",children:[t.jsx("div",{className:"p-4 border-b border-gray-100",children:t.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Activity"})}),t.jsx("div",{className:"p-4",children:y.slice(0,3).length>0?t.jsx("div",{className:"space-y-3",children:y.slice(0,3).map((I,D)=>t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:M(I.type)}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.description}),t.jsx("div",{className:"text-xs text-gray-500",children:J(I.date)})]}),t.jsxs("div",{className:`text-sm font-semibold ${K(I.type)}`,children:[I.amount>0?"+":"",$(I.amount)]})]},D))}):t.jsxs("div",{className:"text-center py-6",children:[t.jsx(kt,{size:24,className:"text-gray-400 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"No transactions yet"})]})})]})]},"overview"):t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:t.jsxs("div",{className:"bg-white rounded-xl border border-gray-100",children:[t.jsx("div",{className:"p-4 border-b border-gray-100",children:t.jsx("h3",{className:"font-semibold text-gray-900",children:"All Transactions"})}),t.jsx("div",{className:"divide-y divide-gray-100",children:y.length>0?y.map((I,D)=>t.jsx("div",{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:M(I.type)}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.description}),t.jsx("div",{className:"text-xs text-gray-500",children:J(I.date)})]}),t.jsxs("div",{className:`text-sm font-semibold ${K(I.type)}`,children:[I.amount>0?"+":"",$(I.amount)]})]})},D)):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(kt,{size:32,className:"text-gray-400 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No transactions yet"}),t.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Start making predictions to see your activity"})]})})]})},"transactions")})}),t.jsx(xe,{children:l!==null&&t.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>d(null),children:t.jsxs(T.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl w-full max-w-sm p-6",onClick:I=>I.stopPropagation(),children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Add Demo Funds"}),t.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:j.map(I=>t.jsxs("button",{onClick:()=>u(I.toString()),className:`py-3 px-4 rounded-lg border-2 text-sm font-medium transition-all ${c===I.toString()?"border-teal-500 bg-teal-50 text-teal-700":"border-gray-200 text-gray-700 hover:border-gray-300"}`,children:["$",I]},I))}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Amount"}),t.jsxs("div",{className:"relative",children:[t.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),t.jsx("input",{type:"number",placeholder:"0",value:c,onChange:I=>u(I.target.value),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"1",max:"10000"})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>d(null),className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>S(parseFloat(c)||0),disabled:!c||parseFloat(c)<=0||i,className:`flex-1 py-3 rounded-lg font-medium transition-colors ${!c||parseFloat(c)<=0||i?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-teal-600 text-white hover:bg-green-700"}`,children:i?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(Bt,{size:16,className:"animate-spin"}),"Adding..."]}):"Add Funds"})]})]})})})]})},oh=()=>{const{login:r,register:e,loginWithOAuth:s,loading:i}=ie(),[n,o]=p.useState(""),[a,l]=p.useState(""),[d,c]=p.useState(""),[u,h]=p.useState(""),[f,m]=p.useState(""),[x,g]=p.useState(!1),[b,w]=p.useState(!1),[y,j]=p.useState(!0),[S,O]=p.useState(!1),[C,$]=p.useState({}),[J,M]=p.useState(null);p.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]);const K=v=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v))return!1;const L=v.split("@"),P=L[0],R=L[1];if(P.length<1||P.length>64||R.length<3||R.length>255)return!1;const F=R.split(".");return F.length<2?!1:F.every(te=>te.length>0&&te.length<=63)},I=()=>{const v={};return n?K(n)||(v.email="Please enter a valid email address (e.g., user@example.com)"):v.email="Email is required",a?a.length<6&&(v.password="Password must be at least 6 characters"):v.password="Password is required",y||(d.trim()||(v.firstName="First name is required"),u.trim()||(v.lastName="Last name is required"),f?a!==f&&(v.confirmPassword="Passwords do not match"):v.confirmPassword="Please confirm your password"),$(v),Object.keys(v).length===0},D=async v=>{if(v.preventDefault(),!(!I()||i)){$({}),M(null);try{y?await r(n,a):await e(n,a,d,u)}catch(_){console.error("Auth error:",_);let L="Authentication failed. Please try again.";if(_.message){const P=_.message.toLowerCase();P.includes("invalid")&&P.includes("credentials")?L="Invalid email or password. Please check your credentials and try again.":P.includes("user already registered")||P.includes("already exists")?(L="An account with this email already exists. Please try signing in instead.",setTimeout(()=>j(!0),2e3)):P.includes("email not confirmed")?L="Please check your email and confirm your account before signing in.":P.includes("too many requests")||P.includes("rate limit")?L="Too many attempts. Please wait a moment and try again.":P.includes("user not found")?(L="No account found with this email. Please register first.",y&&setTimeout(()=>j(!1),2e3)):L="Something went wrong. Please try again or contact support if the issue continues."}M(L)}}},Z=async(v,_,L,P)=>{try{o(v),l(_),L&&c(L),P&&h(P),m(_),M(null),y?await r(v,_):await e(v,_,L||"Test",P||"User")}catch(R){console.error("Test auth error:",R),M(R.message||"Test authentication failed")}},k=async v=>{try{M(null),await s(v)}catch(_){console.error(`${v} auth error:`,_),M(`${v} sign-in failed. Please try again.`)}},A=()=>{j(!y),$({}),M(null),o(""),l(""),c(""),h(""),m(""),window.scrollTo({top:0,behavior:"smooth"})},N=()=>g(!x),E=()=>w(!b);return t.jsxs("div",{style:{minHeight:"100vh",width:"100%",maxWidth:"100vw",background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 30%, #ecfdf5 70%, #f0fdfa 100%)",display:"flex",alignItems:"flex-start",justifyContent:"center",padding:"8px",position:"relative",overflow:"hidden",boxSizing:"border-box"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{position:"fixed",top:"10px",left:"10px",zIndex:1001},children:t.jsx("button",{onClick:()=>O(!S),style:{padding:"8px 12px",background:"#374151",color:"white",border:"none",borderRadius:"6px",fontSize:"12px",cursor:"pointer"},children:" Test Mode"})}),S&&t.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"rgba(0, 0, 0, 0.9)",color:"white",padding:"16px",borderRadius:"8px",fontSize:"12px",zIndex:1e3,maxWidth:"280px"},children:[t.jsx("div",{style:{marginBottom:"12px",fontWeight:"bold",color:"#00ff88"},children:" FIXED AUTHENTICATION"}),t.jsx("div",{style:{marginBottom:"8px",fontSize:"10px",color:"#ccc"},children:" Business domains now supported:"}),t.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#00F5D4",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>Z("userten@fcz.app","test123","User","Ten"),children:y?" Login userten@fcz.app":" Register userten@fcz.app"}),t.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#00F5D4",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>Z("demo@example.com","demo123","Demo","User"),children:y?" Login demo@example.com":" Register demo@example.com"}),t.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#00F5D4",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>Z("user@gmail.com","test123","Test","Person"),children:y?" Login user@gmail.com":" Register user@gmail.com"}),t.jsx("div",{style:{margin:"12px 0 8px 0",fontSize:"10px",color:"#00ff88"},children:" ALL email formats now work!"}),t.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>O(!1),children:" Close"})]})]}),t.jsx("style",{children:`
          @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
          }
          
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
          
          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
          }
          
          @media (max-width: 768px) {
            .auth-card {
              padding: 16px !important;
              margin: 8px !important;
              max-width: calc(100vw - 16px) !important;
              width: calc(100vw - 16px) !important;
              min-height: calc(100vh - 16px) !important;
              border-radius: 16px !important;
              box-sizing: border-box !important;
              overflow: hidden !important;
            }
            
            .auth-card h1 {
              font-size: 28px !important;
            }
            
            .auth-card p {
              font-size: 14px !important;
            }
          }
          
          .auth-error {
            animation: shake 0.5s ease-in-out;
          }
        `}),t.jsx("div",{style:{position:"absolute",top:"-160px",right:"-160px",width:"320px",height:"320px",background:"radial-gradient(circle, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 50%, transparent 100%)",borderRadius:"50%",filter:"blur(40px)",animation:"float 8s ease-in-out infinite"}}),t.jsx("div",{style:{position:"absolute",bottom:"-160px",left:"-160px",width:"320px",height:"320px",background:"radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.03) 50%, transparent 100%)",borderRadius:"50%",filter:"blur(40px)",animation:"float 10s ease-in-out infinite reverse"}}),t.jsxs("div",{className:"auth-card",style:{width:"100%",maxWidth:"calc(100vw - 16px)",minHeight:"calc(100vh - 16px)",backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:"24px",padding:"24px",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",position:"relative",zIndex:10,margin:"8px",marginTop:"8px",display:"flex",flexDirection:"column",justifyContent:"flex-start",boxSizing:"border-box",overflow:"hidden"},children:[t.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"16px",filter:"drop-shadow(0 12px 24px rgba(123, 47, 247, 0.3))"},children:t.jsx(Jn,{size:"xl",variant:"icon"})}),t.jsx("h1",{style:{fontSize:"32px",fontWeight:"bold",color:"#111827",marginBottom:"8px",margin:"0 0 8px 0",background:"linear-gradient(135deg, #111827 0%, #374151 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",lineHeight:"1.2"},children:y?"Welcome Back":"Join Fan Club Z"}),t.jsx("p",{style:{fontSize:"16px",color:"#6b7280",margin:"0",lineHeight:"1.5"},children:y?"Sign in to continue your prediction journey":"Create your account and start making predictions"})]}),J&&t.jsxs("div",{className:"auth-error",style:{marginBottom:"20px",padding:"16px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",color:"#dc2626",fontSize:"14px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[t.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",style:{flexShrink:0,marginTop:"2px"},children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:y?"Sign In Failed":"Registration Failed"}),t.jsx("div",{style:{lineHeight:"1.4"},children:J}),J.includes("valid email")&&t.jsx("div",{style:{marginTop:"8px",fontSize:"12px",color:"#7c2d12",background:"rgba(34, 197, 94, 0.1)",padding:"8px",borderRadius:"6px"},children:" Business domains like @fcz.app, @company.com are now fully supported!"})]})]}),t.jsxs("div",{style:{marginBottom:"32px"},children:[t.jsxs("p",{style:{fontSize:"15px",color:"#6b7280",textAlign:"center",marginBottom:"16px",fontWeight:"500"},children:["Recommended: Quick ",y?"sign in":"sign up"," with Google"]}),t.jsxs("button",{type:"button",onClick:()=>k("google"),disabled:i,style:{width:"100%",height:"56px",backgroundColor:"#4285F4",border:"none",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",fontSize:"16px",fontWeight:"600",color:"white",cursor:i?"not-allowed":"pointer",opacity:i?"0.7":"1",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 8px 16px rgba(66, 133, 244, 0.3)",transform:"translateY(0)",position:"relative",overflow:"hidden"},onMouseEnter:v=>{v.currentTarget.style.transform="translateY(-2px)",v.currentTarget.style.boxShadow="0 12px 24px rgba(66, 133, 244, 0.4)"},onMouseLeave:v=>{v.currentTarget.style.transform="translateY(0)",v.currentTarget.style.boxShadow="0 8px 16px rgba(66, 133, 244, 0.3)"},children:[i?t.jsx("div",{style:{width:"24px",height:"24px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}):t.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:[t.jsx("path",{fill:"white",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"white",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"white",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t.jsx("path",{fill:"white",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]})]}),t.jsxs("div",{style:{position:"relative",textAlign:"center",margin:"24px 0",fontSize:"14px",color:"#6b7280"},children:[t.jsx("div",{style:{position:"absolute",top:"50%",left:"0",right:"0",height:"1px",backgroundColor:"#e5e7eb"}}),t.jsxs("span",{style:{backgroundColor:"white",padding:"0 16px",position:"relative",zIndex:1},children:["Or ",y?"sign in":"sign up"," with email"]})]}),t.jsxs("form",{onSubmit:D,style:{marginBottom:"20px",flex:1},children:[!y&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"18px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"First Name"}),t.jsx("input",{type:"text",value:d,onChange:v=>c(v.target.value),placeholder:"Enter first name",style:{width:"100%",padding:"14px 16px",border:`2px solid ${C.firstName?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:i,required:!y}),C.firstName&&t.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),C.firstName]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Last Name"}),t.jsx("input",{type:"text",value:u,onChange:v=>h(v.target.value),placeholder:"Enter last name",style:{width:"100%",padding:"14px 16px",border:`2px solid ${C.lastName?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:i,required:!y}),C.lastName&&t.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),C.lastName]})]})]}),t.jsxs("div",{style:{marginBottom:"18px",position:"relative"},children:[t.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Email Address"}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx("input",{type:"email",value:n,onChange:v=>o(v.target.value),placeholder:"Enter your email address",style:{width:"100%",padding:"14px 16px",paddingRight:"52px",border:`2px solid ${C.email?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:i,required:!0}),t.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),C.email&&t.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),C.email]})]}),t.jsxs("div",{style:{marginBottom:"18px",position:"relative"},children:[t.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Password"}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx("input",{type:x?"text":"password",value:a,onChange:v=>l(v.target.value),placeholder:"Enter your password",style:{width:"100%",padding:"14px 16px",paddingRight:"52px",border:`2px solid ${C.password?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:i,required:!0}),t.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s"},onClick:N,children:x?t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):t.jsxs("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),C.password&&t.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),C.password]})]}),!y&&t.jsxs("div",{style:{marginBottom:"18px",position:"relative"},children:[t.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Confirm Password"}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx("input",{type:b?"text":"password",value:f,onChange:v=>m(v.target.value),placeholder:"Confirm your password",style:{width:"100%",padding:"14px 16px",paddingRight:"52px",border:`2px solid ${C.confirmPassword?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:i,required:!y}),t.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s"},onClick:E,children:b?t.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):t.jsxs("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),C.confirmPassword&&t.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),C.confirmPassword]})]}),y&&t.jsx("div",{style:{textAlign:"right",marginBottom:"20px"},children:t.jsx("a",{href:"#",onClick:v=>{v.preventDefault(),alert("Password reset functionality will be available soon!")},style:{color:"#00F5D4",textDecoration:"none",fontSize:"14px",fontWeight:"500",padding:"4px 8px",borderRadius:"6px",transition:"all 0.2s"},children:"Forgot your password?"})}),t.jsx("button",{type:"submit",disabled:i,style:{width:"100%",height:"56px",background:"linear-gradient(135deg, #00F5D4 0%, #7B2FF7 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"16px",fontWeight:"600",cursor:i?"not-allowed":"pointer",opacity:i?"0.8":"1",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 8px 16px rgba(16, 185, 129, 0.3)",position:"relative",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:i?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),y?"Signing in...":"Creating account..."]}):y?"Sign In":"Create Account"})]}),t.jsx("div",{style:{textAlign:"center",paddingTop:"20px",paddingBottom:"16px",borderTop:"1px solid #f3f4f6"},children:t.jsxs("p",{style:{color:"#6b7280",fontSize:"15px",margin:"0"},children:[y?"Don't have an account?":"Already have an account?"," ",t.jsx("a",{href:"#",onClick:v=>{v.preventDefault(),A()},style:{color:"#00F5D4",textDecoration:"none",fontWeight:"600",padding:"8px 12px",borderRadius:"6px",transition:"all 0.2s",display:"inline-block",marginTop:"8px"},children:y?"Create one now":"Sign in"})]})})]}),t.jsx(bn,{})]})},ah=()=>{const{handleOAuthCallback:r,isAuthenticated:e,loading:s}=ie(),[,i]=de(),[n,o]=p.useState(!1),[a,l]=p.useState(null);return p.useEffect(()=>{let d=!0;const u=setTimeout(async()=>{if(!n)try{console.log(" Processing OAuth callback..."),o(!0),await r(),setTimeout(()=>{d&&(console.log(" OAuth callback processed, redirecting to app..."),i("/"))},1e3)}catch(h){console.error(" OAuth callback processing failed:",h),d&&(l(h.message||"Authentication failed"),setTimeout(()=>{window.location.href="/auth?error=oauth_failed"},3e3))}},100);return()=>{d=!1,clearTimeout(u)}},[r,n,i]),p.useEffect(()=>{e&&!s&&(console.log(" User already authenticated, redirecting..."),i("/"))},[e,s,i]),a?t.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 30%, #ecfdf5 70%, #f0fdfa 100%)"},children:t.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15)",textAlign:"center",maxWidth:"400px",width:"90%",border:"1px solid #fee2e2"},children:[t.jsx("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",borderRadius:"50%",margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("svg",{width:"24",height:"24",fill:"white",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})}),t.jsx("h2",{style:{margin:"0 0 12px 0",color:"#111827",fontSize:"24px",fontWeight:"bold"},children:"Authentication Failed"}),t.jsx("p",{style:{margin:"0 0 24px 0",color:"#6b7280",fontSize:"16px"},children:a}),t.jsx("p",{style:{margin:"0",color:"#9ca3af",fontSize:"14px"},children:"Redirecting to login page in a few seconds..."})]})}):t.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 30%, #ecfdf5 70%, #f0fdfa 100%)"},children:[t.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15)",textAlign:"center",maxWidth:"400px",width:"90%"},children:[t.jsx("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #00F5D4 0%, #7B2FF7 100%)",borderRadius:"50%",margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center",animation:"spin 2s linear infinite"},children:t.jsx("span",{style:{fontSize:"24px",color:"white"},children:"Z"})}),t.jsx("h2",{style:{margin:"0 0 12px 0",color:"#111827",fontSize:"24px",fontWeight:"bold"},children:"Completing Sign In..."}),t.jsx("p",{style:{margin:"0 0 24px 0",color:"#6b7280",fontSize:"16px"},children:"Please wait while we finish setting up your account."}),t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"4px"},children:[0,1,2].map(d=>t.jsx("div",{style:{width:"8px",height:"8px",background:"#00F5D4",borderRadius:"50%",animation:`bounce 1.4s ease-in-out ${d*.16}s infinite both`}},d))}),t.jsxs("div",{style:{marginTop:"20px",fontSize:"12px",color:"#9ca3af"},children:["Processed: ",n?"Yes":"No"," | Authenticated: ",e?"Yes":"No"," | Loading: ",s?"Yes":"No"]})]}),t.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
          
          @keyframes bounce {
            0%, 80%, 100% {
              transform: scale(0);
            }
            40% {
              transform: scale(1);
            }
          }
        `})]})},Hs=({id:r,value:e,onValueChange:s,placeholder:i,rows:n=3,maxLength:o=500,autoFocus:a=!1,className:l="",disabled:d=!1})=>{const c=p.useCallback(u=>{s(u.target.value)},[s]);return t.jsx("textarea",{id:r,value:e,onChange:c,className:`w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors ${l}`,rows:n,placeholder:i,maxLength:o,disabled:d,autoFocus:a,spellCheck:!1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",style:{minHeight:`${n*1.5}rem`,fontFamily:"inherit"}})},lh=({predictionId:r})=>{const{user:e}=ie(),{comments:s,commentCount:i,isLoading:n,error:o,isSubmitting:a,fetchComments:l,addComment:d,toggleCommentLike:c,clearError:u}=Pr(r),[h,f]=p.useState(""),[m,x]=p.useState({}),[g,b]=p.useState({}),[w,y]=p.useState(null),[j,S]=p.useState(null),[O,C]=p.useState(!1),$=p.useRef(r);p.useEffect(()=>{$.current!==r&&($.current=r,C(!1))},[r]),p.useEffect(()=>{r&&r.trim()&&!O&&!n&&(console.log(` Fetching comments for prediction ${r}`),C(!0),l().catch(E=>{console.error(" Failed to fetch comments:",E),C(!1)}))},[r,O,n]);const J=p.useCallback(async E=>{const v=E?m[E]||"":h;if(v.trim()){if(!e){console.error("User not authenticated");return}try{await d(v.trim(),E,{id:e.id,username:e.firstName||e.email?.split("@")[0]||"Anonymous",full_name:`${e.firstName} ${e.lastName}`.trim()||e.email?.split("@")[0]||"Anonymous User",avatar_url:e.avatar,is_verified:!1}),E?(x(_=>({..._,[E]:""})),y(null)):f("")}catch(_){console.error("Failed to add comment:",_)}}},[e,h,m,d]),M=p.useCallback(async E=>{if(e)try{await c(E)}catch(v){console.error("Failed to toggle like:",v)}},[e,c]),K=p.useCallback((E,v)=>{x(_=>({..._,[E]:v}))},[]),I=p.useCallback((E,v)=>{b(_=>({..._,[E]:v}))},[]),D=p.useCallback((E,v)=>{S(E),b(_=>({..._,[E]:v}))},[]),Z=p.useCallback(E=>{S(null),b(v=>{const _={...v};return delete _[E],_})},[]),k=p.useCallback(E=>{y(E),x(v=>({...v,[E]:""}))},[]),A=p.useCallback(E=>{y(null),x(v=>{const _={...v};return delete _[E],_})},[]),N=re.memo(function E({comment:v,isReply:_=!1}){const[L,P]=p.useState(!1),R=j===v.id,F=w===v.id;return t.jsx("div",{className:`comment-item ${_?"ml-8 pl-4 border-l-2 border-gray-100":""} p-4 bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow-md transition-shadow`,children:t.jsxs("div",{className:"flex space-x-3",children:[v.user?.avatar_url&&t.jsx("div",{className:"flex-shrink-0",children:t.jsx("img",{src:v.user.avatar_url,alt:v.user.username,className:"w-8 h-8 rounded-full object-cover"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx(qt,{username:v.user?.username||v.username||"Anonymous",userId:v.user?.id,className:"font-semibold text-sm text-gray-900 hover:text-teal-600 transition-colors"}),(v.user?.is_verified||v.is_verified)&&t.jsx("span",{className:"text-blue-500 text-xs",children:""}),t.jsx("span",{className:"text-xs text-gray-500",children:uo(new Date(v.created_at),{addSuffix:!0})}),v.is_edited&&t.jsx("span",{className:"text-xs text-gray-400",children:"(edited)"})]}),t.jsx("div",{className:"mb-2",children:R?t.jsxs("div",{className:"space-y-2",children:[t.jsx(Hs,{id:`edit-textarea-${v.id}`,value:g[v.id]||v.content,onValueChange:te=>I(v.id,te),placeholder:"Edit your comment...",rows:2,maxLength:500,autoFocus:!0}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:[(g[v.id]||"").length,"/500"]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>{S(null)},disabled:!(g[v.id]||"").trim(),className:"px-3 py-1 bg-teal-600 text-white text-xs rounded hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"}),t.jsx("button",{onClick:()=>Z(v.id),className:"px-3 py-1 bg-gray-300 text-gray-700 text-xs rounded hover:bg-gray-400",children:"Cancel"})]})]})]}):t.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap leading-relaxed",children:v.content})}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[t.jsxs("button",{onClick:()=>M(v.id),className:`flex items-center space-x-1 hover:text-red-500 transition-colors ${v.is_liked?"text-red-500":"text-gray-500"}`,children:[t.jsx(at,{size:14,className:v.is_liked?"fill-current":""}),t.jsx("span",{children:v.likes_count||0})]}),!_&&t.jsxs("button",{onClick:()=>F?A(v.id):k(v.id),className:"flex items-center space-x-1 text-gray-500 hover:text-blue-500 transition-colors",children:[t.jsx(hd,{size:14}),t.jsx("span",{children:F?"Cancel":"Reply"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>P(!L),className:"text-gray-400 hover:text-gray-600 transition-colors p-1",children:t.jsx(ld,{size:14})}),L&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>P(!1)}),t.jsx("div",{className:"absolute right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-20 min-w-[120px]",children:v.is_own?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{D(v.id,v.content),P(!1)},className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[t.jsx(dd,{size:14,className:"mr-2"}),"Edit"]}),t.jsxs("button",{onClick:()=>{P(!1)},className:"flex items-center w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[t.jsx(xd,{size:14,className:"mr-2"}),"Delete"]})]}):t.jsxs("button",{onClick:()=>{P(!1)},className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[t.jsx(rd,{size:14,className:"mr-2"}),"Report"]})})]})]})]}),F&&t.jsxs("div",{className:"mt-3 space-y-2",children:[t.jsx(Hs,{id:`reply-textarea-${v.id}`,value:m[v.id]||"",onValueChange:te=>K(v.id,te),placeholder:`Reply to ${v.user?.username||v.username}...`,rows:2,maxLength:500,autoFocus:!0}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:[(m[v.id]||"").length,"/500"]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>J(v.id),disabled:!(m[v.id]||"").trim()||a,className:"px-3 py-1 bg-teal-600 text-white text-xs rounded hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Replying...":"Reply"}),t.jsx("button",{onClick:()=>A(v.id),className:"px-3 py-1 bg-gray-300 text-gray-700 text-xs rounded hover:bg-gray-400",children:"Cancel"})]})]})]}),v.replies&&v.replies.length>0&&t.jsx("div",{className:"mt-3",children:v.replies.map(te=>t.jsx(E,{comment:te,isReply:!0},te.id))})]})]})})});return t.jsxs("div",{className:"comment-system bg-white",children:[t.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[t.jsx(Ae,{size:20,className:"mr-2"}),"Comments (",i,")"]})}),o&&t.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"text-red-800 text-sm",children:o}),t.jsx("button",{onClick:u,className:"text-red-600 hover:text-red-800 text-sm",children:"Dismiss"})]})}),e&&t.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:t.jsxs("div",{className:"w-full",children:[t.jsx(Hs,{id:"main-textarea",value:h,onValueChange:f,placeholder:"Share your thoughts...",rows:3,maxLength:500}),t.jsxs("div",{className:"flex justify-between items-center mt-3",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:[h.length,"/500"]}),t.jsx("button",{onClick:()=>J(),disabled:!h.trim()||a,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium",children:a?"Posting...":"Comment"})]})]})}),!e&&t.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:t.jsxs("p",{className:"text-gray-600 text-center",children:["Please ",t.jsx("span",{className:"text-teal-600 font-medium",children:"sign in"})," to join the conversation"]})}),n&&t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-teal-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading comments..."})]}),!n&&t.jsx("div",{className:"divide-y divide-gray-100",children:s.map(E=>t.jsx(N,{comment:E},E.id))}),!n&&s.length===0&&!o&&t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Ae,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("h4",{className:"text-lg font-medium mb-2",children:"No comments yet"}),t.jsx("p",{children:"Be the first to share your thoughts!"})]})]})},ch=({predictionId:r,settlementData:e,userHasEntry:s=!1,className:i=""})=>{const{acceptOutcome:n,setDisputeModalOpen:o,loading:a}=Tt(),[l,d]=p.useState(""),[c,u]=p.useState(!1);p.useEffect(()=>{if(!e.settled_at||e.state!=="settled")return;const m=()=>{const g=new Date(e.settled_at),b=new Date(g.getTime()+e.acceptance_window_hours*60*60*1e3),w=new Date,y=b.getTime()-w.getTime();if(y<=0){u(!0),d("Expired");return}const j=Math.floor(y/(1e3*60*60)),S=Math.floor(y%(1e3*60*60)/(1e3*60));d(`${j.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")} remaining`)};m();const x=setInterval(m,6e4);return()=>clearInterval(x)},[e.settled_at,e.acceptance_window_hours]);const h=async()=>{try{await n(r)}catch(m){console.error("Failed to accept outcome:",m)}},f=()=>{o(!0)};return e.state!=="settled"||!s||c?null:t.jsx("div",{className:`
      fixed bottom-0 left-0 right-0 z-50
      bg-white border-t border-gray-200 
      p-4 pb-safe-area-inset-bottom
      ${i}
    `,children:t.jsxs("div",{className:"max-w-lg mx-auto",children:[t.jsxs("div",{className:"text-center mb-3",children:[t.jsxs("p",{className:"text-xs text-gray-600",children:["Review proof and Accept or Dispute within"," ",t.jsx("span",{className:"font-semibold text-amber-600",children:l})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No action  auto-accept"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:h,disabled:a,className:`flex-1 bg-teal-600 hover:bg-green-700 disabled:bg-teal-400
                       text-white font-semibold py-3 px-4 rounded-lg
                       transition-colors duration-200
                       flex items-center justify-center gap-2`,children:a?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),t.jsx("span",{children:"Accepting..."})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-lg",children:""}),t.jsx("span",{children:"Accept"})]})}),t.jsx("button",{onClick:f,disabled:a,className:`px-6 py-3 text-gray-700 hover:text-gray-900 
                       font-medium border border-gray-300 hover:border-gray-400
                       rounded-lg transition-colors duration-200`,children:"Dispute"})]})]})})},dh=({events:r,className:e=""})=>{const s=(l,d)=>{switch(l.toLowerCase()){case"locked":return"";case"source_fetched":return"";case"settled":return"";case"disputed":return"";case"voided":return"";case"accepted":return"";default:return d==="system"?"":""}},i=l=>{switch(l.toLowerCase()){case"settled":return"text-teal-600";case"disputed":return"text-red-600";case"voided":return"text-red-600";case"locked":return"text-amber-600";case"source_fetched":return"text-blue-600";case"accepted":return"text-teal-600";default:return"text-gray-600"}},n=(l,d)=>{switch(l){case"system":return"System";case"oracle":return"Oracle";case"admin":return`Admin ${d?`(${d.slice(0,8)})`:""}`;case"user":return`User ${d?`(${d.slice(0,8)})`:""}`;default:return l}},o=l=>l.split("_").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" "),a=l=>new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return!r||r.length===0?t.jsx("div",{className:`text-center py-8 text-gray-500 ${e}`,children:t.jsx("p",{className:"text-sm",children:"No audit events available"})}):t.jsxs("div",{className:`space-y-4 ${e}`,children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Audit Timeline"}),t.jsx("div",{className:"space-y-3",children:r.map((l,d)=>t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`
                w-8 h-8 rounded-full border-2 border-white 
                flex items-center justify-center text-xs
                ${i(l.event)} bg-gray-50
              `,children:s(l.event,l.actor_type)}),d<r.length-1&&t.jsx("div",{className:"w-0.5 bg-gray-200 h-6 mt-2"})]}),t.jsxs("div",{className:"flex-1 min-w-0 pb-2",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h5",{className:`text-sm font-medium ${i(l.event)}`,children:o(l.event)}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",n(l.actor_type,l.actor_id)]})]}),t.jsx("time",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:a(l.timestamp)})]}),l.data&&Object.keys(l.data).length>0&&t.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded text-xs",children:t.jsx("pre",{className:"text-gray-700 whitespace-pre-wrap",children:JSON.stringify(l.data,null,2)})})]})]},l.id))})]})},uh=({dispute:r,className:e=""})=>{const s=o=>{switch(o){case"open":return"bg-amber-100 text-amber-800 border-amber-200";case"under_review":return"bg-blue-100 text-blue-800 border-blue-200";case"upheld":return"bg-red-100 text-red-800 border-red-200";case"overturned":return"bg-teal-100 text-teal-800 border-teal-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},i=o=>{switch(o){case"wrong_source":return"Wrong Source Used";case"timing":return"Timing Issue";case"source_updated":return"Source Was Updated";case"other":return"Other";default:return o}},n=o=>new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${e}`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-red-500 text-sm",children:""}),t.jsxs("span",{className:"font-semibold text-gray-900 text-sm",children:["Dispute #",r.id.slice(0,8)]})]}),t.jsx("div",{className:`
          px-2 py-1 rounded-full text-xs font-medium border
          ${s(r.state)}
        `,children:r.state.replace("_"," ").toUpperCase()})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Reason:"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:i(r.reason)})]}),r.evidence&&r.evidence.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Evidence:"}),t.jsx("div",{className:"mt-1 space-y-1",children:r.evidence.map((o,a)=>t.jsx("div",{className:"text-sm",children:o.type==="link"?t.jsx("a",{href:o.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:o.value}):t.jsx("span",{className:"text-gray-700",children:o.value})},a))})]}),r.resolution_note&&t.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded border",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Resolution:"}),t.jsx("p",{className:"text-sm text-gray-700 mt-1",children:r.resolution_note})]}),t.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[t.jsxs("div",{children:["Created: ",n(r.created_at)]}),r.updated_at&&r.updated_at!==r.created_at&&t.jsxs("div",{children:["Updated: ",n(r.updated_at)]})]})]})},hh=({predictionId:r,isOpen:e,onClose:s})=>{const{createDispute:i,loading:n}=Tt(),[o,a]=p.useState("wrong_source"),[l,d]=p.useState(""),[c,u]=p.useState(""),h=[{value:"wrong_source",label:"Wrong Source Used",desc:"The settlement used an incorrect or unreliable source"},{value:"timing",label:"Timing Issue",desc:"Settlement occurred at wrong time or before event completion"},{value:"source_updated",label:"Source Was Updated",desc:"The source corrected or updated the information after settlement"},{value:"other",label:"Other",desc:"Other reason (please specify below)"}],f=async m=>{m.preventDefault();const x=l.split(`
`).filter(g=>g.trim()).map(g=>({type:"link",value:g.trim()}));o==="other"&&c.trim()&&x.push({type:"link",value:`Custom reason: ${c}`});try{await i(r,o,x),s(),a("wrong_source"),d(""),u("")}catch(g){console.error("Failed to create dispute:",g)}};return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Dispute Settlement"}),t.jsxs("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:[t.jsx("span",{className:"sr-only",children:"Close"}),t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Please provide a reason for your dispute and any supporting evidence."})]}),t.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Reason for dispute"}),t.jsx("div",{className:"space-y-2",children:h.map(m=>t.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"reason",value:m.value,checked:o===m.value,onChange:x=>a(x.target.value),className:"mt-1 text-blue-600 focus:ring-blue-500"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.label}),t.jsx("div",{className:"text-xs text-gray-500",children:m.desc})]})]},m.value))})]}),o==="other"&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customReason",className:"block text-sm font-medium text-gray-700 mb-1",children:"Please specify"}),t.jsx("textarea",{id:"customReason",value:c,onChange:m=>u(m.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe the issue in detail...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"evidence",className:"block text-sm font-medium text-gray-700 mb-1",children:"Supporting evidence (optional)"}),t.jsx("textarea",{id:"evidence",value:l,onChange:m=>d(m.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Paste URLs to supporting evidence, one per line..."}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Include links to news articles, official sources, or other relevant evidence."})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",disabled:n,children:"Cancel"}),t.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:bg-red-400",disabled:n,children:n?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),t.jsx("span",{children:"Submitting..."})]}):"Submit Dispute"})]})]}),t.jsx("div",{className:"px-6 pb-6",children:t.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-3",children:t.jsxs("p",{children:[t.jsx("strong",{children:"Note:"})," We've received your dispute. A reviewer will follow up within 24 hours. Fraudulent disputes may result in account restrictions."]})})})]})}):null},ph=({proof:r,className:e=""})=>{const s=async()=>{try{await navigator.clipboard.writeText(r.content_hash)}catch(o){console.error("Failed to copy hash:",o)}},i=()=>{window.open(r.source_url,"_blank","noopener,noreferrer")},n=o=>new Date(o).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"});return t.jsx("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${e}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-16 h-12 bg-gray-100 rounded border flex items-center justify-center flex-shrink-0",children:r.screenshot_url?t.jsx("img",{src:r.screenshot_url,alt:"Settlement proof",className:"w-full h-full object-cover rounded",loading:"lazy"}):t.jsx("span",{className:"text-gray-400 text-xs",children:""})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 truncate",children:"Settlement Proof"}),t.jsx("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:n(r.fetched_at)})]}),r.parser_note&&t.jsx("p",{className:"text-sm text-gray-700 mb-2",children:r.parser_note}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{onClick:i,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Open source "}),t.jsx("button",{onClick:s,className:"text-xs text-gray-600 hover:text-gray-800 font-medium",title:`Hash: ${r.content_hash}`,children:"Copy hash"})]}),t.jsxs("div",{className:"mt-2 text-xs text-gray-500 font-mono truncate",children:[r.content_hash.slice(0,16),"...",r.content_hash.slice(-8)]})]})]})})},fh=({method:r,badges:e=[],className:s=""})=>{const i=()=>e.includes("Oracle")?{text:"Oracle",icon:"",bgColor:"bg-purple-100",textColor:"text-purple-700",borderColor:"border-purple-200"}:e.includes("Auto-Settled")?{text:"Auto-Settled",icon:"",bgColor:"bg-teal-100",textColor:"text-teal-700",borderColor:"border-teal-200"}:e.includes("Manual-Checked")?{text:"Manual-Checked",icon:"",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"}:r==="auto"?{text:"Auto-Settlement",icon:"",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}:{text:"Manual Settlement",icon:"",bgColor:"bg-amber-100",textColor:"text-amber-700",borderColor:"border-amber-200"},{text:n,icon:o,bgColor:a,textColor:l,borderColor:d}=i();return t.jsxs("div",{className:`
      inline-flex items-center gap-1.5 px-2.5 py-1 
      ${a} ${l} ${d}
      border rounded-full text-xs font-medium
      ${s}
    `,children:[t.jsx("span",{className:"text-xs",children:o}),t.jsx("span",{children:n})]})},mh=({predictionId:r,state:e,userHasEntry:s=!1,className:i=""})=>{const{settlements:n,fetchSettlement:o}=Tt(),[a,l]=p.useState(null);p.useEffect(()=>{o(r)},[r,o]),p.useEffect(()=>{n[r]&&l(n[r])},[n,r]);const c=(()=>{switch(e){case"settling":return{title:"Settlement in Progress",description:"We're fetching the official result...",icon:"",bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"};case"settled":return{title:"Settlement Complete",description:"Official outcome has been determined",icon:"",bgColor:"bg-teal-50",textColor:"text-teal-700",borderColor:"border-teal-200"};case"voided":return{title:"Event Voided",description:"Event postponed/cancelledstakes returned",icon:"",bgColor:"bg-red-50",textColor:"text-red-700",borderColor:"border-red-200"};case"disputed":return{title:"Under Dispute",description:"Settlement is being reviewed",icon:"",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"};case"resolved":return{title:"Dispute Resolved",description:"Final outcome confirmed after review",icon:"",bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"};default:return null}})();return c?t.jsx("div",{className:`
      ${c.bgColor} ${c.borderColor} ${c.textColor}
      border rounded-lg p-4 ${i}
    `,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-xl",children:c.icon}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-semibold text-sm mb-1",children:c.title}),t.jsx("p",{className:"text-sm opacity-90",children:c.description}),e==="settling"&&t.jsxs("div",{className:"mt-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-xs",children:"Estimated time: ~10 minutes"})]}),t.jsx("p",{className:"text-xs mt-2 opacity-75",children:"We'll notify you when the outcome is available."})]}),e==="settled"&&a?.outcome&&t.jsx("div",{className:"mt-3",children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-white rounded-full text-sm font-semibold",children:[t.jsx("span",{children:"Outcome:"}),t.jsx("span",{className:a.outcome==="YES"?"text-teal-600":"text-red-600",children:a.outcome})]})}),e==="voided"&&t.jsx("div",{className:"mt-3",children:t.jsx("p",{className:"text-xs opacity-75",children:"All participants will receive their original stake back."})})]})]})}):null},gh=({predictionId:r,settlement:e,isOpen:s,onClose:i})=>{const{settlementConfigs:n,fetchSettlement:o}=Tt(),[a,l]=p.useState(e||null);p.useEffect(()=>{s&&r&&!e&&o(r)},[s,r,e,o]),p.useEffect(()=>{r&&n[r]?l(n[r]):e&&l(e)},[n,r,e]);const d=async()=>{if(a)try{await navigator.clipboard.writeText(a.rule_text)}catch(u){console.error("Failed to copy rule:",u)}},c=(u,h)=>{const f={postponed:"If event is postponed",source_down:"If source is unavailable"},m={auto_void:"Automatically void and return stakes",extend_lock:"Extend the lock time",keep_open:"Keep prediction open",use_backup:"Use backup source",pause_and_escalate:"Pause and escalate to admin"};return`${f[u]||u}: ${m[h]||h}`};return s?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"How This Settles"}),t.jsxs("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:[t.jsx("span",{className:"sr-only",children:"Close"}),t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"This market will be settled using official sources."})]}),t.jsx("div",{className:"p-6 space-y-6",children:a?t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Settlement Rule"}),t.jsx("button",{onClick:d,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Copy rule"})]}),t.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:t.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:a.rule_text})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Sources"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-teal-50 border border-teal-200 rounded-lg",children:[t.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.primary_source.name}),t.jsx("div",{className:"text-xs text-gray-600",children:a.primary_source.url})]}),t.jsx("span",{className:"text-xs bg-teal-600 text-white px-2 py-1 rounded-full font-semibold",children:"PRIMARY"})]}),a.backup_source&&t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[t.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.backup_source.name}),t.jsx("div",{className:"text-xs text-gray-600",children:a.backup_source.url})]}),t.jsx("span",{className:"text-xs bg-amber-600 text-white px-2 py-1 rounded-full font-semibold",children:"BACKUP"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"text-xs font-medium text-gray-500 mb-1",children:"Settlement Method"}),t.jsx("p",{className:"text-sm text-gray-900 capitalize",children:a.method.replace("_"," ")})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"text-xs font-medium text-gray-500 mb-1",children:"Timezone"}),t.jsx("p",{className:"text-sm text-gray-900",children:a.timezone})]})]}),a.contingencies&&Object.keys(a.contingencies).length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Contingency Rules"}),t.jsx("div",{className:"space-y-2",children:Object.entries(a.contingencies).map(([u,h])=>t.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded border",children:c(u,h)},u))})]}),a.badges&&a.badges.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Quality Indicators"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a.badges.map((u,h)=>t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:u.replace("-"," ")},h))})]})]}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Loading settlement information..."})]})}),t.jsx("div",{className:"px-6 pb-6",children:t.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-3",children:t.jsxs("p",{children:[t.jsx("strong",{children:"Note:"})," We settle using public, official sourcesno rumors. All settlements are auditable and transparent."]})})})]})}):null},_i=({timezone:r,timestamp:e,className:s=""})=>{const[i,n]=p.useState(!1),o=new Date(e),a=(d,c)=>{if(c==="UTC"||i)return d.toISOString().replace("T"," ").slice(0,19)+" UTC";try{return new Intl.DateTimeFormat("en-US",{timeZone:c,year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"}).format(d)}catch{return d.toISOString().replace("T"," ").slice(0,19)+" UTC"}},l=()=>{n(!i)};return t.jsx("div",{className:`inline-flex items-center ${s}`,children:t.jsxs("button",{onClick:l,className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium 
                   text-gray-700 bg-gray-100 hover:bg-gray-200 
                   border border-gray-200 rounded transition-colors`,children:[t.jsx("span",{className:"text-[10px]",children:""}),t.jsx("span",{children:a(o,r)}),t.jsx("span",{className:"text-[10px] text-gray-500",children:i?" Local":" UTC"})]})})},xh=({predictionId:r,onNavigateBack:e})=>{const[,s]=de(),[i,n]=p.useState(null),[o,a]=p.useState(""),[l,d]=p.useState(!1),[c,u]=p.useState(null),[h,f]=p.useState(!0),[m,x]=p.useState(!1),[g,b]=p.useState(!1),[w,y]=p.useState(!1),[j,S]=p.useState(!1),O=p.useRef(null),C=p.useRef(null),{predictions:$,fetchPredictions:J,fetchPredictionById:M,placePrediction:K}=Pt(),{isAuthenticated:I,user:D}=ie(),{getBalance:Z}=js(),{checkIfLiked:k,getLikeCount:A,toggleLike:N}=Sr(),{settlements:E,disputes:v,auditTimeline:_,fetchSettlement:L,fetchDisputes:P,fetchAuditTimeline:R,disputeModalOpen:F,setDisputeModalOpen:te}=Tt(),Y=p.useMemo(()=>{if(r)return r;const ne=window.location.pathname.match(/\/prediction\/([^\/]+)/);return ne?ne[1]:null},[r]),oe=p.useMemo(()=>Y||"",[Y]),_e=p.useMemo(()=>Y&&$.find(q=>q.id===Y)||null,[$,Y]),{commentCount:Ps}=Pr(oe);p.useEffect(()=>{(async()=>{if(!Y){console.log(" No prediction ID found"),s("/discover");return}console.log(" Loading prediction with ID:",Y),f(!0);try{const ne=await M(Y);ne?(console.log(" Found prediction:",ne.title),u(ne),["locked","settling","settled","voided","disputed","resolved"].includes(ne.status)&&(await L(Y),await P(Y),await R(Y))):(console.log(" Prediction not found:",Y),u(null))}catch(ne){console.error(" Error loading prediction:",ne),u(null)}finally{f(!1)}})()},[Y,M,s,L,P,R]),p.useEffect(()=>{_e&&c?.id===_e.id&&(console.log(" Updating prediction with latest data from store"),u(_e))},[_e,c?.id]);const At=()=>{if(console.log(" Navigating back"),e)e();else try{window.history.length>1?window.history.back():s("/discover")}catch(q){console.error("Navigation error:",q),s("/discover")}},Se=q=>{console.log(" Option selected:",q),n(q)},Es=q=>{const ne=q.target.value;(ne===""||/^\d+(\.\d{0,2})?$/.test(ne))&&a(ne)},Yt=async()=>{if(!I){G.error("Please sign in to place a prediction");return}if(!i){G.error("Please select an option");return}const q=parseFloat(o);if(!q||q<c.stake_min){G.error(`Minimum stake is $${c.stake_min}`);return}if(c.stake_max&&q>c.stake_max){G.error(`Maximum stake is $${c.stake_max}`);return}const ne=Z("USD");if(q>ne){G.error("Insufficient wallet balance");return}d(!0);try{console.log(" Placing prediction:",{predictionId:c.id,optionId:i,amount:q}),await K({predictionId:c.id,optionId:i,amount:q,userId:D?.id||""}),G.success("Prediction placed successfully!"),a(""),n(null),setTimeout(()=>{J()},1e3)}catch(Ke){console.error(" Failed to place prediction:",Ke);const Ce=Ke instanceof Error?Ke.message:"Failed to place prediction";G.error(Ce)}finally{d(!1)}},Ts=async()=>{if(!c){G.error("No prediction to share");return}const q=`${window.location.origin}/prediction/${c.id}`,ne=`${c.title}

Make your prediction on Fan Club Z!`;if(navigator.share&&navigator.canShare)try{await navigator.share({title:c.title,text:ne,url:q});return}catch(Ke){console.log("Native sharing cancelled or failed:",Ke)}try{await navigator.clipboard.writeText(`${ne}
${q}`),G.success("Link copied to clipboard!")}catch(Ke){console.error("Clipboard API failed:",Ke);const Ce=document.createElement("textarea");Ce.value=`${ne}
${q}`,Ce.style.position="fixed",Ce.style.left="-999999px",Ce.style.top="-999999px",document.body.appendChild(Ce),Ce.focus(),Ce.select();try{document.execCommand("copy"),G.success("Link copied to clipboard!")}catch(so){G.error("Failed to copy link"),console.error("execCommand failed:",so)}finally{document.body.removeChild(Ce)}}},U=async()=>{if(!I){G.error("Please sign in to like this prediction");return}try{await N(c.id),G.success(k(c.id)?"Liked prediction!":"Removed like")}catch{G.error("Failed to update like")}},ae=()=>{console.log(" Toggling comments from:",m,"to:",!m);const q=!m;x(q),q?setTimeout(()=>{O.current&&O.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},300):C.current&&C.current.scrollIntoView({behavior:"smooth",block:"center"})},ye=()=>c?.creator?{id:c.creator.id||c.creator_id,username:c.creator.username||c.creator.full_name||"creator",displayName:c.creator.full_name||c.creator.username,avatar_url:c.creator.avatar_url}:c?.creator_id?{id:c.creator_id,username:"creator",displayName:"Creator"}:{id:"unknown",username:"Fan Club Z",displayName:"Fan Club Z"},ue=c?.user_entry||c?.entries?.some(q=>q.user_id===D?.id),Ue=E[c?.id],Lr=v[c?.id]||[],zr=_[c?.id]||[];if(h)return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsx("div",{className:"px-4 py-4",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("button",{onClick:At,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(ot,{size:20}),t.jsx("span",{className:"font-medium",children:"Back"})]})})})}),t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-teal-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading prediction..."})]})})]});if(!c)return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsx("div",{className:"px-4 py-4",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("button",{onClick:At,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(ot,{size:20}),t.jsx("span",{className:"font-medium",children:"Back"})]})})})}),t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Prediction Not Found"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"The prediction you're looking for doesn't exist or has been removed."}),t.jsx("button",{onClick:()=>s("/discover"),className:"bg-teal-500 text-white px-6 py-2 rounded-lg hover:bg-teal-600 transition-colors",children:"Browse Predictions"})]})})]});const Dr=c.options?.find(q=>q.id===i),Ur=Dr&&o?parseFloat(o)*Dr.current_odds:0,to=c.status==="open"&&new Date(c.entry_deadline)>new Date,Zt=ye();return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:t.jsx("div",{className:"px-4 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("button",{onClick:At,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(ot,{size:20}),t.jsx("span",{className:"font-medium",children:"Back"})]}),t.jsx("button",{onClick:Ts,className:"p-2 text-gray-600 hover:text-gray-900 transition-colors rounded-lg hover:bg-gray-100",children:t.jsx(md,{size:20})})]})})}),t.jsxs("div",{className:"px-4 py-6 max-w-2xl mx-auto pb-24",children:[t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border border-gray-100",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-400 to-teal-600 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-white font-bold text-lg",children:Zt.username?.charAt(0)?.toUpperCase()||"FC"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(qt,{username:Zt.username,userId:Zt.id,displayName:Zt.displayName,className:"font-semibold text-gray-900 text-lg hover:text-teal-600 transition-colors",showAt:!1})}),t.jsx("div",{className:"text-sm text-gray-500",children:new Date(c.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),c.settlement?.method&&t.jsx(fh,{method:c.settlement.method,badges:c.settlement.badges})]}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4 leading-tight",children:c.title}),c.description&&t.jsx("p",{className:"text-gray-600 mb-6 leading-relaxed text-base",children:c.description}),c.settlement&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Settlement Rule:"}),t.jsx("button",{onClick:()=>b(!0),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View full rule"})]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:c.settlement.rule_text})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"text-center p-4 bg-teal-50 rounded-xl",children:[t.jsxs("div",{className:"text-2xl font-bold text-teal-600",children:["$",(c.pool_total||0).toLocaleString()]}),t.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Pool"})]}),t.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.participant_count||0}),t.jsx("div",{className:"text-sm text-gray-600 font-medium whitespace-nowrap text-center",children:"Participants"})]}),t.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:c.options?.length||0}),t.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Options"})]})]}),c.status==="open"&&t.jsxs("div",{className:"flex items-center gap-3 text-orange-600 bg-orange-50 px-4 py-3 rounded-xl",children:[t.jsx(kt,{size:20}),t.jsxs("div",{children:[t.jsxs("div",{className:"font-semibold",children:[Eu(c.entry_deadline)," remaining"]}),t.jsx("div",{className:"text-sm text-orange-500",children:t.jsx(_i,{timezone:c.settlement?.timezone||"UTC",timestamp:c.entry_deadline})})]})]}),c.lock_time&&c.status!=="open"&&t.jsxs("div",{className:"flex items-center gap-3 text-gray-600 bg-gray-50 px-4 py-3 rounded-xl",children:[t.jsx(kt,{size:20}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:"Locked at"}),t.jsx("div",{className:"text-sm",children:t.jsx(_i,{timezone:c.settlement?.timezone||"UTC",timestamp:c.lock_time})})]})]})]}),["settling","settled","voided","disputed","resolved"].includes(c.status)&&t.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"mb-6",children:t.jsx(mh,{predictionId:c.id,state:c.status,userHasEntry:ue})}),c.status==="settled"&&Ue?.proof&&t.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:t.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Settlement Proof"}),t.jsx("button",{onClick:()=>y(!w),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:w?"Hide details":"Show details"})]}),t.jsx(ph,{proof:Ue.proof}),w&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Technical Details"}),t.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Content Hash:"})," ",Ue.proof.content_hash]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Fetched At:"})," ",new Date(Ue.proof.fetched_at).toLocaleString()]}),Ue.proof.parser_note&&t.jsxs("div",{children:[t.jsx("strong",{children:"Parser Note:"})," ",Ue.proof.parser_note]})]})]})]})}),Lr.length>0&&t.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"mb-6",children:t.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Disputes"}),t.jsx("div",{className:"space-y-4",children:Lr.map(q=>t.jsx(uh,{dispute:q},q.id))})]})}),zr.length>0&&t.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-6",children:t.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Audit Timeline"}),t.jsx("button",{onClick:()=>S(!j),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:j?"Hide timeline":"Show timeline"})]}),j&&t.jsx(dh,{events:zr})]})}),to&&t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border border-gray-100",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Place Your Prediction"}),t.jsx("div",{className:"space-y-3 mb-6",children:c.options?.map((q,ne)=>t.jsx(T.button,{onClick:()=>Se(q.id),className:`w-full p-4 rounded-xl border-2 transition-all ${i===q.id?"border-teal-500 bg-teal-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,whileHover:{scale:1.01},whileTap:{scale:.99},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-left flex-1",children:[t.jsx("div",{className:"font-semibold text-gray-900 text-lg mb-1",children:q.label}),t.jsxs("div",{className:"text-sm text-gray-500",children:[c.pool_total>0?`${(q.total_staked/c.pool_total*100).toFixed(1)}% of pool`:"0% of pool","  $",(q.total_staked||0).toLocaleString()," staked"]})]}),t.jsxs("div",{className:"text-right ml-4",children:[t.jsxs("div",{className:"text-2xl font-bold text-teal-600",children:[(q.current_odds||1).toFixed(2),"x"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"odds"})]})]})},q.id))}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Stake Amount (USD)"}),t.jsxs("div",{className:"relative",children:[t.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-lg",children:"$"}),t.jsx("input",{type:"text",value:o,onChange:Es,placeholder:"0.00",className:"w-full pl-10 pr-4 py-4 border-2 border-gray-200 rounded-xl focus:border-teal-500 focus:outline-none transition-colors text-lg"})]}),t.jsxs("div",{className:"flex justify-between text-sm text-gray-500 mt-2",children:[t.jsxs("span",{children:["Min: $",c.stake_min]}),t.jsxs("span",{children:["Max: $",c.stake_max||"No limit"]})]})]}),t.jsx(xe,{children:i&&o&&t.jsxs(T.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-teal-50 border-2 border-teal-200 rounded-xl p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-teal-800 font-semibold",children:"Potential Payout:"}),t.jsxs("span",{className:"text-teal-800 font-bold text-xl",children:["$",Ur.toFixed(2)]})]}),t.jsxs("div",{className:"text-teal-700 text-sm",children:["Profit: $",Math.max(0,Ur-parseFloat(o)).toFixed(2)]})]})}),t.jsx(T.button,{onClick:Yt,disabled:!i||!o||l,className:`w-full py-4 rounded-xl font-semibold text-white transition-all text-lg ${i&&o&&!l?"bg-teal-500 hover:bg-teal-600 active:bg-green-700 shadow-lg":"bg-gray-300 cursor-not-allowed"}`,whileHover:i&&o&&!l?{scale:1.02}:{},whileTap:i&&o&&!l?{scale:.98}:{},children:l?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Placing Prediction..."]}):"Place Prediction"})]}),t.jsxs(T.div,{ref:C,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Community Engagement"}),t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(T.button,{onClick:U,className:`flex items-center gap-2 transition-colors ${k(c.id)?"text-red-500":"text-gray-600 hover:text-red-500"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(at,{size:20,fill:k(c.id)?"currentColor":"none"}),t.jsxs("span",{className:"font-medium",children:[A(c.id)," likes"]})]}),t.jsxs(T.button,{onClick:ae,className:`flex items-center gap-2 transition-colors ${m?"text-blue-500":"text-gray-600 hover:text-blue-500"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(Ae,{size:20}),t.jsxs("span",{className:"font-medium",children:[Ps," comments"]}),t.jsx(ed,{size:16,className:`transition-transform ml-1 ${m?"rotate-180":""}`})]}),t.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[t.jsx(ke,{size:20}),t.jsxs("span",{className:"font-medium",children:[c.participant_count||0," participants"]})]})]})]}),t.jsx(xe,{children:m&&t.jsxs(T.div,{ref:O,initial:{opacity:0,y:-20,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:-20,height:0},transition:{duration:.4,ease:"easeInOut"},className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-6",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Comments"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Join the conversation about this prediction"})]}),t.jsx("div",{className:"min-h-[300px] max-h-[600px] overflow-y-auto",children:t.jsx(lh,{predictionId:oe})})]})})]})]}),t.jsx(gh,{predictionId:c?.id,settlement:c?.settlement,isOpen:g,onClose:()=>b(!1)}),t.jsx(hh,{predictionId:c?.id||"",isOpen:F,onClose:()=>te(!1)}),c.status==="settled"&&ue&&Ue&&t.jsx(ch,{predictionId:c.id,settlementData:Ue,userHasEntry:ue})]})},bh=({activeTab:r="discover",onTabChange:e,showFAB:s=!1,onFABClick:i})=>{const n=[{id:"discover",label:"Discover",icon:jn},{id:"bets",label:"My Bets",icon:ke},{id:"wallet",label:"Wallet",icon:Ht},{id:"profile",label:"Profile",icon:Ir}],o=a=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"}),e&&e(a)};return t.jsx("div",{style:{position:"fixed",bottom:"0",left:"0",right:"0",zIndex:"1000",backgroundColor:"white",borderTop:"1px solid #e5e7eb",paddingBottom:"max(env(safe-area-inset-bottom), 0.5rem)",paddingTop:"0.5rem",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.1)"},children:t.jsxs("nav",{style:{padding:"0 1rem",position:"relative"},children:[t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around",maxWidth:"400px",margin:"0 auto",position:"relative"},children:n.map(a=>{const l=a.icon,d=r===a.id;return t.jsxs(T.button,{onClick:()=>o(a.id),whileHover:{scale:1.05},whileTap:{scale:.95},style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"8px 4px",minWidth:"0",flex:"1",position:"relative",background:"none",border:"none",cursor:"pointer",borderRadius:"12px",transition:"all 0.2s ease"},onMouseEnter:c=>{d||(c.currentTarget.style.backgroundColor="#f9fafb")},onMouseLeave:c=>{d||(c.currentTarget.style.backgroundColor="transparent")},"data-tour-id":`tab-${a.id}`,children:[t.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"6px",marginTop:"2px",width:"24px",height:"24px"},children:[t.jsx("div",{style:{transition:"all 0.2s ease",color:d?"#7B2FF7":"#6b7280",transform:d?"scale(1.1)":"scale(1)",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(l,{size:20})}),d&&t.jsx(T.div,{layoutId:"activeTab",style:{position:"absolute",top:"-6px",left:"50%",transform:"translateX(-50%)",width:"4px",height:"4px",backgroundColor:"#7B2FF7",borderRadius:"50%",boxShadow:"0 0 6px rgba(34, 197, 94, 0.6)"},initial:!1,transition:{type:"spring",stiffness:400,damping:30}})]}),t.jsx("span",{style:{fontSize:"11px",fontWeight:d?"600":"500",transition:"all 0.2s ease",color:d?"#7B2FF7":"#6b7280",textAlign:"center",lineHeight:"1.2"},children:a.label})]},a.id)})}),s&&t.jsx(T.button,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:i,"data-tour-id":"create-fab",style:{position:"fixed",bottom:"calc(80px + env(safe-area-inset-bottom, 0px))",right:"16px",width:"56px",height:"56px",borderRadius:"50%",background:"linear-gradient(135deg, #7B2FF7, #00F5D4)",border:"none",boxShadow:"0 8px 24px rgba(34, 197, 94, 0.4)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:t.jsx(ct,{size:24,style:{color:"white"}})})]})})},Or=({message:r="Loading..."})=>t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-600",children:r})]})}),Xn=p.memo(({children:r})=>{const{isAuthenticated:e,loading:s,initialized:i,initializeAuth:n}=ie();return p.useEffect(()=>{!i&&!s&&n()},[i,s,n]),!i||s&&!e?t.jsx(Or,{message:"Authenticating..."}):e?t.jsx(t.Fragment,{children:r}):t.jsx(oh,{})});Xn.displayName="AuthGuard";const eo=p.memo(({children:r})=>{const[e,s]=de(),i=p.useCallback(()=>{const l=e.toLowerCase();return l==="/"||l==="/discover"?"discover":l==="/bets"||l==="/predictions"?"bets":l==="/profile"?"profile":l==="/wallet"?"wallet":"discover"},[e]),n=p.useCallback(l=>{if(i()!==l){switch(lt(e),jt(),l){case"discover":s("/");break;case"bets":s("/predictions");break;case"profile":s("/profile");break;case"wallet":s("/wallet");break;default:s("/")}setTimeout(()=>{yt({behavior:"instant"})},50)}},[s,i,e]),o=p.useCallback(()=>{lt(e),jt(),s("/create")},[s,e]),a=i()==="discover";return t.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col","data-scroll-container":!0,children:[t.jsx("main",{className:"flex-1 pb-20",children:t.jsx(p.Suspense,{fallback:t.jsx(Or,{message:"Loading page..."}),children:r})}),t.jsx(bh,{activeTab:i(),onTabChange:n,showFAB:a,onFABClick:o}),t.jsx(bn,{}),t.jsx(Sd,{}),t.jsx(Vc,{position:"top-center",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})});eo.displayName="MainLayout";const qs=()=>{const[r,e]=de(),s=p.useCallback(()=>{lt(r),e("/profile")},[e,r]),i=p.useCallback(n=>{lt(r),e(`/prediction/${n}`)},[e,r]);return t.jsx(ze,{title:"Discover",children:t.jsx(Zn,{onNavigateToProfile:s,onNavigateToPrediction:i})})},Si=()=>{const[r,e]=de(),s=p.useCallback(()=>{lt(r),e("/")},[e,r]);return t.jsx(ze,{title:"My Predictions",children:t.jsx(Ju,{onNavigateToDiscover:s})})},yh=()=>{const[r,e]=de(),s=p.useCallback(()=>{jt(),e("/")},[e]);return t.jsx(ze,{title:"Create Prediction",children:t.jsx(Gu,{onNavigateBack:s})})},vh=({params:r})=>{const[e,s]=de(),i=p.useCallback(()=>{window.history.length>1?window.history.back():(jt(),s("/"))},[s]),n=re.useMemo(()=>{const o=r?.userId;if(!o){console.warn(" No userId provided in profile route");return}const a=o.trim();if(!a){console.warn(" Empty userId in profile route");return}if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a))return console.log(" Valid UUID userId:",a),a;if(a.length>2)return console.log(" Non-UUID userId (might be username):",a),a;console.warn(" Invalid userId format:",a)},[r?.userId]);return n?(console.log(" UserProfilePageWrapper rendering with userId:",n),t.jsx(ze,{title:"User Profile",children:t.jsx(Qn,{onNavigateBack:i,userId:n})})):(re.useEffect(()=>{console.warn(" Invalid userId in profile route, redirecting to own profile"),jt(),s("/profile")},[s]),t.jsx(Or,{message:"Redirecting..."}))},wh=()=>{const[r,e]=de(),s=p.useCallback(()=>{lt(r),e("/")},[e,r]);return t.jsx(ze,{title:"My Profile",children:t.jsx(Qn,{onNavigateBack:s})})},jh=()=>{const[r,e]=de(),s=p.useCallback(()=>{lt(r),e("/")},[e,r]);return t.jsx(ze,{title:"Wallet",children:t.jsx(nh,{onNavigateBack:s})})},kh=({params:r})=>{const[e,s]=de(),i=p.useCallback(()=>{console.log(" Navigating back from prediction details"),window.history.length>1?window.history.back():(jt(),s("/"))},[s]);return r?.id?t.jsx(ze,{title:"Prediction Details",children:t.jsx(xh,{predictionId:r.id,onNavigateBack:i})}):t.jsx(ze,{title:"Error",children:t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Prediction Not Found"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"The prediction you're looking for doesn't exist."}),t.jsx("button",{onClick:i,className:"px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600",children:"Go Back"})]})})})};function Nh(){const{initializeWallet:r}=js(),{initializeAuth:e,isAuthenticated:s,loading:i,initialized:n}=ie(),{initializeLikes:o}=Sr(),{initialize:a}=Cr();return p.useEffect(()=>{if(!n&&!i)try{console.log("App: Initializing auth..."),e()}catch(l){console.error("Auth initialization failed:",l)}},[e,n,i]),p.useEffect(()=>{if(s&&!i&&n)try{console.log("App: Initializing wallet and social features..."),r(),o(),a(),console.log(" All stores initialized successfully")}catch(l){console.error("Store initialization failed:",l)}},[s,i,n,r,o,a]),t.jsx(zi,{children:t.jsxs(Vr,{children:[t.jsx(ve,{path:"/auth/callback",children:t.jsx(ze,{title:"Authentication",children:t.jsx(ah,{})})}),t.jsx(Xn,{children:t.jsx(Ud,{children:t.jsx(eo,{children:t.jsxs(Vr,{children:[t.jsx(ve,{path:"/",component:qs}),t.jsx(ve,{path:"/discover",component:qs}),t.jsx(ve,{path:"/predictions",component:Si}),t.jsx(ve,{path:"/bets",component:Si}),t.jsx(ve,{path:"/create",component:yh}),t.jsx(ve,{path:"/profile",component:wh}),t.jsx(ve,{path:"/profile/:userId",component:vh}),t.jsx(ve,{path:"/wallet",component:jh}),t.jsx(ve,{path:"/prediction/:id",component:kh}),t.jsx(ve,{component:qs})]})})})})]})})}console.log(` Fan Club Z ${Cs} - CONSOLIDATED ARCHITECTURE - SINGLE SOURCE OF TRUTH`);window.addEventListener("unhandledrejection",r=>{console.error("Unhandled promise rejection:",r.reason)});window.addEventListener("error",r=>{console.error("Global error:",r.error)});Gs.createRoot(document.getElementById("root")).render(t.jsx(re.StrictMode,{children:t.jsx(Cn,{onError:(r,e)=>{console.error("React Error Boundary triggered:",r,e)},children:t.jsx(Nh,{})})}));console.log(` Fan Club Z ${Cs} - Application started successfully`);console.log(" Build timestamp:",eh);
