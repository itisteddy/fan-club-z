import{j as e}from"./ui-7ef4368a.js";import{r as p}from"./vendor-2237fdcd.js";import{a as D,k as S,c as k,d as F,o as U,T as C,D as d,P as g,z as b}from"./index-9e31fc92.js";import{A as j}from"./AppHeader-1e74d6d2.js";import{C as T}from"./credit-card-d6abd805.js";import{D as W}from"./dollar-sign-39be1c43.js";import"./utils-ac284782.js";const Y=({onNavigateBack:z})=>{const{user:f,isAuthenticated:y}=D(),{user:t,initialized:P}=S(),{getBalance:N,getTransactionHistory:v,addFunds:w,initializeWallet:n}=k(),[_,c]=p.useState(!0);F();const r=t?!0:y,o=t?{id:t.id,firstName:t.user_metadata?.firstName||t.user_metadata?.first_name||t.user_metadata?.full_name?.split(" ")[0]||"User",lastName:t.user_metadata?.lastName||t.user_metadata?.last_name||t.user_metadata?.full_name?.split(" ").slice(1).join(" ")||"",email:t.email||"",phone:t.phone,avatar:t.user_metadata?.avatar_url||t.user_metadata?.picture,provider:t.app_metadata?.provider||"email",createdAt:t.created_at}:f;p.useEffect(()=>{r&&o?.id?(n(),c(!1)):r||c(!1)},[r,o?.id,n]);const m=N("USD")||0,l=v({currency:"USD"})||[],x=l.filter(s=>s.type==="deposit").reduce((s,a)=>s+a.amount,0),A=l.length,h=l.sort((s,a)=>new Date(a.created_at).getTime()-new Date(s.created_at).getTime()).slice(0,5),u=async s=>{try{await w(s,"USD","Demo funds added"),b.success(`Successfully added $${s.toLocaleString()} to your wallet!`)}catch(a){console.error("Failed to add funds:",a),b.error("Failed to add funds. Please try again.")}},i=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(s);return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(j,{title:"Wallet"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsx("div",{className:"space-y-4",children:_?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(C,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Net Profit"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:i(m-x)})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(d,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Deposits"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:i(x)})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(W,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Transactions"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:A})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Overview"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:i(m)}),e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Available Balance"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>u(100),className:"flex-1 flex items-center justify-center space-x-2 py-3 px-4 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Funds"})]}),e.jsxs("button",{className:"flex-1 flex items-center justify-center space-x-2 py-3 px-4 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",disabled:!0,children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{children:"Withdraw"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Recent Activity"}),h.length>0?e.jsx("div",{className:"space-y-3",children:h.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s.type==="deposit"?"bg-green-100":"bg-red-100"}`,children:s.type==="deposit"?e.jsx(g,{className:"w-4 h-4 text-green-600"}):e.jsx(d,{className:"w-4 h-4 text-red-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.description||(s.type==="deposit"?"Funds Added":"Withdrawal")}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-sm font-medium ${s.type==="deposit"?"text-green-600":"text-red-600"}`,children:[s.type==="deposit"?"+":"-",i(Math.abs(s.amount))]}),e.jsx("div",{className:"text-xs text-gray-500",children:s.status})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No transactions yet"}),e.jsx("p",{className:"text-sm mb-4",children:"Your transaction history will appear here."}),e.jsx("button",{onClick:()=>u(100),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Add Your First Funds"})]})]})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(j,{title:"Wallet"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-12 px-4",children:[e.jsx("div",{className:"mb-4 text-gray-300",children:e.jsx(T,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view your wallet"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6 max-w-sm",children:"See your balance, deposits, and transactions."}),e.jsx("button",{onClick:async()=>{try{await U({intent:"view_wallet"})}catch(s){console.error("Auth gate error:",s)}},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"})]})})]})};export{Y as default};
