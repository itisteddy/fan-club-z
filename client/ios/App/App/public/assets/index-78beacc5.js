var Yd=Object.defineProperty;var Qd=(s,e,t)=>e in s?Yd(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var te=(s,e,t)=>(Qd(s,typeof e!="symbol"?e+"":e,t),t);import{_ as I,t as Xd,a as nn,j as n,A as As,m as pe,c as eu,R as $l,P as Ul,O as Bl,C as Fl,T as Ml,D as tu,b as zn}from"./ui-c369d1f3.js";import{b as Vl,r as m,d as su,R as Ie,a as ru}from"./vendor-c36eaa8e.js";import{_ as H,u as nu,c as si,g as tt,U as Ve,S as Os,C as ri,b as Xt,P as Vi,e as au,d as iu,f as ou,h as lu,j as Fr,k as cu,l as du,W as uu,m as hu,o as fu,p as mu,q as pu}from"./wagmi-c444efa6.js";import{c as os,b as zl,s as gu,t as xu,d as yu,Q as wu}from"./utils-617af415.js";function bu(s,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in s)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(s,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}var qn={},zi=Vl;qn.createRoot=zi.createRoot,qn.hydrateRoot=zi.hydrateRoot;var qi="popstate";function vu(s={}){function e(r,a){let{pathname:i,search:o,hash:l}=r.location;return Wn("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Ls(a)}return ju(e,t,null,s)}function oe(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Re(s,e){if(!s)try{throw new Error(e)}catch{}}function _u(){return Math.random().toString(36).substring(2,10)}function Wi(s,e){return{usr:s.state,key:s.key,idx:e}}function Wn(s,e,t=null,r){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?ls(e):e,state:t,key:e&&e.key||r||_u()}}function Ls({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function ls(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let r=s.indexOf("?");r>=0&&(e.search=s.substring(r),s=s.substring(0,r)),s&&(e.pathname=s)}return e}function ju(s,e,t,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,l="POP",c=null,d=u();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function u(){return(o.state||{idx:null}).idx}function h(){l="POP";let y=u(),b=y==null?null:y-d;d=y,c&&c({action:l,location:g.location,delta:b})}function f(y,b){l="PUSH";let v=Wn(g.location,y,b);t&&t(v,y),d=u()+1;let x=Wi(v,d),_=g.createHref(v);try{o.pushState(x,"",_)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(_)}i&&c&&c({action:l,location:g.location,delta:1})}function p(y,b){l="REPLACE";let v=Wn(g.location,y,b);t&&t(v,y),d=u();let x=Wi(v,d),_=g.createHref(v);o.replaceState(x,"",_),i&&c&&c({action:l,location:g.location,delta:0})}function w(y){return Nu(y)}let g={get action(){return l},get location(){return s(a,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(qi,h),c=y,()=>{a.removeEventListener(qi,h),c=null}},createHref(y){return e(a,y)},createURL:w,encodeLocation(y){let b=w(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(y){return o.go(y)}};return g}function Nu(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),oe(t,"No window.location.(origin|href) available to create URL");let r=typeof s=="string"?s:Ls(s);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function ql(s,e,t="/"){return Eu(s,e,t,!1)}function Eu(s,e,t,r){let a=typeof e=="string"?ls(e):e,i=rt(a.pathname||"/",t);if(i==null)return null;let o=Wl(s);Su(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=$u(i);l=Lu(o[c],d,r)}return l}function Wl(s,e=[],t=[],r="",a=!1){let i=(o,l,c=a,d)=>{let u={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(r)&&c)return;oe(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length)}let h=st([r,u.relativePath]),f=t.concat(u);o.children&&o.children.length>0&&(oe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Wl(o.children,e,f,h,c)),!(o.path==null&&!o.index)&&e.push({path:h,score:Ru(h,o.index),routesMeta:f})};return s.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))i(o,l);else for(let c of Hl(o.path))i(o,l,!0,c)}),e}function Hl(s){let e=s.split("/");if(e.length===0)return[];let[t,...r]=e,a=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=Hl(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>s.startsWith("/")&&c===""?"/":c)}function Su(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Ou(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var ku=/^:[\w-]+$/,Cu=3,Tu=2,Au=1,Pu=10,Iu=-2,Hi=s=>s==="*";function Ru(s,e){let t=s.split("/"),r=t.length;return t.some(Hi)&&(r+=Iu),e&&(r+=Tu),t.filter(a=>!Hi(a)).reduce((a,i)=>a+(ku.test(i)?Cu:i===""?Au:Pu),r)}function Ou(s,e){return s.length===e.length&&s.slice(0,-1).every((r,a)=>r===e[a])?s[s.length-1]-e[e.length-1]:0}function Lu(s,e,t=!1){let{routesMeta:r}=s,a={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=Mr({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h&&d&&t&&!r[r.length-1].route.index&&(h=Mr({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(a,h.params),o.push({params:a,pathname:st([i,h.pathname]),pathnameBase:Vu(st([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=st([i,h.pathnameBase]))}return o}function Mr(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,r]=Du(s.path,s.caseSensitive,s.end),a=e.match(t);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:r.reduce((d,{paramName:u,isOptional:h},f)=>{if(u==="*"){let w=l[f]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const p=l[f];return h&&!p?d[u]=void 0:d[u]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:s}}function Du(s,e=!1,t=!0){Re(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let r=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(r.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function $u(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Re(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function rt(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=s.charAt(t);return r&&r!=="/"?null:s.slice(t)||"/"}var Uu=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bu=s=>Uu.test(s);function Fu(s,e="/"){let{pathname:t,search:r="",hash:a=""}=typeof s=="string"?ls(s):s,i;if(t)if(Bu(t))i=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Re(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?i=Ki(t.substring(1),"/"):i=Ki(t,e)}else i=e;return{pathname:i,search:zu(r),hash:qu(a)}}function Ki(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function _n(s,e,t,r){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Mu(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Kl(s){let e=Mu(s);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Gl(s,e,t,r=!1){let a;typeof s=="string"?a=ls(s):(a={...s},oe(!a.pathname||!a.pathname.includes("?"),_n("?","pathname","search",a)),oe(!a.pathname||!a.pathname.includes("#"),_n("#","pathname","hash",a)),oe(!a.search||!a.search.includes("#"),_n("#","search","hash",a)));let i=s===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=Fu(a,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}var st=s=>s.join("/").replace(/\/\/+/g,"/"),Vu=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),zu=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,qu=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function Wu(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Zl=["POST","PUT","PATCH","DELETE"];new Set(Zl);var Hu=["GET",...Zl];new Set(Hu);var cs=m.createContext(null);cs.displayName="DataRouter";var an=m.createContext(null);an.displayName="DataRouterState";m.createContext(!1);var Jl=m.createContext({isTransitioning:!1});Jl.displayName="ViewTransition";var Ku=m.createContext(new Map);Ku.displayName="Fetchers";var Gu=m.createContext(null);Gu.displayName="Await";var Je=m.createContext(null);Je.displayName="Navigation";var Gs=m.createContext(null);Gs.displayName="Location";var Ye=m.createContext({outlet:null,matches:[],isDataRoute:!1});Ye.displayName="Route";var ni=m.createContext(null);ni.displayName="RouteError";function Zu(s,{relative:e}={}){oe(Zs(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=m.useContext(Je),{hash:a,pathname:i,search:o}=Js(s,{relative:e}),l=i;return t!=="/"&&(l=i==="/"?t:st([t,i])),r.createHref({pathname:l,search:o,hash:a})}function Zs(){return m.useContext(Gs)!=null}function Ne(){return oe(Zs(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(Gs).location}var Yl="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ql(s){m.useContext(Je).static||m.useLayoutEffect(s)}function le(){let{isDataRoute:s}=m.useContext(Ye);return s?lh():Ju()}function Ju(){oe(Zs(),"useNavigate() may be used only in the context of a <Router> component.");let s=m.useContext(cs),{basename:e,navigator:t}=m.useContext(Je),{matches:r}=m.useContext(Ye),{pathname:a}=Ne(),i=JSON.stringify(Kl(r)),o=m.useRef(!1);return Ql(()=>{o.current=!0}),m.useCallback((c,d={})=>{if(Re(o.current,Yl),!o.current)return;if(typeof c=="number"){t.go(c);return}let u=Gl(c,JSON.parse(i),a,d.relative==="path");s==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:st([e,u.pathname])),(d.replace?t.replace:t.push)(u,d.state,d)},[e,t,i,a,s])}m.createContext(null);function ds(){let{matches:s}=m.useContext(Ye),e=s[s.length-1];return e?e.params:{}}function Js(s,{relative:e}={}){let{matches:t}=m.useContext(Ye),{pathname:r}=Ne(),a=JSON.stringify(Kl(t));return m.useMemo(()=>Gl(s,JSON.parse(a),r,e==="path"),[s,a,r,e])}function Yu(s,e){return Xl(s,e)}function Xl(s,e,t,r,a){oe(Zs(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=m.useContext(Je),{matches:o}=m.useContext(Ye),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",u=l?l.pathnameBase:"/",h=l&&l.route;{let v=h&&h.path||"";ec(d,!h||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let f=Ne(),p;if(e){let v=typeof e=="string"?ls(e):e;oe(u==="/"||v.pathname?.startsWith(u),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${v.pathname}" was given in the \`location\` prop.`),p=v}else p=f;let w=p.pathname||"/",g=w;if(u!=="/"){let v=u.replace(/^\//,"").split("/");g="/"+w.replace(/^\//,"").split("/").slice(v.length).join("/")}let y=ql(s,{pathname:g});Re(h||y!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Re(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=sh(y&&y.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:st([u,i.encodeLocation?i.encodeLocation(v.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:st([u,i.encodeLocation?i.encodeLocation(v.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathnameBase])})),o,t,r,a);return e&&b?m.createElement(Gs.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},b):b}function Qu(){let s=oh(),e=Wu(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return o=m.createElement(m.Fragment,null,m.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:i},"ErrorBoundary")," or"," ",m.createElement("code",{style:i},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),t?m.createElement("pre",{style:a},t):null,o)}var Xu=m.createElement(Qu,null),eh=class extends m.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError&&this.props.onError(s,e)}render(){return this.state.error!==void 0?m.createElement(Ye.Provider,{value:this.props.routeContext},m.createElement(ni.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function th({routeContext:s,match:e,children:t}){let r=m.useContext(cs);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),m.createElement(Ye.Provider,{value:s},t)}function sh(s,e=[],t=null,r=null,a=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let i=s,o=t?.errors;if(o!=null){let u=i.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);oe(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(t)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:f,errors:p}=t,w=h.route.loader&&!f.hasOwnProperty(h.route.id)&&(!p||p[h.route.id]===void 0);if(h.route.lazy||w){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let d=t&&r?(u,h)=>{r(u,{location:t.location,params:t.matches?.[0]?.params??{},errorInfo:h})}:void 0;return i.reduceRight((u,h,f)=>{let p,w=!1,g=null,y=null;t&&(p=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||Xu,l&&(c<0&&f===0?(ec("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,y=null):c===f&&(w=!0,y=h.route.hydrateFallbackElement||null)));let b=e.concat(i.slice(0,f+1)),v=()=>{let x;return p?x=g:w?x=y:h.route.Component?x=m.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,m.createElement(th,{match:h,routeContext:{outlet:u,matches:b,isDataRoute:t!=null},children:x})};return t&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?m.createElement(eh,{location:t.location,revalidation:t.revalidation,component:g,error:p,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0},onError:d}):v()},null)}function ai(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rh(s){let e=m.useContext(cs);return oe(e,ai(s)),e}function nh(s){let e=m.useContext(an);return oe(e,ai(s)),e}function ah(s){let e=m.useContext(Ye);return oe(e,ai(s)),e}function ii(s){let e=ah(s),t=e.matches[e.matches.length-1];return oe(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function ih(){return ii("useRouteId")}function oh(){let s=m.useContext(ni),e=nh("useRouteError"),t=ii("useRouteError");return s!==void 0?s:e.errors?.[t]}function lh(){let{router:s}=rh("useNavigate"),e=ii("useNavigate"),t=m.useRef(!1);return Ql(()=>{t.current=!0}),m.useCallback(async(a,i={})=>{Re(t.current,Yl),t.current&&(typeof a=="number"?s.navigate(a):await s.navigate(a,{fromRouteId:e,...i}))},[s,e])}var Gi={};function ec(s,e,t){!e&&!Gi[s]&&(Gi[s]=!0,Re(!1,t))}m.memo(ch);function ch({routes:s,future:e,state:t,unstable_onError:r}){return Xl(s,void 0,t,r,e)}function L(s){oe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dh({basename:s="/",children:e=null,location:t,navigationType:r="POP",navigator:a,static:i=!1}){oe(!Zs(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=s.replace(/^\/*/,"/"),l=m.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof t=="string"&&(t=ls(t));let{pathname:c="/",search:d="",hash:u="",state:h=null,key:f="default"}=t,p=m.useMemo(()=>{let w=rt(c,o);return w==null?null:{location:{pathname:w,search:d,hash:u,state:h,key:f},navigationType:r}},[o,c,d,u,h,f,r]);return Re(p!=null,`<Router basename="${o}"> is not able to match the URL "${c}${d}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:m.createElement(Je.Provider,{value:l},m.createElement(Gs.Provider,{children:e,value:p}))}function Vr({children:s,location:e}){return Yu(Hn(s),e)}function Hn(s,e=[]){let t=[];return m.Children.forEach(s,(r,a)=>{if(!m.isValidElement(r))return;let i=[...e,a];if(r.type===m.Fragment){t.push.apply(t,Hn(r.props.children,i));return}oe(r.type===L,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),oe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Hn(r.props.children,i)),t.push(o)}),t}var Cr="get",Tr="application/x-www-form-urlencoded";function on(s){return s!=null&&typeof s.tagName=="string"}function uh(s){return on(s)&&s.tagName.toLowerCase()==="button"}function hh(s){return on(s)&&s.tagName.toLowerCase()==="form"}function fh(s){return on(s)&&s.tagName.toLowerCase()==="input"}function mh(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function ph(s,e){return s.button===0&&(!e||e==="_self")&&!mh(s)}function Kn(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let r=s[t];return e.concat(Array.isArray(r)?r.map(a=>[t,a]):[[t,r]])},[]))}function gh(s,e){let t=Kn(s);return e&&e.forEach((r,a)=>{t.has(a)||e.getAll(a).forEach(i=>{t.append(a,i)})}),t}var ir=null;function xh(){if(ir===null)try{new FormData(document.createElement("form"),0),ir=!1}catch{ir=!0}return ir}var yh=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jn(s){return s!=null&&!yh.has(s)?(Re(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Tr}"`),null):s}function wh(s,e){let t,r,a,i,o;if(hh(s)){let l=s.getAttribute("action");r=l?rt(l,e):null,t=s.getAttribute("method")||Cr,a=jn(s.getAttribute("enctype"))||Tr,i=new FormData(s)}else if(uh(s)||fh(s)&&(s.type==="submit"||s.type==="image")){let l=s.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=s.getAttribute("formaction")||l.getAttribute("action");if(r=c?rt(c,e):null,t=s.getAttribute("formmethod")||l.getAttribute("method")||Cr,a=jn(s.getAttribute("formenctype"))||jn(l.getAttribute("enctype"))||Tr,i=new FormData(l,s),!xh()){let{name:d,type:u,value:h}=s;if(u==="image"){let f=d?`${d}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else d&&i.append(d,h)}}else{if(on(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Cr,r=null,a=Tr,o=s}return i&&a==="text/plain"&&(o=i,i=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function oi(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function bh(s,e,t){let r=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&rt(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function vh(s,e){if(s.id in e)return e[s.id];try{let t=await H(()=>import(s.module),[]);return e[s.id]=t,t}catch{return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _h(s){return s!=null&&typeof s.page=="string"}function jh(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function Nh(s,e,t){let r=await Promise.all(s.map(async a=>{let i=e.routes[a.route.id];if(i){let o=await vh(i,t);return o.links?o.links():[]}return[]}));return Ch(r.flat(1).filter(jh).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Zi(s,e,t,r,a,i){let o=(c,d)=>t[d]?c.route.id!==t[d].route.id:!0,l=(c,d)=>t[d].pathname!==c.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==c.params["*"];return i==="assets"?e.filter((c,d)=>o(c,d)||l(c,d)):i==="data"?e.filter((c,d)=>{let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,d)||l(c,d))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function Eh(s,e,{includeHydrateFallback:t}={}){return Sh(s.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function Sh(s){return[...new Set(s)]}function kh(s){let e={},t=Object.keys(s).sort();for(let r of t)e[r]=s[r];return e}function Ch(s,e){let t=new Set,r=new Set(e);return s.reduce((a,i)=>{if(e&&!_h(i)&&i.as==="script"&&i.href&&r.has(i.href))return a;let l=JSON.stringify(kh(i));return t.has(l)||(t.add(l),a.push({key:l,link:i})),a},[])}function tc(){let s=m.useContext(cs);return oi(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function Th(){let s=m.useContext(an);return oi(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var li=m.createContext(void 0);li.displayName="FrameworkContext";function sc(){let s=m.useContext(li);return oi(s,"You must render this element inside a <HydratedRouter> element"),s}function Ah(s,e){let t=m.useContext(li),[r,a]=m.useState(!1),[i,o]=m.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=e,f=m.useRef(null);m.useEffect(()=>{if(s==="render"&&o(!0),s==="viewport"){let g=b=>{b.forEach(v=>{o(v.isIntersecting)})},y=new IntersectionObserver(g,{threshold:.5});return f.current&&y.observe(f.current),()=>{y.disconnect()}}},[s]),m.useEffect(()=>{if(r){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[r]);let p=()=>{a(!0)},w=()=>{a(!1),o(!1)};return t?s!=="intent"?[i,f,{}]:[i,f,{onFocus:xs(l,p),onBlur:xs(c,w),onMouseEnter:xs(d,p),onMouseLeave:xs(u,w),onTouchStart:xs(h,p)}]:[!1,f,{}]}function xs(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function Ph({page:s,...e}){let{router:t}=tc(),r=m.useMemo(()=>ql(t.routes,s,t.basename),[t.routes,s,t.basename]);return r?m.createElement(Rh,{page:s,matches:r,...e}):null}function Ih(s){let{manifest:e,routeModules:t}=sc(),[r,a]=m.useState([]);return m.useEffect(()=>{let i=!1;return Nh(s,e,t).then(o=>{i||a(o)}),()=>{i=!0}},[s,e,t]),r}function Rh({page:s,matches:e,...t}){let r=Ne(),{manifest:a,routeModules:i}=sc(),{basename:o}=tc(),{loaderData:l,matches:c}=Th(),d=m.useMemo(()=>Zi(s,e,c,a,r,"data"),[s,e,c,a,r]),u=m.useMemo(()=>Zi(s,e,c,a,r,"assets"),[s,e,c,a,r]),h=m.useMemo(()=>{if(s===r.pathname+r.search+r.hash)return[];let w=new Set,g=!1;if(e.forEach(b=>{let v=a.routes[b.route.id];!v||!v.hasLoader||(!d.some(x=>x.route.id===b.route.id)&&b.route.id in l&&i[b.route.id]?.shouldRevalidate||v.hasClientLoader?g=!0:w.add(b.route.id))}),w.size===0)return[];let y=bh(s,o,"data");return g&&w.size>0&&y.searchParams.set("_routes",e.filter(b=>w.has(b.route.id)).map(b=>b.route.id).join(",")),[y.pathname+y.search]},[o,l,r,a,d,e,s,i]),f=m.useMemo(()=>Eh(u,a),[u,a]),p=Ih(u);return m.createElement(m.Fragment,null,h.map(w=>m.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),f.map(w=>m.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),p.map(({key:w,link:g})=>m.createElement("link",{key:w,nonce:t.nonce,...g})))}function Oh(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var rc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rc&&(window.__reactRouterVersion="7.9.6")}catch{}function Ji({basename:s,children:e,window:t}){let r=m.useRef();r.current==null&&(r.current=vu({window:t,v5Compat:!0}));let a=r.current,[i,o]=m.useState({action:a.action,location:a.location}),l=m.useCallback(c=>{m.startTransition(()=>o(c))},[o]);return m.useLayoutEffect(()=>a.listen(l),[a,l]),m.createElement(dh,{basename:s,children:e,location:i.location,navigationType:i.action,navigator:a})}var nc=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zr=m.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:a,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h,...f},p){let{basename:w}=m.useContext(Je),g=typeof d=="string"&&nc.test(d),y,b=!1;if(typeof d=="string"&&g&&(y=d,rc))try{let N=new URL(window.location.href),C=d.startsWith("//")?new URL(N.protocol+d):new URL(d),O=rt(C.pathname,w);C.origin===N.origin&&O!=null?d=O+C.search+C.hash:b=!0}catch{Re(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=Zu(d,{relative:a}),[x,_,j]=Ah(r,f),S=$h(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:h});function E(N){e&&e(N),N.defaultPrevented||S(N)}let T=m.createElement("a",{...f,...j,href:y||v,onClick:b||i?e:E,ref:Oh(p,_),target:c,"data-discover":!g&&t==="render"?"true":void 0});return x&&!g?m.createElement(m.Fragment,null,T,m.createElement(Ph,{page:v})):T});zr.displayName="Link";var ac=m.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:a=!1,style:i,to:o,viewTransition:l,children:c,...d},u){let h=Js(o,{relative:d.relative}),f=Ne(),p=m.useContext(an),{navigator:w,basename:g}=m.useContext(Je),y=p!=null&&Vh(h)&&l===!0,b=w.encodeLocation?w.encodeLocation(h).pathname:h.pathname,v=f.pathname,x=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(v=v.toLowerCase(),x=x?x.toLowerCase():null,b=b.toLowerCase()),x&&g&&(x=rt(x,g)||x);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let j=v===b||!a&&v.startsWith(b)&&v.charAt(_)==="/",S=x!=null&&(x===b||!a&&x.startsWith(b)&&x.charAt(b.length)==="/"),E={isActive:j,isPending:S,isTransitioning:y},T=j?e:void 0,N;typeof r=="function"?N=r(E):N=[r,j?"active":null,S?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(E):i;return m.createElement(zr,{...d,"aria-current":T,className:N,ref:u,style:C,to:o,viewTransition:l},typeof c=="function"?c(E):c)});ac.displayName="NavLink";var Lh=m.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:a,state:i,method:o=Cr,action:l,onSubmit:c,relative:d,preventScrollReset:u,viewTransition:h,...f},p)=>{let w=Fh(),g=Mh(l,{relative:d}),y=o.toLowerCase()==="get"?"get":"post",b=typeof l=="string"&&nc.test(l),v=x=>{if(c&&c(x),x.defaultPrevented)return;x.preventDefault();let _=x.nativeEvent.submitter,j=_?.getAttribute("formmethod")||o;w(_||x.currentTarget,{fetcherKey:e,method:j,navigate:t,replace:a,state:i,relative:d,preventScrollReset:u,viewTransition:h})};return m.createElement("form",{ref:p,method:y,action:g,onSubmit:r?c:v,...f,"data-discover":!b&&s==="render"?"true":void 0})});Lh.displayName="Form";function Dh(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ic(s){let e=m.useContext(cs);return oe(e,Dh(s)),e}function $h(s,{target:e,replace:t,state:r,preventScrollReset:a,relative:i,viewTransition:o}={}){let l=le(),c=Ne(),d=Js(s,{relative:i});return m.useCallback(u=>{if(ph(u,e)){u.preventDefault();let h=t!==void 0?t:Ls(c)===Ls(d);l(s,{replace:h,state:r,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,d,t,r,e,s,a,i,o])}function zv(s){Re(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=m.useRef(Kn(s)),t=m.useRef(!1),r=Ne(),a=m.useMemo(()=>gh(r.search,t.current?null:e.current),[r.search]),i=le(),o=m.useCallback((l,c)=>{const d=Kn(typeof l=="function"?l(new URLSearchParams(a)):l);t.current=!0,i("?"+d,c)},[i,a]);return[a,o]}var Uh=0,Bh=()=>`__${String(++Uh)}__`;function Fh(){let{router:s}=ic("useSubmit"),{basename:e}=m.useContext(Je),t=ih();return m.useCallback(async(r,a={})=>{let{action:i,method:o,encType:l,formData:c,body:d}=wh(r,e);if(a.navigate===!1){let u=a.fetcherKey||Bh();await s.fetch(u,t,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:d,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await s.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:d,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[s,e,t])}function Mh(s,{relative:e}={}){let{basename:t}=m.useContext(Je),r=m.useContext(Ye);oe(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...Js(s||".",{relative:e})},o=Ne();if(s==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let u=l.toString();i.search=u?`?${u}`:""}}return(!s||s===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:st([t,i.pathname])),Ls(i)}function Vh(s,{relative:e}={}){let t=m.useContext(Jl);oe(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=ic("useViewTransitionState"),a=Js(s,{relative:e});if(!t.isTransitioning)return!1;let i=rt(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=rt(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Mr(a.pathname,o)!=null||Mr(a.pathname,i)!=null}const zh=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class ci extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class qh extends ci{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yi extends ci{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Qi extends ci{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Gn;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Gn||(Gn={}));class Wh{constructor(e,{headers:t={},customFetch:r,region:a=Gn.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=zh(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return I(this,arguments,void 0,function*(t,r={}){var a;let i,o;try{const{headers:l,method:c,body:d,signal:u,timeout:h}=r;let f={},{region:p}=r;p||(p=this.region);const w=new URL(`${this.url}/${t}`);p&&p!=="any"&&(f["x-region"]=p,w.searchParams.set("forceFunctionRegion",p));let g;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",g=d):typeof d=="string"?(f["Content-Type"]="text/plain",g=d):typeof FormData<"u"&&d instanceof FormData?g=d:(f["Content-Type"]="application/json",g=JSON.stringify(d)):g=d;let y=u;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),u?(y=o.signal,u.addEventListener("abort",()=>o.abort())):y=o.signal);const b=yield this.fetch(w.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:g,signal:y}).catch(j=>{throw new qh(j)}),v=b.headers.get("x-relay-error");if(v&&v==="true")throw new Yi(b);if(!b.ok)throw new Qi(b);let x=((a=b.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),_;return x==="application/json"?_=yield b.json():x==="application/octet-stream"||x==="application/pdf"?_=yield b.blob():x==="text/event-stream"?_=b:x==="multipart/form-data"?_=yield b.formData():_=yield b.text(),{data:_,error:null,response:b}}catch(l){return{data:null,error:l,response:l instanceof Qi||l instanceof Yi?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var be={};const us=su(Xd);var or={},lr={},cr={},dr={},ur={},hr={},Xi;function oc(){if(Xi)return hr;Xi=1,Object.defineProperty(hr,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return hr.default=s,hr}var eo;function lc(){if(eo)return ur;eo=1,Object.defineProperty(ur,"__esModule",{value:!0});const e=us.__importDefault(oc());class t{constructor(a){var i,o;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(i=a.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=a.signal,this.isMaybeSingle=(o=a.isMaybeSingle)!==null&&o!==void 0?o:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=new Headers(this.headers),this.headers.set(a,i),this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,h,f;let p=null,w=null,g=null,y=c.status,b=c.statusText;if(c.ok){if(this.method!=="HEAD"){const j=await c.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?w=j:w=JSON.parse(j))}const x=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),_=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&_&&_.length>1&&(g=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(p={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,g=null,y=406,b="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const x=await c.text();try{p=JSON.parse(x),Array.isArray(p)&&c.status===404&&(w=[],p=null,y=200,b="OK")}catch{c.status===404&&x===""?(y=204,b="No Content"):p={message:x}}if(p&&this.isMaybeSingle&&(!((f=p?.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,y=200,b="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:w,count:g,status:y,statusText:b}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,h,f,p,w;let g="";const y=c?.cause;if(y){const b=(d=y?.message)!==null&&d!==void 0?d:"",v=(u=y?.code)!==null&&u!==void 0?u:"";g=`${(h=c?.name)!==null&&h!==void 0?h:"FetchError"}: ${c?.message}`,g+=`

Caused by: ${(f=y?.name)!==null&&f!==void 0?f:"Error"}: ${b}`,v&&(g+=` (${v})`),y?.stack&&(g+=`
${y.stack}`)}else g=(p=c?.stack)!==null&&p!==void 0?p:"";return{error:{message:`${(w=c?.name)!==null&&w!==void 0?w:"FetchError"}: ${c?.message}`,details:g,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}}return ur.default=t,ur}var to;function cc(){if(to)return dr;to=1,Object.defineProperty(dr,"__esModule",{value:!0});const e=us.__importDefault(lc());class t extends e.default{select(a){let i=!1;const o=(a??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:i=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${a}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${a}`),this}range(a,i,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this.url.searchParams.set(d,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:i=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const h=[a?"analyze":null,i?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${f}"; options=${h};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return dr.default=t,dr}var so;function di(){if(so)return cr;so=1,Object.defineProperty(cr,"__esModule",{value:!0});const e=us.__importDefault(cc()),t=new RegExp("[,()]");class r extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}regexMatch(i,o){return this.url.searchParams.append(i,`match.${o}`),this}regexIMatch(i,o){return this.url.searchParams.append(i,`imatch.${o}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}isDistinct(i,o){return this.url.searchParams.append(i,`isdistinct.${o}`),this}in(i,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${d}fts${u}.${o}`),this}match(i){return Object.entries(i).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(i,o,l){return this.url.searchParams.append(i,`not.${o}.${l}`),this}or(i,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,o,l){return this.url.searchParams.append(i,`${o}.${l}`),this}}return cr.default=r,cr}var ro;function dc(){if(ro)return lr;ro=1,Object.defineProperty(lr,"__esModule",{value:!0});const e=us.__importDefault(di());class t{constructor(a,{headers:i={},schema:o,fetch:l}){this.url=a,this.headers=new Headers(i),this.schema=o,this.fetch=l}select(a,i){const{head:o=!1,count:l}=i??{},c=o?"HEAD":"GET";let d=!1;const u=(a??"*").split("").map(h=>/\s/.test(h)&&!d?"":(h==='"'&&(d=!d),h)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:i,defaultToNull:o=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const d=a.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(d.length>0){const u=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(a,{onConflict:i,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(a,{count:i}={}){var o;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:a}={}){var i;const o="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return lr.default=t,lr}var no;function Hh(){if(no)return or;no=1,Object.defineProperty(or,"__esModule",{value:!0});const s=us,e=s.__importDefault(dc()),t=s.__importDefault(di());class r{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new r(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:d}={}){var u;let h;const f=new URL(`${this.url}/rpc/${i}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{f.searchParams.append(g,y)})):(h="POST",p=o);const w=new Headers(this.headers);return d&&w.set("Prefer",`count=${d}`),new t.default({method:h,url:f,headers:w,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return or.default=r,or}Object.defineProperty(be,"__esModule",{value:!0});var uc=be.PostgrestError=vc=be.PostgrestBuilder=wc=be.PostgrestTransformBuilder=xc=be.PostgrestFilterBuilder=pc=be.PostgrestQueryBuilder=fc=be.PostgrestClient=void 0;const hs=us,hc=hs.__importDefault(Hh());var fc=be.PostgrestClient=hc.default;const mc=hs.__importDefault(dc());var pc=be.PostgrestQueryBuilder=mc.default;const gc=hs.__importDefault(di());var xc=be.PostgrestFilterBuilder=gc.default;const yc=hs.__importDefault(cc());var wc=be.PostgrestTransformBuilder=yc.default;const bc=hs.__importDefault(lc());var vc=be.PostgrestBuilder=bc.default;const _c=hs.__importDefault(oc());uc=be.PostgrestError=_c.default;var jc=be.default={PostgrestClient:hc.default,PostgrestQueryBuilder:mc.default,PostgrestFilterBuilder:gc.default,PostgrestTransformBuilder:yc.default,PostgrestBuilder:bc.default,PostgrestError:_c.default};const Kh=bu({__proto__:null,get PostgrestBuilder(){return vc},get PostgrestClient(){return fc},get PostgrestError(){return uc},get PostgrestFilterBuilder(){return xc},get PostgrestQueryBuilder(){return pc},get PostgrestTransformBuilder(){return wc},default:jc},[be]),{PostgrestClient:Gh,PostgrestQueryBuilder:qv,PostgrestFilterBuilder:Wv,PostgrestTransformBuilder:Hv,PostgrestBuilder:Kv,PostgrestError:Gv}=jc||Kh;class Zh{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Jh="2.86.0",Yh=`realtime-js/${Jh}`,Nc="1.0.0",Qh="2.0.0",ao=Nc,Zn=1e4,Xh=1e3,ef=100;var Tt;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Tt||(Tt={}));var me;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(me||(me={}));var $e;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})($e||($e={}));var Jn;(function(s){s.websocket="websocket"})(Jn||(Jn={}));var At;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(At||(At={}));class tf{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const a=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,r;const a=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,r){var a,i;const o=e.topic,l=(a=e.ref)!==null&&a!==void 0?a:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",d=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+d.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let w=new DataView(p),g=0;w.setUint8(g++,this.KINDS.userBroadcastPush),w.setUint8(g++,c.length),w.setUint8(g++,l.length),w.setUint8(g++,o.length),w.setUint8(g++,d.length),w.setUint8(g++,h.length),w.setUint8(g++,t),Array.from(c,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(l,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(o,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(d,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(h,b=>w.setUint8(g++,b.charCodeAt(0)));var y=new Uint8Array(p.byteLength+r.byteLength);return y.set(new Uint8Array(p),0),y.set(new Uint8Array(r),p.byteLength),y.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[a,i,o,l,c]=r;return t({join_ref:a,ref:i,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),a=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,r){const a=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+a));c=c+a;const u=r.decode(e.slice(c,c+i));c=c+i;const h=r.decode(e.slice(c,c+o));c=c+o;const f=e.slice(c,e.byteLength),p=l===this.JSON_ENCODING?JSON.parse(r.decode(f)):f,w={type:this.BROADCAST_EVENT,event:u,payload:p};return o>0&&(w.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>t.includes(r)))}}class Ec{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var se;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(se||(se={}));const io=(s,e,t={})=>{var r;const a=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=sf(o,s,e,a),i),{}):{}},sf=(s,e,t,r)=>{const a=e.find(l=>l.name===s),i=a?.type,o=t[s];return i&&!r.includes(i)?Sc(i,o):Yn(o)},Sc=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return of(e,t)}switch(s){case se.bool:return rf(e);case se.float4:case se.float8:case se.int2:case se.int4:case se.int8:case se.numeric:case se.oid:return nf(e);case se.json:case se.jsonb:return af(e);case se.timestamp:return lf(e);case se.abstime:case se.date:case se.daterange:case se.int4range:case se.int8range:case se.money:case se.reltime:case se.text:case se.time:case se.timestamptz:case se.timetz:case se.tsrange:case se.tstzrange:return Yn(e);default:return Yn(e)}},Yn=s=>s,rf=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},nf=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},af=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},of=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let i;const o=s.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Sc(e,l))}return s},lf=s=>typeof s=="string"?s.replace(" ","T"):s,kc=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Nn{constructor(e,t,r={},a=Zn){this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var oo;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(oo||(oo={}));class Ps{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ps.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=Ps.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Ps.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=i[d];if(h){const f=u.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),w=u.filter(y=>p.indexOf(y.presence_ref)<0),g=h.filter(y=>f.indexOf(y.presence_ref)<0);w.length>0&&(l[d]=w),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},r,a)}static syncDiff(e,t,r,a){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...f)}r(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,a(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const a=e[r];return"metas"in a?t[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var lo;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(lo||(lo={}));var Is;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Is||(Is={}));var Xe;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Xe||(Xe={}));class ui{constructor(e,t={config:{}},r){var a,i;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Nn(this,$e.join,this.params,this.timeout),this.rejoinTimer=new Ec(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=me.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this._on($e.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Ps(this),this.broadcastEndpointURL=kc(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==me.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Is.PRESENCE]&&this.bindings[Is.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e?.(Xe.CHANNEL_ERROR,p)),this._onClose(()=>e?.(Xe.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var w;if(this.socket.setAuth(),p===void 0){e?.(Xe.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(w=g?.length)!==null&&w!==void 0?w:0,b=[];for(let v=0;v<y;v++){const x=g[v],{filter:{event:_,schema:j,table:S,filter:E}}=x,T=p&&p[v];if(T&&T.event===_&&T.schema===j&&T.table===S&&T.filter===E)b.push(Object.assign(Object.assign({},x),{id:T.id}));else{this.unsubscribe(),this.state=me.errored,e?.(Xe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(Xe.SUBSCRIBED);return}}).receive("error",p=>{this.state=me.errored,e?.(Xe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e?.(Xe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===me.joined&&e===Is.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var a;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=me.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($e.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Nn(this,$e.leave,{},e),r.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=me.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Nn(this,e,t,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ef){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=$e;if(r&&[l,c,d,u].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var w,g,y;return((w=p.filter)===null||w===void 0?void 0:w.event)==="*"||((y=(g=p.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(f,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var w,g,y,b,v,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const _=p.id,j=(w=p.filter)===null||w===void 0?void 0:w.event;return _&&((g=t.ids)===null||g===void 0?void 0:g.includes(_))&&(j==="*"||j?.toLocaleLowerCase()===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(v=(b=p?.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return _==="*"||_===((x=t?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const w=f.data,{schema:g,table:y,commit_timestamp:b,type:v,errors:x}=w;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:b,eventType:v,new:{},old:{},errors:x}),this._getPayloadRecords(w))}p.callback(f,r)})}_isClosed(){return this.state===me.closed}_isJoined(){return this.state===me.joined}_isJoining(){return this.state===me.joining}_isLeaving(){return this.state===me.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const a=e.toLocaleLowerCase(),i={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ui.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($e.close,{},e)}_onError(e){this._on($e.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=me.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=io(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=io(e.columns,e.old_record)),t}}const En=()=>{},fr={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},cf=[1e3,2e3,5e3,1e4],df=1e4,uf=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hf{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zn,this.transport=null,this.heartbeatIntervalMs=fr.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=En,this.ref=0,this.reconnectTimer=null,this.vsn=ao,this.logger=En,this.conn=null,this.sendBuffer=[],this.serializer=new tf,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Jn.websocket}`,this.httpEndpoint=kc(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Zh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Tt.connecting:return At.Connecting;case Tt.open:return At.Open;case Tt.closing:return At.Closing;default:return At.Closed}}isConnected(){return this.connectionState()===At.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new ui(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Xh,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},fr.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:a,payload:i,ref:o}=t,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(a,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Tt.open||this.conn.readyState===Tt.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger($e.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${r}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([uf],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const a={access_token:t,version:Yh};t&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push($e.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Ec(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},fr.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,a,i,o,l,c,d,u,h,f,p;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:Zn,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:fr.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:En,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:ao,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:w=>cf[w-1]||df,this.vsn){case Nc:this.encode=(u=e?.encode)!==null&&u!==void 0?u:(w,g)=>g(JSON.stringify(w)),this.decode=(h=e?.decode)!==null&&h!==void 0?h:(w,g)=>g(JSON.parse(w));break;case Qh:this.encode=(f=e?.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class ln extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ie(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class ff extends ln{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qn extends ln{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const hi=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),mf=()=>Response,Xn=s=>{if(Array.isArray(s))return s.map(t=>Xn(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const a=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Xn(r)}),e},pf=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},gf=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s),Sn=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},xf=(s,e,t)=>I(void 0,void 0,void 0,function*(){const r=yield mf();s instanceof r&&!t?.noResolveJson?s.json().then(a=>{const i=s.status||500,o=a?.statusCode||i+"";e(new ff(Sn(a),i,o))}).catch(a=>{e(new Qn(Sn(a),a))}):e(new Qn(Sn(s),s))}),yf=(s,e,t,r)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"||!r?a:(pf(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(r)):a.body=r,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function Ys(s,e,t,r,a,i){return I(this,void 0,void 0,function*(){return new Promise((o,l)=>{s(t,yf(e,r,a,i)).then(c=>{if(!c.ok)throw c;return r?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>xf(c,l,r))})})}function Ds(s,e,t,r){return I(this,void 0,void 0,function*(){return Ys(s,"GET",e,t,r)})}function De(s,e,t,r,a){return I(this,void 0,void 0,function*(){return Ys(s,"POST",e,r,a,t)})}function ea(s,e,t,r,a){return I(this,void 0,void 0,function*(){return Ys(s,"PUT",e,r,a,t)})}function wf(s,e,t,r){return I(this,void 0,void 0,function*(){return Ys(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function fi(s,e,t,r,a){return I(this,void 0,void 0,function*(){return Ys(s,"DELETE",e,r,a,t)})}class bf{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return I(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}}var Cc;class vf{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Cc]="BlobDownloadBuilder",this.promise=null}asStream(){return new bf(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return I(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}}Cc=Symbol.toStringTag;const _f=vf,jf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},co={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Nf{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=hi(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,a){return I(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},co),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),a?.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?ea:De)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ie(i))return{data:null,error:i};throw i}})}upload(e,t,r){return I(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,a){return I(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:co.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield ea(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(ie(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return I(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const i=yield De(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new ln("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ie(r))return{data:null,error:r};throw r}})}update(e,t,r){return I(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return I(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}copy(e,t,r){return I(this,void 0,void 0,function*(){try{return{data:{path:(yield De(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,r){return I(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield De(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,r){return I(this,void 0,void 0,function*(){try{const a=yield De(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}download(e,t){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),o=i?`?${i}`:"",l=this._getFinalPath(e),c=()=>Ds(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new _f(c,this.shouldThrowOnError)}info(e){return I(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Ds(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Xn(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ie(r))return{data:null,error:r};throw r}})}exists(e){return I(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield wf(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ie(r)&&r instanceof Qn){const a=r.originalError;if([400,404].includes(a?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&a.push(i);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return I(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}list(e,t,r){return I(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},jf),t),{prefix:e||""});return{data:yield De(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}listV2(e,t){return I(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield De(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ie(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Tc="2.86.0",Ac={"X-Client-Info":`storage-js/${Tc}`};class Ef{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const i=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ac),t),this.fetch=hi(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return I(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield Ds(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}getBucket(e){return I(this,void 0,void 0,function*(){try{return{data:yield Ds(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}createBucket(e){return I(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield De(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}updateBucket(e,t){return I(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ie(r))return{data:null,error:r};throw r}})}emptyBucket(e){return I(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}deleteBucket(e){return I(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var $s=class extends Error{constructor(s,e){super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Sf(s,e,t){const r=new URL(e,s);if(t)for(const[a,i]of Object.entries(t))i!==void 0&&r.searchParams.set(a,i);return r.toString()}async function kf(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function Cf(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:t,path:r,query:a,body:i,headers:o}){const l=Sf(s.baseUrl,r,a),c=await kf(s.auth),d=await e(l,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),u=await d.text(),h=(d.headers.get("content-type")||"").includes("application/json"),f=h&&u?JSON.parse(u):u;if(!d.ok){const p=h?f:void 0,w=p?.error;throw new $s(w?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:w?.type,icebergCode:w?.code,details:p})}return{status:d.status,headers:d.headers,data:f}}}}function mr(s){return s.join("")}var Tf=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:mr(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(s,e){const t={namespace:s.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mr(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mr(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mr(s.namespace)}`}),!0}catch(e){if(e instanceof $s&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(t){if(t instanceof $s&&t.status===409)return;throw t}}};function Ft(s){return s.join("")}var Af=class{constructor(s,e="",t){this.client=s,this.prefix=e,this.accessDelegation=t}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ft(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ft(s.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(s,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ft(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ft(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ft(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ft(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(t){if(t instanceof $s&&t.status===404)return!1;throw t}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(t){if(t instanceof $s&&t.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw t}}},Pf=class{constructor(s){let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const t=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=Cf({baseUrl:t,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=s.accessDelegation?.join(","),this.namespaceOps=new Tf(this.client,e),this.tableOps=new Af(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}};class If{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ac),t),this.fetch=hi(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return I(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}listBuckets(e){return I(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const r=t.toString(),a=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield Ds(this.fetch,a,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}deleteBucket(e){return I(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}from(e){if(!gf(e))throw new ln("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new Pf({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>I(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const mi={"X-Client-Info":`storage-js/${Tc}`,"Content-Type":"application/json"};class Pc extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Se(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}class kn extends Pc{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rf extends Pc{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var uo;(function(s){s.InternalError="InternalError",s.S3VectorConflictException="S3VectorConflictException",s.S3VectorNotFoundException="S3VectorNotFoundException",s.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",s.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",s.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(uo||(uo={}));const pi=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Of=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},ho=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Lf=(s,e,t)=>I(void 0,void 0,void 0,function*(){if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!t?.noResolveJson){const a=s.status||500,i=s;if(typeof i.json=="function")i.json().then(o=>{const l=o?.statusCode||o?.code||a+"";e(new kn(ho(o),a,l))}).catch(()=>{const o=a+"",l=i.statusText||`HTTP ${a} error`;e(new kn(l,a,o))});else{const o=a+"",l=i.statusText||`HTTP ${a} error`;e(new kn(l,a,o))}}else e(new Rf(ho(s),s))}),Df=(s,e,t,r)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"||!r?a:(Of(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(r)):a.body=r,Object.assign(Object.assign({},a),t))};function $f(s,e,t,r,a,i){return I(this,void 0,void 0,function*(){return new Promise((o,l)=>{s(t,Df(e,r,a,i)).then(c=>{if(!c.ok)throw c;if(r?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>Lf(c,l,r))})})}function ke(s,e,t,r,a){return I(this,void 0,void 0,function*(){return $f(s,"POST",e,r,a,t)})}class Uf{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mi),t),this.fetch=pi(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return I(this,void 0,void 0,function*(){try{return{data:(yield ke(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}getIndex(e,t){return I(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}})}listIndexes(e){return I(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return I(this,void 0,void 0,function*(){try{return{data:(yield ke(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}})}}class Bf{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mi),t),this.fetch=pi(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return I(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ke(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}getVectors(e){return I(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}listVectors(e){return I(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield ke(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}queryVectors(e){return I(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}deleteVectors(e){return I(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ke(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}}class Ff{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mi),t),this.fetch=pi(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return I(this,void 0,void 0,function*(){try{return{data:(yield ke(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}getBucket(e){return I(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}listBuckets(){return I(this,arguments,void 0,function*(e={}){try{return{data:yield ke(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}deleteBucket(e){return I(this,void 0,void 0,function*(){try{return{data:(yield ke(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Se(t))return{data:null,error:t};throw t}})}}class Mf extends Ff{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Vf(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return I(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return I(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return I(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return I(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class Vf extends Uf{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return I(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return I(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return I(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return I(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new zf(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class zf extends Bf{constructor(e,t,r,a,i){super(e,t,i),this.vectorBucketName=r,this.indexName=a}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return I(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return I(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return I(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return I(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return I(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class qf extends Ef{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new Nf(this.url,this.headers,e,this.fetch)}get vectors(){return new Mf(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new If(this.url+"/iceberg",this.headers,this.fetch)}}const Wf="2.86.0";let Es="";typeof Deno<"u"?Es="deno":typeof document<"u"?Es="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Es="react-native":Es="node";const Hf={"X-Client-Info":`supabase-js-${Es}/${Wf}`},Kf={headers:Hf},Gf={schema:"public"},Zf={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Jf={},Yf=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Qf=()=>Headers,Xf=(s,e,t)=>{const r=Yf(t),a=Qf();return async(i,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:s;let d=new a(o?.headers);return d.has("apikey")||d.set("apikey",s),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:d}))}};function em(s){return s.endsWith("/")?s:s+"/"}function tm(s,e){var t,r;const{db:a,auth:i,realtime:o,global:l}=s,{db:c,auth:d,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h?.headers)!==null&&t!==void 0?t:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return s.accessToken?f.accessToken=s.accessToken:delete f.accessToken,f}function sm(s){const e=s?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(em(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Ic="2.86.0",Kt=30*1e3,ta=3,Cn=ta*Kt,rm="http://localhost:9999",nm="supabase.auth.token",am={"X-Client-Info":`gotrue-js/${Ic}`},sa="X-Supabase-Api-Version",Rc={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},im=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,om=10*60*1e3;class Us extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function U(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class lm extends Us{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function cm(s){return U(s)&&s.name==="AuthApiError"}class Pt extends Us{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class bt extends Us{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class Ee extends bt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function dm(s){return U(s)&&s.name==="AuthSessionMissingError"}class Mt extends bt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pr extends bt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class gr extends bt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function um(s){return U(s)&&s.name==="AuthImplicitGrantRedirectError"}class fo extends bt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ra extends bt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Tn(s){return U(s)&&s.name==="AuthRetryableFetchError"}class mo extends bt{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class na extends bt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const qr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),po=` 	
\r=`.split(""),hm=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<po.length;e+=1)s[po[e].charCodeAt(0)]=-2;for(let e=0;e<qr.length;e+=1)s[qr[e].charCodeAt(0)]=e;return s})();function go(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(qr[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(qr[r]),e.queuedBits-=6}}function Oc(s,e,t){const r=hm[s];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function xo(s){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{pm(o,r,t)};for(let o=0;o<s.length;o+=1)Oc(s.charCodeAt(o),a,i);return e.join("")}function fm(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function mm(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}fm(r,e)}}function pm(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if(!(s>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Jt(s){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<s.length;a+=1)Oc(s.charCodeAt(a),t,r);return new Uint8Array(e)}function gm(s){const e=[];return mm(s,t=>e.push(t)),new Uint8Array(e)}function Lt(s){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};return s.forEach(a=>go(a,t,r)),go(null,t,r),e.join("")}function xm(s){return Math.round(Date.now()/1e3)+s}function ym(){return Symbol("auth-callback")}const ye=()=>typeof window<"u"&&typeof document<"u",Nt={tested:!1,writable:!1},Lc=()=>{if(!ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Nt.tested)return Nt.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Nt.tested=!0,Nt.writable=!0}catch{Nt.tested=!0,Nt.writable=!1}return Nt.writable};function wm(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return t.searchParams.forEach((r,a)=>{e[a]=r}),e}const Dc=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),bm=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Gt=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Et=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ot=async(s,e)=>{await s.removeItem(e)};class cn{constructor(){this.promise=new cn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}cn.promiseConstructor=Promise;function An(s){const e=s.split(".");if(e.length!==3)throw new na("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!im.test(e[r]))throw new na("JWT not in base64url format");return{header:JSON.parse(xo(e[0])),payload:JSON.parse(xo(e[1])),signature:Jt(e[2]),raw:{header:e[0],payload:e[1]}}}async function vm(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function _m(s,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await s(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function jm(s){return("0"+s.toString(16)).substr(-2)}function Nm(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let a="";for(let i=0;i<56;i++)a+=t.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,jm).join("")}async function Em(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Sm(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return s;const t=await Em(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vt(s,e,t=!1){const r=Nm();let a=r;t&&(a+="/PASSWORD_RECOVERY"),await Gt(s,`${e}-code-verifier`,a);const i=await Sm(r);return[i,r===i?"plain":"s256"]}const km=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Cm(s){const e=s.headers.get(sa);if(!e||!e.match(km))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Tm(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function Am(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Pm=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function zt(s){if(!Pm.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Pn(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Im(s,e){return new Proxy(s,{get:(t,r,a)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,a)}return!e.value&&typeof r=="string"&&(e.value=!0),Reflect.get(t,r,a)}})}function yo(s){return JSON.parse(JSON.stringify(s))}const kt=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Rm=[502,503,504];async function wo(s){var e;if(!bm(s))throw new ra(kt(s),0);if(Rm.includes(s.status))throw new ra(kt(s),s.status);let t;try{t=await s.json()}catch(i){throw new Pt(kt(i),i)}let r;const a=Cm(s);if(a&&a.getTime()>=Rc["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new mo(kt(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ee}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new mo(kt(t),s.status,t.weak_password.reasons);throw new lm(kt(t),s.status||500,r)}const Om=(s,e,t,r)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),t))};async function M(s,e,t,r){var a;const i=Object.assign({},r?.headers);i[sa]||(i[sa]=Rc["2024-01-01"].name),r?.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r?.query)!==null&&a!==void 0?a:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Lm(s,e,t+l,{headers:i,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(c):{data:Object.assign({},c),error:null}}async function Lm(s,e,t,r,a,i){const o=Om(e,r,a,i);let l;try{l=await s(t,Object.assign({},o))}catch(c){throw new ra(kt(c),0)}if(l.ok||await wo(l),r?.noResolveJson)return l;try{return await l.json()}catch(c){await wo(c)}}function Le(s){var e;let t=null;Um(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=xm(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function bo(s){const e=Le(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function ut(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Dm(s){return{data:s,error:null}}function $m(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:i}=s,o=nn(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function vo(s){return s}function Um(s){return s.access_token&&s.refresh_token&&s.expires_in}const In=["global","local","others"];class Bm{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Dc(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=In[0]){if(In.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${In.join(", ")}`);try{return await M(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(U(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await M(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ut})}catch(r){if(U(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=nn(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=r?.newEmail,delete a.newEmail),await M(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:$m,redirectTo:t?.redirectTo})}catch(t){if(U(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await M(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ut})}catch(t){if(U(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await M(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:vo});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(w=>{const g=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(U(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){zt(e);try{return await M(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ut})}catch(t){if(U(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){zt(e);try{return await M(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ut})}catch(r){if(U(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){zt(e);try{return await M(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ut})}catch(r){if(U(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){zt(e.userId);try{const{data:t,error:r}=await M(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:r}}catch(t){if(U(t))return{data:null,error:t};throw t}}async _deleteFactor(e){zt(e.userId),zt(e.id);try{return{data:await M(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(U(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await M(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:vo});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(w=>{const g=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(U(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await M(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(U(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await M(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(U(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await M(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(U(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await M(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(U(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await M(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(U(t))return{data:null,error:t};throw t}}}function _o(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const qt={debug:!!(globalThis&&Lc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $c extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Fm extends $c{}async function Mm(s,e,t){qt.debug;const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),qt.debug},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){qt.debug;try{return await t()}finally{qt.debug}}else{if(e===0)throw qt.debug,new Fm(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(qt.debug)try{const i=await globalThis.navigator.locks.query()}catch{}return await t()}}))}function Vm(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Uc(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function zm(s){return parseInt(s,16)}function qm(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function Wm(s){var e;const{chainId:t,domain:r,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:u,uri:h,version:f}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const p=Uc(s.address),w=u?`${u}://${r}`:r,g=s.statement?`${s.statement}
`:"",y=`${w} wants you to sign in with your Ethereum account:
${p}

${g}`;let b=`URI: ${h}
Version: ${f}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(b+=`
Expiration Time: ${a.toISOString()}`),l&&(b+=`
Not Before: ${l.toISOString()}`),c&&(b+=`
Request ID: ${c}`),d){let v=`
Resources:`;for(const x of d){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);v+=`
- ${x}`}b+=v}return`${y}
${b}`}class he extends Error{constructor({message:e,code:t,cause:r,name:a}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=a??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class Wr extends he{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Hm({error:s,options:e}){var t,r,a;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new he({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new he({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new he({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new he({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new he({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new he({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new he({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new he({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const o=window.location.hostname;if(Bc(o)){if(i.rp.id!==o)return new he({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new he({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new he({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new he({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new he({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function Km({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new he({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new he({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const r=window.location.hostname;if(Bc(r)){if(t.rpId!==r)return new he({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new he({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new he({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new he({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class Gm{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Zm=new Gm;function Jm(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:r}=s,a=nn(s,["challenge","user","excludeCredentials"]),i=Jt(e).buffer,o=Object.assign(Object.assign({},t),{id:Jt(t.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Jt(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Ym(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,r=nn(s,["challenge","allowCredentials"]),a=Jt(e).buffer,i=Object.assign(Object.assign({},r),{challenge:a});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Jt(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function Qm(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:Lt(new Uint8Array(s.response.attestationObject)),clientDataJSON:Lt(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Xm(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,r=s.getClientExtensionResults(),a=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:Lt(new Uint8Array(a.authenticatorData)),clientDataJSON:Lt(new Uint8Array(a.clientDataJSON)),signature:Lt(new Uint8Array(a.signature)),userHandle:a.userHandle?Lt(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Bc(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function jo(){var s,e;return!!(ye()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function ep(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Wr("Browser returned unexpected credential type",e)}:{data:null,error:new Wr("Empty credential response",e)}}catch(e){return{data:null,error:Hm({error:e,options:s})}}}async function tp(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Wr("Browser returned unexpected credential type",e)}:{data:null,error:new Wr("Empty credential response",e)}}catch(e){return{data:null,error:Km({error:e,options:s})}}}const sp={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},rp={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Hr(...s){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),r={};for(const a of s)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))r[i]=o;else if(t(o))r[i]=o;else if(e(o)){const l=r[i];e(l)?r[i]=Hr(l,o):r[i]=Hr(o)}else r[i]=o}return r}function np(s,e){return Hr(sp,s,e||{})}function ap(s,e){return Hr(rp,s,e||{})}class ip{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:a},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=a??Zm.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=np(o.webauthn.credential_options.publicKey,i?.create),{data:u,error:h}=await ep({publicKey:d,signal:c});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const d=ap(o.webauthn.credential_options.publicKey,i?.request),{data:u,error:h}=await tp(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(o){return U(o)?{data:null,error:o}:{data:null,error:new Pt("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!t)return{data:null,error:new Us("rpId is required for WebAuthn authentication")};try{if(!jo())return{data:null,error:new Pt("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return U(o)?{data:null,error:o}:{data:null,error:new Pt("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!t)return{data:null,error:new Us("rpId is required for WebAuthn registration")};try{if(!jo())return{data:null,error:new Pt("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:a},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return U(o)?{data:null,error:o}:{data:null,error:new Pt("Unexpected error in register",o)}}}}Vm();const op={url:rm,storageKey:nm,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:am,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function No(s,e,t){return await t()}const Wt={};class Bs{get jwks(){var e,t;return(t=(e=Wt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Wt[this.storageKey]=Object.assign(Object.assign({},Wt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Wt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Wt[this.storageKey]=Object.assign(Object.assign({},Wt[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},op),e);if(this.storageKey=i.storageKey,this.instanceID=(t=Bs.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Bs.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&ye()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;this.logDebugMessages}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Bm({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Dc(i.fetch),this.lock=i.lock||No,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:ye()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=Mm:this.lock=No,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ip(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Lc()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=_o(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=_o(this.memoryStorage)),ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch{}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ic}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(ye()&&(t=wm(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),ye()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),um(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return U(t)?this._returnResult({error:t}):this._returnResult({error:new Pt("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{const i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Le}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(U(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,r,a;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,w=null;this.flowType==="pkce"&&([p,w]=await Vt(this.storage,this.storageKey)),i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:h,data:(t=f?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:p,code_challenge_method:w},xform:Le})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=f?.data)!==null&&r!==void 0?r:{},channel:(a=f?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Le})}else throw new pr("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(U(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:bo})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:bo})}else throw new pr("You must provide either an email or phone number and a password");const{data:r,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!r||!r.session||!r.user){const i=new Mt;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(t){if(U(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,a,i,o,l,c,d,u,h,f;let p,w;if("message"in e)p=e.message,w=e.signature;else{const{chain:g,wallet:y,statement:b,options:v}=e;let x;if(ye())if(typeof y=="object")x=y;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")x=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!v?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=y}const _=new URL((t=v?.url)!==null&&t!==void 0?t:window.location.href),j=await x.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=Uc(j[0]);let E=(r=v?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!E){const N=await x.request({method:"eth_chainId"});E=zm(N)}const T={domain:_.host,address:S,statement:b,uri:_.href,version:"1",chainId:E,nonce:(a=v?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=v?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=v?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=v?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=v?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=v?.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=Wm(T),w=await x.request({method:"personal_sign",params:[qm(p),S]})}try{const{data:g,error:y}=await M(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:w},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Le});if(y)throw y;if(!g||!g.session||!g.user){const b=new Mt;return this._returnResult({data:{user:null,session:null},error:b})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(U(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(e){var t,r,a,i,o,l,c,d,u,h,f,p;let w,g;if("message"in e)w=e.message,g=e.signature;else{const{chain:y,wallet:b,statement:v,options:x}=e;let _;if(ye())if(typeof b=="object")_=b;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))_=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=b}const j=new URL((t=x?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in _&&_.signIn){const S=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),v?{statement:v}:null));let E;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")E=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)E=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)w=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),g=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${j.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(a=(r=x?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=x?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((d=x?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const S=await _.signMessage(new TextEncoder().encode(w),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=S}}try{const{data:y,error:b}=await M(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Lt(g)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Le});if(b)throw b;if(!y||!y.session||!y.user){const v=new Mt;return this._returnResult({data:{user:null,session:null},error:v})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:b})}catch(y){if(U(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const t=await Et(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(t??"").split("/");try{const{data:i,error:o}=await M(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Le});if(await ot(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new Mt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(U(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:a,access_token:i,nonce:o}=e,l=await M(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Le}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Mt;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(U(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Vt(this.storage,this.storageKey));const{error:h}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c?.data)!==null&&a!==void 0?a:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:u})}throw new pr("You must provide either an email or phone number.")}catch(l){if(U(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,r;try{let a,i;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await M(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Le});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(U(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,r,a,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Vt(this.storage,this.storageKey));const d=await M(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Dm});return!((i=d.data)===null||i===void 0)&&i.url&&ye()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(U(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Ee;const{error:a}=await M(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(U(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await M(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:l}=await M(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new pr("You must provide either an email or phone number and a type")}catch(t){if(U(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Et(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Cn:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Et(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Pn()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=Im(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ut}):await this._useSession(async t=>{var r,a,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ee}:await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:ut})})}catch(t){if(U(t))return dm(t)&&(await this._removeSession(),await ot(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Ee;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Vt(this.storage,this.storageKey));const{data:d,error:u}=await M(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:ut});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(U(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ee;const t=Date.now()/1e3;let r=t,a=!0,i=null;const{payload:o}=An(e.access_token);if(o.exp&&(r=o.exp,a=r<=t),a){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(U(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new Ee;const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(U(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!ye())throw new gr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new gr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new fo("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new gr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new fo("No code detected.");const{data:v,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new gr("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c)),(f-u)*1e3<=Kt;const w=f-h;u-w>=120||u-w<0;const{data:g,error:y}=await this._getUser(i);if(y)throw y;const b={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:e.type},error:null})}catch(r){if(U(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Et(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:a,error:i}=t;if(i)return this._returnResult({error:i});const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(cm(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await ot(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=ym(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i)}})}async resetPasswordForEmail(e,t={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Vt(this.storage,this.storageKey,!0));try{return await M(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(U(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await M(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return ye()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:e.provider,url:r?.url},error:null})}catch(r){if(U(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:a,data:{session:i}}=t;if(a)throw a;const{options:o,provider:l,token:c,access_token:d,nonce:u}=e,h=await M(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Le}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Mt}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(a){if(U(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;const{data:i,error:o}=t;if(o)throw o;return await M(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await _m(async a=>(a>0&&await vm(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await M(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Le})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Tn(i)&&Date.now()+o-r<Kt})}catch(r){if(this._debug(t,"error",r),U(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ye()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await Et(this.storage,this.storageKey);if(a&&this.userStorage){let o=await Et(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await Gt(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o?.user)!==null&&e!==void 0?e:Pn()}else if(a&&!a.user&&!a.user){const o=await Et(this.storage,this.storageKey+"-user");o&&o?.user?(a.user=o.user,await ot(this.storage,this.storageKey+"-user"),await Gt(this.storage,this.storageKey,a)):a.user=Pn()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const i=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Cn;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Cn}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(Tn(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&o?.user?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Ee;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new cn;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ee;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),U(i)){const o={data:null,error:i};return Tn(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Gt(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const i=yo(a);await Gt(this.storage,this.storageKey,i)}else{const a=yo(t);await Gt(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ot(this.storage,this.storageKey),await ot(this.storage,this.storageKey+"-code-verifier"),await ot(this.storage,this.storageKey+"-user"),this.userStorage&&await ot(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ye()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch{}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Kt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Kt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Kt}ms, refresh threshold is ${ta} ticks`),a<=ta&&await this._callRefreshToken(r.refresh_token)})}catch{}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $c)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ye()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch{}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const a=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Vt(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(r?.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r?.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:a,error:i}=t;return i?this._returnResult({data:null,error:i}):await M(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await M(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((a=c?.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Qm(e.webauthn.credential_response):Xm(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Jm(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ym(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t?.factors)!==null&&e!==void 0?e:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=An(r.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await M(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ee})})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:a},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Ee});const o=await M(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ye()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(U(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:a},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Ee});const o=await M(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ye()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(U(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await M(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Ee})})}catch(e){if(U(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?(await M(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ee})})}catch(t){if(U(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+om>a)return r;const{data:i,error:o}=await M(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:p,error:w}=await this.getSession();if(w||!p.session)return this._returnResult({data:null,error:w});r=p.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=An(r);t?.allowExpired||Tm(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:a,signature:o},error:null}}const u=Am(a.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,gm(`${l}.${c}`)))throw new na("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(U(r))return this._returnResult({data:null,error:r});throw r}}}Bs.nextInstanceID={};const lp=Bs;class cp extends lp{constructor(e){super(e)}}class dp{constructor(e,t,r){var a,i,o;this.supabaseUrl=e,this.supabaseKey=t;const l=sm(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Gf,realtime:Jf,auth:Object.assign(Object.assign({},Zf),{storageKey:c}),global:Kf},u=tm(r??{},d);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=Xf(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>{}),this.rest=new Gh(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new qf(this.storageUrl.href,this.headers,this.fetch,r?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Wh(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:i,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:u},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cp({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:i,flowType:l,lock:c,debug:d,throwOnError:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new hf(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const up=(s,e,t)=>new dp(s,e,t);function hp(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}hp();/*! Capacitor: https://capacitorjs.com/ - MIT License */var es;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(es||(es={}));class Rn extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const fp=s=>{var e,t;return s?.androidBridge?"android":!((t=(e=s?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},mp=s=>{const e=s.CapacitorCustomPlatform||null,t=s.Capacitor||{},r=t.Plugins=t.Plugins||{},a=()=>e!==null?e.name:fp(s),i=()=>a()!=="web",o=h=>{const f=d.get(h);return!!(f?.platforms.has(a())||l(h))},l=h=>{var f;return(f=t.PluginHeaders)===null||f===void 0?void 0:f.find(p=>p.name===h)},c=h=>s.console.error(h),d=new Map,u=(h,f={})=>{const p=d.get(h);if(p)return p.proxy;const w=a(),g=l(h);let y;const b=async()=>(!y&&w in f?y=typeof f[w]=="function"?y=await f[w]():y=f[w]:e!==null&&!y&&"web"in f&&(y=typeof f.web=="function"?y=await f.web():y=f.web),y),v=(T,N)=>{var C,O;if(g){const F=g?.methods.find(re=>N===re.name);if(F)return F.rtype==="promise"?re=>t.nativePromise(h,N.toString(),re):(re,K)=>t.nativeCallback(h,N.toString(),re,K);if(T)return(C=T[N])===null||C===void 0?void 0:C.bind(T)}else{if(T)return(O=T[N])===null||O===void 0?void 0:O.bind(T);throw new Rn(`"${h}" plugin is not implemented on ${w}`,es.Unimplemented)}},x=T=>{let N;const C=(...O)=>{const F=b().then(re=>{const K=v(re,T);if(K){const ue=K(...O);return N=ue?.remove,ue}else throw new Rn(`"${h}.${T}()" is not implemented on ${w}`,es.Unimplemented)});return T==="addListener"&&(F.remove=async()=>N()),F};return C.toString=()=>`${T.toString()}() { [capacitor code] }`,Object.defineProperty(C,"name",{value:T,writable:!1,configurable:!1}),C},_=x("addListener"),j=x("removeListener"),S=(T,N)=>{const C=_({eventName:T},N),O=async()=>{const re=await C;j({eventName:T,callbackId:re},N)},F=new Promise(re=>C.then(()=>re({remove:O})));return F.remove=async()=>{await O()},F},E=new Proxy({},{get(T,N){switch(N){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?S:_;case"removeListener":return j;default:return x(N)}}});return r[h]=E,d.set(h,{name:h,proxy:E,platforms:new Set([...Object.keys(f),...g?[w]:[]])}),E};return t.convertFileSrc||(t.convertFileSrc=h=>h),t.getPlatform=a,t.handleError=c,t.isNativePlatform=i,t.isPluginAvailable=o,t.registerPlugin=u,t.Exception=Rn,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},pp=s=>s.Capacitor=mp(s),nt=pp(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Qs=nt.registerPlugin;class gi{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const a=this.listeners[e];if(!a){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(t),this.retainedEventArguments[e]=i}return}a.forEach(i=>i(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new nt.Exception(e,es.Unimplemented)}unavailable(e="not available"){return new nt.Exception(e,es.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const a=r.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const Eo=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),So=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class gp extends gi{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=So(a).trim(),i=So(i).trim(),t[a]=i}),t}async setCookie(e){try{const t=Eo(e.key),r=Eo(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${a}; path=${i}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Qs("CapacitorCookies",{web:()=>new gp});const xp=async s=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>t(a),r.readAsDataURL(s)}),yp=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=s[e[o]],a),{})},wp=(s,e=!0)=>s?Object.entries(s).reduce((r,a)=>{const[i,o]=a;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=e?encodeURIComponent(d):d,c+=`${i}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${i}=${l}`),`${r}&${c}`},"").substr(1):null,bp=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),a=yp(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,l]of Object.entries(s.data||{}))i.set(o,l);t.body=i.toString()}else if(a.includes("multipart/form-data")||s.data instanceof FormData){const i=new FormData;if(s.data instanceof FormData)s.data.forEach((l,c)=>{i.append(c,l)});else for(const l of Object.keys(s.data))i.append(l,s.data[l]);t.body=i;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(a.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class vp extends gi{async request(e){const t=bp(e,e.webFetchExtra),r=wp(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,i=await fetch(a,t),o=i.headers.get("content-type")||"";let{responseType:l="text"}=i.ok?e:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=await i.blob(),c=await xp(d);break;case"json":c=await i.json();break;case"document":case"text":default:c=await i.text()}const u={};return i.headers.forEach((h,f)=>{u[f]=h}),{data:c,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}const Zv=Qs("CapacitorHttp",{web:()=>new vp});var ko;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(ko||(ko={}));var Co;(function(s){s.StatusBar="StatusBar",s.NavigationBar="NavigationBar"})(Co||(Co={}));class _p extends gi{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Qs("SystemBars",{web:()=>new _p});const jp=Qs("App",{web:()=>H(()=>import("./web-16685850.js"),["assets/web-16685850.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js"]).then(s=>new s.AppWeb)}),Fc=Qs("Browser",{web:()=>H(()=>import("./web-bcd77046.js"),["assets/web-bcd77046.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js"]).then(s=>new s.BrowserWeb)});var X;(function(s){s.assertEqual=a=>{};function e(a){}s.assertIs=e;function t(a){throw new Error}s.assertNever=t,s.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},s.getValidEnumValues=a=>{const i=s.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of i)o[l]=a[l];return s.objectValues(o)},s.objectValues=a=>s.objectKeys(a).map(function(i){return a[i]}),s.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},s.find=(a,i)=>{for(const o of a)if(i(o))return o},s.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}s.joinValues=r,s.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(X||(X={}));var To;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(To||(To={}));const R=X.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ct=s=>{switch(typeof s){case"undefined":return R.undefined;case"string":return R.string;case"number":return Number.isNaN(s)?R.nan:R.number;case"boolean":return R.boolean;case"function":return R.function;case"bigint":return R.bigint;case"symbol":return R.symbol;case"object":return Array.isArray(s)?R.array:s===null?R.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?R.promise:typeof Map<"u"&&s instanceof Map?R.map:typeof Set<"u"&&s instanceof Set?R.set:typeof Date<"u"&&s instanceof Date?R.date:R.object;default:return R.unknown}},k=X.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class at extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return a(this),r}static assert(e){if(!(e instanceof at))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,X.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];t[i]=t[i]||[],t[i].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}at.create=s=>new at(s);const Np=(s,e)=>{let t;switch(s.code){case k.invalid_type:s.received===R.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case k.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,X.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:t=`Unrecognized key(s) in object: ${X.joinValues(s.keys,", ")}`;break;case k.invalid_union:t="Invalid input";break;case k.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${X.joinValues(s.options)}`;break;case k.invalid_enum_value:t=`Invalid enum value. Expected ${X.joinValues(s.options)}, received '${s.received}'`;break;case k.invalid_arguments:t="Invalid function arguments";break;case k.invalid_return_type:t="Invalid function return type";break;case k.invalid_date:t="Invalid date";break;case k.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:X.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case k.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case k.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case k.custom:t="Invalid input";break;case k.invalid_intersection_types:t="Intersection results could not be merged";break;case k.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case k.not_finite:t="Number must be finite";break;default:t=e.defaultError,X.assertNever(s)}return{message:t}},aa=Np;let Ep=aa;function Sp(){return Ep}const kp=s=>{const{data:e,path:t,errorMaps:r,issueData:a}=s,i=[...t,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...a,path:i,message:l}};function A(s,e){const t=Sp(),r=kp({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===aa?void 0:aa].filter(a=>!!a)});s.common.issues.push(r)}class Ce{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const a of t){if(a.status==="aborted")return z;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const a of t){const i=await a.key,o=await a.value;r.push({key:i,value:o})}return Ce.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const a of t){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return z;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const z=Object.freeze({status:"aborted"}),Ss=s=>({status:"dirty",value:s}),Oe=s=>({status:"valid",value:s}),Ao=s=>s.status==="aborted",Po=s=>s.status==="dirty",ts=s=>s.status==="valid",Kr=s=>typeof Promise<"u"&&s instanceof Promise;var D;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(D||(D={}));class gt{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Io=(s,e)=>{if(ts(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new at(s.common.issues);return this._error=t,this._error}}};function W(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:a}=s;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(o,l)=>{const{message:c}=s;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:a}}class Q{get description(){return this._def.description}_getType(e){return ct(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ce,ctx:{common:e.parent.common,data:e.data,parsedType:ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Kr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)},a=this._parseSync({data:e,path:r.path,parent:r});return Io(r,a)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return ts(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>ts(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(Kr(a)?a:Promise.resolve(a));return Io(r,i)}refine(e,t){const r=a=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(a):t;return this._refinement((a,i)=>{const o=e(a),l=()=>i.addIssue({code:k.custom,...r(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof t=="function"?t(r,a):t),!1))}_refinement(e){return new rs({schema:this,typeName:q.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return mt.create(this,this._def)}nullable(){return ns.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return qe.create(this)}promise(){return Yr.create(this,this._def)}or(e){return Zr.create([this,e],this._def)}and(e){return Jr.create(this,e,this._def)}transform(e){return new rs({...W(this._def),schema:this,typeName:q.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new oa({...W(this._def),innerType:this,defaultValue:t,typeName:q.ZodDefault})}brand(){return new Jp({typeName:q.ZodBranded,type:this,...W(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new la({...W(this._def),innerType:this,catchValue:t,typeName:q.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return xi.create(this,e)}readonly(){return ca.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Cp=/^c[^\s-]{8,}$/i,Tp=/^[0-9a-z]+$/,Ap=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Pp=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ip=/^[a-z0-9_-]{21}$/i,Rp=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Op=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Lp=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Dp="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let On;const $p=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Up=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Bp=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Fp=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Mp=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Vp=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Mc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",zp=new RegExp(`^${Mc}$`);function Vc(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);const t=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function qp(s){return new RegExp(`^${Vc(s)}$`)}function Wp(s){let e=`${Mc}T${Vc(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Hp(s,e){return!!((e==="v4"||!e)&&$p.test(s)||(e==="v6"||!e)&&Bp.test(s))}function Kp(s,e){if(!Rp.test(s))return!1;try{const[t]=s.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&a?.typ!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function Gp(s,e){return!!((e==="v4"||!e)&&Up.test(s)||(e==="v6"||!e)&&Fp.test(s))}class ft extends Q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==R.string){const i=this._getOrReturnCtx(e);return A(i,{code:k.invalid_type,expected:R.string,received:i.parsedType}),z}const r=new Ce;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),A(a,{code:k.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),A(a,{code:k.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,l=e.data.length<i.value;(o||l)&&(a=this._getOrReturnCtx(e,a),o?A(a,{code:k.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&A(a,{code:k.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Lp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"email",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")On||(On=new RegExp(Dp,"u")),On.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"emoji",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Pp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"uuid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Ip.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"nanoid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Cp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"cuid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Tp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"cuid2",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Ap.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"ulid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),A(a,{validation:"url",code:k.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"regex",code:k.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),A(a,{code:k.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),A(a,{code:k.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),A(a,{code:k.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Wp(i).test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{code:k.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?zp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{code:k.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?qp(i).test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{code:k.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Op.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"duration",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Hp(e.data,i.version)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"ip",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Kp(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"jwt",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Gp(e.data,i.version)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"cidr",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Mp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"base64",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Vp.test(e.data)||(a=this._getOrReturnCtx(e,a),A(a,{validation:"base64url",code:k.invalid_string,message:i.message}),r.dirty()):X.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(a=>e.test(a),{validation:t,code:k.invalid_string,...D.errToObj(r)})}_addCheck(e){return new ft({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...D.errToObj(e)})}url(e){return this._addCheck({kind:"url",...D.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...D.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...D.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...D.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...D.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...D.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...D.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...D.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...D.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...D.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...D.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...D.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...D.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...D.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...D.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...D.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...D.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...D.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...D.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...D.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...D.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...D.errToObj(t)})}nonempty(e){return this.min(1,D.errToObj(e))}trim(){return new ft({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ft({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ft({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ft.create=s=>new ft({checks:[],typeName:q.ZodString,coerce:s?.coerce??!1,...W(s)});function Zp(s,e){const t=(s.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=t>r?t:r,i=Number.parseInt(s.toFixed(a).replace(".","")),o=Number.parseInt(e.toFixed(a).replace(".",""));return i%o/10**a}class Fs extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==R.number){const i=this._getOrReturnCtx(e);return A(i,{code:k.invalid_type,expected:R.number,received:i.parsedType}),z}let r;const a=new Ce;for(const i of this._def.checks)i.kind==="int"?X.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),A(r,{code:k.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),A(r,{code:k.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),A(r,{code:k.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?Zp(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),A(r,{code:k.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),A(r,{code:k.not_finite,message:i.message}),a.dirty()):X.assertNever(i);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,D.toString(t))}gt(e,t){return this.setLimit("min",e,!1,D.toString(t))}lte(e,t){return this.setLimit("max",e,!0,D.toString(t))}lt(e,t){return this.setLimit("max",e,!1,D.toString(t))}setLimit(e,t,r,a){return new Fs({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:D.toString(a)}]})}_addCheck(e){return new Fs({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:D.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:D.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:D.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:D.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:D.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&X.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Fs.create=s=>new Fs({checks:[],typeName:q.ZodNumber,coerce:s?.coerce||!1,...W(s)});class Ms extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==R.bigint)return this._getInvalidInput(e);let r;const a=new Ce;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),A(r,{code:k.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),A(r,{code:k.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),A(r,{code:k.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):X.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return A(t,{code:k.invalid_type,expected:R.bigint,received:t.parsedType}),z}gte(e,t){return this.setLimit("min",e,!0,D.toString(t))}gt(e,t){return this.setLimit("min",e,!1,D.toString(t))}lte(e,t){return this.setLimit("max",e,!0,D.toString(t))}lt(e,t){return this.setLimit("max",e,!1,D.toString(t))}setLimit(e,t,r,a){return new Ms({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:D.toString(a)}]})}_addCheck(e){return new Ms({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:D.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ms.create=s=>new Ms({checks:[],typeName:q.ZodBigInt,coerce:s?.coerce??!1,...W(s)});class Ro extends Q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==R.boolean){const r=this._getOrReturnCtx(e);return A(r,{code:k.invalid_type,expected:R.boolean,received:r.parsedType}),z}return Oe(e.data)}}Ro.create=s=>new Ro({typeName:q.ZodBoolean,coerce:s?.coerce||!1,...W(s)});class Gr extends Q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==R.date){const i=this._getOrReturnCtx(e);return A(i,{code:k.invalid_type,expected:R.date,received:i.parsedType}),z}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return A(i,{code:k.invalid_date}),z}const r=new Ce;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),A(a,{code:k.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),A(a,{code:k.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):X.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Gr({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:D.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:D.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Gr.create=s=>new Gr({checks:[],coerce:s?.coerce||!1,typeName:q.ZodDate,...W(s)});class Oo extends Q{_parse(e){if(this._getType(e)!==R.symbol){const r=this._getOrReturnCtx(e);return A(r,{code:k.invalid_type,expected:R.symbol,received:r.parsedType}),z}return Oe(e.data)}}Oo.create=s=>new Oo({typeName:q.ZodSymbol,...W(s)});class Lo extends Q{_parse(e){if(this._getType(e)!==R.undefined){const r=this._getOrReturnCtx(e);return A(r,{code:k.invalid_type,expected:R.undefined,received:r.parsedType}),z}return Oe(e.data)}}Lo.create=s=>new Lo({typeName:q.ZodUndefined,...W(s)});class Do extends Q{_parse(e){if(this._getType(e)!==R.null){const r=this._getOrReturnCtx(e);return A(r,{code:k.invalid_type,expected:R.null,received:r.parsedType}),z}return Oe(e.data)}}Do.create=s=>new Do({typeName:q.ZodNull,...W(s)});class $o extends Q{constructor(){super(...arguments),this._any=!0}_parse(e){return Oe(e.data)}}$o.create=s=>new $o({typeName:q.ZodAny,...W(s)});class Uo extends Q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Oe(e.data)}}Uo.create=s=>new Uo({typeName:q.ZodUnknown,...W(s)});class xt extends Q{_parse(e){const t=this._getOrReturnCtx(e);return A(t,{code:k.invalid_type,expected:R.never,received:t.parsedType}),z}}xt.create=s=>new xt({typeName:q.ZodNever,...W(s)});class Bo extends Q{_parse(e){if(this._getType(e)!==R.undefined){const r=this._getOrReturnCtx(e);return A(r,{code:k.invalid_type,expected:R.void,received:r.parsedType}),z}return Oe(e.data)}}Bo.create=s=>new Bo({typeName:q.ZodVoid,...W(s)});class qe extends Q{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==R.array)return A(t,{code:k.invalid_type,expected:R.array,received:t.parsedType}),z;if(a.exactLength!==null){const o=t.data.length>a.exactLength.value,l=t.data.length<a.exactLength.value;(o||l)&&(A(t,{code:o?k.too_big:k.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&t.data.length<a.minLength.value&&(A(t,{code:k.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&t.data.length>a.maxLength.value&&(A(t,{code:k.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>a.type._parseAsync(new gt(t,o,t.path,l)))).then(o=>Ce.mergeArray(r,o));const i=[...t.data].map((o,l)=>a.type._parseSync(new gt(t,o,t.path,l)));return Ce.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new qe({...this._def,minLength:{value:e,message:D.toString(t)}})}max(e,t){return new qe({...this._def,maxLength:{value:e,message:D.toString(t)}})}length(e,t){return new qe({...this._def,exactLength:{value:e,message:D.toString(t)}})}nonempty(e){return this.min(1,e)}}qe.create=(s,e)=>new qe({type:s,minLength:null,maxLength:null,exactLength:null,typeName:q.ZodArray,...W(e)});function Zt(s){if(s instanceof ce){const e={};for(const t in s.shape){const r=s.shape[t];e[t]=mt.create(Zt(r))}return new ce({...s._def,shape:()=>e})}else return s instanceof qe?new qe({...s._def,type:Zt(s.element)}):s instanceof mt?mt.create(Zt(s.unwrap())):s instanceof ns?ns.create(Zt(s.unwrap())):s instanceof Ut?Ut.create(s.items.map(e=>Zt(e))):s}class ce extends Q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=X.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==R.object){const d=this._getOrReturnCtx(e);return A(d,{code:k.invalid_type,expected:R.object,received:d.parsedType}),z}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof xt&&this._def.unknownKeys==="strip"))for(const d in a.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const u=i[d],h=a.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new gt(a,h,a.path,d)),alwaysSet:d in a.data})}if(this._def.catchall instanceof xt){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:a.data[u]}});else if(d==="strict")l.length>0&&(A(a,{code:k.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of l){const h=a.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new gt(a,h,a.path,u)),alwaysSet:u in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const h=await u.key,f=await u.value;d.push({key:h,value:f,alwaysSet:u.alwaysSet})}return d}).then(d=>Ce.mergeObjectSync(r,d)):Ce.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return D.errToObj,new ce({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const a=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:D.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new ce({...this._def,unknownKeys:"strip"})}passthrough(){return new ce({...this._def,unknownKeys:"passthrough"})}extend(e){return new ce({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ce({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:q.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ce({...this._def,catchall:e})}pick(e){const t={};for(const r of X.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new ce({...this._def,shape:()=>t})}omit(e){const t={};for(const r of X.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new ce({...this._def,shape:()=>t})}deepPartial(){return Zt(this)}partial(e){const t={};for(const r of X.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new ce({...this._def,shape:()=>t})}required(e){const t={};for(const r of X.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof mt;)i=i._def.innerType;t[r]=i}return new ce({...this._def,shape:()=>t})}keyof(){return zc(X.objectKeys(this.shape))}}ce.create=(s,e)=>new ce({shape:()=>s,unknownKeys:"strip",catchall:xt.create(),typeName:q.ZodObject,...W(e)});ce.strictCreate=(s,e)=>new ce({shape:()=>s,unknownKeys:"strict",catchall:xt.create(),typeName:q.ZodObject,...W(e)});ce.lazycreate=(s,e)=>new ce({shape:s,unknownKeys:"strip",catchall:xt.create(),typeName:q.ZodObject,...W(e)});class Zr extends Q{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new at(l.ctx.common.issues));return A(t,{code:k.invalid_union,unionErrors:o}),z}if(t.common.async)return Promise.all(r.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const c of r){const d={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new at(c));return A(t,{code:k.invalid_union,unionErrors:l}),z}}get options(){return this._def.options}}Zr.create=(s,e)=>new Zr({options:s,typeName:q.ZodUnion,...W(e)});function ia(s,e){const t=ct(s),r=ct(e);if(s===e)return{valid:!0,data:s};if(t===R.object&&r===R.object){const a=X.objectKeys(e),i=X.objectKeys(s).filter(l=>a.indexOf(l)!==-1),o={...s,...e};for(const l of i){const c=ia(s[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===R.array&&r===R.array){if(s.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<s.length;i++){const o=s[i],l=e[i],c=ia(o,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return t===R.date&&r===R.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class Jr extends Q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=(i,o)=>{if(Ao(i)||Ao(o))return z;const l=ia(i.value,o.value);return l.valid?((Po(i)||Po(o))&&t.dirty(),{status:t.value,value:l.data}):(A(r,{code:k.invalid_intersection_types}),z)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Jr.create=(s,e,t)=>new Jr({left:s,right:e,typeName:q.ZodIntersection,...W(t)});class Ut extends Q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==R.array)return A(r,{code:k.invalid_type,expected:R.array,received:r.parsedType}),z;if(r.data.length<this._def.items.length)return A(r,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),z;!this._def.rest&&r.data.length>this._def.items.length&&(A(r,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new gt(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Ce.mergeArray(t,o)):Ce.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Ut({...this._def,rest:e})}}Ut.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ut({items:s,typeName:q.ZodTuple,rest:null,...W(e)})};class Fo extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==R.map)return A(r,{code:k.invalid_type,expected:R.map,received:r.parsedType}),z;const a=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:a._parse(new gt(r,l,r.path,[d,"key"])),value:i._parse(new gt(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return z;(d.status==="dirty"||u.status==="dirty")&&t.dirty(),l.set(d.value,u.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return z;(d.status==="dirty"||u.status==="dirty")&&t.dirty(),l.set(d.value,u.value)}return{status:t.value,value:l}}}}Fo.create=(s,e,t)=>new Fo({valueType:e,keyType:s,typeName:q.ZodMap,...W(t)});class Vs extends Q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==R.set)return A(r,{code:k.invalid_type,expected:R.set,received:r.parsedType}),z;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(A(r,{code:k.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(A(r,{code:k.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const u of c){if(u.status==="aborted")return z;u.status==="dirty"&&t.dirty(),d.add(u.value)}return{status:t.value,value:d}}const l=[...r.data.values()].map((c,d)=>i._parse(new gt(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new Vs({...this._def,minSize:{value:e,message:D.toString(t)}})}max(e,t){return new Vs({...this._def,maxSize:{value:e,message:D.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Vs.create=(s,e)=>new Vs({valueType:s,minSize:null,maxSize:null,typeName:q.ZodSet,...W(e)});class Mo extends Q{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Mo.create=(s,e)=>new Mo({getter:s,typeName:q.ZodLazy,...W(e)});class Vo extends Q{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return A(t,{received:t.data,code:k.invalid_literal,expected:this._def.value}),z}return{status:"valid",value:e.data}}get value(){return this._def.value}}Vo.create=(s,e)=>new Vo({value:s,typeName:q.ZodLiteral,...W(e)});function zc(s,e){return new ss({values:s,typeName:q.ZodEnum,...W(e)})}class ss extends Q{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return A(t,{expected:X.joinValues(r),received:t.parsedType,code:k.invalid_type}),z}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return A(t,{received:t.data,code:k.invalid_enum_value,options:r}),z}return Oe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ss.create(e,{...this._def,...t})}exclude(e,t=this._def){return ss.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}ss.create=zc;class zo extends Q{_parse(e){const t=X.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==R.string&&r.parsedType!==R.number){const a=X.objectValues(t);return A(r,{expected:X.joinValues(a),received:r.parsedType,code:k.invalid_type}),z}if(this._cache||(this._cache=new Set(X.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=X.objectValues(t);return A(r,{received:r.data,code:k.invalid_enum_value,options:a}),z}return Oe(e.data)}get enum(){return this._def.values}}zo.create=(s,e)=>new zo({values:s,typeName:q.ZodNativeEnum,...W(e)});class Yr extends Q{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==R.promise&&t.common.async===!1)return A(t,{code:k.invalid_type,expected:R.promise,received:t.parsedType}),z;const r=t.parsedType===R.promise?t.data:Promise.resolve(t.data);return Oe(r.then(a=>this._def.type.parseAsync(a,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Yr.create=(s,e)=>new Yr({type:s,typeName:q.ZodPromise,...W(e)});class rs extends Q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===q.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:o=>{A(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return z;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?z:c.status==="dirty"||t.value==="dirty"?Ss(c.value):c});{if(t.value==="aborted")return z;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?z:l.status==="dirty"||t.value==="dirty"?Ss(l.value):l}}if(a.type==="refinement"){const o=l=>{const c=a.refinement(l,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?z:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?z:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(a.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ts(o))return z;const l=a.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>ts(o)?Promise.resolve(a.transform(o.value,i)).then(l=>({status:t.value,value:l})):z);X.assertNever(a)}}rs.create=(s,e,t)=>new rs({schema:s,typeName:q.ZodEffects,effect:e,...W(t)});rs.createWithPreprocess=(s,e,t)=>new rs({schema:e,effect:{type:"preprocess",transform:s},typeName:q.ZodEffects,...W(t)});class mt extends Q{_parse(e){return this._getType(e)===R.undefined?Oe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}mt.create=(s,e)=>new mt({innerType:s,typeName:q.ZodOptional,...W(e)});class ns extends Q{_parse(e){return this._getType(e)===R.null?Oe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ns.create=(s,e)=>new ns({innerType:s,typeName:q.ZodNullable,...W(e)});class oa extends Q{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===R.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}oa.create=(s,e)=>new oa({innerType:s,typeName:q.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...W(e)});class la extends Q{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Kr(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new at(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new at(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}la.create=(s,e)=>new la({innerType:s,typeName:q.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...W(e)});class qo extends Q{_parse(e){if(this._getType(e)!==R.nan){const r=this._getOrReturnCtx(e);return A(r,{code:k.invalid_type,expected:R.nan,received:r.parsedType}),z}return{status:"valid",value:e.data}}}qo.create=s=>new qo({typeName:q.ZodNaN,...W(s)});class Jp extends Q{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class xi extends Q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?z:i.status==="dirty"?(t.dirty(),Ss(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?z:a.status==="dirty"?(t.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,t){return new xi({in:e,out:t,typeName:q.ZodPipeline})}}class ca extends Q{_parse(e){const t=this._def.innerType._parse(e),r=a=>(ts(a)&&(a.value=Object.freeze(a.value)),a);return Kr(t)?t.then(a=>r(a)):r(t)}unwrap(){return this._def.innerType}}ca.create=(s,e)=>new ca({innerType:s,typeName:q.ZodReadonly,...W(e)});ce.lazycreate;var q;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(q||(q={}));const Wo=ft.create;xt.create;qe.create;const Yp=ce.create;ce.strictCreate;Zr.create;Jr.create;Ut.create;const Ho=ss.create;Yr.create;mt.create;ns.create;const Qp=Yp({MODE:Ho(["development","production","test"]),VITE_API_BASE:Wo().optional(),VITE_IMAGES_FEATURE_FLAG:Wo().optional(),VITE_IMAGES_PROVIDER:Ho(["none","pexels","unsplash"]).default("none")}),Xp=Qp.parse({MODE:"production",VITE_API_BASE:"/api",VITE_IMAGES_FEATURE_FLAG:{}.VITE_IMAGES_FEATURE_FLAG,VITE_IMAGES_PROVIDER:{}.VITE_IMAGES_PROVIDER}),xe={...Xp,DEV:!1,PROD:!0,SSR:!1,VITE_SUPABASE_URL:"https://auth.fanclubz.app",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlodG5zeWhrbnZsdGdya3NmZnVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM2NzA2MzYsImV4cCI6MjA2OTI0NjYzNn0.ZmoZ5cGVHfhDwTvkmaw9LSVHm_awoyMOTyQKewr7rYo",VITE_FRONTEND_URL:"http://localhost:5174",VITE_FCZ_UNIFIED_HEADER:{}.VITE_FCZ_UNIFIED_HEADER,VITE_FCZ_DISCOVER_V2:{}.VITE_FCZ_DISCOVER_V2,VITE_FCZ_PREDICTION_DETAILS_V2:{}.VITE_FCZ_PREDICTION_DETAILS_V2,VITE_FCZ_SHARED_CARDS:{}.VITE_FCZ_SHARED_CARDS,VITE_FCZ_AUTH_GATE:{}.VITE_FCZ_AUTH_GATE,VITE_FCZ_COMMENTS_V2:{}.VITE_FCZ_COMMENTS_V2,VITE_FCZ_UNIFIED_CARDS:"1",VITE_FCZ_COMMENTS_SORT:{}.VITE_FCZ_COMMENTS_SORT,VITE_DEBUG:{}.VITE_DEBUG,VITE_VAPID_PUBLIC_KEY:{}.VITE_VAPID_PUBLIC_KEY,VITE_ESCROW_CONTRACT_ADDRESS:{}.VITE_ESCROW_CONTRACT_ADDRESS,VITE_GOOGLE_ANALYTICS_ID:{}.VITE_GOOGLE_ANALYTICS_ID},yi=xe.DEV,Qr=xe.PROD,qc=xe.MODE,Ar=xe.VITE_API_BASE,Wc=xe.VITE_SUPABASE_URL,Hc=xe.VITE_SUPABASE_ANON_KEY,Xs=xe.VITE_FRONTEND_URL,Kc=xe.VITE_FCZ_UNIFIED_HEADER==="1",eg=xe.VITE_FCZ_DISCOVER_V2==="1",tg=xe.VITE_FCZ_PREDICTION_DETAILS_V2==="1",sg=xe.VITE_FCZ_SHARED_CARDS==="1",rg=xe.VITE_FCZ_AUTH_GATE==="1",ng=xe.VITE_FCZ_COMMENTS_V2==="1",ag=xe.VITE_FCZ_UNIFIED_CARDS==="1",ig=xe.VITE_FCZ_COMMENTS_SORT==="1",og=xe.VITE_DEBUG==="true",Gc=xe.VITE_VAPID_PUBLIC_KEY,lg=xe.VITE_ESCROW_CONTRACT_ADDRESS,cg=xe.VITE_GOOGLE_ANALYTICS_ID;function fs(){const s=window.location.hostname,e=window.location.protocol,t=typeof window<"u"&&!!nt?.isNativePlatform?.(),r="https://fan-club-z.onrender.com";if(s==="app.fanclubz.app"||s==="fanclubz.app"||s==="www.fanclubz.app")return{apiUrl:r,socketUrl:r,environment:"production",isDevelopment:!1,isProduction:!0};if(s==="dev.fanclubz.app")return{apiUrl:"https://fan-club-z.onrender.com",socketUrl:"https://fan-club-z.onrender.com",environment:"staging",isDevelopment:!1,isProduction:!1};if(s.includes("vercel.app"))return{apiUrl:r,socketUrl:r,environment:"production",isDevelopment:!1,isProduction:!0};if(t&&!yi)return{apiUrl:r,socketUrl:r,environment:"production",isDevelopment:!1,isProduction:!0};if(qc==="development"){const o=s==="localhost"||s.startsWith("127.")?"localhost":s,l=`${e}//${o}:3001`;return{apiUrl:l,socketUrl:l,environment:"development",isDevelopment:!0,isProduction:!1}}return Ar?{apiUrl:Ar,socketUrl:Ar,environment:"production",isDevelopment:!Qr,isProduction:Qr}:!t&&(s==="localhost"||s.startsWith("127.0.0.1")||s.startsWith("192.168."))?{apiUrl:"http://localhost:3001",socketUrl:"http://localhost:3001",environment:"development",isDevelopment:!0,isProduction:!1}:{apiUrl:r,socketUrl:r,environment:"production",isDevelopment:!1,isProduction:!0}}function wi(){return fs().apiUrl}function Zc(){return fs().socketUrl}function dg(){return fs().isDevelopment}function ug(){return fs().isProduction}const Jv=Object.freeze(Object.defineProperty({__proto__:null,API_BASE:Ar,DEBUG_ENABLED:og,ESCROW_CONTRACT_ADDRESS:lg,FCZ_AUTH_GATE:rg,FCZ_COMMENTS_SORT:ig,FCZ_COMMENTS_V2:ng,FCZ_DISCOVER_V2:eg,FCZ_PREDICTION_DETAILS_V2:tg,FCZ_SHARED_CARDS:sg,FCZ_UNIFIED_CARDS:ag,FCZ_UNIFIED_HEADER:Kc,FRONTEND_URL:Xs,GOOGLE_ANALYTICS_ID:cg,SUPABASE_ANON_KEY:Hc,SUPABASE_URL:Wc,VAPID_PUBLIC_KEY:Gc,getApiUrl:wi,getEnvironmentConfig:fs,getSocketUrl:Zc,isDev:yi,isDevelopment:dg,isProd:Qr,isProduction:ug,mode:qc},Symbol.toStringTag,{value:"Module"})),hg=Wc,fg=Hc,dn=()=>{if(typeof window>"u")return!1;const s=!!nt?.isNativePlatform?.(),e=nt?.getPlatform?.()!=="web";return s||e};function da(s){const e=i=>{if(!s)return i;const o=i.includes("?")?"&":"?";return`${i}${o}next=${encodeURIComponent(s)}`};if(dn())return e("fanclubz://auth/callback");if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"){const o=`${window.location.origin}/auth/callback`;return e(o)}return{}.VITE_AUTH_REDIRECT_URL?e({}.VITE_AUTH_REDIRECT_URL):e("https://app.fanclubz.app/auth/callback")}const Ko=s=>da(s);let Go=null;const Jc=async()=>{if(!dn()||Go)return;Go=await jp.addListener("appUrlOpen",async({url:e})=>{try{const t=e&&e.startsWith("fanclubz://auth/callback"),r=e&&(e.includes("app.fanclubz.app/auth/callback")||e.includes("localhost/auth/callback")||e.includes("127.0.0.1/auth/callback"));if(!t&&!r)return;if(await Fc.close().catch(i=>{}),t){let i=null,o=null;try{const l=new URL(e.replace("fanclubz://","https://"));i=l.searchParams.get("code"),o=l.searchParams.get("state")}catch{}if(i)try{const{data:l,error:c}=await V.auth.exchangeCodeForSession(i);c||l?.session}catch{}}window.dispatchEvent(new CustomEvent("auth-in-progress",{detail:{started:!1,completed:!0}}));const a="/auth/callback"+(e.includes("?")?e.substring(e.indexOf("?")):"");window.location.href=a}catch{}})},mg=()=>{if(!(typeof window>"u"))try{return window.localStorage}catch{return}},ua={auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},db:{schema:"public"},global:{headers:{"X-Client-Info":"fanclubz-web@1.0.0"}}},Zo=mg();Zo&&(ua.auth={...ua.auth,storage:Zo,storageKey:"fcz-auth-storage"});const ha=globalThis,V=ha.__fanclubzSupabase??up(hg,fg,ua);ha.__fanclubzSupabase||(ha.__fanclubzSupabase=V);const ks={signUp:async(s,e,t={})=>{try{const{data:r,error:a}=await V.auth.signUp({email:s,password:e,options:{data:t,emailRedirectTo:da()}});return{data:r,error:a}}catch(r){return{data:null,error:{message:r.message||"An unexpected error occurred"}}}},signIn:async(s,e)=>{try{const{data:t,error:r}=await V.auth.signInWithPassword({email:s,password:e});return{data:t,error:r}}catch(t){return{data:null,error:{message:t.message||"An unexpected error occurred"}}}},signInWithOAuth:async(s,e)=>{const t=dn();t&&await Jc();try{const r=da(e?.next);t&&window.dispatchEvent(new CustomEvent("auth-in-progress",{detail:{started:!0}}));const{data:a,error:i}=await V.auth.signInWithOAuth({provider:s,options:{redirectTo:r,skipBrowserRedirect:t,queryParams:{access_type:"offline",prompt:"consent"}}});return i?t&&window.dispatchEvent(new CustomEvent("auth-in-progress",{detail:{started:!1,error:!0}})):t&&a?.url&&await Fc.open({url:a.url,presentationStyle:"fullscreen"}),{data:a,error:i}}catch(r){return t&&window.dispatchEvent(new CustomEvent("auth-in-progress",{detail:{started:!1,error:!0}})),{data:null,error:{message:r.message||"An unexpected error occurred"}}}},signOut:async()=>{try{const{error:s}=await V.auth.signOut();return{error:s}}catch(s){return{error:{message:s.message||"An unexpected error occurred"}}}},getCurrentUser:async()=>{try{const{data:{user:s},error:e}=await V.auth.getUser();return{user:s,error:e}}catch(s){return{user:null,error:{message:s.message||"An unexpected error occurred"}}}},onAuthStateChange:s=>V.auth.onAuthStateChange(s)},pg={predictions:{async getAll(s={}){try{let e=V.from("predictions").select(`
            *,
            creator:users!creator_id(id, username, full_name, avatar_url),
            options:prediction_options!prediction_options_prediction_id_fkey(*),
          `);s.category&&(e=e.eq("category",s.category)),s.status&&(e=e.eq("status",s.status)),s.search&&(e=e.or(`title.ilike.%${s.search}%,description.ilike.%${s.search}%`));const{data:t,error:r}=await e.order("created_at",{ascending:!1}).limit(s.limit||20);return r&&!r.message.includes("relation")&&r.message.includes("does not exist"),{data:t,error:r}}catch(e){return{data:null,error:{message:e.message||"An unexpected error occurred"}}}},async getById(s){try{const{data:e,error:t}=await V.from("predictions").select(`
            *,
            creator:users!creator_id(id, username, full_name, avatar_url),
            options:prediction_options!prediction_options_prediction_id_fkey(*),
          `).eq("id",s).single();return t&&!t.message.includes("relation")&&t.message.includes("does not exist"),{data:e,error:t}}catch(e){return{data:null,error:{message:e.message||"An unexpected error occurred"}}}},async create(s){try{const{data:e,error:t}=await V.from("predictions").insert(s).select().single();return{data:e,error:t}}catch(e){return{data:null,error:{message:e.message||"An unexpected error occurred"}}}}},users:{async getProfile(s){try{const{data:e,error:t}=await V.from("users").select("*").eq("id",s).single();return t&&!t.message.includes("relation")&&t.message.includes("does not exist"),{data:e,error:t}}catch(e){return{data:null,error:{message:e.message||"An unexpected error occurred"}}}},async updateProfile(s,e){try{const{data:t,error:r}=await V.from("users").update(e).eq("id",s).select().single();return{data:t,error:r}}catch(t){return{data:null,error:{message:t.message||"An unexpected error occurred"}}}}},wallets:{async getBalance(s,e="NGN"){try{const{data:t,error:r}=await V.from("wallets").select("*").eq("user_id",s).eq("currency",e).single();return r&&!r.message.includes("relation")&&r.message.includes("does not exist"),{data:t,error:r}}catch(t){return{data:null,error:{message:t.message||"An unexpected error occurred"}}}},async getTransactions(s,e=20){try{const{data:t,error:r}=await V.from("wallet_transactions").select("*").eq("user_id",s).order("created_at",{ascending:!1}).limit(e);return r&&!r.message.includes("relation")&&r.message.includes("does not exist"),{data:t,error:r}}catch(t){return{data:null,error:{message:t.message||"An unexpected error occurred"}}}}},comments:{async getByPredictionId(s,e=20){try{const{data:t,error:r}=await V.from("comments").select(`
            *,
            user:users(id, username, full_name, avatar_url)
          `).eq("prediction_id",s).is("parent_comment_id",null).order("created_at",{ascending:!1}).limit(e);return r&&!r.message.includes("relation")&&r.message.includes("does not exist"),{data:t,error:r}}catch(t){return{data:null,error:{message:t.message||"An unexpected error occurred"}}}},async create(s){try{const{data:e,error:t}=await V.from("comments").insert(s).select(`
            *,
            user:users(id, username, full_name, avatar_url)
          `).single();return{data:e,error:t}}catch(e){return{data:null,error:{message:e.message||"An unexpected error occurred"}}}}}};dn()&&Jc();const gg=os()((s,e)=>({balances:[],transactions:[],isLoading:!1,error:null,walletSummary:null,get balance(){return e().balances.find(a=>a.currency==="USD")?.available||0},get totalBalance(){return e().balances.find(a=>a.currency==="USD")?.total||0},get reservedBalance(){return e().balances.find(a=>a.currency==="USD")?.reserved||0},initializeWallet:async()=>{s({balances:[],transactions:[],isLoading:!1,error:null})},refreshWalletData:async()=>{await e().initializeWallet()},lockFunds:async(t,r="USD")=>{try{if(isNaN(t)||t<=0)throw new Error("Please enter a valid amount");const i=e().balances.find(d=>d.currency===r);if(!i||i.available<t)throw new Error("Insufficient funds");const o=i.available-t,l=i.reserved+t,c={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"bet_lock",amount:t,description:"Funds locked for prediction",date:new Date,status:"completed",reference:`LOCK_${Date.now()}`,currency:r,fee:0};s(d=>({balances:d.balances.map(u=>u.currency===r?{...u,available:o,reserved:l,total:o+l}:u),transactions:[c,...d.transactions],error:null}));try{const{data:{user:d}}=await V.auth.getUser();d&&(await V.from("wallets").upsert({user_id:d.id,currency:r,available_balance:o,reserved_balance:l,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:d.id,type:c.type,currency:c.currency,amount:c.amount,status:c.status,reference:c.reference,description:c.description,created_at:new Date().toISOString()}))}catch{}}catch(a){const i=a instanceof Error?a.message:"Failed to lock funds";throw s({error:i}),a}},addFunds:async(t,r="USD",a="Bank Transfer")=>{s({isLoading:!0,error:null});try{if(isNaN(t)||t<=0)throw new Error("Please enter a valid amount");const o=e().balances.find(u=>u.currency===r),l=(o?.available||0)+t,c=l+(o?.reserved||0),d={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"deposit",amount:t,description:`${a} Deposit`,date:new Date,status:"completed",reference:`DEP_${Date.now()}`,currency:r,fee:0};s(u=>({balances:u.balances.map(h=>h.currency===r?{...h,available:l,total:c}:h),transactions:[d,...u.transactions],isLoading:!1,error:null}));try{const{data:{user:u}}=await V.auth.getUser();u&&(await V.from("wallets").upsert({user_id:u.id,currency:r,available_balance:l,reserved_balance:o?.reserved||0,total_deposited:(o?.available||0)+t,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:u.id,type:d.type,currency:d.currency,amount:d.amount,status:d.status,reference:d.reference,description:d.description,created_at:new Date().toISOString()}))}catch{}return d}catch(i){const o=i instanceof Error?i.message:"Failed to add funds";throw s({isLoading:!1,error:o}),i}},withdraw:async(t,r="USD",a="Bank Account")=>{s({isLoading:!0,error:null});try{if(isNaN(t)||t<=0)throw new Error("Please enter a valid amount");const o=e().balances.find(u=>u.currency===r);if(!o||o.available<t)throw new Error("Insufficient funds");const l=o.available-t,c=l+o.reserved,d={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"withdraw",amount:t,description:`Withdrawal to ${a}`,date:new Date,status:"completed",reference:`WTH_${Date.now()}`,currency:r,fee:0};s(u=>({balances:u.balances.map(h=>h.currency===r?{...h,available:l,total:c}:h),transactions:[d,...u.transactions],isLoading:!1,error:null}));try{const{data:{user:u}}=await V.auth.getUser();u&&(await V.from("wallets").upsert({user_id:u.id,currency:r,available_balance:l,reserved_balance:o.reserved,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:u.id,type:d.type,currency:d.currency,amount:d.amount,status:d.status,reference:d.reference,description:d.description,created_at:new Date().toISOString()}))}catch{}return d}catch(i){const o=i instanceof Error?i.message:"Failed to withdraw funds";throw s({isLoading:!1,error:o}),i}},makePrediction:async(t,r,a,i="USD")=>{s({isLoading:!0,error:null});try{if(isNaN(t)||t<=0)throw new Error("Please enter a valid amount");const l=e().balances.find(f=>f.currency===i);if(!l||l.available<t)throw new Error("Insufficient funds");const c=l.available-t,d=l.reserved+t,u=c+d,h={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"bet_lock",amount:t,description:r,date:new Date,status:"completed",reference:`PRED_${Date.now()}`,currency:i,fee:0,predictionId:a};s(f=>({balances:f.balances.map(p=>p.currency===i?{...p,available:c,reserved:d,total:u}:p),transactions:[h,...f.transactions],isLoading:!1,error:null}));try{const{data:{user:f}}=await V.auth.getUser();f&&(await V.from("wallets").upsert({user_id:f.id,currency:i,available_balance:c,reserved_balance:d,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:f.id,type:h.type,currency:h.currency,amount:h.amount,status:h.status,reference:h.reference,description:h.description,created_at:new Date().toISOString()}))}catch{}return h}catch(o){const l=o instanceof Error?o.message:"Failed to make prediction";throw s({isLoading:!1,error:l}),o}},recordWin:async(t,r,a,i="USD")=>{s({isLoading:!0,error:null});try{const l=e().balances.find(f=>f.currency===i),c=(l?.available||0)+t,d=Math.max(0,(l?.reserved||0)-t),u=c+d,h={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"win",amount:t,description:r,date:new Date,status:"completed",reference:`WIN_${Date.now()}`,currency:i,fee:0,predictionId:a};s(f=>({balances:f.balances.map(p=>p.currency===i?{...p,available:c,reserved:d,total:u}:p),transactions:[h,...f.transactions],isLoading:!1,error:null}));try{const{data:{user:f}}=await V.auth.getUser();f&&(await V.from("wallets").upsert({user_id:f.id,currency:i,available_balance:c,reserved_balance:d,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:f.id,type:"bet_release",currency:h.currency,amount:h.amount,status:h.status,reference:h.reference,description:h.description,prediction_id:a,created_at:new Date().toISOString()}))}catch{}return h}catch(o){const l=o instanceof Error?o.message:"Failed to record win";throw s({isLoading:!1,error:l}),o}},recordLoss:async(t,r,a,i="USD")=>{s({isLoading:!0,error:null});try{const l=e().balances.find(h=>h.currency===i),c=Math.max(0,(l?.reserved||0)-t),d=(l?.available||0)+c,u={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"loss",amount:t,description:r,date:new Date,status:"completed",reference:`LOSS_${Date.now()}`,currency:i,fee:0,predictionId:a};s(h=>({balances:h.balances.map(f=>f.currency===i?{...f,reserved:c,total:d}:f),transactions:[u,...h.transactions],isLoading:!1,error:null}));try{const{data:{user:h}}=await V.auth.getUser();h&&(await V.from("wallets").upsert({user_id:h.id,currency:i,available_balance:l?.available||0,reserved_balance:c,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:h.id,type:"loss",currency:u.currency,amount:u.amount,status:u.status,reference:u.reference,description:u.description,prediction_id:a,created_at:new Date().toISOString()}))}catch{}return u}catch(o){const l=o instanceof Error?o.message:"Failed to record loss";throw s({isLoading:!1,error:l}),o}},transferFunds:async(t,r,a,i="USD")=>{s({isLoading:!0,error:null});try{if(isNaN(t)||t<=0)throw new Error("Please enter a valid amount");const l=e().balances.find(h=>h.currency===i);if(!l||l.available<t)throw new Error("Insufficient funds");const c=l.available-t,d=c+l.reserved,u={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"transfer_out",amount:t,description:a||`Transfer to ${r}`,date:new Date,status:"completed",reference:`TRF_${Date.now()}`,currency:i,fee:0,toUser:r};s(h=>({balances:h.balances.map(f=>f.currency===i?{...f,available:c,total:d}:f),transactions:[u,...h.transactions],isLoading:!1,error:null}));try{const{data:{user:h}}=await V.auth.getUser();h&&(await V.from("wallets").upsert({user_id:h.id,currency:i,available_balance:c,reserved_balance:l.reserved,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"}),await V.from("wallet_transactions").insert({user_id:h.id,type:u.type,currency:u.currency,amount:u.amount,status:u.status,reference:u.reference,description:u.description,to_user:r,created_at:new Date().toISOString()}))}catch{}return u}catch(o){const l=o instanceof Error?o.message:"Failed to transfer funds";throw s({isLoading:!1,error:l}),o}},getBalance:(t="USD")=>e().balances.find(i=>i.currency===t)?.available||0,getTransactionHistory:t=>{let a=[...e().transactions];return t?.type&&(a=a.filter(i=>i.type===t.type)),t?.currency&&(a=a.filter(i=>i.currency===t.currency)),t?.limit&&(a=a.slice(0,t.limit)),a},clearError:()=>{s({error:null})}})),fa=new Map,xr=s=>{const e=fa.get(s);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},xg=(s,e,t)=>{if(s===void 0)return{type:"untracked",connection:e.connect(t)};const r=fa.get(t.name);if(r)return{type:"tracked",store:s,...r};const a={connection:e.connect(t),stores:{}};return fa.set(t.name,a),{type:"tracked",store:s,...a}},yg=(s,e={})=>(t,r,a)=>{const{enabled:i,anonymousActionType:o,store:l,...c}=e;let d;try{d=(i??!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return s(t,r,a);const{connection:u,...h}=xg(l,d,c);let f=!0;a.setState=(g,y,b)=>{const v=t(g,y);if(!f)return v;const x=b===void 0?{type:o||"anonymous"}:typeof b=="string"?{type:b}:b;return l===void 0?(u?.send(x,r()),v):(u?.send({...x,type:`${l}/${x.type}`},{...xr(c.name),[l]:a.getState()}),v)};const p=(...g)=>{const y=f;f=!1,t(...g),f=y},w=s(a.setState,r,a);if(h.type==="untracked"?u?.init(w):(h.stores[h.store]=a,u?.init(Object.fromEntries(Object.entries(h.stores).map(([g,y])=>[g,g===h.store?w:y.getState()])))),a.dispatchFromDevtools&&typeof a.dispatch=="function"){let g=!1;const y=a.dispatch;a.dispatch=(...b)=>{y(...b)}}return u.subscribe(g=>{var y;switch(g.type){case"ACTION":return typeof g.payload!="string"?void 0:Ln(g.payload,b=>{if(b.type==="__setState"){if(l===void 0){p(b.state);return}Object.keys(b.state).length;const v=b.state[l];if(v==null)return;JSON.stringify(a.getState())!==JSON.stringify(v)&&p(v);return}a.dispatchFromDevtools&&typeof a.dispatch=="function"&&a.dispatch(b)});case"DISPATCH":switch(g.payload.type){case"RESET":return p(w),l===void 0?u?.init(a.getState()):u?.init(xr(c.name));case"COMMIT":if(l===void 0){u?.init(a.getState());return}return u?.init(xr(c.name));case"ROLLBACK":return Ln(g.state,b=>{if(l===void 0){p(b),u?.init(a.getState());return}p(b[l]),u?.init(xr(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Ln(g.state,b=>{if(l===void 0){p(b);return}JSON.stringify(a.getState())!==JSON.stringify(b[l])&&p(b[l])});case"IMPORT_STATE":{const{nextLiftedState:b}=g.payload,v=(y=b.computedStates.slice(-1)[0])==null?void 0:y.state;if(!v)return;p(l===void 0?v:v[l]),u?.send(null,b);return}case"PAUSE_RECORDING":return f=!f}return}}),w},Yv=yg,Ln=(s,e)=>{let t;try{t=JSON.parse(s)}catch{}t!==void 0&&e(t)};function Yc(s,e){let t;try{t=s()}catch{return}return{getItem:a=>{var i;const o=c=>c===null?null:JSON.parse(c,e?.reviver),l=(i=t.getItem(a))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(a,i)=>t.setItem(a,JSON.stringify(i,e?.replacer)),removeItem:a=>t.removeItem(a)}}const zs=s=>e=>{try{const t=s(e);return t instanceof Promise?t:{then(r){return zs(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return zs(r)(t)}}}},wg=(s,e)=>(t,r,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,b)=>({...b,...y}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return s((...y)=>{t(...y)},r,a);const u=zs(i.serialize),h=()=>{const y=i.partialize({...r()});let b;const v=u({state:y,version:i.version}).then(x=>d.setItem(i.name,x)).catch(x=>{b=x});if(b)throw b;return v},f=a.setState;a.setState=(y,b)=>{f(y,b),h()};const p=s((...y)=>{t(...y),h()},r,a);let w;const g=()=>{var y;if(!d)return;o=!1,l.forEach(v=>v(r()));const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,r()))||void 0;return zs(d.getItem.bind(d))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version)}else return v.state}).then(v=>{var x;return w=i.merge(v,(x=r())!=null?x:p),t(w,!0),h()}).then(()=>{b?.(w,void 0),o=!0,c.forEach(v=>v(w))}).catch(v=>{b?.(void 0,v)})};return a.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(d=y.getStorage())},clearStorage:()=>{d?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:y=>(l.add(y),()=>{l.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},g(),w||p},bg=(s,e)=>(t,r,a)=>{let i={storage:Yc(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...e},o=!1;const l=new Set,c=new Set;let d=i.storage;if(!d)return s((...g)=>{t(...g)},r,a);const u=()=>{const g=i.partialize({...r()});return d.setItem(i.name,{state:g,version:i.version})},h=a.setState;a.setState=(g,y)=>{h(g,y),u()};const f=s((...g)=>{t(...g),u()},r,a);a.getInitialState=()=>f;let p;const w=()=>{var g,y;if(!d)return;o=!1,l.forEach(v=>{var x;return v((x=r())!=null?x:f)});const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(g=r())!=null?g:f))||void 0;return zs(d.getItem.bind(d))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)]}else return[!1,v.state];return[!1,void 0]}).then(v=>{var x;const[_,j]=v;if(p=i.merge(j,(x=r())!=null?x:f),t(p,!0),_)return u()}).then(()=>{b?.(p,void 0),p=r(),o=!0,c.forEach(v=>v(p))}).catch(v=>{b?.(void 0,v)})};return a.persist={setOptions:g=>{i={...i,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:g=>(l.add(g),()=>{l.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||w(),p||f},vg=(s,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?wg(s,e):bg(s,e),bi=vg,vi=os()(bi((s,e)=>({notifications:[],unreadCount:0,toasts:[],settings:{predictionOutcomes:!0,comments:!0,marketClosing:!0,payouts:!0,pushNotifications:!0,emailNotifications:!1,frequency:"immediate"},addNotification:t=>{const r={...t,id:crypto.randomUUID(),createdAt:new Date().toISOString(),read:!1};s(a=>({notifications:[r,...a.notifications],unreadCount:a.unreadCount+1})),["prediction_outcome","payout"].includes(r.type)&&e().addToast({type:"success",title:r.title,message:r.message,duration:5e3}),e().settings.pushNotifications&&e().sendPushNotification(r)},markAsRead:t=>{s(r=>({notifications:r.notifications.map(a=>a.id===t?{...a,read:!0}:a),unreadCount:Math.max(0,r.unreadCount-1)}))},markAllAsRead:()=>{s(t=>({notifications:t.notifications.map(r=>({...r,read:!0})),unreadCount:0}))},deleteNotification:t=>{s(r=>{const a=r.notifications.find(o=>o.id===t),i=a&&!a.read;return{notifications:r.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,r.unreadCount-1):r.unreadCount}})},clearAllNotifications:()=>{s({notifications:[],unreadCount:0})},updateSettings:t=>{s(r=>({settings:{...r.settings,...t}}))},addToast:t=>{const r={...t,id:crypto.randomUUID()};s(a=>({toasts:[...a.toasts,r]}))},removeToast:t=>{s(r=>({toasts:r.toasts.filter(a=>a.id!==t)}))},clearToasts:()=>{s({toasts:[]})},requestPermission:async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:!1,subscribeToPush:async()=>{if(!await e().requestPermission())throw new Error("Notification permission denied");s(r=>({settings:{...r.settings,pushNotifications:!0}}))},unsubscribeFromPush:async()=>{s(t=>({settings:{...t.settings,pushNotifications:!1}}))},sendPushNotification:t=>{if(!("Notification"in window)||Notification.permission!=="granted")return;const r={body:t.message,icon:"/icon-192x192.png",badge:"/icon-badge.png",tag:t.id,renotify:!1},a=new Notification(t.title,r);a.onclick=()=>{window.focus(),a.close(),t.data?.predictionId&&(window.location.href=`/predictions/${t.data.predictionId}`)},setTimeout(()=>{a.close()},5e3)},notifySettlementReady:(t,r)=>{const{addNotification:a,addToast:i}=e();a({type:"settlement_ready",title:"Settlement Required",message:`"${r}" needs your validation. Tap to review the outcome.`,data:{predictionId:t,action:"validate_settlement"}}),i({type:"info",title:"âš–ï¸ Settlement Ready",message:`Tap to validate the outcome of "${r}"`,duration:8e3})},notifySettlementCompleted:(t,r,a,i)=>{const{addNotification:o,addToast:l}=e(),c=a==="won"?`You won ${i?`$${i}`:""} on "${r}"!`:`Settlement completed for "${r}". Better luck next time!`;o({type:"settlement_completed",title:a==="won"?"You Won!":"Settlement Complete",message:c,data:{predictionId:t,outcome:a,payout:i}}),l({type:a==="won"?"success":"info",title:a==="won"?"ðŸŽ‰ You Won!":"ðŸ“‹ Settlement Complete",message:c,duration:a==="won"?1e4:6e3})},showSuccess:(t,r)=>{e().addToast({type:"success",title:r||"Success",message:t,duration:3e3})},showError:(t,r)=>{e().addToast({type:"error",title:r||"Error",message:t,duration:5e3})}}),{name:"fanclubz-notifications",partialize:s=>({notifications:s.notifications,settings:s.settings})})),St=(s,e)=>{vi.getState().addToast({type:"success",title:e||"Success",message:s,duration:3e3})},Me=(s,e)=>{vi.getState().addToast({type:"error",title:e||"Error",message:s,duration:5e3})},ma="auth:returnTo",qs=s=>{try{const e=s??`${window.location.pathname}${window.location.search}${window.location.hash}`;sessionStorage.setItem(ma,e)}catch{}},Qv=()=>{try{const s=sessionStorage.getItem(ma);return sessionStorage.removeItem(ma),s}catch{return null}},Xv=s=>{if(!s)return"/";try{const e=new URL(s,window.location.origin);return e.origin!==window.location.origin?"/":e.pathname+e.search+e.hash}catch{}return s.startsWith("/")?s:"/"},Ht=async s=>{try{const{data:e,error:t}=await V.from("users").select("og_badge, og_badge_assigned_at, og_badge_member_number, referral_code, username, full_name, avatar_url").eq("id",s).single();return t||!e?{}:{og_badge:e.og_badge,og_badge_assigned_at:e.og_badge_assigned_at,og_badge_member_number:e.og_badge_member_number,referral_code:e.referral_code,username:e.username||void 0,full_name:e.full_name||void 0,avatar_url:e.avatar_url||void 0}}catch{return{}}},Ct=(s,e)=>{if(!s)return null;const t=s.user_metadata||{},r=s.app_metadata||{};let a="",i="",o="";if(t.full_name){const d=t.full_name.split(" ");a=d[0]||"",i=d.slice(1).join(" ")||""}else a=t.firstName||t.first_name||t.given_name||"User",i=t.lastName||t.last_name||t.family_name||"";t.avatar_url?o=t.avatar_url:t.picture?o=t.picture:t.photo&&(o=t.photo);const l=t.username||t.preferred_username||t.full_name||s.email?.split("@")[0]||"",c=t.full_name||`${a} ${i}`.trim();return{id:s.id,email:s.email||"",firstName:a,lastName:i,phone:s.phone,avatar:e?.avatar_url||o,avatar_url:e?.avatar_url||o,provider:r.provider||"email",bio:t.bio,totalEarnings:t.totalEarnings||0,totalInvested:t.totalInvested||0,winRate:t.winRate||0,activePredictions:t.activePredictions||0,totalPredictions:t.totalPredictions||0,rank:t.rank||0,level:t.level||"New Predictor",createdAt:s.created_at||new Date().toISOString(),username:e?.username||l,full_name:e?.full_name||c,is_verified:!!(t.is_verified||t.verified),og_badge:e?.og_badge||null,og_badge_assigned_at:e?.og_badge_assigned_at||null,og_badge_member_number:e?.og_badge_member_number||null,referral_code:e?.referral_code||null}};let Jo=!1,Dn=!1,Yo="",Qo="",Xo=0;const _g=5e3,J=os()(bi((s,e)=>({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!1,lastAuthCheck:0,initializeAuth:async()=>{const t=e(),r=Date.now();if(!Dn&&!(t.initialized&&r-t.lastAuthCheck<3e4)){if(t.isAuthenticated&&t.user&&t.token&&r-t.lastAuthCheck<3e5){s({loading:!1,initialized:!0,lastAuthCheck:r});return}if(!t.loading){Dn=!0,s({loading:!0,lastAuthCheck:r});try{const{data:{session:a},error:i}=await V.auth.getSession();if(i){s({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:r});return}if(a?.user){const o=await Ht(a.user.id),l=Ct(a.user,o);s({isAuthenticated:!0,user:l,token:a.access_token,loading:!1,initialized:!0,lastAuthCheck:r})}else s({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:r})}catch{s({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:r})}finally{Dn=!1}}}},login:async(t,r)=>{s({loading:!0});try{const{data:a,error:i}=await ks.signIn(t,r);if(i){let c="Login failed. Please check your credentials.";throw i.message.includes("Invalid login credentials")?c="Invalid email or password. Please try again.":i.message.includes("Email not confirmed")&&(c="Please check your email and click the confirmation link."),s({loading:!1}),Me(c),new Error(c)}const o=a?.user,l=a?.session;if(o&&l){const c=await Ht(o.id),d=Ct(o,c);s({isAuthenticated:!0,user:d,token:l.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),St(`Welcome back, ${d?.firstName}!`)}}catch(a){throw s({loading:!1}),a}},register:async(t,r,a,i)=>{s({loading:!0});try{if(r.length<6)throw new Error("Password must be at least 6 characters long");const o={data:{firstName:a,lastName:i,first_name:a,last_name:i,full_name:`${a} ${i}`}},{data:l,error:c}=await ks.signUp(t,r,o);if(c){let u="Registration failed. Please try again.";throw c.message.includes("User already registered")?u="An account with this email already exists. Please sign in instead.":c.message.includes("Password should be at least")&&(u="Password must be at least 6 characters long."),s({loading:!1}),Me(u),new Error(u)}const d=l?.user;if(d){const u=await Ht(d.id),h=Ct(d,u);l?.session?(s({isAuthenticated:!0,user:h,token:l.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),St(`Welcome to Fan Club Z, ${h?.firstName}!`)):(s({isAuthenticated:!0,user:h,token:null,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),St(`Welcome to Fan Club Z, ${h?.firstName}! Please check your email to verify your account.`))}}catch(o){throw s({loading:!1}),o}},loginWithOAuth:async t=>{s({loading:!0});try{const r=`${window.location.pathname}${window.location.search}${window.location.hash}`;qs(r);const{data:a,error:i}=await ks.signInWithOAuth(t,{next:r});if(i)throw s({loading:!1}),Me(`${t} sign-in failed. Please try again.`),new Error(i.message)}catch(r){throw s({loading:!1}),r}},handleOAuthCallback:async()=>{try{const{data:t,error:r}=await V.auth.getSession();if(r)throw Me("Authentication failed. Please try again."),new Error(r.message);if(t.session?.user){const a=await Ht(t.session.user.id),i=Ct(t.session.user,a);s({isAuthenticated:!0,user:i,token:t.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()});const o=i?.provider||"email",l=o.charAt(0).toUpperCase()+o.slice(1);return St(`Welcome ${i?.firstName}! Signed in with ${l}.`),i}else throw new Error("No user session found after OAuth callback")}catch(t){throw s({loading:!1}),t}},logout:async()=>{s({loading:!0});try{const{error:t}=await ks.signOut();s({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:0}),St("Signed out successfully")}catch{s({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:0})}},updateProfile:async t=>{s({loading:!0});try{const r=e().user;if(!r)throw new Error("No user logged in");const{data:a,error:i}=await V.auth.updateUser({data:{firstName:t.firstName||r.firstName,lastName:t.lastName||r.lastName,bio:t.bio!==void 0?t.bio:r.bio}});if(i)throw new Error(i.message||"Failed to update profile");if(a?.user){const o=await Ht(a.user.id),l=Ct(a.user,o);try{const c=`${l?.firstName||""} ${l?.lastName||""}`.trim();if(c){const{getApiUrl:d}=await H(()=>Promise.resolve().then(()=>fd),void 0),u=d(),h=await fetch(`${u}/api/v2/users/${a.user.id}/profile`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:c})});if(!h.ok){const f=await h.json().catch(()=>({}))}}}catch{}s({user:l,loading:!1,lastAuthCheck:Date.now()}),St("Profile updated successfully!")}}catch(r){s({loading:!1});const a=typeof r?.message=="string"?r.message:"",i=a.toLowerCase().includes("failed to fetch")||a.toLowerCase().includes("network error");throw Me(i?"Network error while saving your profile. Please check your connection and try again.":a||"Failed to update profile. Please try again."),r}},uploadAvatar:async t=>{const r=e();if(!r.user)throw new Error("No user logged in");const a=r.user.id,i=t.name.split(".").pop()?.toLowerCase()||"jpg",o=`${a}/${Date.now()}.${i}`,{data:l,error:c}=await V.storage.from("avatars").upload(o,t,{cacheControl:"3600",upsert:!0,contentType:t.type});if(c){const y=(c.message||"").toLowerCase();throw y.includes("file size")||y.includes("too large")||y.includes("maximum allowed size")?Me("Image is too large. Please choose a file under 10 MB."):y.includes("mime")||y.includes("content-type")||y.includes("invalid file type")?Me("Invalid image type. Please upload a JPG, PNG, or GIF image."):Me("Failed to upload image. Please try again."),c}const{data:d}=V.storage.from("avatars").getPublicUrl(l.path),u=d.publicUrl,{data:h,error:f}=await V.auth.updateUser({data:{avatar_url:u}});if(f)throw Me("Failed to save avatar to profile."),f;await pg.users.updateProfile(a,{avatar_url:u});const p=await Ht(a),w=h?.user?Ct(h.user,p):null;return w&&s({user:w,lastAuthCheck:Date.now()}),St("Profile photo updated."),u}}),{name:"fanclubz-auth-storage",storage:Yc(()=>localStorage),partialize:s=>({isAuthenticated:s.isAuthenticated,user:s.user,token:s.token,initialized:s.initialized,lastAuthCheck:s.lastAuthCheck}),version:6}));typeof window<"u"&&!Jo&&(Jo=!0,V.auth.onAuthStateChange((s,e)=>{const t=Date.now(),r=e?.user?.id||"";if(`${s}:${r}`===`${Yo}:${Qo}`&&t-Xo<_g)return;Yo=s,Qo=r,Xo=t;const i=J.getState();if(s==="SIGNED_IN"&&e?.user){if(!i.isAuthenticated||i.user?.id!==e.user.id){const o=Ct(e.user);J.setState({isAuthenticated:!0,user:o,token:e.access_token,loading:!1,initialized:!0,lastAuthCheck:t})}}else s==="SIGNED_OUT"?J.setState({isAuthenticated:!1,user:null,token:null,lastAuthCheck:0}):s==="TOKEN_REFRESHED"&&e?.user&&i.isAuthenticated&&i.user?.id===e.user.id&&J.setState({token:e.access_token,lastAuthCheck:t})}));const el=()=>{},jg=[],Ng=()=>({initializeLikes:el,toggleLike:el,checkIfLiked:()=>!1,getLikeCount:()=>0,likes:jg}),_i={view_wallet:{title:"Sign in to FanClubZ",description:"See your balance, deposits, and transactions.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.view_wallet"},view_my_bets:{title:"Sign in to FanClubZ",description:"Track your predictions and manage your portfolio.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.view_my_bets"},edit_profile:{title:"Sign in to FanClubZ",description:"Customize your handle and avatar.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.edit_profile"},place_prediction:{title:"Sign in to FanClubZ",description:"Stake, share, and compete on the leaderboard.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.place_prediction"},create_prediction:{title:"Sign in to FanClubZ",description:"Create your own prediction and invite others to participate.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.create_prediction"},comment_prediction:{title:"Sign in to comment",description:"Join the discussion and share your take.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.comment_prediction"},like_prediction:{title:"Sign in to like predictions",description:"Save your favorites and get better recommendations.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.like_prediction"},add_funds:{title:"Sign in to add funds",description:"Securely top up your balance to start predicting.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.add_funds"},withdraw_funds:{title:"Sign in to withdraw funds",description:"For your security, we need to verify your account.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.withdraw_funds"},follow_creator:{title:"Follow creators you like",description:"Get alerts when your favorites make a move.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.follow_creator"},share_private:{title:"Share privately",description:"Keep your insights within your circle.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.share_private"},view_settlements:{title:"Sign in to view settlements",description:"See outcomes and claim rewards on resolved markets.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.view_settlements"}},Eg={title:"Sign in",description:"Continue to unlock this action.",primaryCta:"Continue with Google",secondaryCta:"Continue with Email",analyticsKey:"auth.fallback"};Object.entries(_i).reduce((s,[e,t])=>({...s,[e]:{key:e,title:t.title,description:t.description,primaryCta:"google",secondaryCta:"email_link",analyticsEvent:t.analyticsKey}}),{});const ji="fcz.pendingAuth",Sg="fcz.returnUrl";let Dt={isOpen:!1,pendingIntent:null,intentMeta:null,payload:void 0,resolver:null};const pa=new Set,kg=()=>{pa.forEach(s=>s())},Ni=s=>{Dt={...Dt,...s},kg()},Cg=(s,e)=>{try{sessionStorage.setItem(ji,JSON.stringify({intent:s,payload:e}));const t=window.location.pathname+window.location.search;sessionStorage.setItem(Sg,t)}catch{}},Tg=()=>{try{const s=sessionStorage.getItem(ji);if(s)return JSON.parse(s)}catch{}return null},Ag=()=>{const[,s]=m.useState({});return m.useEffect(()=>{const e=()=>s({});return pa.add(e),()=>{pa.delete(e)}},[]),{isOpen:Dt.isOpen,pendingIntent:Dt.pendingIntent,intentMeta:Dt.intentMeta,payload:Dt.payload}},Ei=s=>new Promise(e=>{const t=_i[s.intent],r=s.metaOverride?{...t,...s.metaOverride}:t;Cg(s.intent,s.payload),Ni({isOpen:!0,pendingIntent:s.intent,intentMeta:r,payload:s.payload,resolver:e})}),ys=s=>{const{resolver:e,pendingIntent:t,payload:r}=Dt;try{sessionStorage.removeItem(ji)}catch{}Ni({isOpen:!1,pendingIntent:null,intentMeta:null,payload:void 0,resolver:null}),s.status==="success"&&t&&t!=="edit_profile"&&Pg(t,r),e&&e(s)},Pg=(s,e)=>{switch(s){case"view_wallet":break;case"view_my_bets":break;case"comment_prediction":setTimeout(()=>{const t=document.querySelector(".comment-textarea");t&&t.focus()},100);break;case"place_prediction":e?.predictionId&&setTimeout(()=>{const t=document.querySelector('[data-qa="bet-amount"]');t&&t.focus()},100);break}},Ig=()=>{const s=Tg();return s?(Ni({pendingIntent:s.intent,payload:s.payload}),s):null},Qc=m.createContext(void 0),Rg=()=>{const s=m.useContext(Qc);if(s===void 0)throw new Error("useSupabase must be used within a SupabaseProvider");return s},ga=({children:s})=>{const e={supabase:V};return n.jsx(Qc.Provider,{value:e,children:s})},Xc=m.createContext(void 0),ae=()=>{const s=m.useContext(Xc);if(s===void 0)throw new Error("useAuthSession must be used within an AuthSessionProvider");return s},Og=3e3,xa=({children:s})=>{const{supabase:e}=Rg(),[t,r]=m.useState(null),[a,i]=m.useState(null),[o,l]=m.useState(!0),[c,d]=m.useState(!1),u=m.useRef(null);m.useEffect(()=>{let b=!0;const v=async()=>{try{const j=sessionStorage.getItem("fcz:update:session");if(!j)return;sessionStorage.removeItem("fcz:update:session");const S=JSON.parse(j);S?.access_token&&S?.refresh_token&&await e.auth.setSession({access_token:S.access_token,refresh_token:S.refresh_token})}catch{}};(async()=>{try{await v();const{data:{session:j},error:S}=await e.auth.getSession();if(!b)return;S||(i(j),r(j?.user??null))}catch{}finally{b&&(l(!1),d(!0))}})();const{data:{subscription:_}}=e.auth.onAuthStateChange(async(j,S)=>{if(!b)return;const E=Date.now(),T=S?.user?.id||"",N=u.current;N&&N.event===j&&N.userId===T&&E-N.time<Og||(u.current={event:j,userId:T,time:E},i(S),r(S?.user??null),l(!1))});return()=>{b=!1,_.unsubscribe()}},[e]);const y={user:t,session:a,loading:o,initialized:c,isAuthenticated:!!t,signIn:async(b,v)=>{try{const{error:x}=await e.auth.signInWithPassword({email:b,password:v});return{error:x}}catch(x){return{error:{message:x.message||"An unexpected error occurred"}}}},signUp:async(b,v,x={})=>{try{const{error:_}=await e.auth.signUp({email:b,password:v,options:{data:x,emailRedirectTo:"https://app.fanclubz.app/"}});return{error:_}}catch(_){return{error:{message:_.message||"An unexpected error occurred"}}}},signOut:async()=>{try{const{error:b}=await e.auth.signOut();return{error:b}}catch(b){return{error:{message:b.message||"An unexpected error occurred"}}}},signInWithGoogle:async()=>{try{qs();const v=`${window.location.pathname}${window.location.search}${window.location.hash}`,x=Ko(v),{error:_}=await ks.signInWithOAuth("google",{next:v});return{error:_}}catch(b){return{error:{message:b.message||"An unexpected error occurred"}}}},signInWithEmailLink:async b=>{try{qs();const x=`${window.location.pathname}${window.location.search}${window.location.hash}`,_=Ko(x),{error:j}=await e.auth.signInWithOtp({email:b,options:{emailRedirectTo:_}});return{error:j}}catch(v){return{error:{message:v.message||"An unexpected error occurred"}}}}};return n.jsx(Xc.Provider,{value:y,children:s})},Ke=Object.create(null);Ke.open="0";Ke.close="1";Ke.ping="2";Ke.pong="3";Ke.message="4";Ke.upgrade="5";Ke.noop="6";const Pr=Object.create(null);Object.keys(Ke).forEach(s=>{Pr[Ke[s]]=s});const ya={type:"error",data:"parser error"},ed=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",td=typeof ArrayBuffer=="function",sd=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,Si=({type:s,data:e},t,r)=>ed&&e instanceof Blob?t?r(e):tl(e,r):td&&(e instanceof ArrayBuffer||sd(e))?t?r(e):tl(new Blob([e]),r):r(Ke[s]+(e||"")),tl=(s,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(s)};function sl(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let $n;function Lg(s,e){if(ed&&s.data instanceof Blob)return s.data.arrayBuffer().then(sl).then(e);if(td&&(s.data instanceof ArrayBuffer||sd(s.data)))return e(sl(s.data));Si(s,!1,t=>{$n||($n=new TextEncoder),e($n.encode(t))})}const rl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Cs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<rl.length;s++)Cs[rl.charCodeAt(s)]=s;const Dg=s=>{let e=s.length*.75,t=s.length,r,a=0,i,o,l,c;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const d=new ArrayBuffer(e),u=new Uint8Array(d);for(r=0;r<t;r+=4)i=Cs[s.charCodeAt(r)],o=Cs[s.charCodeAt(r+1)],l=Cs[s.charCodeAt(r+2)],c=Cs[s.charCodeAt(r+3)],u[a++]=i<<2|o>>4,u[a++]=(o&15)<<4|l>>2,u[a++]=(l&3)<<6|c&63;return d},$g=typeof ArrayBuffer=="function",ki=(s,e)=>{if(typeof s!="string")return{type:"message",data:rd(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:Ug(s.substring(1),e)}:Pr[t]?s.length>1?{type:Pr[t],data:s.substring(1)}:{type:Pr[t]}:ya},Ug=(s,e)=>{if($g){const t=Dg(s);return rd(t,e)}else return{base64:!0,data:s}},rd=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},nd=String.fromCharCode(30),Bg=(s,e)=>{const t=s.length,r=new Array(t);let a=0;s.forEach((i,o)=>{Si(i,!1,l=>{r[o]=l,++a===t&&e(r.join(nd))})})},Fg=(s,e)=>{const t=s.split(nd),r=[];for(let a=0;a<t.length;a++){const i=ki(t[a],e);if(r.push(i),i.type==="error")break}return r};function Mg(){return new TransformStream({transform(s,e){Lg(s,t=>{const r=t.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}s.data&&typeof s.data!="string"&&(a[0]|=128),e.enqueue(a),e.enqueue(t)})}})}let Un;function yr(s){return s.reduce((e,t)=>e+t.length,0)}function wr(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let r=0;for(let a=0;a<e;a++)t[a]=s[0][r++],r===s[0].length&&(s.shift(),r=0);return s.length&&r<s[0].length&&(s[0]=s[0].slice(r)),t}function Vg(s,e){Un||(Un=new TextDecoder);const t=[];let r=0,a=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(r===0){if(yr(t)<1)break;const c=wr(t,1);i=(c[0]&128)===128,a=c[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(yr(t)<2)break;const c=wr(t,2);a=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(yr(t)<8)break;const c=wr(t,8),d=new DataView(c.buffer,c.byteOffset,c.length),u=d.getUint32(0);if(u>Math.pow(2,53-32)-1){l.enqueue(ya);break}a=u*Math.pow(2,32)+d.getUint32(4),r=3}else{if(yr(t)<a)break;const c=wr(t,a);l.enqueue(ki(i?c:Un.decode(c),e)),r=0}if(a===0||a>s){l.enqueue(ya);break}}}})}const ad=4;function fe(s){if(s)return zg(s)}function zg(s){for(var e in fe.prototype)s[e]=fe.prototype[e];return s}fe.prototype.on=fe.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};fe.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};fe.prototype.off=fe.prototype.removeListener=fe.prototype.removeAllListeners=fe.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var r,a=0;a<t.length;a++)if(r=t[a],r===e||r.fn===e){t.splice(a,1);break}return t.length===0&&delete this._callbacks["$"+s],this};fe.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,a=t.length;r<a;++r)t[r].apply(this,e)}return this};fe.prototype.emitReserved=fe.prototype.emit;fe.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};fe.prototype.hasListeners=function(s){return!!this.listeners(s).length};const un=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),Pe=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),qg="arraybuffer";function id(s,...e){return e.reduce((t,r)=>(s.hasOwnProperty(r)&&(t[r]=s[r]),t),{})}const Wg=Pe.setTimeout,Hg=Pe.clearTimeout;function hn(s,e){e.useNativeTimers?(s.setTimeoutFn=Wg.bind(Pe),s.clearTimeoutFn=Hg.bind(Pe)):(s.setTimeoutFn=Pe.setTimeout.bind(Pe),s.clearTimeoutFn=Pe.clearTimeout.bind(Pe))}const Kg=1.33;function Gg(s){return typeof s=="string"?Zg(s):Math.ceil((s.byteLength||s.size)*Kg)}function Zg(s){let e=0,t=0;for(let r=0,a=s.length;r<a;r++)e=s.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function od(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Jg(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function Yg(s){let e={},t=s.split("&");for(let r=0,a=t.length;r<a;r++){let i=t[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class Qg extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class Ci extends fe{constructor(e){super(),this.writable=!1,hn(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new Qg(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=ki(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Jg(e);return t.length?"?"+t:""}}class Xg extends Ci{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Fg(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Bg(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=od()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let ld=!1;try{ld=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const e0=ld;function t0(){}class s0 extends Xg{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let r=location.port;r||(r=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}let Yt=class Ir extends fe{constructor(e,t,r){super(),this.createRequest=e,hn(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const t=id(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Ir.requestsCount++,Ir.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=t0,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ir.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Yt.requestsCount=0;Yt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",nl);else if(typeof addEventListener=="function"){const s="onpagehide"in Pe?"pagehide":"unload";addEventListener(s,nl,!1)}}function nl(){for(let s in Yt.requests)Yt.requests.hasOwnProperty(s)&&Yt.requests[s].abort()}const r0=function(){const s=cd({xdomain:!1});return s&&s.responseType!==null}();class n0 extends s0{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=r0&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Yt(cd,this.uri(),e)}}function cd(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||e0))return new XMLHttpRequest}catch{}if(!e)try{return new Pe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const dd=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class a0 extends Ci{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,r=dd?{}:id(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],a=t===e.length-1;Si(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&un(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=od()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Bn=Pe.WebSocket||Pe.MozWebSocket;class i0 extends a0{createSocket(e,t,r){return dd?new Bn(e,t,r):t?new Bn(e,t):new Bn(e)}doWrite(e,t){this.ws.send(t)}}class o0 extends Ci{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Vg(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),a=Mg();a.readable.pipeTo(e.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:l,value:c})=>{l||(this.onPacket(c),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],a=t===e.length-1;this._writer.write(r).then(()=>{a&&un(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const l0={websocket:i0,webtransport:o0,polling:n0},c0=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,d0=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function wa(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),r=s.indexOf("]");t!=-1&&r!=-1&&(s=s.substring(0,t)+s.substring(t,r).replace(/:/g,";")+s.substring(r,s.length));let a=c0.exec(s||""),i={},o=14;for(;o--;)i[d0[o]]=a[o]||"";return t!=-1&&r!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=u0(i,i.path),i.queryKey=h0(i,i.query),i}function u0(s,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function h0(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(t[a]=i)}),t}const ba=typeof addEventListener=="function"&&typeof removeEventListener=="function",Rr=[];ba&&addEventListener("offline",()=>{Rr.forEach(s=>s())},!1);class pt extends fe{constructor(e,t){if(super(),this.binaryType=qg,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const r=wa(e);t.hostname=r.host,t.secure=r.protocol==="https"||r.protocol==="wss",t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=wa(t.host).host);hn(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Yg(this.opts.query)),ba&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Rr.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=ad,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&pt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",pt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(t+=Gg(a)),r>0&&t>this._maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,un(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,a){if(typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(pt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ba&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Rr.indexOf(this._offlineEventListener);r!==-1&&Rr.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}pt.protocol=ad;class f0 extends pt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;pt.priorWebsocketSuccess=!1;const a=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;pt.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=t.name,this.emitReserved("upgradeError",f)}}))};function i(){r||(r=!0,u(),t.close(),t=null)}const o=h=>{const f=new Error("probe error: "+h);f.transport=t.name,i(),this.emitReserved("upgradeError",f)};function l(){o("transport closed")}function c(){o("socket closed")}function d(h){t&&h.name!==t.name&&i()}const u=()=>{t.removeListener("open",a),t.removeListener("error",o),t.removeListener("close",l),this.off("close",c),this.off("upgrading",d)};t.once("open",a),t.once("error",o),t.once("close",l),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}let m0=class extends f0{constructor(e,t={}){const r=typeof e=="object"?e:t;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>l0[a]).filter(a=>!!a)),super(e,r)}};function p0(s,e="",t){let r=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),r=wa(s)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port),r}const g0=typeof ArrayBuffer=="function",x0=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,ud=Object.prototype.toString,y0=typeof Blob=="function"||typeof Blob<"u"&&ud.call(Blob)==="[object BlobConstructor]",w0=typeof File=="function"||typeof File<"u"&&ud.call(File)==="[object FileConstructor]";function Ti(s){return g0&&(s instanceof ArrayBuffer||x0(s))||y0&&s instanceof Blob||w0&&s instanceof File}function Or(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,r=s.length;t<r;t++)if(Or(s[t]))return!0;return!1}if(Ti(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return Or(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&Or(s[t]))return!0;return!1}function b0(s){const e=[],t=s.data,r=s;return r.data=va(t,e),r.attachments=e.length,{packet:r,buffers:e}}function va(s,e){if(!s)return s;if(Ti(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let r=0;r<s.length;r++)t[r]=va(s[r],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=va(s[r],e));return t}return s}function v0(s,e){return s.data=_a(s.data,e),delete s.attachments,s}function _a(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=_a(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=_a(s[t],e));return s}const _0=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],j0=5;var G;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(G||(G={}));class N0{constructor(e){this.replacer=e}encode(e){return(e.type===G.EVENT||e.type===G.ACK)&&Or(e)?this.encodeAsBinary({type:e.type===G.EVENT?G.BINARY_EVENT:G.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===G.BINARY_EVENT||e.type===G.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=b0(e),r=this.encodeAsString(t.packet),a=t.buffers;return a.unshift(r),a}}function al(s){return Object.prototype.toString.call(s)==="[object Object]"}class Ai extends fe{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===G.BINARY_EVENT;r||t.type===G.BINARY_ACK?(t.type=r?G.EVENT:G.ACK,this.reconstructor=new E0(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Ti(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(G[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===G.BINARY_EVENT||r.type===G.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(i,t)}else r.nsp="/";const a=e.charAt(t+1);if(a!==""&&Number(a)==a){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(Ai.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case G.CONNECT:return al(t);case G.DISCONNECT:return t===void 0;case G.CONNECT_ERROR:return typeof t=="string"||al(t);case G.EVENT:case G.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&_0.indexOf(t[0])===-1);case G.ACK:case G.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class E0{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=v0(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const S0=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ai,Encoder:N0,get PacketType(){return G},protocol:j0},Symbol.toStringTag,{value:"Module"}));function Ue(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const k0=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class hd extends fe{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ue(e,"open",this.onopen.bind(this)),Ue(e,"packet",this.onpacket.bind(this)),Ue(e,"error",this.onerror.bind(this)),Ue(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,a,i;if(k0.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:G.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const u=this.ids++,h=t.pop();this._registerAckCallback(u,h),o.id=u}const l=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},a),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((r,a)=>{const i=(o,l)=>o?a(o):r(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((a,...i)=>r!==this._queue[0]?void 0:(a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(a)):(this._queue.shift(),t&&t(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:G.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case G.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case G.EVENT:case G.BINARY_EVENT:this.onevent(e);break;case G.ACK:case G.BINARY_ACK:this.onack(e);break;case G.DISCONNECT:this.ondisconnect();break;case G.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...a){r||(r=!0,t.packet({type:G.ACK,id:e,data:a}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:G.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function ms(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}ms.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};ms.prototype.reset=function(){this.attempts=0};ms.prototype.setMin=function(s){this.ms=s};ms.prototype.setMax=function(s){this.max=s};ms.prototype.setJitter=function(s){this.jitter=s};class ja extends fe{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,hn(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new ms({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const a=t.parser||S0;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new m0(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=Ue(t,"open",function(){r.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=Ue(t,"error",i);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(a),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ue(e,"ping",this.onping.bind(this)),Ue(e,"data",this.ondata.bind(this)),Ue(e,"error",this.onerror.bind(this)),Ue(e,"close",this.onclose.bind(this)),Ue(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){un(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new hd(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(a=>{a?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",a)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ws={};function Lr(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=p0(s,e.path||"/socket.io"),r=t.source,a=t.id,i=t.path,o=ws[a]&&i in ws[a].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return l?c=new ja(r,e):(ws[a]||(ws[a]=new ja(r,e)),c=ws[a]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(Lr,{Manager:ja,Socket:hd,io:Lr,connect:Lr});const Te={walletSummary:(s,e)=>["wallet","summary",s,(e??"").toLowerCase()],walletActivity:(s,e=25)=>["wallet","activity",s,e],escrowBalance:s=>["escrow-balance",s],onchainUSDC:(s,e)=>["onchain-usdc",s??"0x0",e],predictionEntries:s=>["prediction-entries",s],prediction:s=>["prediction",s],readContract:(s,e,t)=>["readContract",s,e,t??[]],onchainActivity:(s,e=20)=>["onchain-activity",s,e],predictionImage:(s,e,t,r)=>["prediction-image",s,e,t,r]},C0="@fanclubz/client",T0="2.0.78",A0="Fan Club Z React Client Application",P0="module",I0=["**/*.css"],R0={dev:"vite",clean:"rimraf dist .turbo .vite .cache",typecheck:"tsc -p tsconfig.json --noEmit",lint:"eslint .",build:"vite build",preview:"vite preview --port 5175","cap:sync":"npx cap sync","cap:sync:ios":"npx cap sync ios","cap:sync:android":"npx cap sync android","ios:open":"npx cap open ios","android:open":"npx cap open android",preflight:"pnpm clean && pnpm lint && pnpm typecheck && pnpm check:dupes && pnpm build","vercel-build":"vite build","lint:fix":"eslint . --ext ts,tsx --fix","type-check":"tsc --noEmit","env:check":"ts-node --transpile-only ../scripts/check-env.ts","generate-icons":"bash ../generate-pwa-icons.sh","pwa-audit":"lighthouse --view --chrome-flags='--headless' --only-categories=pwa http://localhost:5173","check-manifest":`node -e "console.log('Checking manifest...'); fetch('http://localhost:5173/manifest.json').then(r=>r.json()).then(console.log).catch(console.error)"`,"check:dupes":"node scripts/check-duplicates.mjs","perf:bundle":"vite build && node scripts/perf/bundle-report.mjs","perf:lighthouse":"npx lighthouse http://localhost:5174 --view --preset=desktop"},O0={"@capacitor/app":"^7.0.0","@capacitor/browser":"^7.0.0","@capacitor/core":"^8.0.1","@coinbase/wallet-sdk":"^4.3.7","@fanclubz/shared":"file:../shared","@hookform/resolvers":"^3.3.2","@radix-ui/react-avatar":"^1.0.4","@radix-ui/react-dialog":"^1.0.5","@radix-ui/react-dropdown-menu":"^2.0.6","@radix-ui/react-select":"^2.0.0","@radix-ui/react-slot":"^1.0.2","@radix-ui/react-switch":"^1.0.3","@radix-ui/react-tabs":"^1.0.4","@radix-ui/react-toast":"^1.1.5","@supabase/supabase-js":"^2.39.1","@tailwindcss/forms":"^0.5.7","@tailwindcss/typography":"^0.5.10","@tanstack/react-query":"^5.14.2","@types/react-router-dom":"^5.3.3","@vitejs/plugin-react":"^4.1.1","@wagmi/connectors":"^5.11.2","@wagmi/core":"^2.22.1","@walletconnect/ethereum-provider":"^2.23.0","@walletconnect/modal":"^2.7.0",autoprefixer:"^10.4.16","class-variance-authority":"^0.7.0",clsx:"^2.1.1","date-fns":"^3.6.0","framer-motion":"^10.16.16","html-to-image":"^1.11.13","lucide-react":"^0.303.0",postcss:"^8.4.32",react:"^18.2.0","react-dom":"^18.2.0","react-hook-form":"^7.48.2","react-hot-toast":"^2.4.1","react-intersection-observer":"^9.5.3","react-router-dom":"^7.9.1","rollup-plugin-visualizer":"^5.12.0","socket.io-client":"^4.7.4","tailwind-merge":"^2.6.0",tailwindcss:"^3.4.0",uuid:"^13.0.0",viem:"^2.38.6",vite:"^4.4.9","vite-plugin-pwa":"^0.17.4",vitest:"^4.0.9",wagmi:"^2.19.2","web-vitals":"^3.5.2",wouter:"^3.0.0",zod:"^3.25.76",zustand:"^4.4.7"},L0={"@capacitor/android":"^7.4.4","@capacitor/cli":"^7.4.4","@capacitor/ios":"^8.0.1","@types/node":"^24.5.2","@types/react":"^18.2.45","@types/react-dom":"^18.2.18","@typescript-eslint/eslint-plugin":"^6.16.0","@typescript-eslint/parser":"^6.16.0",eslint:"^8.56.0","eslint-plugin-react":"^7.37.5","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-react-refresh":"^0.4.5",globby:"^13.2.2",rimraf:"^3.0.2","source-map-explorer":"^2.5.3",typescript:"^5.3.3"},D0={node:">=18.0.0",npm:">=9.0.0"},$0={name:C0,version:T0,description:A0,type:P0,sideEffects:I0,scripts:R0,dependencies:O0,devDependencies:L0,engines:D0},U0=$0.version||"0.0.0",yt={version:U0,name:"Fan Club Z",description:"Social Prediction Platform",api:{url:fs().apiUrl,timeout:15e3,retries:3},frontend:{url:Xs},features:{realTimeUpdates:!0,socialEngagement:!0,walletIntegration:!0,settlementSystem:!0},limits:{maxStakeAmount:1e4,minStakeAmount:1,maxDescriptionLength:500,maxCommentLength:280},ui:{theme:{primaryColor:"#22c55e",brandColors:{green:{50:"#f0fdf4",500:"#22c55e",600:"#16a34a",700:"#15803d"}}},animations:{duration:{fast:200,normal:300,slow:500}}}},B0=()=>yi,F0=()=>Qr,ne=()=>yt.api.url,M0=()=>yt.frontend.url,V0=()=>yt.version,z0=()=>`${yt.name} v${yt.version}`,q0=s=>yt.features[s],fd=Object.freeze(Object.defineProperty({__proto__:null,APP_CONFIG:yt,default:yt,getApiUrl:ne,getFrontendUrl:M0,getFullVersion:z0,getVersion:V0,isDevelopment:B0,isFeatureEnabled:q0,isProduction:F0},Symbol.toStringTag,{value:"Module"})),il={maxRetries:3,initialDelay:1e3,maxDelay:1e4,backoffFactor:2},W0=s=>new Promise(e=>setTimeout(e,s)),H0=(s,e,t)=>e>=t?!1:!!(s.name==="TypeError"&&s.message.includes("Failed to fetch")||s.name==="HTTPError"&&s.status>=500||s.name==="AbortError"||s.name==="TimeoutError"),K0=(s,e)=>{const t=e.initialDelay*Math.pow(e.backoffFactor,s-1);return Math.min(t,e.maxDelay)},br=async(s,e={})=>{const{timeout:t=15e3,retryOptions:r=il,...a}=e,i={...il,...r};let o;for(let l=1;l<=i.maxRetries+1;l++)try{const c=new AbortController,d=setTimeout(()=>c.abort(),t),u=String(a.method||"GET").toUpperCase(),h=u==="GET"||u==="HEAD",f={Accept:"application/json",...a.headers},p=typeof a.body<"u"&&a.body!==null;!h&&p&&!("Content-Type"in f)&&!("content-type"in f)&&(f["Content-Type"]="application/json");const w=await fetch(s,{...a,signal:c.signal,headers:f});if(clearTimeout(d),!w.ok){const g=new Error(`HTTP error! status: ${w.status} ${w.statusText}`);throw g.name="HTTPError",g.status=w.status,g.response=w,g}return w}catch(c){if(o=c,H0(c,l,i.maxRetries)){const d=K0(l,i);await W0(d);continue}break}throw o},vr={get:async(s,e={})=>{const t=`${ne()}${s}`;return(await br(t,{method:"GET",...e})).json()},post:async(s,e,t={})=>{const r=`${ne()}${s}`;return(await br(r,{method:"POST",body:e?JSON.stringify(e):void 0,...t})).json()},put:async(s,e,t={})=>{const r=`${ne()}${s}`;return(await br(r,{method:"PUT",body:e?JSON.stringify(e):void 0,...t})).json()},delete:async(s,e={})=>{const t=`${ne()}${s}`;return(await br(t,{method:"DELETE",...e})).json()}},ol=!1,G0=os()(bi((s,e)=>({mode:"crypto",isDemoEnabled:ol,isFiatEnabled:!1,setMode:t=>{const r=e();if(t==="demo"&&!ol){s({mode:"crypto"});return}if(t==="fiat"&&!r.isFiatEnabled){s({mode:"crypto"});return}s({mode:t})},setFiatEnabled:t=>{s({isFiatEnabled:t});const r=e();!t&&r.mode==="fiat"&&s({mode:"crypto"})}}),{name:"fcz:fundingMode",version:2,partialize:s=>({mode:s.mode}),onRehydrateStorage:()=>s=>{s&&s.mode==="demo"&&s.setMode("crypto")}}));function bs(s,e,t,r){return`bet:${s||"anon"}:${e}:${t}:${r}`}function _r(s,e=2*60*1e3){try{const t=sessionStorage.getItem(s),r=Date.now();if(t){const i=JSON.parse(t);if(i&&i.id&&r-i.ts<e)return i.id}const a=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${r}-${Math.random().toString(16).slice(2)}`;return sessionStorage.setItem(s,JSON.stringify({id:a,ts:r})),a}catch{return`${Date.now()}-${Math.random().toString(16).slice(2)}`}}const Z0=(s={})=>{const e=s.totalStaked??s.total_staked??0,t=s.currentOdds??s.current_odds??s.odds??1;return{id:s.id??"",prediction_id:s.prediction_id??s.predictionId??"",label:s.label??s.text??"Option",total_staked:s.total_staked??e,current_odds:s.current_odds??t,percentage:s.percentage??s.share??0,totalStaked:e,currentOdds:t}},Na=(s={})=>{const e=Array.isArray(s.options)?s.options.map(Z0):[],t=s.pool_total??s.poolTotal??s.totalPool??0,r=s.stake_min??s.stakeMin??s.minimum_stake??0,a=s.entry_deadline??s.entryDeadline??s.deadline,i=s.settlement_method??s.settlementMethod??"manual",o=s.participant_count??s.participantCount??s.participants??0,l=s.likes_count??s.likeCount??(Array.isArray(s.likes)?s.likes.length:Number(s.likes??0)),c=s.comments_count??s.commentCount??(Array.isArray(s.comments)?s.comments.length:Number(s.comments??0));return{...s,options:e,pool_total:s.pool_total??t,poolTotal:t,stake_min:s.stake_min??r,stakeMin:r,entry_deadline:s.entry_deadline??a,entryDeadline:a,settlement_method:s.settlement_method??i,settlementMethod:i,participant_count:s.participant_count??o,participantCount:o,likes_count:s.likes_count??l,likeCount:l,comments_count:s.comments_count??c,commentCount:c}},jr=(s=[])=>s.map(Na),Nr={predictions:[],trendingPredictions:[],userPredictions:[],createdPredictions:[],completedPredictions:[],userPredictionEntries:[],userCreatedPredictions:[],loading:!1,loadingMore:!1,error:null,initialized:!1,lastFetchTime:0,platformStats:null,statsLoading:!1,pagination:{page:1,limit:20,total:0,hasNext:!1,hasPrev:!1},filters:{category:"all",search:""},inFlightBets:{}},J0=os((s,e)=>({...Nr,fetchPredictions:async(t={})=>{const{page:r=1,category:a=e().filters.category,search:i=e().filters.search,append:o=!1}=t,l=Date.now(),{lastFetchTime:c,predictions:d}=e();if(!o&&r===1&&l-c<3e4&&d.length>0)return;const u=o&&r>1;s({[u?"loadingMore":"loading"]:!0,error:null});try{const h=new URLSearchParams({page:r.toString(),limit:"20",...a!=="all"&&{category:a},...i.trim()&&{search:i.trim()}}),f=await vr.get(`/api/v2/predictions?${h}`,{timeout:1e4,retryOptions:{maxRetries:3}}),p=jr(f.data||[]),w=f.pagination||{};s(g=>({predictions:o?[...g.predictions,...p]:p,loading:!1,loadingMore:!1,error:null,initialized:!0,lastFetchTime:l,pagination:{page:w.page||r,limit:w.limit||20,total:w.total||0,hasNext:w.hasNext||!1,hasPrev:w.hasPrev||!1},filters:{category:a,search:i}}))}catch(h){s({loading:!1,loadingMore:!1,error:h instanceof Error?h.message:"Failed to fetch predictions"})}},loadMorePredictions:async()=>{const{pagination:t,loadingMore:r}=e();r||!t.hasNext||await e().fetchPredictions({page:t.page+1,append:!0})},setFilters:t=>{const a={...e().filters,...t};s(i=>({filters:a,pagination:{...i.pagination,page:1},predictions:[]})),e().fetchPredictions({category:a.category,search:a.search})},resetPagination:()=>{s(t=>({pagination:{...Nr.pagination},filters:{...Nr.filters},predictions:[]}))},refreshPredictions:async(t=!1)=>{const{lastFetchTime:r}=e(),a=Date.now();if(!(!t&&a-r<1e4)){s(i=>({lastFetchTime:0,pagination:{...i.pagination,page:1},predictions:[]}));try{await e().fetchPredictions()}catch(i){throw i}}},fetchTrendingPredictions:async()=>{s({loading:!0});try{const t=await fetch(`${ne()}/api/v2/predictions/trending`);if(!t.ok)throw new Error(`Failed to fetch trending predictions: ${t.statusText}`);const r=await t.json(),a=jr(r.data||[]);s({trendingPredictions:a,loading:!1,error:null})}catch(t){s({loading:!1,error:t instanceof Error?t.message:"Failed to fetch trending predictions"})}},fetchUserPredictions:async t=>{s({loading:!0});try{const r=await fetch(`${ne()}/api/v2/predictions/user/${t}`);if(!r.ok)throw new Error(`Failed to fetch user predictions: ${r.statusText}`);const a=await r.json(),i=jr(a.data||[]);s({userPredictions:i,loading:!1,error:null})}catch(r){s({loading:!1,error:r instanceof Error?r.message:"Failed to fetch user predictions"})}},fetchCreatedPredictions:async t=>{s({loading:!0});try{const r=await fetch(`${ne()}/api/v2/predictions/created/${t}`);if(!r.ok)throw new Error(`Failed to fetch created predictions: ${r.statusText}`);const a=await r.json(),i=jr(a.data||[]);s({createdPredictions:i,loading:!1,error:null})}catch(r){s({loading:!1,error:r instanceof Error?r.message:"Failed to fetch created predictions"})}},fetchPredictionById:async t=>{try{const{predictions:r}=e(),a=r.find(c=>c.id===t)||null,i=await fetch(`${ne()}/api/v2/predictions/${t}`);if(!i.ok)return i.status,a;const o=await i.json(),l=Na(o.data);return l?(s(c=>{const d=h=>h.id===t?{...h,...l}:h;return{predictions:(h=>h.some(f=>f.id===t)?h.map(d):[...h,l])(c.predictions),userPredictions:c.userPredictions.map(d),createdPredictions:c.createdPredictions.map(d),userCreatedPredictions:c.userCreatedPredictions.map(d),trendingPredictions:c.trendingPredictions.map(d),completedPredictions:c.completedPredictions.map(d)}}),l):a}catch{const{predictions:a}=e();return a.find(i=>i.id===t)||null}},createPrediction:async t=>{s({loading:!0,error:null});try{const r=await fetch(`${ne()}/api/v2/predictions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Failed to create prediction: ${r.statusText}`);const a=await r.json();if(!a.data)throw new Error("Invalid response: no prediction data returned");const i=Na(a.data);if(!i||!i.id)throw new Error("Invalid prediction data: missing required fields");s(o=>({predictions:[i,...o.predictions],loading:!1,error:null})),setTimeout(()=>{e().fetchPredictions()},100),s(o=>({userCreatedPredictions:[i,...o.userCreatedPredictions]}));try{const{user:o}=J.getState();o?.id&&setTimeout(()=>{e().fetchUserCreatedPredictions(o.id)},1e3)}catch{}return i}catch(r){throw s({loading:!1,error:r instanceof Error?r.message:"Failed to create prediction"}),r}},placePrediction:async(t,r,a,i,o)=>{s({loading:!0,error:null});try{const c=G0.getState(),d=c.mode,u=d==="crypto";if(d==="fiat"&&c.isFiatEnabled){const f=bs(i,t,r,a);if((e().inFlightBets||{})[f]){s({loading:!1});return}s(x=>({inFlightBets:{...x.inFlightBets||{},[f]:!0}}));const w=_r(f),g=await fetch(`${ne()}/api/predictions/${t}/place-bet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:r,amountNgn:a,userId:i,fundingMode:"fiat",requestId:w})});if(!g.ok){const x=await g.json().catch(()=>({}));throw x.error==="INSUFFICIENT_FUNDS"?new Error("INSUFFICIENT_FUNDS"):x.error==="FIAT_DISABLED"?new Error("FIAT_DISABLED"):x.error==="BETTING_DISABLED"?new Error("Betting is temporarily unavailable. Please try again later."):new Error(x.message||"Unable to place bet. Please try again.")}const y=await g.json(),b=y?.data?.prediction,v=y?.data?.entry;return s(x=>{const _=j=>!j||j.id!==t?j:b?{...j,...b}:j;return{predictions:x.predictions.map(_),userPredictions:x.userPredictions.map(_),createdPredictions:x.createdPredictions.map(_),userCreatedPredictions:x.userCreatedPredictions.map(_),userPredictionEntries:v?[...x.userPredictionEntries.filter(j=>j.id!==v.id),v]:x.userPredictionEntries,loading:!1,error:null}}),s(x=>{const _={...x.inFlightBets||{}};return delete _[f],{inFlightBets:_}}),y}if(u){const f=bs(i,t,r,a);if((e().inFlightBets||{})[f]){s({loading:!1});return}s(x=>({inFlightBets:{...x.inFlightBets||{},[f]:!0}}));const w=_r(f),g=await fetch(`${ne()}/api/predictions/${t}/place-bet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:r,amountUSD:a,userId:i,walletAddress:o||void 0,requestId:w})});if(!g.ok){const x=await g.json().catch(()=>({}));throw x.error==="INSUFFICIENT_ESCROW"?new Error("INSUFFICIENT_ESCROW"):x.error==="BETTING_DISABLED"?new Error("Betting is temporarily unavailable. Please try again later."):new Error(x.message||"Unable to place bet. Please try again.")}const y=await g.json(),b=y?.data?.prediction,v=y?.data?.entry;s(x=>{const _=j=>!j||j.id!==t?j:b?{...j,...b}:{...j,pool_total:(j.pool_total||0)+a,participant_count:(j.participant_count||0)+1};return{predictions:x.predictions.map(_),userPredictions:x.userPredictions.map(_),createdPredictions:x.createdPredictions.map(_),userCreatedPredictions:x.userCreatedPredictions.map(_),userPredictionEntries:v?[...x.userPredictionEntries.filter(j=>j.id!==v.id),v]:x.userPredictionEntries,loading:!1,error:null}});try{const{user:x}=J.getState();x?.id&&await Promise.all([e().fetchUserCreatedPredictions(x.id),e().fetchUserPredictionEntries(x.id)])}catch{}return s(x=>{const _={...x.inFlightBets||{}};return delete _[f],{inFlightBets:_}}),y}else{const f=bs(i,t,r,a);if((e().inFlightBets||{})[f]){s({loading:!1});return}s(x=>({inFlightBets:{...x.inFlightBets||{},[f]:!0}}));const w=_r(f),g=await fetch(`${ne()}/api/predictions/${t}/place-bet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:r,amountUSD:a,userId:i,fundingMode:"demo",requestId:w})});if(!g.ok){const x=await g.json().catch(()=>({}));throw x.error==="INSUFFICIENT_FUNDS"?new Error("INSUFFICIENT_FUNDS"):x.error==="BETTING_DISABLED"?new Error("Betting is temporarily unavailable. Please try again later."):new Error(x.message||"Unable to place bet. Please try again.")}const y=await g.json(),b=y?.data?.prediction,v=y?.data?.entry;s(x=>{const _=j=>!j||j.id!==t?j:b?{...j,...b}:j;return{predictions:x.predictions.map(_),userPredictions:x.userPredictions.map(_),createdPredictions:x.createdPredictions.map(_),userCreatedPredictions:x.userCreatedPredictions.map(_),userPredictionEntries:v?[...x.userPredictionEntries.filter(j=>j.id!==v.id),v]:x.userPredictionEntries,loading:!1,error:null}});try{const{user:x}=J.getState();x?.id&&await Promise.all([e().fetchUserCreatedPredictions(x.id),e().fetchUserPredictionEntries(x.id)])}catch{}return s(x=>{const _={...x.inFlightBets||{}};return delete _[f],{inFlightBets:_}}),y}}catch(l){let c="Failed to place prediction";throw l instanceof Error&&(l.message.includes("already been used")||l.message.includes("already been consumed")?c="Previous bet attempt was not completed. Please refresh the page and try again.":c=l.message),s({loading:!1,error:c}),l}finally{try{const l=bs(i,t,r,a);s(c=>{const d={...c.inFlightBets||{}};return delete d[l],{inFlightBets:d}})}catch{}}},placeFiatPrediction:async(t,r,a,i)=>{s({loading:!0,error:null});try{const o=bs(i,t,r,a);if((e().inFlightBets||{})[o]){s({loading:!1});return}s(p=>({inFlightBets:{...p.inFlightBets||{},[o]:!0}}));const c=_r(o),d=await fetch(`${ne()}/api/predictions/${t}/place-bet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:r,amountNgn:a,userId:i,fundingMode:"fiat",requestId:c})});if(!d.ok){const p=await d.json().catch(()=>({}));throw p.error==="INSUFFICIENT_FUNDS"?new Error("Insufficient fiat balance. Please deposit more NGN."):p.error==="FIAT_DISABLED"?new Error("Fiat betting is currently disabled."):p.error==="BETTING_DISABLED"?new Error("Betting is temporarily unavailable. Please try again later."):new Error(p.message||"Unable to place bet. Please try again.")}const u=await d.json(),h=u?.data?.prediction,f=u?.data?.entry;s(p=>{const w=g=>!g||g.id!==t?g:h?{...g,...h}:g;return{predictions:p.predictions.map(w),userPredictions:p.userPredictions.map(w),createdPredictions:p.createdPredictions.map(w),userCreatedPredictions:p.userCreatedPredictions.map(w),userPredictionEntries:f?[...p.userPredictionEntries.filter(g=>g.id!==f.id),f]:p.userPredictionEntries,loading:!1,error:null}});try{const{user:p}=J.getState();p?.id&&await Promise.all([e().fetchUserCreatedPredictions(p.id),e().fetchUserPredictionEntries(p.id)])}catch{}return s(p=>{const w={...p.inFlightBets||{}};return delete w[o],{inFlightBets:w}}),u}catch(o){let l="Failed to place prediction";throw o instanceof Error&&(l=o.message),s({loading:!1,error:l}),o}},fetchPlatformStats:async()=>{s({statsLoading:!0});try{const t=await vr.get("/api/v2/predictions/stats/platform",{timeout:8e3,retryOptions:{maxRetries:3}});if(t.success&&t.data)s({platformStats:t.data,statsLoading:!1});else throw new Error("Invalid stats response format")}catch{const{predictions:r}=e(),a={totalVolume:r.reduce((i,o)=>i+(o.pool_total||0),0).toFixed(2),activePredictions:r.filter(i=>i.status==="open").length,totalUsers:r.length>0?"5":"0",rawVolume:r.reduce((i,o)=>i+(o.pool_total||0),0),rawUsers:r.length>0?5:0};s({platformStats:a,statsLoading:!1})}},getActivityForPrediction:t=>[],getParticipantsForPrediction:t=>[],clearError:()=>{s({error:null})},fetchUserPredictionEntries:async t=>{try{const a=(await vr.get(`/api/v2/prediction-entries/user/${t}`,{timeout:1e4,retryOptions:{maxRetries:3}})).data||[];s({userPredictionEntries:a})}catch{}},fetchUserCreatedPredictions:async t=>{try{const a=(await vr.get(`/api/v2/predictions/created/${t}`,{timeout:1e4,retryOptions:{maxRetries:3}})).data||[];s({userCreatedPredictions:a})}catch{}},getUserPredictionEntries:t=>{const{userPredictionEntries:r}=e();return r.filter(a=>a.user_id===t)},getUserCreatedPredictions:t=>{const{userCreatedPredictions:r}=e();return r.filter(a=>a.creator_id===t)},updatePrediction:async(t,r)=>{try{const a=await fetch(`${ne()}/api/v2/predictions/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)});if(!a.ok)throw new Error(`Failed to update prediction: ${a.statusText}`);const o=(await a.json()).data;s(l=>({predictions:l.predictions.map(c=>c.id===t?{...c,...o}:c),userCreatedPredictions:l.userCreatedPredictions.map(c=>c.id===t?{...c,...o}:c)}))}catch(a){throw a}},deletePrediction:async t=>{try{const r=await fetch(`${ne()}/api/v2/predictions/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to delete prediction: ${r.statusText}`);s(a=>({predictions:a.predictions.filter(i=>i.id!==t),createdPredictions:a.createdPredictions.filter(i=>i.id!==t),userCreatedPredictions:a.userCreatedPredictions.filter(i=>i.id!==t),trendingPredictions:a.trendingPredictions.filter(i=>i.id!==t),completedPredictions:a.completedPredictions.filter(i=>i.id!==t)}));try{const{user:a}=J.getState();await e().refreshPredictions(!0),await e().fetchTrendingPredictions(),a?.id&&(await e().fetchUserCreatedPredictions(a.id),await e().fetchUserPredictionEntries(a.id))}catch{}}catch(r){throw r}},closePrediction:async t=>{try{const r=await fetch(`${ne()}/api/v2/predictions/${t}/close`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to close prediction: ${r.statusText}`);const i=(await r.json()).data;s(o=>{const l=c=>c.id===t?{...c,...i,status:"closed"}:c;return{predictions:o.predictions.map(l),userCreatedPredictions:o.userCreatedPredictions.map(l),createdPredictions:o.createdPredictions.map(l),userPredictions:o.userPredictions.map(l),trendingPredictions:o.trendingPredictions.map(l),completedPredictions:o.completedPredictions.map(l)}})}catch(r){throw r}},fetchPredictionActivity:async t=>{try{const r=await fetch(`${ne()}/api/v2/predictions/${t}/activity`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return r.ok?(await r.json()).data||[]:[]}catch{return[]}},fetchPredictionParticipants:async t=>{try{const r=await fetch(`${ne()}/api/v2/predictions/${t}/participants`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return r.ok?(await r.json()).data||[]:[]}catch{return[]}},reset:()=>{s(Nr)}})),ll=async()=>{const{refreshPredictions:s}=J0.getState();if(typeof s=="function")try{await s(!0)}catch{}},Y0=({children:s})=>{const{user:e}=ae(),t=zl(),r=m.useRef(null);return m.useEffect(()=>{const a=Zc().replace(/\/$/,""),i=Lr(a,{transports:["websocket","polling"],withCredentials:!0,autoConnect:!0,reconnection:!0,reconnectionAttempts:10,reconnectionDelay:500,timeout:2e4});r.current=i,i.on("connect",()=>{}),i.on("connect_error",d=>{}),i.on("disconnect",d=>{});const o=d=>{!e?.id||d.userId!==e.id||(t.invalidateQueries({queryKey:Te.walletSummary(e.id)}),t.invalidateQueries({queryKey:Te.walletActivity(e.id)}),t.invalidateQueries({queryKey:Te.escrowBalance(e.id)}),t.invalidateQueries({queryKey:["readContract"]}))},l=d=>{d.predictionId&&(t.invalidateQueries({queryKey:Te.prediction(d.predictionId)}),t.invalidateQueries({queryKey:Te.predictionEntries(d.predictionId)}),ll())},c=d=>{d.predictionId&&(t.invalidateQueries({queryKey:Te.prediction(d.predictionId)}),t.invalidateQueries({queryKey:Te.predictionEntries(d.predictionId)}),e?.id&&t.invalidateQueries({queryKey:Te.walletSummary(e.id)}),ll())};return i.on("wallet:update",o),i.on("prediction:update",l),i.on("settlement:complete",c),()=>{i.off("wallet:update",o),i.off("prediction:update",l),i.off("settlement:complete",c),i.close()}},[e?.id,t]),n.jsx(n.Fragment,{children:s})};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Q0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),P=(s,e)=>{const t=m.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>m.createElement("svg",{ref:u,...Q0,width:a,height:a,stroke:r,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${X0(s)}`,l].join(" "),...d},[...e.map(([h,f])=>m.createElement(h,f)),...Array.isArray(c)?c:[c]]));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=P("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=P("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=P("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=P("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=P("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=P("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=P("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=P("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=P("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=P("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=P("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=P("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=P("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=P("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=P("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=P("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=P("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=P("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=P("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=P("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=P("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=P("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=P("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=P("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=P("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=P("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=P("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=P("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=P("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"8ur5zv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=P("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=P("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=P("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=P("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=P("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=P("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=P("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=P("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=P("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=P("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=P("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=P("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=P("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=P("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=P("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=P("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=P("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=P("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=P("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=P("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=P("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=P("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=P("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=P("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=P("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=P("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=P("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=P("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=P("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=P("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=P("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=P("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=P("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=P("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=P("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=P("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=P("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=P("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);class jd{constructor(e){te(this,"element");te(this,"focusableElements");te(this,"firstFocusableElement",null);te(this,"lastFocusableElement",null);te(this,"previousActiveElement",null);te(this,"handleKeyDown",e=>{if(e.key==="Tab"){if(this.updateFocusableElements(),this.focusableElements.length===0){e.preventDefault();return}if(this.focusableElements.length===1){e.preventDefault(),this.firstFocusableElement?.focus();return}e.shiftKey?document.activeElement===this.firstFocusableElement&&(e.preventDefault(),this.lastFocusableElement?.focus()):document.activeElement===this.lastFocusableElement&&(e.preventDefault(),this.firstFocusableElement?.focus())}});this.element=e,this.focusableElements=[],this.updateFocusableElements()}updateFocusableElements(){const e=["button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","a[href]",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(",");this.focusableElements=Array.from(this.element.querySelectorAll(e)),this.firstFocusableElement=this.focusableElements[0]||null,this.lastFocusableElement=this.focusableElements[this.focusableElements.length-1]||null}activate(){this.previousActiveElement=document.activeElement,this.updateFocusableElements(),setTimeout(()=>{this.firstFocusableElement&&this.firstFocusableElement.focus()},50),document.addEventListener("keydown",this.handleKeyDown)}deactivate(){document.removeEventListener("keydown",this.handleKeyDown),this.previousActiveElement&&"focus"in this.previousActiveElement&&this.previousActiveElement.focus()}}const Nd={handleArrowKeys:(s,e,t,r,a="vertical")=>{const i=a==="vertical",o=i?"ArrowUp":"ArrowLeft",l=i?"ArrowDown":"ArrowRight";switch(s.key){case o:s.preventDefault(),r(e>0?e-1:t-1);break;case l:s.preventDefault(),r(e<t-1?e+1:0);break;case"Home":s.preventDefault(),r(0);break;case"End":s.preventDefault(),r(t-1);break}},handleEscape:(s,e)=>{s.key==="Escape"&&(s.preventDefault(),e())},handleActivation:(s,e)=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),e())}},tn={generateId:(s="fcz")=>`${s}-${Math.random().toString(36).substr(2,9)}`,announce:(s,e="polite")=>{const t=document.createElement("div");t.setAttribute("aria-live",e),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=s,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&document.body.removeChild(t)},1e3)},setExpanded:(s,e)=>{s.setAttribute("aria-expanded",e.toString())},setSelected:(s,e)=>{s.setAttribute("aria-selected",e.toString())},setPressed:(s,e)=>{s.setAttribute("aria-pressed",e.toString())}},t_=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,Ed=m.createContext(void 0),vx=()=>{const s=m.useContext(Ed);if(s===void 0)throw new Error("useNetworkStatus must be used within a NetworkStatusProvider");return s},Pa=({children:s})=>{const[e,t]=m.useState(navigator.onLine),[r,a]=m.useState(!1);m.useEffect(()=>{const o=()=>{t(!0)},l=()=>{t(!1)};return window.addEventListener("online",o),window.addEventListener("offline",l),(()=>{if("connection"in navigator){const d=navigator.connection;if(d){const u=d.effectiveType==="slow-2g"||d.effectiveType==="2g";a(u)}}})(),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",l)}},[]);const i={isOnline:e,isSlowConnection:r};return n.jsx(Ed.Provider,{value:i,children:s})},_x=({isOpen:s,onClose:e,onSubmit:t,title:r="Enter your email address",description:a="We'll send you a secure sign-in link.",submitLabel:i="Send Link"})=>{const[o,l]=m.useState(""),[c,d]=m.useState(!1),[u,h]=m.useState(""),[f,p]=m.useState(!1),w=m.useRef(null),g=m.useRef(null),y=m.useRef(null),[b]=m.useState(()=>tn.generateId("email-modal"));m.useEffect(()=>{if(s&&w.current)return l(""),h(""),d(!1),p(!1),y.current=new jd(w.current),y.current.activate(),tn.announce(`${r} dialog opened`),()=>{y.current&&(y.current.deactivate(),y.current=null)}},[s,r]),m.useEffect(()=>{if(!s)return;const _=j=>{Nd.handleEscape(j,e)};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[s,e]);const v=_=>_?/\S+@\S+\.\S+/.test(_)?null:"Please enter a valid email address.":"Email is required.",x=async _=>{_.preventDefault();const j=v(o);if(j){h(j);return}d(!0),h("");try{await t(o.trim()),p(!0),setTimeout(()=>{e()},3e3)}catch(S){h(S instanceof Error?S.message:"Failed to send email"),d(!1)}};return s?n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{pointerEvents:s?"auto":"none"},children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:f?void 0:e}),n.jsxs("div",{ref:w,className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":`${b}-title`,"aria-describedby":`${b}-description`,"aria-live":"polite",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[n.jsxs("div",{children:[n.jsx("h2",{id:`${b}-title`,className:"text-xl font-semibold text-gray-900",children:f?"Check your email!":r}),n.jsx("p",{id:`${b}-description`,className:"text-sm text-gray-600 mt-1",children:f?`We sent a sign-in link to ${o}`:a})]}),n.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close modal",disabled:c,children:n.jsx(vt,{className:"w-5 h-5"})})]}),f?n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"mx-auto flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:n.jsx(Ge,{className:"w-8 h-8 text-emerald-600"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign-in link sent!"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:"Click the link in your email to sign in. The link will expire in 1 hour for security."}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:n.jsxs("p",{className:"text-sm text-gray-700",children:[n.jsx("strong",{children:"Sent to:"})," ",o]})}),n.jsx("p",{className:"text-xs text-gray-500",children:"Didn't receive it? Check your spam folder or close this to try again."})]}):n.jsx("form",{onSubmit:x,className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(en,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{ref:g,id:"email-input",type:"email",value:o,onChange:_=>l(_.target.value),className:`block w-full pl-10 pr-3 py-3 border rounded-xl focus:ring-2 focus:ring-emerald-500 transition-colors ${u?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-emerald-500"}`,placeholder:"your@email.com",disabled:c,autoComplete:"email"})]}),u&&n.jsx("p",{className:"mt-2 text-sm text-red-600",role:"alert",children:u})]}),n.jsx("button",{type:"submit",disabled:c||!o.trim(),className:"w-full flex items-center justify-center gap-3 bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white py-3 px-6 rounded-xl font-semibold transition-colors shadow-lg",children:c?n.jsxs(n.Fragment,{children:[n.jsx(Y,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):n.jsxs(n.Fragment,{children:[n.jsx(en,{className:"w-5 h-5"}),i]})})]})}),!f&&n.jsx("div",{className:"px-6 pb-6",children:n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"By continuing, you agree to our Terms of Service and Privacy Policy."})})]})]}):null},jx=_x,Nx=()=>{const{isOpen:s,pendingIntent:e,intentMeta:t}=Ag(),{signInWithGoogle:r,signInWithEmailLink:a,user:i}=ae(),{isOnline:o}=vx(),[l,c]=m.useState(!1),d=m.useRef(null),u=m.useRef(null),h=m.useRef(null),[f]=m.useState(()=>tn.generateId("auth-modal")),p=t??(e?_i[e]:void 0)??Eg;m.useEffect(()=>{if(s&&d.current)return h.current=new jd(d.current),h.current.activate(),tn.announce(`${p.title} dialog opened`),()=>{h.current&&(h.current.deactivate(),h.current=null)}},[s,p.title]),m.useEffect(()=>{const x=_=>{s&&Nd.handleEscape(_,w)};if(s)return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[s]),m.useEffect(()=>{i&&s&&ys({status:"success"})},[i,s]);const w=()=>{ys({status:"cancel"})},g=async()=>{try{const{error:x}=await r();x&&ys({status:"error",reason:x.message||"Google sign in failed"})}catch(x){ys({status:"error",reason:x instanceof Error?x.message:"Unknown error"})}},y=()=>{c(!0)},b=async x=>{try{const{error:_}=await a(x);if(_)throw new Error(_.message||"Email sign in failed");c(!1),ys({status:"success"})}catch(_){throw _}};if(!s)return null;const v=!o;return n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{pointerEvents:s?"auto":"none"},children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:w}),n.jsxs("div",{ref:d,className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl",role:"dialog","aria-modal":"true","aria-labelledby":`${f}-title`,"aria-describedby":`${f}-description`,"aria-live":"polite",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[n.jsxs("div",{children:[n.jsx("h2",{id:`${f}-title`,className:"text-xl font-semibold text-gray-900",children:p.title}),n.jsx("p",{id:`${f}-description`,className:"text-sm text-gray-600 mt-1",children:p.description})]}),n.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close modal",children:n.jsx(vt,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{ref:u,onClick:g,disabled:v,className:"w-full flex items-center justify-center gap-3 bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 text-white py-4 px-6 rounded-xl font-semibold transition-colors disabled:cursor-not-allowed shadow-lg relative group","data-qa":"auth-gate-google",title:"You'll sign in with Google to FanClubZ",children:[n.jsx(ix,{className:"w-5 h-5"}),p.primaryCta]}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-gray-200"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-gray-500",children:"or"})})]}),n.jsxs("button",{onClick:y,disabled:v,className:"w-full flex items-center justify-center gap-3 bg-white border-2 border-gray-200 hover:bg-gray-50 hover:border-gray-300 disabled:bg-gray-100 disabled:border-gray-200 text-gray-700 py-4 px-6 rounded-xl font-semibold transition-colors disabled:cursor-not-allowed","data-qa":"auth-gate-email",children:[n.jsx(en,{className:"w-5 h-5"}),p.secondaryCta]}),v&&n.jsx("div",{className:"text-center py-2",children:n.jsx("p",{className:"text-sm text-orange-600 bg-orange-50 px-3 py-2 rounded-lg",children:"You're offline. Try again when you're back online."})})]})}),n.jsx("div",{className:"px-6 pb-6",children:n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"By continuing, you agree to FanClubZ's Terms of Service and Privacy Policy."})})]}),n.jsx(jx,{isOpen:l,onClose:()=>c(!1),onSubmit:b,title:"Continue with Email",description:"Enter your email address and we'll send you a secure sign-in link.",submitLabel:"Send Sign-in Link"})]})},Sd=Nx;let Ex={data:""},Sx=s=>{if(typeof window=="object"){let e=(s?s.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(s||document.head).appendChild(e),e.firstChild}return s||Ex},kx=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Cx=/\/\*[^]*?\*\/|  +/g,hl=/\n+/g,ht=(s,e)=>{let t="",r="",a="";for(let i in s){let o=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":r+=i[1]=="f"?ht(o,i):i+"{"+ht(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=ht(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ht.p?ht.p(i,o):i+":"+o+";")}return t+(e&&a?e+"{"+a+"}":a)+r},Qe={},kd=s=>{if(typeof s=="object"){let e="";for(let t in s)e+=t+kd(s[t]);return e}return s},Tx=(s,e,t,r,a)=>{let i=kd(s),o=Qe[i]||(Qe[i]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(i));if(!Qe[o]){let c=i!==s?s:(d=>{let u,h,f=[{}];for(;u=kx.exec(d.replace(Cx,""));)u[4]?f.shift():u[3]?(h=u[3].replace(hl," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][u[1]]=u[2].replace(hl," ").trim();return f[0]})(s);Qe[o]=ht(a?{["@keyframes "+o]:c}:c,t?"":"."+o)}let l=t&&Qe.g?Qe.g:null;return t&&(Qe.g=Qe[o]),((c,d,u,h)=>{h?d.data=d.data.replace(h,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(Qe[o],e,r,l),o},Ax=(s,e,t)=>s.reduce((r,a,i)=>{let o=e[i];if(o&&o.call){let l=o(t),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":ht(l,""):l===!1?"":l}return r+a+(o??"")},"");function fn(s){let e=this||{},t=s.call?s(e.p):s;return Tx(t.unshift?t.raw?Ax(t,[].slice.call(arguments,1),e.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(e.p):a),{}):t,Sx(e.target),e.g,e.o,e.k)}let Cd,Ia,Ra;fn.bind({g:1});let it=fn.bind({k:1});function Px(s,e,t,r){ht.p=e,Cd=s,Ia=t,Ra=r}function _t(s,e){let t=this||{};return function(){let r=arguments;function a(i,o){let l=Object.assign({},i),c=l.className||a.className;t.p=Object.assign({theme:Ia&&Ia()},l),t.o=/ *go\d+/.test(c),l.className=fn.apply(t,r)+(c?" "+c:""),e&&(l.ref=o);let d=s;return s[0]&&(d=l.as||s,delete l.as),Ra&&d[0]&&Ra(l),Cd(d,l)}return e?e(a):a}}var Ix=s=>typeof s=="function",sn=(s,e)=>Ix(s)?s(e):s,Rx=(()=>{let s=0;return()=>(++s).toString()})(),Td=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");s=!e||e.matches}return s}})(),Ox=20,Oi="default",Ad=(s,e)=>{let{toastLimit:t}=s.settings;switch(e.type){case 0:return{...s,toasts:[e.toast,...s.toasts].slice(0,t)};case 1:return{...s,toasts:s.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return Ad(s,{type:s.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=e;return{...s,toasts:s.toasts.map(o=>o.id===a||a===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...s,pausedAt:e.time};case 6:let i=e.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},$r=[],Pd={toasts:[],pausedAt:void 0,settings:{toastLimit:Ox}},ze={},Id=(s,e=Oi)=>{ze[e]=Ad(ze[e]||Pd,s),$r.forEach(([t,r])=>{t===e&&r(ze[e])})},Rd=s=>Object.keys(ze).forEach(e=>Id(s,e)),Lx=s=>Object.keys(ze).find(e=>ze[e].toasts.some(t=>t.id===s)),mn=(s=Oi)=>e=>{Id(e,s)},Dx={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},$x=(s={},e=Oi)=>{let[t,r]=m.useState(ze[e]||Pd),a=m.useRef(ze[e]);m.useEffect(()=>(a.current!==ze[e]&&r(ze[e]),$r.push([e,r]),()=>{let o=$r.findIndex(([l])=>l===e);o>-1&&$r.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,c,d;return{...s,...s[o.type],...o,removeDelay:o.removeDelay||((l=s[o.type])==null?void 0:l.removeDelay)||s?.removeDelay,duration:o.duration||((c=s[o.type])==null?void 0:c.duration)||s?.duration||Dx[o.type],style:{...s.style,...(d=s[o.type])==null?void 0:d.style,...o.style}}});return{...t,toasts:i}},Ux=(s,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:t?.id||Rx()}),sr=s=>(e,t)=>{let r=Ux(e,s,t);return mn(r.toasterId||Lx(r.id))({type:2,toast:r}),r.id},ge=(s,e)=>sr("blank")(s,e);ge.error=sr("error");ge.success=sr("success");ge.loading=sr("loading");ge.custom=sr("custom");ge.dismiss=(s,e)=>{let t={type:3,toastId:s};e?mn(e)(t):Rd(t)};ge.dismissAll=s=>ge.dismiss(void 0,s);ge.remove=(s,e)=>{let t={type:4,toastId:s};e?mn(e)(t):Rd(t)};ge.removeAll=s=>ge.remove(void 0,s);ge.promise=(s,e,t)=>{let r=ge.loading(e.loading,{...t,...t?.loading});return typeof s=="function"&&(s=s()),s.then(a=>{let i=e.success?sn(e.success,a):void 0;return i?ge.success(i,{id:r,...t,...t?.success}):ge.dismiss(r),a}).catch(a=>{let i=e.error?sn(e.error,a):void 0;i?ge.error(i,{id:r,...t,...t?.error}):ge.dismiss(r)}),s};var Bx=1e3,Fx=(s,e="default")=>{let{toasts:t,pausedAt:r}=$x(s,e),a=m.useRef(new Map).current,i=m.useCallback((h,f=Bx)=>{if(a.has(h))return;let p=setTimeout(()=>{a.delete(h),o({type:4,toastId:h})},f);a.set(h,p)},[]);m.useEffect(()=>{if(r)return;let h=Date.now(),f=t.map(p=>{if(p.duration===1/0)return;let w=(p.duration||0)+p.pauseDuration-(h-p.createdAt);if(w<0){p.visible&&ge.dismiss(p.id);return}return setTimeout(()=>ge.dismiss(p.id,e),w)});return()=>{f.forEach(p=>p&&clearTimeout(p))}},[t,r,e]);let o=m.useCallback(mn(e),[e]),l=m.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=m.useCallback((h,f)=>{o({type:1,toast:{id:h,height:f}})},[o]),d=m.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=m.useCallback((h,f)=>{let{reverseOrder:p=!1,gutter:w=8,defaultPosition:g}=f||{},y=t.filter(x=>(x.position||g)===(h.position||g)&&x.height),b=y.findIndex(x=>x.id===h.id),v=y.filter((x,_)=>_<b&&x.visible).length;return y.filter(x=>x.visible).slice(...p?[v+1]:[0,v]).reduce((x,_)=>x+(_.height||0)+w,0)},[t]);return m.useEffect(()=>{t.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let f=a.get(h.id);f&&(clearTimeout(f),a.delete(h.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:c,startPause:l,endPause:d,calculateOffset:u}}},Mx=it`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Vx=it`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,zx=it`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,qx=_t("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Mx} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Vx} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${zx} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Wx=it`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Hx=_t("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${Wx} 1s linear infinite;
`,Kx=it`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Gx=it`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Zx=_t("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Kx} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Gx} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Jx=_t("div")`
  position: absolute;
`,Yx=_t("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Qx=it`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Xx=_t("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Qx} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ey=({toast:s})=>{let{icon:e,type:t,iconTheme:r}=s;return e!==void 0?typeof e=="string"?m.createElement(Xx,null,e):e:t==="blank"?null:m.createElement(Yx,null,m.createElement(Hx,{...r}),t!=="loading"&&m.createElement(Jx,null,t==="error"?m.createElement(qx,{...r}):m.createElement(Zx,{...r})))},ty=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,sy=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,ry="0%{opacity:0;} 100%{opacity:1;}",ny="0%{opacity:1;} 100%{opacity:0;}",ay=_t("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,iy=_t("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,oy=(s,e)=>{let t=s.includes("top")?1:-1,[r,a]=Td()?[ry,ny]:[ty(t),sy(t)];return{animation:e?`${it(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${it(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},ly=m.memo(({toast:s,position:e,style:t,children:r})=>{let a=s.height?oy(s.position||e||"top-center",s.visible):{opacity:0},i=m.createElement(ey,{toast:s}),o=m.createElement(iy,{...s.ariaProps},sn(s.message,s));return m.createElement(ay,{className:s.className,style:{...a,...t,...s.style}},typeof r=="function"?r({icon:i,message:o}):m.createElement(m.Fragment,null,i,o))});Px(m.createElement);var cy=({id:s,className:e,style:t,onHeightUpdate:r,children:a})=>{let i=m.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;r(s,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[s,r]);return m.createElement("div",{ref:i,className:e,style:t},a)},dy=(s,e)=>{let t=s.includes("top"),r=t?{top:0}:{bottom:0},a=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Td()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...a}},uy=fn`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Er=16,hy=({reverseOrder:s,position:e="top-center",toastOptions:t,gutter:r,children:a,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:d}=Fx(t,i);return m.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Er,left:Er,right:Er,bottom:Er,pointerEvents:"none",...o},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(u=>{let h=u.position||e,f=d.calculateOffset(u,{reverseOrder:s,gutter:r,defaultPosition:e}),p=dy(h,f);return m.createElement(cy,{id:u.id,key:u.id,onHeightUpdate:d.updateHeight,className:u.visible?uy:"",style:p},u.type==="custom"?sn(u.message,u):a?a(u):m.createElement(ly,{toast:u,position:h}))}))},B=ge;const Rt=class Rt{constructor(){te(this,"scrollPositions",new Map);te(this,"currentRoute","");te(this,"scrollTimeout",null);te(this,"isNavigating",!1);te(this,"restoreTimeout",null);te(this,"navigationHistory",[]);te(this,"isBackNavigation",!1);typeof window<"u"&&(this.currentRoute=window.location.pathname,this.navigationHistory=[this.currentRoute],this.setupNavigationListeners())}static getInstance(){return Rt.instance||(Rt.instance=new Rt),Rt.instance}setupNavigationListeners(){window.addEventListener("popstate",()=>{this.isNavigating=!0,this.isBackNavigation=!0;const e=window.location.pathname;this.navigationHistory.length>0&&this.navigationHistory[this.navigationHistory.length-1]===this.currentRoute&&this.navigationHistory.pop(),setTimeout(()=>{this.restoreScrollPosition(e),this.currentRoute=e,this.isNavigating=!1,this.isBackNavigation=!1},100)}),window.addEventListener("beforeunload",()=>{this.saveCurrentScrollPosition()})}handleRouteChange(e,t){if(e!==t){this.saveScrollPosition(e);const r=this.navigationHistory.length>1&&this.navigationHistory[this.navigationHistory.length-2]===t;r?this.navigationHistory.pop():(this.navigationHistory.push(t),this.navigationHistory.length>10&&this.navigationHistory.shift()),this.currentRoute=t,this.isBackNavigation=r,r?this.scheduleScrollRestore(t):this.scrollToTop({behavior:"instant",delay:50})}}scheduleScrollRestore(e){this.restoreTimeout&&clearTimeout(this.restoreTimeout),this.restoreTimeout=window.setTimeout(()=>{!this.isNavigating&&this.isBackNavigation&&this.restoreScrollPosition(e)},150)}saveScrollPosition(e){const t=e||this.currentRoute,r=this.getCurrentScrollPosition();r>50&&this.scrollPositions.set(t,{scrollY:r,timestamp:Date.now(),route:t})}saveCurrentScrollPosition(){this.saveScrollPosition(this.currentRoute)}restoreScrollPosition(e){const t=this.scrollPositions.get(e);return t?Date.now()-t.timestamp<10*60*1e3?(this.scrollToPosition(t.scrollY,"smooth"),!0):(this.scrollPositions.delete(e),!1):!1}getCurrentScrollPosition(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}scrollToPosition(e,t="smooth"){const r=()=>{document.scrollingElement&&(document.scrollingElement.scrollTop=e),document.documentElement.scrollTop=e,document.body.scrollTop=e;try{window.scrollTo({top:e,left:0,behavior:t==="instant"?"instant":"smooth"})}catch{window.scrollTo(0,e)}};if(t==="instant"){r(),requestAnimationFrame(()=>{r()});return}try{window.scrollTo({top:e,left:0,behavior:"smooth"}),setTimeout(()=>{const a=this.getCurrentScrollPosition();Math.abs(a-e)>100&&r()},300)}catch{r()}}scrollToTop(e={}){const{behavior:t="smooth",delay:r=0}=e;if(this.scrollTimeout&&window.clearTimeout(this.scrollTimeout),t==="instant"){this.scrollToPosition(0,"instant"),r>0&&(this.scrollTimeout=window.setTimeout(()=>{this.scrollToPosition(0,"instant"),this.scrollTimeout=null},r)),window.setTimeout(()=>{this.scrollToPosition(0,"instant")},100);return}this.scrollTimeout=window.setTimeout(()=>{this.scrollToPosition(0,t),this.scrollTimeout=null},r)}scrollToElement(e,t={}){const{behavior:r="smooth",offset:a=0}=t;this.scrollTimeout&&window.clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{const i=document.getElementById(e);if(i){const o=i.offsetTop-a;this.scrollToPosition(o,r)}this.scrollTimeout=null},50)}clearOldPositions(){const e=Date.now(),t=10*60*1e3;for(const[r,a]of this.scrollPositions.entries())e-a.timestamp>t&&this.scrollPositions.delete(r)}markNavigationAsIntentional(){this.isNavigating=!0,this.isBackNavigation=!1,setTimeout(()=>{this.isNavigating=!1},500)}markAsBackNavigation(){this.isBackNavigation=!0}handleRouterNavigation(e,t){this.saveScrollPosition(e);const r=this.navigationHistory.length>1&&this.navigationHistory[this.navigationHistory.length-2]===t;r?this.navigationHistory.pop():(this.navigationHistory.push(t),this.navigationHistory.length>10&&this.navigationHistory.shift()),this.currentRoute=t,this.isBackNavigation=r,r?setTimeout(()=>{this.restoreScrollPosition(t)},150):(this.scrollToPosition(0,"instant"),this.scrollToTop({behavior:"instant",delay:50}))}getDebugInfo(){return{currentRoute:this.currentRoute,savedPositions:Array.from(this.scrollPositions.entries()).map(([e,t])=>({route:e,scrollY:t.scrollY,age:Date.now()-t.timestamp})),isNavigating:this.isNavigating}}destroy(){this.scrollTimeout&&window.clearTimeout(this.scrollTimeout),this.restoreTimeout&&window.clearTimeout(this.restoreTimeout),this.scrollPositions.clear()}};te(Rt,"instance");let Oa=Rt;const rr=Oa.getInstance(),fy=s=>{rr.scrollToTop(s)},Ks=s=>{rr.saveScrollPosition(s)},rn=()=>{rr.markNavigationAsIntentional()},my=(s,e)=>{rr.handleRouterNavigation(s,e)};setInterval(()=>{rr.clearOldPositions()},5*60*1e3);const py=({type:s,message:e,duration:t=5e3,onClose:r,show:a=!0})=>{const[i,o]=m.useState(a);if(m.useEffect(()=>{o(a)},[a]),m.useEffect(()=>{if(i&&t>0){const d=setTimeout(()=>{o(!1),r?.()},t);return()=>clearTimeout(d)}},[i,t,r]),!i)return null;const l=()=>{switch(s){case"success":return n.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return n.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return n.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return n.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},c=()=>{const d={position:"fixed",top:"20px",right:"20px",zIndex:9999,padding:"16px 20px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.15)",display:"flex",alignItems:"center",gap:"12px",maxWidth:"400px",minWidth:"300px",animation:"slideIn 0.3s ease-out",border:"1px solid",backdropFilter:"blur(10px)",fontSize:"14px",fontWeight:"600",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'};switch(s){case"success":return{...d,backgroundColor:"rgba(16, 185, 129, 0.95)",color:"white",borderColor:"rgba(16, 185, 129, 0.3)"};case"error":return{...d,backgroundColor:"rgba(239, 68, 68, 0.95)",color:"white",borderColor:"rgba(239, 68, 68, 0.3)"};case"warning":return{...d,backgroundColor:"rgba(245, 158, 11, 0.95)",color:"white",borderColor:"rgba(245, 158, 11, 0.3)"};case"info":return{...d,backgroundColor:"rgba(59, 130, 246, 0.95)",color:"white",borderColor:"rgba(59, 130, 246, 0.3)"}}};return n.jsxs(n.Fragment,{children:[n.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
          
          @keyframes slideOut {
            from {
              transform: translateX(0);
              opacity: 1;
            }
            to {
              transform: translateX(100%);
              opacity: 0;
            }
          }
        `}),n.jsxs("div",{style:c(),children:[n.jsx("div",{style:{flexShrink:0},children:l()}),n.jsx("div",{style:{flex:1},children:e})]})]})},gy=py,xy={success:"success",error:"error",warning:"warning",info:"info",prediction_outcome:"success",payout:"success",comment:"info",market_close:"warning",like:"info",follow:"info",settlement_ready:"warning",settlement_completed:"success"},yy=()=>{const{toasts:s,removeToast:e}=vi();return n.jsx(n.Fragment,{children:s.map(t=>n.jsx(gy,{type:xy[t.type]??"info",message:t.message,duration:t.duration,onClose:()=>e(t.id),show:!0},t.id))})},wy=yy,Ot=class Ot{constructor(){te(this,"deferredPrompt",null);te(this,"isInstalled",!1);this.init()}static getInstance(){return Ot.instance||(Ot.instance=new Ot),Ot.instance}init(){if(nt.isNativePlatform()){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(r=>{r.unregister()})}).catch(t=>{});return}this.registerServiceWorker(),this.checkInstallStatus(),this.setupInstallPrompt()}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&this.showUpdateAvailable()})})}catch{}}checkInstallStatus(){this.isInstalled=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.deferredPrompt=e,window.dispatchEvent(new CustomEvent("pwa-installable",{detail:{canInstall:!0}}))}),window.addEventListener("appinstalled",()=>{this.isInstalled=!0,this.deferredPrompt=null,this.trackInstallation(),window.dispatchEvent(new CustomEvent("pwa-installed"))})}async promptInstall(){if(!this.deferredPrompt)return!1;try{await this.deferredPrompt.prompt();const e=await this.deferredPrompt.userChoice;return this.deferredPrompt=null,e.outcome==="accepted"}catch{return!1}}canInstall(){return!!this.deferredPrompt&&!this.isInstalled}isAppInstalled(){return this.isInstalled}isIOSDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}isAndroidDevice(){return/Android/.test(navigator.userAgent)}showUpdateAvailable(){const e=new CustomEvent("pwa-update-available",{detail:{message:"A new version of Fan Club Z is available. Refresh to update.",action:()=>window.location.reload()}});window.dispatchEvent(e)}trackInstallation(){typeof window<"u"&&window.gtag&&window.gtag("event","pwa_install",{event_category:"engagement",event_label:"app_install"})}async requestNotificationPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?!1:await Notification.requestPermission()==="granted":!1}async subscribeToPushNotifications(){try{const e=await navigator.serviceWorker.ready,t=await e.pushManager.getSubscription();if(t)return t;const r=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(Gc||"")});return await this.sendSubscriptionToServer(r),r}catch{return null}}urlBase64ToUint8Array(e){const t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(r),i=new Uint8Array(a.length);for(let o=0;o<a.length;++o){const l=a.charCodeAt(o);i[o]=l}return i}async sendSubscriptionToServer(e){try{const t=wi();await fetch(`${t}/api/notifications/subscribe`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch{}}};te(Ot,"instance");let La=Ot;const Ae=La.getInstance(),by=()=>{const[s,e]=m.useState(!1),[t,r]=m.useState(!1);m.useEffect(()=>{const l=()=>{if(Ae.isAppInstalled()){e(!1);return}const u=Ae.isIOSDevice(),h=localStorage.getItem(u?"ios-install-dismissed":"pwa-banner-dismissed"),f=h?parseInt(h):0,p=(Date.now()-f)/(24*60*60*1e3),g=!h||p>(u?3:1),y=sessionStorage.getItem("pwa-banner-session-dismissed");g&&!y&&(u?setTimeout(()=>e(!0),5e3):r(Ae.canInstall()))},c=()=>{r(!0),localStorage.getItem("pwa-banner-dismissed")||e(!0)},d=()=>{e(!1),r(!1)};return window.addEventListener("pwa-installable",c),window.addEventListener("pwa-installed",d),l(),()=>{window.removeEventListener("pwa-installable",c),window.removeEventListener("pwa-installed",d)}},[]);const a=async()=>{Ae.isIOSDevice()?(window.dispatchEvent(new CustomEvent("show-ios-install")),e(!1)):(await Ae.promptInstall()||localStorage.setItem("pwa-banner-dismissed",Date.now().toString()),e(!1))},i=()=>{e(!1);const l=Ae.isIOSDevice()?"ios-install-dismissed":"pwa-banner-dismissed";localStorage.setItem(l,Date.now().toString()),sessionStorage.setItem("pwa-banner-session-dismissed","true")};if(!s)return null;const o=Ae.isIOSDevice();return n.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-purple-500 to-teal-600 text-white shadow-lg animate-in slide-in-from-top duration-300",children:n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 max-w-md mx-auto",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-white/20 p-2 rounded-lg backdrop-blur-sm",children:n.jsx(bd,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-sm",children:o?"Add to Home Screen":"Install Fan Club Z"}),n.jsx("p",{className:"text-xs text-green-100",children:o?"Get quick access and offline features":"Faster loading â€¢ Offline access â€¢ Notifications"})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:a,className:"bg-white text-teal-600 px-3 py-1.5 rounded-md text-sm font-medium hover:bg-teal-50 active:bg-teal-100 transition-colors flex items-center space-x-1 shadow-sm",children:[n.jsx(Xr,{className:"w-4 h-4"}),n.jsx("span",{children:o?"How To":"Install"})]}),n.jsx("button",{onClick:i,className:"text-green-100 hover:text-white transition-colors p-1 rounded","aria-label":"Dismiss install banner",children:n.jsx(vt,{className:"w-5 h-5"})})]})]})})},vy=by,_y=({isOpen:s,onClose:e})=>s?n.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex flex-col ios-install-modal",onClick:e,style:{zIndex:1e4},children:n.jsx("div",{className:"flex-1 flex items-center justify-center p-4 pb-24",children:n.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200 flex flex-col max-h-[calc(100vh-8rem)]",onClick:t=>t.stopPropagation(),style:{zIndex:10001},children:[n.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-emerald-600 p-4 text-center text-white relative rounded-t-2xl flex-shrink-0",children:[n.jsx("button",{onClick:e,className:"absolute top-3 right-3 text-white/80 hover:text-white transition-colors p-1 rounded-full hover:bg-white/20","aria-label":"Close modal",children:n.jsx(vt,{className:"w-5 h-5"})}),n.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-white/20 rounded-full mb-3",children:n.jsx(bd,{className:"w-6 h-6"})}),n.jsx("h2",{className:"text-lg font-bold mb-1",children:"Install Fan Club Z"}),n.jsx("p",{className:"text-green-100 text-sm",children:"Get the full app experience with offline access and notifications"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain",children:n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"1"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:"Tap the Share button"}),n.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[n.jsx(xx,{className:"w-4 h-4"}),n.jsx("span",{children:"Usually found at the bottom of Safari"})]})]})]}),n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"2"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:'Select "Add to Home Screen"'}),n.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[n.jsx(tr,{className:"w-4 h-4"}),n.jsx("span",{children:"Scroll down in the share menu to find this option"})]})]})]}),n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"3"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:'Tap "Add" to confirm'}),n.jsx("p",{className:"text-sm text-gray-600",children:"Fan Club Z will appear on your home screen like a native app"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3 text-base",children:"Why install?"}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[n.jsx("li",{children:"â€¢ Faster loading and smoother experience"}),n.jsx("li",{children:"â€¢ Works offline for viewing your predictions"}),n.jsx("li",{children:"â€¢ Push notifications for important updates"}),n.jsx("li",{children:"â€¢ Easy access from your home screen"})]})]}),n.jsx("div",{className:"h-4"})]})}),n.jsx("div",{className:"border-t border-gray-100 p-4 flex-shrink-0 rounded-b-2xl",children:n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors text-base",children:"Maybe Later"}),n.jsx("button",{onClick:()=>{e(),localStorage.setItem("ios-install-dismissed",Date.now().toString())},className:"flex-1 px-4 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-base",children:"Got It!"})]})})]})})}):null,jy=_y,Ny=({onInstall:s,onDismiss:e})=>{const[t,r]=m.useState(!1);m.useEffect(()=>{const o=setTimeout(()=>r(!0),100);return()=>clearTimeout(o)},[]);const a=()=>{r(!1),setTimeout(s,300)},i=()=>{r(!1),setTimeout(e,300)};return n.jsx("div",{className:`
      fixed inset-x-4 top-20 max-w-sm mx-auto transition-all duration-300 ease-out pwa-install-prompt
      ${t?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-4"}
    `,style:{zIndex:1e4},children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:n.jsx(Xr,{className:"w-4 h-4"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-sm",children:"Install Fan Club Z"}),n.jsx("p",{className:"text-xs text-green-100",children:"Get the full app experience"})]})]}),n.jsx("button",{onClick:i,className:"text-green-100 hover:text-white transition-colors p-1 rounded",children:n.jsx(vt,{className:"w-4 h-4"})})]})}),n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-400 to-teal-500 rounded-lg flex items-center justify-center",children:n.jsx(bx,{className:"w-4 h-4 text-teal-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Faster Performance"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Lightning-fast loading and smooth animations"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(sx,{className:"w-4 h-4 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Get notified about prediction results and updates"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:n.jsx(gs,{className:"w-4 h-4 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Offline Access"}),n.jsx("p",{className:"text-xs text-gray-600",children:"View your predictions even without internet"})]})]})]}),n.jsxs("div",{className:"p-4 pt-0 flex space-x-2",children:[n.jsx("button",{onClick:i,className:"flex-1 py-2.5 px-4 text-gray-700 bg-gray-100 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors",children:"Maybe Later"}),n.jsxs("button",{onClick:a,className:"flex-1 py-2.5 px-4 bg-teal-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors flex items-center justify-center space-x-1",children:[n.jsx(Xr,{className:"w-4 h-4"}),n.jsx("span",{children:"Install"})]})]})]})})},Ey=()=>{const[s,e]=m.useState(!1),[t,r]=m.useState(0);m.useEffect(()=>{let l=0;const c=["click","scroll","touchstart","keydown"],d=()=>{l++,r(l),l>=5&&!localStorage.getItem("install-prompt-shown")&&a()};return c.forEach(u=>{document.addEventListener(u,d,{passive:!0})}),()=>{c.forEach(u=>{document.removeEventListener(u,d)})}},[]);const a=()=>{if(Ae.isAppInstalled())return;const l=localStorage.getItem("install-prompt-dismissed"),c=l?parseInt(l):0,d=24*60*60*1e3;if(!l||Date.now()-c>d){const u=Date.now()-parseInt(localStorage.getItem("session-start")||"0"),h=localStorage.getItem("has-created-prediction"),f=localStorage.getItem("has-placed-prediction");u>3e4&&(h||f)&&(e(!0),localStorage.setItem("install-prompt-shown","true"))}},i=async()=>{Ae.isIOSDevice()?window.dispatchEvent(new CustomEvent("show-ios-install")):await Ae.promptInstall()||localStorage.setItem("install-prompt-dismissed",Date.now().toString()),e(!1)},o=()=>{e(!1),localStorage.setItem("install-prompt-dismissed",Date.now().toString())};return s?n.jsx(Ny,{onInstall:i,onDismiss:o}):null},Sy=Ey,ky=({isVisible:s,onUpdate:e,onDismiss:t})=>{const[r,a]=m.useState(!1),i=()=>{a(!0),setTimeout(t,300)},o=()=>{a(!0),setTimeout(e,200)};return!s&&!r?null:n.jsxs(n.Fragment,{children:[n.jsx("div",{className:`
        fixed inset-0 bg-black/10 backdrop-blur-sm transition-opacity duration-300 update-notification
        ${s&&!r?"opacity-100":"opacity-0"}
      `,style:{zIndex:1e4}}),n.jsx("div",{className:`
        fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 update-notification
        w-[calc(100vw-32px)] max-w-sm max-h-[90vh] overflow-y-auto
        transition-all duration-300 ease-out
        ${s&&!r?"opacity-100 scale-100":"opacity-0 scale-95"}
      `,style:{zIndex:10001},children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[n.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white relative",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:n.jsx(wt,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("h3",{className:"font-bold text-base flex items-center space-x-2",children:[n.jsx("span",{children:"Update Available!"}),n.jsx(gs,{className:"w-4 h-4"})]}),n.jsx("p",{className:"text-sm text-green-100",children:"New features and improvements ready"})]})]}),n.jsx("button",{onClick:i,className:"absolute top-3 right-3 text-green-100 hover:text-white transition-colors p-1 rounded-full hover:bg-white/10","aria-label":"Dismiss update notification",children:n.jsx(vt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"mb-4",children:[n.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:["ðŸš€ ",n.jsx("strong",{children:"What's New:"})]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 ml-2",children:[n.jsx("li",{children:"â€¢ Improved performance and stability"}),n.jsx("li",{children:"â€¢ Enhanced user interface"}),n.jsx("li",{children:"â€¢ Bug fixes and optimizations"})]})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsxs("button",{onClick:o,className:"flex-[2] bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold text-sm hover:bg-green-700 active:bg-green-800 transition-colors flex items-center justify-center space-x-2 shadow-lg",children:[n.jsx(wt,{className:"w-4 h-4"}),n.jsx("span",{children:"Update Now"})]}),n.jsx("button",{onClick:i,className:"flex-1 py-3 px-4 text-gray-600 hover:text-gray-800 transition-colors text-sm font-medium hover:bg-gray-50 rounded-xl border border-gray-200",children:"Later"})]})]})]})})]})},Cy=ky,Ty=()=>{const[s,e]=m.useState(!1),[t,r]=m.useState(!1);if(nt.isNativePlatform())return null;m.useEffect(()=>{localStorage.getItem("session-start")||localStorage.setItem("session-start",Date.now().toString());const o=()=>{e(!0)},l=f=>{r(!0)},c=()=>{setTimeout(async()=>{const f=localStorage.getItem("user-has-interacted"),p=localStorage.getItem("notification-permission-requested");if(f&&!p){const w=await Ae.requestNotificationPermission();localStorage.setItem("notification-permission-requested","true"),w&&await Ae.subscribeToPushNotifications()}},15e3)};window.addEventListener("show-ios-install",o),window.addEventListener("pwa-update-available",l);const d=()=>{localStorage.setItem("user-has-interacted","true"),c()},u=["click","scroll","touchstart"];return u.forEach(f=>{document.addEventListener(f,d,{once:!0,passive:!0})}),(()=>{const f=parseInt(localStorage.getItem("visit-count")||"0")+1;localStorage.setItem("visit-count",f.toString()),localStorage.setItem("last-visit",Date.now().toString()),f>1&&localStorage.setItem("is-returning-user","true")})(),()=>{window.removeEventListener("show-ios-install",o),window.removeEventListener("pwa-update-available",l),u.forEach(f=>{document.removeEventListener(f,d)})}},[]);const a=async()=>{try{const{data:o}=await V.auth.getSession();o?.session?.access_token&&o.session.refresh_token&&sessionStorage.setItem("fcz:update:session",JSON.stringify({access_token:o.session.access_token,refresh_token:o.session.refresh_token}))}catch{}typeof window<"u"&&"gtag"in window&&typeof window.gtag=="function"&&window.gtag("event","pwa_update_accepted",{event_category:"engagement",event_label:"app_update"}),window.location.reload()},i=()=>{r(!1),typeof window<"u"&&"gtag"in window&&typeof window.gtag=="function"&&window.gtag("event","pwa_update_dismissed",{event_category:"engagement",event_label:"app_update"})};return n.jsxs(n.Fragment,{children:[n.jsx(vy,{}),n.jsx(Sy,{}),n.jsx(jy,{isOpen:s,onClose:()=>e(!1)}),n.jsx(Cy,{isVisible:t,onUpdate:a,onDismiss:i})]})},Ay=Ty;let Py=class extends m.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"text-center max-w-md",children:[n.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Something went wrong"}),n.jsx("p",{className:"text-gray-600 mb-4",children:this.state.error?.message||"An unexpected error occurred while loading this page."}),n.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:void 0}),this.props.onRetry()},className:"bg-teal-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Try Again"})]})}):this.props.children}};const Iy=({title:s="Loading..."})=>n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:s})]})}),Ry=({children:s,title:e="Loading...",fallback:t})=>{const[r,a]=Ie.useState(0),i=()=>{a(o=>o+1)};return n.jsx(Py,{onRetry:i,children:n.jsx(m.Suspense,{fallback:t||n.jsx(Iy,{title:e}),children:n.jsx("div",{children:s},r)})})},$t=Ry;function Oy(s,e){if(s instanceof RegExp)return{keys:!1,pattern:s};var t,r,a,i,o=[],l="",c=s.split("/");for(c[0]||c.shift();a=c.shift();)t=a[0],t==="*"?(o.push(t),l+=a[1]==="?"?"(?:/(.*))?":"/(.*)"):t===":"?(r=a.indexOf("?",1),i=a.indexOf(".",1),o.push(a.substring(1,~r?r:~i?i:a.length)),l+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~r?"?":"")+"\\"+a.substring(i))):l+="/"+a;return{keys:o,pattern:new RegExp("^"+l+(e?"(?=$|/)":"/?$"),"i")}}const Ly=ru["useInsertionEffect"],Dy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$y=Dy?m.useLayoutEffect:m.useEffect,Uy=Ly||$y,Od=s=>{const e=m.useRef([s,(...t)=>e[0](...t)]).current;return Uy(()=>{e[0]=s}),e[1]},By="popstate",Li="pushState",Di="replaceState",Fy="hashchange",fl=[By,Li,Di,Fy],My=s=>{for(const e of fl)addEventListener(e,s);return()=>{for(const e of fl)removeEventListener(e,s)}},Ld=(s,e)=>gu.useSyncExternalStore(My,s,e),ml=()=>location.search,Vy=({ssrSearch:s}={})=>Ld(ml,s!=null?()=>s:ml),pl=()=>location.pathname,zy=({ssrPath:s}={})=>Ld(pl,s!=null?()=>s:pl),qy=(s,{replace:e=!1,state:t=null}={})=>history[e?Di:Li](t,"",s),Wy=(s={})=>[zy(s),qy],gl=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[gl]>"u"){for(const s of[Li,Di]){const e=history[s];history[s]=function(){const t=e.apply(this,arguments),r=new Event(s);return r.arguments=arguments,dispatchEvent(r),t}}Object.defineProperty(window,gl,{value:!0})}const Hy=(s,e)=>e.toLowerCase().indexOf(s.toLowerCase())?"~"+e:e.slice(s.length)||"/",Dd=(s="")=>s==="/"?"":s,Ky=(s,e)=>s[0]==="~"?s.slice(1):Dd(e)+s,Gy=(s="",e)=>Hy(xl(Dd(s)),xl(e)),xl=s=>{try{return decodeURI(s)}catch{return s}},Zy={hook:Wy,searchHook:Vy,parser:Oy,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:s=>s},Jy=m.createContext(Zy),$d=()=>m.useContext(Jy),Yy={};m.createContext(Yy);const Ud=s=>{const[e,t]=s.hook(s);return[Gy(s.base,e),Od((r,a)=>t(Ky(r,s.base),a))]},Qy=()=>Ud($d());m.forwardRef((s,e)=>{const t=$d(),[r,a]=Ud(t),{to:i="",href:o=i,onClick:l,asChild:c,children:d,className:u,replace:h,state:f,...p}=s,w=Od(y=>{y.ctrlKey||y.metaKey||y.altKey||y.shiftKey||y.button!==0||(l?.(y),y.defaultPrevented||(y.preventDefault(),a(o,s)))}),g=t.hrefs(o[0]==="~"?o.slice(1):t.base+o,t);return c&&m.isValidElement(d)?m.cloneElement(d,{onClick:w,href:g}):m.createElement("a",{...p,onClick:w,href:g,className:u?.call?u(r===o):u,children:d,ref:e})});const Xy=()=>{const[s,e]=m.useState(()=>{try{const u=localStorage.getItem("fcz_onboarding_state_v3");return u?JSON.parse(u):{isActive:!1,currentStep:0,completed:!1,skipped:!1,userPreferences:{hasSeenOnboarding:!1,preferredTourStyle:"full",completedSteps:[]}}}catch{return{isActive:!1,currentStep:0,completed:!1,skipped:!1,userPreferences:{hasSeenOnboarding:!1,preferredTourStyle:"full",completedSteps:[]}}}}),[t,r]=m.useState(null),a=m.useCallback(u=>{e(h=>{const f=typeof u=="function"?u(h):u,p={...h,...f};try{localStorage.setItem("fcz_onboarding_state_v3",JSON.stringify(p))}catch{}return p})},[]),i=m.useCallback(u=>{r(u),a({isActive:!0,currentStep:0,completed:!1,skipped:!1})},[a]),o=m.useCallback(async()=>{if(!t)return;const u=t.steps[s.currentStep];if(u?.onNext)try{await u.onNext()}catch{}a(h=>{const f=h.currentStep>=(t?.steps.length||0)-1,p=u?.id?[...h.userPreferences.completedSteps,u.id]:h.userPreferences.completedSteps;return f?{isActive:!1,completed:!0,userPreferences:{...h.userPreferences,hasSeenOnboarding:!0,completedSteps:p}}:{currentStep:h.currentStep+1,userPreferences:{...h.userPreferences,completedSteps:p}}})},[t,s.currentStep,a]),l=m.useCallback(async()=>{const u=t?.steps[s.currentStep];if(u?.onPrev)try{await u.onPrev()}catch{}s.currentStep>0&&a(h=>({currentStep:Math.max(0,h.currentStep-1)}))},[t,s.currentStep,a]),c=m.useCallback(()=>{a(u=>({isActive:!1,skipped:!0,userPreferences:{...u.userPreferences,hasSeenOnboarding:!0,preferredTourStyle:"minimal"}}))},[a]),d=m.useCallback(()=>{try{localStorage.removeItem("fcz_onboarding_state_v3"),e({isActive:!1,currentStep:0,completed:!1,skipped:!1,userPreferences:{hasSeenOnboarding:!1,preferredTourStyle:"full",completedSteps:[]}})}catch{}},[]);return{state:s,config:t,startOnboarding:i,nextStep:o,prevStep:l,skipOnboarding:c,resetOnboarding:d}},ew=(s,e,t="auto")=>{const r={width:window.innerWidth,height:window.innerHeight},a={top:44,bottom:100,left:16,right:16},i=16,o={top:{x:Math.max(a.left,Math.min(s.left+(s.width-e.width)/2,r.width-e.width-a.right)),y:Math.max(a.top,s.top-e.height-i)},bottom:{x:Math.max(a.left,Math.min(s.left+(s.width-e.width)/2,r.width-e.width-a.right)),y:Math.min(r.height-e.height-a.bottom,s.bottom+i)},left:{x:Math.max(a.left,s.left-e.width-i),y:Math.max(a.top,Math.min(s.top+(s.height-e.height)/2,r.height-e.height-a.bottom))},right:{x:Math.min(r.width-e.width-a.right,s.right+i),y:Math.max(a.top,Math.min(s.top+(s.height-e.height)/2,r.height-e.height-a.bottom))},center:{x:(r.width-e.width)/2,y:(r.height-e.height)/2}};if(t!=="auto")return o[t]||o.center;const l={top:s.top-a.top,bottom:r.height-s.bottom-a.bottom,left:s.left-a.left,right:r.width-s.right-a.right},c={top:l.top>=e.height+i,bottom:l.bottom>=e.height+i,left:l.left>=e.width+i,right:l.right>=e.width+i};return c.bottom?o.bottom:c.top?o.top:c.right&&e.width<300?o.right:c.left&&e.width<300?o.left:o.center},tw=({step:s,position:e,onNext:t,onPrev:r,onSkip:a,isFirst:i,isLast:o,stepNumber:l,totalSteps:c,canSkip:d})=>{const u=m.useCallback(()=>{t()},[t]),h=m.useCallback(()=>{r()},[r]),f=m.useCallback(()=>{a()},[a]);return n.jsxs(pe.div,{className:"fixed bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden max-w-sm z-[25000]",style:{left:e.x,top:e.y,width:"min(calc(100vw - 32px), 380px)"},initial:{scale:.8,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:10},transition:{duration:.2,ease:"easeOut"},children:[n.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[s.icon&&n.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:s.icon}),n.jsx("h3",{className:"font-semibold text-lg",children:s.title})]}),d&&n.jsx("button",{onClick:f,className:"p-1 rounded-lg hover:bg-white/10 transition-colors","aria-label":"Skip tour",children:n.jsx(vt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 bg-white/20 rounded-full h-2",children:n.jsx("div",{className:"bg-white rounded-full h-2 transition-all duration-300",style:{width:`${(l+1)/c*100}%`}})}),n.jsxs("span",{className:"text-xs font-medium",children:[l+1," of ",c]})]})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("p",{className:"text-gray-700 text-sm leading-relaxed mb-4",children:s.description}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("button",{onClick:h,disabled:i,className:"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-100 text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200 transition-colors text-sm font-medium min-w-[80px] justify-center",children:[n.jsx(md,{className:"w-4 h-4"}),"Previous"]}),n.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:c},(p,w)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${w===l?"bg-teal-500":"bg-gray-200"}`},w))}),n.jsx("button",{onClick:u,className:"flex items-center gap-1 px-4 py-2 rounded-xl bg-teal-500 text-white hover:bg-teal-600 transition-colors text-sm font-medium min-w-[80px] justify-center",children:o?n.jsxs(n.Fragment,{children:[n.jsx(Ge,{className:"w-4 h-4"}),"Finish"]}):n.jsxs(n.Fragment,{children:["Next",n.jsx(nx,{className:"w-4 h-4"})]})})]})]})]})},sw=({targetRect:s})=>{const e=m.useMemo(()=>`spotlight-${Math.random().toString(36).substr(2,9)}`,[]);if(!s)return null;const t=Math.max(s.width,s.height)/2+20,r=s.left+s.width/2,a=s.top+s.height/2;return n.jsx("div",{className:"fixed inset-0 z-[24000] pointer-events-none",children:n.jsxs("svg",{width:"100%",height:"100%",className:"absolute inset-0",children:[n.jsx("defs",{children:n.jsxs("mask",{id:e,children:[n.jsx("rect",{width:"100%",height:"100%",fill:"white"}),n.jsx("circle",{cx:r,cy:a,r:t,fill:"black"})]})}),n.jsx("rect",{width:"100%",height:"100%",fill:"rgba(0,0,0,0.7)",mask:`url(#${e})`})]})})},rw=({isActive:s,config:e,currentStep:t,onNext:r,onPrev:a,onSkip:i})=>{const[o,l]=m.useState(null),[c,d]=m.useState(null),[u,h]=m.useState({x:0,y:0}),f=m.useRef(null),p=m.useRef(null),w=m.useRef(null),g=e?.steps[t];if(m.useEffect(()=>{if(!s||!g?.target){l(null),d(null);return}const b=j=>{if(!j)return null;if(/^[.#\[]/.test(j)||j.includes(" "))try{return document.querySelector(j)}catch{return null}return document.querySelector(`[data-tour-id="${j}"]`)||document.querySelector(`[data-tour="${j}"]`)},v=()=>{if(!g?.target){l(null),d(null);return}try{const j=b(g.target);if(j){const S=j.getBoundingClientRect();l(j),d(S),j.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}else l(null),d(null)}catch{}};w.current&&clearTimeout(w.current),w.current=setTimeout(v,g.delay||100);const x=()=>v(),_=()=>v();return window.addEventListener("resize",x),window.addEventListener("scroll",_,!0),window.addEventListener("orientationchange",x),p.current&&p.current.disconnect(),p.current=new ResizeObserver(v),()=>{w.current&&clearTimeout(w.current),window.removeEventListener("resize",x),window.removeEventListener("scroll",_,!0),window.removeEventListener("orientationchange",x),p.current&&p.current.disconnect()}},[s,g,t]),m.useEffect(()=>{if(c&&f.current){const b=new DOMRect(0,0,380,200);let v=ew(c,b,g?.placement||"auto");g?.offset&&(v={x:v.x+(g.offset.x??0),y:v.y+(g.offset.y??0)}),h(v)}},[c,g?.placement]),m.useEffect(()=>{if(s){const b=setTimeout(()=>{const v=document.querySelector("[data-onboarding-tooltip]");v&&v.focus()},100);return()=>clearTimeout(b)}},[s,t]),!s||!e||!g)return null;const y=n.jsx(As,{mode:"wait",children:n.jsxs(pe.div,{className:"fixed inset-0 z-[23000]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[g.action==="spotlight"&&c?n.jsx(sw,{targetRect:c}):n.jsx("div",{className:"absolute inset-0 bg-black/40"}),c&&g.target&&n.jsx(pe.div,{className:"absolute border-4 border-teal-400 rounded-xl pointer-events-none shadow-lg",style:{left:Math.max(0,c.left-4),top:Math.max(0,c.top-4),width:Math.min(window.innerWidth,c.width+8),height:c.height+8},initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3,delay:.1}}),n.jsx("div",{ref:f,"data-onboarding-tooltip":!0,tabIndex:-1,children:n.jsx(tw,{step:g,position:u,onNext:r,onPrev:a,onSkip:i,isFirst:t===0,isLast:t===e.steps.length-1,stepNumber:t,totalSteps:e.steps.length,canSkip:e.allowSkip!==!1})})]},`onboarding-${t}`)});return Vl.createPortal(y,document.body)},nw=({isOpen:s,onStartTour:e,onSkip:t,onMinimalTour:r})=>{const a=m.useCallback(()=>{e()},[e]),i=m.useCallback(()=>{r()},[r]),o=m.useCallback(()=>{t()},[t]);return n.jsx(As,{children:s&&n.jsxs("div",{className:"fixed inset-0 z-[26000] flex items-center justify-center p-4",children:[n.jsx(pe.div,{className:"absolute inset-0 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),n.jsxs(pe.div,{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden w-full max-w-md",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},children:[n.jsxs("div",{className:"bg-gradient-to-br from-purple-500 via-teal-600 to-teal-600 p-6 text-white text-center relative overflow-hidden",children:[n.jsx(pe.div,{className:"absolute inset-0 bg-white/10",animate:{background:["radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%)","radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 0%, transparent 50%)","radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"linear"}}),n.jsxs("div",{className:"relative z-10",children:[n.jsx(pe.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.3},className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(gs,{className:"w-8 h-8"})}),n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to Fan Club Z!"}),n.jsx("p",{className:"text-teal-100 text-sm",children:"Ready to discover the future of social predictions?"})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-400 to-teal-500 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx(ox,{className:"w-5 h-5 text-teal-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Discover Predictions"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Explore trending markets and join the community"})]})]}),n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx(Be,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Make Your Predictions"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Put your knowledge to the test and earn rewards"})]})]}),n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx(Fe,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Manage Everything"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Track your performance and manage your wallet"})]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:a,className:"w-full bg-teal-500 hover:bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold transition-colors flex items-center justify-center gap-2",children:[n.jsx(yd,{className:"w-4 h-4"}),"Take the Tour"]}),n.jsx("button",{onClick:i,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-4 rounded-xl font-medium transition-colors",children:"Quick Overview"}),n.jsxs("button",{onClick:o,className:"w-full text-gray-500 hover:text-gray-700 py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-1",children:[n.jsx(ax,{className:"w-4 h-4"}),"Skip for now"]})]})]})]})]})})},aw={bet:"stake",bets:"stakes",betVerb:"Lock stake",myBets:"Stakes",betSlip:"Prediction ticket",wager:"Stake amount",winnings:"Payout",cashOut:"Withdraw",odds:"Payout ratio",betting:"predicting"};function iw(){return aw}function It(s){return iw()[s]}const ow=[{id:"welcome",title:"Welcome to FanClubZ!",description:`Let's show you the essentials in just 5 quick steps. You'll learn how to discover predictions, create your own, track ${It("bets")}, and manage your wallet.`,placement:"center",icon:n.jsx(gs,{className:"w-6 h-6"}),action:"modal",delay:300},{id:"discover-feed",title:"Discover Predictions",description:`Browse active predictions here. Each card shows the title, category, pool size, and closing date. Tap any card to ${It("betVerb").toLowerCase()}!`,target:"discover-list",placement:"top",offset:{y:-40},icon:n.jsx(Ws,{className:"w-5 h-5"}),action:"highlight"},{id:"create-prediction-fab",title:"Create Your Own",description:"Got an idea? Tap the plus button to create your own prediction and invite others to participate.",target:"create-fab",placement:"left",offset:{x:-16,y:-80},icon:n.jsx(tr,{className:"w-5 h-5"}),action:"spotlight"},{id:"navigate-to-bets",title:"Track Your Stakes",description:`Visit the ${It("myBets")} tab to track all your active predictions, see predictions you've created, and review completed ${It("bets")}.`,target:"tab-bets",placement:"top",offset:{y:-40},icon:n.jsx(is,{className:"w-5 h-5"}),action:"spotlight",onNext:async()=>{const s=window.__router_navigate;s&&(s("/bets"),await new Promise(e=>setTimeout(e,500)))}},{id:"navigate-to-wallet",title:"Manage Your Wallet",description:`Your Wallet is where you add funds, withdraw ${It("winnings").toLowerCase()}, and track all transactions. Let's check it out!`,target:"tab-wallet",placement:"top",offset:{y:-40},icon:n.jsx(Fe,{className:"w-5 h-5"}),action:"spotlight",onNext:async()=>{const s=window.__router_navigate;s&&(s("/wallet"),await new Promise(e=>setTimeout(e,500)),setTimeout(()=>{s("/")},2e3))}}],lw=[{id:"quick-welcome",title:"Welcome!",description:"Let's quickly show you the essentials in 3 steps.",placement:"center",icon:n.jsx(gs,{className:"w-6 h-6"}),action:"modal"},{id:"quick-discover",title:"Browse Predictions",description:"Scroll through active predictions. Tap any card to view details and place your bet.",target:"discover-list",placement:"top",offset:{y:-40},icon:n.jsx(Ws,{className:"w-5 h-5"}),action:"highlight"},{id:"quick-create",title:"Create Predictions",description:"Got an idea? Tap the plus button to create your own prediction. You're all set!",target:"create-fab",placement:"left",offset:{x:-16,y:-80},icon:n.jsx(tr,{className:"w-5 h-5"}),action:"spotlight"}],yl=m.createContext(void 0),wl=ow,cw=lw,dw=()=>{try{const s=localStorage.getItem("fcz_onboarding_state_v3");return s?!JSON.parse(s).userPreferences?.hasSeenOnboarding:!0}catch{return!0}},uw=()=>new URLSearchParams(window.location.search).get("welcome")==="1"||dw(),hw=({children:s})=>{const[e,t]=Qy(),{state:r,config:a,startOnboarding:i,nextStep:o,prevStep:l,skipOnboarding:c,resetOnboarding:d}=Xy(),[u,h]=m.useState(!1),{user:f,loading:p}=J(),w=()=>{const j=e.toLowerCase();return j==="/"||j==="/discover"?!!document.querySelector('[data-tour="discover-header"]'):!0},g=f&&!p&&w();m.useEffect(()=>(window.__router_navigate=t,()=>{delete window.__router_navigate}),[t]),m.useEffect(()=>{if(!f||p)return;const j=()=>{(e==="/"||e==="/discover")&&uw()&&(w()?h(!0):setTimeout(j,200))},S=setTimeout(j,300);return()=>clearTimeout(S)},[f,p,e]),m.useEffect(()=>{const S=new URLSearchParams(window.location.search).get("tour");S==="full"?y():S==="quick"&&b()},[e]);const y=m.useCallback(()=>{if(h(!1),e!=="/"&&e!=="/discover"){t("/");const j=()=>{document.querySelector('[data-tour="discover-header"]')?i({steps:wl,allowSkip:!0,showProgress:!0,persistent:!0}):setTimeout(j,100)};setTimeout(j,200)}else i({steps:wl,allowSkip:!0,showProgress:!0,persistent:!0})},[e,t,i]),b=m.useCallback(()=>{h(!1),i({steps:cw,allowSkip:!0,showProgress:!0,persistent:!1})},[i]),v=m.useCallback(()=>{h(!1),c()},[c]),x=m.useCallback(()=>{d(),h(!0)},[d]),_={isActive:!!(r.isActive&&g),showWelcome:u,startFullTour:y,startQuickTour:b,skipOnboarding:v,resetOnboarding:x,hasSeenOnboarding:r.userPreferences.hasSeenOnboarding,currentStep:r.currentStep,totalSteps:a?.steps.length||0};return!g&&r.isActive?n.jsx(yl.Provider,{value:_,children:s}):n.jsxs(yl.Provider,{value:_,children:[s,g&&n.jsx(nw,{isOpen:u,onStartTour:y,onMinimalTour:b,onSkip:v}),g&&n.jsx(rw,{isActive:r.isActive,config:a,currentStep:r.currentStep,onNext:o,onPrev:l,onSkip:c})]})},Bd=(...s)=>{},fw=({children:s,overrideHeader:e,className:t=""})=>{const r=Ne(),a=le();return(()=>{if(e)return e;const o=r.pathname;switch(!0){case o==="/":case o==="/discover":return{title:"Discover",leftAction:{type:"none"},rightAction:{type:"none"}};case o==="/my-bets":return{title:It("myBets"),leftAction:{type:"none"},rightAction:{type:"none"}};case o==="/wallet":return{title:"Wallet",leftAction:{type:"none"},rightAction:{type:"none"}};case o==="/leaderboard":return{title:"Leaderboard",leftAction:{type:"none"},rightAction:{type:"none"}};case o==="/profile":case o.startsWith("/profile/"):return{title:"Profile",leftAction:o==="/profile"?{type:"none"}:{type:"back",onClick:()=>a(-1),"aria-label":"Go back"},rightAction:{type:"none"}};case o.startsWith("/prediction/"):return{title:"Prediction Details",leftAction:{type:"back",onClick:()=>a(-1),"aria-label":"Go back"},rightAction:{type:"none"}};case o==="/create":return{title:"Create Prediction",leftAction:{type:"close",onClick:()=>a("/"),"aria-label":"Close and go to Discover"},rightAction:{type:"none"}};default:return{title:"Fan Club Z",leftAction:{type:"none"},rightAction:{type:"none"}}}})(),n.jsxs("div",{className:`min-h-screen bg-gray-50 ${t}`,children:[null,n.jsx("main",{className:"flex-1",style:{paddingTop:Kc?"0":void 0},children:s})]})},mw=fw,pw=()=>n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pe.div,{className:"inline-block w-8 h-8 border-4 border-emerald-200 border-t-emerald-600 rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),n.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Loading..."})]})}),gw=pw;function xw(){return m.useEffect(()=>{},[]),null}const yw=({isVisible:s,onRetry:e,onCancel:t})=>s?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full mx-4 shadow-xl",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"mb-4",children:n.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-green-600"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Signing in..."}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:"Please complete the sign-in process in the browser window."}),n.jsxs("div",{className:"flex gap-3 justify-center",children:[e&&n.jsx("button",{onClick:e,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium",children:"Retry"}),t&&n.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm font-medium",children:"Cancel"})]})]})})}):null;function dt(...s){return xu(yu(s))}const ww=({activeTab:s="discover",onTabChange:e,showFAB:t=!1,onFABClick:r,className:a})=>{const i=[{id:"discover",label:"Discover",icon:xd,path:"/"},{id:"bets",label:It("myBets"),icon:is,path:"/bets",badge:0},{id:"leaderboard",label:"Rankings",icon:Aa,path:"/leaderboard"},{id:"wallet",label:"Wallet",icon:Fe,path:"/wallet"},{id:"profile",label:"Profile",icon:je,path:"/profile"}],o=m.useCallback(c=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"}),e&&e(c)},[e]),l=c=>c>99?"99+":c.toString();return n.jsxs(n.Fragment,{children:[n.jsx(pe.div,{className:dt("fixed bottom-0 left-0 right-0 z-[9999]","bg-white/95 backdrop-blur-xl border-t border-gray-200","shadow-[0_-8px_32px_rgba(0,0,0,0.12)]",a),style:{paddingBottom:"max(env(safe-area-inset-bottom), 0.75rem)",paddingTop:"0.75rem",minHeight:"calc(4rem + env(safe-area-inset-bottom))"},initial:{y:100},animate:{y:0},transition:{type:"spring",stiffness:300,damping:30},children:n.jsx("nav",{className:"px-4",children:n.jsx("div",{className:"flex items-center justify-around max-w-lg mx-auto",children:i.map(c=>{const d=c.icon,u=s===c.id,h=c.badge!==void 0&&c.badge>0;return n.jsxs(pe.button,{onClick:()=>o(c.id),className:dt("relative flex flex-col items-center justify-center","p-2 min-w-0 flex-1 rounded-xl transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-emerald-500/20","active:scale-95"),whileHover:{scale:1.02},whileTap:{scale:.98},"data-testid":`nav-tab-${c.id}`,"data-tour":`tab-${c.id}`,"data-tour-id":`tab-${c.id}`,"aria-label":`Navigate to ${c.label}`,role:"tab","aria-selected":u,children:[n.jsxs("div",{className:"relative mb-1",children:[n.jsx(pe.div,{className:dt("flex items-center justify-center w-6 h-6","transition-colors duration-200"),animate:{scale:u?1.1:1,color:u?"#10b981":"#6b7280"},transition:{type:"spring",stiffness:400,damping:25},children:n.jsx(d,{size:20,strokeWidth:u?2.5:2,className:"drop-shadow-sm"})}),n.jsx(As,{children:h&&n.jsx(pe.div,{className:dt("absolute -top-1 -right-1","bg-red-500 text-white text-xs font-semibold","rounded-full min-w-[18px] h-[18px]","flex items-center justify-center","shadow-sm border-2 border-white"),initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:400,damping:25},children:l(c.badge)})}),n.jsx(As,{children:u&&n.jsx(pe.div,{className:"absolute -top-1 left-1/2 w-1 h-1 bg-emerald-500 rounded-full shadow-sm",layoutId:"activeTabIndicator",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{type:"spring",stiffness:400,damping:30},style:{transform:"translateX(-50%)"}})})]}),n.jsx(pe.span,{className:dt("text-xs font-medium text-center leading-tight","transition-colors duration-200"),animate:{color:u?"#10b981":"#6b7280",fontWeight:u?600:500},children:c.label})]},c.id)})})})}),n.jsx(As,{children:t&&n.jsxs(pe.button,{className:dt("fixed z-[10000] w-14 h-14 rounded-full","bg-gradient-to-br from-emerald-500 to-emerald-600","shadow-lg shadow-emerald-500/25","flex items-center justify-center","focus:outline-none focus:ring-4 focus:ring-emerald-500/20","active:scale-95 hover:shadow-xl hover:shadow-emerald-500/30","transition-shadow duration-200"),style:{bottom:"calc(5rem + env(safe-area-inset-bottom))",right:"1rem"},initial:{scale:0,opacity:0,rotate:-180},animate:{scale:1,opacity:1,rotate:0},exit:{scale:0,opacity:0,rotate:180},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:r,"data-testid":"create-fab","data-tour":"create-fab","data-tour-id":"create-fab","aria-label":"Create new prediction",transition:{type:"spring",stiffness:300,damping:25},children:[n.jsx(tr,{size:24,className:"text-white drop-shadow-sm",strokeWidth:2.5}),n.jsx(pe.div,{className:"absolute inset-0 rounded-full bg-emerald-400 opacity-0",animate:{scale:[1,1.2,1],opacity:[0,.3,0]},transition:{duration:2,repeat:1/0,repeatType:"reverse"}})]})})]})},bw=ww;function vw(s){const e=_w(s),t=m.forwardRef((r,a)=>{const{children:i,...o}=r,l=m.Children.toArray(i),c=l.find(Nw);if(c){const d=c.props.children,u=l.map(h=>h===c?m.Children.count(d)>1?m.Children.only(null):m.isValidElement(d)?d.props.children:null:h);return n.jsx(e,{...o,ref:a,children:m.isValidElement(d)?m.cloneElement(d,void 0,u):null})}return n.jsx(e,{...o,ref:a,children:i})});return t.displayName=`${s}.Slot`,t}function _w(s){const e=m.forwardRef((t,r)=>{const{children:a,...i}=t;if(m.isValidElement(a)){const o=Sw(a),l=Ew(i,a.props);return a.type!==m.Fragment&&(l.ref=r?eu(r,o):o),m.cloneElement(a,l)}return m.Children.count(a)>1?m.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var jw=Symbol("radix.slottable");function Nw(s){return m.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===jw}function Ew(s,e){const t={...e};for(const r in e){const a=s[r],i=e[r];/^on[A-Z]/.test(r)?a&&i?t[r]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(t[r]=a):r==="style"?t[r]={...a,...i}:r==="className"&&(t[r]=[a,i].filter(Boolean).join(" "))}return{...s,...t}}function Sw(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var kw=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Cw=kw.reduce((s,e)=>{const t=vw(`Primitive.${e}`),r=m.forwardRef((a,i)=>{const{asChild:o,...l}=a,c=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...s,[e]:r}},{}),Tw=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Aw="VisuallyHidden",Da=m.forwardRef((s,e)=>n.jsx(Cw.span,{...s,ref:e,style:{...Tw,...s.style}}));Da.displayName=Aw;const Pw={}.VITE_WC_PROJECT_ID||"a376a3c48ca99bd80c5b30a37652a5ae",_s=Pw.length>=8,Iw=()=>/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<=768&&"ontouchstart"in window;function Rw({isOpen:s,onClose:e}){const{connect:t,connectors:r,status:a,error:i}=nu(),[o,l]=m.useState(!!s),[c,d]=m.useState(null),u=Iw(),h=_s?r.find(y=>y.id==="walletConnect"):null,f=m.useRef(!1),p=m.useRef(0);m.useEffect(()=>{o&&(f.current=!1,d(null))},[o]);const w=m.useCallback(async y=>{const b=Date.now();if(!(f.current&&b-p.current<1e4)){f.current=!0,p.current=b,d(null);try{await t({connector:y}),e?e():l(!1)}catch(v){const x=v?.message||"Failed to connect wallet";d(x),x.includes("403")||x.includes("Forbidden")?B.error("WalletConnect configuration error. Please contact support."):x.includes("User rejected")?B.error("Connection cancelled"):B.error(x),f.current=!1}}},[t,e]);m.useEffect(()=>{typeof s=="boolean"&&l(s)},[s]),m.useEffect(()=>{if(typeof s=="boolean")return;const y=()=>{l(!0)};return window.addEventListener("fcz:wallet:connect",y),()=>window.removeEventListener("fcz:wallet:connect",y)},[s]);const g=r.find(y=>y.id==="injected");return n.jsx($l,{open:o,onOpenChange:y=>{typeof s=="boolean"?!y&&e&&e():l(y)},children:n.jsxs(Ul,{children:[n.jsx(Bl,{className:"fixed inset-0 bg-black/30 z-modal"}),n.jsxs(Fl,{className:"z-modal fixed inset-x-0 rounded-t-2xl bg-white shadow-xl bottom-[calc(64px+env(safe-area-inset-bottom,0px))] max-h-[calc(100vh-env(safe-area-inset-top,0px)-64px-env(safe-area-inset-bottom,0px))] focus:outline-none",children:[n.jsx(Ml,{asChild:!0,children:n.jsx(Da,{children:"Connect wallet"})}),n.jsx(tu,{asChild:!0,children:n.jsx(Da,{children:"Select a wallet provider"})}),n.jsx("div",{className:"mx-auto mt-2 mb-3 h-1.5 w-16 rounded-full bg-gray-200"}),n.jsxs("div",{className:"px-4 pb-3",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Connect wallet"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Choose a wallet provider to continue."})]}),n.jsxs("div",{className:"overflow-y-auto pb-safe px-4 pt-3",children:[u?n.jsx("div",{className:"rounded-xl border border-gray-100 overflow-hidden",children:n.jsxs("button",{type:"button",disabled:!h||!_s,onClick:()=>h&&w(h),className:"flex w-full items-center justify-between px-4 py-4 hover:bg-gray-50 disabled:opacity-50",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-2xl",children:"ðŸª¢"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"WalletConnect"}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Connect your mobile wallet",!_s&&n.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(add VITE_WC_PROJECT_ID)"})]})]})]}),n.jsx("span",{className:"text-gray-400",children:"â€º"})]})}):n.jsxs("ul",{className:"divide-y divide-gray-100 rounded-xl border border-gray-100 overflow-hidden",children:[n.jsx("li",{children:n.jsxs("button",{type:"button",disabled:!g,onClick:()=>g&&w(g),className:"flex w-full items-center justify-between px-4 py-4 hover:bg-gray-50 disabled:opacity-50",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-2xl",children:"ðŸ¦Š"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"Browser Wallet"}),n.jsx("div",{className:"text-xs text-gray-500",children:"MetaMask or compatible"})]})]}),n.jsx("span",{className:"text-gray-400",children:"â€º"})]})}),n.jsx("li",{children:n.jsxs("button",{type:"button",disabled:!h||!_s,onClick:()=>h&&w(h),className:"flex w-full items-center justify-between px-4 py-4 hover:bg-gray-50 disabled:opacity-50",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-2xl",children:"ðŸª¢"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:"WalletConnect"}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Mobile wallets (QR / deep link)",!_s&&n.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(add VITE_WC_PROJECT_ID)"})]})]})]}),n.jsx("span",{className:"text-gray-400",children:"â€º"})]})})]}),(a==="error"||c)&&n.jsxs("div",{className:"px-4 pt-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-red-600",children:c||String(i?.message??"Failed to connect")}),c&&n.jsx("button",{type:"button",onClick:()=>{f.current=!1,d(null)},className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Try again"})]}),n.jsx("div",{className:"h-3"})]}),n.jsx(zn,{className:"absolute right-3 top-2 rounded-full p-2 text-gray-500 hover:bg-gray-100","aria-label":"Close",children:"âœ•"})]})]})})}function Ow({icon:s,title:e,description:t,primaryAction:r,secondaryAction:a,className:i}){return n.jsxs("div",{className:dt("flex flex-col items-center justify-center text-center py-12 px-4",i),children:[s&&n.jsx("div",{className:"mb-4 text-gray-300",children:Ie.cloneElement(s,{className:dt("w-6 h-6 md:w-8 md:h-8",s.props.className)})}),n.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-2",children:e}),t&&n.jsx("p",{className:"text-sm md:text-base text-gray-600 mb-6 max-w-sm leading-relaxed",children:t}),(r||a)&&n.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-3 sm:space-y-0 sm:space-x-3",children:[r,a]})]})}function Lw({icon:s,title:e,description:t,intent:r="view_my_bets",payload:a,className:i}){const o=async()=>{try{await Ei({intent:r,payload:a})}catch{}};return n.jsx(Ow,{icon:s,title:e,description:t,primaryAction:n.jsx("button",{onClick:o,className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"}),className:i})}const $i="ref_code",Ui="fanclubz_ref_code",Dw=90,Fd=()=>!0,Md=()=>{const s=new URLSearchParams(window.location.search),e=s.get("ref")||s.get("ref_code");if(e)return $a(e),e;const t=Uw($i);if(t)return t;try{return localStorage.getItem(Ui)}catch{return null}},$a=s=>{if(!Fd()||!s)return;const e=new Date;e.setDate(e.getDate()+Dw),document.cookie=`${$i}=${s}; expires=${e.toUTCString()}; path=/; SameSite=Lax`;try{localStorage.setItem(Ui,s)}catch{}},$w=()=>{document.cookie=`${$i}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`;try{localStorage.removeItem(Ui)}catch{}},Uw=s=>{const t=`; ${document.cookie}`.split(`; ${s}=`);return t.length===2&&t.pop()?.split(";").shift()||null},Vd=s=>s?`http://localhost:5174/r/${s}`:null,Bw=async s=>{const e=Vd(s);if(!e)return!1;try{return await navigator.clipboard.writeText(e),!0}catch{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.focus(),t.select();try{return document.execCommand("copy"),!0}catch{return!1}finally{document.body.removeChild(t)}}},Fw=async s=>{const e=Md();if(!e)return{attributed:!1,reason:"no_code"};try{const t=ne(),r=await fetch(`${t}/api/referrals/attribute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s,refCode:e})});if(!r.ok)return{attributed:!1,reason:"request_failed"};const a=await r.json();return a.data?.attributed?($w(),{attributed:!0}):{attributed:!1,reason:a.data?.reason||"unknown"}}catch{return{attributed:!1,reason:"error"}}},Mw=async s=>{try{const e=ne();await fetch(`${e}/api/referrals/log-login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s,source:"web"})})}catch{}},Vw=async s=>{try{const e=ne(),t=await fetch(`${e}/api/referrals/my-stats?userId=${s}`,{method:"GET",headers:{"Content-Type":"application/json"}});return t.ok&&(await t.json()).data||null}catch{return null}},r_=async(s=50,e="all")=>{try{const t=ne(),r=await fetch(`${t}/api/leaderboard/referrals?limit=${s}&period=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});return r.ok?(await r.json()).data?.items||[]:[]}catch{return[]}},n_=()=>{const{user:s}=ae(),[e,t]=m.useState(null),[r,a]=m.useState(!1),i=m.useMemo(()=>Fd(),[]),o=m.useMemo(()=>e?.referralCode?e.referralCode:(s?.user_metadata||{}).referral_code||null,[e,s]),l=m.useMemo(()=>Vd(o),[o]),c=m.useCallback(async()=>{if(!(!i||!s?.id)){a(!0);try{const u=await Vw(s.id);t(u)}finally{a(!1)}}},[i,s?.id]);m.useEffect(()=>{i&&s?.id&&c()},[i,s?.id,c]);const d=m.useCallback(async()=>o?Bw(o):!1,[o]);return{isEnabled:i,referralCode:o,referralLink:l,stats:e,statsLoading:r,copyLink:d,refreshStats:c}},zw=()=>{m.useEffect(()=>{const s=window.location.pathname.match(/^\/r\/([a-zA-Z0-9]+)/);if(s?.[1]){$a(s[1]);return}const e=new URLSearchParams(window.location.search),t=e.get("ref")||e.get("ref_code");t&&$a(t)},[])},qw=()=>{const{user:s,initialized:e}=ae(),[t,r]=m.useState(!1);m.useEffect(()=>{if(!e||!s?.id||t)return;(async()=>{if(!Md())return;(await Fw(s.id)).attributed&&r(!0)})(),Mw(s.id)},[s?.id,e,t])},_e=({children:s})=>{const{user:e,loading:t,initialized:r}=ae(),a=le(),[i,o]=m.useState(null),[l,c]=m.useState(!0);return m.useEffect(()=>{(async()=>{if(r){if(!e){o(!1),c(!1);return}try{const u=await fetch(`${ne()}/api/v2/admin/audit?limit=1&actorId=${e.id}`,{headers:{"Content-Type":"application/json"}});u.ok?o(!0):(u.status===403||u.status,o(!1))}catch{o(!1)}finally{c(!1)}}})()},[e,r]),t||!r||l?n.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-slate-400",children:"Checking access..."})]})}):e?i?n.jsx(n.Fragment,{children:s}):n.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center max-w-md px-6",children:[n.jsx(as,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Access Denied"}),n.jsx("p",{className:"text-slate-400 mb-6",children:"You don't have permission to access the admin dashboard. Contact support if you believe this is an error."}),n.jsx("button",{onClick:()=>a("/"),className:"px-6 py-3 bg-slate-700 text-white rounded-lg hover:bg-slate-600 transition-colors",children:"Return to App"})]})}):n.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center max-w-md px-6",children:[n.jsx(as,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),n.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Authentication Required"}),n.jsx("p",{className:"text-slate-400 mb-6",children:"Please sign in to access the admin dashboard."}),n.jsx("button",{onClick:()=>a("/"),className:"px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"Go to App"})]})})},Ww=[{path:"/admin",label:"Overview",icon:hx,exact:!0},{path:"/admin/users",label:"Users",icon:Bt},{path:"/admin/wallets",label:"Wallets",icon:Fe},{path:"/admin/predictions",label:"Predictions",icon:Be},{path:"/admin/settlements",label:"Settlements",icon:gd},{path:"/admin/moderation",label:"Moderation",icon:ka},{path:"/admin/audit",label:"Audit Log",icon:Ta},{path:"/admin/config",label:"Config",icon:wd}],we=({children:s})=>{const{user:e}=ae();le();const t=Xs;return n.jsxs("div",{className:"min-h-screen bg-slate-900 flex",children:[n.jsxs("aside",{className:"w-64 bg-slate-800 border-r border-slate-700 flex flex-col",children:[n.jsx("div",{className:"p-4 border-b border-slate-700",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-600 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold text-lg",children:"F"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-white font-semibold",children:"Fan Club Z"}),n.jsx("p",{className:"text-xs text-slate-400",children:"Admin Dashboard"})]})]})}),n.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:Ww.map(r=>n.jsxs(ac,{to:r.path,end:r.exact,className:({isActive:a})=>`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${a?"bg-emerald-600/20 text-emerald-400":"text-slate-400 hover:text-white hover:bg-slate-700/50"}`,children:[n.jsx(r.icon,{className:"w-5 h-5"}),r.label]},r.path))}),n.jsxs("div",{className:"p-4 border-t border-slate-700 space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 px-3 py-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center",children:n.jsx("span",{className:"text-white text-sm font-medium",children:e?.email?.[0]?.toUpperCase()||"A"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm text-white truncate",children:e?.email||"Admin"}),n.jsx("p",{className:"text-xs text-slate-400",children:"Administrator"})]})]}),n.jsxs("button",{onClick:()=>window.open(t,"_self"),className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-700/50 transition-colors",children:[n.jsx(md,{className:"w-5 h-5"}),"Back to App"]})]})]}),n.jsx("main",{className:"flex-1 overflow-auto",children:n.jsx("div",{className:"p-6",children:s})})]})},Hw=we,Ur=os(s=>({active:!1,message:"The platform is currently under maintenance. Please check back soon.",setMaintenance:e=>s({active:!0,message:e||"The platform is currently under maintenance. Please check back soon."}),clear:()=>s({active:!1})}));function Kw(){const{active:s,message:e}=Ur();return s?n.jsx("div",{className:"fixed inset-0 z-[2147483646] bg-white",children:n.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:n.jsxs("div",{className:"w-full max-w-sm text-center",children:[n.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-amber-100 text-amber-700",children:n.jsx(_d,{className:"h-6 w-6"})}),n.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Maintenance mode"}),n.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e}),n.jsxs("button",{type:"button",onClick:()=>window.location.reload(),className:"mt-6 inline-flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-semibold text-white hover:bg-emerald-700",children:[n.jsx(px,{className:"h-4 w-4"}),"Retry"]})]})})}):null}const Gw=m.lazy(()=>H(()=>import("./DiscoverPage-9bcffad8.js"),["assets/DiscoverPage-9bcffad8.js","assets/wagmi-c444efa6.js","assets/vendor-c36eaa8e.js","assets/utils-617af415.js","assets/ui-c369d1f3.js","assets/CreatorByline-9bede90f.js","assets/format-14414da9.js","assets/input-0cc3cd56.js","assets/index-cca8fa81.js","assets/utils-ae6b997d.js","assets/useUnifiedBalance-69bdcc40.js","assets/useEscrowBalance-5c6e362b.js","assets/DepositUSDCModal-4620608e.js","assets/useWalletConnectSession-1627a74c.js","assets/cooldowns-a5c743e7.js","assets/useFiatWallet-4b2d48ae.js","assets/arrow-up-right-87b90fb4.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/useCategories-dd2ff1dd.js"])),Zw=m.lazy(()=>H(()=>import("./PredictionsPage-5d5dcaba.js"),["assets/PredictionsPage-5d5dcaba.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/useMerkleClaim-2ef83797.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/useWalletConnectSession-1627a74c.js","assets/input-0cc3cd56.js","assets/index-cca8fa81.js","assets/utils-ae6b997d.js","assets/trash-2-b77d99dc.js","assets/pen-line-0d53dd19.js","assets/share-2-f58723c5.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/useClaimableClaims-8ac6c19f.js","assets/format-14414da9.js"])),Jw=m.lazy(()=>H(()=>import("./CreatePredictionPage-03ef9eb0.js"),["assets/CreatePredictionPage-03ef9eb0.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/useCategories-dd2ff1dd.js"]));m.lazy(()=>H(()=>import("./ProfilePage-54401e6e.js"),["assets/ProfilePage-54401e6e.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/UserAvatar-92d363fe.js","assets/index-cca8fa81.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/utils-ae6b997d.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/format-14414da9.js","assets/pen-line-0d53dd19.js"]));m.lazy(()=>H(()=>import("./WalletPage-15bf6fa5.js"),["assets/WalletPage-15bf6fa5.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/format-14414da9.js","assets/useEscrowBalance-5c6e362b.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js","assets/DepositUSDCModal-4620608e.js","assets/useWalletConnectSession-1627a74c.js","assets/WithdrawUSDCModal-1d812251.js","assets/utils-ae6b997d.js","assets/arrow-down-to-line-3ec1fc28.js"]));const Yw=m.lazy(()=>H(()=>import("./PredictionDetailsPageV2-4e662ff5.js"),["assets/PredictionDetailsPageV2-4e662ff5.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/useFiatWallet-4b2d48ae.js","assets/useUnifiedBalance-69bdcc40.js","assets/useEscrowBalance-5c6e362b.js","assets/DepositUSDCModal-4620608e.js","assets/useWalletConnectSession-1627a74c.js","assets/runtime-1fefd008.js","assets/message-circle-051707de.js","assets/CreatorByline-9bede90f.js","assets/useActivityFeed-afbe2e9d.js","assets/format-14414da9.js","assets/trash-2-b77d99dc.js","assets/useMerkleClaim-2ef83797.js","assets/share-2-f58723c5.js"])),bl=m.lazy(()=>H(()=>import("./ProfilePageV2-214eb736.js"),["assets/ProfilePageV2-214eb736.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/UserAvatar-92d363fe.js","assets/index-cca8fa81.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/utils-ae6b997d.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/format-14414da9.js","assets/txFormat-714ffd43.js","assets/useActivityFeed-afbe2e9d.js","assets/gift-cbf334a5.js","assets/share-2-f58723c5.js","assets/message-circle-051707de.js","assets/OGBadge-a4548af7.js","assets/pen-line-0d53dd19.js"])),Qw=m.lazy(()=>H(()=>import("./DownloadPage-def3937e.js"),["assets/DownloadPage-def3937e.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js"]));m.lazy(()=>H(()=>import("./WalletPageV2-3ca505d4.js"),["assets/WalletPageV2-3ca505d4.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js","assets/format-14414da9.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/txFormat-714ffd43.js","assets/useClaimableClaims-8ac6c19f.js","assets/useMerkleClaim-2ef83797.js","assets/useWalletConnectSession-1627a74c.js","assets/DepositUSDCModal-4620608e.js","assets/WithdrawUSDCModal-1d812251.js","assets/utils-ae6b997d.js","assets/useAutoNetworkSwitch-7bfb655b.js","assets/useFiatWallet-4b2d48ae.js","assets/useUnifiedBalance-69bdcc40.js","assets/useEscrowBalance-5c6e362b.js","assets/arrow-up-right-87b90fb4.js"]));const Xw=m.lazy(()=>H(()=>import("./UnifiedWalletPage-7a335436.js"),["assets/UnifiedWalletPage-7a335436.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/Page-e098f488.js","assets/format-14414da9.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/DepositUSDCModal-4620608e.js","assets/useWalletConnectSession-1627a74c.js","assets/WithdrawUSDCModal-1d812251.js","assets/utils-ae6b997d.js","assets/useAutoNetworkSwitch-7bfb655b.js","assets/useFiatWallet-4b2d48ae.js","assets/txFormat-714ffd43.js","assets/cooldowns-a5c743e7.js","assets/runtime-1fefd008.js","assets/arrow-down-to-line-3ec1fc28.js"])),eb=m.lazy(()=>H(()=>import("./UnifiedLeaderboardPage-3537df18.js"),["assets/UnifiedLeaderboardPage-3537df18.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/UserAvatar-92d363fe.js","assets/index-cca8fa81.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js","assets/utils-ae6b997d.js","assets/OGBadge-a4548af7.js","assets/AppHeader-5f619f9e.js","assets/useNotifications-29ac0910.js","assets/format-14414da9.js","assets/gift-cbf334a5.js"])),tb=m.lazy(()=>H(()=>import("./AuthCallback-6d420bf9.js"),["assets/AuthCallback-6d420bf9.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js"])),sb=m.lazy(()=>H(()=>import("./ReferralRedirectPage-e651ea2a.js"),["assets/ReferralRedirectPage-e651ea2a.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/gift-cbf334a5.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js"])),rb=m.lazy(()=>H(()=>import("./NotificationsPage-940bf374.js"),["assets/NotificationsPage-940bf374.js","assets/ui-c369d1f3.js","assets/vendor-c36eaa8e.js","assets/useNotifications-29ac0910.js","assets/Page-e098f488.js","assets/message-circle-051707de.js","assets/utils-617af415.js","assets/wagmi-c444efa6.js"])),nb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Tb),void 0)),ab=m.lazy(()=>H(()=>Promise.resolve().then(()=>zb),void 0)),ib=m.lazy(()=>H(()=>Promise.resolve().then(()=>Ab),void 0)),ob=m.lazy(()=>H(()=>Promise.resolve().then(()=>Pb),void 0)),lb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Rb),void 0)),cb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Ob),void 0)),db=m.lazy(()=>H(()=>Promise.resolve().then(()=>Lb),void 0)),ub=m.lazy(()=>H(()=>Promise.resolve().then(()=>$b),void 0)),hb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Mb),void 0)),fb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Vb),void 0)),mb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Ub),void 0)),pb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Bb),void 0)),gb=m.lazy(()=>H(()=>Promise.resolve().then(()=>Fb),void 0)),zd=({message:s="Loading..."})=>n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto"}),n.jsx("p",{className:"mt-2 text-gray-600",children:s})]})}),qd=m.memo(({children:s})=>{const e=Ne(),t=le(),{user:r}=ae(),a=!!r,i=m.useRef(e.pathname);m.useEffect(()=>{i.current=e.pathname},[]),m.useEffect(()=>{const f=e.pathname,p=i.current;f!==p&&(my(p,f),i.current=f)},[e.pathname]);const o=m.useCallback(f=>{const p=f.toLowerCase();return p==="/"?p:p.replace(/\/+$/,"")},[]),l=m.useCallback(()=>{const f=o(e.pathname);return f==="/"||f==="/discover"?"discover":f==="/bets"||f==="/predictions"?"bets":f==="/leaderboard"?"leaderboard":f==="/profile"?"profile":f==="/wallet"?"wallet":"discover"},[e.pathname,o]),c=m.useCallback(f=>{const p=o(e.pathname);if(!((p==="/"||p==="/discover"||p==="/bets"||p==="/predictions"||p==="/leaderboard"||p==="/profile"||p==="/wallet")&&(f==="discover"&&(p==="/"||p==="/discover")||f==="bets"&&(p==="/bets"||p==="/predictions")||f==="leaderboard"&&p==="/leaderboard"||f==="profile"&&p==="/profile"||f==="wallet"&&p==="/wallet"))){switch(Ks(e.pathname),rn(),window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0,f){case"discover":t("/");break;case"bets":t("/predictions");break;case"leaderboard":t("/leaderboard");break;case"profile":t("/profile");break;case"wallet":t("/wallet");break;default:t("/")}requestAnimationFrame(()=>{window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0,setTimeout(()=>{fy({behavior:"instant"})},50)})}},[t,e]),d=m.useCallback(async()=>a?!0:(qs("/create"),(await Ei({intent:"create_prediction"})).status==="success"),[a]),u=m.useCallback(()=>{(async()=>{await d()&&(Ks(e.pathname),rn(),t("/create"))})()},[t,e.pathname,d]),h=(()=>{const f=o(e.pathname);return f==="/"||f==="/discover"})();return n.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col","data-scroll-container":!0,children:[n.jsx(Kw,{}),n.jsx("main",{className:"flex-1 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:n.jsx(m.Suspense,{fallback:n.jsx(zd,{message:"Loading page..."}),children:s})}),n.jsx(bw,{activeTab:l(),onTabChange:c,showFAB:h,onFABClick:u}),n.jsx(wy,{}),n.jsx(Ay,{}),n.jsx(hy,{position:"top-center",containerStyle:{zIndex:2147483647},toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff",zIndex:2147483647}}})]})});qd.displayName="MainLayout";const xb=()=>{const{user:s,session:e,initialized:t}=ae(),{initializeAuth:r,isAuthenticated:a,initialized:i,user:o}=J();return zw(),qw(),m.useEffect(()=>{if(t)if(s&&e){const l=J.getState().user;if(!J.getState().isAuthenticated||!l||l.id!==s.id){const d={id:s.id,firstName:s.user_metadata?.firstName||s.user_metadata?.first_name||s.user_metadata?.full_name?.split(" ")[0]||"User",lastName:s.user_metadata?.lastName||s.user_metadata?.last_name||s.user_metadata?.full_name?.split(" ").slice(1).join(" ")||"",email:s.email||"",phone:s.phone,avatar:s.user_metadata?.avatar_url||s.user_metadata?.picture,provider:s.app_metadata?.provider||"email",createdAt:s.created_at};J.setState({isAuthenticated:!0,user:d,token:e.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()})}}else!s&&a&&J.setState({isAuthenticated:!1,user:null,token:null,lastAuthCheck:0})},[s,e,t,a]),m.useEffect(()=>{Ig()},[]),null},Fn=()=>{const s=Ne(),e=le(),t=m.useCallback(()=>{Ks(s.pathname),e("/profile")},[e,s.pathname]),r=m.useCallback(a=>{Ks(s.pathname);const i=`${s.pathname}${s.search}${s.hash}`;e(`/prediction/${a}`,{state:{from:i}})},[e,s.pathname,s.search,s.hash]);return n.jsx(Gw,{onNavigateToProfile:t,onNavigateToPrediction:r})},vl=()=>{const s=Ne(),e=le(),t=m.useCallback(()=>{Ks(s.pathname),e("/")},[e,s.pathname]);return n.jsx(Zw,{onNavigateToDiscover:t})},yb=()=>{Ne();const s=le(),{user:e,loading:t}=ae(),r=!!e,a=m.useRef(!1),i=m.useCallback(()=>{rn(),s("/")},[s]);return m.useEffect(()=>{!r&&!t&&!a.current&&(a.current=!0,qs("/create"),Ei({intent:"create_prediction"}))},[r,t]),r?n.jsx($t,{title:"Create Prediction",children:n.jsx(Jw,{onNavigateBack:i})}):n.jsx($t,{title:"Create Prediction",children:n.jsx("div",{className:"px-4 py-12",children:n.jsx(Lw,{icon:n.jsx(gs,{className:"w-10 h-10 text-emerald-500"}),title:"Sign in to create predictions",description:"You need to be signed in to create and publish predictions. Your progress will be saved automatically.",intent:"create_prediction"})})})},_l=()=>n.jsx($t,{title:"Leaderboard",children:n.jsx(eb,{})}),jl=()=>{const{id:s}=ds(),e=le(),[t,r]=Ie.useState(null),[a,i]=Ie.useState(!0),o=m.useCallback(()=>{window.history.length>1?window.history.back():(rn(),e("/"))},[e]);return Ie.useEffect(()=>{(async()=>{if(!s){i(!1);return}if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(s)){r(s),i(!1);return}try{const d=(await H(()=>Promise.resolve().then(()=>fd),void 0)).getApiUrl(),u=await fetch(`${d}/api/v2/predictions/resolve/slug/${encodeURIComponent(s)}`,{method:"GET"});if(!u.ok)throw new Error(`resolve failed ${u.status}`);const h=await u.json();h?.id&&r(h.id)}catch{}finally{i(!1)}})()},[s]),s?a?n.jsx(zd,{message:"Loading prediction..."}):t?n.jsx(Yw,{predictionId:t}):n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Prediction Not Found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"The prediction you're looking for doesn't exist."}),n.jsx("button",{onClick:o,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:"Go Back"})]})}):n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Prediction Not Found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"The prediction you're looking for doesn't exist."}),n.jsx("button",{onClick:o,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:"Go Back"})]})})},wb=()=>{const{initializeWallet:s}=gg(),{initializeAuth:e,loading:t,initialized:r}=J(),{initializeLikes:a}=Ng(),{user:i,loading:o,initialized:l}=ae(),c=o||t,d=!!i;return m.useEffect(()=>{if(!r&&!t&&l)try{i||e()}catch{}},[e,r,t,l,i]),m.useEffect(()=>{if(d&&!c&&l)try{s(),a()}catch{}},[d,c,l,s,a]),m.useEffect(()=>{l&&!J.getState().initialized&&J.setState({initialized:!0,loading:!1})},[l]),n.jsxs(hw,{children:[n.jsx(mw,{children:n.jsx(m.Suspense,{fallback:n.jsx(gw,{}),children:n.jsxs(Vr,{children:[n.jsx(L,{path:"/admin",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(nb,{})})})}),n.jsx(L,{path:"/admin/audit",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(ab,{})})})}),n.jsx(L,{path:"/admin/users",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(ib,{})})})}),n.jsx(L,{path:"/admin/users/:userId",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(ob,{})})})}),n.jsx(L,{path:"/admin/wallets",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(lb,{})})})}),n.jsx(L,{path:"/admin/wallets/:userId",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(cb,{})})})}),n.jsx(L,{path:"/admin/predictions",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(db,{})})})}),n.jsx(L,{path:"/admin/predictions/:predictionId",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(ub,{})})})}),n.jsx(L,{path:"/admin/moderation",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(hb,{})})})}),n.jsx(L,{path:"/admin/config",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(fb,{})})})}),n.jsx(L,{path:"/admin/settlements",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(mb,{})})})}),n.jsx(L,{path:"/admin/settlements/:predictionId",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(pb,{})})})}),n.jsx(L,{path:"/admin/support",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx(gb,{})})})}),n.jsx(L,{path:"/admin/*",element:n.jsx(_e,{children:n.jsx(we,{children:n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-slate-400",children:"Page coming soon"})})})})}),n.jsx(L,{path:"*",element:n.jsx(qd,{children:n.jsxs(Vr,{children:[n.jsx(L,{path:"/",element:n.jsx(Fn,{})}),n.jsx(L,{path:"/discover",element:n.jsx(Fn,{})}),n.jsx(L,{path:"/auth/callback",element:n.jsx(tb,{})}),n.jsx(L,{path:"/r/:code",element:n.jsx(sb,{})}),n.jsx(L,{path:"/predictions",element:n.jsx(vl,{})}),n.jsx(L,{path:"/predictions/:id",element:n.jsx(jl,{})}),n.jsx(L,{path:"/bets",element:n.jsx(vl,{})}),n.jsx(L,{path:"/leaderboard",element:n.jsx(_l,{})}),n.jsx(L,{path:"/create",element:n.jsx(yb,{})}),n.jsx(L,{path:"/profile",element:n.jsx($t,{title:"Profile",children:n.jsx(bl,{})})}),n.jsx(L,{path:"/profile/:userId",element:n.jsx($t,{title:"Profile",children:n.jsx(bl,{})})}),n.jsx(L,{path:"/wallet",element:n.jsx($t,{title:"Wallet",children:n.jsx(Xw,{})})}),n.jsx(L,{path:"/notifications",element:n.jsx($t,{title:"Notifications",children:n.jsx(rb,{})})}),n.jsx(L,{path:"/rankings",element:n.jsx(_l,{})}),n.jsx(L,{path:"/prediction/:id",element:n.jsx(jl,{})}),n.jsx(L,{path:"/download",element:n.jsx(Qw,{})}),n.jsx(L,{path:"*",element:n.jsx(Fn,{})})]})})})]})})}),n.jsx(Sd,{}),n.jsx(xb,{})]})};function bb(){const[s,e]=Ie.useState(!1),[t,r]=Ie.useState(!1);Ie.useEffect(()=>{const o=l=>{const{started:c,completed:d,error:u}=l.detail;c?(e(!0),r(!1)):(d||u)&&(e(!1),r(!!u))};return window.addEventListener("auth-in-progress",o),()=>{window.removeEventListener("auth-in-progress",o)}},[]);const a=()=>{e(!1),r(!1)},i=()=>{e(!1),r(!1)};return n.jsxs(Pa,{children:[n.jsx(xw,{}),n.jsx(ga,{children:n.jsx(xa,{children:n.jsxs(Y0,{children:[n.jsx(wb,{}),n.jsx(Rw,{}),n.jsx(yw,{isVisible:s,onRetry:t?a:void 0,onCancel:i})]})})})]})}const vb=new Date().getFullYear(),_b=()=>{const s=le();J();const e="https://app.fanclubz.app",t=()=>{window.location.href=`${e}/discover`};return n.jsxs("div",{className:"bg-gradient-to-b from-[#211234] via-[#1b1130] to-[#130c24] text-white min-h-screen",children:[n.jsx("header",{className:"sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/5",children:n.jsx("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("img",{src:"/brand/fcz-logomark.png",alt:"FanClubZ",className:"h-8 w-8",style:{objectFit:"contain"}}),n.jsx("span",{className:"text-lg font-semibold tracking-wide",children:"FanClubZ"})]})})}),n.jsxs("main",{children:[n.jsxs("section",{className:"relative overflow-hidden",children:[n.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(600px_circle_at_20%_20%,rgba(34,197,94,0.15),transparent_60%),radial-gradient(600px_circle_at_80%_0%,rgba(59,130,246,0.12),transparent_60%)]"}),n.jsx("div",{className:"relative mx-auto max-w-6xl px-4 py-16 md:py-20",children:n.jsxs("div",{className:"mx-auto max-w-3xl text-center",children:[n.jsx("h1",{className:"text-balance text-4xl font-extrabold leading-tight sm:text-5xl",children:"Predict trending topics with friends"}),n.jsx("p",{className:"mt-4 text-lg text-white/80",children:"Make a prediction, lock a stake, compare outcomes with friends."}),n.jsx("div",{className:"mt-8 flex flex-wrap items-center justify-center gap-3",children:n.jsx("button",{onClick:t,className:"inline-flex items-center gap-2 rounded-xl bg-emerald-500 px-6 py-3 text-sm font-semibold text-black shadow-xl transition hover:brightness-95",children:"Get started"})})]})})]}),n.jsxs("section",{className:"mx-auto max-w-6xl px-4 py-10",children:[n.jsx("h2",{className:"text-center text-2xl font-bold",children:"Why choose FanClubZ?"}),n.jsx("p",{className:"mx-auto mt-2 max-w-2xl text-center text-white/70",children:"The most engaging way to predict what happens next. Join communities, build credibility, and earn when you get it right."}),n.jsxs("div",{className:"mt-8 grid grid-cols-1 gap-4 md:grid-cols-3",children:[n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5",children:[n.jsx("div",{className:"mb-3 inline-flex items-center justify-center rounded-xl bg-white/10 p-2",children:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-emerald-300",children:[n.jsx("path",{d:"M3 3v16a2 2 0 0 0 2 2h16"}),n.jsx("path",{d:"m19 9-5 5-4-4-3 3"})]})}),n.jsx("div",{className:"text-sm font-semibold",children:"Real time odds"}),n.jsx("p",{className:"mt-1 text-sm text-white/70",children:"Make predictions as events unfold with dynamic odds."})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5",children:[n.jsx("div",{className:"mb-3 inline-flex items-center justify-center rounded-xl bg-white/10 p-2",children:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-emerald-300",children:[n.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),n.jsx("path",{d:"M16 3.128a4 4 0 0 1 0 7.744"}),n.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),n.jsx("circle",{cx:"9",cy:"7",r:"4"})]})}),n.jsx("div",{className:"text-sm font-semibold",children:"Social Predictions"}),n.jsx("p",{className:"mt-1 text-sm text-white/70",children:"Follow top predictors, share insights, and discover trends."})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5",children:[n.jsx("div",{className:"mb-3 inline-flex items-center justify-center rounded-xl bg-white/10 p-2",children:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-emerald-300",children:[n.jsx("path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}),n.jsx("path",{d:"m9 12 2 2 4-4"})]})}),n.jsx("div",{className:"text-sm font-semibold",children:"Secure & Fair"}),n.jsx("p",{className:"mt-1 text-sm text-white/70",children:"Transparent rules, verifiable outcomes, and fast payouts."})]})]})]}),n.jsxs("section",{className:"mx-auto max-w-6xl px-4 py-12",children:[n.jsx("h3",{className:"text-xl font-semibold",children:"How it works"}),n.jsxs("ol",{className:"mt-4 grid list-decimal gap-3 pl-6 text-white/80 md:grid-cols-2",children:[n.jsx("li",{children:"Pick a prediction that matches your interest."}),n.jsx("li",{children:"Choose an outcome you believe will happen."}),n.jsx("li",{children:"Stake an amount you're comfortable with."}),n.jsx("li",{children:"If you're right, you win based on the final odds."})]})]}),n.jsxs("section",{className:"mx-auto max-w-6xl px-4 pb-16",children:[n.jsxs("h3",{className:"mb-4 flex items-center gap-2 text-xl font-semibold",children:[n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10"}),n.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),n.jsx("path",{d:"M12 17h.01"})]}),"FAQ"]}),n.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:[{question:"Is it free to join?",answer:"Yes. Browsing predictions is free. You only stake when placing a prediction."},{question:"Where can I use FanClubZ?",answer:"Anywhere the web app loads. Android APK is available; iOS is coming soon."},{question:"How are outcomes decided?",answer:"Each prediction has clear settlement rules and sources. Winning stakes are paid out accordingly."},{question:"Is my data safe?",answer:"We use modern security practices for auth and data storage. You can delete your data anytime."},{question:"How do I fund my wallet?",answer:"FanClubZ uses the Base Sepolia testnet. You'll need to install a wallet like MetaMask, add the Base Sepolia network, and get test ETH and USDC from faucets.",hasLink:!0}].map(r=>n.jsxs("details",{className:"group rounded-xl border border-white/10 p-4 open:bg-white/5",children:[n.jsx("summary",{className:"cursor-pointer list-none select-none font-medium text-white/90",children:n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx("span",{children:r.question}),n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 text-white/50 transition group-open:rotate-180",children:[n.jsx("path",{d:"M12 7v14"}),n.jsx("path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"})]})]})}),n.jsxs("p",{className:"mt-2 text-sm text-white/70",children:[r.answer,r.hasLink&&n.jsxs(n.Fragment,{children:[" ",n.jsx("a",{href:"/docs/funding-guide",className:"text-emerald-400 hover:text-emerald-300 underline",onClick:a=>{a.preventDefault(),s("/docs/funding-guide")},children:"View our step-by-step funding guide â†’"})]})]})]},r.question))})]})]}),n.jsxs("footer",{className:"border-t border-white/10",children:[n.jsxs("div",{className:"mx-auto grid max-w-6xl grid-cols-2 gap-8 px-4 py-10 md:grid-cols-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[n.jsx("img",{src:"/brand/fcz-logomark.png",alt:"FanClubZ",className:"h-6 w-6",style:{objectFit:"contain"}}),n.jsx("span",{className:"font-semibold",children:"FanClubZ"})]}),n.jsx("p",{className:"text-sm text-white/70",children:"Social predictions done right. Turn your opinions into rewards."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"mb-2 text-sm font-semibold text-white/80",children:"Company"}),n.jsxs("ul",{className:"space-y-2 text-sm text-white/70",children:[n.jsx("li",{children:n.jsx("a",{href:`${e}`,className:"hover:text-white",children:"Web App"})}),n.jsx("li",{children:n.jsx("a",{href:"mailto:tech@fanclubz.app",className:"hover:text-white",children:"Contact"})})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"mb-2 text-sm font-semibold text-white/80",children:"Resources"}),n.jsx("ul",{className:"space-y-2 text-sm text-white/70",children:n.jsx("li",{children:n.jsx("a",{href:"/docs/funding-guide",className:"hover:text-white",onClick:r=>{r.preventDefault(),s("/docs/funding-guide")},children:"Docs"})})})]}),n.jsxs("div",{children:[n.jsx("div",{className:"mb-2 text-sm font-semibold text-white/80",children:"Community"}),n.jsxs("ul",{className:"space-y-2 text-sm text-white/70",children:[n.jsx("li",{children:n.jsx("a",{href:"https://www.instagram.com/fanclubzapp?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==",target:"_blank",rel:"noreferrer",className:"hover:text-white",children:"Instagram"})}),n.jsx("li",{children:n.jsx("a",{href:"https://x.com/fanclubzapp?s=21&t=azQHKJXvTx2oYBcMg4IStg",target:"_blank",rel:"noreferrer",className:"hover:text-white",children:"Twitter"})}),n.jsx("li",{children:n.jsx("a",{href:"https://youtube.com/@fanclubzapp",target:"_blank",rel:"noreferrer",className:"hover:text-white",children:"YouTube"})}),n.jsx("li",{children:n.jsx("a",{href:"https://chat.whatsapp.com/Csb2ngooDCt7fguCXvfntj?mode=wwt",target:"_blank",rel:"noreferrer",className:"hover:text-white",children:"WhatsApp"})}),n.jsx("li",{children:n.jsx("a",{href:"https://discord.gg/PdEs8vD2H5",target:"_blank",rel:"noreferrer",className:"hover:text-white",children:"Discord"})}),n.jsx("li",{children:n.jsx("a",{href:"https://t.me/Fanclubzapp",target:"_blank",rel:"noreferrer",className:"hover:text-white",children:"Telegram"})})]})]})]}),n.jsxs("div",{className:"border-t border-white/10 py-6 text-center text-xs text-white/50",children:["Â© ",vb," FanClubZ. All rights reserved."]})]}),n.jsx(Sd,{})]})},Nl=_b,jb=new Date().getFullYear(),El="0x036CbD53842c5426634e7929541eC2318f3dCF7e",Nb="https://app.fanclubz.app",Eb=()=>{const s=le(),[e,t]=Ie.useState(!1),r=async()=>{try{await navigator.clipboard.writeText(El),t(!0),setTimeout(()=>t(!1),2e3)}catch{}},a=()=>{s("/")},i=()=>{window.location.href=`${Nb}/wallet`};return n.jsxs("div",{className:"bg-gradient-to-b from-[#211234] via-[#1b1130] to-[#130c24] text-white min-h-screen",children:[n.jsx("header",{className:"sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/5",children:n.jsx("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-4",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:a,className:"p-2 -ml-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Go back",children:n.jsx(ps,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("img",{src:"/brand/fcz-logomark.png",alt:"FanClubZ",className:"h-8 w-8",style:{objectFit:"contain"}}),n.jsx("span",{className:"text-lg font-semibold tracking-wide",children:"FanClubZ"})]})]})})}),n.jsxs("main",{children:[n.jsxs("section",{className:"relative overflow-hidden",children:[n.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(600px_circle_at_20%_20%,rgba(34,197,94,0.15),transparent_60%),radial-gradient(600px_circle_at_80%_0%,rgba(59,130,246,0.12),transparent_60%)]"}),n.jsx("div",{className:"relative mx-auto max-w-4xl px-4 py-12 md:py-16",children:n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-emerald-500/20 mb-4",children:n.jsx(Fe,{className:"w-8 h-8 text-emerald-400"})}),n.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold mb-3",children:"How to Fund Your Wallet"}),n.jsx("p",{className:"text-lg text-white/70 max-w-2xl mx-auto",children:"FanClubZ uses the Base Sepolia testnet. Follow these steps to get test tokens and start making predictions."})]})})]}),n.jsx("section",{className:"mx-auto max-w-4xl px-4 pb-16",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold",children:"1"}),n.jsx("h2",{className:"text-xl font-semibold",children:"Install a Wallet"})]}),n.jsx("p",{className:"text-white/70 mb-4",children:"You'll need a crypto wallet to interact with FanClubZ. We recommend MetaMask, but any WalletConnect-compatible wallet works."}),n.jsxs("a",{href:"https://metamask.io/download/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-orange-500/20 rounded-lg flex items-center justify-center",children:n.jsx("span",{className:"text-orange-400 text-lg font-bold",children:"M"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-white",children:"MetaMask"}),n.jsx("p",{className:"text-sm text-white/50",children:"Browser extension & mobile app"})]})]}),n.jsx(et,{className:"w-5 h-5 text-white/40 group-hover:text-white/70"})]}),n.jsx("div",{className:"mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:n.jsxs("p",{className:"text-sm text-blue-300",children:[n.jsx("strong",{children:"Tip:"})," This is a one-time setup. Once installed, your wallet will work across all Web3 apps."]})})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold",children:"2"}),n.jsx("h2",{className:"text-xl font-semibold",children:"Add Base Sepolia Network"})]}),n.jsx("p",{className:"text-white/70 mb-4",children:"Add the Base Sepolia testnet to your wallet using these settings:"}),n.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-white/50",children:"Network Name"}),n.jsx("span",{className:"font-medium text-white",children:"Base Sepolia"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-white/50",children:"RPC URL"}),n.jsx("span",{className:"font-mono text-sm text-white",children:"https://sepolia.base.org"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-white/50",children:"Chain ID"}),n.jsx("span",{className:"font-mono text-white",children:"84532"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-white/50",children:"Currency Symbol"}),n.jsx("span",{className:"font-medium text-white",children:"ETH"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-white/50",children:"Block Explorer"}),n.jsx("a",{href:"https://sepolia.basescan.org",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:text-emerald-300 transition-colors",children:"sepolia.basescan.org"})]})]})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold",children:"3"}),n.jsx("h2",{className:"text-xl font-semibold",children:"Get Base Sepolia ETH (Gas)"})]}),n.jsx("p",{className:"text-white/70 mb-4",children:"You need a small amount of ETH to pay for transaction fees (gas). Use any of these free faucets:"}),n.jsx("div",{className:"space-y-3",children:[{name:"Alchemy Faucet",url:"https://www.alchemy.com/faucets/base-sepolia",desc:"Fast & reliable"},{name:"Chainlink Faucet",url:"https://faucets.chain.link",desc:'Select "Base Sepolia"'},{name:"QuickNode Faucet",url:"https://faucet.quicknode.com",desc:'Select "Base Sepolia"'}].map(o=>n.jsxs("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center",children:n.jsx(cx,{className:"w-5 h-5 text-purple-400"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-white",children:o.name}),n.jsx("p",{className:"text-sm text-white/50",children:o.desc})]})]}),n.jsx(et,{className:"w-5 h-5 text-white/40 group-hover:text-white/70"})]},o.name))}),n.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 bg-emerald-500/10 border border-emerald-500/20 rounded-xl",children:[n.jsx(Ge,{className:"w-5 h-5 text-emerald-400 mt-0.5 flex-shrink-0"}),n.jsx("p",{className:"text-sm text-emerald-300",children:"After claiming, confirm your wallet shows a small ETH balance on Base Sepolia before proceeding."})]})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold",children:"4"}),n.jsx("h2",{className:"text-xl font-semibold",children:"Get Base Sepolia USDC"})]}),n.jsx("p",{className:"text-white/70 mb-4",children:"USDC is the currency used for predictions on FanClubZ. Get test USDC from these faucets:"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("a",{href:"https://faucet.circle.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:n.jsx(cl,{className:"w-5 h-5 text-blue-400"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-white",children:"Circle USDC Faucet"}),n.jsx("p",{className:"text-sm text-white/50",children:'Select "Base Sepolia" if available'})]})]}),n.jsx(et,{className:"w-5 h-5 text-white/40 group-hover:text-white/70"})]}),n.jsxs("a",{href:"https://portal.cdp.coinbase.com/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:n.jsx(cl,{className:"w-5 h-5 text-blue-400"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-white",children:"Coinbase Developer Platform"}),n.jsx("p",{className:"text-sm text-white/50",children:"Alternative USDC source"})]})]}),n.jsx(et,{className:"w-5 h-5 text-white/40 group-hover:text-white/70"})]})]}),n.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:[n.jsx(tx,{className:"w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0"}),n.jsxs("p",{className:"text-sm text-amber-300",children:[n.jsx("strong",{children:"Important:"})," Only connect your wallet to trusted websites. Always verify the URL before approving any transactions."]})]}),n.jsxs("div",{className:"mt-4 p-4 bg-white/5 border border-white/10 rounded-xl",children:[n.jsx("p",{className:"text-sm text-white/50 mb-2",children:"USDC Token Address (Base Sepolia)"}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("code",{className:"text-sm font-mono text-white/80 break-all",children:El}),n.jsx("button",{onClick:r,className:"p-2 text-white/50 hover:text-white hover:bg-white/10 rounded-lg transition-colors flex-shrink-0","aria-label":"Copy address",children:e?n.jsx(Ge,{className:"w-5 h-5 text-emerald-400"}):n.jsx(pd,{className:"w-5 h-5"})})]}),n.jsx("p",{className:"text-xs text-white/50 mt-2",children:`If USDC doesn't appear in your wallet, use "Import Token" and paste this address.`})]})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold",children:"5"}),n.jsx("h2",{className:"text-xl font-semibold",children:"Use It in the App"})]}),n.jsx("p",{className:"text-white/70 mb-4",children:"Now you're ready to start making predictions!"}),n.jsx("ol",{className:"space-y-3",children:[{step:"Open the app and go to Wallet"},{step:"Tap Connect Wallet and select your wallet"},{step:"Tap Deposit to add USDC to your escrow balance"},{step:"Approve the transaction in your wallet when prompted"},{step:"Start placing predictions using your Available balance!"}].map((o,l)=>n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-white/10 text-white/70 text-xs font-medium flex-shrink-0 mt-0.5",children:l+1}),n.jsx("p",{className:"text-white/70",children:o.step})]},l))})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx(ux,{className:"w-6 h-6 text-white/50"}),n.jsx("h2",{className:"text-xl font-semibold",children:"Troubleshooting"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-white mb-1",children:"No wallet prompt appearing?"}),n.jsx("p",{className:"text-sm text-white/60",children:"Make sure your wallet is set to Base Sepolia network, then try again."})]}),n.jsxs("div",{className:"border-t border-white/10 pt-4",children:[n.jsx("p",{className:"font-medium text-white mb-1",children:"Balance didn't update?"}),n.jsx("p",{className:"text-sm text-white/60",children:"Wait a few seconds for the transaction to confirm, then refresh the page."})]}),n.jsxs("div",{className:"border-t border-white/10 pt-4",children:[n.jsx("p",{className:"font-medium text-white mb-1",children:"USDC not visible in wallet?"}),n.jsx("p",{className:"text-sm text-white/60",children:"Import the USDC token using the address shown above."})]}),n.jsxs("div",{className:"border-t border-white/10 pt-4",children:[n.jsx("p",{className:"font-medium text-white mb-1",children:"Out of gas?"}),n.jsx("p",{className:"text-sm text-white/60",children:"Grab a bit more Base Sepolia ETH from any of the faucets listed above."})]})]})]}),n.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:[n.jsx("p",{className:"text-white/70 mb-4",children:"Ready to start making predictions?"}),n.jsx("button",{onClick:i,className:"inline-flex items-center gap-2 rounded-xl bg-emerald-500 px-8 py-3 text-sm font-semibold text-black shadow-xl transition hover:brightness-95",children:"Open the App"})]})]})})]}),n.jsx("footer",{className:"border-t border-white/10",children:n.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-8",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("img",{src:"/brand/fcz-logomark.png",alt:"FanClubZ",className:"h-6 w-6",style:{objectFit:"contain"}}),n.jsx("span",{className:"font-semibold",children:"FanClubZ"})]}),n.jsxs("div",{className:"flex items-center gap-6 text-sm text-white/50",children:[n.jsx("button",{onClick:a,className:"hover:text-white transition-colors",children:"Home"}),n.jsx("a",{href:"mailto:tech@fanclubz.app",className:"hover:text-white transition-colors",children:"Contact"})]})]}),n.jsxs("div",{className:"mt-6 text-center text-xs text-white/50",children:["Â© ",jb," FanClubZ. All rights reserved."]})]})})]})},Sb=Eb,Ua="fcz_admin_key",kb=({children:s})=>{const[e,t]=m.useState(null),[r,a]=m.useState(""),[i,o]=m.useState(null),[l,c]=m.useState(!0);m.useEffect(()=>{const u=localStorage.getItem(Ua);u&&t(u),c(!1)},[]);const d=async u=>{if(u.preventDefault(),o(null),!r.trim()){o("Please enter an admin key");return}localStorage.setItem(Ua,r.trim()),t(r.trim()),a("")};return l?n.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-slate-400",children:"Loading..."})]})}):e?n.jsx(n.Fragment,{children:s}):n.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center max-w-md px-6",children:[n.jsx("div",{className:"w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ca,{className:"w-8 h-8 text-slate-600"})}),n.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Admin Access Required"}),n.jsx("p",{className:"text-slate-400 mb-6",children:"Please enter your admin key to continue."}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("input",{type:"password",value:r,onChange:u=>{a(u.target.value),o(null)},placeholder:"Enter admin key",className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",autoFocus:!0}),i&&n.jsx("p",{className:"text-red-400 text-sm mt-2",children:i})]}),n.jsx("button",{type:"submit",className:"w-full px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium",children:"Access Admin"})]})]})})};function nr(){return typeof window>"u"?null:localStorage.getItem(Ua)}function ar(s,e,t){const r=ne(),a=typeof window<"u"?window.location.origin:"http://localhost",i=new URL(s.startsWith("http")?s:`${r}${s}`,a);if(e&&i.searchParams.set("actorId",e),t)for(const[o,l]of Object.entries(t))l!==void 0&&i.searchParams.set(o,String(l));return i.toString()}async function pn(s){return(s.headers.get("content-type")||"").includes("application/json")?await s.json():{message:await s.text().catch(()=>"")}}async function de(s,e,t){const r=ar(s,e,t),a=nr(),i={};a&&(i["x-admin-key"]=a);const o=await fetch(r,{method:"GET",credentials:"include",headers:i});if(!o.ok){const l=await pn(o);throw new Error(l?.message||`Request failed (${o.status})`)}return await o.json()}async function ve(s,e,t){const r=ar(s,e),a=nr(),i={"Content-Type":"application/json",Accept:"application/json"};a&&(i["x-admin-key"]=a);const o=await fetch(r,{method:"POST",credentials:"include",headers:i,body:JSON.stringify(e?{...t||{},actorId:e}:{...t||{}})});if(!o.ok){const l=await pn(o);throw new Error(l?.message||`Request failed (${o.status})`)}return await o.json()}async function Cb(s,e,t){const r=ar(s,e),a=nr(),i={"Content-Type":"application/json",Accept:"application/json"};a&&(i["x-admin-key"]=a);const o=await fetch(r,{method:"PUT",credentials:"include",headers:i,body:JSON.stringify(e?{...t||{},actorId:e}:{...t||{}})});if(!o.ok){const l=await pn(o);throw new Error(l?.message||`Request failed (${o.status})`)}return await o.json()}async function js(s,e,t){const r=ar(s,e),a=nr(),i={"Content-Type":"application/json",Accept:"application/json"};a&&(i["x-admin-key"]=a);const o=await fetch(r,{method:"PATCH",credentials:"include",headers:i,body:JSON.stringify(e?{...t||{},actorId:e}:{...t||{}})});if(!o.ok){const l=await pn(o);throw new Error(l?.message||`Request failed (${o.status})`)}return await o.json()}const Ba=()=>{const[s,e]=m.useState({}),[t,r]=m.useState([]),[a,i]=m.useState(!0),{user:o}=J(),{user:l}=ae(),c=l?.id||o?.id||"";m.useEffect(()=>{(async()=>{try{const[h,f]=await Promise.all([de("/api/v2/admin/overview",c),de("/api/v2/admin/audit",c,{limit:5})]);e({totalUsers:h.totalUsers,activePredictions:h.activePredictions,pendingSettlements:h.pendingSettlements,totalVolume:h.totalVolume}),r(f.items||[])}catch{}finally{i(!1)}})()},[c]);const d=[{label:"Search Users",path:"/admin/users",icon:Bt,color:"bg-blue-600"},{label:"View Wallets",path:"/admin/wallets",icon:Fe,color:"bg-emerald-600"},{label:"Predictions",path:"/admin/predictions",icon:Be,color:"bg-purple-600"},{label:"Settlements",path:"/admin/settlements",icon:gd,color:"bg-amber-600"},{label:"Categories",path:"/admin/categories",icon:vd,color:"bg-indigo-600"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-white",children:"Admin Dashboard"}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Welcome to the Fan Club Z admin panel"})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:d.map(u=>n.jsxs(zr,{to:u.path,className:"bg-slate-800 border border-slate-700 rounded-xl p-4 hover:border-slate-600 transition-colors group",children:[n.jsx("div",{className:`w-10 h-10 ${u.color} rounded-lg flex items-center justify-center mb-3 group-hover:scale-110 transition-transform`,children:n.jsx(u.icon,{className:"w-5 h-5 text-white"})}),n.jsx("p",{className:"text-white font-medium",children:u.label})]},u.path))}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Bt,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Users"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:s.totalUsers??"â€”"})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(ex,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Active Predictions"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:s.activePredictions??"â€”"})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Ze,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Pending Settlements"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:s.pendingSettlements??"â€”"})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(is,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Volume"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:s.totalVolume!=null?`$${s.totalVolume.toLocaleString()}`:"â€”"})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center justify-between",children:[n.jsx("h2",{className:"text-white font-semibold",children:"Recent Admin Actions"}),n.jsx(zr,{to:"/admin/audit",className:"text-sm text-emerald-400 hover:text-emerald-300",children:"View All"})]}),n.jsx("div",{className:"divide-y divide-slate-700",children:a?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx("div",{className:"w-6 h-6 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:"Loading..."})]}):t.length===0?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(We,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),n.jsx("p",{className:"text-slate-400",children:"No recent admin actions"})]}):t.map(u=>n.jsx("div",{className:"px-4 py-3 hover:bg-slate-700/30 transition-colors",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium text-sm",children:u.action}),n.jsxs("p",{className:"text-slate-400 text-xs mt-0.5",children:["by ",u.actorName," â€¢ ",u.targetType&&`${u.targetType}: `,u.targetId?.slice(0,8),"..."]})]}),n.jsx("span",{className:"text-xs text-slate-500",children:new Date(u.createdAt).toLocaleDateString()})]})},u.id))})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h2",{className:"text-white font-semibold mb-3",children:"System Status"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),n.jsx("span",{className:"text-slate-300 text-sm",children:"All systems operational"})]})]})]})},Tb=Object.freeze(Object.defineProperty({__proto__:null,AdminHomePage:Ba,default:Ba},Symbol.toStringTag,{value:"Module"})),Fa=()=>{const s=le(),{user:e}=J(),{user:t}=ae(),r=t?.id||e?.id||"",[a,i]=m.useState(""),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,h]=m.useState(!1),f=m.useCallback(async()=>{if(a.trim()){d(!0),h(!0);try{const w=await de("/api/v2/admin/users/search",r,{q:a.trim(),limit:25});l(w.items||[])}catch{l([])}finally{d(!1)}}},[a,r]),p=w=>{w.key==="Enter"&&f()};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Bt,{className:"w-7 h-7 text-blue-500"}),"User Management"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Search and view user details"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(He,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),n.jsx("input",{type:"text",value:a,onChange:w=>i(w.target.value),onKeyDown:p,placeholder:"Search by email, username, name, or user ID...",className:"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:f,disabled:c||!a.trim(),className:"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[c?n.jsx(Y,{className:"w-5 h-5 animate-spin"}):n.jsx(He,{className:"w-5 h-5"}),"Search"]})]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:u?c?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Searching..."})]}):o.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(je,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"No users found"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Try a different search term"})]}):n.jsx("div",{className:"divide-y divide-slate-700",children:o.map(w=>n.jsxs("button",{onClick:()=>s(`/admin/users/${w.id}`),className:"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:w.avatarUrl?n.jsx("img",{src:w.avatarUrl,alt:"",className:"w-full h-full object-cover"}):n.jsx(je,{className:"w-5 h-5 text-slate-400"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-white font-medium truncate",children:w.fullName||w.username||"Unknown User"}),w.isAdmin&&n.jsx(as,{className:"w-4 h-4 text-amber-500"})]}),n.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-400 mt-0.5",children:[w.username&&n.jsxs("span",{children:["@",w.username]}),w.email&&n.jsx("span",{className:"truncate",children:w.email})]})]}),n.jsxs("div",{className:"text-right flex-shrink-0",children:[n.jsxs("div",{className:"text-xs text-slate-500 font-mono",children:[w.id.slice(0,8),"..."]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500 mt-0.5",children:[n.jsx(Dr,{className:"w-3 h-3"}),new Date(w.createdAt).toLocaleDateString()]})]})]},w.id))}):n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Bt,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"Search for users"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Enter an email, username, name, or user ID to search"})]})})]})},Ab=Object.freeze(Object.defineProperty({__proto__:null,UsersPage:Fa,default:Fa},Symbol.toStringTag,{value:"Module"})),Ma=()=>{const{userId:s}=ds(),e=le(),{user:t}=J(),{user:r}=ae(),a=r?.id||t?.id||"",[i,o]=m.useState(null),[l,c]=m.useState(null),[d,u]=m.useState(null),[h,f]=m.useState([]),[p,w]=m.useState([]),[g,y]=m.useState(!0),[b,v]=m.useState(!0);m.useState("timeline");const[x,_]=m.useState(null),[j,S]=m.useState("all"),E=m.useCallback(async()=>{if(s){y(!0);try{const O=await de(`/api/v2/admin/users/${s}`,a);o(O.user),c(O.wallet),u(O.stats),f(O.addresses||[])}catch{}finally{y(!1)}}},[s,a]),T=m.useCallback(async()=>{if(s){v(!0);try{const O=await de(`/api/v2/admin/users/${s}/timeline`,a,{limit:100,type:j});w(O.items||[])}catch{}finally{v(!1)}}},[s,j,a]);m.useEffect(()=>{E()},[E]),m.useEffect(()=>{T()},[T]);const N=O=>{switch(O){case"wallet_tx":return n.jsx(Fe,{className:"w-4 h-4"});case"entry":return n.jsx(Be,{className:"w-4 h-4"});case"settlement":return n.jsx(Aa,{className:"w-4 h-4"});case"admin":return n.jsx(as,{className:"w-4 h-4"});default:return n.jsx(Dr,{className:"w-4 h-4"})}},C=O=>{switch(O){case"wallet_tx":return"bg-emerald-600/20 text-emerald-400";case"entry":return"bg-blue-600/20 text-blue-400";case"settlement":return"bg-purple-600/20 text-purple-400";case"admin":return"bg-amber-600/20 text-amber-400";default:return"bg-slate-600/20 text-slate-400"}};return g?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})}):i?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("button",{onClick:()=>e("/admin/users"),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[n.jsx(ps,{className:"w-4 h-4"}),"Back to Users"]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:i.avatarUrl?n.jsx("img",{src:i.avatarUrl,alt:"",className:"w-full h-full object-cover"}):n.jsx(je,{className:"w-8 h-8 text-slate-400"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h1",{className:"text-xl font-bold text-white",children:i.fullName||i.username||"Unknown User"}),i.isAdmin&&n.jsxs("span",{className:"px-2 py-0.5 bg-amber-600/20 text-amber-400 text-xs font-medium rounded flex items-center gap-1",children:[n.jsx(as,{className:"w-3 h-3"})," Admin"]}),i.isVerified&&n.jsxs("span",{className:"px-2 py-0.5 bg-blue-600/20 text-blue-400 text-xs font-medium rounded flex items-center gap-1",children:[n.jsx(Ea,{className:"w-3 h-3"})," Verified"]})]}),i.username&&n.jsxs("p",{className:"text-slate-400 mt-1",children:["@",i.username]}),n.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm",children:[i.email&&n.jsxs("span",{className:"flex items-center gap-1 text-slate-400",children:[n.jsx(en,{className:"w-4 h-4"}),i.email]}),n.jsxs("span",{className:"flex items-center gap-1 text-slate-400",children:[n.jsx(Dr,{className:"w-4 h-4"}),"Joined ",new Date(i.createdAt).toLocaleDateString()]})]}),n.jsxs("p",{className:"text-xs text-slate-500 mt-2 font-mono",children:["ID: ",i.id]})]}),n.jsx("div",{className:"flex flex-col gap-2",children:n.jsx("button",{onClick:()=>e(`/admin/users/${i.id}/view`),className:"px-3 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors",children:"View as user"})})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(er,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Available"})]}),n.jsxs("p",{className:"text-xl font-bold text-white",children:["$",l?.availableBalance?.toFixed(2)||"0.00"]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Fe,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Deposited"})]}),n.jsxs("p",{className:"text-xl font-bold text-white",children:["$",l?.totalDeposited?.toFixed(2)||"0.00"]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Be,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Bets"})]}),n.jsx("p",{className:"text-xl font-bold text-white",children:d?.totalBets||0})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Aa,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Win Rate"})]}),n.jsxs("p",{className:"text-xl font-bold text-emerald-400",children:[d?.winRate||"0","%"]})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center justify-between",children:[n.jsx("h2",{className:"text-white font-semibold",children:"Activity Timeline"}),n.jsxs("select",{value:j,onChange:O=>S(O.target.value),className:"px-3 py-1.5 bg-slate-700 border border-slate-600 rounded-lg text-sm text-white focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[n.jsx("option",{value:"all",children:"All Activity"}),n.jsx("option",{value:"wallet",children:"Wallet"}),n.jsx("option",{value:"bets",children:"Bets"}),n.jsx("option",{value:"settlements",children:"Settlements"}),n.jsx("option",{value:"admin",children:"Admin Actions"})]})]}),n.jsx("div",{className:"divide-y divide-slate-700 max-h-[500px] overflow-y-auto",children:b?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(Y,{className:"w-6 h-6 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:"Loading timeline..."})]}):p.length===0?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(Dr,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),n.jsx("p",{className:"text-slate-400",children:"No activity found"})]}):p.map(O=>n.jsxs("div",{className:"hover:bg-slate-700/30 transition-colors",children:[n.jsx("button",{onClick:()=>_(x===O.id?null:O.id),className:"w-full px-4 py-3 text-left",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${C(O.type)}`,children:N(O.type)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-white text-sm",children:O.summary}),n.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:new Date(O.timestamp).toLocaleString()})]}),x===O.id?n.jsx(Ri,{className:"w-4 h-4 text-slate-400"}):n.jsx(Ii,{className:"w-4 h-4 text-slate-400"})]})}),x===O.id&&n.jsx("div",{className:"px-4 pb-3",children:n.jsxs("div",{className:"bg-slate-900 rounded-lg p-3 ml-11",children:[n.jsx("pre",{className:"text-xs text-slate-300 font-mono overflow-x-auto",children:JSON.stringify(O.details,null,2)}),O.details.predictionId&&n.jsxs("button",{onClick:()=>e(`/prediction/${O.details.predictionId}`),className:"mt-2 flex items-center gap-1 text-xs text-emerald-400 hover:text-emerald-300",children:[n.jsx(et,{className:"w-3 h-3"}),"View Prediction"]})]})})]},O.id))})]}),h.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-3",children:"Crypto Addresses"}),n.jsx("div",{className:"space-y-2",children:h.map((O,F)=>n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"font-mono text-slate-300",children:O.address}),n.jsxs("span",{className:"text-slate-500",children:["Chain ",O.chain_id]})]},F))})]})]}):n.jsxs("div",{className:"text-center py-20",children:[n.jsx(We,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"User not found"}),n.jsx("button",{onClick:()=>e("/admin/users"),className:"mt-4 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600",children:"Back to Users"})]})},Pb=Object.freeze(Object.defineProperty({__proto__:null,UserDetailPage:Ma,default:Ma},Symbol.toStringTag,{value:"Module"})),Ib=()=>{const{userId:s}=ds(),e=le(),[t,r]=m.useState(!0),[a,i]=m.useState("active"),[o,l]=m.useState(null),[c,d]=m.useState(null),[u,h]=m.useState([]),f=m.useCallback(async()=>{if(s){r(!0);try{const[b,v,x]=await Promise.all([de(`/api/v2/admin/users/${s}/summary`,""),de(`/api/v2/admin/users/${s}/predictions`,""),de(`/api/v2/admin/users/${s}/activity`,"",{limit:100})]);l(b),d(v),h(x.items||[])}catch(b){B.error(b?.message||"Failed to load user view")}finally{r(!1)}}},[s]);m.useEffect(()=>{f()},[f]);const p=m.useMemo(()=>{const b=o?.user;return b?.fullName||b?.username||b?.email||(s?`${s.slice(0,8)}â€¦`:"User")},[o,s]);if(t)return n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})});if(!o?.user)return n.jsxs("div",{className:"text-center py-20",children:[n.jsx("p",{className:"text-white font-medium",children:"User not found"}),n.jsx("button",{onClick:()=>e("/admin/users"),className:"mt-4 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600",children:"Back to Users"})]});const w=o.wallet,g=[{key:"active",label:"Active"},{key:"complete",label:"Complete"},{key:"created",label:"Created"},{key:"activity",label:"Activity"}],y=b=>c?b==="active"?c.active||[]:b==="complete"?c.complete||[]:b==="created"?c.created||[]:[]:[];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("button",{onClick:()=>e(`/admin/users/${s}`),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[n.jsx(ps,{className:"w-4 h-4"}),"Back to User"]}),n.jsxs("div",{className:"bg-amber-600/20 border border-amber-600/30 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(lx,{className:"w-5 h-5 text-amber-400 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-white font-semibold",children:"Admin view (read-only)"}),n.jsx("p",{className:"text-slate-300 text-sm",children:"You are viewing the user experience in read-only mode. No staking/cancelling/editing actions are available."})]})]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-semibold",children:p}),n.jsxs("p",{className:"text-slate-500 text-xs font-mono",children:["userId: ",o.user.id]})]}),n.jsx("button",{onClick:()=>f(),className:"px-3 py-2 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600",children:"Refresh"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("p",{className:"text-slate-400 text-sm",children:"Demo balance"}),n.jsxs("p",{className:"text-white text-xl font-bold",children:["$",Number(w?.availableBalance||0).toFixed(2)]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("p",{className:"text-slate-400 text-sm",children:"Crypto balance"}),n.jsx("p",{className:"text-white text-xl font-bold",children:"â€”"}),n.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"Placeholder (depends on escrow/chain model)"})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("p",{className:"text-slate-400 text-sm",children:"Fiat balance"}),n.jsx("p",{className:"text-white text-xl font-bold",children:"â€”"})]})]}),n.jsx("div",{className:"flex gap-2 flex-wrap",children:g.map(b=>n.jsx("button",{onClick:()=>i(b.key),className:`px-4 py-2 rounded-lg font-medium transition-colors ${a===b.key?"bg-emerald-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:b.label},b.key))}),a==="activity"?n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:u.length===0?n.jsx("div",{className:"p-8 text-center text-slate-400",children:"No activity found"}):n.jsx("div",{className:"divide-y divide-slate-700",children:u.map(b=>n.jsxs("div",{className:"px-4 py-3",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-white text-sm font-medium truncate",children:b.title}),n.jsxs("p",{className:"text-slate-400 text-xs mt-0.5",children:[b.rail?.toUpperCase?.()||"â€”"," â€¢ ",new Date(b.created_at).toLocaleString()]})]}),n.jsx("div",{className:"text-right",children:n.jsx("p",{className:"text-white text-sm font-semibold",children:typeof b.amount=="number"?`$${Math.abs(b.amount).toFixed(2)}`:"â€”"})})]}),b.href&&n.jsx("button",{onClick:()=>e(b.href),className:"mt-2 text-xs text-emerald-400 hover:text-emerald-300",children:"Open"})]},b.id))})}):n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:y(a).length===0?n.jsx("div",{className:"p-8 text-center text-slate-400",children:"No items"}):n.jsx("div",{className:"divide-y divide-slate-700",children:y(a).map(b=>n.jsxs("button",{onClick:()=>e(`/admin/predictions/${b.id}`),className:"w-full px-4 py-3 hover:bg-slate-700/40 transition-colors text-left",children:[n.jsx("p",{className:"text-white font-medium",children:b.title}),n.jsxs("p",{className:"text-slate-400 text-xs mt-0.5",children:["status: ",b.status," â€¢ id: ",String(b.id).slice(0,8),"â€¦"]})]},b.id))})})]})},Va=()=>{const s=le(),{user:e}=J(),{user:t}=ae(),r=t?.id||e?.id||"",[a,i]=m.useState(""),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,h]=m.useState(!1),f=m.useCallback(async()=>{if(a.trim()){d(!0),h(!0);try{const w=await de("/api/v2/admin/users/search",r,{q:a.trim(),limit:25});l(w.items||[])}catch{l([])}finally{d(!1)}}},[a,r]),p=w=>{w.key==="Enter"&&f()};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Fe,{className:"w-7 h-7 text-emerald-500"}),"Wallet Management"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Search users to view their wallet details"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(He,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),n.jsx("input",{type:"text",value:a,onChange:w=>i(w.target.value),onKeyDown:p,placeholder:"Search by email, username, or user ID...",className:"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:f,disabled:c||!a.trim(),className:"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[c?n.jsx(Y,{className:"w-5 h-5 animate-spin"}):n.jsx(He,{className:"w-5 h-5"}),"Search"]})]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:u?c?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Searching..."})]}):o.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(je,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"No users found"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Try a different search term"})]}):n.jsx("div",{className:"divide-y divide-slate-700",children:o.map(w=>n.jsxs("button",{onClick:()=>s(`/admin/wallets/${w.id}`),className:"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center",children:n.jsx(je,{className:"w-5 h-5 text-slate-400"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:w.fullName||w.username||"Unknown User"}),n.jsx("p",{className:"text-sm text-slate-400",children:w.email||w.id.slice(0,8)+"..."})]})]}),n.jsx(Qt,{className:"w-5 h-5 text-slate-400"})]},w.id))}):n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Fe,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"Search for a user"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Enter an email, username, or user ID to view their wallet"})]})})]})},Rb=Object.freeze(Object.defineProperty({__proto__:null,WalletsPage:Va,default:Va},Symbol.toStringTag,{value:"Module"})),za=()=>{const{userId:s}=ds(),e=le(),{user:t}=J(),{user:r}=ae(),a=r?.id||t?.id||"",[i,o]=m.useState([]),[l,c]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState([]),[p,w]=m.useState([]),[g,y]=m.useState(!0),[b,v]=m.useState("all"),[x,_]=m.useState(!1),j=m.useCallback(async()=>{if(s){y(!0);try{const N=await de(`/api/v2/admin/wallets/user/${s}`,a);o(N.wallets||[]),c(N.recentTransactions?.crypto||[]),u(N.recentTransactions?.demo||[]),f(N.escrowLocks||[]),w(N.addresses||[])}catch{}finally{y(!1)}}},[s,a]);m.useEffect(()=>{j()},[j]);const S=async()=>{if(s){_(!0);try{const N=ar("/api/v2/admin/wallets/transactions/export.csv",a,{userId:s,provider:b,limit:500}),C=nr(),O=await fetch(N,{headers:C?{"x-admin-key":C}:void 0,credentials:"include"});if(!O.ok)throw new Error("Export failed");const F=await O.blob(),re=window.URL.createObjectURL(F),K=document.createElement("a");K.href=re,K.download=`transactions_${s.slice(0,8)}_${Date.now()}.csv`,document.body.appendChild(K),K.click(),K.remove(),window.URL.revokeObjectURL(re)}catch{}finally{_(!1)}}},E=b==="crypto"?l:b==="demo"?d:[...l,...d].sort((N,C)=>new Date(C.created_at).getTime()-new Date(N.created_at).getTime()),T=i.find(N=>N.currency==="USD");return g?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("button",{onClick:()=>e("/admin/wallets"),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[n.jsx(ps,{className:"w-4 h-4"}),"Back to Wallets"]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Fe,{className:"w-7 h-7 text-emerald-500"}),"User Wallet"]}),n.jsx("p",{className:"text-slate-400 mt-1 font-mono text-sm",children:s})]}),n.jsxs("button",{onClick:()=>e(`/admin/users/${s}`),className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 transition-colors text-sm flex items-center gap-2",children:["View User Profile",n.jsx(et,{className:"w-4 h-4"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(er,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Available"})]}),n.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",T?.availableBalance?.toFixed(2)||"0.00"]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Ca,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Reserved"})]}),n.jsxs("p",{className:"text-2xl font-bold text-amber-400",children:["$",T?.reservedBalance?.toFixed(2)||"0.00"]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(is,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Deposited"})]}),n.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:["$",T?.totalDeposited?.toFixed(2)||"0.00"]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(ul,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Withdrawn"})]}),n.jsxs("p",{className:"text-2xl font-bold text-red-400",children:["$",T?.totalWithdrawn?.toFixed(2)||"0.00"]})]})]}),p.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-3",children:"Crypto Addresses"}),n.jsx("div",{className:"space-y-2",children:p.map((N,C)=>n.jsxs("div",{className:"flex items-center justify-between text-sm bg-slate-900 rounded-lg px-3 py-2",children:[n.jsx("span",{className:"font-mono text-slate-300",children:N.address}),n.jsxs("span",{className:"text-slate-500",children:["Chain ",N.chain_id]})]},C))})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center justify-between flex-wrap gap-3",children:[n.jsx("h2",{className:"text-white font-semibold",children:"Transactions"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex gap-1",children:["all","crypto","demo"].map(N=>n.jsx("button",{onClick:()=>v(N),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${b===N?"bg-emerald-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:N.charAt(0).toUpperCase()+N.slice(1)},N))}),n.jsxs("button",{onClick:S,disabled:x,className:"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm flex items-center gap-2 hover:bg-slate-600 disabled:opacity-50",children:[x?n.jsx(Y,{className:"w-4 h-4 animate-spin"}):n.jsx(Xr,{className:"w-4 h-4"}),"Export CSV"]})]})]}),n.jsx("div",{className:"divide-y divide-slate-700 max-h-[400px] overflow-y-auto",children:E.length===0?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(We,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),n.jsx("p",{className:"text-slate-400",children:"No transactions found"})]}):E.map(N=>n.jsx("div",{className:"px-4 py-3 hover:bg-slate-700/30 transition-colors",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${N.direction==="credit"?"bg-emerald-600/20 text-emerald-400":"bg-red-600/20 text-red-400"}`,children:N.direction==="credit"?n.jsx(is,{className:"w-4 h-4"}):n.jsx(ul,{className:"w-4 h-4"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-white font-medium",children:[N.direction==="credit"?"+":"-","$",Math.abs(Number(N.amount)).toFixed(2)]}),n.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${N.provider==="demo-wallet"?"bg-purple-600/20 text-purple-400":"bg-blue-600/20 text-blue-400"}`,children:N.provider==="demo-wallet"?"Demo":"Crypto"})]}),n.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:[N.channel," â€¢ ",N.description||N.type]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-slate-500",children:new Date(N.created_at).toLocaleString()}),n.jsx("p",{className:`text-xs mt-0.5 ${N.status==="success"?"text-emerald-400":"text-amber-400"}`,children:N.status})]})]})},N.id))})]}),h.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-4 py-3 border-b border-slate-700",children:n.jsx("h2",{className:"text-white font-semibold",children:"Escrow Locks"})}),n.jsx("div",{className:"divide-y divide-slate-700",children:h.map(N=>n.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-600/20 flex items-center justify-center",children:n.jsx(Ca,{className:"w-4 h-4 text-amber-400"})}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-white font-medium",children:["$",Number(N.amount).toFixed(2)]}),n.jsx("p",{className:"text-xs text-slate-400",children:N.status})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-xs text-slate-500 font-mono",children:[N.prediction_id?.slice(0,8),"..."]}),N.expires_at&&n.jsxs("p",{className:"text-xs text-slate-500 flex items-center gap-1 justify-end mt-0.5",children:[n.jsx(Ze,{className:"w-3 h-3"}),new Date(N.expires_at).toLocaleString()]})]})]},N.id))})]})]})},Ob=Object.freeze(Object.defineProperty({__proto__:null,UserWalletPage:za,default:za},Symbol.toStringTag,{value:"Module"}));function Wd(s){const e=(s.status||"").toLowerCase(),t=Date.now();if(e==="cancelled"||s.cancelledAt)return{label:"Cancelled",tone:"danger",subtext:s.cancelledAt?`Cancelled on ${new Date(s.cancelledAt).toLocaleDateString()}`:void 0};if(e==="voided"||s.voidedAt)return{label:"Voided",tone:"danger",subtext:s.voidedAt?`Voided on ${new Date(s.voidedAt).toLocaleDateString()}`:void 0};const r=(s.disputeStatus||"").toLowerCase();if(r==="open"||r==="active"||e==="disputed")return{label:"Disputed",tone:"warning",subtext:"Under review"};if(!!(s.settledAt||s.settled_at)||e==="settled"||e==="complete"){const u=s.settledAt||s.settled_at;return{label:"Complete",tone:"success",subtext:u?`Settled on ${new Date(u).toLocaleDateString()}`:void 0}}const o=!!s.closedAt,l=s.closesAt?new Date(s.closesAt).getTime():null,c=l?l<=t:!1;return o||e==="closed"||e==="awaiting_settlement"||c?{label:"Closed",tone:"default",subtext:"Awaiting settlement"}:{label:"Active",tone:"default"}}const Sl={active:{icon:Ze,color:"text-emerald-400 bg-emerald-600/20",label:"Active"},pending:{icon:Ze,color:"text-amber-400 bg-amber-600/20",label:"Pending"},settled:{icon:Ge,color:"text-blue-400 bg-blue-600/20",label:"Settled"},voided:{icon:Hs,color:"text-red-400 bg-red-600/20",label:"Voided"},cancelled:{icon:Pi,color:"text-slate-400 bg-slate-600/20",label:"Cancelled"}},qa=()=>{const s=le(),{user:e}=J(),{user:t}=ae(),r=t?.id||e?.id||"",[a,i]=m.useState(""),[o,l]=m.useState("all"),[c,d]=m.useState("all"),[u,h]=m.useState([]),[f,p]=m.useState(!1),[w,g]=m.useState(0),y=m.useCallback(async()=>{p(!0);try{const x=await de("/api/v2/admin/predictions",r,{q:a||void 0,status:o!=="all"?o:void 0,rail:c!=="all"?c:void 0,limit:50});h(x.items||[]),g(x.total||0)}catch{h([])}finally{p(!1)}},[a,o,c,r]);m.useEffect(()=>{y()},[o,c,y]);const b=()=>{y()},v=x=>{x.key==="Enter"&&y()};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Be,{className:"w-7 h-7 text-emerald-500"}),"Prediction Management"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Search and manage predictions"})]}),n.jsxs("div",{className:"flex gap-3 flex-wrap",children:[n.jsxs("div",{className:"relative flex-1 min-w-[250px]",children:[n.jsx(He,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),n.jsx("input",{type:"text",value:a,onChange:x=>i(x.target.value),onKeyDown:v,placeholder:"Search by title or prediction ID...",className:"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Sa,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),n.jsxs("select",{value:o,onChange:x=>l(x.target.value),className:"pl-10 pr-8 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[n.jsx("option",{value:"all",children:"All Status"}),n.jsx("option",{value:"active",children:"Active (Open)"}),n.jsx("option",{value:"closed",children:"Closed"}),n.jsx("option",{value:"settled",children:"Settled"}),n.jsx("option",{value:"voided",children:"Voided"}),n.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Sa,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),n.jsxs("select",{value:c,onChange:x=>d(x.target.value),className:"pl-10 pr-8 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[n.jsx("option",{value:"all",children:"All Rails"}),n.jsx("option",{value:"demo",children:"Demo"}),n.jsx("option",{value:"crypto",children:"Crypto"}),n.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),n.jsxs("button",{onClick:b,disabled:f,className:"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[f?n.jsx(Y,{className:"w-5 h-5 animate-spin"}):n.jsx(He,{className:"w-5 h-5"}),"Search"]})]}),!f&&n.jsxs("p",{className:"text-slate-400 text-sm",children:[w," prediction",w!==1?"s":""," found"]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:f?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Searching..."})]}):u.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Be,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"No predictions found"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Try a different search term or filter"})]}):n.jsx("div",{className:"divide-y divide-slate-700",children:u.map(x=>{const _=Sl.pending??{icon:Ze,color:"text-amber-400 bg-amber-600/20",label:"Pending"};(Sl[x.status]??_).icon;const S=x.railsSummary||{hasDemo:!1,hasCrypto:!1},E=S.hasDemo&&S.hasCrypto?"Hybrid":S.hasCrypto?"Crypto":S.hasDemo?"Demo":"â€”",T=Wd({status:x.status,closedAt:x.closesAt||x.endDate||null,settledAt:x.settledAt||null}),N=T.tone==="success"?"text-emerald-400 bg-emerald-600/20":T.tone==="danger"?"text-red-400 bg-red-600/20":T.tone==="warning"?"text-amber-400 bg-amber-600/20":"text-slate-400 bg-slate-600/20";return n.jsxs("button",{onClick:()=>s(`/admin/predictions/${x.id}`),className:"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"text-white font-medium truncate",children:x.title}),n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${N}`,children:T.label}),n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium text-slate-300 bg-slate-700/50",children:E})]}),n.jsxs("p",{className:"text-sm text-slate-400 mt-0.5",children:["by ",x.creatorName||x.creatorUsername||"Unknown"," â€¢"," ","closes ",new Date(x.closesAt||x.endDate||x.createdAt).toLocaleDateString()]})]}),n.jsx(Qt,{className:"w-5 h-5 text-slate-400 flex-shrink-0 ml-3"})]},x.id)})})})]})},Lb=Object.freeze(Object.defineProperty({__proto__:null,PredictionsPage:qa,default:qa},Symbol.toStringTag,{value:"Module"}));function Db(s){return s?s.categoryObj&&typeof s.categoryObj=="object"&&s.categoryObj.label?s.categoryObj.label:s.categoryLabel&&typeof s.categoryLabel=="string"?s.categoryLabel:s.category&&typeof s.category=="string"?s.category.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):null:null}const Wa=()=>{const{predictionId:s}=ds(),e=le(),{user:t}=J(),{user:r}=ae(),a=r?.id||t?.id||"",[i,o]=m.useState(null),[l,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,w]=m.useState(!1),[g,y]=m.useState(""),[b,v]=m.useState(null),x=m.useCallback(async()=>{if(s){c(!0);try{const $=await de(`/api/v2/admin/predictions/${s}`,a);o($)}catch{B.error("Failed to load prediction")}finally{c(!1)}}},[s,a]),_=async $=>{if(s){v($);try{const ee=await ve(`/api/v2/admin/predictions/${s}/outcome`,a,a?{optionId:$,actorId:a}:{optionId:$});if(ee?.alreadySettled)B.success("Already settled");else if(ee?.settlement){const Z=ee.settlement,yn=(Z.demoEntriesCount||0)+(Z.cryptoEntriesCount||0);B.success(`Settled! ${yn} entries processed. Fees: $${(Z.totalPlatformFee||0).toFixed(2)} platform, $${(Z.totalCreatorFee||0).toFixed(2)} creator.`)}else B.success("Settlement complete");x()}catch(ee){B.error(ee?.message||"Failed to settle prediction")}finally{v(null)}}};m.useEffect(()=>{x()},[x]);const j=async()=>{if(!(!s||!a||g.length<5)){u(!0);try{const $=await ve(`/api/v2/admin/predictions/${s}/void`,a,{reason:g});B.success(`Prediction voided. ${$.refunds?.success||0} bets refunded.`),f(!1),y(""),x()}catch($){B.error($.message||"Failed to void prediction")}finally{u(!1)}}},S=async()=>{if(!(!s||!a||g.length<5)){u(!0);try{await ve(`/api/v2/admin/predictions/${s}/cancel`,a,{reason:g}),B.success("Prediction cancelled"),w(!1),y(""),x()}catch($){B.error($.message||"Failed to cancel prediction")}finally{u(!1)}}},E=async()=>{if(!(!s||!a)&&window.confirm("Reset this prediction to active? This will undo settlement.")){u(!0);try{await ve(`/api/v2/admin/predictions/${s}/reset`,a,{}),B.success("Prediction reset to active"),x()}catch($){B.error($.message||"Failed to reset prediction")}finally{u(!1)}}};if(l)return n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})});if(!i)return n.jsxs("div",{className:"text-center py-20",children:[n.jsx(We,{className:"w-12 h-12 text-amber-500 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"Prediction not found"})]});const{prediction:T,creator:N,options:C,stats:O,entries:F}=i;T.status;const re=T.status==="settled",K=T.status==="voided"||T.status==="cancelled",ue=Xs;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("button",{onClick:()=>e("/admin/predictions"),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[n.jsx(ps,{className:"w-4 h-4"}),"Back to Predictions"]}),n.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Be,{className:"w-7 h-7 text-emerald-500"}),T.title]}),n.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[n.jsx("p",{className:"text-slate-400 font-mono text-sm",children:T.id}),(()=>{const $=Db(i);return $?n.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-700 px-2.5 py-0.5 text-xs font-medium text-slate-300",children:$}):null})()]})]}),(()=>{const $=Wd({status:T.status,settledAt:T.settledAt||T.resolutionDate,closedAt:T.closedAt||T.closesAt||T.endDate});return n.jsxs("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${$.tone==="success"?"bg-emerald-600/20 text-emerald-400":$.tone==="danger"?"bg-red-600/20 text-red-400":$.tone==="warning"?"bg-amber-600/20 text-amber-400":"bg-slate-600/20 text-slate-400"}`,children:[$.label,$.subtext&&n.jsx("span",{className:"ml-2 text-xs opacity-75",children:$.subtext})]})})()]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(er,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Stake"})]}),n.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",O.totalStake.toFixed(2)]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Bt,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Bettors"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:O.uniqueBettors})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Be,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Bets"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:O.entryCount})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Ze,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Created"})]}),n.jsx("p",{className:"text-lg font-medium text-white",children:new Date(T.createdAt).toLocaleDateString()})]})]}),i.aggregates&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-2",children:"Demo rail"}),n.jsxs("p",{className:"text-slate-400 text-sm",children:["Pot: ",n.jsxs("span",{className:"text-white",children:["$",Number(i.aggregates.demo?.pot||0).toFixed(2)]})]}),n.jsxs("p",{className:"text-slate-400 text-sm",children:["Entries: ",n.jsx("span",{className:"text-white",children:i.aggregates.demo?.entriesCount||0})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-2",children:"Crypto rail"}),n.jsxs("p",{className:"text-slate-400 text-sm",children:["Pot: ",n.jsxs("span",{className:"text-white",children:["$",Number(i.aggregates.crypto?.pot||0).toFixed(2)]})]}),n.jsxs("p",{className:"text-slate-400 text-sm",children:["Entries: ",n.jsx("span",{className:"text-white",children:i.aggregates.crypto?.entriesCount||0})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-2",children:"Total"}),n.jsxs("p",{className:"text-slate-400 text-sm",children:["Pot: ",n.jsxs("span",{className:"text-white",children:["$",Number(i.aggregates.total?.pot||0).toFixed(2)]})]}),n.jsxs("p",{className:"text-slate-400 text-sm",children:["Entries: ",n.jsx("span",{className:"text-white",children:i.aggregates.total?.entriesCount||0})]})]})]}),N&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[n.jsx(je,{className:"w-4 h-4"}),"Creator"]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:N.fullName||N.username||"Unknown"}),n.jsx("p",{className:"text-sm text-slate-400",children:N.email})]}),n.jsxs("button",{onClick:()=>e(`/admin/users/${N.id}`),className:"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600 flex items-center gap-1",children:["View Profile",n.jsx(et,{className:"w-3 h-3"})]})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-4 py-3 border-b border-slate-700",children:n.jsx("h2",{className:"text-white font-semibold",children:"Options"})}),n.jsx("div",{className:"divide-y divide-slate-700",children:C.map($=>n.jsxs("div",{className:`px-4 py-3 flex items-center justify-between ${T.winningOptionId===$.id?"bg-emerald-600/10 border-l-4 border-emerald-500":""}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[T.winningOptionId===$.id&&n.jsx(Ge,{className:"w-5 h-5 text-emerald-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:$.text}),n.jsxs("p",{className:"text-sm text-slate-400",children:["Odds: ",$.odds?.toFixed(2)||"N/A"," â€¢ Prob: ",(($.probability||0)*100).toFixed(0),"%"]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-white font-medium",children:["$",$.totalStake.toFixed(2)]}),n.jsx("p",{className:"text-sm text-slate-400",children:"staked"})]})]},$.id))})]}),F.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-4 py-3 border-b border-slate-700",children:n.jsxs("h2",{className:"text-white font-semibold",children:["Recent Bets (",F.length,")"]})}),n.jsx("div",{className:"divide-y divide-slate-700 max-h-[300px] overflow-y-auto",children:F.map($=>{const ee=C.find(Z=>Z.id===$.option_id);return n.jsxs("div",{className:"px-4 py-2 flex items-center justify-between text-sm",children:[n.jsxs("div",{children:[n.jsxs("span",{className:"text-white font-mono text-xs",children:[$.user_id.slice(0,8),"..."]}),n.jsxs("span",{className:"text-slate-400 ml-2",children:['on "',ee?.text||"?",'"']})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("span",{className:"text-white font-medium",children:["$",Number($.amount).toFixed(2)]}),n.jsx("span",{className:`ml-2 px-1.5 py-0.5 rounded text-xs ${$.provider==="demo-wallet"?"bg-purple-600/20 text-purple-400":"bg-blue-600/20 text-blue-400"}`,children:$.provider==="demo-wallet"?"Demo":"Crypto"})]})]},$.id)})})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-3",children:"Navigation"}),n.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[N?.id&&n.jsxs("button",{onClick:()=>e(`/admin/users/${N.id}/view`),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 flex items-center gap-2",children:[n.jsx(je,{className:"w-4 h-4"}),"View as user (creator)"]}),n.jsxs("button",{onClick:()=>window.open(`${ue}/predictions/${s}`,"_blank"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 flex items-center gap-2",children:[n.jsx(et,{className:"w-4 h-4"}),"Go to prediction page"]})]})]}),!T.winningOptionId&&!K&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-2",children:"Settle Prediction"}),n.jsx("p",{className:"text-slate-400 text-sm mb-3",children:"Select the winning outcome to settle this prediction immediately. Winners will be credited and losers debited."}),n.jsx("div",{className:"flex flex-wrap gap-2",children:C.map($=>n.jsx("button",{onClick:()=>_($.id),disabled:b!==null,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700 disabled:opacity-50",children:b===$.id?"Settlingâ€¦":`Settle: ${$.text}`},$.id))})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-4",children:"Admin Actions"}),n.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.jsxs("button",{onClick:()=>f(!0),disabled:K||d,className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n.jsx(Hs,{className:"w-4 h-4"}),"Void (Refund Bets)"]}),n.jsxs("button",{onClick:()=>w(!0),disabled:K||d,className:"px-4 py-2 bg-slate-600 text-white rounded-lg font-medium hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n.jsx(Pi,{className:"w-4 h-4"}),"Cancel (No Refund)"]}),re&&n.jsxs("button",{onClick:E,disabled:d,className:"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n.jsx(gx,{className:"w-4 h-4"}),"Reset to Active"]})]}),K&&n.jsxs("p",{className:"text-amber-400 text-sm mt-3 flex items-center gap-2",children:[n.jsx(We,{className:"w-4 h-4"}),"This prediction has been ",T.status," and cannot be modified further."]})]}),h&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700",children:[n.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Void Prediction"}),n.jsx("p",{className:"text-slate-400 mb-4",children:"This will void the prediction and refund all bets to participants."}),n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Reason (required)"}),n.jsx("textarea",{value:g,onChange:$=>y($.target.value),placeholder:"Explain why this prediction is being voided...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-red-500 h-24 resize-none"}),n.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[n.jsx("button",{onClick:()=>{f(!1),y("")},className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600",children:"Cancel"}),n.jsxs("button",{onClick:j,disabled:g.length<5||d,className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[d&&n.jsx(Y,{className:"w-4 h-4 animate-spin"}),"Void Prediction"]})]})]})}),p&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700",children:[n.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Cancel Prediction"}),n.jsxs("p",{className:"text-amber-400 text-sm mb-4 flex items-start gap-2",children:[n.jsx(We,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),n.jsxs("span",{children:["This will cancel the prediction ",n.jsx("strong",{children:"without refunding bets"}),". Use this only for spam/fraud predictions."]})]}),n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Reason (required)"}),n.jsx("textarea",{value:g,onChange:$=>y($.target.value),placeholder:"Explain why this prediction is being cancelled...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 h-24 resize-none"}),n.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[n.jsx("button",{onClick:()=>{w(!1),y("")},className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600",children:"Back"}),n.jsxs("button",{onClick:S,disabled:g.length<5||d,className:"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[d&&n.jsx(Y,{className:"w-4 h-4 animate-spin"}),"Cancel Prediction"]})]})]})})]})},$b=Object.freeze(Object.defineProperty({__proto__:null,PredictionDetailPage:Wa,default:Wa},Symbol.toStringTag,{value:"Module"})),Ha=()=>{const s=le(),{user:e}=J(),{user:t}=ae(),r=t?.id||e?.id||"",[a,i]=m.useState([]),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,h]=m.useState(null),f=m.useCallback(async()=>{d(!0);try{const[b,v]=await Promise.all([de("/api/v2/admin/settlements/queue",r),de("/api/v2/admin/settlements/stats",r)]);i(b.items||[]),l(v||null)}catch{}finally{d(!1)}},[r]);m.useEffect(()=>{f()},[f]);const p=async b=>{h(b);try{await ve(`/api/v2/admin/settlements/${b}/sync`,r,r?{actorId:r}:{}),B.success("Sync queued"),f()}catch(v){B.error(v?.message||"Failed to sync")}finally{h(null)}},w=async b=>{if(window.confirm("Finalize on-chain? This may submit a relayer transaction.")){h(b);try{await ve(`/api/v2/admin/settlements/${b}/finalize`,r,r?{actorId:r}:{}),B.success("Finalize submitted"),f()}catch(v){B.error(v.message||"Failed to finalize")}finally{h(null)}}},g=b=>{const v=[];return b.needs.needsOutcome&&v.push({label:"Outcome",cls:"bg-amber-600/20 text-amber-400"}),b.needs.needsOffchainSettlement&&v.push({label:"Offchain",cls:"bg-blue-600/20 text-blue-400"}),b.needs.needsOnchainFinalize&&v.push({label:"Finalize",cls:"bg-red-600/20 text-red-400"}),v.length===0&&v.push({label:"OK",cls:"bg-emerald-600/20 text-emerald-400"}),v},y=b=>{if(!b)return null;const v={queued:{icon:Ze,color:"text-amber-400 bg-amber-600/20"},running:{icon:wt,color:"text-blue-400 bg-blue-600/20"},finalized:{icon:Ge,color:"text-emerald-400 bg-emerald-600/20"},failed:{icon:Hs,color:"text-red-400 bg-red-600/20"}},x=v.queued??{icon:Ze,color:"text-amber-400 bg-amber-600/20"},_=v[b.status]??x,j=_.icon;return n.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex items-center gap-1 ${_.color}`,children:[n.jsx(j,{className:`w-3 h-3 ${b.status==="running"?"animate-spin":""}`}),b.status]})};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Ws,{className:"w-7 h-7 text-emerald-500"}),"Settlements"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Manage prediction settlements and finalization"})]}),o&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(We,{className:"w-4 h-4 text-amber-400"}),n.jsx("span",{className:"text-sm",children:"Pending Settlement"})]}),n.jsx("p",{className:"text-2xl font-bold text-amber-400",children:o.predictions.pendingSettlement})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Ge,{className:"w-4 h-4 text-emerald-400"}),n.jsx("span",{className:"text-sm",children:"Settled"})]}),n.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:o.predictions.settled})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Hs,{className:"w-4 h-4 text-red-400"}),n.jsx("span",{className:"text-sm",children:"Failed Jobs"})]}),n.jsx("p",{className:"text-2xl font-bold text-red-400",children:o.jobs.failed})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(is,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Staked"})]}),n.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",o.totalStake.toLocaleString()]})]})]}),n.jsx("div",{className:"text-slate-400 text-sm",children:"Finalize Queue â€” items needing Outcome, Offchain sync, or Onchain finalize."}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:c?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Loading queue..."})]}):a.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Ws,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"Queue is empty"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"No predictions need admin settlement attention."})]}):n.jsx("div",{className:"divide-y divide-slate-700",children:a.map(b=>n.jsx("div",{className:"px-4 py-3 hover:bg-slate-700/30 transition-colors",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("p",{className:"text-white font-medium truncate",children:b.title}),n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-slate-600/20 text-slate-300",children:b.status}),y(b.job),g(b).map(v=>n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${v.cls}`,children:v.label},v.label))]}),n.jsxs("p",{className:"text-sm text-slate-400 mt-0.5",children:["Rails: ",b.rails.hasDemo&&b.rails.hasCrypto?"Hybrid":b.rails.hasCrypto?"Crypto":b.rails.hasDemo?"Demo":"â€”"," â€¢ Closes: ",b.closesAt?new Date(b.closesAt).toLocaleDateString():"â€”"]}),b.job?.error&&n.jsxs("p",{className:"text-xs text-red-400 mt-1 truncate",children:["Error: ",b.job.error]})]}),n.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[n.jsxs("button",{onClick:()=>p(b.predictionId),disabled:u===b.predictionId||b.needs.needsOutcome,title:b.needs.needsOutcome?"Set outcome first (use Details â†’ Set Outcome)":"Sync settlement",className:`px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 ${b.needs.needsOutcome?"bg-slate-700 text-slate-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50"}`,children:[u===b.predictionId?n.jsx(Y,{className:"w-3 h-3 animate-spin"}):n.jsx(wt,{className:"w-3 h-3"}),"Sync"]}),b.needs.needsOnchainFinalize&&n.jsx("button",{onClick:()=>w(b.predictionId),disabled:u===b.predictionId,className:"px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 disabled:opacity-50 flex items-center gap-1",children:"Finalize"}),n.jsxs("button",{onClick:()=>s(`/admin/predictions/${b.predictionId}`),className:"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600 flex items-center gap-1",children:["Details",n.jsx(Qt,{className:"w-3 h-3"})]})]})]})},b.predictionId))})})]})},Ub=Object.freeze(Object.defineProperty({__proto__:null,SettlementsPage:Ha,default:Ha},Symbol.toStringTag,{value:"Module"})),Ka=()=>{const{predictionId:s}=ds(),e=le(),{user:t}=J(),{user:r}=ae(),a=r?.id||t?.id||"",[i,o]=m.useState(null),[l,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,w]=m.useState(""),g=m.useCallback(async()=>{if(s){c(!0);try{if(!a)throw new Error("Missing user");const F=await de(`/api/v2/admin/settlements/${s}`,a);o(F)}catch{B.error("Failed to load settlement")}finally{c(!1)}}},[s,a]);m.useEffect(()=>{g()},[g]);const y=async()=>{if(!(!s||!a||!p)){u(!0);try{await ve(`/api/v2/admin/settlements/${s}/trigger`,a,{winningOptionId:p}),B.success("Settlement triggered"),f(!1),g()}catch(F){B.error(F.message||"Failed to trigger settlement")}finally{u(!1)}}},b=async()=>{if(!(!s||!a)){u(!0);try{await ve(`/api/v2/admin/settlements/${s}/retry`,a,{}),B.success("Settlement retry queued"),g()}catch{B.error("Failed to retry settlement")}finally{u(!1)}}},v=F=>{navigator.clipboard.writeText(F),B.success("Copied to clipboard")};if(l)return n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})});if(!i)return n.jsxs("div",{className:"text-center py-20",children:[n.jsx(We,{className:"w-12 h-12 text-amber-500 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"Settlement not found"})]});const{prediction:x,creator:_,options:j,entryStats:S,job:E,payouts:T}=i,C=x.status==="active"&&new Date(x.endDate)<new Date&&!x.winningOptionId,O=E?.status==="failed";return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("button",{onClick:()=>e("/admin/settlements"),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[n.jsx(ps,{className:"w-4 h-4"}),"Back to Settlements"]}),n.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Ws,{className:"w-7 h-7 text-emerald-500"}),x.title]}),n.jsx("p",{className:"text-slate-400 mt-1 font-mono text-sm",children:x.id})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${x.status==="active"?"bg-emerald-600/20 text-emerald-400":x.status==="settled"?"bg-blue-600/20 text-blue-400":"bg-slate-600/20 text-slate-400"}`,children:x.status}),E&&n.jsxs("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium flex items-center gap-1 ${E.status==="queued"?"bg-amber-600/20 text-amber-400":E.status==="running"?"bg-blue-600/20 text-blue-400":E.status==="finalized"?"bg-emerald-600/20 text-emerald-400":"bg-red-600/20 text-red-400"}`,children:[E.status==="running"&&n.jsx(wt,{className:"w-3 h-3 animate-spin"}),"Job: ",E.status]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(er,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Stake"})]}),n.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",S.totalStake.toFixed(2)]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Bt,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"Total Entries"})]}),n.jsx("p",{className:"text-2xl font-bold text-white",children:S.total})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:[n.jsx(Ze,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:"End Date"})]}),n.jsx("p",{className:"text-lg font-medium text-white",children:new Date(x.endDate).toLocaleDateString()})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("div",{className:"flex items-center gap-2 text-slate-400 mb-2",children:n.jsx("span",{className:"text-sm",children:"Fees"})}),n.jsxs("p",{className:"text-lg font-medium text-white",children:["Platform: ",x.platformFee,"% â€¢ Creator: ",x.creatorFee,"%"]})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-4 py-3 border-b border-slate-700",children:n.jsx("h2",{className:"text-white font-semibold",children:"Options & Stakes"})}),n.jsx("div",{className:"divide-y divide-slate-700",children:j.map(F=>{const re=S.byOption[F.id]||{count:0,stake:0},K=x.winningOptionId===F.id;return n.jsxs("div",{className:`px-4 py-3 flex items-center justify-between ${K?"bg-emerald-600/10 border-l-4 border-emerald-500":""}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[K&&n.jsx(Ge,{className:"w-5 h-5 text-emerald-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:F.text}),n.jsxs("p",{className:"text-sm text-slate-400",children:[re.count," entries â€¢ Odds: ",F.odds?.toFixed(2)||"N/A"]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-white font-medium",children:["$",re.stake.toFixed(2)]}),n.jsxs("p",{className:"text-sm text-slate-400",children:[S.totalStake>0?(re.stake/S.totalStake*100).toFixed(1):0,"%"]})]})]},F.id)})})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-3",children:"Stakes by Provider"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(S.byProvider).map(([F,re])=>n.jsxs("div",{className:"bg-slate-900 rounded-lg p-3",children:[n.jsx("p",{className:`text-xs font-medium uppercase ${F==="demo-wallet"?"text-purple-400":"text-blue-400"}`,children:F==="demo-wallet"?"Demo":F}),n.jsxs("p",{className:"text-white font-bold text-lg mt-1",children:["$",re.stake.toFixed(2)]}),n.jsxs("p",{className:"text-slate-400 text-sm",children:[re.count," entries"]})]},F))})]}),E&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-3",children:"Settlement Job"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-slate-400",children:"Status"}),n.jsx("span",{className:`font-medium ${E.status==="finalized"?"text-emerald-400":E.status==="failed"?"text-red-400":"text-amber-400"}`,children:E.status})]}),E.tx_hash&&n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-slate-400",children:"Transaction"}),n.jsxs("button",{onClick:()=>v(E.tx_hash),className:"text-blue-400 font-mono text-sm flex items-center gap-1 hover:text-blue-300",children:[E.tx_hash.slice(0,10),"...",E.tx_hash.slice(-8),n.jsx(pd,{className:"w-3 h-3"})]})]}),E.error&&n.jsxs("div",{children:[n.jsx("span",{className:"text-slate-400 text-sm",children:"Error"}),n.jsx("p",{className:"text-red-400 text-sm mt-1 bg-red-600/10 rounded p-2",children:E.error})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-slate-400",children:"Created"}),n.jsx("span",{className:"text-slate-300",children:new Date(E.created_at).toLocaleString()})]})]})]}),T.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-4 py-3 border-b border-slate-700",children:n.jsxs("h2",{className:"text-white font-semibold",children:["Payouts (",T.length,")"]})}),n.jsx("div",{className:"divide-y divide-slate-700 max-h-[300px] overflow-y-auto",children:T.map(F=>n.jsxs("div",{className:"px-4 py-2 flex items-center justify-between text-sm",children:[n.jsxs("div",{children:[n.jsxs("span",{className:"text-white font-mono text-xs",children:[F.user_id.slice(0,8),"..."]}),n.jsx("span",{className:`ml-2 px-1.5 py-0.5 rounded text-xs ${F.channel==="payout"?"bg-emerald-600/20 text-emerald-400":F.channel==="creator_fee"?"bg-blue-600/20 text-blue-400":"bg-purple-600/20 text-purple-400"}`,children:F.channel})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("span",{className:"text-white font-medium",children:["$",Number(F.amount).toFixed(2)]}),n.jsx("span",{className:`ml-2 text-xs ${F.status==="completed"?"text-emerald-400":"text-amber-400"}`,children:F.status})]})]},F.id))})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4",children:[n.jsx("h3",{className:"text-white font-semibold mb-4",children:"Admin Actions"}),n.jsxs("div",{className:"flex flex-wrap gap-3",children:[C&&n.jsxs("button",{onClick:()=>f(!0),disabled:d,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 flex items-center gap-2",children:[n.jsx(yd,{className:"w-4 h-4"}),"Trigger Settlement"]}),O&&n.jsxs("button",{onClick:b,disabled:d,className:"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:opacity-50 flex items-center gap-2",children:[d?n.jsx(Y,{className:"w-4 h-4 animate-spin"}):n.jsx(wt,{className:"w-4 h-4"}),"Retry Settlement"]}),n.jsxs("button",{onClick:()=>e(`/admin/predictions/${x.id}`),className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 flex items-center gap-2",children:["View Prediction",n.jsx(et,{className:"w-4 h-4"})]}),_&&n.jsxs("button",{onClick:()=>e(`/admin/users/${_.id}`),className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 flex items-center gap-2",children:[n.jsx(je,{className:"w-4 h-4"}),"View Creator"]})]})]}),h&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700",children:[n.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Trigger Settlement"}),n.jsx("p",{className:"text-slate-400 mb-4",children:"Select the winning option to settle this prediction."}),n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Winning Option"}),n.jsxs("select",{value:p,onChange:F=>w(F.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[n.jsx("option",{value:"",children:"Select option..."}),j.map(F=>n.jsx("option",{value:F.id,children:F.text},F.id))]}),n.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.jsx("button",{onClick:()=>{f(!1),w("")},className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600",children:"Cancel"}),n.jsxs("button",{onClick:y,disabled:!p||d,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[d&&n.jsx(Y,{className:"w-4 h-4 animate-spin"}),"Trigger Settlement"]})]})]})})]})},Bb=Object.freeze(Object.defineProperty({__proto__:null,SettlementDetailPage:Ka,default:Ka},Symbol.toStringTag,{value:"Module"})),Ga=()=>{const s=le(),{user:e}=J(),{user:t}=ae(),r=t?.id||e?.id||"",[a,i]=m.useState(""),[o,l]=m.useState(!1),[c,d]=m.useState(null),[u,h]=m.useState(!1),f=m.useCallback(async()=>{if(!a.trim()||a.length<2){B.error("Query must be at least 2 characters");return}if(r){l(!0),h(!0);try{const g=await de("/api/v2/admin/support/search",r,{q:a.trim()});d(g.results)}catch{B.error("Search failed"),d(null)}finally{l(!1)}}},[a,r]),p=g=>{g.key==="Enter"&&f()},w=c?c.users.length+c.predictions.length+c.transactions.length:0;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(dx,{className:"w-7 h-7 text-emerald-500"}),"Support Center"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Search users, predictions, and transactions for investigation"})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[n.jsx("h3",{className:"text-white font-semibold mb-4",children:"Global Search"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(He,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),n.jsx("input",{type:"text",value:a,onChange:g=>i(g.target.value),onKeyDown:p,placeholder:"Search by user ID, email, username, prediction ID, tx hash...",className:"w-full pl-10 pr-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:f,disabled:o||a.length<2,className:"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[o?n.jsx(Y,{className:"w-5 h-5 animate-spin"}):n.jsx(He,{className:"w-5 h-5"}),"Search"]})]}),n.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"Tip: You can search by UUID, email address, username, prediction title, or transaction hash (0x...)"})]}),u&&n.jsx("div",{className:"space-y-4",children:o?n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-12 text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Searching..."})]}):w===0?n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-12 text-center",children:[n.jsx(He,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"No results found"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Try a different search term"})]}):n.jsxs(n.Fragment,{children:[n.jsxs("p",{className:"text-slate-400 text-sm",children:[w," result",w!==1?"s":""," found"]}),c?.users&&c.users.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center gap-2",children:[n.jsx(je,{className:"w-4 h-4 text-blue-400"}),n.jsxs("h3",{className:"text-white font-semibold",children:["Users (",c.users.length,")"]})]}),n.jsx("div",{className:"divide-y divide-slate-700",children:c.users.map(g=>n.jsxs("button",{onClick:()=>s(`/admin/users/${g.id}`),className:"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:g.full_name||g.username||"Unknown"}),n.jsx("p",{className:"text-sm text-slate-400",children:g.email||g.id})]}),n.jsx(Qt,{className:"w-4 h-4 text-slate-400"})]},g.id))})]}),c?.predictions&&c.predictions.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center gap-2",children:[n.jsx(Be,{className:"w-4 h-4 text-emerald-400"}),n.jsxs("h3",{className:"text-white font-semibold",children:["Predictions (",c.predictions.length,")"]})]}),n.jsx("div",{className:"divide-y divide-slate-700",children:c.predictions.map(g=>n.jsxs("button",{onClick:()=>s(`/admin/predictions/${g.id}`),className:"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:g.title}),n.jsxs("p",{className:"text-sm text-slate-400 flex items-center gap-2",children:[n.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${g.status==="active"?"bg-emerald-600/20 text-emerald-400":g.status==="settled"?"bg-blue-600/20 text-blue-400":"bg-slate-600/20 text-slate-400"}`,children:g.status}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Ze,{className:"w-3 h-3"}),new Date(g.created_at).toLocaleDateString()]})]})]}),n.jsx(Qt,{className:"w-4 h-4 text-slate-400"})]},g.id))})]}),c?.transactions&&c.transactions.length>0&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center gap-2",children:[n.jsx(dl,{className:"w-4 h-4 text-purple-400"}),n.jsxs("h3",{className:"text-white font-semibold",children:["Transactions (",c.transactions.length,")"]})]}),n.jsx("div",{className:"divide-y divide-slate-700",children:c.transactions.map(g=>n.jsxs("button",{onClick:()=>s(`/admin/wallets/${g.user_id}`),className:"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-white font-medium",children:["$",Number(g.amount).toFixed(2)," - ",g.channel]}),n.jsxs("p",{className:"text-sm text-slate-400 font-mono",children:[g.tx_hash?.slice(0,20),"..."]})]}),n.jsx(Qt,{className:"w-4 h-4 text-slate-400"})]},g.id))})]})]})}),!u&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsxs("button",{onClick:()=>s("/admin/users"),className:"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:bg-slate-700/50 transition-colors text-left",children:[n.jsx(je,{className:"w-8 h-8 text-blue-400 mb-3"}),n.jsx("h3",{className:"text-white font-semibold",children:"User Management"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Search and manage user accounts"})]}),n.jsxs("button",{onClick:()=>s("/admin/settlements"),className:"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:bg-slate-700/50 transition-colors text-left",children:[n.jsx(Be,{className:"w-8 h-8 text-emerald-400 mb-3"}),n.jsx("h3",{className:"text-white font-semibold",children:"Settlements"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"View and manage prediction settlements"})]}),n.jsxs("button",{onClick:()=>s("/admin/wallets"),className:"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:bg-slate-700/50 transition-colors text-left",children:[n.jsx(dl,{className:"w-8 h-8 text-purple-400 mb-3"}),n.jsx("h3",{className:"text-white font-semibold",children:"Wallets"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Investigate wallet transactions"})]})]})]})},Fb=Object.freeze(Object.defineProperty({__proto__:null,SupportPage:Ga,default:Ga},Symbol.toStringTag,{value:"Module"})),Za=()=>{const s=le(),{user:e}=J(),{user:t}=ae(),r=t?.id||e?.id||"",[a,i]=m.useState("creators"),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,h]=m.useState(null),[f,p]=m.useState(""),[w,g]=m.useState(!1),[y,b]=m.useState(null),[v,x]=m.useState(""),_=m.useCallback(async()=>{d(!0);try{if(!r)throw new Error("Missing user");const C=await de("/api/v2/admin/moderation/creators",r,{limit:100});l(C.items||[])}catch{B.error("Failed to load creators")}finally{d(!1)}},[r]);m.useEffect(()=>{a==="creators"&&_()},[a,_]);const j=async()=>{if(!(!y||!r||v.length<5)){h(y.id);try{const C=await ve(`/api/v2/admin/moderation/users/${y.id}/ban`,r,{reason:v});B.success("User banned successfully"),g(!1),b(null),x(""),_()}catch(C){B.error(C.message||"Failed to ban user")}finally{h(null)}}},S=async C=>{if(r){h(C);try{await ve(`/api/v2/admin/moderation/users/${C}/unban`,r,{}),B.success("User unbanned successfully"),_()}catch(O){B.error(O.message||"Failed to unban user")}finally{h(null)}}},E=async C=>{if(r){h(C);try{await ve(`/api/v2/admin/moderation/users/${C}/verify`,r,{}),B.success("User verified successfully"),_()}catch(O){B.error(O.message||"Failed to verify user")}finally{h(null)}}},T=async C=>{if(r){h(C);try{await ve(`/api/v2/admin/moderation/users/${C}/unverify`,r,{}),B.success("Verification removed"),_()}catch(O){B.error(O.message||"Failed to remove verification")}finally{h(null)}}},N=f?o.filter(C=>C.username?.toLowerCase().includes(f.toLowerCase())||C.fullName?.toLowerCase().includes(f.toLowerCase())||C.email?.toLowerCase().includes(f.toLowerCase())):o;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(as,{className:"w-7 h-7 text-emerald-500"}),"Moderation"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Manage creators, bans, and content reports"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>i("creators"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${a==="creators"?"bg-emerald-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[n.jsx(je,{className:"w-4 h-4 inline mr-2"}),"Creators"]}),n.jsxs("button",{onClick:()=>i("reports"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${a==="reports"?"bg-emerald-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[n.jsx(ka,{className:"w-4 h-4 inline mr-2"}),"Reports"]})]}),a==="creators"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative",children:[n.jsx(He,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),n.jsx("input",{type:"text",value:f,onChange:C=>p(C.target.value),placeholder:"Filter by username, name, or email...",className:"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:c?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Loading creators..."})]}):N.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(je,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"No creators found"})]}):n.jsx("div",{className:"divide-y divide-slate-700",children:N.map(C=>n.jsxs("div",{className:`px-4 py-3 flex items-center justify-between ${C.isBanned?"bg-red-900/10":""}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden",children:C.avatarUrl?n.jsx("img",{src:C.avatarUrl,alt:"",className:"w-full h-full object-cover"}):n.jsx(je,{className:"w-5 h-5 text-slate-400"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"text-white font-medium",children:C.fullName||C.username||"Unknown"}),C.isVerified&&n.jsx(Ea,{className:"w-4 h-4 text-blue-400","aria-label":"Verified"}),C.isBanned&&n.jsx("span",{className:"px-2 py-0.5 bg-red-600/20 text-red-400 text-xs rounded-full",children:"Banned"})]}),n.jsxs("p",{className:"text-sm text-slate-400",children:[C.email," â€¢ ",C.predictionCount," predictions"]}),C.isBanned&&C.banReason&&n.jsxs("p",{className:"text-xs text-red-400 mt-0.5",children:["Reason: ",C.banReason]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>s(`/admin/users/${C.id}`),className:"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600",children:"View"}),C.isVerified?n.jsxs("button",{onClick:()=>T(C.id),disabled:u===C.id,className:"px-3 py-1.5 bg-slate-600 text-white rounded-lg text-sm hover:bg-slate-500 disabled:opacity-50 flex items-center gap-1",children:[u===C.id?n.jsx(Y,{className:"w-3 h-3 animate-spin"}):n.jsx(Hs,{className:"w-3 h-3"}),"Unverify"]}):n.jsxs("button",{onClick:()=>E(C.id),disabled:u===C.id,className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50 flex items-center gap-1",children:[u===C.id?n.jsx(Y,{className:"w-3 h-3 animate-spin"}):n.jsx(Ea,{className:"w-3 h-3"}),"Verify"]}),C.isBanned?n.jsxs("button",{onClick:()=>S(C.id),disabled:u===C.id,className:"px-3 py-1.5 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700 disabled:opacity-50 flex items-center gap-1",children:[u===C.id?n.jsx(Y,{className:"w-3 h-3 animate-spin"}):n.jsx(Ge,{className:"w-3 h-3"}),"Unban"]}):n.jsxs("button",{onClick:()=>{b(C),g(!0)},disabled:u===C.id,className:"px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 disabled:opacity-50 flex items-center gap-1",children:[n.jsx(Pi,{className:"w-3 h-3"}),"Ban"]})]})]},C.id))})})]}),a==="reports"&&n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-8 text-center",children:[n.jsx(ka,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"Content Reports"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"No reports pending. Reports from users will appear here."})]}),w&&y&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700",children:[n.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Ban User"}),n.jsxs("p",{className:"text-slate-400 mb-4",children:["Ban ",n.jsx("strong",{className:"text-white",children:y.fullName||y.username}),"? They will be unable to access the platform."]}),n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Reason (required)"}),n.jsx("textarea",{value:v,onChange:C=>x(C.target.value),placeholder:"Explain why this user is being banned...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-red-500 h-24 resize-none"}),n.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[n.jsx("button",{onClick:()=>{g(!1),b(null),x("")},className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600",children:"Cancel"}),n.jsxs("button",{onClick:j,disabled:v.length<5||u===y.id,className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[u===y.id&&n.jsx(Y,{className:"w-4 h-4 animate-spin"}),"Ban User"]})]})]})})]})},Mb=Object.freeze(Object.defineProperty({__proto__:null,ModerationPage:Za,default:Za},Symbol.toStringTag,{value:"Module"})),Mn={maintenance_mode:!1,maintenance_message:"The platform is currently under maintenance. Please check back soon.",feature_flags:{crypto_deposits:!0,demo_wallet:!0,referrals:!0,comments:!0},platform_fee_percentage:2.5,creator_fee_percentage:1,min_bet_amount:1,max_bet_amount:1e4,default_demo_balance:1e3},Ja=()=>{const{user:s}=J(),{user:e}=ae(),t=e?.id||s?.id||"",[r,a]=m.useState(Mn),[i,o]=m.useState(!0),[l,c]=m.useState(!1),[d,u]=m.useState(""),h=m.useCallback(async()=>{o(!0);try{const g=await de("/api/v2/admin/config",t||"");a({...Mn,...g.config}),u(g.config?.maintenance_message||Mn.maintenance_message)}catch{}finally{o(!1)}},[t]);m.useEffect(()=>{h()},[h]);const f=async()=>{c(!0);try{const g=!r.maintenance_mode;await ve("/api/v2/admin/config/maintenance",t||"",{enabled:g,message:d}),a(y=>({...y,maintenance_mode:g})),B.success(g?"Maintenance mode enabled":"Maintenance mode disabled"),setTimeout(()=>h(),500)}catch(g){B.error(g?.message||"Failed to toggle maintenance mode")}finally{c(!1)}},p=async g=>{c(!0);try{const y={...r.feature_flags,[g]:!r.feature_flags[g]};await ve("/api/v2/admin/config/feature-flags",t||"",{flags:{[g]:y[g]}}),a(b=>({...b,feature_flags:y})),B.success(`${g.replace(/_/g," ")} ${y[g]?"enabled":"disabled"}`)}catch(y){B.error(y?.message||"Failed to update feature flag")}finally{c(!1)}},w=async(g,y)=>{c(!0);try{await Cb(`/api/v2/admin/config/${g}`,t||"",{value:y}),a(b=>({...b,[g]:y})),B.success("Config saved")}catch(b){B.error(b?.message||"Failed to save config")}finally{c(!1)}};return i?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(wd,{className:"w-7 h-7 text-emerald-500"}),"App Configuration"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Manage platform settings and feature flags"})]}),n.jsxs("div",{className:`rounded-xl p-6 border ${r.maintenance_mode?"bg-amber-900/20 border-amber-600":"bg-slate-800 border-slate-700"}`,children:[n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${r.maintenance_mode?"bg-amber-600/20":"bg-slate-700"}`,children:n.jsx(_d,{className:`w-6 h-6 ${r.maintenance_mode?"text-amber-400":"text-slate-400"}`})}),n.jsxs("div",{children:[n.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:["Maintenance Mode",r.maintenance_mode&&n.jsx("span",{className:"px-2 py-0.5 bg-amber-600 text-white text-xs rounded-full",children:"ACTIVE"})]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"When enabled, users will see a maintenance message instead of the app"})]})]}),n.jsxs("button",{onClick:f,disabled:l,className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${r.maintenance_mode?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-amber-600 text-white hover:bg-amber-700"} disabled:opacity-50`,children:[l?n.jsx(Y,{className:"w-4 h-4 animate-spin"}):n.jsx(mx,{className:"w-4 h-4"}),r.maintenance_mode?"Disable":"Enable"]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Maintenance Message"}),n.jsx("textarea",{value:d,onChange:g=>u(g.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 h-20 resize-none"})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-slate-700",children:[n.jsx("h2",{className:"text-lg font-semibold text-white",children:"Feature Flags"}),n.jsx("p",{className:"text-sm text-slate-400",children:"Enable or disable platform features"})]}),n.jsx("div",{className:"divide-y divide-slate-700",children:Object.entries(r.feature_flags).map(([g,y])=>n.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium capitalize",children:g.replace(/_/g," ")}),n.jsxs("p",{className:"text-sm text-slate-400",children:[g==="crypto_deposits"&&"Allow users to deposit crypto to their wallet",g==="demo_wallet"&&"Enable demo wallet for testing",g==="referrals"&&"Enable referral program",g==="comments"&&"Allow comments on predictions"]})]}),n.jsx("button",{onClick:()=>p(g),disabled:l,className:"relative",children:y?n.jsx(wx,{className:"w-10 h-10 text-emerald-500"}):n.jsx(yx,{className:"w-10 h-10 text-slate-500"})})]},g))})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-6 py-4 border-b border-slate-700",children:n.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[n.jsx(fx,{className:"w-5 h-5 text-emerald-500"}),"Fee Configuration"]})}),n.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Platform Fee (%)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:r.platform_fee_percentage,onChange:g=>a(y=>({...y,platform_fee_percentage:Number(g.target.value)})),className:"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.jsx("button",{onClick:()=>w("platform_fee_percentage",r.platform_fee_percentage),disabled:l,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:n.jsx(vs,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Creator Fee (%)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:r.creator_fee_percentage,onChange:g=>a(y=>({...y,creator_fee_percentage:Number(g.target.value)})),className:"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.jsx("button",{onClick:()=>w("creator_fee_percentage",r.creator_fee_percentage),disabled:l,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:n.jsx(vs,{className:"w-4 h-4"})})]})]})]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[n.jsx("div",{className:"px-6 py-4 border-b border-slate-700",children:n.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[n.jsx(er,{className:"w-5 h-5 text-emerald-500"}),"Bet Limits"]})}),n.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Min Bet Amount ($)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",min:"0",value:r.min_bet_amount,onChange:g=>a(y=>({...y,min_bet_amount:Number(g.target.value)})),className:"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.jsx("button",{onClick:()=>w("min_bet_amount",r.min_bet_amount),disabled:l,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:n.jsx(vs,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Max Bet Amount ($)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",min:"0",value:r.max_bet_amount,onChange:g=>a(y=>({...y,max_bet_amount:Number(g.target.value)})),className:"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.jsx("button",{onClick:()=>w("max_bet_amount",r.max_bet_amount),disabled:l,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:n.jsx(vs,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Default Demo Balance ($)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",min:"0",value:r.default_demo_balance,onChange:g=>a(y=>({...y,default_demo_balance:Number(g.target.value)})),className:"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.jsx("button",{onClick:()=>w("default_demo_balance",r.default_demo_balance),disabled:l,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:n.jsx(vs,{className:"w-4 h-4"})})]})]})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-900/20 border border-amber-600/30 rounded-lg",children:[n.jsx(We,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-amber-200 font-medium",children:"Configuration Changes Are Immediate"}),n.jsx("p",{className:"text-amber-200/70 text-sm mt-1",children:"Changes to these settings take effect immediately across the platform. Use caution when modifying production settings."})]})]})]})},Vb=Object.freeze(Object.defineProperty({__proto__:null,ConfigPage:Ja,default:Ja},Symbol.toStringTag,{value:"Module"})),Ya=()=>{const{user:s}=J(),{user:e}=ae(),t=e?.id||s?.id||"",[r,a]=m.useState([]),[i,o]=m.useState(!0),[l,c]=m.useState(0),[d,u]=m.useState(0),[h,f]=m.useState(null),[p,w]=m.useState(""),[g,y]=m.useState([]),b=25,v=m.useCallback(async()=>{o(!0);try{if(!t)return;const E=await de("/api/v2/admin/audit",t,{limit:b,offset:d,action:p||void 0});a(E.items||[]),c(E.total||0)}catch{}finally{o(!1)}},[d,p,t]),x=m.useCallback(async()=>{try{if(!t)return;const E=await de("/api/v2/admin/audit/actions",t);y(E.actions||[])}catch{}},[t]);m.useEffect(()=>{v()},[v]),m.useEffect(()=>{x()},[x]);const _=()=>{u(0),v()},j=Math.ceil(l/b),S=Math.floor(d/b)+1;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(Ta,{className:"w-7 h-7 text-emerald-500"}),"Audit Log"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Track all admin actions and changes"})]}),n.jsxs("button",{onClick:_,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 disabled:opacity-50 transition-colors",children:[n.jsx(wt,{className:`w-4 h-4 ${i?"animate-spin":""}`}),"Refresh"]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative flex-1 max-w-xs",children:[n.jsx(Sa,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),n.jsxs("select",{value:p,onChange:E=>{w(E.target.value),u(0)},className:"w-full pl-10 pr-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[n.jsx("option",{value:"",children:"All Actions"}),g.map(E=>n.jsx("option",{value:E,children:E},E))]})]}),n.jsxs("span",{className:"text-sm text-slate-400",children:[l," total entries"]})]}),n.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:[i&&r.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx("div",{className:"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto"}),n.jsx("p",{className:"text-slate-400 mt-3",children:"Loading audit log..."})]}):r.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Ta,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),n.jsx("p",{className:"text-white font-medium",children:"No audit entries found"}),n.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Admin actions will appear here"})]}):n.jsx("div",{className:"divide-y divide-slate-700",children:r.map(E=>n.jsxs("div",{className:"hover:bg-slate-700/30 transition-colors",children:[n.jsx("button",{onClick:()=>f(h===E.id?null:E.id),className:"w-full px-4 py-3 text-left",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"px-2 py-0.5 bg-emerald-600/20 text-emerald-400 text-xs font-medium rounded",children:E.action}),E.targetType&&n.jsx("span",{className:"text-slate-400 text-sm",children:E.targetType})]}),n.jsxs("div",{className:"mt-1 flex items-center gap-2 text-sm",children:[n.jsx("span",{className:"text-white",children:E.actorName}),E.targetId&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-slate-500",children:"â†’"}),n.jsxs("span",{className:"text-slate-400 font-mono text-xs",children:[E.targetId.slice(0,8),"..."]})]})]}),E.reason&&n.jsxs("p",{className:"text-slate-500 text-sm mt-1 truncate",children:["Reason: ",E.reason]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:new Date(E.createdAt).toLocaleString()}),E.meta&&Object.keys(E.meta).length>0&&(h===E.id?n.jsx(Ri,{className:"w-4 h-4 text-slate-400"}):n.jsx(Ii,{className:"w-4 h-4 text-slate-400"}))]})]})}),h===E.id&&E.meta&&n.jsx("div",{className:"px-4 pb-3",children:n.jsx("div",{className:"bg-slate-900 rounded-lg p-3 overflow-x-auto",children:n.jsx("pre",{className:"text-xs text-slate-300 font-mono",children:JSON.stringify(E.meta,null,2)})})})]},E.id))}),j>1&&n.jsxs("div",{className:"px-4 py-3 border-t border-slate-700 flex items-center justify-between",children:[n.jsx("button",{onClick:()=>u(Math.max(0,d-b)),disabled:d===0||i,className:"px-3 py-1.5 text-sm text-slate-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),n.jsxs("span",{className:"text-sm text-slate-400",children:["Page ",S," of ",j]}),n.jsx("button",{onClick:()=>u(d+b),disabled:d+b>=l||i,className:"px-3 py-1.5 text-sm text-slate-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})},zb=Object.freeze(Object.defineProperty({__proto__:null,AuditLogPage:Ya,default:Ya},Symbol.toStringTag,{value:"Module"})),qb=()=>{const{user:s}=J(),{user:e}=ae(),t=e?.id||s?.id||"",[r,a]=m.useState([]),[i,o]=m.useState(!0),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState({slug:"",label:"",icon:""}),p=m.useCallback(async()=>{o(!0);try{const x=await de("/api/v2/admin/categories",t||"");a(x.data||[])}catch{B.error("Failed to load categories")}finally{o(!1)}},[t]);m.useEffect(()=>{p()},[p]);const w=async(x,_)=>{c(!0);try{await js(`/api/v2/admin/categories/${x}`,t||"",{isEnabled:!_}),a(j=>j.map(S=>S.id===x?{...S,isEnabled:!_}:S)),B.success(`Category ${_?"disabled":"enabled"}`)}catch(j){B.error(j?.message||"Failed to update category")}finally{c(!1)}},g=async(x,_)=>{if(_===0)return;const j=r[_-1];if(j){c(!0);try{await Promise.all([js(`/api/v2/admin/categories/${x.id}`,t||"",{sortOrder:j.sortOrder}),js(`/api/v2/admin/categories/${j.id}`,t||"",{sortOrder:x.sortOrder})]),await p(),B.success("Category order updated")}catch(S){B.error(S?.message||"Failed to reorder category")}finally{c(!1)}}},y=async(x,_)=>{if(_===r.length-1)return;const j=r[_+1];if(j){c(!0);try{await Promise.all([js(`/api/v2/admin/categories/${x.id}`,t||"",{sortOrder:j.sortOrder}),js(`/api/v2/admin/categories/${j.id}`,t||"",{sortOrder:x.sortOrder})]),await p(),B.success("Category order updated")}catch(S){B.error(S?.message||"Failed to reorder category")}finally{c(!1)}}},b=async()=>{if(!h.label.trim()||!h.slug.trim()){B.error("Label and slug are required");return}c(!0);try{await ve("/api/v2/admin/categories",t||"",{slug:h.slug.toLowerCase(),label:h.label,icon:h.icon||null}),B.success("Category created"),u(!1),f({slug:"",label:"",icon:""}),await p()}catch(x){B.error(x?.message||"Failed to create category")}finally{c(!1)}},v=x=>{f({...h,label:x,slug:x.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")})};return i?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Y,{className:"w-8 h-8 text-emerald-500 animate-spin"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[n.jsx(vd,{className:"w-7 h-7 text-emerald-500"}),"Categories"]}),n.jsx("p",{className:"text-slate-400 mt-1",children:"Manage prediction categories"})]}),n.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors",children:[n.jsx(tr,{className:"w-4 h-4"}),"Add Category"]})]}),n.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden",children:n.jsx("div",{className:"divide-y divide-slate-700",children:r.map((x,_)=>n.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-slate-750 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx("button",{onClick:()=>g(x,_),disabled:_===0||l,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:n.jsx(Ri,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>y(x,_),disabled:_===r.length-1||l,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:n.jsx(Ii,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h3",{className:"text-white font-semibold",children:x.label}),n.jsxs("span",{className:"text-slate-400 text-sm font-mono",children:["/",x.slug]}),x.icon&&n.jsx("span",{className:"text-slate-400",children:x.icon})]}),n.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:["Sort order: ",x.sortOrder," â€¢ Created: ",new Date(x.createdAt).toLocaleDateString()]})]})]}),n.jsx("button",{onClick:()=>w(x.id,x.isEnabled),disabled:l,className:`px-4 py-2 rounded-lg font-medium transition-colors ${x.isEnabled?"bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30":"bg-slate-700 text-slate-400 hover:bg-slate-600"} disabled:opacity-50`,children:x.isEnabled?"Enabled":"Disabled"})]},x.id))})}),n.jsx($l,{open:d,onOpenChange:u,children:n.jsxs(Ul,{children:[n.jsx(Bl,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[12000]"}),n.jsxs(Fl,{className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-slate-800 border border-slate-700 rounded-xl shadow-2xl z-[12001] w-full max-w-md p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx(Ml,{className:"text-xl font-bold text-white",children:"Add Category"}),n.jsx(zn,{className:"p-2 rounded-lg hover:bg-slate-700 text-slate-400 hover:text-white",children:n.jsx(vt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Label *"}),n.jsx("input",{type:"text",value:h.label,onChange:x=>v(x.target.value),placeholder:"e.g., Sports",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slug *"}),n.jsx("input",{type:"text",value:h.slug,onChange:x=>f({...h,slug:x.target.value.toLowerCase()}),placeholder:"e.g., sports",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 font-mono text-sm"}),n.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Lowercase, alphanumeric, underscores only"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Icon (optional)"}),n.jsx("input",{type:"text",value:h.icon,onChange:x=>f({...h,icon:x.target.value}),placeholder:"e.g., âš½ or trophy",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500"})]})]}),n.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[n.jsx(zn,{className:"px-4 py-2 text-slate-400 hover:text-white transition-colors",children:"Cancel"}),n.jsx("button",{onClick:b,disabled:l||!h.label.trim()||!h.slug.trim(),className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:l?n.jsxs(n.Fragment,{children:[n.jsx(Y,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):n.jsxs(n.Fragment,{children:[n.jsx(rx,{className:"w-4 h-4"}),"Create"]})})]})]})]})})]})},Wb=()=>n.jsx(kb,{children:n.jsx(Hw,{children:n.jsxs(Vr,{children:[n.jsx(L,{path:"/",element:n.jsx(Ba,{})}),n.jsx(L,{path:"users",element:n.jsx(Fa,{})}),n.jsx(L,{path:"users/:userId",element:n.jsx(Ma,{})}),n.jsx(L,{path:"users/:userId/view",element:n.jsx(Ib,{})}),n.jsx(L,{path:"wallets",element:n.jsx(Va,{})}),n.jsx(L,{path:"wallets/:userId",element:n.jsx(za,{})}),n.jsx(L,{path:"predictions",element:n.jsx(qa,{})}),n.jsx(L,{path:"predictions/:predictionId",element:n.jsx(Wa,{})}),n.jsx(L,{path:"settlements",element:n.jsx(Ha,{})}),n.jsx(L,{path:"settlements/:predictionId",element:n.jsx(Ka,{})}),n.jsx(L,{path:"support",element:n.jsx(Ga,{})}),n.jsx(L,{path:"moderation",element:n.jsx(Za,{})}),n.jsx(L,{path:"config",element:n.jsx(Ja,{})}),n.jsx(L,{path:"categories",element:n.jsx(qb,{})}),n.jsx(L,{path:"audit",element:n.jsx(Ya,{})})]})})}),kl=Wb,Hb=()=>{const s=Ne();return m.useEffect(()=>{const t=`${Xs}${s.pathname}${s.search}${s.hash}`;window.location.replace(t)},[s.pathname,s.search,s.hash]),n.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:n.jsx("div",{className:"text-slate-300",children:"Redirectingâ€¦"})})},lt=Hb,Kb=()=>n.jsxs(Vr,{children:[n.jsx(L,{path:"/",element:n.jsx(Nl,{})}),n.jsx(L,{path:"/docs/funding-guide",element:n.jsx(Sb,{})}),n.jsx(L,{path:"/predictions/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/prediction/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/profile/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/wallet/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/discover/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/bets/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/create/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/rankings/*",element:n.jsx(lt,{})}),n.jsx(L,{path:"/admin",element:n.jsx(kl,{})}),n.jsx(L,{path:"/admin/*",element:n.jsx(kl,{})}),n.jsx(L,{path:"*",element:n.jsx(Nl,{})})]}),Gb=Kb;class Zb extends Ie.Component{constructor(t){super(t);te(this,"resetError",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(t.message.includes("Failed to fetch dynamically imported module")||t.message.includes("Failed to load module script")||t.message.includes("Loading chunk")||t.message.includes("ChunkLoadError")){"caches"in window&&caches.keys().then(i=>{i.forEach(o=>caches.delete(o))}),window.location.reload();return}this.setState({error:t,errorInfo:r}),this.props.onError?.(t,r)}render(){if(this.state.hasError){if(this.props.fallback){const t=this.props.fallback;return n.jsx(t,{error:this.state.error,resetError:this.resetError})}return n.jsx(Jb,{error:this.state.error,resetError:this.resetError})}return this.props.children}}const Jb=({error:s,resetError:e})=>{const t=()=>{e(),window.location.href="/"},r=()=>{e(),window.location.reload()};return n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:n.jsxs(pe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(We,{className:"w-8 h-8 text-red-600"})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),n.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"We encountered an unexpected error. This has been logged and our team will investigate."})]}),s&&n.jsxs("details",{className:"mb-6 p-4 bg-gray-100 rounded-lg text-left",children:[n.jsx("summary",{className:"font-semibold text-sm text-gray-800 mb-2 cursor-pointer",children:"Error Details (click to expand)"}),n.jsxs("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap mt-2",children:[s.message,s.stack&&`

Stack:
${s.stack}`]})]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs(pe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:r,className:"flex items-center justify-center gap-2 w-full bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-green-700 transition-colors",children:[n.jsx(wt,{className:"w-4 h-4"}),"Try Again"]}),n.jsxs(pe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:t,className:"flex items-center justify-center gap-2 w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-xl font-semibold hover:bg-gray-200 transition-colors",children:[n.jsx(xd,{className:"w-4 h-4"}),"Go to Home"]})]})]})})},Cl=Zb,Tl=new Map,Yb=1e4,Al=3,Qb=["user_action","validation_error","success","info"],Xb=(s,e="info",t={})=>{const{category:r="user_action",duration:a=4e3,throttle:i=!0,dedupe:o=!0}=t;if(!Qb.includes(r))return;const l=`${r}:${s}`;if(i){const c=Date.now(),d=Tl.get(l);if(d)if(c-d.lastShown<Yb){if(d.count++,d.count>Al)return;Bd("Toast throttled:",s,`(${d.count}/${Al})`);return}else d.count=1,d.lastShown=c;else Tl.set(l,{lastShown:c,count:1})}if(o){const c=document.querySelectorAll('[data-testid="toast"]');for(const d of c){const u=d.textContent;if(u&&u.includes(s))return}}switch(e){case"success":B.success(s,{duration:a,style:{background:"#10B981",color:"#fff"},iconTheme:{primary:"#fff",secondary:"#10B981"}});break;case"error":B.error(s,{duration:a,style:{background:"#EF4444",color:"#fff"},iconTheme:{primary:"#fff",secondary:"#EF4444"}});break;case"loading":B.loading(s,{duration:a,style:{background:"#3B82F6",color:"#fff"}});break;case"info":default:B(s,{duration:a,style:{background:"#6B7280",color:"#fff"},iconTheme:{primary:"#fff",secondary:"#6B7280"}});break}},ev=(s,e)=>{Xb(s,"error",{...e,category:"user_action"})};class Ts extends Error{constructor(t,r={}){super(t);te(this,"code");te(this,"status");te(this,"context");te(this,"userAction");te(this,"timestamp");this.name="AppError",this.code=r.code,this.status=r.status,this.context=r.context,this.userAction=r.userAction,this.timestamp=Date.now()}toErrorInfo(){return{message:this.message,code:this.code,status:this.status,timestamp:this.timestamp,context:this.context,userAction:this.userAction}}}const tv=s=>s instanceof Ts?{type:s.code==="AUTH_REQUIRED"?"auth":s.code==="VALIDATION_ERROR"?"validation":s.status&&s.status>=500?"server":s.status&&s.status>=400?"validation":"unknown",message:s.message,userFriendly:!0,shouldShowToast:s.userAction||!1}:s instanceof Error?s.message.includes("fetch")||s.message.includes("network")||s.message.includes("Failed to fetch")?{type:"network",message:"Connection problem. Please check your internet and try again.",userFriendly:!0,shouldShowToast:!1}:{type:"unknown",message:s.message,userFriendly:!1,shouldShowToast:!1}:{type:"unknown",message:"Something went wrong. Please try again.",userFriendly:!0,shouldShowToast:!1},sv=m.createContext(void 0),Pl=({children:s,maxErrors:e=10,showToasts:t=!0})=>{const[r,a]=m.useState([]),i=(c,d)=>{const u=c instanceof Ts?c:new Ts(c.message,{context:d}),h=tv(u);a(f=>[u,...f].slice(0,e)),Bd("[ErrorHandlingProvider] Error reported:",u.toErrorInfo()),t&&h.shouldShowToast&&ev(h.message)},o=()=>{a([])};m.useEffect(()=>{const c=u=>{const h=new Ts(u.message,{context:"unhandled_error",code:"UNHANDLED_ERROR"});i(h)},d=u=>{const h=new Ts(u.reason instanceof Error?u.reason.message:"Unhandled promise rejection",{context:"unhandled_rejection",code:"UNHANDLED_REJECTION"});i(h)};return window.addEventListener("error",c),window.addEventListener("unhandledrejection",d),()=>{window.removeEventListener("error",c),window.removeEventListener("unhandledrejection",d)}},[i]);const l={reportError:i,clearErrors:o,errors:r};return n.jsx(sv.Provider,{value:l,children:s})};gn.type="coinbaseWallet";function gn(s={}){return s.version==="3"||s.headlessMode?nv(s):rv(s)}function rv(s){let e,t,r,a;return si(i=>({id:"coinbaseWalletSDK",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",type:gn.type,async connect({chainId:o,withCapabilities:l,...c}={}){try{const d=await this.getProvider(),u=(await d.request({method:"eth_requestAccounts",params:"instantOnboarding"in c&&c.instantOnboarding?[{onboarding:"instant"}]:[]})).map(f=>tt(f));t||(t=this.onAccountsChanged.bind(this),d.on("accountsChanged",t)),r||(r=this.onChainChanged.bind(this),d.on("chainChanged",r)),a||(a=this.onDisconnect.bind(this),d.on("disconnect",a));let h=await this.getChainId();return o&&h!==o&&(h=(await this.switchChain({chainId:o}).catch(p=>{if(p.code===Ve.code)throw p;return{id:h}}))?.id??h),{accounts:l?u.map(f=>({address:f,capabilities:{}})):u,chainId:h}}catch(d){throw/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(d.message)?new Ve(d):d}},async disconnect(){const o=await this.getProvider();t&&(o.removeListener("accountsChanged",t),t=void 0),r&&(o.removeListener("chainChanged",r),r=void 0),a&&(o.removeListener("disconnect",a),a=void 0),o.disconnect(),o.close?.()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(l=>tt(l))},async getChainId(){const l=await(await this.getProvider()).request({method:"eth_chainId"});return Number(l)},async getProvider(){if(!e){const o=(()=>typeof s.preference=="string"?{options:s.preference}:{...s.preference,options:s.preference?.options??"all"})(),{createCoinbaseWalletSDK:l}=await H(()=>import("./index-df748c0b.js"),["assets/index-df748c0b.js","assets/wagmi-c444efa6.js","assets/vendor-c36eaa8e.js","assets/utils-617af415.js","assets/ui-c369d1f3.js","assets/_shortw_utils-2428d36e.js"]);e=l({...s,appChainIds:i.chains.map(d=>d.id),preference:o}).getProvider()}return e},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:o,chainId:l}){const c=i.chains.find(u=>u.id===l);if(!c)throw new Os(new ri);const d=await this.getProvider();try{return await d.request({method:"wallet_switchEthereumChain",params:[{chainId:Xt(c.id)}]}),c}catch(u){if(u.code===4902)try{let h;o?.blockExplorerUrls?h=o.blockExplorerUrls:h=c.blockExplorers?.default.url?[c.blockExplorers?.default.url]:[];let f;o?.rpcUrls?.length?f=o.rpcUrls:f=[c.rpcUrls.default?.http[0]??""];const p={blockExplorerUrls:h,chainId:Xt(l),chainName:o?.chainName??c.name,iconUrls:o?.iconUrls,nativeCurrency:o?.nativeCurrency??c.nativeCurrency,rpcUrls:f};return await d.request({method:"wallet_addEthereumChain",params:[p]}),c}catch(h){throw new Ve(h)}throw new Os(u)}},onAccountsChanged(o){o.length===0?this.onDisconnect():i.emitter.emit("change",{accounts:o.map(l=>tt(l))})},onChainChanged(o){const l=Number(o);i.emitter.emit("change",{chainId:l})},async onDisconnect(o){i.emitter.emit("disconnect");const l=await this.getProvider();t&&(l.removeListener("accountsChanged",t),t=void 0),r&&(l.removeListener("chainChanged",r),r=void 0),a&&(l.removeListener("disconnect",a),a=void 0)}}))}function nv(s){let t,r,a,i,o;return si(l=>({id:"coinbaseWalletSDK",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",type:gn.type,async connect({chainId:c,withCapabilities:d}={}){try{const u=await this.getProvider(),h=(await u.request({method:"eth_requestAccounts"})).map(p=>tt(p));a||(a=this.onAccountsChanged.bind(this),u.on("accountsChanged",a)),i||(i=this.onChainChanged.bind(this),u.on("chainChanged",i)),o||(o=this.onDisconnect.bind(this),u.on("disconnect",o));let f=await this.getChainId();return c&&f!==c&&(f=(await this.switchChain({chainId:c}).catch(w=>{if(w.code===Ve.code)throw w;return{id:f}}))?.id??f),{accounts:d?h.map(p=>({address:p,capabilities:{}})):h,chainId:f}}catch(u){throw/(user closed modal|accounts received is empty|user denied account)/i.test(u.message)?new Ve(u):u}},async disconnect(){const c=await this.getProvider();a&&(c.removeListener("accountsChanged",a),a=void 0),i&&(c.removeListener("chainChanged",i),i=void 0),o&&(c.removeListener("disconnect",o),o=void 0),c.disconnect(),c.close()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(d=>tt(d))},async getChainId(){const d=await(await this.getProvider()).request({method:"eth_chainId"});return Number(d)},async getProvider(){if(!r){const c=await(async()=>{const{default:p}=await H(()=>import("./index-97fc6785.js").then(w=>w.i),["assets/index-97fc6785.js","assets/vendor-c36eaa8e.js","assets/wagmi-c444efa6.js","assets/utils-617af415.js","assets/ui-c369d1f3.js","assets/events-91c3d7fe.js"]);return typeof p!="function"&&typeof p.default=="function"?p.default:p})();t=new c({...s,reloadOnDisconnect:!1});const d=t.walletExtension?.getChainId(),u=l.chains.find(p=>s.chainId?p.id===s.chainId:p.id===d)||l.chains[0],h=s.chainId||u?.id,f=s.jsonRpcUrl||u?.rpcUrls.default.http[0];r=t.makeWeb3Provider(f,h)}return r},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:c,chainId:d}){const u=l.chains.find(f=>f.id===d);if(!u)throw new Os(new ri);const h=await this.getProvider();try{return await h.request({method:"wallet_switchEthereumChain",params:[{chainId:Xt(u.id)}]}),u}catch(f){if(f.code===4902)try{let p;c?.blockExplorerUrls?p=c.blockExplorerUrls:p=u.blockExplorers?.default.url?[u.blockExplorers?.default.url]:[];let w;c?.rpcUrls?.length?w=c.rpcUrls:w=[u.rpcUrls.default?.http[0]??""];const g={blockExplorerUrls:p,chainId:Xt(d),chainName:c?.chainName??u.name,iconUrls:c?.iconUrls,nativeCurrency:c?.nativeCurrency??u.nativeCurrency,rpcUrls:w};return await h.request({method:"wallet_addEthereumChain",params:[g]}),u}catch(p){throw new Ve(p)}throw new Os(f)}},onAccountsChanged(c){c.length===0?this.onDisconnect():l.emitter.emit("change",{accounts:c.map(d=>tt(d))})},onChainChanged(c){const d=Number(c);l.emitter.emit("change",{chainId:d})},async onDisconnect(c){l.emitter.emit("disconnect");const d=await this.getProvider();a&&(d.removeListener("accountsChanged",a),a=void 0),i&&(d.removeListener("chainChanged",i),i=void 0),o&&(d.removeListener("disconnect",o),o=void 0)}}))}Bi.type="walletConnect";function Bi(s){const e=s.isNewChainsStale??!0;let t,r;const a="eip155";let i,o,l,c,d,u;return si(h=>({id:"walletConnect",name:"WalletConnect",type:Bi.type,async setup(){const f=await this.getProvider().catch(()=>null);f&&(l||(l=this.onConnect.bind(this),f.on("connect",l)),d||(d=this.onSessionDelete.bind(this),f.on("session_delete",d)))},async connect({chainId:f,withCapabilities:p,...w}={}){try{const g=await this.getProvider();if(!g)throw new Vi;c||(c=this.onDisplayUri,g.on("display_uri",c));let y=f;if(!y){const _=await h.storage?.getItem("state")??{};h.chains.some(S=>S.id===_.chainId)?y=_.chainId:y=h.chains[0]?.id}if(!y)throw new Error("No chains found on connector.");const b=await this.isChainsStale();if(g.session&&b&&await g.disconnect(),!g.session||b){const _=h.chains.filter(j=>j.id!==y).map(j=>j.id);await g.connect({optionalChains:[y,..._],..."pairingTopic"in w?{pairingTopic:w.pairingTopic}:{}}),this.setRequestedChainsIds(h.chains.map(j=>j.id))}const v=(await g.enable()).map(_=>tt(_));let x=await this.getChainId();return f&&x!==f&&(x=(await this.switchChain({chainId:f}).catch(j=>{if(j.code===Ve.code&&j.cause?.message!=="Missing or invalid. request() method: wallet_addEthereumChain")throw j;return{id:x}}))?.id??x),c&&(g.removeListener("display_uri",c),c=void 0),l&&(g.removeListener("connect",l),l=void 0),i||(i=this.onAccountsChanged.bind(this),g.on("accountsChanged",i)),o||(o=this.onChainChanged.bind(this),g.on("chainChanged",o)),u||(u=this.onDisconnect.bind(this),g.on("disconnect",u)),d||(d=this.onSessionDelete.bind(this),g.on("session_delete",d)),{accounts:p?v.map(_=>({address:_,capabilities:{}})):v,chainId:x}}catch(g){throw/(user rejected|connection request reset)/i.test(g?.message)?new Ve(g):g}},async disconnect(){const f=await this.getProvider();try{await f?.disconnect()}catch(p){if(!/No matching key/i.test(p.message))throw p}finally{o&&(f?.removeListener("chainChanged",o),o=void 0),u&&(f?.removeListener("disconnect",u),u=void 0),l||(l=this.onConnect.bind(this),f?.on("connect",l)),i&&(f?.removeListener("accountsChanged",i),i=void 0),d&&(f?.removeListener("session_delete",d),d=void 0),this.setRequestedChainsIds([])}},async getAccounts(){return(await this.getProvider()).accounts.map(p=>tt(p))},async getProvider({chainId:f}={}){async function p(){const w=h.chains.map(y=>y.id);if(!w.length)return;const{EthereumProvider:g}=await H(()=>import("./index.es-449de70f.js").then(y=>y.J),["assets/index.es-449de70f.js","assets/wagmi-c444efa6.js","assets/vendor-c36eaa8e.js","assets/utils-617af415.js","assets/ui-c369d1f3.js","assets/events-91c3d7fe.js"]);return await g.init({...s,disableProviderPing:!0,optionalChains:w,projectId:s.projectId,rpcMap:Object.fromEntries(h.chains.map(y=>{const[b]=au({chain:y,transports:h.transports});return[y.id,b]})),showQrModal:s.showQrModal??!0})}return t||(r||(r=p()),t=await r,t?.events.setMaxListeners(Number.POSITIVE_INFINITY)),f&&await this.switchChain?.({chainId:f}),t},async getChainId(){return(await this.getProvider()).chainId},async isAuthorized(){try{const[f,p]=await Promise.all([this.getAccounts(),this.getProvider()]);return f.length?await this.isChainsStale()&&p.session?(await p.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:f,chainId:p}){const w=await this.getProvider();if(!w)throw new Vi;const g=h.chains.find(y=>y.id===p);if(!g)throw new Os(new ri);try{await Promise.all([new Promise(b=>{const v=({chainId:x})=>{x===p&&(h.emitter.off("change",v),b())};h.emitter.on("change",v)}),w.request({method:"wallet_switchEthereumChain",params:[{chainId:Xt(p)}]})]);const y=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...y,p]),g}catch(y){const b=y;if(/(user rejected)/i.test(b.message))throw new Ve(b);try{let v;f?.blockExplorerUrls?v=f.blockExplorerUrls:v=g.blockExplorers?.default.url?[g.blockExplorers?.default.url]:[];let x;f?.rpcUrls?.length?x=f.rpcUrls:x=[...g.rpcUrls.default.http];const _={blockExplorerUrls:v,chainId:Xt(p),chainName:f?.chainName??g.name,iconUrls:f?.iconUrls,nativeCurrency:f?.nativeCurrency??g.nativeCurrency,rpcUrls:x};await w.request({method:"wallet_addEthereumChain",params:[_]});const j=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...j,p]),g}catch(v){throw new Ve(v)}}},onAccountsChanged(f){f.length===0?this.onDisconnect():h.emitter.emit("change",{accounts:f.map(p=>tt(p))})},onChainChanged(f){const p=Number(f);h.emitter.emit("change",{chainId:p})},async onConnect(f){const p=Number(f.chainId),w=await this.getAccounts();h.emitter.emit("connect",{accounts:w,chainId:p})},async onDisconnect(f){this.setRequestedChainsIds([]),h.emitter.emit("disconnect");const p=await this.getProvider();i&&(p.removeListener("accountsChanged",i),i=void 0),o&&(p.removeListener("chainChanged",o),o=void 0),u&&(p.removeListener("disconnect",u),u=void 0),d&&(p.removeListener("session_delete",d),d=void 0),l||(l=this.onConnect.bind(this),p.on("connect",l))},onDisplayUri(f){h.emitter.emit("message",{type:"display_uri",data:f})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){return t?t.session?.namespaces[a]?.accounts?.map(p=>Number.parseInt(p.split(":")[1]||"",10))??[]:[]},async getRequestedChainsIds(){return await h.storage?.getItem(this.requestedChainsStorageKey)??[]},async isChainsStale(){if(!e)return!1;const f=h.chains.map(g=>g.id),p=this.getNamespaceChainsIds();if(p.length&&!p.some(g=>f.includes(g)))return!1;const w=await this.getRequestedChainsIds();return!f.every(g=>w.includes(g))},async setRequestedChainsIds(f){await h.storage?.setItem(this.requestedChainsStorageKey,f)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}}))}const Il="a376a3c48ca99bd80c5b30a37652a5ae",Fi=[lu({shimDisconnect:!1})];if(Il.length>=8)try{const s=typeof window<"u"?nt?.isNativePlatform?.()?"https://app.fanclubz.app":window.location.origin:"https://app.fanclubz.app";Fi.push(Bi({projectId:Il,showQrModal:!0,qrModalOptions:{themeMode:"light",enableExplorer:!0},metadata:{name:"Fan Club Z",description:"Prediction Platform",url:s,icons:["https://app.fanclubz.app/icons/icon-192.png"]}}))}catch{}if({}.VITE_ENABLE_COINBASE_CONNECTOR==="1"){const s=gn({appName:"Fan Club Z",preference:"smartWalletOnly",headlessMode:!1});Fi.push(s)}const av=["https://sepolia.base.org","https://base-sepolia-rpc.publicnode.com","https://base-sepolia.blockpi.network/v1/rpc/public"],iv=iu({storage:typeof window<"u"?window.localStorage:void 0,key:"wagmi"}),ov=ou({chains:[Fr],connectors:Fi,storage:iv,syncConnectedChain:!0,multiInjectedProviderDiscovery:!0,transports:{[Fr.id]:cu(av[0],{batch:{batchSize:1024,wait:16},timeout:3e4,retryCount:3,retryDelay:500})}});class Br extends Error{constructor(t,r){super(t);te(this,"code");this.name="WalletStateError",this.code=r}}class lv extends Error{constructor(t,r,a){super(t);te(this,"requiredAmount");te(this,"actualAmount");this.name="AllowanceError",this.requiredAmount=r,this.actualAmount=a}}class cv extends Error{constructor(e){super(e),this.name="SessionError"}}class dv extends Error{constructor(t,r){super(t);te(this,"txHash");this.name="TransactionTimeoutError",this.txHash=r}}const uv=["network","timeout","connection","rpc","rate limit","too many requests","econnrefused","socket hang up","fetch failed","ethers-nofallback","failed to fetch","econnreset","etimedout","request failed"],hv=["user rejected","user denied","rejected by user","user cancelled","action_rejected","user closed","request denied","request rejected","user refused","denied transaction","transaction declined","rejected the request"],fv=["no matching key","session topic","session not found","pairing topic","inactive session","expired session","session disconnected","missing session","getdefaultprovider","provider.request","wallet disconnected","walletconnect","topic not found","missing or invalid","proposal expired","wc_session","relay connection","socket hang up","ns sepolia","no provider","provider is undefined","disconnected from","please call connect() before request","client not initialized","pairing not found","session request timeout","peer disconnected","connection closed","request timeout","transport error","signerclient is undefined","provider not found","connector not connected","no signer available","chain mismatch","unsupported chain"];function a_(s){const{address:e,chainId:t,expectedChainId:r,isConnected:a,sessionHealthy:i}=s,o=r??Fr.id;if(!a||!e)throw new Br("Wallet not connected. Please connect your wallet to continue.","WALLET_NOT_CONNECTED");if(t!==o)throw new Br("Wrong network. Please switch your wallet to Base Sepolia.","WRONG_NETWORK");if(i===!1)throw new Br("Wallet session expired. Please reconnect your wallet.","SESSION_UNHEALTHY")}function mv(s){const e=String(s).toLowerCase();return uv.some(t=>e.includes(t))}function pv(s){const e=String(s).toLowerCase();return hv.some(t=>e.includes(t))}function Qa(s){const e=String(s).toLowerCase();return fv.some(t=>e.includes(t))}function i_(s){const e=String(s).toLowerCase(),t=s instanceof Error?s.message:String(s);if(s instanceof Br)return{message:s.message,code:s.code};if(s instanceof lv){const a=Number(s.requiredAmount)/1e6,i=Number(s.actualAmount)/1e6;return{message:`Approval not confirmed yet (need $${a.toFixed(2)}, have $${i.toFixed(2)}). Please wait a moment and try again.`,code:"ALLOWANCE_VERIFICATION_FAILED"}}return s instanceof cv?{message:s.message,code:"SESSION_EXPIRED"}:s instanceof dv?{message:s.txHash?`Transaction timed out. Check status on BaseScan: ${s.txHash.slice(0,10)}...`:"Transaction timed out. Please check your wallet and try again.",code:"TIMEOUT"}:pv(s)?{message:"Transaction cancelled",code:"USER_REJECTED"}:Qa(s)?{message:"Wallet session expired. Please reconnect your wallet.",code:"SESSION_EXPIRED"}:e.includes("insufficient funds")||e.includes("insufficient eth")||e.includes("intrinsic gas too low")?{message:"Not enough ETH for gas fees. Please add ETH to your wallet on Base Sepolia.",code:"INSUFFICIENT_GAS"}:e.includes("allowance")||e.includes("erc20: transfer amount exceeds allowance")||e.includes("transfer amount exceeds allowance")?{message:"Token approval not yet confirmed. Please wait a moment and try again.",code:"INSUFFICIENT_ALLOWANCE"}:e.includes("insufficient balance")||e.includes("exceeds balance")||e.includes("transfer amount exceeds balance")?{message:"Insufficient USDC balance",code:"INSUFFICIENT_BALANCE"}:e.includes("insufficient escrow")||e.includes("not enough funds in escrow")?{message:"Insufficient funds in escrow account",code:"INSUFFICIENT_ESCROW"}:e.includes("gas required exceeds allowance")||e.includes("cannot estimate gas")?{message:"Transaction would fail. Check your balance and inputs.",code:"GAS_ESTIMATION_FAILED"}:mv(s)?{message:"Network error. Please check your connection and try again.",code:"NETWORK_ERROR"}:e.includes("revert")||e.includes("execution reverted")?{message:(t.match(/reason: (.+?)(?:\n|$)/)?.[1]||"Transaction reverted by contract").slice(0,100),code:"CONTRACT_REVERT"}:e.includes("simulation")||e.includes("simulate")?{message:"Transaction simulation failed. Check your inputs.",code:"SIMULATION_FAILED"}:e.includes("replacement")||e.includes("nonce")||e.includes("already known")?{message:"Transaction was replaced or dropped. Please try again.",code:"TX_REPLACED"}:e.includes("timeout")||e.includes("timed out")?{message:"Transaction timed out. Please check your wallet and blockchain explorer.",code:"TIMEOUT"}:{message:t.replace(/0x[a-fA-F0-9]{40,}/g,"[address]").replace(/\n/g," ").slice(0,120)||"Transaction failed",code:"UNKNOWN_ERROR"}}const Rs="fcz:failedTxLogs",Rl=100;async function gv(s,e=3){const r=`${wi()}/api/wallet/log-transaction`;for(let a=1;a<=e;a++){try{const i=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,chainId:s.chainId??Fr.id,timestamp:new Date().toISOString()})});if(i.ok)return!0;const o=await i.text().catch(()=>"Unknown error")}catch{}a<e&&await new Promise(i=>setTimeout(i,1e3*a))}return xv(s),!1}function xv(s){try{const e=JSON.parse(localStorage.getItem(Rs)||"[]"),t=e.find(r=>r.txHash===s.txHash&&r.status===s.status);if(t){t.retryCount++,localStorage.setItem(Rs,JSON.stringify(e));return}e.push({...s,timestamp:new Date().toISOString(),retryCount:0}),e.length>Rl&&e.splice(0,e.length-Rl),localStorage.setItem(Rs,JSON.stringify(e))}catch{}}async function Hd(){let s=0;try{const e=JSON.parse(localStorage.getItem(Rs)||"[]");if(e.length===0)return 0;const t=[];for(const r of e){if(r.retryCount>=5)continue;await gv(r,1)?s++:t.push({...r,retryCount:r.retryCount+1})}localStorage.setItem(Rs,JSON.stringify(t))}catch{}return s}function Xa(){let s=0;try{const e=[];for(let r=0;r<localStorage.length;r++){const a=localStorage.key(r);a&&(a.startsWith("wc@2:")||a.startsWith("wc@1:")||a.startsWith("walletconnect")||a.startsWith("WALLETCONNECT")||a.includes("wc_session")||a.includes("@walletconnect")||a.startsWith("wc_")||a.includes("pairing")||a.includes("relay")||a.includes("topic")&&a.includes("wc")||a.includes("wallet-connect")||a.includes("wagmi")&&a.includes("walletConnect"))&&e.push(a)}e.forEach(r=>{try{localStorage.removeItem(r),s++}catch{}});const t=[];for(let r=0;r<sessionStorage.length;r++){const a=sessionStorage.key(r);a&&(a.startsWith("wc@2:")||a.startsWith("wc@1:")||a.startsWith("walletconnect")||a.includes("@walletconnect")||a.includes("wc_session"))&&t.push(a)}t.forEach(r=>{try{sessionStorage.removeItem(r),s++}catch{}}),s>0}catch{}return s}function yv(){window.dispatchEvent(new CustomEvent("fcz:balance:refresh"))}function o_(s){window.dispatchEvent(new CustomEvent("fcz:wallet:reconnect-required",{detail:{reason:s}}))}let Vn=!1;function wv(){if(Vn)return()=>{};const s=t=>{const r=t.reason;Qa(r)&&(t.preventDefault(),ei()||Xa())},e=t=>{Qa(t.error)&&(t.preventDefault(),ei()||Xa())};return window.addEventListener("unhandledrejection",s),window.addEventListener("error",e),Vn=!0,()=>{window.removeEventListener("unhandledrejection",s),window.removeEventListener("error",e),Vn=!1}}const bv=[["wallet"],["wallet","summary"],["escrow-balance"],["escrow-snapshot"],["unified-balance"],["usdcBalance"],["readContract"],["onchain-activity"],["allowance"]];let Ol=!1;function ei(){if(typeof window>"u")return!1;try{const s=localStorage.getItem("wagmi.store");if(!s)return!1;const e=JSON.parse(s),t=e?.state?.connections,r=e?.state?.current;if(r&&t?.value?.length>0){const a=t.value.find(i=>Array.isArray(i)&&i[0]===r);return a&&a[1]?.accounts?.length>0?!0:t.value.some(i=>Array.isArray(i)&&i[1]?.accounts?.length>0)}}catch{}return!1}function vv(){Ol||(wv(),Hd(),ei()||Xa(),Ol=!0)}function _v(s){if(typeof window>"u")return()=>{};const e=()=>{try{s&&bv.forEach(t=>{s.invalidateQueries({queryKey:t,exact:!1}).catch(r=>{})})}catch{}};return window.addEventListener("fcz:balance:refresh",e),()=>window.removeEventListener("fcz:balance:refresh",e)}async function l_(s,e){await new Promise(t=>setTimeout(t,s))}const ti=[["wallet"],["escrow-balance"],["unified-balance"],["escrow-snapshot"],["readContract"],["onchain-usdc"],["usdcBalance"],["balance"],["allowance"],["escrow"]],jv=[["onchain-activity"],["wallet-activity"],["blockchain-transactions"]],Nv=[["prediction"],["prediction-activity"],["prediction-entries"]],Ev=[["user-entries"],["user-predictions"]],Sv=[["claimable-claims"],["merkle-proof"]];function xn(s,e){const{userId:t,predictionId:r,includeEscrow:a=!0,includeActivity:i=!0}=e||{};ti.forEach(o=>{s.invalidateQueries({queryKey:o,exact:!1})}),i&&t&&(s.invalidateQueries({queryKey:Te.walletActivity(t)}),jv.forEach(o=>{s.invalidateQueries({queryKey:o,exact:!1})})),a&&t&&s.invalidateQueries({queryKey:Te.escrowBalance(t)}),r&&(s.invalidateQueries({queryKey:Te.prediction(r)}),s.invalidateQueries({queryKey:Te.predictionEntries(r)}),Nv.forEach(o=>{s.invalidateQueries({queryKey:[...o,r],exact:!1})})),t&&Ev.forEach(o=>{s.invalidateQueries({queryKey:o,exact:!1})})}function c_(s,e){xn(s,{userId:e?.userId,includeEscrow:!0,includeActivity:!0}),s.invalidateQueries({queryKey:["usdcBalance"]}),s.invalidateQueries({queryKey:["escrow-balance"]}),s.invalidateQueries({queryKey:["unified-balance"]}),s.invalidateQueries({queryKey:["readContract"]})}function d_(s,e){xn(s,{userId:e?.userId,includeEscrow:!0,includeActivity:!0}),s.invalidateQueries({queryKey:["usdcBalance"]}),s.invalidateQueries({queryKey:["escrow-balance"]}),s.invalidateQueries({queryKey:["unified-balance"]}),s.invalidateQueries({queryKey:["readContract"]})}function u_(s,e){xn(s,{userId:e.userId,predictionId:e.predictionId,includeEscrow:!0,includeActivity:!0}),s.invalidateQueries({queryKey:["prediction-stats",e.predictionId]}),yv()}let Sr=null;function h_(s,e){xn(s,{userId:e?.userId,predictionId:e?.predictionId,includeEscrow:!0,includeActivity:!0}),Sv.forEach(t=>{s.invalidateQueries({queryKey:t,exact:!1})}),s.invalidateQueries({queryKey:["usdcBalance"]}),s.invalidateQueries({queryKey:["escrow-balance"]}),s.invalidateQueries({queryKey:["unified-balance"]}),Sr&&clearTimeout(Sr),Sr=setTimeout(()=>{Promise.all([s.refetchQueries({queryKey:["usdcBalance"]}).catch(()=>{}),s.refetchQueries({queryKey:["escrow-balance"]}).catch(()=>{}),s.refetchQueries({queryKey:["unified-balance"]}).catch(()=>{})]).catch(()=>{}),Sr=null},200)}let kr=null;function kv(s){ti.forEach(e=>{s.invalidateQueries({queryKey:e,exact:!1})}),kr&&clearTimeout(kr),kr=setTimeout(()=>{ti.forEach(e=>{s.refetchQueries({queryKey:e,exact:!1}).catch(()=>{})}),kr=null},300)}const Kd=["no matching key","session topic doesn't exist","session not found","pairing topic doesn't exist","missing session","inactive session","session disconnected","expired session","please call connect() before request","client not initialized","pairing not found","session request timeout","peer disconnected","signerclient is undefined","provider not found","connector not connected","no signer available"],Cv=[["wallet"],["readContract"],["balance"],["allowance"],["escrow"],["usdcBalance"],["escrow-balance"],["unified-balance"],["escrow-snapshot"],["onchain-usdc"],["claimable-claims"],["merkle-proof"],["wallet-summary"],["onchain-activity"]];function Ll(){try{const s=localStorage.getItem("wagmi.store");if(!s)return!1;const e=JSON.parse(s),t=e?.state?.connections;if(!e?.state?.current||!t?.value?.length)return!1;for(const a of t.value)if(Array.isArray(a)&&a[1]?.accounts?.length>0)return!0;return!1}catch{return!1}}const Gd=m.createContext(null);function f_(){const s=m.useContext(Gd);if(!s)throw new Error("useWeb3Recovery must be used within Web3Provider");return s}const Tv=new du({defaultOptions:{queries:{staleTime:1e3*30,gcTime:1e3*60*2,refetchOnWindowFocus:!1,retry:(s,e)=>{const t=String(e).toLowerCase();return Kd.some(r=>t.includes(r))?!1:s<2}}}});function Av({children:s}){const{address:e,connector:t,isConnected:r,isConnecting:a,isReconnecting:i,status:o}=hu();fu();const{reconnect:l,isPending:c}=mu(),d=pu(),u=zl(),[h,f]=m.useState(!1),[p,w]=m.useState(0),[g,y]=m.useState(!0),[b,v]=m.useState(null),x=m.useRef(!1),_=m.useRef(!0),j=m.useRef(!1),S=m.useRef(!1),E=m.useRef({isConnected:r,isConnecting:a,isReconnecting:i,status:o,address:e});m.useEffect(()=>{E.current={isConnected:r,isConnecting:a,isReconnecting:i,status:o,address:e}},[r,a,i,o,e]),m.useEffect(()=>(_.current=!0,()=>{_.current=!1}),[]);const T=m.useCallback(()=>{v(null)},[]);m.useEffect(()=>{if(!j.current){j.current=!0;try{vv()}catch{}Hd().catch(()=>{}),Ll()&&!r&&!a&&!i&&!S.current&&(S.current=!0,setTimeout(()=>{try{l()}catch{}},200))}},[r,a,i,l]),m.useEffect(()=>_v(u),[u]);const N=m.useCallback(K=>{if(!K)return!1;const ue=String(K).toLowerCase();return Kd.some($=>ue.includes($))},[]),C=m.useCallback(async()=>{try{const K=d.find(ee=>ee.id==="walletConnect");if(K)try{const ee=await K.getProvider().catch(()=>null);ee&&typeof ee.disconnect=="function"&&await ee.disconnect().catch(()=>{})}catch{}const ue=[];for(let ee=0;ee<localStorage.length;ee++){const Z=localStorage.key(ee);Z&&Z!=="wagmi.store"&&(Z.startsWith("wc@2:")||Z.startsWith("wc@1:")||Z.startsWith("walletconnect")||Z.startsWith("WALLETCONNECT")||Z.includes("wc_session")||Z.includes("@walletconnect")||Z.startsWith("wc_")||Z.includes("pairing")&&Z.includes("wc")||Z.includes("relay")&&Z.includes("wc")||Z.includes("topic")&&Z.includes("wc")||Z.includes("wallet-connect"))&&ue.push(Z)}ue.forEach(ee=>{try{localStorage.removeItem(ee)}catch{}});const $=[];for(let ee=0;ee<sessionStorage.length;ee++){const Z=sessionStorage.key(ee);Z&&(Z.startsWith("wc@2:")||Z.startsWith("wc@1:")||Z.startsWith("walletconnect")||Z.includes("@walletconnect")||Z.includes("wc_session"))&&$.push(Z)}$.forEach(ee=>{try{sessionStorage.removeItem(ee)}catch{}})}catch{}},[d]),O=m.useCallback(async()=>{const K=Date.now();if(K-p<3e3||x.current)return!1;const ue=Ll();if(ue&&(a||i))return!1;x.current=!0,f(!0),w(K);try{return!ue&&!r&&!a&&!i&&await C(),await new Promise($=>setTimeout($,300)),Cv.forEach($=>{u.removeQueries({queryKey:$,exact:!1})}),window.dispatchEvent(new CustomEvent("fcz:wallet:reconnect-required",{detail:{reason:"Wallet session expired"}})),y(!1),!0}catch{return y(!1),!1}finally{x.current=!1,_.current&&f(!1)}},[C,r,a,i,p,u]),F=m.useCallback((K,ue)=>(async()=>{const ee=ue?.maxRetries??1,Z=ue?.retryDelay??1e3,yn=ue?.operationTimeoutMs??6e4;let Mi=null;for(let wn=0;wn<=ee;wn++)try{const jt=K(),bn=new Promise((Jd,vn)=>{setTimeout(()=>{vn(new Error("Wallet operation timed out. Please try again."))},yn)});return await Promise.race([jt,bn])}catch(jt){Mi=jt;const bn=jt instanceof Error&&jt.message.toLowerCase().includes("timed out");if((N(jt)||bn)&&await O()&&wn<ee){await new Promise(vn=>setTimeout(vn,Z));continue}throw jt}throw Mi})(),[N,O]);m.useEffect(()=>{const K=()=>{kv(u)};return window.addEventListener("fcz:balance:refresh",K),()=>{window.removeEventListener("fcz:balance:refresh",K)}},[u]),m.useEffect(()=>{r&&e&&(y(!0),v(null),S.current=!1)},[r,e]);const re={isRecovering:h,lastRecoveryTime:p,sessionHealthy:g,lastError:b,triggerRecovery:O,cleanupSessions:C,wrapWithRecovery:F,clearLastError:T};return n.jsx(Gd.Provider,{value:re,children:s})}function Pv({children:s}){return n.jsx(uu,{config:ov,children:n.jsx(wu,{client:Tv,children:n.jsx(Av,{children:s})})})}const Iv={FCP:{good:1800,poor:3e3},LCP:{good:2500,poor:4e3},CLS:{good:.1,poor:.25},INP:{good:200,poor:500},TTFB:{good:800,poor:1800}};function Rv(s,e){const t=Iv[s];return e<=t.good?"good":e<=t.poor?"needs-improvement":"poor"}function Ov(){const s=parseFloat("0.05");return Math.random()<s}function Lv(s){if(typeof window<"u"&&window.Sentry){const e=window.Sentry;e.addBreadcrumb({category:"web-vital",message:`${s.name}: ${s.value.toFixed(2)}`,level:s.rating==="poor"?"warning":"info",data:{rating:s.rating,value:s.value,delta:s.delta,navigationType:s.navigationType}}),s.rating==="poor"&&e.setMeasurement(s.name,s.value,s.name==="CLS"?"":"millisecond")}}function Ns(s){const e=s.name,t=Rv(e,s.value),r={name:e,value:s.value,rating:t,delta:s.delta,id:s.id,navigationType:s.navigationType||"unknown"};Ov()&&Lv(r)}async function Dv(){if(!(typeof window>"u"))try{const{onFCP:s,onLCP:e,onCLS:t,onINP:r,onTTFB:a}=await H(()=>import("./web-vitals-867e2ef8.js"),[]);s(Ns),e(Ns),t(Ns),r(Ns),a(Ns)}catch{}}"scrollRestoration"in history&&(history.scrollRestoration="manual");if(typeof window<"u"&&typeof window.fetch=="function"){const s=window.fetch.bind(window);window.fetch=async(...e)=>{const t=await s(...e);try{if(t.ok&&Ur.getState().active&&Ur.getState().clear(),t.status===503&&(t.headers.get("content-type")||"").includes("application/json")){const i=await t.clone().json().catch(()=>null);i?.maintenance&&Ur.getState().setMaintenance(String(i?.message||"The platform is currently under maintenance. Please check back soon."))}}catch{}return t}}const Zd={}.VITE_BUILD_TARGET==="landing",Dl=Zd?Gb:bb;window.addEventListener("error",s=>{(s.message?.includes("Failed to fetch dynamically imported module")||s.message?.includes("Failed to load module script")||s.message?.includes("Loading chunk")||s.filename?.includes("assets/")&&s.message?.includes("MIME type"))&&(s.preventDefault(),"caches"in window&&caches.keys().then(t=>t.forEach(r=>caches.delete(r))),window.location.reload())});window.addEventListener("unhandledrejection",s=>{const e=s.reason?.message||String(s.reason);(e.includes("Failed to fetch dynamically imported module")||e.includes("Failed to load module script")||e.includes("Loading chunk"))&&(s.preventDefault(),"caches"in window&&caches.keys().then(r=>r.forEach(a=>caches.delete(a))),window.location.reload())});const $v=Zd?n.jsx(Ie.StrictMode,{children:n.jsx(Cl,{onError:(s,e)=>{},children:n.jsx(Pl,{children:n.jsx(Pa,{children:n.jsx(ga,{children:n.jsx(xa,{children:n.jsx(Ji,{children:n.jsx(Dl,{})})})})})})})}):n.jsx(Ie.StrictMode,{children:n.jsx(Pv,{children:n.jsx(Cl,{onError:(s,e)=>{},children:n.jsx(Pl,{children:n.jsx(Pa,{children:n.jsx(ga,{children:n.jsx(xa,{children:n.jsx(Ji,{children:n.jsx(Dl,{})})})})})})})})});qn.createRoot(document.getElementById("root")).render($v);Dv();export{ex as $,We as A,tx as B,Ii as C,er as D,Ws as E,wd as F,gd as G,Ze as H,ae as I,Be as J,It as K,zr as L,dt as M,V as N,t_ as O,tr as P,Te as Q,ps as R,He as S,is as T,Bt as U,fy as V,Br as W,vt as X,gs as Y,bx as Z,je as _,J as a,Qy as a0,wt as a1,Ca as a2,Rw as a3,P as a4,Yv as a5,Bd as a6,ve as a7,Dr as a8,ds as a9,Xv as aA,zv as aB,$a as aC,Ur as aD,gi as aE,us as aF,Jv as aG,Ea as aa,n_ as ab,et as ac,pd as ad,en as ae,Hs as af,bd as ag,Xr as ah,as as ai,ux as aj,dl as ak,pv as al,h_ as am,Lw as an,Ow as ao,nt as ap,l_ as aq,d_ as ar,Zv as as,c_ as at,Fd as au,tn as av,r_ as aw,sx as ax,Rg as ay,Qv as az,J0 as b,f_ as c,G0 as d,ne as e,a_ as f,Db as g,Fe as h,u_ as i,le as j,Y as k,wi as l,gv as m,ge as n,Ei as o,i_ as p,yv as q,Qa as r,Xa as s,o_ as t,Ne as u,vi as v,rx as w,Aa as x,Ge as y,B as z};
