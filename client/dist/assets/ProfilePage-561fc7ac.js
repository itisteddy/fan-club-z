import{j as e}from"./ui-78f6af00.js";import{r as h}from"./vendor-2237fdcd.js";import{c as P,s as A,z as g,u as E,U as u,o as U}from"./index-c088a804.js";import{u as z}from"./predictionStore-9decf1a2.js";import{U as O}from"./UserAvatar-1f0b26ea.js";import{A as f}from"./AppHeader-d22f1ef9.js";import{b as C}from"./format-42e48058.js";import{A as D}from"./activity-426a18e7.js";import{D as I}from"./dollar-sign-16a9c6de.js";import{P as W}from"./pen-line-52f62a74.js";import"./utils-228faac7.js";import"./index-50eb3521.js";import"./utils-a3c9b01a.js";function _(){try{typeof window<"u"&&(sessionStorage.removeItem("sb-ihtnsyhknvltgrksffun-auth-token"),localStorage.removeItem("sb-ihtnsyhknvltgrksffun-auth-token"),Object.keys(localStorage).forEach(t=>{(t.startsWith("fcz-")||t.startsWith("fanclubz-"))&&localStorage.removeItem(t)}),Object.keys(sessionStorage).forEach(t=>{(t.startsWith("fcz-")||t.startsWith("fanclubz-"))&&sessionStorage.removeItem(t)}))}catch(t){console.warn("Failed to reset some stores:",t)}}function F(t){const c=P(),r=async()=>{try{await A.auth.signOut(),_?.(),g.success("Signed out"),c("/")}catch(l){console.error(l),g.error("Failed to sign out. Please try again.")}};return e.jsx("button",{type:"button",onClick:r,"data-qa":"signout",className:"w-full rounded-xl border border-black/10 bg-white px-4 py-3 text-sm font-medium hover:bg-white/80 active:scale-[0.99]",...t,children:"Sign Out"})}const V=({onNavigateBack:t,userId:c})=>{const{user:r,isAuthenticated:l}=E(),{getUserPredictionEntries:p,getUserCreatedPredictions:b}=z(),[j,v]=h.useState(!l),d=!c||c===r?.id,a=r;h.useEffect(()=>{l&&r?.id&&v(!1)},[l,r?.id]);const n=p(r?.id||"")||[],N=b(r?.id||"")||[],o=n.filter(s=>s?.status==="won"||s?.status==="lost"),x=n.filter(s=>s?.status==="won"),y=n.reduce((s,i)=>s+(i?.amount||0),0),w=x.reduce((s,i)=>s+(i?.actual_payout||0),0),S=o.length>0?Math.round(x.length/o.length*100):0,k=w-y,m=[...n,...N].sort((s,i)=>new Date(i.created_at||0).getTime()-new Date(s.created_at||0).getTime()).slice(0,5);return l?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(f,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsx("div",{className:"space-y-4",children:j?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-2/3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(D,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Predictions"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:n.length})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Win Rate"})]}),e.jsxs("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:[S,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(I,{className:"w-4 h-4 text-gray-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Balance"})]}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 font-mono",children:C(k)})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Overview"}),d&&e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(O,{email:a?.email,username:a?.firstName||a?.email?.split("@")[0],avatarUrl:a?.avatar,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a?.firstName&&a?.lastName?`${a.firstName} ${a.lastName}`:a?.email?.split("@")[0]||"User"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["@",a?.email?.split("@")[0]||"user"]}),e.jsxs("div",{className:"flex space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[o.length," completed"]}),e.jsxs("span",{children:[n.filter(s=>s.status==="active").length," active"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Recent Activity"}),m.length>0?e.jsx("div",{className:"space-y-3",children:m.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"question"in s?s.question:"Prediction Entry"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at||0).toLocaleDateString()})]}),e.jsx("div",{className:"text-right",children:"status"in s&&e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.status==="won"?"bg-green-100 text-green-800":s.status==="lost"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})})]},i))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No recent activity"}),e.jsx("p",{className:"text-sm",children:"Your prediction activity will appear here."})]})]}),d&&e.jsx("div",{className:"mt-4",children:e.jsx(F,{})})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(f,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-12 px-4",children:[e.jsx("div",{className:"mb-4 text-gray-300",children:e.jsx(u,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view your profile"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6 max-w-sm",children:"Customize your handle, avatar, and preferences."}),e.jsx("button",{onClick:async()=>{try{await U({intent:"edit_profile"})}catch(s){console.error("Auth gate error:",s)}},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"})]})})]})};export{V as default};
