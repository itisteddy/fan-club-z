import{r as R}from"./vendor-c36eaa8e.js";import{m as _,j as l,x as f,g as D}from"./wagmi-c444efa6.js";function I(){const t="0x30c60f688A0082D1b761610ec3c70f6dC1374E95",s={}.VITE_ESCROW_ADDRESS_BASE_SEPOLIA;if(s&&t.trim().toLowerCase()!==s.trim().toLowerCase())throw new Error(`[FCZ-PAY] Escrow address mismatch. VITE_BASE_ESCROW_ADDRESS (${t}) !== VITE_ESCROW_ADDRESS_BASE_SEPOLIA (${s}). Fix env to a single canonical escrow.`);return D(t)}const m=I(),A=[{type:"function",name:"balances",stateMutability:"view",inputs:[{name:"user",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"reserved",stateMutability:"view",inputs:[{name:"user",type:"address"}],outputs:[{type:"uint256"}]}];function T(){const{address:t,isConnected:s,chainId:r}=_(),n=typeof window<"u"?O():void 0,e=t??n,a=!!e&&(r===l.id||r===void 0),{data:o,isLoading:v,error:E,refetch:y}=f({address:m,abi:A,functionName:"balances",args:e?[e]:void 0,query:{enabled:a,refetchOnMount:!0,refetchInterval:1e4,staleTime:5e3,gcTime:3e4,retry:3,refetchOnWindowFocus:!0}}),{data:c,isLoading:S,error:g,refetch:h}=f({address:m,abi:A,functionName:"reserved",args:e?[e]:void 0,query:{enabled:a,refetchOnMount:!0,refetchInterval:1e4,staleTime:5e3,gcTime:3e4,retry:3,refetchOnWindowFocus:!0}}),i=o?Number(o)/1e6:0,d=c?Number(c)/1e6:0,p=i+d,b=v||S,w=E||g,u=async()=>{await Promise.all([y(),h()])};return R.useEffect(()=>{if(a&&e){const C=setTimeout(()=>{u()},500);return()=>clearTimeout(C)}},[a,e]),{availableBalance:o||BigInt(0),reservedBalance:c||BigInt(0),availableUSD:i,reservedUSD:d,totalUSD:p,isLoading:b,error:w,refetch:u,isConnected:s,chainId:r,isCorrectChain:r===l.id}}function O(){try{const t=localStorage.getItem("wagmi.store");if(!t)return;const s=JSON.parse(t),r=s?.state?.connections?.value,n=s?.state?.current;if(n&&Array.isArray(r)){const e=r.find(a=>Array.isArray(a)&&a[0]===n&&a[1]?.accounts?.length);if(e)return e[1].accounts[0]}if(Array.isArray(r)){for(const e of r)if(Array.isArray(e)&&e[1]?.accounts?.length)return e[1].accounts[0]}}catch{}}export{T as u};
