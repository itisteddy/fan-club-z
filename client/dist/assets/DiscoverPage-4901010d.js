import{L as K,u as Y,a as Q,X as W,Z as X,z as S,b as G,S as J,c as q,_ as ee,n as F,d as te,T as se}from"./index-6a684df2.js";import{j as e,A as I,m as k}from"./ui-78f6af00.js";import{r as n,R as O}from"./vendor-2237fdcd.js";import{u as z}from"./predictionStore-79f46cf9.js";import{u as ae}from"./useMedia-d4e07280.js";import{I as re,B as U}from"./input-7853984f.js";import{c as D}from"./utils-b41b1069.js";import{c as le}from"./utils-228faac7.js";import{A as ne}from"./AppHeader-ac3be6d8.js";import{f as oe,a as A}from"./format-42e48058.js";import"./index-8ab6d350.js";function ie(t,s){if(s?.currency)try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s.currency,maximumFractionDigits:1,notation:"compact"}).format(t)}catch{}return new Intl.NumberFormat(void 0,{maximumFractionDigits:1,notation:"compact"}).format(t)}function ce(t){const s=Math.max(0,Math.floor(t)),a=365*24*3600,r=7*24*3600,o=24*3600,i=3600,d=60;return s>=a?`${Math.round(s/a)}y`:s>=r?`${Math.round(s/r)}w`:s>=o?`${Math.round(s/o)}d`:s>=i?`${Math.round(s/i)}h`:s>=d?`${Math.round(s/d)}m`:`${s}s`}function de({prediction:t}){const{media:s}=ae(t.id,{id:t.id,title:t.title,description:t.description??"",category:t.category}),a=t.endsAt?ce(Math.max(0,(new Date(t.endsAt).getTime()-Date.now())/1e3)):null;return e.jsx(K,{to:`/prediction/${t.id}`,className:"block rounded-2xl border border-black/5 bg-white hover:shadow-sm focus-visible:ring-2 focus-visible:ring-indigo-500 transition",children:e.jsxs("div",{className:"flex items-stretch gap-3 p-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.category&&e.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-0.5",children:t.category}),a&&e.jsxs("span",{className:"rounded-full bg-gray-100 px-2 py-0.5",children:["ends in ",a]})]}),e.jsx("h3",{className:"mt-1 line-clamp-2 text-[15px] font-semibold text-gray-900",children:t.title}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-gray-500",children:[typeof t.pool=="number"&&e.jsxs("span",{children:[ie(t.pool,{currency:"USD"})," pool"]}),typeof t.players=="number"&&e.jsxs("span",{children:[t.players," players"]}),t.options?.length?e.jsx("div",{className:"flex items-center gap-1",children:t.options.slice(0,2).map(r=>e.jsxs("span",{className:"rounded-md border border-gray-200 px-1.5 py-0.5 text-[11px] font-medium text-gray-700",children:[r.label,r.odds?e.jsxs("span",{className:"ml-1 text-gray-500",children:[r.odds.toFixed(2),"x"]}):null]},r.label))}):null]})]}),e.jsx("div",{className:"h-[72px] w-[96px] shrink-0 overflow-hidden rounded-xl bg-gray-100",children:e.jsx("img",{src:s.url,alt:s.alt||t.title,className:"h-full w-full object-cover",loading:"lazy"})})]})})}function me(){return e.jsx("div",{className:"rounded-2xl border border-black/5 bg-white p-3",children:e.jsxs("div",{className:"flex items-stretch gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded-full animate-pulse"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded animate-pulse mb-1"}),e.jsx("div",{className:"h-4 w-3/4 bg-gray-200 rounded animate-pulse mb-2"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-3 w-16 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-12 bg-gray-200 rounded animate-pulse"})]})]}),e.jsx("div",{className:"h-[72px] w-[96px] bg-gray-200 rounded-xl animate-pulse"})]})})}const L=n.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:D("rounded-xl border bg-card text-card-foreground shadow-sm",t),...s}));L.displayName="Card";const ue=n.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:D("flex flex-col space-y-1.5 p-6",t),...s}));ue.displayName="CardHeader";const xe=n.forwardRef(({className:t,...s},a)=>e.jsx("h3",{ref:a,className:D("font-semibold leading-none tracking-tight",t),...s}));xe.displayName="CardTitle";const ge=n.forwardRef(({className:t,...s},a)=>e.jsx("p",{ref:a,className:D("text-sm text-muted-foreground",t),...s}));ge.displayName="CardDescription";const R=n.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:D("p-6 pt-0",t),...s}));R.displayName="CardContent";const he=n.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:D("flex items-center p-6 pt-0",t),...s}));he.displayName="CardFooter";const w=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),pe=(t,s)=>t*s,H=(...t)=>t.filter(Boolean).join(" "),fe=t=>{const s=t.entry_deadline||t.entryDeadline;if(!s)return"Time remaining unknown";const a=Math.max(0,new Date(s).getTime()-Date.now()),r=Math.floor(a/(1e3*60*60));return a<=0?"Ended":r>=24?`${Math.floor(r/24)}d left`:`${r}h left`},ye=({prediction:t,isOpen:s,onClose:a})=>{if(!t||!s)return null;const[r,o]=n.useState(""),[i,d]=n.useState(""),[g,C]=n.useState(!1),{user:h}=Y(),{getBalance:m,lockFunds:p}=Q(),{placePrediction:f}=z(),y=m("USD")||0,c=parseFloat(i)||0,u=t?.options?.find(x=>x.id===r),N=u?.current_odds||(u?.total_staked?t?.pool_total/u.total_staked:2),b=u?pe(c,N):0,M=[5,10,25,50,100,250],T=async()=>{if(!r){S.error("Please select a prediction option (Yes or No)");return}if(!c){S.error("Please enter an amount to stake");return}if(c<t.stake_min){S.error(`Minimum stake is ${w(t.stake_min)}. Please increase your amount.`);return}if(t.stake_max&&c>t.stake_max){S.error(`Maximum stake is ${w(t.stake_max)}. Please reduce your amount.`);return}if(c>y){S.error(`Insufficient balance. You have ${w(y)} available, but tried to stake ${w(c)}.`);return}if(!h?.id){S.error("You must be logged in to place predictions");return}C(!0);try{await p(c,"USD"),await f(t.id,r,c,h.id),S.success(`Prediction placed successfully! You staked ${w(c)} on ${u?.label}.`),a(),d(""),o("")}catch(x){const v=x?.message||"Unknown error occurred";S.error(`Failed to place prediction: ${v}. Please try again.`)}finally{C(!1)}};return e.jsx(I,{mode:"wait",initial:!1,children:s&&e.jsxs(e.Fragment,{children:[e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:a,style:{zIndex:8e3}},"prediction-modal-backdrop"),e.jsx("div",{className:"fixed inset-0 flex items-end justify-center p-4 pb-20",style:{zIndex:8500,pointerEvents:"none"},children:e.jsxs(k.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"w-full max-w-md bg-white rounded-t-2xl shadow-2xl flex flex-col max-h-[75vh]",style:{pointerEvents:"auto"},onClick:x=>x.stopPropagation(),children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Place Prediction"}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close modal",children:e.jsx(W,{size:20})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base",children:t.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[w(t.pool_total||0)," Pool"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[t.participant_count||0," Players"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:fe(t)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Select your prediction:"}),e.jsx("div",{className:"space-y-2",children:(t.options||[]).map(x=>{const v=x.total_staked||0,$=t.pool_total||1,E=$>0?Math.min(v/$*100,100):50,_=x.current_odds||(v>0?$/v:2);return e.jsx(L,{className:H("cursor-pointer transition-all border-2",r===x.id?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"),onClick:()=>o(x.id),children:e.jsx(R,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:x.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[E.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-teal-600",children:[_.toFixed(2),"x"]})})]})})},x.id||Math.random())})})]}),e.jsx(I,{mode:"wait",children:r&&e.jsxs(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stake amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(re,{type:"number",placeholder:"0.00",value:i,onChange:x=>d(x.target.value),className:"pl-8 pr-4 h-12 text-lg font-medium",min:t.stake_min,max:t.stake_max||y}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"$"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["Balance: ",w(y)]}),e.jsx("button",{onClick:()=>d(y.toString()),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Max"})]})]}),e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:M.map(x=>e.jsxs(U,{variant:"outline",size:"sm",onClick:()=>d(x.toString()),disabled:x>y,className:"text-sm h-10",children:["$",x]},x))})}),c>0&&e.jsx(L,{className:"bg-teal-50 border-teal-200",children:e.jsx(R,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Potential return"}),e.jsx("div",{className:"text-lg font-bold text-teal-600",children:w(b)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Profit"}),e.jsx("div",{className:H("font-semibold",b>c?"text-teal-600":"text-red-600"),children:w(b-c)})]})]})})})]},`amount-input-${r}`)})]}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-200 bg-white",children:e.jsx(U,{onClick:T,disabled:!r||!c||g||c>y,className:"w-full h-12 bg-teal-500 hover:bg-teal-600 disabled:bg-gray-400 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg flex items-center justify-center",children:g?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Placing..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{size:16}),e.jsxs("span",{children:["Place Prediction (",w(c),")"]})]})})})]},"prediction-modal-content")})]})})},ve=({hasNext:t,loading:s,onLoadMore:a,threshold:r=200,disabled:o=!1,container:i=null})=>{const d=n.useRef(!1),g=n.useCallback(()=>{if(o||s||!t||d.current)return;let h,m,p;i?(h=i.scrollTop,m=i.scrollHeight,p=i.clientHeight):(h=window.pageYOffset||document.documentElement.scrollTop,m=document.documentElement.scrollHeight,p=window.innerHeight||document.documentElement.clientHeight);const f=m-(h+p);f<=r&&(console.log("🔄 Infinite scroll triggered:",{distanceFromBottom:f,threshold:r,hasNext:t,loading:s,container:i?"container":"window"}),d.current=!0,a(),setTimeout(()=>{d.current=!1},1e3))},[o,s,t,r,a,i]);return n.useEffect(()=>{if(o)return;let h;const m=()=>{clearTimeout(h),h=setTimeout(g,100)},p=i||window,f="scroll",y="touchmove";return p.addEventListener(f,m,{passive:!0}),i||window.addEventListener(y,m,{passive:!0}),()=>{p.removeEventListener(f,m),i||window.removeEventListener(y,m),clearTimeout(h)}},[g,o,i]),{triggerLoadMore:n.useCallback(()=>{!o&&!s&&t&&!d.current&&(console.log("🔄 Manual infinite scroll trigger"),d.current=!0,a(),setTimeout(()=>{d.current=!1},1e3))},[o,s,t,a])}},be=le((t,s)=>({positions:{},saveScrollPosition:(a,r)=>{t(o=>({positions:{...o.positions,[a]:{path:a,scrollY:r,timestamp:Date.now()}}}))},getScrollPosition:a=>{const r=s().positions[a];return r&&Date.now()-r.timestamp<10*60*1e3?r.scrollY:null},clearOldPositions:()=>{const a=Date.now(),r=10*60*1e3;t(o=>({positions:Object.fromEntries(Object.entries(o.positions).filter(([,i])=>a-i.timestamp<r))}))}})),je=(t,s={})=>{const[a]=G(),{saveScrollPosition:r,getScrollPosition:o}=be(),i=n.useRef(""),{saveOnUnmount:d=!0,restoreOnMount:g=!0,preserveFor:C=10,threshold:h=50}=s,m=n.useCallback(()=>t?.current?t.current:document.querySelector("[data-scroll-container]")||document.documentElement,[t]),p=n.useCallback(()=>{const c=m(),u=c===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:c.scrollTop;u>h&&(console.log(`💾 Saving scroll position for ${a}: ${u}px`),r(a,u))},[a,h,r,m]),f=n.useCallback(()=>{const c=m(),u=o(a);return u!==null&&u>0?(console.log(`🔄 Restoring scroll position for ${a}: ${u}px`),setTimeout(()=>{c===document.documentElement?window.scrollTo({top:u,behavior:"smooth"}):c.scrollTo({top:u,behavior:"smooth"})},100),!0):!1},[a,o,m]),y=n.useCallback(c=>{const u=m(),N=u===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:u.scrollTop,b=c||a;N>h&&(console.log(`💾 Manually saving scroll for ${b}: ${N}px`),r(b,N))},[a,h,r,m]);return n.useEffect(()=>{let c;return g&&(c=setTimeout(()=>{f()},50)),()=>{c&&clearTimeout(c),d&&p()}},[g,d,f,p]),n.useEffect(()=>{i.current&&i.current!==a&&console.log(`🔄 Location changed from ${i.current} to ${a}`),i.current=a},[a]),{saveScroll:y,restoreScroll:f,saveCurrentScroll:p}},V=O.memo(function({selectedCategory:s,onSelect:a}){const r=[{id:"all",label:"All",icon:"🌟"},{id:"sports",label:"Sports",icon:"⚽"},{id:"pop_culture",label:"Pop Culture",icon:"🎬"},{id:"custom",label:"Custom",icon:"✨"},{id:"politics",label:"Politics",icon:"🗳️"},{id:"crypto",label:"Crypto",icon:"₿"},{id:"tech",label:"Tech",icon:"💻"},{id:"finance",label:"Finance",icon:"📈"}];return e.jsx("div",{className:"category-filters bg-white border-b border-gray-100 px-4 py-3","data-tour-id":"category-filters",children:e.jsx("div",{className:"category-filters-container overflow-x-auto -mx-2 px-2",children:e.jsx("div",{className:"category-filters-flex flex gap-2 pb-1",children:r.map(o=>e.jsx(k.button,{onClick:()=>a(o.id),className:`
                category-pill flex-shrink-0 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium
                transition-all duration-200 whitespace-nowrap
                ${s===o.id?"active bg-purple-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
              `,whileTap:{scale:.96},children:e.jsx("span",{children:o.label})},o.id))})})})});V.displayName="CategoryFilters";const B=O.memo(function({stats:s,searchQuery:a,onSearchChange:r}){return e.jsxs("div",{className:"px-4 pt-4 pb-4 bg-white",children:[e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"LIVE MARKETS"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",title:`Total volume: ${(s?.totalVolume||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,children:oe(s?.totalVolume)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Volume"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",title:`${(s?.activePredictions||0).toLocaleString()} active predictions`,children:A(s?.activePredictions)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Live"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",title:`${(s?.totalUsers||0).toLocaleString()} total players`,children:A(s?.totalUsers)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Players"})]})]})]}),e.jsxs("div",{className:"relative","data-tour-id":"search-bar",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search predictions...",value:a,onChange:o=>r(o.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-500 focus:bg-white focus:ring-2 focus:ring-emerald-500 focus:outline-none transition-all"})]})]})});B.displayName="DiscoverHeaderContent";const Ne=O.memo(function({onNavigateToProfile:s,onNavigateToPrediction:a}){Y(),q();const{predictions:r,loading:o,loadingMore:i,pagination:d,filters:g,refreshPredictions:C,loadMorePredictions:h,setFilters:m}=z(),[p,f]=n.useState(null),[y,c]=n.useState(!1),u=n.useRef(null),{saveScroll:N}=je(u,{saveOnUnmount:!0,restoreOnMount:!0,preserveFor:15,threshold:100}),[b,M]=n.useState({totalVolume:"0",activePredictions:0,totalUsers:"0",rawVolume:0,rawUsers:0}),T=n.useCallback(async()=>{try{const{getApiUrl:l}=await ee(()=>import("./index-6a684df2.js").then(j=>j.H),["assets/index-6a684df2.js","assets/ui-78f6af00.js","assets/vendor-2237fdcd.js","assets/utils-228faac7.js","assets/index-7c822fcf.css"]),P=await fetch(`${l()}/api/v2/predictions/stats/platform`);if(P.ok){const j=await P.json();j.success&&(M(j.data),console.log("✅ Platform stats fetched:",j.data))}else console.error("Failed to fetch platform stats:",P.status)}catch(l){console.error("Error fetching platform stats:",l)}},[]);ve({hasNext:d.hasNext,loading:i,onLoadMore:()=>{console.log("🔄 Infinite scroll triggered in DiscoverPage:",{hasNext:d.hasNext,loading:i,currentPage:d.page,total:d.total}),h()},threshold:300,container:u.current}),n.useEffect(()=>{C(),T()},[C,T]);const x=n.useMemo(()=>({totalVolume:b.totalVolume,activePredictions:b.activePredictions,totalUsers:b.totalUsers}),[b]),v=n.useMemo(()=>!r||!Array.isArray(r)?(console.log("🔍 DiscoverPage Debug - No valid predictions array:",r),[]):(console.log(`🔍 DiscoverPage Debug - Displaying ${r.length} predictions`),r.filter(l=>!l||!l.id||!l.title?(console.warn("⚠️ DiscoverPage: Invalid prediction object:",l),!1):!0)),[r]);n.useCallback(l=>{f(l),c(!0)},[]);const $=n.useCallback(l=>{N("/discover"),a?a(l):window.location.href=`/prediction/${l}`},[a,N]);n.useCallback(l=>{F.success("Prediction liked!")},[]),n.useCallback(l=>{N("/discover"),$(l)},[$,N]),n.useCallback(l=>{const P=`Check out this prediction: ${l.title}`,j=`${window.location.origin}/prediction/${l.id}`;navigator.share?navigator.share({title:l.title,text:P,url:j}).catch(console.error):navigator.clipboard.writeText(`${P}
${j}`).then(()=>F.success("Link copied to clipboard!")).catch(()=>F.error("Failed to copy link"))},[]);const E=n.useCallback(l=>{console.log("🔍 Search query changed:",l),m({search:l})},[m]),_=n.useCallback(l=>{console.log("📂 Category changed:",l),m({category:l})},[m]),Z=n.useCallback(()=>{c(!1),f(null)},[]);return o&&(!r||r.length===0)?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-100",children:[e.jsx("div",{className:"h-11"}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 loading-skeleton"})]}),e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full loading-skeleton"})]}),e.jsxs("div",{className:"bg-gray-200 rounded-2xl p-4 mb-4 loading-skeleton",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-20 mb-3 loading-skeleton"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-16 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-12 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-14 mx-auto loading-skeleton"})]})]})]}),e.jsx("div",{className:"h-12 bg-gray-200 rounded-xl loading-skeleton"})]})]}),e.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[1,2,3,4,5,6].map(l=>e.jsx("div",{className:"h-8 bg-gray-200 rounded-full w-20 flex-shrink-0 loading-skeleton"},l))})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"px-4 mb-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 loading-skeleton"})]}),e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(l=>e.jsx(me,{},l))})]})]}):e.jsxs("div",{ref:u,className:"discover-page content-with-bottom-nav","data-scroll-container":!0,style:{position:"relative",zIndex:1,overflowY:"auto",height:"100vh"},children:[e.jsx(ne,{title:"Discover"}),e.jsx(B,{stats:x,searchQuery:g.search,onSearchChange:E}),e.jsx("div",{className:"category-filters-wrapper",style:{position:"relative",zIndex:45},children:e.jsx(V,{selectedCategory:g.category,onSelect:_})}),e.jsxs("div",{className:"prediction-cards-container",children:[e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-1","data-tour-id":"discover-list",children:[g.category==="all"?"All Predictions":`${g.category} Predictions`,g.search&&` - "${g.search}"`]}),d.total>0&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",v.length," of ",d.total," predictions",d.hasNext&&" • Scroll for more"]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(I,{mode:"wait",children:v.length>0?e.jsxs(e.Fragment,{children:[v.map((l,P)=>!l||!l.id?(console.warn("⚠️ DiscoverPage: Skipping invalid prediction at index",P),null):e.jsx(de,{prediction:{id:l.id,title:l.title,category:l.category,endsAt:l.entry_deadline,pool:l.pool_total,players:l.participant_count,options:l.options?.slice(0,2).map(j=>({label:j.label,odds:j.current_odds})),description:l.description}},`${l.id}-${P}`)),i&&e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center py-8",children:[e.jsx(te,{className:"w-6 h-6 animate-spin text-purple-500 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading more predictions..."})]}),d.hasNext&&!i&&e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-6",children:[e.jsxs("button",{onClick:()=>{console.log("🔄 Manual load more triggered"),h()},className:"bg-purple-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-600 transition-colors",children:["Load More (",d.total-v.length," remaining)"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Page ",d.page," • ",v.length,"/",d.total]})]}),!d.hasNext&&!i&&v.length>10&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"🎉 You've seen all predictions!"})})]}):e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"text-center py-12 px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(se,{size:24,className:"text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No predictions found"}),e.jsx("p",{className:"text-gray-600",children:g.search?`No predictions match "${g.search}"`:o?"Loading predictions...":"Try adjusting your filters or check back later"}),!o&&!g.search&&e.jsx("button",{onClick:()=>C(!0),className:"mt-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"Refresh Predictions"})]})})})]}),e.jsx(ye,{prediction:p,isOpen:y,onClose:Z})]})});Ne.displayName="DiscoverPage";export{Ne as default};
