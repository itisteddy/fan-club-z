{"version":3,"mappings":"4/BAEIA,GAAIC,GAEYC,GAAA,WAAGF,GAAE,WACJE,GAAA,YAAGF,GAAE,YCmB1B,IAAIG,GAAoB,WAiGxB,SAASC,GAAqBC,EAAU,GAAI,CAC1C,SAASC,EAAsBC,EAASC,EAAe,CACrD,GAAI,CAAE,SAAAC,EAAU,OAAAC,EAAQ,KAAAC,CAAI,EAAKJ,EAAQ,SACzC,OAAOK,GACL,GACA,CAAE,SAAAH,EAAU,OAAAC,EAAQ,KAAAC,CAAM,EAE1BH,EAAc,OAASA,EAAc,MAAM,KAAO,KAClDA,EAAc,OAASA,EAAc,MAAM,KAAO,SACxD,CACG,CACD,SAASK,EAAkBN,EAASO,EAAI,CACtC,OAAO,OAAOA,GAAO,SAAWA,EAAKC,GAAWD,CAAE,CACnD,CACD,OAAOE,GACLV,EACAO,EACA,KACAR,CACJ,CACA,CA4CA,SAASY,GAAUC,EAAOC,EAAS,CACjC,GAAID,IAAU,IAASA,IAAU,MAAQ,OAAOA,EAAU,IACxD,MAAM,IAAI,MAAMC,CAAO,CAE3B,CACA,SAASC,GAAQC,EAAMF,EAAS,CAC9B,GAAI,CAACE,EAEH,GAAI,CACF,MAAM,IAAI,MAAMF,CAAO,CACxB,MAAW,CACX,CAEL,CACA,SAASG,IAAY,CACnB,OAAO,KAAK,OAAM,EAAG,SAAS,EAAE,EAAE,UAAU,EAAG,EAAE,CACnD,CACA,SAASC,GAAgBC,EAAUC,EAAO,CACxC,MAAO,CACL,IAAKD,EAAS,MACd,IAAKA,EAAS,IACd,IAAKC,CACT,CACA,CACA,SAASb,GAAec,EAASZ,EAAIa,EAAQ,KAAMC,EAAK,CAatD,MAZe,CACb,SAAU,OAAOF,GAAY,SAAWA,EAAUA,EAAQ,SAC1D,OAAQ,GACR,KAAM,GACN,GAAG,OAAOZ,GAAO,SAAWe,GAAUf,CAAE,EAAIA,EAC5C,MAAAa,EAKA,IAAKb,GAAMA,EAAG,KAAOc,GAAON,GAAW,CAC3C,CAEA,CACA,SAASP,GAAW,CAClB,SAAAN,EAAW,IACX,OAAAC,EAAS,GACT,KAAAC,EAAO,EACT,EAAG,CACD,OAAID,GAAUA,IAAW,MACvBD,GAAYC,EAAO,OAAO,CAAC,IAAM,IAAMA,EAAS,IAAMA,GACpDC,GAAQA,IAAS,MACnBF,GAAYE,EAAK,OAAO,CAAC,IAAM,IAAMA,EAAO,IAAMA,GAC7CF,CACT,CACA,SAASoB,GAAUC,EAAM,CACvB,IAAIC,EAAa,GACjB,GAAID,EAAM,CACR,IAAIE,EAAYF,EAAK,QAAQ,GAAG,EAC5BE,GAAa,IACfD,EAAW,KAAOD,EAAK,UAAUE,CAAS,EAC1CF,EAAOA,EAAK,UAAU,EAAGE,CAAS,GAEpC,IAAIC,EAAcH,EAAK,QAAQ,GAAG,EAC9BG,GAAe,IACjBF,EAAW,OAASD,EAAK,UAAUG,CAAW,EAC9CH,EAAOA,EAAK,UAAU,EAAGG,CAAW,GAElCH,IACFC,EAAW,SAAWD,EAEzB,CACD,OAAOC,CACT,CACA,SAASf,GAAmBkB,EAAaC,EAAaC,EAAkB/B,EAAU,GAAI,CACpF,GAAI,CAAE,OAAQE,EAAU,SAAS,YAAa,SAAA8B,EAAW,EAAO,EAAGhC,EAC/DG,EAAgBD,EAAQ,QACxB+B,EAAS,MACTC,EAAW,KACXd,EAAQe,IACRf,GAAS,OACXA,EAAQ,EACRjB,EAAc,aAAa,CAAE,GAAGA,EAAc,MAAO,IAAKiB,GAAS,EAAE,GAEvE,SAASe,GAAW,CAElB,OADYhC,EAAc,OAAS,CAAE,IAAK,IAAI,GACjC,GACd,CACD,SAASiC,GAAY,CACnBH,EAAS,MACT,IAAII,EAAYF,IACZG,EAAQD,GAAa,KAAO,KAAOA,EAAYjB,EACnDA,EAAQiB,EACJH,GACFA,EAAS,CAAE,OAAAD,EAAQ,SAAUM,EAAQ,SAAU,MAAAD,CAAK,CAAE,CAEzD,CACD,SAASE,EAAK/B,EAAIa,EAAO,CACvBW,EAAS,OACT,IAAId,EAAWZ,GAAegC,EAAQ,SAAU9B,EAAIa,CAAK,EACrDS,GAAkBA,EAAiBZ,EAAUV,CAAE,EACnDW,EAAQe,EAAU,EAAG,EACrB,IAAIM,EAAevB,GAAgBC,EAAUC,CAAK,EAC9CsB,EAAMH,EAAQ,WAAWpB,CAAQ,EACrC,GAAI,CACFhB,EAAc,UAAUsC,EAAc,GAAIC,CAAG,CAC9C,OAAQC,EAAO,CACd,GAAIA,aAAiB,cAAgBA,EAAM,OAAS,iBAClD,MAAMA,EAERzC,EAAQ,SAAS,OAAOwC,CAAG,CAC5B,CACGV,GAAYE,GACdA,EAAS,CAAE,OAAAD,EAAQ,SAAUM,EAAQ,SAAU,MAAO,CAAC,CAAE,CAE5D,CACD,SAASK,EAASnC,EAAIa,EAAO,CAC3BW,EAAS,UACT,IAAId,EAAWZ,GAAegC,EAAQ,SAAU9B,EAAIa,CAAK,EACrDS,GAAkBA,EAAiBZ,EAAUV,CAAE,EACnDW,EAAQe,EAAQ,EAChB,IAAIM,EAAevB,GAAgBC,EAAUC,CAAK,EAC9CsB,EAAMH,EAAQ,WAAWpB,CAAQ,EACrChB,EAAc,aAAasC,EAAc,GAAIC,CAAG,EAC5CV,GAAYE,GACdA,EAAS,CAAE,OAAAD,EAAQ,SAAUM,EAAQ,SAAU,MAAO,CAAC,CAAE,CAE5D,CACD,SAASM,EAAUpC,EAAI,CACrB,OAAOqC,GAAqBrC,CAAE,CAC/B,CACD,IAAI8B,EAAU,CACZ,IAAI,QAAS,CACX,OAAON,CACR,EACD,IAAI,UAAW,CACb,OAAOJ,EAAY3B,EAASC,CAAa,CAC1C,EACD,OAAO4C,EAAI,CACT,GAAIb,EACF,MAAM,IAAI,MAAM,4CAA4C,EAE9D,OAAAhC,EAAQ,iBAAiBJ,GAAmBsC,CAAS,EACrDF,EAAWa,EACJ,IAAM,CACX7C,EAAQ,oBAAoBJ,GAAmBsC,CAAS,EACxDF,EAAW,IACnB,CACK,EACD,WAAWzB,EAAI,CACb,OAAOqB,EAAY5B,EAASO,CAAE,CAC/B,EACD,UAAAoC,EACA,eAAepC,EAAI,CACjB,IAAIiC,EAAMG,EAAUpC,CAAE,EACtB,MAAO,CACL,SAAUiC,EAAI,SACd,OAAQA,EAAI,OACZ,KAAMA,EAAI,IAClB,CACK,EACD,KAAAF,EACA,QAASI,EACT,GAAGI,EAAG,CACJ,OAAO7C,EAAc,GAAG6C,CAAC,CAC1B,CACL,EACE,OAAOT,CACT,CACA,SAASO,GAAqBrC,EAAIwC,EAAa,GAAO,CACpD,IAAIC,EAAO,mBACP,OAAO,OAAW,MACpBA,EAAO,OAAO,SAAS,SAAW,OAAS,OAAO,SAAS,OAAS,OAAO,SAAS,MAEtFtC,GAAUsC,EAAM,0DAA0D,EAC1E,IAAIC,EAAO,OAAO1C,GAAO,SAAWA,EAAKC,GAAWD,CAAE,EACtD,OAAA0C,EAAOA,EAAK,QAAQ,KAAM,KAAK,EAC3B,CAACF,GAAcE,EAAK,WAAW,IAAI,IACrCA,EAAOD,EAAOC,GAET,IAAI,IAAIA,EAAMD,CAAI,CAC3B,CAwIA,SAASE,GAAYC,EAAQC,EAAaC,EAAW,IAAK,CACxD,OAAOC,GAAgBH,EAAQC,EAAaC,EAAU,EAAK,CAC7D,CACA,SAASC,GAAgBH,EAAQC,EAAaC,EAAUE,EAAc,CACpE,IAAItC,EAAW,OAAOmC,GAAgB,SAAW9B,GAAU8B,CAAW,EAAIA,EACtElD,EAAWsD,GAAcvC,EAAS,UAAY,IAAKoC,CAAQ,EAC/D,GAAInD,GAAY,KACd,OAAO,KAET,IAAIuD,EAAWC,GAAcP,CAAM,EACnCQ,GAAkBF,CAAQ,EAC1B,IAAIG,EAAU,KACd,QAASC,EAAI,EAAGD,GAAW,MAAQC,EAAIJ,EAAS,OAAQ,EAAEI,EAAG,CAC3D,IAAIC,EAAUC,GAAW7D,CAAQ,EACjC0D,EAAUI,GACRP,EAASI,CAAC,EACVC,EACAP,CACN,CACG,CACD,OAAOK,CACT,CAYA,SAASF,GAAcP,EAAQM,EAAW,GAAIQ,EAAc,CAAE,EAAEC,EAAa,GAAIC,EAA6B,GAAO,CACnH,IAAIC,EAAe,CAACC,EAAOnD,EAAOoD,EAA4BH,EAA4BI,IAAiB,CACzG,IAAIC,EAAO,CACT,aAAcD,IAAiB,OAASF,EAAM,MAAQ,GAAKE,EAC3D,cAAeF,EAAM,gBAAkB,GACvC,cAAenD,EACf,MAAAmD,CACN,EACI,GAAIG,EAAK,aAAa,WAAW,GAAG,EAAG,CACrC,GAAI,CAACA,EAAK,aAAa,WAAWN,CAAU,GAAKI,EAC/C,OAEF5D,GACE8D,EAAK,aAAa,WAAWN,CAAU,EACvC,wBAAwBM,EAAK,YAAY,wBAAwBN,CAAU,0GACnF,EACMM,EAAK,aAAeA,EAAK,aAAa,MAAMN,EAAW,MAAM,CAC9D,CACD,IAAI3C,EAAOkD,GAAU,CAACP,EAAYM,EAAK,YAAY,CAAC,EAChDE,EAAaT,EAAY,OAAOO,CAAI,EACpCH,EAAM,UAAYA,EAAM,SAAS,OAAS,IAC5C3D,GAGE2D,EAAM,QAAU,GAChB,4FAA4F9C,CAAI,IACxG,EACMmC,GACEW,EAAM,SACNZ,EACAiB,EACAnD,EACA+C,CACR,GAEQ,EAAAD,EAAM,MAAQ,MAAQ,CAACA,EAAM,QAGjCZ,EAAS,KAAK,CACZ,KAAAlC,EACA,MAAOoD,GAAapD,EAAM8C,EAAM,KAAK,EACrC,WAAAK,CACN,CAAK,CACL,EACE,OAAAvB,EAAO,QAAQ,CAACkB,EAAOnD,IAAU,CAC/B,GAAImD,EAAM,OAAS,IAAM,CAACA,EAAM,MAAM,SAAS,GAAG,EAChDD,EAAaC,EAAOnD,CAAK,MAEzB,SAAS0D,KAAYC,GAAwBR,EAAM,IAAI,EACrDD,EAAaC,EAAOnD,EAAO,GAAM0D,CAAQ,CAGjD,CAAG,EACMnB,CACT,CACA,SAASoB,GAAwBtD,EAAM,CACrC,IAAIuD,EAAWvD,EAAK,MAAM,GAAG,EAC7B,GAAIuD,EAAS,SAAW,EAAG,MAAO,GAClC,GAAI,CAACC,EAAO,GAAGC,CAAI,EAAIF,EACnBG,EAAaF,EAAM,SAAS,GAAG,EAC/BG,EAAWH,EAAM,QAAQ,MAAO,EAAE,EACtC,GAAIC,EAAK,SAAW,EAClB,OAAOC,EAAa,CAACC,EAAU,EAAE,EAAI,CAACA,CAAQ,EAEhD,IAAIC,EAAeN,GAAwBG,EAAK,KAAK,GAAG,CAAC,EACrDI,EAAS,GACb,OAAAA,EAAO,KACL,GAAGD,EAAa,IACbE,GAAYA,IAAY,GAAKH,EAAW,CAACA,EAAUG,CAAO,EAAE,KAAK,GAAG,CACtE,CACL,EACMJ,GACFG,EAAO,KAAK,GAAGD,CAAY,EAEtBC,EAAO,IACXR,GAAarD,EAAK,WAAW,GAAG,GAAKqD,IAAa,GAAK,IAAMA,CAClE,CACA,CACA,SAASjB,GAAkBF,EAAU,CACnCA,EAAS,KACP,CAAC6B,EAAGC,IAAMD,EAAE,QAAUC,EAAE,MAAQA,EAAE,MAAQD,EAAE,MAAQE,GAClDF,EAAE,WAAW,IAAKd,GAASA,EAAK,aAAa,EAC7Ce,EAAE,WAAW,IAAKf,GAASA,EAAK,aAAa,CAC9C,CACL,CACA,CACA,IAAIiB,GAAU,YACVC,GAAsB,EACtBC,GAAkB,EAClBC,GAAoB,EACpBC,GAAqB,GACrBC,GAAe,GACfC,GAAW,GAAM,IAAM,IAC3B,SAASpB,GAAapD,EAAML,EAAO,CACjC,IAAI4D,EAAWvD,EAAK,MAAM,GAAG,EACzByE,EAAelB,EAAS,OAC5B,OAAIA,EAAS,KAAKiB,EAAO,IACvBC,GAAgBF,IAEd5E,IACF8E,GAAgBL,IAEXb,EAAS,OAAQmB,GAAM,CAACF,GAAQE,CAAC,CAAC,EAAE,OACzC,CAACC,EAAOC,IAAYD,GAAST,GAAQ,KAAKU,CAAO,EAAIT,GAAsBS,IAAY,GAAKP,GAAoBC,IAChHG,CACJ,CACA,CACA,SAASR,GAAeF,EAAGC,EAAG,CAE5B,OADeD,EAAE,SAAWC,EAAE,QAAUD,EAAE,MAAM,EAAG,EAAE,EAAE,MAAM,CAACxC,EAAGe,IAAMf,IAAMyC,EAAE1B,CAAC,CAAC,EAM/EyB,EAAEA,EAAE,OAAS,CAAC,EAAIC,EAAEA,EAAE,OAAS,CAAC,EAIhC,CAEJ,CACA,SAASvB,GAAiBoC,EAAQlG,EAAUqD,EAAe,GAAO,CAChE,GAAI,CAAE,WAAAmB,CAAY,EAAG0B,EACjBC,EAAgB,GAChBC,EAAkB,IAClB1C,EAAU,GACd,QAASC,EAAI,EAAGA,EAAIa,EAAW,OAAQ,EAAEb,EAAG,CAC1C,IAAIW,EAAOE,EAAWb,CAAC,EACnB0C,EAAM1C,IAAMa,EAAW,OAAS,EAChC8B,EAAoBF,IAAoB,IAAMpG,EAAWA,EAAS,MAAMoG,EAAgB,MAAM,GAAK,IACnGG,EAAQC,GACV,CAAE,KAAMlC,EAAK,aAAc,cAAeA,EAAK,cAAe,IAAA+B,CAAK,EACnEC,CACN,EACQnC,EAAQG,EAAK,MAWjB,GAVI,CAACiC,GAASF,GAAOhD,GAAgB,CAACmB,EAAWA,EAAW,OAAS,CAAC,EAAE,MAAM,QAC5E+B,EAAQC,GACN,CACE,KAAMlC,EAAK,aACX,cAAeA,EAAK,cACpB,IAAK,EACN,EACDgC,CACR,GAEQ,CAACC,EACH,OAAO,KAET,OAAO,OAAOJ,EAAeI,EAAM,MAAM,EACzC7C,EAAQ,KAAK,CAEX,OAAQyC,EACR,SAAU5B,GAAU,CAAC6B,EAAiBG,EAAM,QAAQ,CAAC,EACrD,aAAcE,GACZlC,GAAU,CAAC6B,EAAiBG,EAAM,YAAY,CAAC,CAChD,EACD,MAAApC,CACN,CAAK,EACGoC,EAAM,eAAiB,MACzBH,EAAkB7B,GAAU,CAAC6B,EAAiBG,EAAM,YAAY,CAAC,EAEpE,CACD,OAAO7C,CACT,CA6BA,SAAS8C,GAAUE,EAAS1G,EAAU,CAChC,OAAO0G,GAAY,WACrBA,EAAU,CAAE,KAAMA,EAAS,cAAe,GAAO,IAAK,KAExD,GAAI,CAACC,EAASC,CAAc,EAAIC,GAC9BH,EAAQ,KACRA,EAAQ,cACRA,EAAQ,GACZ,EACMH,EAAQvG,EAAS,MAAM2G,CAAO,EAClC,GAAI,CAACJ,EAAO,OAAO,KACnB,IAAIH,EAAkBG,EAAM,CAAC,EACzBO,EAAeV,EAAgB,QAAQ,UAAW,IAAI,EACtDW,EAAgBR,EAAM,MAAM,CAAC,EAiBjC,MAAO,CACL,OAjBWK,EAAe,OAC1B,CAACI,EAAO,CAAE,UAAAC,EAAW,WAAAlC,CAAU,EAAI/D,IAAU,CAC3C,GAAIiG,IAAc,IAAK,CACrB,IAAIC,EAAaH,EAAc/F,CAAK,GAAK,GACzC8F,EAAeV,EAAgB,MAAM,EAAGA,EAAgB,OAASc,EAAW,MAAM,EAAE,QAAQ,UAAW,IAAI,CAC5G,CACD,MAAMzG,EAAQsG,EAAc/F,CAAK,EACjC,OAAI+D,GAAc,CAACtE,EACjBuG,EAAMC,CAAS,EAAI,OAEnBD,EAAMC,CAAS,GAAKxG,GAAS,IAAI,QAAQ,OAAQ,GAAG,EAE/CuG,CACR,EACD,CAAE,CACN,EAGI,SAAUZ,EACV,aAAAU,EACA,QAAAJ,CACJ,CACA,CACA,SAASG,GAAYxF,EAAM8F,EAAgB,GAAOd,EAAM,GAAM,CAC5D1F,GACEU,IAAS,KAAO,CAACA,EAAK,SAAS,GAAG,GAAKA,EAAK,SAAS,IAAI,EACzD,eAAeA,CAAI,oCAAoCA,EAAK,QAAQ,MAAO,IAAI,CAAC,yIAAyIA,EAAK,QAAQ,MAAO,IAAI,CAAC,IACtP,EACE,IAAI+F,EAAS,GACTC,EAAe,IAAMhG,EAAK,QAAQ,UAAW,EAAE,EAAE,QAAQ,OAAQ,GAAG,EAAE,QAAQ,qBAAsB,MAAM,EAAE,QAC9G,oBACA,CAACiG,EAAGL,EAAWlC,KACbqC,EAAO,KAAK,CAAE,UAAAH,EAAW,WAAYlC,GAAc,IAAI,CAAE,EAClDA,EAAa,eAAiB,aAE3C,EAAI,QAAQ,sBAAuB,UAAU,EAC3C,OAAI1D,EAAK,SAAS,GAAG,GACnB+F,EAAO,KAAK,CAAE,UAAW,GAAK,GAC9BC,GAAgBhG,IAAS,KAAOA,IAAS,KAAO,QAAU,qBACjDgF,EACTgB,GAAgB,QACPhG,IAAS,IAAMA,IAAS,MACjCgG,GAAgB,iBAIX,CADO,IAAI,OAAOA,EAAcF,EAAgB,OAAS,GAAG,EAClDC,CAAM,CACzB,CACA,SAASvD,GAAWpD,EAAO,CACzB,GAAI,CACF,OAAOA,EAAM,MAAM,GAAG,EAAE,IAAK8G,GAAM,mBAAmBA,CAAC,EAAE,QAAQ,MAAO,KAAK,CAAC,EAAE,KAAK,GAAG,CACzF,OAAQhF,EAAO,CACd,OAAA5B,GACE,GACA,iBAAiBF,CAAK,iHAAiH8B,CAAK,IAClJ,EACW9B,CACR,CACH,CACA,SAAS6C,GAActD,EAAUmD,EAAU,CACzC,GAAIA,IAAa,IAAK,OAAOnD,EAC7B,GAAI,CAACA,EAAS,YAAa,EAAC,WAAWmD,EAAS,YAAW,CAAE,EAC3D,OAAO,KAET,IAAIqE,EAAarE,EAAS,SAAS,GAAG,EAAIA,EAAS,OAAS,EAAIA,EAAS,OACrEsE,EAAWzH,EAAS,OAAOwH,CAAU,EACzC,OAAIC,GAAYA,IAAa,IACpB,KAEFzH,EAAS,MAAMwH,CAAU,GAAK,GACvC,CAOA,IAAIE,GAAqB,gCACrBC,GAAiBrF,GAAQoF,GAAmB,KAAKpF,CAAG,EACxD,SAASsF,GAAYvH,EAAIwH,EAAe,IAAK,CAC3C,GAAI,CACF,SAAUC,EACV,OAAA7H,EAAS,GACT,KAAAC,EAAO,EACX,EAAM,OAAOG,GAAO,SAAWe,GAAUf,CAAE,EAAIA,EACzCL,EACJ,GAAI8H,EACF,GAAIH,GAAcG,CAAU,EAC1B9H,EAAW8H,MACN,CACL,GAAIA,EAAW,SAAS,IAAI,EAAG,CAC7B,IAAIC,EAAcD,EAClBA,EAAaA,EAAW,QAAQ,SAAU,GAAG,EAC7CnH,GACE,GACA,+DAA+DoH,CAAW,OAAOD,CAAU,EACrG,CACO,CACGA,EAAW,WAAW,GAAG,EAC3B9H,EAAWgI,GAAgBF,EAAW,UAAU,CAAC,EAAG,GAAG,EAEvD9H,EAAWgI,GAAgBF,EAAYD,CAAY,CAEtD,MAED7H,EAAW6H,EAEb,MAAO,CACL,SAAA7H,EACA,OAAQiI,GAAgBhI,CAAM,EAC9B,KAAMiI,GAAchI,CAAI,CAC5B,CACA,CACA,SAAS8H,GAAgB3D,EAAcwD,EAAc,CACnD,IAAIjD,EAAWiD,EAAa,QAAQ,OAAQ,EAAE,EAAE,MAAM,GAAG,EAEzD,OADuBxD,EAAa,MAAM,GAAG,EAC5B,QAAS4B,GAAY,CAChCA,IAAY,KACVrB,EAAS,OAAS,GAAGA,EAAS,IAAG,EAC5BqB,IAAY,KACrBrB,EAAS,KAAKqB,CAAO,CAE3B,CAAG,EACMrB,EAAS,OAAS,EAAIA,EAAS,KAAK,GAAG,EAAI,GACpD,CACA,SAASuD,GAAoBC,EAAMC,EAAOC,EAAMjH,EAAM,CACpD,MAAO,qBAAqB+G,CAAI,4CAA4CC,CAAK,aAAa,KAAK,UACjGhH,CACJ,CAAG,0CAA0CiH,CAAI,4HACjD,CACA,SAASC,GAA2B7E,EAAS,CAC3C,OAAOA,EAAQ,OACb,CAAC6C,EAAOvF,IAAUA,IAAU,GAAKuF,EAAM,MAAM,MAAQA,EAAM,MAAM,KAAK,OAAS,CACnF,CACA,CACA,SAASiC,GAAoB9E,EAAS,CACpC,IAAI+E,EAAcF,GAA2B7E,CAAO,EACpD,OAAO+E,EAAY,IACjB,CAAClC,EAAOmC,IAAQA,IAAQD,EAAY,OAAS,EAAIlC,EAAM,SAAWA,EAAM,YAC5E,CACA,CACA,SAASoC,GAAUC,EAAOC,EAAgBC,EAAkBC,EAAiB,GAAO,CAClF,IAAI1I,EACA,OAAOuI,GAAU,SACnBvI,EAAKe,GAAUwH,CAAK,GAEpBvI,EAAK,CAAE,GAAGuI,GACVpI,GACE,CAACH,EAAG,UAAY,CAACA,EAAG,SAAS,SAAS,GAAG,EACzC8H,GAAoB,IAAK,WAAY,SAAU9H,CAAE,CACvD,EACIG,GACE,CAACH,EAAG,UAAY,CAACA,EAAG,SAAS,SAAS,GAAG,EACzC8H,GAAoB,IAAK,WAAY,OAAQ9H,CAAE,CACrD,EACIG,GACE,CAACH,EAAG,QAAU,CAACA,EAAG,OAAO,SAAS,GAAG,EACrC8H,GAAoB,IAAK,SAAU,OAAQ9H,CAAE,CACnD,GAEE,IAAI2I,EAAcJ,IAAU,IAAMvI,EAAG,WAAa,GAC9CyH,EAAakB,EAAc,IAAM3I,EAAG,SACpC4I,EACJ,GAAInB,GAAc,KAChBmB,EAAOH,MACF,CACL,IAAII,EAAqBL,EAAe,OAAS,EACjD,GAAI,CAACE,GAAkBjB,EAAW,WAAW,IAAI,EAAG,CAClD,IAAIqB,EAAarB,EAAW,MAAM,GAAG,EACrC,KAAOqB,EAAW,CAAC,IAAM,MACvBA,EAAW,MAAK,EAChBD,GAAsB,EAExB7I,EAAG,SAAW8I,EAAW,KAAK,GAAG,CAClC,CACDF,EAAOC,GAAsB,EAAIL,EAAeK,CAAkB,EAAI,GACvE,CACD,IAAI7H,EAAOuG,GAAYvH,EAAI4I,CAAI,EAC3BG,EAA2BtB,GAAcA,IAAe,KAAOA,EAAW,SAAS,GAAG,EACtFuB,GAA2BL,GAAelB,IAAe,MAAQgB,EAAiB,SAAS,GAAG,EAClG,MAAI,CAACzH,EAAK,SAAS,SAAS,GAAG,IAAM+H,GAA4BC,KAC/DhI,EAAK,UAAY,KAEZA,CACT,CACA,IAAIkD,GAAa+E,GAAUA,EAAM,KAAK,GAAG,EAAE,QAAQ,SAAU,GAAG,EAC5D7C,GAAqBzG,GAAaA,EAAS,QAAQ,OAAQ,EAAE,EAAE,QAAQ,OAAQ,GAAG,EAClFiI,GAAmBhI,GAAW,CAACA,GAAUA,IAAW,IAAM,GAAKA,EAAO,WAAW,GAAG,EAAIA,EAAS,IAAMA,EACvGiI,GAAiBhI,GAAS,CAACA,GAAQA,IAAS,IAAM,GAAKA,EAAK,WAAW,GAAG,EAAIA,EAAO,IAAMA,EAgD/F,SAASqJ,GAAqBhH,EAAO,CACnC,OAAOA,GAAS,MAAQ,OAAOA,EAAM,QAAW,UAAY,OAAOA,EAAM,YAAe,UAAY,OAAOA,EAAM,UAAa,WAAa,SAAUA,CACvJ,CAwQuB,OAAO,oBAAoB,OAAO,SAAS,EAAE,KAAM,EAAC,KAAK,IAAI,EAUpF,IAAIiH,GAA0B,CAC5B,OACA,MACA,QACA,QACF,EAC2B,IAAI,IAC7BA,EACF,EACA,IAAIC,GAAyB,CAC3B,MACA,GAAGD,EACL,EAC0B,IAAI,IAAIC,EAAsB,EAq9HxD,IAAIC,GAAoBC,gBAAoB,IAAI,EAChDD,GAAkB,YAAc,aAChC,IAAIE,GAAyBD,gBAAoB,IAAI,EACrDC,GAAuB,YAAc,kBACdD,EAAmB,cAAC,EAAK,EAIhD,IAAIE,GAAwBF,gBAAoB,CAC9C,gBAAiB,EACnB,CAAC,EACDE,GAAsB,YAAc,iBACpC,IAAIC,GAAkBH,EAAmB,cACvB,IAAI,GACtB,EACAG,GAAgB,YAAc,WAC9B,IAAIC,GAAeJ,gBAAoB,IAAI,EAC3CI,GAAa,YAAc,QAE3B,IAAIC,GAAoBL,EAAmB,cACzC,IACF,EACAK,GAAkB,YAAc,aAChC,IAAIC,GAAkBN,EAAmB,cACvC,IACF,EACAM,GAAgB,YAAc,WAC9B,IAAIC,GAAeP,gBAAoB,CACrC,OAAQ,KACR,QAAS,CAAE,EACX,YAAa,EACf,CAAC,EACDO,GAAa,YAAc,QAC3B,IAAIC,GAAoBR,gBAAoB,IAAI,EAChDQ,GAAkB,YAAc,aAKhC,SAASC,GAAQ/J,EAAI,CAAE,SAAAgK,CAAQ,EAAK,GAAI,CACtC7J,GACE8J,GAAoB,EAGpB,oEACJ,EACE,GAAI,CAAE,SAAAnH,EAAU,UAAAoH,CAAW,EAAGC,EAAiB,WAACR,EAAiB,EAC7D,CAAE,KAAA9J,EAAM,SAAAF,EAAU,OAAAC,CAAM,EAAKwK,GAAgBpK,EAAI,CAAE,SAAAgK,CAAQ,CAAE,EAC7DK,EAAiB1K,EACrB,OAAImD,IAAa,MACfuH,EAAiB1K,IAAa,IAAMmD,EAAWoB,GAAU,CAACpB,EAAUnD,CAAQ,CAAC,GAExEuK,EAAU,WAAW,CAAE,SAAUG,EAAgB,OAAAzK,EAAQ,KAAAC,CAAI,CAAE,CACxE,CACA,SAASoK,IAAqB,CAC5B,OAAOE,EAAiB,WAACP,EAAe,GAAK,IAC/C,CACA,SAASU,IAAc,CACrB,OAAAnK,GACE8J,GAAoB,EAGpB,wEACJ,EACSE,EAAiB,WAACP,EAAe,EAAE,QAC5C,CAiBA,IAAIW,GAAwB,gGAC5B,SAASC,GAA0BC,EAAI,CACtBN,aAAkBR,EAAiB,EAAE,QAElDe,EAAsB,gBAACD,CAAE,CAE7B,CACA,SAASE,IAAc,CACrB,GAAI,CAAE,YAAAC,CAAW,EAAKT,EAAiB,WAACN,EAAY,EACpD,OAAOe,EAAcC,KAAsBC,IAC7C,CACA,SAASA,IAAsB,CAC7B3K,GACE8J,GAAoB,EAGpB,wEACJ,EACE,IAAIc,EAAoBZ,aAAkBd,EAAiB,EACvD,CAAE,SAAAvG,EAAU,UAAAoH,CAAW,EAAGC,EAAiB,WAACR,EAAiB,EAC7D,CAAE,QAAAtG,CAAO,EAAK8G,EAAiB,WAACN,EAAY,EAC5C,CAAE,SAAUpB,CAAkB,EAAG6B,GAAW,EAC5CU,EAAqB,KAAK,UAAU7C,GAAoB9E,CAAO,CAAC,EAChE4H,EAAYC,SAAc,EAAK,EACnCV,UAA0B,IAAM,CAC9BS,EAAU,QAAU,EACxB,CAAG,EACcE,EAAkB,YAC/B,CAACnL,EAAIT,EAAU,KAAO,CAEpB,GADAe,GAAQ2K,EAAU,QAASV,EAAqB,EAC5C,CAACU,EAAU,QAAS,OACxB,GAAI,OAAOjL,GAAO,SAAU,CAC1BkK,EAAU,GAAGlK,CAAE,EACf,MACD,CACD,IAAIgB,EAAOsH,GACTtI,EACA,KAAK,MAAMgL,CAAkB,EAC7BvC,EACAlJ,EAAQ,WAAa,MAC7B,EACUwL,GAAqB,MAAQjI,IAAa,MAC5C9B,EAAK,SAAWA,EAAK,WAAa,IAAM8B,EAAWoB,GAAU,CAACpB,EAAU9B,EAAK,QAAQ,CAAC,IAErFzB,EAAQ,QAAU2K,EAAU,QAAUA,EAAU,MACjDlJ,EACAzB,EAAQ,MACRA,CACR,CACK,EACD,CACEuD,EACAoH,EACAc,EACAvC,EACAsC,CACD,CACL,CAEA,CACoBK,EAAoB,cAAC,IAAI,EAW7C,SAASC,IAAY,CACnB,GAAI,CAAE,QAAAhI,CAAO,EAAK8G,EAAiB,WAACN,EAAY,EAC5CyB,EAAajI,EAAQA,EAAQ,OAAS,CAAC,EAC3C,OAAOiI,EAAaA,EAAW,OAAS,EAC1C,CACA,SAASlB,GAAgBpK,EAAI,CAAE,SAAAgK,CAAQ,EAAK,GAAI,CAC9C,GAAI,CAAE,QAAA3G,CAAO,EAAK8G,EAAiB,WAACN,EAAY,EAC5C,CAAE,SAAUpB,CAAkB,EAAG6B,GAAW,EAC5CU,EAAqB,KAAK,UAAU7C,GAAoB9E,CAAO,CAAC,EACpE,OAAOkI,EAAc,QACnB,IAAMjD,GACJtI,EACA,KAAK,MAAMgL,CAAkB,EAC7BvC,EACAuB,IAAa,MACd,EACD,CAAChK,EAAIgL,EAAoBvC,EAAkBuB,CAAQ,CACvD,CACA,CACA,SAASwB,GAAU5I,EAAQC,EAAa,CACtC,OAAO4I,GAAc7I,EAAQC,CAAW,CAC1C,CACA,SAAS4I,GAAc7I,EAAQC,EAAa6I,EAAiBC,EAAkBC,EAAQ,CACrFzL,GACE8J,GAAoB,EAGpB,sEACJ,EACE,GAAI,CAAE,UAAAC,CAAS,EAAKC,EAAiB,WAACR,EAAiB,EACnD,CAAE,QAASkC,CAAe,EAAG1B,EAAiB,WAACN,EAAY,EAC3DyB,EAAaO,EAAcA,EAAc,OAAS,CAAC,EACnDC,EAAeR,EAAaA,EAAW,OAAS,GAChDS,EAAiBT,EAAaA,EAAW,SAAW,IACpDU,EAAqBV,EAAaA,EAAW,aAAe,IAC5DW,EAAcX,GAAcA,EAAW,MAClB,CACvB,IAAI3H,EAAasI,GAAeA,EAAY,MAAQ,GACpDC,GACEH,EACA,CAACE,GAAetI,EAAW,SAAS,GAAG,GAAKA,EAAW,SAAS,IAAI,EACpE,oEAAoEoI,CAAc,yBAAyBpI,CAAU;AAAA;AAAA,wCAEnFA,CAAU,sBAAsBA,IAAe,IAAM,IAAM,GAAGA,CAAU,IAAI,KACpH,CACG,CACD,IAAIwI,EAAsB7B,KACtB5J,EACJ,GAAImC,EAAa,CACf,IAAIuJ,EAAoB,OAAOvJ,GAAgB,SAAW9B,GAAU8B,CAAW,EAAIA,EACnF1C,GACE6L,IAAuB,KAAOI,EAAkB,UAAU,WAAWJ,CAAkB,EACvF,2OAA2OA,CAAkB,mBAAmBI,EAAkB,QAAQ,uCAChT,EACI1L,EAAW0L,CACf,MACI1L,EAAWyL,EAEb,IAAIxM,EAAWe,EAAS,UAAY,IAChCuF,EAAoBtG,EACxB,GAAIqM,IAAuB,IAAK,CAC9B,IAAIK,EAAiBL,EAAmB,QAAQ,MAAO,EAAE,EAAE,MAAM,GAAG,EAEpE/F,EAAoB,IADLtG,EAAS,QAAQ,MAAO,EAAE,EAAE,MAAM,GAAG,EACjB,MAAM0M,EAAe,MAAM,EAAE,KAAK,GAAG,CACzE,CACD,IAAIhJ,EAAUV,GAAYC,EAAQ,CAAE,SAAUqD,CAAiB,CAAE,EAE/D3F,GACE2L,GAAe5I,GAAW,KAC1B,+BAA+B3C,EAAS,QAAQ,GAAGA,EAAS,MAAM,GAAGA,EAAS,IAAI,IACxF,EACIJ,GACE+C,GAAW,MAAQA,EAAQA,EAAQ,OAAS,CAAC,EAAE,MAAM,UAAY,QAAUA,EAAQA,EAAQ,OAAS,CAAC,EAAE,MAAM,YAAc,QAAUA,EAAQA,EAAQ,OAAS,CAAC,EAAE,MAAM,OAAS,OAChL,mCAAmC3C,EAAS,QAAQ,GAAGA,EAAS,MAAM,GAAGA,EAAS,IAAI,6IAC5F,EAEE,IAAI4L,EAAkBC,GACpBlJ,GAAWA,EAAQ,IAChB6C,GAAU,OAAO,OAAO,GAAIA,EAAO,CAClC,OAAQ,OAAO,OAAO,CAAE,EAAE4F,EAAc5F,EAAM,MAAM,EACpD,SAAUhC,GAAU,CAClB8H,EAKA9B,EAAU,eAAiBA,EAAU,eACnChE,EAAM,SAAS,QAAQ,MAAO,KAAK,EAAE,QAAQ,KAAM,KAAK,CACpE,EAAY,SAAWA,EAAM,QAC7B,CAAS,EACD,aAAcA,EAAM,eAAiB,IAAM8F,EAAqB9H,GAAU,CACxE8H,EAKA9B,EAAU,eAAiBA,EAAU,eACnChE,EAAM,aAAa,QAAQ,MAAO,KAAK,EAAE,QAAQ,KAAM,KAAK,CACxE,EAAY,SAAWA,EAAM,YAC7B,CAAS,CACT,CAAO,CACF,EACD2F,EACAH,EACAC,EACAC,CACJ,EACE,OAAI/I,GAAeyJ,EACME,EAAoB,cACzC5C,GAAgB,SAChB,CACE,MAAO,CACL,SAAU,CACR,SAAU,IACV,OAAQ,GACR,KAAM,GACN,MAAO,KACP,IAAK,UACL,GAAGlJ,CACJ,EACD,eAAgB,KACjB,CACF,EACD4L,CACN,EAESA,CACT,CACA,SAASG,IAAwB,CAC/B,IAAIvK,EAAQwK,KACRrM,EAAU6I,GAAqBhH,CAAK,EAAI,GAAGA,EAAM,MAAM,IAAIA,EAAM,UAAU,GAAKA,aAAiB,MAAQA,EAAM,QAAU,KAAK,UAAUA,CAAK,EAC7IyK,EAAQzK,aAAiB,MAAQA,EAAM,MAAQ,KAC/C0K,EAAY,yBACZC,EAAY,CAAE,QAAS,SAAU,gBAAiBD,CAAS,EAC3DE,EAAa,CAAE,QAAS,UAAW,gBAAiBF,CAAS,EAC7DG,EAAU,KAMZ,OAAAA,EAA0BP,gBAAqBQ,WAAiB,KAAsBR,gBAAqB,IAAK,KAAM,qBAAmC,EAAmBA,EAAoB,cAAC,IAAK,KAAM,+FAAgHA,EAAoB,cAAC,OAAQ,CAAE,MAAOM,CAAU,EAAI,eAAe,EAAG,MAAO,IAAqBN,EAAoB,cAAC,OAAQ,CAAE,MAAOM,CAAY,EAAE,cAAc,EAAG,sBAAsB,CAAC,EAEreN,EAAoB,cAACQ,EAAe,SAAE,KAAsBR,gBAAqB,KAAM,KAAM,+BAA+B,EAAmBA,gBAAqB,KAAM,CAAE,MAAO,CAAE,UAAW,QAAU,GAAInM,CAAO,EAAGsM,EAAwBH,gBAAqB,MAAO,CAAE,MAAOK,CAAW,EAAEF,CAAK,EAAI,KAAMI,CAAO,CACjV,CACA,IAAIE,GAAsCT,EAAoB,cAACC,GAAuB,IAAI,EACtFS,GAAsB,cAAcC,WAAiB,CACvD,YAAYC,EAAO,CACjB,MAAMA,CAAK,EACX,KAAK,MAAQ,CACX,SAAUA,EAAM,SAChB,aAAcA,EAAM,aACpB,MAAOA,EAAM,KACnB,CACG,CACD,OAAO,yBAAyBlL,EAAO,CACrC,MAAO,CAAE,MAAAA,CAAK,CACf,CACD,OAAO,yBAAyBkL,EAAOvM,EAAO,CAC5C,OAAIA,EAAM,WAAauM,EAAM,UAAYvM,EAAM,eAAiB,QAAUuM,EAAM,eAAiB,OACxF,CACL,MAAOA,EAAM,MACb,SAAUA,EAAM,SAChB,aAAcA,EAAM,YAC5B,EAEW,CACL,MAAOA,EAAM,QAAU,OAASA,EAAM,MAAQvM,EAAM,MACpD,SAAUA,EAAM,SAChB,aAAcuM,EAAM,cAAgBvM,EAAM,YAChD,CACG,CACD,kBAAkBqB,EAAOmL,EAAW,CAC9B,KAAK,MAAM,SACb,KAAK,MAAM,QAAQnL,EAAOmL,CAAS,CAOtC,CACD,QAAS,CACP,OAAO,KAAK,MAAM,QAAU,OAAyBb,gBAAqB3C,GAAa,SAAU,CAAE,MAAO,KAAK,MAAM,YAAc,EAAkB2C,EAAoB,cACvK1C,GAAkB,SAClB,CACE,MAAO,KAAK,MAAM,MAClB,SAAU,KAAK,MAAM,SACtB,CACP,CAAK,EAAI,KAAK,MAAM,QACjB,CACH,EACA,SAASwD,GAAc,CAAE,aAAAC,EAAc,MAAArH,EAAO,SAAAsH,CAAQ,EAAI,CACxD,IAAIzC,EAAoBZ,aAAkBd,EAAiB,EAC3D,OAAI0B,GAAqBA,EAAkB,QAAUA,EAAkB,gBAAkB7E,EAAM,MAAM,cAAgBA,EAAM,MAAM,iBAC/H6E,EAAkB,cAAc,2BAA6B7E,EAAM,MAAM,IAEpDsG,gBAAqB3C,GAAa,SAAU,CAAE,MAAO0D,CAAY,EAAIC,CAAQ,CACtG,CACA,SAASjB,GAAelJ,EAASwI,EAAgB,GAAIH,EAAkB,KAAMC,EAAmB,KAAMC,EAAS,KAAM,CACnH,GAAIvI,GAAW,KAAM,CACnB,GAAI,CAACqI,EACH,OAAO,KAET,GAAIA,EAAgB,OAClBrI,EAAUqI,EAAgB,gBACjBG,EAAc,SAAW,GAAK,CAACH,EAAgB,aAAeA,EAAgB,QAAQ,OAAS,EACxGrI,EAAUqI,EAAgB,YAE1B,QAAO,IAEV,CACD,IAAIY,EAAkBjJ,EAClBoK,EAAS/B,GAAiB,OAC9B,GAAI+B,GAAU,KAAM,CAClB,IAAIC,EAAapB,EAAgB,UAC9BpN,GAAMA,EAAE,MAAM,IAAMuO,IAASvO,EAAE,MAAM,EAAE,IAAM,MACpD,EACIiB,GACEuN,GAAc,EACd,4DAA4D,OAAO,KACjED,CACR,EAAQ,KAAK,GAAG,CAAC,EACjB,EACInB,EAAkBA,EAAgB,MAChC,EACA,KAAK,IAAIA,EAAgB,OAAQoB,EAAa,CAAC,CACrD,CACG,CACD,IAAIC,EAAiB,GACjBC,EAAgB,GACpB,GAAIlC,EACF,QAASpI,EAAI,EAAGA,EAAIgJ,EAAgB,OAAQhJ,IAAK,CAC/C,IAAI4C,EAAQoG,EAAgBhJ,CAAC,EAI7B,IAHI4C,EAAM,MAAM,iBAAmBA,EAAM,MAAM,0BAC7C0H,EAAgBtK,GAEd4C,EAAM,MAAM,GAAI,CAClB,GAAI,CAAE,WAAA2H,EAAY,OAAQC,CAAO,EAAKpC,EAClCqC,EAAmB7H,EAAM,MAAM,QAAU,CAAC2H,EAAW,eAAe3H,EAAM,MAAM,EAAE,IAAM,CAAC4H,GAAWA,EAAQ5H,EAAM,MAAM,EAAE,IAAM,QACpI,GAAIA,EAAM,MAAM,MAAQ6H,EAAkB,CACxCJ,EAAiB,GACbC,GAAiB,EACnBtB,EAAkBA,EAAgB,MAAM,EAAGsB,EAAgB,CAAC,EAE5DtB,EAAkB,CAACA,EAAgB,CAAC,CAAC,EAEvC,KACD,CACF,CACF,CAEH,IAAI0B,EAAUtC,GAAmBC,EAAmB,CAACzJ,EAAOmL,IAAc,CACxE1B,EAAiBzJ,EAAO,CACtB,SAAUwJ,EAAgB,SAC1B,OAAQA,EAAgB,UAAU,CAAC,GAAG,QAAU,CAAE,EAClD,UAAA2B,CACN,CAAK,CACF,EAAG,OACJ,OAAOf,EAAgB,YACrB,CAAC2B,EAAQ/H,EAAOvF,IAAU,CACxB,IAAIuB,EACAgM,EAA8B,GAC9BC,EAAe,KACfC,EAAyB,KACzB1C,IACFxJ,EAAQuL,GAAUvH,EAAM,MAAM,GAAKuH,EAAOvH,EAAM,MAAM,EAAE,EAAI,OAC5DiI,EAAejI,EAAM,MAAM,cAAgB+G,GACvCU,IACEC,EAAgB,GAAKjN,IAAU,GACjCuL,GACE,iBACA,GACA,0EACd,EACYgC,EAA8B,GAC9BE,EAAyB,MAChBR,IAAkBjN,IAC3BuN,EAA8B,GAC9BE,EAAyBlI,EAAM,MAAM,wBAA0B,QAIrE,IAAImI,EAAWxC,EAAc,OAAOS,EAAgB,MAAM,EAAG3L,EAAQ,CAAC,CAAC,EACnE2N,EAAc,IAAM,CACtB,IAAId,EACJ,OAAItL,EACFsL,EAAWW,EACFD,EACTV,EAAWY,EACFlI,EAAM,MAAM,UACrBsH,EAA2BhB,EAAoB,cAACtG,EAAM,MAAM,UAAW,IAAI,EAClEA,EAAM,MAAM,QACrBsH,EAAWtH,EAAM,MAAM,QAEvBsH,EAAWS,EAEUzB,EAAoB,cACzCc,GACA,CACE,MAAApH,EACA,aAAc,CACZ,OAAA+H,EACA,QAASI,EACT,YAAa3C,GAAmB,IACjC,EACD,SAAA8B,CACD,CACX,CACA,EACM,OAAO9B,IAAoBxF,EAAM,MAAM,eAAiBA,EAAM,MAAM,cAAgBvF,IAAU,GAAqB6L,EAAoB,cACrIU,GACA,CACE,SAAUxB,EAAgB,SAC1B,aAAcA,EAAgB,aAC9B,UAAWyC,EACX,MAAAjM,EACA,SAAUoM,EAAa,EACvB,aAAc,CAAE,OAAQ,KAAM,QAASD,EAAU,YAAa,EAAM,EACpE,QAAAL,CACD,CACF,EAAGM,EAAW,CAChB,EACD,IACJ,CACA,CACA,SAASC,GAA0BC,EAAU,CAC3C,MAAO,GAAGA,CAAQ,oGACpB,CACA,SAASC,GAAqBD,EAAU,CACtC,IAAIE,EAAMvE,aAAkBd,EAAiB,EAC7C,OAAAlJ,GAAUuO,EAAKH,GAA0BC,CAAQ,CAAC,EAC3CE,CACT,CACA,SAASC,GAAmBH,EAAU,CACpC,IAAI3N,EAAQsJ,aAAkBZ,EAAsB,EACpD,OAAApJ,GAAUU,EAAO0N,GAA0BC,CAAQ,CAAC,EAC7C3N,CACT,CACA,SAAS+N,GAAgBJ,EAAU,CACjC,IAAI1K,EAAQqG,aAAkBN,EAAY,EAC1C,OAAA1J,GAAU2D,EAAOyK,GAA0BC,CAAQ,CAAC,EAC7C1K,CACT,CACA,SAAS+K,GAAkBL,EAAU,CACnC,IAAI1K,EAAQ8K,GAAgBJ,CAAQ,EAChCM,EAAYhL,EAAM,QAAQA,EAAM,QAAQ,OAAS,CAAC,EACtD,OAAA3D,GACE2O,EAAU,MAAM,GAChB,GAAGN,CAAQ,wDACf,EACSM,EAAU,MAAM,EACzB,CACA,SAASC,IAAa,CACpB,OAAOF,GAAkB,aAC3B,CAuCA,SAASnC,IAAgB,CACvB,IAAIxK,EAAQiI,aAAkBL,EAAiB,EAC3CjJ,EAAQ8N,GAAmB,iBAC3BK,EAAUH,GAAkB,iBAChC,OAAI3M,IAAU,OACLA,EAEFrB,EAAM,SAASmO,CAAO,CAC/B,CAiDA,SAASnE,IAAoB,CAC3B,GAAI,CAAE,OAAAoE,CAAM,EAAKR,GAAqB,aAAa,EAC/CS,EAAKL,GAAkB,eACvB5D,EAAYC,SAAc,EAAK,EACnCV,UAA0B,IAAM,CAC9BS,EAAU,QAAU,EACxB,CAAG,EACcE,EAAkB,YAC/B,MAAOnL,EAAIT,EAAU,KAAO,CAC1Be,GAAQ2K,EAAU,QAASV,EAAqB,EAC3CU,EAAU,UACX,OAAOjL,GAAO,SAChBiP,EAAO,SAASjP,CAAE,EAElB,MAAMiP,EAAO,SAASjP,EAAI,CAAE,YAAakP,EAAI,GAAG3P,CAAO,CAAE,EAE5D,EACD,CAAC0P,EAAQC,CAAE,CACf,CAEA,CACA,IAAIC,GAAgB,GACpB,SAASjD,GAAYpL,EAAKP,EAAMF,EAAS,CACnC,CAACE,GAAQ,CAAC4O,GAAcrO,CAAG,IAC7BqO,GAAcrO,CAAG,EAAI,GACrBR,GAAQ,GAAOD,CAAO,EAE1B,CA6ayB+O,EAAW,KAACC,EAAU,EAC/C,SAASA,GAAW,CAClB,OAAAzM,EACA,OAAAgJ,EACA,MAAA/K,EACA,iBAAA8K,CACF,EAAG,CACD,OAAOF,GAAc7I,EAAQ,OAAQ/B,EAAO8K,EAAkBC,CAAM,CACtE,CAyEA,SAAS0D,EAAMlC,EAAO,CACpBjN,GACE,GACA,sIACJ,CACA,CACA,SAASoP,GAAO,CACd,SAAUC,EAAe,IACzB,SAAAhC,EAAW,KACX,SAAUiC,EACV,eAAAC,EAAiB,MACjB,UAAAxF,EACA,OAAQyF,EAAa,EACvB,EAAG,CACDxP,GACE,CAAC8J,GAAoB,EACrB,wGACJ,EACE,IAAInH,EAAW0M,EAAa,QAAQ,OAAQ,GAAG,EAC3CI,EAAoBC,EAAc,QACpC,KAAO,CACL,SAAA/M,EACA,UAAAoH,EACA,OAAQyF,EACR,OAAQ,CAAE,CAChB,GACI,CAAC7M,EAAUoH,EAAWyF,CAAU,CACpC,EACM,OAAOF,GAAiB,WAC1BA,EAAe1O,GAAU0O,CAAY,GAEvC,GAAI,CACF,SAAA9P,EAAW,IACX,OAAAC,EAAS,GACT,KAAAC,EAAO,GACP,MAAAgB,EAAQ,KACR,IAAAC,EAAM,SACP,EAAG2O,EACAK,EAAkBD,UAAe,IAAM,CACzC,IAAIE,EAAmB9M,GAActD,EAAUmD,CAAQ,EACvD,OAAIiN,GAAoB,KACf,KAEF,CACL,SAAU,CACR,SAAUA,EACV,OAAAnQ,EACA,KAAAC,EACA,MAAAgB,EACA,IAAAC,CACD,EACD,eAAA4O,CACN,CACA,EAAK,CAAC5M,EAAUnD,EAAUC,EAAQC,EAAMgB,EAAOC,EAAK4O,CAAc,CAAC,EAKjE,OAJApP,GACEwP,GAAmB,KACnB,qBAAqBhN,CAAQ,oCAAoCnD,CAAQ,GAAGC,CAAM,GAAGC,CAAI,uFAC7F,EACMiQ,GAAmB,KACd,KAEcE,gBAAqBrG,GAAkB,SAAU,CAAE,MAAOiG,CAAiB,EAAoBI,gBAAqBpG,GAAgB,SAAU,CAAE,SAAA4D,EAAU,MAAOsC,CAAe,CAAE,CAAC,CAC5M,CACA,SAASG,GAAO,CACd,SAAAzC,EACA,SAAA9M,CACF,EAAG,CACD,OAAO8K,GAAU0E,GAAyB1C,CAAQ,EAAG9M,CAAQ,CAC/D,CAkGA,SAASwP,GAAyB1C,EAAU7J,EAAa,GAAI,CAC3D,IAAIf,EAAS,GACbuN,kBAAgB,QAAQ3C,EAAU,CAAC4C,EAASzP,IAAU,CACpD,GAAI,CAAC0P,iBAAsBD,CAAO,EAChC,OAEF,IAAIE,EAAW,CAAC,GAAG3M,EAAYhD,CAAK,EACpC,GAAIyP,EAAQ,OAASG,WAAiB,CACpC3N,EAAO,KAAK,MACVA,EACAsN,GAAyBE,EAAQ,MAAM,SAAUE,CAAQ,CACjE,EACM,MACD,CACDnQ,GACEiQ,EAAQ,OAASd,EACjB,IAAI,OAAOc,EAAQ,MAAS,SAAWA,EAAQ,KAAOA,EAAQ,KAAK,IAAI,wGAC7E,EACIjQ,GACE,CAACiQ,EAAQ,MAAM,OAAS,CAACA,EAAQ,MAAM,SACvC,0CACN,EACI,IAAItM,EAAQ,CACV,GAAIsM,EAAQ,MAAM,IAAME,EAAS,KAAK,GAAG,EACzC,cAAeF,EAAQ,MAAM,cAC7B,QAASA,EAAQ,MAAM,QACvB,UAAWA,EAAQ,MAAM,UACzB,MAAOA,EAAQ,MAAM,MACrB,KAAMA,EAAQ,MAAM,KACpB,WAAYA,EAAQ,MAAM,WAC1B,OAAQA,EAAQ,MAAM,OACtB,OAAQA,EAAQ,MAAM,OACtB,uBAAwBA,EAAQ,MAAM,uBACtC,gBAAiBA,EAAQ,MAAM,gBAC/B,aAAcA,EAAQ,MAAM,aAC5B,cAAeA,EAAQ,MAAM,cAC7B,iBAAkBA,EAAQ,MAAM,mBAAqB,IAAQA,EAAQ,MAAM,eAAiB,MAAQA,EAAQ,MAAM,cAAgB,KAClI,iBAAkBA,EAAQ,MAAM,iBAChC,OAAQA,EAAQ,MAAM,OACtB,KAAMA,EAAQ,MAAM,IAC1B,EACQA,EAAQ,MAAM,WAChBtM,EAAM,SAAWoM,GACfE,EAAQ,MAAM,SACdE,CACR,GAEI1N,EAAO,KAAKkB,CAAK,CACrB,CAAG,EACMlB,CACT,CAkEA,IAAI4N,GAAgB,MAChBC,GAAiB,oCACrB,SAASC,GAAcC,EAAQ,CAC7B,OAAOA,GAAU,MAAQ,OAAOA,EAAO,SAAY,QACrD,CACA,SAASC,GAAgBD,EAAQ,CAC/B,OAAOD,GAAcC,CAAM,GAAKA,EAAO,QAAQ,YAAa,IAAK,QACnE,CACA,SAASE,GAAcF,EAAQ,CAC7B,OAAOD,GAAcC,CAAM,GAAKA,EAAO,QAAQ,YAAa,IAAK,MACnE,CACA,SAASG,GAAeH,EAAQ,CAC9B,OAAOD,GAAcC,CAAM,GAAKA,EAAO,QAAQ,YAAa,IAAK,OACnE,CACA,SAASI,GAAgBC,EAAO,CAC9B,MAAO,CAAC,EAAEA,EAAM,SAAWA,EAAM,QAAUA,EAAM,SAAWA,EAAM,SACpE,CACA,SAASC,GAAuBD,EAAOE,EAAQ,CAC7C,OAAOF,EAAM,SAAW,IACvB,CAACE,GAAUA,IAAW,UACvB,CAACH,GAAgBC,CAAK,CACxB,CACA,SAASG,GAAmBC,EAAO,GAAI,CACrC,OAAO,IAAI,gBACT,OAAOA,GAAS,UAAY,MAAM,QAAQA,CAAI,GAAKA,aAAgB,gBAAkBA,EAAO,OAAO,KAAKA,CAAI,EAAE,OAAO,CAACzK,EAAO7F,IAAQ,CACnI,IAAIV,EAAQgR,EAAKtQ,CAAG,EACpB,OAAO6F,EAAM,OACX,MAAM,QAAQvG,CAAK,EAAIA,EAAM,IAAK8G,GAAM,CAACpG,EAAKoG,CAAC,CAAC,EAAI,CAAC,CAACpG,EAAKV,CAAK,CAAC,CACzE,CACK,EAAE,EAAE,CACT,CACA,CACA,SAASiR,GAA2BC,EAAgBC,EAAqB,CACvE,IAAIC,EAAeL,GAAmBG,CAAc,EACpD,OAAIC,GACFA,EAAoB,QAAQ,CAACtK,EAAGnG,IAAQ,CACjC0Q,EAAa,IAAI1Q,CAAG,GACvByQ,EAAoB,OAAOzQ,CAAG,EAAE,QAASV,GAAU,CACjDoR,EAAa,OAAO1Q,EAAKV,CAAK,CACxC,CAAS,CAET,CAAK,EAEIoR,CACT,CACA,IAAIC,GAA6B,KACjC,SAASC,IAA+B,CACtC,GAAID,KAA+B,KACjC,GAAI,CACF,IAAI,SACF,SAAS,cAAc,MAAM,EAE7B,CACR,EACMA,GAA6B,EAC9B,MAAW,CACVA,GAA6B,EAC9B,CAEH,OAAOA,EACT,CACA,IAAIE,GAAwC,IAAI,IAAI,CAClD,oCACA,sBACA,YACF,CAAC,EACD,SAASC,GAAeC,EAAS,CAC/B,OAAIA,GAAW,MAAQ,CAACF,GAAsB,IAAIE,CAAO,GACvDvR,GACE,GACA,IAAIuR,CAAO,uFAAuFpB,EAAc,GACtH,EACW,MAEFoB,CACT,CACA,SAASC,GAAsBZ,EAAQpO,EAAU,CAC/C,IAAIiP,EACAvQ,EACAqQ,EACAG,EACAC,EACJ,GAAIpB,GAAcK,CAAM,EAAG,CACzB,IAAIgB,EAAOhB,EAAO,aAAa,QAAQ,EACvC1P,EAAS0Q,EAAOjP,GAAciP,EAAMpP,CAAQ,EAAI,KAChDiP,EAASb,EAAO,aAAa,QAAQ,GAAKV,GAC1CqB,EAAUD,GAAeV,EAAO,aAAa,SAAS,CAAC,GAAKT,GAC5DuB,EAAW,IAAI,SAASd,CAAM,CAC/B,SAAUN,GAAgBM,CAAM,GAAKJ,GAAeI,CAAM,IAAMA,EAAO,OAAS,UAAYA,EAAO,OAAS,SAAU,CACrH,IAAIiB,EAAOjB,EAAO,KAClB,GAAIiB,GAAQ,KACV,MAAM,IAAI,MACR,oEACR,EAEI,IAAID,EAAOhB,EAAO,aAAa,YAAY,GAAKiB,EAAK,aAAa,QAAQ,EAK1E,GAJA3Q,EAAS0Q,EAAOjP,GAAciP,EAAMpP,CAAQ,EAAI,KAChDiP,EAASb,EAAO,aAAa,YAAY,GAAKiB,EAAK,aAAa,QAAQ,GAAK3B,GAC7EqB,EAAUD,GAAeV,EAAO,aAAa,aAAa,CAAC,GAAKU,GAAeO,EAAK,aAAa,SAAS,CAAC,GAAK1B,GAChHuB,EAAW,IAAI,SAASG,EAAMjB,CAAM,EAChC,CAACQ,GAA4B,EAAI,CACnC,GAAI,CAAE,KAAAU,EAAM,KAAAC,EAAM,MAAAjS,CAAK,EAAK8Q,EAC5B,GAAImB,IAAS,QAAS,CACpB,IAAIC,EAASF,EAAO,GAAGA,CAAI,IAAM,GACjCJ,EAAS,OAAO,GAAGM,CAAM,IAAK,GAAG,EACjCN,EAAS,OAAO,GAAGM,CAAM,IAAK,GAAG,CAClC,MAAUF,GACTJ,EAAS,OAAOI,EAAMhS,CAAK,CAE9B,CACL,KAAS,IAAIsQ,GAAcQ,CAAM,EAC7B,MAAM,IAAI,MACR,oFACN,EAEIa,EAASvB,GACThP,EAAS,KACTqQ,EAAUpB,GACVwB,EAAOf,EAET,OAAIc,GAAYH,IAAY,eAC1BI,EAAOD,EACPA,EAAW,QAEN,CAAE,OAAAxQ,EAAQ,OAAQuQ,EAAO,YAAW,EAAI,QAAAF,EAAS,SAAAG,EAAU,KAAAC,EACpE,CAqNwB,OAAO,oBAAoB,OAAO,SAAS,EAAE,KAAM,EAAC,KAAK,IAAI,EA6erF,SAASM,GAAWnS,EAAOC,EAAS,CAClC,GAAID,IAAU,IAASA,IAAU,MAAQ,OAAOA,EAAU,IACxD,MAAM,IAAI,MAAMC,CAAO,CAE3B,CA0SA,SAASmS,GAAeC,EAAQ3P,EAAU4P,EAAW,CACnD,IAAIzQ,EAAM,OAAOwQ,GAAW,SAAW,IAAI,IACzCA,EAGA,OAAO,OAAW,IAAc,wBAA0B,OAAO,SAAS,MAC3E,EAAGA,EACJ,OAAIxQ,EAAI,WAAa,IACnBA,EAAI,SAAW,SAASyQ,CAAS,GACxB5P,GAAYG,GAAchB,EAAI,SAAUa,CAAQ,IAAM,IAC/Db,EAAI,SAAW,GAAGa,EAAS,QAAQ,MAAO,EAAE,CAAC,UAAU4P,CAAS,GAEhEzQ,EAAI,SAAW,GAAGA,EAAI,SAAS,QAAQ,MAAO,EAAE,CAAC,IAAIyQ,CAAS,GAEzDzQ,CACT,CAoKA,eAAe0Q,GAAgB7O,EAAO8O,EAAmB,CACvD,GAAI9O,EAAM,MAAM8O,EACd,OAAOA,EAAkB9O,EAAM,EAAE,EAEnC,GAAI,CACF,IAAI+O,EAAc,MAAMC,EAAA,WAGtBhP,EAAM,QACR,IACA,OAAA8O,EAAkB9O,EAAM,EAAE,EAAI+O,EACvBA,CACR,MAAe,CAKV,cAAO,sBAAwB,OAAO,qBAAqB,UAI/D,OAAO,SAAS,SACT,IAAI,QAAQ,IAAM,CAC7B,CAAK,CACF,CACH,CAuEA,SAASE,GAAqBpC,EAAQ,CACpC,OAAOA,GAAU,MAAQ,OAAOA,EAAO,MAAS,QAClD,CACA,SAASqC,GAAqBrC,EAAQ,CACpC,OAAIA,GAAU,KACL,GAELA,EAAO,MAAQ,KACVA,EAAO,MAAQ,WAAa,OAAOA,EAAO,aAAgB,UAAY,OAAOA,EAAO,YAAe,SAErG,OAAOA,EAAO,KAAQ,UAAY,OAAOA,EAAO,MAAS,QAClE,CACA,eAAesC,GAAsB5P,EAAS6P,EAAUC,EAAc,CACpE,IAAIC,EAAQ,MAAM,QAAQ,IACxB/P,EAAQ,IAAI,MAAO6C,GAAU,CAC3B,IAAIpC,EAAQoP,EAAS,OAAOhN,EAAM,MAAM,EAAE,EAC1C,GAAIpC,EAAO,CACT,IAAIuP,EAAM,MAAMV,GAAgB7O,EAAOqP,CAAY,EACnD,OAAOE,EAAI,MAAQA,EAAI,MAAK,EAAK,EAClC,CACD,MAAO,EACb,CAAK,CACL,EACE,OAAOC,GACLF,EAAM,KAAK,CAAC,EAAE,OAAOJ,EAAoB,EAAE,OAAQO,GAASA,EAAK,MAAQ,cAAgBA,EAAK,MAAQ,SAAS,EAAE,IAC9GA,GAASA,EAAK,MAAQ,aAAe,CAAE,GAAGA,EAAM,IAAK,WAAY,GAAI,OAAS,EAAG,CAAE,GAAGA,EAAM,IAAK,UAAY,CAC/G,CACL,CACA,CACA,SAASC,GAAsBC,EAAMC,EAAaC,EAAgBT,EAAUxS,EAAUkT,EAAM,CAC1F,IAAIC,EAAQ,CAAC3N,EAAOvF,IACbgT,EAAehT,CAAK,EAClBuF,EAAM,MAAM,KAAOyN,EAAehT,CAAK,EAAE,MAAM,GADnB,GAGjCmT,EAAmB,CAAC5N,EAAOvF,IAG3BgT,EAAehT,CAAK,EAAE,WAAauF,EAAM,UAEzCyN,EAAehT,CAAK,EAAE,MAAM,MAAM,SAAS,GAAG,GAAKgT,EAAehT,CAAK,EAAE,OAAO,GAAG,IAAMuF,EAAM,OAAO,GAAG,EAG7G,OAAI0N,IAAS,SACJF,EAAY,OACjB,CAACxN,EAAOvF,IAAUkT,EAAM3N,EAAOvF,CAAK,GAAKmT,EAAiB5N,EAAOvF,CAAK,CAC5E,EAEMiT,IAAS,OACJF,EAAY,OAAO,CAACxN,EAAOvF,IAAU,CAC1C,IAAIoT,EAAgBb,EAAS,OAAOhN,EAAM,MAAM,EAAE,EAClD,GAAI,CAAC6N,GAAiB,CAACA,EAAc,UACnC,MAAO,GAET,GAAIF,EAAM3N,EAAOvF,CAAK,GAAKmT,EAAiB5N,EAAOvF,CAAK,EACtD,MAAO,GAET,GAAIuF,EAAM,MAAM,iBAAkB,CAChC,IAAI8N,EAAc9N,EAAM,MAAM,iBAAiB,CAC7C,WAAY,IAAI,IACdxF,EAAS,SAAWA,EAAS,OAASA,EAAS,KAC/C,OAAO,MACR,EACD,cAAeiT,EAAe,CAAC,GAAG,QAAU,CAAE,EAC9C,QAAS,IAAI,IAAIF,EAAM,OAAO,MAAM,EACpC,WAAYvN,EAAM,OAClB,wBAAyB,EACnC,CAAS,EACD,GAAI,OAAO8N,GAAgB,UACzB,OAAOA,CAEV,CACD,MAAO,EACb,CAAK,EAEI,EACT,CACA,SAASC,GAAmB5Q,EAAS6P,EAAU,CAAE,uBAAAgB,CAAsB,EAAK,GAAI,CAC9E,OAAOC,GACL9Q,EAAQ,IAAK6C,GAAU,CACrB,IAAIpC,EAAQoP,EAAS,OAAOhN,EAAM,MAAM,EAAE,EAC1C,GAAI,CAACpC,EAAO,MAAO,GACnB,IAAIsQ,EAAQ,CAACtQ,EAAM,MAAM,EACzB,OAAIA,EAAM,qBACRsQ,EAAQA,EAAM,OAAOtQ,EAAM,kBAAkB,GAE3CA,EAAM,qBACRsQ,EAAQA,EAAM,OAAOtQ,EAAM,kBAAkB,GAE3CoQ,GAA0BpQ,EAAM,wBAClCsQ,EAAQA,EAAM,OAAOtQ,EAAM,qBAAqB,GAE9CA,EAAM,UACRsQ,EAAQA,EAAM,OAAOtQ,EAAM,OAAO,GAE7BsQ,CACb,CAAK,EAAE,KAAK,CAAC,CACb,CACA,CACA,SAASD,GAAYC,EAAO,CAC1B,MAAO,CAAC,GAAG,IAAI,IAAIA,CAAK,CAAC,CAC3B,CACA,SAASC,GAASC,EAAK,CACrB,IAAIC,EAAS,GACTC,EAAO,OAAO,KAAKF,CAAG,EAAE,KAAI,EAChC,QAASxT,KAAO0T,EACdD,EAAOzT,CAAG,EAAIwT,EAAIxT,CAAG,EAEvB,OAAOyT,CACT,CACA,SAASjB,GAAsBmB,EAAaC,EAAU,CACpD,IAAIC,EAAsB,IAAI,IAC1BC,EAAc,IAAI,IAAIF,CAAQ,EAClC,OAAOD,EAAY,OAAO,CAACI,EAASC,IAAe,CAEjD,GAD2BJ,GAAY,CAAC3B,GAAqB+B,CAAU,GAAKA,EAAW,KAAO,UAAYA,EAAW,MAAQF,EAAY,IAAIE,EAAW,IAAI,EAE1J,OAAOD,EAET,IAAI/T,EAAM,KAAK,UAAUuT,GAASS,CAAU,CAAC,EAC7C,OAAKH,EAAI,IAAI7T,CAAG,IACd6T,EAAI,IAAI7T,CAAG,EACX+T,EAAQ,KAAK,CAAE,IAAA/T,EAAK,KAAMgU,CAAY,IAEjCD,CACR,EAAE,CAAE,EACP,CA0oBA,SAASE,IAAwB,CAC/B,IAAIC,EAAUC,aAAkB5L,EAAiB,EACjD,OAAAkJ,GACEyC,EACA,4EACJ,EACSA,CACT,CACA,SAASE,IAA4B,CACnC,IAAIF,EAAUC,aAAkB1L,EAAsB,EACtD,OAAAgJ,GACEyC,EACA,iFACJ,EACSA,CACT,CACA,IAAIG,GAAmBC,gBAAqB,MAAM,EAClDD,GAAiB,YAAc,mBAC/B,SAASE,IAAsB,CAC7B,IAAIL,EAAUC,aAAkBE,EAAgB,EAChD,OAAA5C,GACEyC,EACA,gEACJ,EACSA,CACT,CACA,SAASM,GAAoBC,EAAUC,EAAmB,CACxD,IAAIC,EAAmBR,aAAkBE,EAAgB,EACrD,CAACO,EAAeC,CAAgB,EAAIC,EAAe,SAAC,EAAK,EACzD,CAACC,EAAgBC,CAAiB,EAAIF,EAAe,SAAC,EAAK,EAC3D,CAAE,QAAAG,EAAS,OAAAC,EAAQ,aAAAC,EAAc,aAAAC,EAAc,aAAAC,CAAc,EAAGX,EAChEY,EAAMC,SAAc,IAAI,EAC5BC,YAAiB,IAAM,CAIrB,GAHIf,IAAa,UACfO,EAAkB,EAAI,EAEpBP,IAAa,WAAY,CAC3B,IAAIgB,EAAYC,GAAY,CAC1BA,EAAQ,QAASC,GAAU,CACzBX,EAAkBW,EAAM,cAAc,CAChD,CAAS,CACT,EACUC,EAAW,IAAI,qBAAqBH,EAAU,CAAE,UAAW,EAAG,CAAE,EACpE,OAAIH,EAAI,SAASM,EAAS,QAAQN,EAAI,OAAO,EACtC,IAAM,CACXM,EAAS,WAAU,CAC3B,CACK,CACL,EAAK,CAACnB,CAAQ,CAAC,EACbe,YAAiB,IAAM,CACrB,GAAIZ,EAAe,CACjB,IAAIxG,EAAK,WAAW,IAAM,CACxB4G,EAAkB,EAAI,CACvB,EAAE,GAAG,EACN,MAAO,IAAM,CACX,aAAa5G,CAAE,CACvB,CACK,CACL,EAAK,CAACwG,CAAa,CAAC,EAClB,IAAIiB,EAAY,IAAM,CACpBhB,EAAiB,EAAI,CACzB,EACMiB,EAAe,IAAM,CACvBjB,EAAiB,EAAK,EACtBG,EAAkB,EAAK,CAC3B,EACE,OAAKL,EAGDF,IAAa,SACR,CAACM,EAAgBO,EAAK,EAAE,EAE1B,CACLP,EACAO,EACA,CACE,QAASS,GAAqBd,EAASY,CAAS,EAChD,OAAQE,GAAqBb,EAAQY,CAAY,EACjD,aAAcC,GAAqBZ,EAAcU,CAAS,EAC1D,aAAcE,GAAqBX,EAAcU,CAAY,EAC7D,aAAcC,GAAqBV,EAAcQ,CAAS,CAC3D,CACL,EAfW,CAAC,GAAOP,EAAK,EAAE,CAgB1B,CACA,SAASS,GAAqBC,EAAcC,EAAY,CACtD,OAAQ/F,GAAU,CAChB8F,GAAgBA,EAAa9F,CAAK,EAC7BA,EAAM,kBACT+F,EAAW/F,CAAK,CAEtB,CACA,CAsCA,SAASgG,GAAkB,CAAE,KAAAvD,EAAM,GAAGwD,GAAa,CACjD,GAAI,CAAE,OAAAhI,GAAW8F,KACb1R,EAAU6T,EAAc,QAC1B,IAAMvU,GAAYsM,EAAO,OAAQwE,EAAMxE,EAAO,QAAQ,EACtD,CAACA,EAAO,OAAQwE,EAAMxE,EAAO,QAAQ,CACzC,EACE,OAAK5L,EAGkB8T,gBAAqBC,GAAuB,CAAE,KAAA3D,EAAM,QAAApQ,EAAS,GAAG4T,CAAS,CAAE,EAFzF,IAGX,CACA,SAASI,GAAsBhU,EAAS,CACtC,GAAI,CAAE,SAAA6P,EAAU,aAAAC,CAAc,EAAGkC,GAAmB,EAChD,CAACiC,EAAoBC,CAAqB,EAAI3B,EAAe,SAAC,CAAE,GACpEU,mBAAiB,IAAM,CACrB,IAAIkB,EAAc,GAClB,OAAKvE,GAAsB5P,EAAS6P,EAAUC,CAAY,EAAE,KACzDC,GAAU,CACJoE,GACHD,EAAsBnE,CAAK,CAE9B,CACP,EACW,IAAM,CACXoE,EAAc,EACpB,CACG,EAAE,CAACnU,EAAS6P,EAAUC,CAAY,CAAC,EAC7BmE,CACT,CACA,SAASF,GAAsB,CAC7B,KAAA3D,EACA,QAASC,EACT,GAAGuD,CACL,EAAG,CACD,IAAIvW,EAAW4J,KACX,CAAE,SAAA4I,EAAU,aAAAC,CAAc,EAAGkC,GAAmB,EAChD,CAAE,SAAAvS,GAAaiS,KACf,CAAE,WAAAlH,EAAY,QAAAxK,CAAS,EAAG6R,GAAyB,EACnDuC,EAAoBP,EAAc,QACpC,IAAM1D,GACJC,EACAC,EACArQ,EACA6P,EACAxS,EACA,MACD,EACD,CAAC+S,EAAMC,EAAarQ,EAAS6P,EAAUxS,CAAQ,CACnD,EACMgX,EAAsBR,EAAc,QACtC,IAAM1D,GACJC,EACAC,EACArQ,EACA6P,EACAxS,EACA,QACD,EACD,CAAC+S,EAAMC,EAAarQ,EAAS6P,EAAUxS,CAAQ,CACnD,EACMiX,EAAYT,UAAe,IAAM,CACnC,GAAIzD,IAAS/S,EAAS,SAAWA,EAAS,OAASA,EAAS,KAC1D,MAAO,GAET,IAAIkX,EAA+B,IAAI,IACnCC,EAAmB,GAcvB,GAbAnE,EAAY,QAASxU,GAAM,CACzB,IAAI6U,EAAgBb,EAAS,OAAOhU,EAAE,MAAM,EAAE,EAC1C,CAAC6U,GAAiB,CAACA,EAAc,YAGjC,CAAC0D,EAAkB,KAAMK,GAAOA,EAAG,MAAM,KAAO5Y,EAAE,MAAM,EAAE,GAAKA,EAAE,MAAM,MAAM2O,GAAcsF,EAAajU,EAAE,MAAM,EAAE,GAAG,kBAE9G6U,EAAc,gBADvB8D,EAAmB,GAInBD,EAAa,IAAI1Y,EAAE,MAAM,EAAE,EAEnC,CAAK,EACG0Y,EAAa,OAAS,EACxB,MAAO,GAET,IAAI3V,EAAMuQ,GAAeiB,EAAM3Q,EAAU,MAAM,EAC/C,OAAI+U,GAAoBD,EAAa,KAAO,GAC1C3V,EAAI,aAAa,IACf,UACAyR,EAAY,OAAQxU,GAAM0Y,EAAa,IAAI1Y,EAAE,MAAM,EAAE,CAAC,EAAE,IAAKA,GAAMA,EAAE,MAAM,EAAE,EAAE,KAAK,GAAG,CAC/F,EAEW,CAAC+C,EAAI,SAAWA,EAAI,MAAM,CACrC,EAAK,CACDa,EACA+K,EACAnN,EACAwS,EACAuE,EACA/D,EACAD,EACAN,CACJ,CAAG,EACG4E,EAAcb,EAAc,QAC9B,IAAMjD,GAAmByD,EAAqBxE,CAAQ,EACtD,CAACwE,EAAqBxE,CAAQ,CAClC,EACMoE,EAAqBD,GAAsBK,CAAmB,EAClE,OAAuBP,EAAoB,cAACa,EAAe,SAAE,KAAML,EAAU,IAAKjV,GAAyByU,gBAAqB,OAAQ,CAAE,IAAKzU,EAAM,IAAK,WAAY,GAAI,QAAS,KAAAA,EAAM,GAAGuU,EAAW,CAAC,EAAGc,EAAY,IAAKrV,GAAyByU,EAAoB,cAAC,OAAQ,CAAE,IAAKzU,EAAM,IAAK,gBAAiB,KAAAA,EAAM,GAAGuU,CAAW,EAAC,EAAGK,EAAmB,IAAI,CAAC,CAAE,IAAAxW,EAAK,KAAAyS,CAAM,IAGhW4D,gBAAqB,OAAQ,CAAE,IAAArW,EAAK,MAAOmW,EAAU,MAAO,GAAG1D,EAAM,CACtF,CAAC,CACJ,CA2QA,SAAS0E,MAAaC,EAAM,CAC1B,OAAQ9X,GAAU,CAChB8X,EAAK,QAAS9B,GAAQ,CAChB,OAAOA,GAAQ,WACjBA,EAAIhW,CAAK,EACAgW,GAAO,OAChBA,EAAI,QAAUhW,EAEtB,CAAK,CACL,CACA,CAqGA,IAAI+X,GAAY,OAAO,OAAW,KAAe,OAAO,OAAO,SAAa,KAAe,OAAO,OAAO,SAAS,cAAkB,IACpI,GAAI,CACEA,KACF,OAAO,qBACP,QAEJ,MAAY,CACZ,CA8EA,SAASC,GAAc,CACrB,SAAAtV,EACA,SAAA0K,EACA,OAAQ/N,CACV,EAAG,CACD,IAAI4Y,EAAaC,WACbD,EAAW,SAAW,OACxBA,EAAW,QAAU/Y,GAAqB,CAAE,OAAQG,EAAS,SAAU,EAAI,CAAE,GAE/E,IAAIqC,EAAUuW,EAAW,QACrB,CAACxX,EAAO0X,CAAY,EAAIC,WAAiB,CAC3C,OAAQ1W,EAAQ,OAChB,SAAUA,EAAQ,QACtB,CAAG,EACG2W,EAAWC,EAAmB,YAC/BC,GAAa,CACZC,kBAAwB,IAAML,EAAaI,CAAQ,CAAC,CACrD,EACD,CAACJ,CAAY,CACjB,EACEM,yBAAwB,IAAM/W,EAAQ,OAAO2W,CAAQ,EAAG,CAAC3W,EAAS2W,CAAQ,CAAC,EACpDK,EAAqB,cAC1CvJ,GACA,CACE,SAAAzM,EACA,SAAA0K,EACA,SAAU3M,EAAM,SAChB,eAAgBA,EAAM,OACtB,UAAWiB,CACZ,CACL,CACA,CAyDA,IAAIiX,GAAsB,gCACtBC,GAAOC,EAAkB,WAC3B,SAAqB,CACnB,QAAAC,EACA,SAAAC,EAAW,SACX,SAAA5D,EAAW,OACX,SAAAvL,EACA,eAAAoP,EACA,QAASjX,EACT,MAAAtB,EACA,OAAAqQ,EACA,GAAAlR,EACA,mBAAAqZ,EACA,eAAAC,EACA,GAAG7U,CACJ,EAAE8U,EAAc,CACf,GAAI,CAAE,SAAAzW,CAAQ,EAAK0W,EAAkB,WAAC7P,EAAiB,EACnDnH,EAAa,OAAOxC,GAAO,UAAY+Y,GAAoB,KAAK/Y,CAAE,EAClEyZ,EACAC,EAAa,GACjB,GAAI,OAAO1Z,GAAO,UAAYwC,IAC5BiX,EAAezZ,EACXmY,IACF,GAAI,CACF,IAAIwB,EAAa,IAAI,IAAI,OAAO,SAAS,IAAI,EACzCC,EAAY5Z,EAAG,WAAW,IAAI,EAAI,IAAI,IAAI2Z,EAAW,SAAW3Z,CAAE,EAAI,IAAI,IAAIA,CAAE,EAChFgB,EAAOiC,GAAc2W,EAAU,SAAU9W,CAAQ,EACjD8W,EAAU,SAAWD,EAAW,QAAU3Y,GAAQ,KACpDhB,EAAKgB,EAAO4Y,EAAU,OAASA,EAAU,KAEzCF,EAAa,EAEhB,MAAW,CACVpZ,GACE,GACA,aAAaN,CAAE,wGAC3B,CACS,CAGL,IAAI0C,EAAOqH,GAAQ/J,EAAI,CAAE,SAAAgK,CAAU,GAC/B,CAAC6L,EAAgBgE,EAAaC,CAAgB,EAAIxE,GACpDC,EACA9Q,CACN,EACQsV,EAAkBC,GAAoBha,EAAI,CAC5C,QAASmC,EACT,MAAAtB,EACA,OAAAqQ,EACA,mBAAAmI,EACA,SAAArP,EACA,eAAAsP,CACN,CAAK,EACD,SAASW,EAAYjJ,EAAO,CACtBkI,GAASA,EAAQlI,CAAK,EACrBA,EAAM,kBACT+I,EAAgB/I,CAAK,CAExB,CACD,IAAIuC,EAEcuF,EAAqB,cACnC,IACA,CACE,GAAGrU,EACH,GAAGqV,EACH,KAAML,GAAgB/W,EACtB,QAASgX,GAAcN,EAAiBF,EAAUe,EAClD,IAAKhC,GAAUsB,EAAcM,CAAW,EACxC,OAAA3I,EACA,gBAAiB,CAAC1O,GAAc2W,IAAa,SAAW,OAAS,MAClE,CACF,EAEH,OAAOtD,GAAkB,CAACrT,EAA6BsW,gBAAsBoB,WAAkB,KAAM3G,EAAsBuF,gBAAsB9B,GAAmB,CAAE,KAAMtU,CAAI,CAAE,CAAC,EAAI6Q,CACxL,CACH,EACAyF,GAAK,YAAc,OACnB,IAAImB,GAAUlB,EAAkB,WAC9B,SAAwB,CACtB,eAAgBmB,EAAkB,OAClC,cAAAtT,EAAgB,GAChB,UAAWuT,EAAgB,GAC3B,IAAArU,EAAM,GACN,MAAOsU,EACP,GAAAta,EACA,eAAAsZ,EACA,SAAA9L,EACA,GAAG/I,CACJ,EAAE2R,EAAK,CACN,IAAIpV,EAAOoJ,GAAgBpK,EAAI,CAAE,SAAUyE,EAAK,QAAQ,CAAE,EACtD/D,EAAW4J,KACXiQ,EAAcf,aAAmBjQ,EAAsB,EACvD,CAAE,UAAAW,EAAW,SAAApH,CAAU,EAAG0W,EAAkB,WAAC7P,EAAiB,EAC9D6Q,EAAkBD,GAAe,MAErCE,GAAuBzZ,CAAI,GAAKsY,IAAmB,GAC/C7R,EAAayC,EAAU,eAAiBA,EAAU,eAAelJ,CAAI,EAAE,SAAWA,EAAK,SACvFyH,EAAmB/H,EAAS,SAC5Bga,EAAuBH,GAAeA,EAAY,YAAcA,EAAY,WAAW,SAAWA,EAAY,WAAW,SAAS,SAAW,KAC5IzT,IACH2B,EAAmBA,EAAiB,cACpCiS,EAAuBA,EAAuBA,EAAqB,YAAW,EAAK,KACnFjT,EAAaA,EAAW,eAEtBiT,GAAwB5X,IAC1B4X,EAAuBzX,GAAcyX,EAAsB5X,CAAQ,GAAK4X,GAE1E,MAAMC,EAAmBlT,IAAe,KAAOA,EAAW,SAAS,GAAG,EAAIA,EAAW,OAAS,EAAIA,EAAW,OAC7G,IAAImT,EAAWnS,IAAqBhB,GAAc,CAACzB,GAAOyC,EAAiB,WAAWhB,CAAU,GAAKgB,EAAiB,OAAOkS,CAAgB,IAAM,IAC/IE,EAAYH,GAAwB,OAASA,IAAyBjT,GAAc,CAACzB,GAAO0U,EAAqB,WAAWjT,CAAU,GAAKiT,EAAqB,OAAOjT,EAAW,MAAM,IAAM,KAC9LqT,EAAc,CAChB,SAAAF,EACA,UAAAC,EACA,gBAAAL,CACN,EACQO,EAAcH,EAAWR,EAAkB,OAC3CY,EACA,OAAOX,GAAkB,WAC3BW,EAAYX,EAAcS,CAAW,EAErCE,EAAY,CACVX,EACAO,EAAW,SAAW,KACtBC,EAAY,UAAY,KACxBL,EAAkB,gBAAkB,IACrC,EAAC,OAAO,OAAO,EAAE,KAAK,GAAG,EAE5B,IAAIS,EAAQ,OAAOX,GAAc,WAAaA,EAAUQ,CAAW,EAAIR,EACvE,OAAuBxB,EAAqB,cAC1CE,GACA,CACE,GAAGvU,EACH,eAAgBsW,EAChB,UAAAC,EACA,IAAA5E,EACA,MAAA6E,EACA,GAAAjb,EACA,eAAAsZ,CACD,EACD,OAAO9L,GAAa,WAAaA,EAASsN,CAAW,EAAItN,CAC/D,CACG,CACH,EACA2M,GAAQ,YAAc,UACtB,IAAIe,GAAOjC,EAAkB,WAC3B,CAAC,CACC,SAAAE,EAAW,SACX,WAAAgC,EACA,SAAAC,EACA,eAAAhC,EACA,QAASjX,EACT,MAAAtB,EACA,OAAAkR,EAASvB,GACT,OAAAhP,EACA,SAAA6Z,EACA,SAAArR,EACA,mBAAAqP,EACA,eAAAC,EACA,GAAGlM,CACJ,EAAEmM,IAAiB,CAClB,IAAI+B,EAASC,KACTC,EAAaC,GAAcja,EAAQ,CAAE,SAAAwI,CAAU,GAC/C0R,EAAa3J,EAAO,YAAa,IAAK,MAAQ,MAAQ,OACtDvP,EAAa,OAAOhB,GAAW,UAAYuX,GAAoB,KAAKvX,CAAM,EAC1Ema,EAAiB3K,GAAU,CAE7B,GADAqK,GAAYA,EAASrK,CAAK,EACtBA,EAAM,iBAAkB,OAC5BA,EAAM,eAAc,EACpB,IAAI4K,EAAY5K,EAAM,YAAY,UAC9B6K,EAAeD,GAAW,aAAa,YAAY,GAAK7J,EAC5DuJ,EAAOM,GAAa5K,EAAM,cAAe,CACvC,WAAAmK,EACA,OAAQU,EACR,SAAAT,EACA,QAASjZ,EACT,MAAAtB,EACA,SAAAmJ,EACA,mBAAAqP,EACA,eAAAC,CACR,CAAO,CACP,EACI,OAAuBR,EAAqB,cAC1C,OACA,CACE,IAAKS,EACL,OAAQmC,EACR,OAAQF,EACR,SAAUpC,EAAiBiC,EAAWM,EACtC,GAAGvO,EACH,gBAAiB,CAAC5K,GAAc2W,IAAa,SAAW,OAAS,MAClE,CACP,CACG,CACH,EACA+B,GAAK,YAAc,OA2DnB,SAASY,GAA2BtN,EAAU,CAC5C,MAAO,GAAGA,CAAQ,oGACpB,CACA,SAASuN,GAAsBvN,EAAU,CACvC,IAAIE,EAAM8K,aAAmBnQ,EAAiB,EAC9C,OAAAlJ,GAAUuO,EAAKoN,GAA2BtN,CAAQ,CAAC,EAC5CE,CACT,CAMA,SAASsL,GAAoBha,EAAI,CAC/B,OAAAkR,EACA,QAAS8K,EACT,MAAAnb,EACA,mBAAAwY,EACA,SAAArP,EACA,eAAAsP,CACF,EAAI,GAAI,CACN,IAAI8B,EAAWzQ,KACXjK,EAAW4J,KACXtJ,EAAOoJ,GAAgBpK,EAAI,CAAE,SAAAgK,CAAU,GAC3C,OAAO0O,EAAmB,YACvB1H,GAAU,CACT,GAAIC,GAAuBD,EAAOE,CAAM,EAAG,CACzCF,EAAM,eAAc,EACpB,IAAI7O,EAAW6Z,IAAgB,OAASA,EAAc/b,GAAWS,CAAQ,IAAMT,GAAWe,CAAI,EAC9Foa,EAASpb,EAAI,CACX,QAASmC,EACT,MAAAtB,EACA,mBAAAwY,EACA,SAAArP,EACA,eAAAsP,CACV,CAAS,CACF,CACF,EACD,CACE5Y,EACA0a,EACApa,EACAgb,EACAnb,EACAqQ,EACAlR,EACAqZ,EACArP,EACAsP,CACD,CACL,CACA,CACA,SAAS2C,GAAgBC,EAAa,CACpC5b,GACE,OAAO,gBAAoB,IAC3B,yOACJ,EACE,IAAI6b,EAAyB7D,EAAc,OAACnH,GAAmB+K,CAAW,CAAC,EACvEE,EAAwB9D,SAAe,EAAK,EAC5C5X,EAAW4J,KACXkH,EAAe6K,EAAe,QAChC,IAIEhL,GACE3Q,EAAS,OACT0b,EAAsB,QAAU,KAAOD,EAAuB,OAC/D,EAEH,CAACzb,EAAS,MAAM,CACpB,EACM0a,EAAWzQ,KACX2R,EAAkB5D,EAAmB,YACvC,CAAC6D,EAAUC,IAAoB,CAC7B,MAAMC,EAAkBtL,GACtB,OAAOoL,GAAa,WAAaA,EAAS,IAAI,gBAAgB/K,CAAY,CAAC,EAAI+K,CACvF,EACMH,EAAsB,QAAU,GAChChB,EAAS,IAAMqB,EAAiBD,CAAe,CAChD,EACD,CAACpB,EAAU5J,CAAY,CAC3B,EACE,MAAO,CAACA,EAAc8K,CAAe,CACvC,CACA,IAAII,GAAY,EACZC,GAAqB,IAAM,KAAK,OAAO,EAAED,EAAS,CAAC,KACvD,SAASnB,IAAY,CACnB,GAAI,CAAE,OAAAtM,CAAM,EAAK8M,GAAsB,WAAW,EAC9C,CAAE,SAAAjZ,CAAQ,EAAK0W,EAAkB,WAAC7P,EAAiB,EACnDiT,EAAiB7N,KACrB,OAAO2J,EAAmB,YACxB,MAAOxH,EAAQ3R,EAAU,KAAO,CAC9B,GAAI,CAAE,OAAAiC,EAAQ,OAAAuQ,EAAQ,QAAAF,EAAS,SAAAG,EAAU,KAAAC,CAAI,EAAKH,GAChDZ,EACApO,CACR,EACM,GAAIvD,EAAQ,WAAa,GAAO,CAC9B,IAAIuB,EAAMvB,EAAQ,YAAcod,GAAkB,EAClD,MAAM1N,EAAO,MAAMnO,EAAK8b,EAAgBrd,EAAQ,QAAUiC,EAAQ,CAChE,mBAAoBjC,EAAQ,mBAC5B,SAAAyS,EACA,KAAAC,EACA,WAAY1S,EAAQ,QAAUwS,EAC9B,YAAaxS,EAAQ,SAAWsS,EAChC,UAAWtS,EAAQ,SAC7B,CAAS,CACT,MACQ,MAAM0P,EAAO,SAAS1P,EAAQ,QAAUiC,EAAQ,CAC9C,mBAAoBjC,EAAQ,mBAC5B,SAAAyS,EACA,KAAAC,EACA,WAAY1S,EAAQ,QAAUwS,EAC9B,YAAaxS,EAAQ,SAAWsS,EAChC,QAAStS,EAAQ,QACjB,MAAOA,EAAQ,MACf,YAAaqd,EACb,UAAWrd,EAAQ,UACnB,eAAgBA,EAAQ,cAClC,CAAS,CAEJ,EACD,CAAC0P,EAAQnM,EAAU8Z,CAAc,CACrC,CACA,CACA,SAASnB,GAAcja,EAAQ,CAAE,SAAAwI,CAAQ,EAAK,GAAI,CAChD,GAAI,CAAE,SAAAlH,CAAQ,EAAK0W,EAAkB,WAAC7P,EAAiB,EACnD4D,EAAeiM,aAAmB3P,EAAY,EAClD1J,GAAUoN,EAAc,kDAAkD,EAC1E,GAAI,CAACrH,CAAK,EAAIqH,EAAa,QAAQ,MAAM,EAAE,EACvCvM,EAAO,CAAE,GAAGoJ,GAAgB5I,GAAkB,IAAK,CAAE,SAAAwI,CAAU,IAC/DtJ,EAAW4J,KACf,GAAI9I,GAAU,KAAM,CAClBR,EAAK,OAASN,EAAS,OACvB,IAAIqG,EAAS,IAAI,gBAAgB/F,EAAK,MAAM,EACxC6b,EAAc9V,EAAO,OAAO,OAAO,EAEvC,GADyB8V,EAAY,KAAM3V,GAAMA,IAAM,EAAE,EACjC,CACtBH,EAAO,OAAO,OAAO,EACrB8V,EAAY,OAAQ3V,GAAMA,CAAC,EAAE,QAASA,GAAMH,EAAO,OAAO,QAASG,CAAC,CAAC,EACrE,IAAI4V,EAAK/V,EAAO,WAChB/F,EAAK,OAAS8b,EAAK,IAAIA,CAAE,GAAK,EAC/B,CACF,CACD,OAAK,CAACtb,GAAUA,IAAW,MAAQ0E,EAAM,MAAM,QAC7ClF,EAAK,OAASA,EAAK,OAASA,EAAK,OAAO,QAAQ,MAAO,SAAS,EAAI,UAElE8B,IAAa,MACf9B,EAAK,SAAWA,EAAK,WAAa,IAAM8B,EAAWoB,GAAU,CAACpB,EAAU9B,EAAK,QAAQ,CAAC,GAEjFf,GAAWe,CAAI,CACxB,CAoOA,SAASyZ,GAAuBza,EAAI,CAAE,SAAAgK,CAAQ,EAAK,GAAI,CACrD,IAAI+S,EAAYvD,aAAmBhQ,EAAqB,EACxDrJ,GACE4c,GAAa,KACb,wJACJ,EACE,GAAI,CAAE,SAAAja,CAAQ,EAAKiZ,GACjB,wBACJ,EACM/a,EAAOoJ,GAAgBpK,EAAI,CAAE,SAAAgK,CAAU,GAC3C,GAAI,CAAC+S,EAAU,gBACb,MAAO,GAET,IAAIC,EAAc/Z,GAAc8Z,EAAU,gBAAgB,SAAUja,CAAQ,GAAKia,EAAU,gBAAgB,SACvGE,EAAWha,GAAc8Z,EAAU,aAAa,SAAUja,CAAQ,GAAKia,EAAU,aAAa,SAClG,OAAO5W,GAAUnF,EAAK,SAAUic,CAAQ,GAAK,MAAQ9W,GAAUnF,EAAK,SAAUgc,CAAW,GAAK,IAChG,CCtnUO,MAAME,GAAgBC,GACrBA,EACO,IAAIC,IAASD,EAAY,GAAGC,CAAI,EAEpC,IAAIA,IAAS,MAAM,GAAGA,CAAI,ECQ9B,MAAMC,WAAuB,KAAM,CACtC,YAAYhd,EAAS+R,EAAO,iBAAkB4C,EAAS,CACnD,MAAM3U,CAAO,EACb,KAAK,KAAO+R,EACZ,KAAK,QAAU4C,CAClB,CACL,CAWO,MAAMsI,WAA4BD,EAAe,CACpD,YAAYrI,EAAS,CACjB,MAAM,gDAAiD,sBAAuBA,CAAO,CACxF,CACL,CAWO,MAAMuI,WAA4BF,EAAe,CACpD,YAAYrI,EAAS,CACjB,MAAM,yCAA0C,sBAAuBA,CAAO,CACjF,CACL,CAWO,MAAMwI,WAA2BH,EAAe,CACnD,YAAYrI,EAAS,CACjB,MAAM,+CAAgD,qBAAsBA,CAAO,CACtF,CACL,CAEO,IAAIyI,IACV,SAAUA,EAAgB,CACvBA,EAAe,IAAS,MACxBA,EAAe,aAAkB,iBACjCA,EAAe,aAAkB,iBACjCA,EAAe,SAAc,aAC7BA,EAAe,aAAkB,iBACjCA,EAAe,aAAkB,iBACjCA,EAAe,WAAgB,eAC/BA,EAAe,WAAgB,eAC/BA,EAAe,QAAa,YAC5BA,EAAe,QAAa,YAC5BA,EAAe,QAAa,YAC5BA,EAAe,QAAa,YAC5BA,EAAe,QAAa,YAC5BA,EAAe,QAAa,YAC5BA,EAAe,QAAa,WAChC,GAAGA,KAAmBA,GAAiB,GAAG,EC5EnC,MAAMC,EAAgB,CAczB,YAAYzb,EAAK,CAAE,QAAA0b,EAAU,CAAE,EAAE,YAAAR,EAAa,OAAAS,EAASH,GAAe,GAAM,EAAG,GAAI,CAC/E,KAAK,IAAMxb,EACX,KAAK,QAAU0b,EACf,KAAK,OAASC,EACd,KAAK,MAAQV,GAAaC,CAAW,CACxC,CASD,QAAQU,EAAO,CACX,KAAK,QAAQ,cAAgB,UAAUA,CAAK,EAC/C,CAYD,OAAOC,EAAgB,CACnB,OAAOC,EAAU,KAAM,UAAW,OAAQ,UAAWC,EAAcze,EAAU,GAAI,CAC7E,IAAI0e,EACJ,IAAIC,EACAC,EACJ,GAAI,CACA,KAAM,CAAE,QAAAR,EAAS,OAAA5L,EAAQ,KAAMqM,EAAc,OAAAC,EAAQ,QAAAC,CAAS,EAAG/e,EACjE,IAAIgf,EAAW,GACX,CAAE,OAAAX,CAAQ,EAAGre,EACZqe,IACDA,EAAS,KAAK,QAGlB,MAAM3b,EAAM,IAAI,IAAI,GAAG,KAAK,GAAG,IAAI+b,CAAY,EAAE,EAC7CJ,GAAUA,IAAW,QACrBW,EAAS,UAAU,EAAIX,EACvB3b,EAAI,aAAa,IAAI,sBAAuB2b,CAAM,GAEtD,IAAI3L,EACAmM,IACET,GAAW,CAAC,OAAO,UAAU,eAAe,KAAKA,EAAS,cAAc,GAAM,CAACA,GAC5E,OAAO,KAAS,KAAeS,aAAwB,MACxDA,aAAwB,aAGxBG,EAAS,cAAc,EAAI,2BAC3BtM,EAAOmM,GAEF,OAAOA,GAAiB,UAE7BG,EAAS,cAAc,EAAI,aAC3BtM,EAAOmM,GAEF,OAAO,SAAa,KAAeA,aAAwB,SAGhEnM,EAAOmM,GAIPG,EAAS,cAAc,EAAI,mBAC3BtM,EAAO,KAAK,UAAUmM,CAAY,GAKtCnM,EAAOmM,EAGX,IAAII,EAAkBH,EAClBC,IACAH,EAAoB,IAAI,gBACxBD,EAAY,WAAW,IAAMC,EAAkB,MAAO,EAAEG,CAAO,EAE3DD,GACAG,EAAkBL,EAAkB,OAEpCE,EAAO,iBAAiB,QAAS,IAAMF,EAAkB,MAAO,IAGhEK,EAAkBL,EAAkB,QAG5C,MAAMM,EAAW,MAAM,KAAK,MAAMxc,EAAI,SAAQ,EAAI,CAC9C,OAAQ8P,GAAU,OAKlB,QAAS,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,GAAIwM,CAAQ,EAAG,KAAK,OAAO,EAAGZ,CAAO,EACxF,KAAA1L,EACA,OAAQuM,CAC5B,CAAiB,EAAE,MAAOE,GAAe,CACrB,MAAM,IAAIpB,GAAoBoB,CAAU,CAC5D,CAAiB,EACKC,EAAeF,EAAS,QAAQ,IAAI,eAAe,EACzD,GAAIE,GAAgBA,IAAiB,OACjC,MAAM,IAAIpB,GAAoBkB,CAAQ,EAE1C,GAAI,CAACA,EAAS,GACV,MAAM,IAAIjB,GAAmBiB,CAAQ,EAEzC,IAAIG,IAAiBX,EAAKQ,EAAS,QAAQ,IAAI,cAAc,KAAO,MAAQR,IAAO,OAASA,EAAK,cAAc,MAAM,GAAG,EAAE,CAAC,EAAE,OACzHY,EACJ,OAAID,IAAiB,mBACjBC,EAAO,MAAMJ,EAAS,OAEjBG,IAAiB,4BACtBA,IAAiB,kBACjBC,EAAO,MAAMJ,EAAS,OAEjBG,IAAiB,oBACtBC,EAAOJ,EAEFG,IAAiB,sBACtBC,EAAO,MAAMJ,EAAS,WAItBI,EAAO,MAAMJ,EAAS,OAEnB,CAAE,KAAAI,EAAM,MAAO,KAAM,SAAAJ,CAAQ,CACvC,OACMvc,EAAO,CACV,MAAO,CACH,KAAM,KACN,MAAAA,EACA,SAAUA,aAAiBsb,IAAsBtb,aAAiBqb,GAC5Drb,EAAM,QACN,MAC1B,CACa,QACO,CAEAgc,GACA,aAAaA,CAAS,CAE7B,CACb,CAAS,CACJ,CACL,yGCvKA,OAAO,eAAeY,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAM5D,MAAMC,UAAuB,KAAM,CAc/B,YAAY/J,EAAS,CACjB,MAAMA,EAAQ,OAAO,EACrB,KAAK,KAAO,iBACZ,KAAK,QAAUA,EAAQ,QACvB,KAAK,KAAOA,EAAQ,KACpB,KAAK,KAAOA,EAAQ,IACvB,CACJ,CACc8J,UAAA,QAAGC,+CC5BlB,OAAO,eAAeC,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAE5D,MAAMF,EADU3f,GACiB,gBAAgB8f,GAA2B,GAC5E,MAAMC,CAAiB,CAcnB,YAAYC,EAAS,CACjB,IAAIlB,EAAImB,EACR,KAAK,mBAAqB,GAC1B,KAAK,OAASD,EAAQ,OACtB,KAAK,IAAMA,EAAQ,IACnB,KAAK,QAAU,IAAI,QAAQA,EAAQ,OAAO,EAC1C,KAAK,OAASA,EAAQ,OACtB,KAAK,KAAOA,EAAQ,KACpB,KAAK,oBAAsBlB,EAAKkB,EAAQ,sBAAwB,MAAQlB,IAAO,OAASA,EAAK,GAC7F,KAAK,OAASkB,EAAQ,OACtB,KAAK,eAAiBC,EAAKD,EAAQ,iBAAmB,MAAQC,IAAO,OAASA,EAAK,GAC/ED,EAAQ,MACR,KAAK,MAAQA,EAAQ,MAGrB,KAAK,MAAQ,KAEpB,CAOD,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAID,UAAU/M,EAAMhS,EAAO,CACnB,YAAK,QAAU,IAAI,QAAQ,KAAK,OAAO,EACvC,KAAK,QAAQ,IAAIgS,EAAMhS,CAAK,EACrB,IACV,CACD,KAAKif,EAAaC,EAAY,CAEtB,KAAK,SAAW,SAGX,CAAC,MAAO,MAAM,EAAE,SAAS,KAAK,MAAM,EACzC,KAAK,QAAQ,IAAI,iBAAkB,KAAK,MAAM,EAG9C,KAAK,QAAQ,IAAI,kBAAmB,KAAK,MAAM,GAE/C,KAAK,SAAW,OAAS,KAAK,SAAW,QACzC,KAAK,QAAQ,IAAI,eAAgB,kBAAkB,EAIvD,MAAMC,EAAS,KAAK,MACpB,IAAIC,EAAMD,EAAO,KAAK,IAAI,SAAQ,EAAI,CAClC,OAAQ,KAAK,OACb,QAAS,KAAK,QACd,KAAM,KAAK,UAAU,KAAK,IAAI,EAC9B,OAAQ,KAAK,MACzB,CAAS,EAAE,KAAK,MAAOC,GAAQ,CACnB,IAAIvB,EAAImB,EAAIK,EAAIC,EAChB,IAAIxd,EAAQ,KACR2c,EAAO,KACPc,EAAQ,KACRC,EAASJ,EAAI,OACbK,EAAaL,EAAI,WACrB,GAAIA,EAAI,GAAI,CACR,GAAI,KAAK,SAAW,OAAQ,CACxB,MAAMvN,EAAO,MAAMuN,EAAI,OACnBvN,IAAS,KAGJ,KAAK,QAAQ,IAAI,QAAQ,IAAM,YAG/B,KAAK,QAAQ,IAAI,QAAQ,IAC5B,GAAAgM,EAAK,KAAK,QAAQ,IAAI,QAAQ,KAAO,MAAQA,IAAO,SAAkBA,EAAG,SAAS,iCAAiC,GAHrHY,EAAO5M,EAOP4M,EAAO,KAAK,MAAM5M,CAAI,EAE7B,CACD,MAAM6N,GAAeV,EAAK,KAAK,QAAQ,IAAI,QAAQ,KAAO,MAAQA,IAAO,OAAS,OAASA,EAAG,MAAM,iCAAiC,EAC/HW,GAAgBN,EAAKD,EAAI,QAAQ,IAAI,eAAe,KAAO,MAAQC,IAAO,OAAS,OAASA,EAAG,MAAM,GAAG,EAC1GK,GAAeC,GAAgBA,EAAa,OAAS,IACrDJ,EAAQ,SAASI,EAAa,CAAC,CAAC,GAIhC,KAAK,eAAiB,KAAK,SAAW,OAAS,MAAM,QAAQlB,CAAI,IAC7DA,EAAK,OAAS,GACd3c,EAAQ,CAEJ,KAAM,WACN,QAAS,mBAAmB2c,EAAK,MAAM,0DACvC,KAAM,KACN,QAAS,uDACrC,EACwBA,EAAO,KACPc,EAAQ,KACRC,EAAS,IACTC,EAAa,kBAERhB,EAAK,SAAW,EACrBA,EAAOA,EAAK,CAAC,EAGbA,EAAO,KAGlB,KACI,CACD,MAAM5M,EAAO,MAAMuN,EAAI,OACvB,GAAI,CACAtd,EAAQ,KAAK,MAAM+P,CAAI,EAEnB,MAAM,QAAQ/P,CAAK,GAAKsd,EAAI,SAAW,MACvCX,EAAO,GACP3c,EAAQ,KACR0d,EAAS,IACTC,EAAa,KAEpB,MACU,CAEHL,EAAI,SAAW,KAAOvN,IAAS,IAC/B2N,EAAS,IACTC,EAAa,cAGb3d,EAAQ,CACJ,QAAS+P,CACrC,CAEiB,CAMD,GALI/P,GAAS,KAAK,gBAAmB,GAAAwd,EAAmDxd,GAAM,WAAa,MAAQwd,IAAO,SAAkBA,EAAG,SAAS,QAAQ,KAC5Jxd,EAAQ,KACR0d,EAAS,IACTC,EAAa,MAEb3d,GAAS,KAAK,mBACd,MAAM,IAAI4c,EAAiB,QAAQ5c,CAAK,CAE/C,CAQD,MAP0B,CACtB,MAAAA,EACA,KAAA2c,EACA,MAAAc,EACA,OAAAC,EACA,WAAAC,CAChB,CAEA,CAAS,EACD,OAAK,KAAK,qBACNL,EAAMA,EAAI,MAAOd,GAAe,CAC5B,IAAIT,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EAIxB,IAAIC,EAAe,GAEnB,MAAMC,EAAgEzB,GAAW,MACjF,GAAIyB,EAAO,CACP,MAAMC,GAAgBnC,EAAmDkC,GAAM,WAAa,MAAQlC,IAAO,OAASA,EAAK,GACnHoC,GAAajB,EAAmDe,GAAM,QAAU,MAAQf,IAAO,OAASA,EAAK,GACnHc,EAAe,IAAIT,EAA6Df,GAAW,QAAU,MAAQe,IAAO,OAASA,EAAK,YAAY,KAA6Df,GAAW,OAAO,GAC7NwB,GAAgB;AAAA;AAAA,cAAmBR,EAAmDS,GAAM,QAAU,MAAQT,IAAO,OAASA,EAAK,OAAO,KAAKU,CAAY,GACvJC,IACAH,GAAgB,KAAKG,CAAS,KAEgBF,GAAM,QACpDD,GAAgB;AAAA,EAAKC,EAAM,KAAK,GAEvC,MAGGD,GAAgBF,EAA6DtB,GAAW,SAAW,MAAQsB,IAAO,OAASA,EAAK,GAEpI,MAAO,CACH,MAAO,CACH,QAAS,IAAIC,EAA6DvB,GAAW,QAAU,MAAQuB,IAAO,OAASA,EAAK,YAAY,KAA6DvB,GAAW,OAAO,GACvN,QAASwB,EACT,KAAM,GACN,KAAM,EACT,EACD,KAAM,KACN,MAAO,KACP,OAAQ,EACR,WAAY,EAChC,CACA,CAAa,GAEEV,EAAI,KAAKH,EAAaC,CAAU,CAC1C,CAOD,SAAU,CAEN,OAAO,IACV,CAuBD,eAAgB,CACZ,OAAO,IACV,CACJ,CACcN,UAAA,QAAGE,+CCvPlB,OAAO,eAAeoB,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAE5D,MAAMtB,EADU7f,GACmB,gBAAgB8f,GAA6B,GAChF,MAAMsB,UAAkCvB,EAAmB,OAAQ,CAU/D,OAAOwB,EAAS,CAEZ,IAAIC,EAAS,GACb,MAAMC,GAAkBF,GAAmD,KACtE,MAAM,EAAE,EACR,IAAKG,GACF,KAAK,KAAKA,CAAC,GAAK,CAACF,EACV,IAEPE,IAAM,MACNF,EAAS,CAACA,GAEPE,EACV,EACI,KAAK,EAAE,EACZ,YAAK,IAAI,aAAa,IAAI,SAAUD,CAAc,EAClD,KAAK,QAAQ,OAAO,SAAU,uBAAuB,EAC9C,IACV,CAmBD,MAAME,EAAQ,CAAE,UAAAC,EAAY,GAAM,WAAAC,EAAY,aAAAC,EAAc,gBAAAC,EAAkBD,CAAe,EAAG,GAAI,CAChG,MAAMjgB,EAAMkgB,EAAkB,GAAGA,CAAe,SAAW,QACrDC,EAAgB,KAAK,IAAI,aAAa,IAAIngB,CAAG,EACnD,YAAK,IAAI,aAAa,IAAIA,EAAK,GAAGmgB,EAAgB,GAAGA,CAAa,IAAM,EAAE,GAAGL,CAAM,IAAIC,EAAY,MAAQ,MAAM,GAAGC,IAAe,OAAY,GAAKA,EAAa,cAAgB,YAAY,EAAE,EACxL,IACV,CAWD,MAAMnB,EAAO,CAAE,aAAAoB,EAAc,gBAAAC,EAAkBD,CAAe,EAAG,GAAI,CACjE,MAAMjgB,EAAM,OAAOkgB,EAAoB,IAAc,QAAU,GAAGA,CAAe,SACjF,YAAK,IAAI,aAAa,IAAIlgB,EAAK,GAAG6e,CAAK,EAAE,EAClC,IACV,CAgBD,MAAM/W,EAAM5I,EAAI,CAAE,aAAA+gB,EAAc,gBAAAC,EAAkBD,CAAe,EAAG,GAAI,CACpE,MAAMG,EAAY,OAAOF,EAAoB,IAAc,SAAW,GAAGA,CAAe,UAClFG,EAAW,OAAOH,EAAoB,IAAc,QAAU,GAAGA,CAAe,SACtF,YAAK,IAAI,aAAa,IAAIE,EAAW,GAAGtY,CAAI,EAAE,EAE9C,KAAK,IAAI,aAAa,IAAIuY,EAAU,GAAGnhB,EAAK4I,EAAO,CAAC,EAAE,EAC/C,IACV,CAMD,YAAYyV,EAAQ,CAChB,YAAK,OAASA,EACP,IACV,CAOD,QAAS,CACL,YAAK,QAAQ,IAAI,SAAU,mCAAmC,EACvD,IACV,CAOD,aAAc,CAGV,OAAI,KAAK,SAAW,MAChB,KAAK,QAAQ,IAAI,SAAU,kBAAkB,EAG7C,KAAK,QAAQ,IAAI,SAAU,mCAAmC,EAElE,KAAK,cAAgB,GACd,IACV,CAID,KAAM,CACF,YAAK,QAAQ,IAAI,SAAU,UAAU,EAC9B,IACV,CAID,SAAU,CACN,YAAK,QAAQ,IAAI,SAAU,sBAAsB,EAC1C,IACV,CA0BD,QAAQ,CAAE,QAAA+C,EAAU,GAAO,QAAAC,EAAU,GAAO,SAAAC,EAAW,GAAO,QAAAC,EAAU,GAAO,IAAAC,EAAM,GAAO,OAAAC,EAAS,MAAS,EAAG,GAAI,CACjH,IAAIxD,EACJ,MAAM1e,EAAU,CACZ6hB,EAAU,UAAY,KACtBC,EAAU,UAAY,KACtBC,EAAW,WAAa,KACxBC,EAAU,UAAY,KACtBC,EAAM,MAAQ,IACjB,EACI,OAAO,OAAO,EACd,KAAK,GAAG,EAEPE,GAAgBzD,EAAK,KAAK,QAAQ,IAAI,QAAQ,KAAO,MAAQA,IAAO,OAASA,EAAK,mBAExF,OADA,KAAK,QAAQ,IAAI,SAAU,8BAA8BwD,CAAM,UAAUC,CAAY,cAAcniB,CAAO,GAAG,EACzGkiB,IAAW,OACJ,KAGA,IAEd,CAMD,UAAW,CACP,YAAK,QAAQ,OAAO,SAAU,aAAa,EACpC,IACV,CAOD,SAAU,CACN,OAAO,IACV,CAOD,YAAYrhB,EAAO,CACf,YAAK,QAAQ,OAAO,SAAU,iBAAiB,EAC/C,KAAK,QAAQ,OAAO,SAAU,gBAAgBA,CAAK,EAAE,EAC9C,IACV,CACJ,CACckgB,UAAA,QAAGC,+CC7NlB,OAAO,eAAeoB,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAE5D,MAAMrB,EADUnhB,GAC4B,gBAAgB8f,GAAsC,GAC5F2C,EAA+B,IAAI,OAAO,OAAO,EACvD,MAAMC,UAA+BvB,EAA4B,OAAQ,CASrE,GAAGM,EAAQxgB,EAAO,CACd,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAC3C,IACV,CAOD,IAAIwgB,EAAQxgB,EAAO,CACf,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAOxgB,CAAK,EAAE,EAC5C,IACV,CAOD,GAAGwgB,EAAQxgB,EAAO,CACd,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAC3C,IACV,CAOD,IAAIwgB,EAAQxgB,EAAO,CACf,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAOxgB,CAAK,EAAE,EAC5C,IACV,CAOD,GAAGwgB,EAAQxgB,EAAO,CACd,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAC3C,IACV,CAOD,IAAIwgB,EAAQxgB,EAAO,CACf,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAOxgB,CAAK,EAAE,EAC5C,IACV,CAOD,KAAKwgB,EAAQva,EAAS,CAClB,YAAK,IAAI,aAAa,OAAOua,EAAQ,QAAQva,CAAO,EAAE,EAC/C,IACV,CAOD,UAAUua,EAAQkB,EAAU,CACxB,YAAK,IAAI,aAAa,OAAOlB,EAAQ,cAAckB,EAAS,KAAK,GAAG,CAAC,GAAG,EACjE,IACV,CAOD,UAAUlB,EAAQkB,EAAU,CACxB,YAAK,IAAI,aAAa,OAAOlB,EAAQ,cAAckB,EAAS,KAAK,GAAG,CAAC,GAAG,EACjE,IACV,CAOD,MAAMlB,EAAQva,EAAS,CACnB,YAAK,IAAI,aAAa,OAAOua,EAAQ,SAASva,CAAO,EAAE,EAChD,IACV,CAOD,WAAWua,EAAQkB,EAAU,CACzB,YAAK,IAAI,aAAa,OAAOlB,EAAQ,eAAekB,EAAS,KAAK,GAAG,CAAC,GAAG,EAClE,IACV,CAOD,WAAWlB,EAAQkB,EAAU,CACzB,YAAK,IAAI,aAAa,OAAOlB,EAAQ,eAAekB,EAAS,KAAK,GAAG,CAAC,GAAG,EAClE,IACV,CAQD,WAAWlB,EAAQva,EAAS,CACxB,YAAK,IAAI,aAAa,OAAOua,EAAQ,SAASva,CAAO,EAAE,EAChD,IACV,CAQD,YAAYua,EAAQva,EAAS,CACzB,YAAK,IAAI,aAAa,OAAOua,EAAQ,UAAUva,CAAO,EAAE,EACjD,IACV,CAaD,GAAGua,EAAQxgB,EAAO,CACd,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAC3C,IACV,CAWD,WAAWwgB,EAAQxgB,EAAO,CACtB,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,cAAcxgB,CAAK,EAAE,EACnD,IACV,CAOD,GAAGwgB,EAAQmB,EAAQ,CACf,MAAMC,EAAgB,MAAM,KAAK,IAAI,IAAID,CAAM,CAAC,EAC3C,IAAKrc,GAGF,OAAOA,GAAM,UAAYkc,EAA6B,KAAKlc,CAAC,EACrD,IAAIA,CAAC,IAEL,GAAGA,CAAC,EAClB,EACI,KAAK,GAAG,EACb,YAAK,IAAI,aAAa,OAAOkb,EAAQ,OAAOoB,CAAa,GAAG,EACrD,IACV,CAQD,SAASpB,EAAQxgB,EAAO,CACpB,OAAI,OAAOA,GAAU,SAGjB,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAE7C,MAAM,QAAQA,CAAK,EAExB,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAOxgB,EAAM,KAAK,GAAG,CAAC,GAAG,EAI9D,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAM,KAAK,UAAUxgB,CAAK,CAAC,EAAE,EAE/D,IACV,CAQD,YAAYwgB,EAAQxgB,EAAO,CACvB,OAAI,OAAOA,GAAU,SAEjB,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAE7C,MAAM,QAAQA,CAAK,EAExB,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAOxgB,EAAM,KAAK,GAAG,CAAC,GAAG,EAI9D,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAM,KAAK,UAAUxgB,CAAK,CAAC,EAAE,EAE/D,IACV,CAQD,QAAQwgB,EAAQqB,EAAO,CACnB,YAAK,IAAI,aAAa,OAAOrB,EAAQ,MAAMqB,CAAK,EAAE,EAC3C,IACV,CASD,SAASrB,EAAQqB,EAAO,CACpB,YAAK,IAAI,aAAa,OAAOrB,EAAQ,OAAOqB,CAAK,EAAE,EAC5C,IACV,CAQD,QAAQrB,EAAQqB,EAAO,CACnB,YAAK,IAAI,aAAa,OAAOrB,EAAQ,MAAMqB,CAAK,EAAE,EAC3C,IACV,CASD,SAASrB,EAAQqB,EAAO,CACpB,YAAK,IAAI,aAAa,OAAOrB,EAAQ,OAAOqB,CAAK,EAAE,EAC5C,IACV,CASD,cAAcrB,EAAQqB,EAAO,CACzB,YAAK,IAAI,aAAa,OAAOrB,EAAQ,OAAOqB,CAAK,EAAE,EAC5C,IACV,CAQD,SAASrB,EAAQxgB,EAAO,CACpB,OAAI,OAAOA,GAAU,SAEjB,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,EAIlD,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAOxgB,EAAM,KAAK,GAAG,CAAC,GAAG,EAE3D,IACV,CAWD,WAAWwgB,EAAQsB,EAAO,CAAE,OAAAC,EAAQ,KAAA9P,CAAM,EAAG,GAAI,CAC7C,IAAI+P,EAAW,GACX/P,IAAS,QACT+P,EAAW,KAEN/P,IAAS,SACd+P,EAAW,KAEN/P,IAAS,cACd+P,EAAW,KAEf,MAAMC,EAAaF,IAAW,OAAY,GAAK,IAAIA,CAAM,IACzD,YAAK,IAAI,aAAa,OAAOvB,EAAQ,GAAGwB,CAAQ,MAAMC,CAAU,IAAIH,CAAK,EAAE,EACpE,IACV,CAQD,MAAMA,EAAO,CACT,cAAO,QAAQA,CAAK,EAAE,QAAQ,CAAC,CAACtB,EAAQxgB,CAAK,IAAM,CAC/C,KAAK,IAAI,aAAa,OAAOwgB,EAAQ,MAAMxgB,CAAK,EAAE,CAC9D,CAAS,EACM,IACV,CAcD,IAAIwgB,EAAQ0B,EAAUliB,EAAO,CACzB,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,OAAO0B,CAAQ,IAAIliB,CAAK,EAAE,EACxD,IACV,CAgBD,GAAGmiB,EAAS,CAAE,aAAAxB,EAAc,gBAAAC,EAAkBD,CAAe,EAAG,GAAI,CAChE,MAAMjgB,EAAMkgB,EAAkB,GAAGA,CAAe,MAAQ,KACxD,YAAK,IAAI,aAAa,OAAOlgB,EAAK,IAAIyhB,CAAO,GAAG,EACzC,IACV,CAcD,OAAO3B,EAAQ0B,EAAUliB,EAAO,CAC5B,YAAK,IAAI,aAAa,OAAOwgB,EAAQ,GAAG0B,CAAQ,IAAIliB,CAAK,EAAE,EACpD,IACV,CACJ,CACcuhB,UAAA,QAAGE,+CC7ZlB,OAAO,eAAeW,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAE5D,MAAMb,EADUxiB,GACyB,gBAAgB8f,GAAmC,GAC5F,MAAMwD,CAAsB,CAcxB,YAAYxgB,EAAK,CAAE,QAAA0b,EAAU,GAAI,OAAA+E,EAAQ,MAAAC,GAAU,CAC/C,KAAK,IAAM1gB,EACX,KAAK,QAAU,IAAI,QAAQ0b,CAAO,EAClC,KAAK,OAAS+E,EACd,KAAK,MAAQC,CAChB,CAsBD,OAAOnC,EAASjhB,EAAS,CACrB,KAAM,CAAE,KAAAqjB,EAAO,GAAO,MAAAjD,GAAUpgB,GAAmD,GAC7EwS,EAAS6Q,EAAO,OAAS,MAE/B,IAAInC,EAAS,GACb,MAAMC,GAAkBF,GAAmD,KACtE,MAAM,EAAE,EACR,IAAKG,GACF,KAAK,KAAKA,CAAC,GAAK,CAACF,EACV,IAEPE,IAAM,MACNF,EAAS,CAACA,GAEPE,EACV,EACI,KAAK,EAAE,EACZ,YAAK,IAAI,aAAa,IAAI,SAAUD,CAAc,EAC9Cf,GACA,KAAK,QAAQ,OAAO,SAAU,SAASA,CAAK,EAAE,EAE3C,IAAIgC,EAAyB,QAAQ,CACxC,OAAA5P,EACA,IAAK,KAAK,IACV,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,MAAO,KAAK,KACxB,CAAS,CACJ,CA2BD,OAAOgQ,EAAQ,CAAE,MAAApC,EAAO,cAAAkD,EAAgB,EAAO,EAAG,GAAI,CAClD,IAAI5E,EACJ,MAAMlM,EAAS,OAOf,GANI4N,GACA,KAAK,QAAQ,OAAO,SAAU,SAASA,CAAK,EAAE,EAE7CkD,GACD,KAAK,QAAQ,OAAO,SAAU,iBAAiB,EAE/C,MAAM,QAAQd,CAAM,EAAG,CACvB,MAAMvB,EAAUuB,EAAO,OAAO,CAACe,EAAKC,IAAMD,EAAI,OAAO,OAAO,KAAKC,CAAC,CAAC,EAAG,CAAE,GACxE,GAAIvC,EAAQ,OAAS,EAAG,CACpB,MAAMwC,EAAgB,CAAC,GAAG,IAAI,IAAIxC,CAAO,CAAC,EAAE,IAAKI,GAAW,IAAIA,CAAM,GAAG,EACzE,KAAK,IAAI,aAAa,IAAI,UAAWoC,EAAc,KAAK,GAAG,CAAC,CAC/D,CACJ,CACD,OAAO,IAAIrB,EAAyB,QAAQ,CACxC,OAAA5P,EACA,IAAK,KAAK,IACV,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,KAAMgQ,EACN,OAAQ9D,EAAK,KAAK,SAAW,MAAQA,IAAO,OAASA,EAAK,KACtE,CAAS,CACJ,CAsFD,OAAO8D,EAAQ,CAAE,WAAAkB,EAAY,iBAAAC,EAAmB,GAAO,MAAAvD,EAAO,cAAAkD,EAAgB,EAAO,EAAG,GAAI,CACxF,IAAI5E,EACJ,MAAMlM,EAAS,OAUf,GATA,KAAK,QAAQ,OAAO,SAAU,cAAcmR,EAAmB,SAAW,OAAO,aAAa,EAC1FD,IAAe,QACf,KAAK,IAAI,aAAa,IAAI,cAAeA,CAAU,EACnDtD,GACA,KAAK,QAAQ,OAAO,SAAU,SAASA,CAAK,EAAE,EAE7CkD,GACD,KAAK,QAAQ,OAAO,SAAU,iBAAiB,EAE/C,MAAM,QAAQd,CAAM,EAAG,CACvB,MAAMvB,EAAUuB,EAAO,OAAO,CAACe,EAAKC,IAAMD,EAAI,OAAO,OAAO,KAAKC,CAAC,CAAC,EAAG,CAAE,GACxE,GAAIvC,EAAQ,OAAS,EAAG,CACpB,MAAMwC,EAAgB,CAAC,GAAG,IAAI,IAAIxC,CAAO,CAAC,EAAE,IAAKI,GAAW,IAAIA,CAAM,GAAG,EACzE,KAAK,IAAI,aAAa,IAAI,UAAWoC,EAAc,KAAK,GAAG,CAAC,CAC/D,CACJ,CACD,OAAO,IAAIrB,EAAyB,QAAQ,CACxC,OAAA5P,EACA,IAAK,KAAK,IACV,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,KAAMgQ,EACN,OAAQ9D,EAAK,KAAK,SAAW,MAAQA,IAAO,OAASA,EAAK,KACtE,CAAS,CACJ,CAsBD,OAAO8D,EAAQ,CAAE,MAAApC,CAAK,EAAM,GAAI,CAC5B,IAAI1B,EACJ,MAAMlM,EAAS,QACf,OAAI4N,GACA,KAAK,QAAQ,OAAO,SAAU,SAASA,CAAK,EAAE,EAE3C,IAAIgC,EAAyB,QAAQ,CACxC,OAAA5P,EACA,IAAK,KAAK,IACV,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,KAAMgQ,EACN,OAAQ9D,EAAK,KAAK,SAAW,MAAQA,IAAO,OAASA,EAAK,KACtE,CAAS,CACJ,CAoBD,OAAO,CAAE,MAAA0B,CAAQ,EAAG,GAAI,CACpB,IAAI1B,EACJ,MAAMlM,EAAS,SACf,OAAI4N,GACA,KAAK,QAAQ,OAAO,SAAU,SAASA,CAAK,EAAE,EAE3C,IAAIgC,EAAyB,QAAQ,CACxC,OAAA5P,EACA,IAAK,KAAK,IACV,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,OAAQkM,EAAK,KAAK,SAAW,MAAQA,IAAO,OAASA,EAAK,KACtE,CAAS,CACJ,CACJ,CACcuE,UAAA,QAAGC,+CCnTlB,OAAO,eAAeU,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAC5D,MAAMC,EAAUjkB,GACVqjB,EAA0BY,EAAQ,gBAAgBnE,GAAkC,GACpF0C,EAA2ByB,EAAQ,gBAAgBC,GAAmC,GAW5F,MAAMC,CAAgB,CAoBlB,YAAYrhB,EAAK,CAAE,QAAA0b,EAAU,CAAE,EAAE,OAAA+E,EAAQ,MAAAC,CAAQ,EAAG,GAAI,CACpD,KAAK,IAAM1gB,EACX,KAAK,QAAU,IAAI,QAAQ0b,CAAO,EAClC,KAAK,WAAa+E,EAClB,KAAK,MAAQC,CAChB,CAMD,KAAKY,EAAU,CACX,GAAI,CAACA,GAAY,OAAOA,GAAa,UAAYA,EAAS,KAAM,IAAK,GACjE,MAAM,IAAI,MAAM,6DAA6D,EAEjF,MAAMthB,EAAM,IAAI,IAAI,GAAG,KAAK,GAAG,IAAIshB,CAAQ,EAAE,EAC7C,OAAO,IAAIf,EAAwB,QAAQvgB,EAAK,CAC5C,QAAS,IAAI,QAAQ,KAAK,OAAO,EACjC,OAAQ,KAAK,WACb,MAAO,KAAK,KACxB,CAAS,CACJ,CAQD,OAAOygB,EAAQ,CACX,OAAO,IAAIY,EAAgB,KAAK,IAAK,CACjC,QAAS,KAAK,QACd,OAAAZ,EACA,MAAO,KAAK,KACxB,CAAS,CACJ,CAwBD,IAAIpgB,EAAI8a,EAAO,GAAI,CAAE,KAAAwF,EAAO,GAAO,IAAAY,EAAM,GAAO,MAAA7D,CAAK,EAAM,GAAI,CAC3D,IAAI1B,EACJ,IAAIlM,EACJ,MAAM9P,EAAM,IAAI,IAAI,GAAG,KAAK,GAAG,QAAQK,CAAE,EAAE,EAC3C,IAAI2P,EACA2Q,GAAQY,GACRzR,EAAS6Q,EAAO,OAAS,MACzB,OAAO,QAAQxF,CAAI,EAGd,OAAO,CAAC,CAACnW,EAAG7G,CAAK,IAAMA,IAAU,MAAS,EAE1C,IAAI,CAAC,CAACgS,EAAMhS,CAAK,IAAM,CAACgS,EAAM,MAAM,QAAQhS,CAAK,EAAI,IAAIA,EAAM,KAAK,GAAG,CAAC,IAAM,GAAGA,CAAK,EAAE,CAAC,EACzF,QAAQ,CAAC,CAACgS,EAAMhS,CAAK,IAAM,CAC5B6B,EAAI,aAAa,OAAOmQ,EAAMhS,CAAK,CACnD,CAAa,IAGD2R,EAAS,OACTE,EAAOmL,GAEX,MAAMO,EAAU,IAAI,QAAQ,KAAK,OAAO,EACxC,OAAIgC,GACAhC,EAAQ,IAAI,SAAU,SAASgC,CAAK,EAAE,EAEnC,IAAIgC,EAAyB,QAAQ,CACxC,OAAA5P,EACA,IAAA9P,EACA,QAAA0b,EACA,OAAQ,KAAK,WACb,KAAA1L,EACA,OAAQgM,EAAK,KAAK,SAAW,MAAQA,IAAO,OAASA,EAAK,KACtE,CAAS,CACJ,CACJ,CACckF,UAAA,QAAGG,KChIlB,OAAO,eAAeG,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAC5D,IAAA1E,GAAA0E,GAAA,eAAyBvE,GAAAuE,GAAA,iBAA2BlD,GAAAkD,GAAA,0BAAoC5B,GAAA4B,GAAA,uBAAiChB,GAAAgB,GAAA,sBAAgCH,GAAAG,GAAA,gBAA0B,OACnL,MAAML,GAAUjkB,GAEVgkB,GAAoBC,GAAQ,gBAAgBnE,GAA4B,GAC9E,IAAAqE,GAAAG,GAAA,gBAA0BN,GAAkB,QAC5C,MAAMX,GAA0BY,GAAQ,gBAAgBC,GAAkC,GAC1F,IAAAZ,GAAAgB,GAAA,sBAAgCjB,GAAwB,QACxD,MAAMb,GAA2ByB,GAAQ,gBAAgBM,GAAmC,GAC5F,IAAA7B,GAAA4B,GAAA,uBAAiC9B,GAAyB,QAC1D,MAAMrB,GAA8B8C,GAAQ,gBAAgBO,GAAsC,GAClG,IAAApD,GAAAkD,GAAA,0BAAoCnD,GAA4B,QAChE,MAAMtB,GAAqBoE,GAAQ,gBAAgBQ,GAA6B,GAChF,IAAA1E,GAAAuE,GAAA,iBAA2BzE,GAAmB,QAC9C,MAAMF,GAAmBsE,GAAQ,gBAAgBS,GAA2B,GAC5E9E,GAAA0E,GAAA,eAAyB3E,GAAiB,QAC1C,IAAAgF,GAAAL,GAAA,QAAkB,CACd,gBAAiBN,GAAkB,QACnC,sBAAuBX,GAAwB,QAC/C,uBAAwBb,GAAyB,QACjD,0BAA2BrB,GAA4B,QACvD,iBAAkBtB,GAAmB,QACrC,eAAgBF,GAAiB,OACrC,6QCvBM,CACJ,gBAAAwE,GACA,sBAAAb,GACA,uBAAAZ,GACA,0BAAAtB,GACA,iBAAArB,GACA,eAAAH,EACF,EAAIgF,IAAiBpjB,GCLd,MAAMqjB,EAAiB,CAI1B,aAAc,CAAG,CACjB,OAAO,mBAAoB,CACvB,IAAI/F,EACJ,GAAI,OAAO,UAAc,IACrB,MAAO,CAAE,KAAM,SAAU,YAAa,SAAS,EAEnD,GAAI,OAAO,WAAe,KAAe,OAAO,WAAW,UAAc,IACrE,MAAO,CAAE,KAAM,SAAU,YAAa,WAAW,SAAS,EAE9D,GAAI,OAAO,OAAW,KAAe,OAAO,OAAO,UAAc,IAC7D,MAAO,CAAE,KAAM,SAAU,YAAa,OAAO,SAAS,EAE1D,GAAI,OAAO,WAAe,KACtB,OAAO,WAAW,cAAkB,KACpC,OAAO,WAAW,UAAc,IAChC,MAAO,CACH,KAAM,aACN,MAAO,0FACP,WAAY,4GAC5B,EAEQ,GAAK,OAAO,WAAe,KAAe,WAAW,aAChD,OAAO,UAAc,MAAiB,GAAAA,EAAK,UAAU,aAAe,MAAQA,IAAO,SAAkBA,EAAG,SAAS,aAAa,GAC/H,MAAO,CACH,KAAM,cACN,MAAO,oGACP,WAAY,wFAC5B,EAEQ,GAAI,OAAO,QAAY,IAAa,CAEhC,MAAMgG,EAAkB,QAAQ,SAChC,GAAIA,GAAmBA,EAAgB,KAAS,CAE5C,MAAMC,EAAgBD,EAAgB,KAChCE,EAAc,SAASD,EAAc,QAAQ,KAAM,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC,EAE1E,OAAIC,GAAe,GAEX,OAAO,WAAW,UAAc,IACzB,CAAE,KAAM,SAAU,YAAa,WAAW,SAAS,EAGvD,CACH,KAAM,cACN,MAAO,WAAWA,CAAW,4CAC7B,WAAY,8DACpC,EAGuB,CACH,KAAM,cACN,MAAO,WAAWA,CAAW,8CAC7B,WAAY;AAAA;AAAA,2CAGhC,CACa,CACJ,CACD,MAAO,CACH,KAAM,cACN,MAAO,wDACP,WAAY,yHACxB,CACK,CAUD,OAAO,yBAA0B,CAC7B,MAAMC,EAAM,KAAK,oBACjB,GAAIA,EAAI,YACJ,OAAOA,EAAI,YAEf,IAAIC,EAAeD,EAAI,OAAS,+CAChC,MAAIA,EAAI,aACJC,GAAgB;AAAA;AAAA,sBAA2BD,EAAI,UAAU,IAEvD,IAAI,MAAMC,CAAY,CAC/B,CASD,OAAO,gBAAgBpiB,EAAKqiB,EAAW,CACnC,MAAMC,EAAK,KAAK,0BAChB,OAAO,IAAIA,EAAGtiB,EAAKqiB,CAAS,CAC/B,CAWD,OAAO,sBAAuB,CAC1B,GAAI,CACA,MAAMF,EAAM,KAAK,oBACjB,OAAOA,EAAI,OAAS,UAAYA,EAAI,OAAS,IAChD,MACU,CACP,MAAO,EACV,CACJ,CACL,CCrHO,MAAMI,GAAU,SCLVC,GAAkB,eAAeD,EAAO,GACxCE,GAAY,QACZC,GAAY,QACZC,GAAcF,GAEdG,GAAkB,IAClBC,GAAkB,IAClBC,GAAuB,IAC7B,IAAIC,IACV,SAAUA,EAAe,CACtBA,EAAcA,EAAc,WAAgB,CAAC,EAAI,aACjDA,EAAcA,EAAc,KAAU,CAAC,EAAI,OAC3CA,EAAcA,EAAc,QAAa,CAAC,EAAI,UAC9CA,EAAcA,EAAc,OAAY,CAAC,EAAI,QACjD,GAAGA,KAAkBA,GAAgB,CAAE,EAAC,EACjC,IAAIC,IACV,SAAUA,EAAgB,CACvBA,EAAe,OAAY,SAC3BA,EAAe,QAAa,UAC5BA,EAAe,OAAY,SAC3BA,EAAe,QAAa,UAC5BA,EAAe,QAAa,SAChC,GAAGA,KAAmBA,GAAiB,CAAE,EAAC,EACnC,IAAIC,IACV,SAAUA,EAAgB,CACvBA,EAAe,MAAW,YAC1BA,EAAe,MAAW,YAC1BA,EAAe,KAAU,WACzBA,EAAe,MAAW,YAC1BA,EAAe,MAAW,YAC1BA,EAAe,aAAkB,cACrC,GAAGA,KAAmBA,GAAiB,CAAE,EAAC,EACnC,IAAIC,IACV,SAAUA,EAAY,CACnBA,EAAW,UAAe,WAC9B,GAAGA,KAAeA,GAAa,CAAE,EAAC,EAC3B,IAAIC,IACV,SAAUA,EAAkB,CACzBA,EAAiB,WAAgB,aACjCA,EAAiB,KAAU,OAC3BA,EAAiB,QAAa,UAC9BA,EAAiB,OAAY,QACjC,GAAGA,KAAqBA,GAAmB,GAAG,EC3C/B,MAAMC,EAAW,CAC5B,YAAYC,EAAqB,CAC7B,KAAK,cAAgB,EACrB,KAAK,gCAAkC,EACvC,KAAK,MAAQ,CAAE,kBAAmB,EAAG,cAAe,GACpD,KAAK,gBAAkB,EACvB,KAAK,cAAgB,EACrB,KAAK,gBAAkB,YACvB,KAAK,oBAAsB,GAC3B,KAAK,oBAAsBA,GAAuF,EACrH,CACD,OAAOC,EAAKhP,EAAU,CAClB,GAAIgP,EAAI,QAAU,KAAK,iBACnB,EAAEA,EAAI,mBAAmB,cACzB,OAAOA,EAAI,QAAQ,OAAU,SAC7B,OAAOhP,EAAS,KAAK,+BAA+BgP,CAAG,CAAC,EAE5D,IAAIC,EAAU,CAACD,EAAI,SAAUA,EAAI,IAAKA,EAAI,MAAOA,EAAI,MAAOA,EAAI,OAAO,EACvE,OAAOhP,EAAS,KAAK,UAAUiP,CAAO,CAAC,CAC1C,CACD,+BAA+BnlB,EAAS,CACpC,IAAI4d,EACJ,OAAI,KAAK,gBAAgBA,EAAK5d,EAAQ,WAAa,MAAQ4d,IAAO,OAAS,OAASA,EAAG,OAAO,EACnF,KAAK,+BAA+B5d,CAAO,EAG3C,KAAK,6BAA6BA,CAAO,CAEvD,CACD,+BAA+BA,EAAS,CACpC,IAAI4d,EAAImB,EACR,MAAMqG,GAAerG,GAAMnB,EAAK5d,EAAQ,WAAa,MAAQ4d,IAAO,OAAS,OAASA,EAAG,WAAa,MAAQmB,IAAO,OAASA,EAAK,IAAI,YAAY,CAAC,EACpJ,OAAO,KAAK,yBAAyB/e,EAAS,KAAK,gBAAiBolB,CAAW,CAClF,CACD,6BAA6BplB,EAAS,CAClC,IAAI4d,EAAImB,EACR,MAAMqG,GAAerG,GAAMnB,EAAK5d,EAAQ,WAAa,MAAQ4d,IAAO,OAAS,OAASA,EAAG,WAAa,MAAQmB,IAAO,OAASA,EAAK,GAE7HsG,EADU,IAAI,cACe,OAAO,KAAK,UAAUD,CAAW,CAAC,EAAE,OACvE,OAAO,KAAK,yBAAyBplB,EAAS,KAAK,cAAeqlB,CAAkB,CACvF,CACD,yBAAyBrlB,EAASslB,EAAcC,EAAgB,CAC5D,IAAI3H,EAAImB,EACR,MAAMyG,EAAQxlB,EAAQ,MAChB+V,GAAO6H,EAAK5d,EAAQ,OAAS,MAAQ4d,IAAO,OAASA,EAAK,GAC1D6H,GAAW1G,EAAK/e,EAAQ,YAAc,MAAQ+e,IAAO,OAASA,EAAK,GACnE2G,EAAY1lB,EAAQ,QAAQ,MAE5BoE,EAAO,KAAK,oBACZ,KAAK,MAAMpE,EAAQ,QAAS,KAAK,mBAAmB,EACpD,GACA2lB,EAAW,OAAO,KAAKvhB,CAAI,EAAE,SAAW,EAAI,GAAK,KAAK,UAAUA,CAAI,EAE1E,GAAIqhB,EAAQ,OAAS,IACjB,MAAM,IAAI,MAAM,kBAAkBA,EAAQ,MAAM,yBAAyB,EAE7E,GAAI1P,EAAI,OAAS,IACb,MAAM,IAAI,MAAM,cAAcA,EAAI,MAAM,yBAAyB,EAErE,GAAIyP,EAAM,OAAS,IACf,MAAM,IAAI,MAAM,gBAAgBA,EAAM,MAAM,yBAAyB,EAEzE,GAAIE,EAAU,OAAS,IACnB,MAAM,IAAI,MAAM,oBAAoBA,EAAU,MAAM,yBAAyB,EAEjF,GAAIC,EAAS,OAAS,IAClB,MAAM,IAAI,MAAM,mBAAmBA,EAAS,MAAM,yBAAyB,EAE/E,MAAMC,EAAa,KAAK,gCACpBH,EAAQ,OACR1P,EAAI,OACJyP,EAAM,OACNE,EAAU,OACVC,EAAS,OACPE,EAAS,IAAI,YAAY,KAAK,cAAgBD,CAAU,EAC9D,IAAIE,EAAO,IAAI,SAASD,CAAM,EAC1BE,EAAS,EACbD,EAAK,SAASC,IAAU,KAAK,MAAM,iBAAiB,EACpDD,EAAK,SAASC,IAAUN,EAAQ,MAAM,EACtCK,EAAK,SAASC,IAAUhQ,EAAI,MAAM,EAClC+P,EAAK,SAASC,IAAUP,EAAM,MAAM,EACpCM,EAAK,SAASC,IAAUL,EAAU,MAAM,EACxCI,EAAK,SAASC,IAAUJ,EAAS,MAAM,EACvCG,EAAK,SAASC,IAAUT,CAAY,EACpC,MAAM,KAAKG,EAAU/d,GAASoe,EAAK,SAASC,IAAUre,EAAK,WAAW,CAAC,CAAC,CAAC,EACzE,MAAM,KAAKqO,EAAMrO,GAASoe,EAAK,SAASC,IAAUre,EAAK,WAAW,CAAC,CAAC,CAAC,EACrE,MAAM,KAAK8d,EAAQ9d,GAASoe,EAAK,SAASC,IAAUre,EAAK,WAAW,CAAC,CAAC,CAAC,EACvE,MAAM,KAAKge,EAAYhe,GAASoe,EAAK,SAASC,IAAUre,EAAK,WAAW,CAAC,CAAC,CAAC,EAC3E,MAAM,KAAKie,EAAWje,GAASoe,EAAK,SAASC,IAAUre,EAAK,WAAW,CAAC,CAAC,CAAC,EAC1E,IAAIse,EAAW,IAAI,WAAWH,EAAO,WAAaN,EAAe,UAAU,EAC3E,OAAAS,EAAS,IAAI,IAAI,WAAWH,CAAM,EAAG,CAAC,EACtCG,EAAS,IAAI,IAAI,WAAWT,CAAc,EAAGM,EAAO,UAAU,EACvDG,EAAS,MACnB,CACD,OAAOC,EAAY/P,EAAU,CACzB,GAAI,KAAK,eAAe+P,CAAU,EAAG,CACjC,IAAIzhB,EAAS,KAAK,cAAcyhB,CAAU,EAC1C,OAAO/P,EAAS1R,CAAM,CACzB,CACD,GAAI,OAAOyhB,GAAe,SAAU,CAChC,MAAMC,EAAc,KAAK,MAAMD,CAAU,EACnC,CAACE,EAAUpQ,EAAKyP,EAAO7U,EAAOwU,CAAO,EAAIe,EAC/C,OAAOhQ,EAAS,CAAE,SAAAiQ,EAAU,IAAApQ,EAAK,MAAAyP,EAAO,MAAA7U,EAAO,QAAAwU,CAAO,CAAE,CAC3D,CACD,OAAOjP,EAAS,EAAE,CACrB,CACD,cAAckQ,EAAQ,CAClB,MAAMN,EAAO,IAAI,SAASM,CAAM,EAC1BC,EAAOP,EAAK,SAAS,CAAC,EACtBQ,EAAU,IAAI,YACpB,OAAQD,EAAI,CACR,KAAK,KAAK,MAAM,cACZ,OAAO,KAAK,qBAAqBD,EAAQN,EAAMQ,CAAO,CAC7D,CACJ,CACD,qBAAqBF,EAAQN,EAAMQ,EAAS,CACxC,MAAMC,EAAYT,EAAK,SAAS,CAAC,EAC3BU,EAAgBV,EAAK,SAAS,CAAC,EAC/BW,EAAeX,EAAK,SAAS,CAAC,EAC9BY,EAAkBZ,EAAK,SAAS,CAAC,EACvC,IAAIC,EAAS,KAAK,cAAgB,EAClC,MAAMP,EAAQc,EAAQ,OAAOF,EAAO,MAAML,EAAQA,EAASQ,CAAS,CAAC,EACrER,EAASA,EAASQ,EAClB,MAAMb,EAAYY,EAAQ,OAAOF,EAAO,MAAML,EAAQA,EAASS,CAAa,CAAC,EAC7ET,EAASA,EAASS,EAClB,MAAMb,EAAWW,EAAQ,OAAOF,EAAO,MAAML,EAAQA,EAASU,CAAY,CAAC,EAC3EV,EAASA,EAASU,EAClB,MAAMtB,EAAUiB,EAAO,MAAML,EAAQK,EAAO,UAAU,EAChDO,EAAgBD,IAAoB,KAAK,cAAgB,KAAK,MAAMJ,EAAQ,OAAOnB,CAAO,CAAC,EAAIA,EAC/F3G,EAAO,CACT,KAAM,KAAK,gBACX,MAAOkH,EACP,QAASiB,CACrB,EAEQ,OAAIF,EAAe,IACfjI,EAAK,KAAU,KAAK,MAAMmH,CAAQ,GAE/B,CAAE,SAAU,KAAM,IAAK,KAAM,MAAOH,EAAO,MAAO,KAAK,gBAAiB,QAAShH,CAAI,CAC/F,CACD,eAAe4H,EAAQ,CACnB,IAAIxI,EACJ,OAAOwI,aAAkB,eAAiBxI,EAAqDwI,GAAO,eAAiB,MAAQxI,IAAO,OAAS,OAASA,EAAG,QAAU,aACxK,CACD,MAAM3J,EAAKE,EAAM,CACb,MAAI,CAACF,GAAO,OAAOA,GAAQ,SAChB,GAEJ,OAAO,YAAY,OAAO,QAAQA,CAAG,EAAE,OAAO,CAAC,CAACxT,CAAG,IAAM0T,EAAK,SAAS1T,CAAG,CAAC,CAAC,CACtF,CACL,CC1Ie,MAAMmmB,EAAM,CACvB,YAAY1Q,EAAU2Q,EAAW,CAC7B,KAAK,SAAW3Q,EAChB,KAAK,UAAY2Q,EACjB,KAAK,MAAQ,OACb,KAAK,MAAQ,EACb,KAAK,SAAW3Q,EAChB,KAAK,UAAY2Q,CACpB,CACD,OAAQ,CACJ,KAAK,MAAQ,EACb,aAAa,KAAK,KAAK,EACvB,KAAK,MAAQ,MAChB,CAED,iBAAkB,CACd,aAAa,KAAK,KAAK,EACvB,KAAK,MAAQ,WAAW,IAAM,CAC1B,KAAK,MAAQ,KAAK,MAAQ,EAC1B,KAAK,SAAQ,CACzB,EAAW,KAAK,UAAU,KAAK,MAAQ,CAAC,CAAC,CACpC,CACL,CC7BO,IAAIC,IACV,SAAUA,EAAe,CACtBA,EAAc,QAAa,UAC3BA,EAAc,KAAU,OACxBA,EAAc,KAAU,OACxBA,EAAc,UAAe,YAC7BA,EAAc,OAAY,SAC1BA,EAAc,OAAY,SAC1BA,EAAc,KAAU,OACxBA,EAAc,KAAU,OACxBA,EAAc,UAAe,YAC7BA,EAAc,KAAU,OACxBA,EAAc,UAAe,YAC7BA,EAAc,KAAU,OACxBA,EAAc,MAAW,QACzBA,EAAc,MAAW,QACzBA,EAAc,QAAa,UAC3BA,EAAc,IAAS,MACvBA,EAAc,QAAa,UAC3BA,EAAc,KAAU,OACxBA,EAAc,KAAU,OACxBA,EAAc,UAAe,YAC7BA,EAAc,YAAiB,cAC/BA,EAAc,OAAY,SAC1BA,EAAc,QAAa,UAC3BA,EAAc,UAAe,WACjC,GAAGA,KAAkBA,GAAgB,CAAE,EAAC,EAajC,MAAMC,GAAoB,CAAC5G,EAAS6G,EAAQ9nB,EAAU,KAAO,CAChE,IAAI0e,EACJ,MAAMqJ,GAAarJ,EAAK1e,EAAQ,aAAe,MAAQ0e,IAAO,OAASA,EAAK,GAC5E,OAAKoJ,EAGE,OAAO,KAAKA,CAAM,EAAE,OAAO,CAACvE,EAAKyE,KACpCzE,EAAIyE,CAAO,EAAIC,GAAcD,EAAS/G,EAAS6G,EAAQC,CAAS,EACzDxE,GACR,CAAE,GALM,EAMf,EAea0E,GAAgB,CAACC,EAAYjH,EAAS6G,EAAQC,IAAc,CACrE,MAAM1G,EAASJ,EAAQ,KAAMuC,GAAMA,EAAE,OAAS0E,CAAU,EAClDC,EAA0D9G,GAAO,KACjExgB,EAAQinB,EAAOI,CAAU,EAC/B,OAAIC,GAAW,CAACJ,EAAU,SAASI,CAAO,EAC/BC,GAAYD,EAAStnB,CAAK,EAE9BwnB,GAAKxnB,CAAK,CACrB,EAcaunB,GAAc,CAACtV,EAAMjS,IAAU,CAExC,GAAIiS,EAAK,OAAO,CAAC,IAAM,IAAK,CACxB,MAAMwV,EAAWxV,EAAK,MAAM,EAAGA,EAAK,MAAM,EAC1C,OAAOyV,GAAQ1nB,EAAOynB,CAAQ,CACjC,CAED,OAAQxV,EAAI,CACR,KAAK8U,GAAc,KACf,OAAOY,GAAU3nB,CAAK,EAC1B,KAAK+mB,GAAc,OACnB,KAAKA,GAAc,OACnB,KAAKA,GAAc,KACnB,KAAKA,GAAc,KACnB,KAAKA,GAAc,KACnB,KAAKA,GAAc,QACnB,KAAKA,GAAc,IACf,OAAOa,GAAS5nB,CAAK,EACzB,KAAK+mB,GAAc,KACnB,KAAKA,GAAc,MACf,OAAOc,GAAO7nB,CAAK,EACvB,KAAK+mB,GAAc,UACf,OAAOe,GAAkB9nB,CAAK,EAClC,KAAK+mB,GAAc,QACnB,KAAKA,GAAc,KACnB,KAAKA,GAAc,UACnB,KAAKA,GAAc,UACnB,KAAKA,GAAc,UACnB,KAAKA,GAAc,MACnB,KAAKA,GAAc,QACnB,KAAKA,GAAc,KACnB,KAAKA,GAAc,KACnB,KAAKA,GAAc,YACnB,KAAKA,GAAc,OACnB,KAAKA,GAAc,QACnB,KAAKA,GAAc,UACf,OAAOS,GAAKxnB,CAAK,EACrB,QAEI,OAAOwnB,GAAKxnB,CAAK,CACxB,CACL,EACMwnB,GAAQxnB,GACHA,EAEE2nB,GAAa3nB,GAAU,CAChC,OAAQA,EAAK,CACT,IAAK,IACD,MAAO,GACX,IAAK,IACD,MAAO,GACX,QACI,OAAOA,CACd,CACL,EACa4nB,GAAY5nB,GAAU,CAC/B,GAAI,OAAOA,GAAU,SAAU,CAC3B,MAAM+nB,EAAc,WAAW/nB,CAAK,EACpC,GAAI,CAAC,OAAO,MAAM+nB,CAAW,EACzB,OAAOA,CAEd,CACD,OAAO/nB,CACX,EACa6nB,GAAU7nB,GAAU,CAC7B,GAAI,OAAOA,GAAU,SACjB,GAAI,CACA,OAAO,KAAK,MAAMA,CAAK,CAC1B,MACa,CAEV,OAAOA,CACV,CAEL,OAAOA,CACX,EAWa0nB,GAAU,CAAC1nB,EAAOiS,IAAS,CACpC,GAAI,OAAOjS,GAAU,SACjB,OAAOA,EAEX,MAAMgoB,EAAUhoB,EAAM,OAAS,EACzBioB,EAAajoB,EAAMgoB,CAAO,EAGhC,GAFkBhoB,EAAM,CAAC,IAEP,KAAOioB,IAAe,IAAK,CACzC,IAAIC,EACJ,MAAMC,EAAUnoB,EAAM,MAAM,EAAGgoB,CAAO,EAEtC,GAAI,CACAE,EAAM,KAAK,MAAM,IAAMC,EAAU,GAAG,CACvC,MACS,CAEND,EAAMC,EAAUA,EAAQ,MAAM,GAAG,EAAI,EACxC,CACD,OAAOD,EAAI,IAAKE,GAAQb,GAAYtV,EAAMmW,CAAG,CAAC,CACjD,CACD,OAAOpoB,CACX,EAQa8nB,GAAqB9nB,GAC1B,OAAOA,GAAU,SACVA,EAAM,QAAQ,IAAK,GAAG,EAE1BA,EAEEqoB,GAAmBC,GAAc,CAC1C,MAAMC,EAAQ,IAAI,IAAID,CAAS,EAC/B,OAAAC,EAAM,SAAWA,EAAM,SAAS,QAAQ,OAAQ,MAAM,EACtDA,EAAM,SAAWA,EAAM,SAClB,QAAQ,OAAQ,EAAE,EAClB,QAAQ,wBAAyB,EAAE,EACnC,QAAQ,aAAc,EAAE,EACxB,QAAQ,gBAAiB,EAAE,EAC5BA,EAAM,WAAa,IAAMA,EAAM,WAAa,IAC5CA,EAAM,SAAW,iBAGjBA,EAAM,SAAWA,EAAM,SAAW,iBAE/BA,EAAM,IACjB,ECnOe,MAAMC,EAAK,CAStB,YAAYC,EAAS7X,EAAOwU,EAAU,CAAE,EAAElH,EAAUuG,GAAiB,CACjE,KAAK,QAAUgE,EACf,KAAK,MAAQ7X,EACb,KAAK,QAAUwU,EACf,KAAK,QAAUlH,EACf,KAAK,KAAO,GACZ,KAAK,aAAe,OACpB,KAAK,IAAM,GACX,KAAK,aAAe,KACpB,KAAK,SAAW,GAChB,KAAK,SAAW,IACnB,CACD,OAAOA,EAAS,CACZ,KAAK,QAAUA,EACf,KAAK,gBAAe,EACpB,KAAK,IAAM,GACX,KAAK,SAAW,KAChB,KAAK,aAAe,KACpB,KAAK,KAAO,GACZ,KAAK,KAAI,CACZ,CACD,MAAO,CACC,KAAK,aAAa,SAAS,IAG/B,KAAK,aAAY,EACjB,KAAK,KAAO,GACZ,KAAK,QAAQ,OAAO,KAAK,CACrB,MAAO,KAAK,QAAQ,MACpB,MAAO,KAAK,MACZ,QAAS,KAAK,QACd,IAAK,KAAK,IACV,SAAU,KAAK,QAAQ,SAAU,CAC7C,CAAS,EACJ,CACD,cAAckH,EAAS,CACnB,KAAK,QAAU,OAAO,OAAO,OAAO,OAAO,GAAI,KAAK,OAAO,EAAGA,CAAO,CACxE,CACD,QAAQ5F,EAAQrJ,EAAU,CACtB,IAAI0H,EACJ,OAAI,KAAK,aAAa2B,CAAM,GACxBrJ,GAAU0H,EAAK,KAAK,gBAAkB,MAAQA,IAAO,OAAS,OAASA,EAAG,QAAQ,EAEtF,KAAK,SAAS,KAAK,CAAE,OAAA2B,EAAQ,SAAArJ,CAAU,GAChC,IACV,CACD,cAAe,CACX,GAAI,KAAK,aACL,OAEJ,KAAK,IAAM,KAAK,QAAQ,OAAO,SAAQ,EACvC,KAAK,SAAW,KAAK,QAAQ,gBAAgB,KAAK,GAAG,EACrD,MAAMA,EAAYiP,GAAY,CAC1B,KAAK,gBAAe,EACpB,KAAK,eAAc,EACnB,KAAK,aAAeA,EACpB,KAAK,cAAcA,CAAO,CACtC,EACQ,KAAK,QAAQ,IAAI,KAAK,SAAU,GAAIjP,CAAQ,EAC5C,KAAK,aAAe,WAAW,IAAM,CACjC,KAAK,QAAQ,UAAW,EAAE,CACtC,EAAW,KAAK,OAAO,CAClB,CACD,QAAQqJ,EAAQnB,EAAU,CAClB,KAAK,UACL,KAAK,QAAQ,SAAS,KAAK,SAAU,CAAE,OAAAmB,EAAQ,SAAAnB,CAAQ,CAAE,CAChE,CACD,SAAU,CACN,KAAK,gBAAe,EACpB,KAAK,eAAc,CACtB,CACD,iBAAkB,CACT,KAAK,UAGV,KAAK,QAAQ,KAAK,KAAK,SAAU,CAAE,EACtC,CACD,gBAAiB,CACb,aAAa,KAAK,YAAY,EAC9B,KAAK,aAAe,MACvB,CACD,cAAc,CAAE,OAAAmB,EAAQ,SAAAnB,GAAY,CAChC,KAAK,SAAS,OAAQqK,GAAMA,EAAE,SAAWlJ,CAAM,EAAE,QAASkJ,GAAMA,EAAE,SAASrK,CAAQ,CAAC,CACvF,CACD,aAAamB,EAAQ,CACjB,OAAO,KAAK,cAAgB,KAAK,aAAa,SAAWA,CAC5D,CACL,CC7FO,IAAImJ,IACV,SAAUA,EAAiC,CACxCA,EAAgC,KAAU,OAC1CA,EAAgC,KAAU,OAC1CA,EAAgC,MAAW,OAC/C,GAAGA,KAAoCA,GAAkC,CAAE,EAAC,EAC7D,MAAMC,EAAiB,CAgBlC,YAAYH,EAASI,EAAM,CACvB,KAAK,QAAUJ,EACf,KAAK,MAAQ,GACb,KAAK,aAAe,GACpB,KAAK,QAAU,KACf,KAAK,QAAU,GACf,KAAK,OAAS,CACV,OAAQ,IAAM,CAAG,EACjB,QAAS,IAAM,CAAG,EAClB,OAAQ,IAAM,CAAG,CAC7B,EACQ,MAAMK,EAAsDD,GAAK,QAAW,CACxE,MAAO,iBACP,KAAM,eAClB,EACQ,KAAK,QAAQ,IAAIC,EAAO,MAAO,GAAKvQ,GAAa,CAC7C,KAAM,CAAE,OAAAwQ,EAAQ,QAAAC,EAAS,OAAAC,CAAM,EAAK,KAAK,OACzC,KAAK,QAAU,KAAK,QAAQ,SAAQ,EACpC,KAAK,MAAQL,GAAiB,UAAU,KAAK,MAAOrQ,EAAUwQ,EAAQC,CAAO,EAC7E,KAAK,aAAa,QAASE,GAAS,CAChC,KAAK,MAAQN,GAAiB,SAAS,KAAK,MAAOM,EAAMH,EAAQC,CAAO,CACxF,CAAa,EACD,KAAK,aAAe,GACpBC,GACZ,CAAS,EACD,KAAK,QAAQ,IAAIH,EAAO,KAAM,GAAKI,GAAS,CACxC,KAAM,CAAE,OAAAH,EAAQ,QAAAC,EAAS,OAAAC,CAAM,EAAK,KAAK,OACrC,KAAK,qBACL,KAAK,aAAa,KAAKC,CAAI,GAG3B,KAAK,MAAQN,GAAiB,SAAS,KAAK,MAAOM,EAAMH,EAAQC,CAAO,EACxEC,IAEhB,CAAS,EACD,KAAK,OAAO,CAACvoB,EAAKyoB,EAAkBC,IAAiB,CACjD,KAAK,QAAQ,SAAS,WAAY,CAC9B,MAAO,OACP,IAAA1oB,EACA,iBAAAyoB,EACA,aAAAC,CAChB,CAAa,CACb,CAAS,EACD,KAAK,QAAQ,CAAC1oB,EAAKyoB,EAAkBE,IAAkB,CACnD,KAAK,QAAQ,SAAS,WAAY,CAC9B,MAAO,QACP,IAAA3oB,EACA,iBAAAyoB,EACA,cAAAE,CAChB,CAAa,CACb,CAAS,EACD,KAAK,OAAO,IAAM,CACd,KAAK,QAAQ,SAAS,WAAY,CAAE,MAAO,MAAM,CAAE,CAC/D,CAAS,CACJ,CAWD,OAAO,UAAUC,EAAc/Q,EAAUwQ,EAAQC,EAAS,CACtD,MAAMvoB,EAAQ,KAAK,UAAU6oB,CAAY,EACnCC,EAAmB,KAAK,eAAehR,CAAQ,EAC/CiR,EAAQ,GACRC,EAAS,GACf,YAAK,IAAIhpB,EAAO,CAACC,EAAKgpB,IAAc,CAC3BH,EAAiB7oB,CAAG,IACrB+oB,EAAO/oB,CAAG,EAAIgpB,EAE9B,CAAS,EACD,KAAK,IAAIH,EAAkB,CAAC7oB,EAAK0oB,IAAiB,CAC9C,MAAMD,EAAmB1oB,EAAMC,CAAG,EAClC,GAAIyoB,EAAkB,CAClB,MAAMQ,EAAkBP,EAAa,IAAKtqB,GAAMA,EAAE,YAAY,EACxD8qB,EAAkBT,EAAiB,IAAKrqB,GAAMA,EAAE,YAAY,EAC5D+qB,EAAkBT,EAAa,OAAQtqB,GAAM8qB,EAAgB,QAAQ9qB,EAAE,YAAY,EAAI,CAAC,EACxFuqB,EAAgBF,EAAiB,OAAQrqB,GAAM6qB,EAAgB,QAAQ7qB,EAAE,YAAY,EAAI,CAAC,EAC5F+qB,EAAgB,OAAS,IACzBL,EAAM9oB,CAAG,EAAImpB,GAEbR,EAAc,OAAS,IACvBI,EAAO/oB,CAAG,EAAI2oB,EAErB,MAEGG,EAAM9oB,CAAG,EAAI0oB,CAE7B,CAAS,EACM,KAAK,SAAS3oB,EAAO,CAAE,MAAA+oB,EAAO,OAAAC,CAAQ,EAAEV,EAAQC,CAAO,CACjE,CAWD,OAAO,SAASvoB,EAAOyoB,EAAMH,EAAQC,EAAS,CAC1C,KAAM,CAAE,MAAAQ,EAAO,OAAAC,GAAW,CACtB,MAAO,KAAK,eAAeP,EAAK,KAAK,EACrC,OAAQ,KAAK,eAAeA,EAAK,MAAM,CACnD,EACQ,OAAKH,IACDA,EAAS,IAAM,IAEdC,IACDA,EAAU,IAAM,IAEpB,KAAK,IAAIQ,EAAO,CAAC9oB,EAAK0oB,IAAiB,CACnC,IAAIvL,EACJ,MAAMsL,GAAoBtL,EAAKpd,EAAMC,CAAG,KAAO,MAAQmd,IAAO,OAASA,EAAK,GAE5E,GADApd,EAAMC,CAAG,EAAI,KAAK,UAAU0oB,CAAY,EACpCD,EAAiB,OAAS,EAAG,CAC7B,MAAMW,EAAqBrpB,EAAMC,CAAG,EAAE,IAAK5B,GAAMA,EAAE,YAAY,EACzDirB,EAAeZ,EAAiB,OAAQrqB,GAAMgrB,EAAmB,QAAQhrB,EAAE,YAAY,EAAI,CAAC,EAClG2B,EAAMC,CAAG,EAAE,QAAQ,GAAGqpB,CAAY,CACrC,CACDhB,EAAOroB,EAAKyoB,EAAkBC,CAAY,CACtD,CAAS,EACD,KAAK,IAAIK,EAAQ,CAAC/oB,EAAK2oB,IAAkB,CACrC,IAAIF,EAAmB1oB,EAAMC,CAAG,EAChC,GAAI,CAACyoB,EACD,OACJ,MAAMa,EAAuBX,EAAc,IAAKvqB,GAAMA,EAAE,YAAY,EACpEqqB,EAAmBA,EAAiB,OAAQrqB,GAAMkrB,EAAqB,QAAQlrB,EAAE,YAAY,EAAI,CAAC,EAClG2B,EAAMC,CAAG,EAAIyoB,EACbH,EAAQtoB,EAAKyoB,EAAkBE,CAAa,EACxCF,EAAiB,SAAW,GAC5B,OAAO1oB,EAAMC,CAAG,CAChC,CAAS,EACMD,CACV,CAED,OAAO,IAAIyT,EAAK+V,EAAM,CAClB,OAAO,OAAO,oBAAoB/V,CAAG,EAAE,IAAKxT,GAAQupB,EAAKvpB,EAAKwT,EAAIxT,CAAG,CAAC,CAAC,CAC1E,CAwBD,OAAO,eAAeD,EAAO,CACzB,OAAAA,EAAQ,KAAK,UAAUA,CAAK,EACrB,OAAO,oBAAoBA,CAAK,EAAE,OAAO,CAAC8X,EAAU7X,IAAQ,CAC/D,MAAMgpB,EAAYjpB,EAAMC,CAAG,EAC3B,MAAI,UAAWgpB,EACXnR,EAAS7X,CAAG,EAAIgpB,EAAU,MAAM,IAAKQ,IACjCA,EAAS,aAAkBA,EAAS,QACpC,OAAOA,EAAS,QAChB,OAAOA,EAAS,aACTA,EACV,EAGD3R,EAAS7X,CAAG,EAAIgpB,EAEbnR,CACV,EAAE,CAAE,EACR,CAED,OAAO,UAAUrE,EAAK,CAClB,OAAO,KAAK,MAAM,KAAK,UAAUA,CAAG,CAAC,CACxC,CAED,OAAOiC,EAAU,CACb,KAAK,OAAO,OAASA,CACxB,CAED,QAAQA,EAAU,CACd,KAAK,OAAO,QAAUA,CACzB,CAED,OAAOA,EAAU,CACb,KAAK,OAAO,OAASA,CACxB,CAED,oBAAqB,CACjB,MAAO,CAAC,KAAK,SAAW,KAAK,UAAY,KAAK,QAAQ,UACzD,CACL,CCjOO,IAAIgU,IACV,SAAUA,EAAwC,CAC/CA,EAAuC,IAAS,IAChDA,EAAuC,OAAY,SACnDA,EAAuC,OAAY,SACnDA,EAAuC,OAAY,QACvD,GAAGA,KAA2CA,GAAyC,CAAE,EAAC,EACnF,IAAIC,IACV,SAAUA,EAAuB,CAC9BA,EAAsB,UAAe,YACrCA,EAAsB,SAAc,WACpCA,EAAsB,iBAAsB,mBAC5CA,EAAsB,OAAY,QACtC,GAAGA,KAA0BA,GAAwB,CAAE,EAAC,EACjD,IAAIC,IACV,SAAUA,EAA2B,CAClCA,EAA0B,WAAgB,aAC1CA,EAA0B,UAAe,YACzCA,EAA0B,OAAY,SACtCA,EAA0B,cAAmB,eACjD,GAAGA,KAA8BA,GAA4B,CAAE,EAAC,EAOjD,MAAMC,EAAgB,CAiBjC,YAEA7E,EAAO9e,EAAS,CAAE,OAAQ,CAAE,GAAI4jB,EAAQ,CACpC,IAAI1M,EAAImB,EA2DR,GA1DA,KAAK,MAAQyG,EACb,KAAK,OAAS9e,EACd,KAAK,OAAS4jB,EACd,KAAK,SAAW,GAChB,KAAK,MAAQ1F,GAAe,OAC5B,KAAK,WAAa,GAClB,KAAK,WAAa,GAClB,KAAK,SAAWY,EAAM,QAAQ,cAAe,EAAE,EAC/C,KAAK,OAAO,OAAS,OAAO,OAAO,CAC/B,UAAW,CAAE,IAAK,GAAO,KAAM,EAAO,EACtC,SAAU,CAAE,IAAK,GAAI,QAAS,EAAO,EACrC,QAAS,EACrB,EAAW9e,EAAO,MAAM,EAChB,KAAK,QAAU,KAAK,OAAO,QAC3B,KAAK,SAAW,IAAI6hB,GAAK,KAAM1D,GAAe,KAAM,KAAK,OAAQ,KAAK,OAAO,EAC7E,KAAK,YAAc,IAAI+B,GAAM,IAAM,KAAK,sBAAqB,EAAI,KAAK,OAAO,gBAAgB,EAC7F,KAAK,SAAS,QAAQ,KAAM,IAAM,CAC9B,KAAK,MAAQhC,GAAe,OAC5B,KAAK,YAAY,QACjB,KAAK,WAAW,QAAS2F,GAAcA,EAAU,KAAI,CAAE,EACvD,KAAK,WAAa,EAC9B,CAAS,EACD,KAAK,SAAS,IAAM,CAChB,KAAK,YAAY,QACjB,KAAK,OAAO,IAAI,UAAW,SAAS,KAAK,KAAK,IAAI,KAAK,SAAU,GAAE,EACnE,KAAK,MAAQ3F,GAAe,OAC5B,KAAK,OAAO,QAAQ,IAAI,CACpC,CAAS,EACD,KAAK,SAAU4F,GAAW,CAClB,KAAK,WAAU,GAAM,KAAK,UAAS,IAGvC,KAAK,OAAO,IAAI,UAAW,SAAS,KAAK,KAAK,GAAIA,CAAM,EACxD,KAAK,MAAQ5F,GAAe,QAC5B,KAAK,YAAY,kBAC7B,CAAS,EACD,KAAK,SAAS,QAAQ,UAAW,IAAM,CAC9B,KAAK,eAGV,KAAK,OAAO,IAAI,UAAW,WAAW,KAAK,KAAK,GAAI,KAAK,SAAS,OAAO,EACzE,KAAK,MAAQA,GAAe,QAC5B,KAAK,YAAY,kBAC7B,CAAS,EACD,KAAK,SAAS,QAAQ,QAAU4F,GAAW,CACnC,KAAK,WAAU,GAAM,KAAK,UAAS,IAGvC,KAAK,OAAO,IAAI,UAAW,SAAS,KAAK,KAAK,GAAIA,CAAM,EACxD,KAAK,MAAQ5F,GAAe,QAC5B,KAAK,YAAY,kBAC7B,CAAS,EACD,KAAK,IAAIC,GAAe,MAAO,GAAI,CAACM,EAASpP,IAAQ,CACjD,KAAK,SAAS,KAAK,gBAAgBA,CAAG,EAAGoP,CAAO,CAC5D,CAAS,EACD,KAAK,SAAW,IAAIwD,GAAiB,IAAI,EACzC,KAAK,qBAAuBP,GAAgB,KAAK,OAAO,QAAQ,EAChE,KAAK,QAAU,KAAK,OAAO,OAAO,SAAW,GACzC,CAAC,KAAK,UAAa,GAAArJ,GAAMnB,EAAK,KAAK,OAAO,UAAY,MAAQA,IAAO,OAAS,OAASA,EAAG,aAAe,MAAQmB,IAAO,SAAkBA,EAAG,QAC7I,KAAM,0CAA0C,KAAK,KAAK,kCAEjE,CAED,UAAU7I,EAAU+H,EAAU,KAAK,QAAS,CACxC,IAAIL,EAAImB,EAAIK,EAIZ,GAHK,KAAK,OAAO,eACb,KAAK,OAAO,UAEZ,KAAK,OAASwF,GAAe,OAAQ,CACrC,KAAM,CAAE,OAAQ,CAAE,UAAA6F,EAAW,SAAAR,EAAU,QAASS,CAAW,GAAM,KAAK,OAChEC,GAAoB5L,GAAMnB,EAAK,KAAK,SAAS,oBAAsB,MAAQA,IAAO,OAAS,OAASA,EAAG,IAAKgN,GAAMA,EAAE,MAAM,KAAO,MAAQ7L,IAAO,OAASA,EAAK,GAC9J8L,EAAoB,CAAC,CAAC,KAAK,SAASV,GAAsB,QAAQ,GACpE,KAAK,SAASA,GAAsB,QAAQ,EAAE,OAAS,KACrD/K,EAAK,KAAK,OAAO,OAAO,YAAc,MAAQA,IAAO,OAAS,OAASA,EAAG,WAAa,GACvF0L,EAAqB,GACrBhJ,EAAS,CACX,UAAA2I,EACA,SAAU,OAAO,OAAO,OAAO,OAAO,GAAIR,CAAQ,EAAG,CAAE,QAASY,EAAkB,EAClF,iBAAAF,EACA,QAASD,CACzB,EACgB,KAAK,OAAO,mBACZI,EAAmB,aAAe,KAAK,OAAO,kBAElD,KAAK,SAAUC,GAA0D7U,IAASkU,GAA0B,cAAeW,CAAC,CAAC,EAC7H,KAAK,SAAS,IAA0D7U,IAASkU,GAA0B,MAAM,CAAC,EAClH,KAAK,kBAAkB,OAAO,OAAO,CAAE,OAAAtI,CAAQ,EAAEgJ,CAAkB,CAAC,EACpE,KAAK,WAAa,GAClB,KAAK,QAAQ7M,CAAO,EACpB,KAAK,SACA,QAAQ,KAAM,MAAO,CAAE,iBAAA0M,KAAuB,CAC/C,IAAI/M,EAEJ,GADA,KAAK,OAAO,UACR+M,IAAqB,OAAW,CACoBzU,IAASkU,GAA0B,UAAU,EACjG,MACH,KACI,CACD,MAAMY,EAAyB,KAAK,SAAS,iBACvCC,GAAerN,EAAqFoN,GAAuB,UAAY,MAAQpN,IAAO,OAASA,EAAK,EACpKsN,EAAsB,GAC5B,QAASjoB,EAAI,EAAGA,EAAIgoB,EAAahoB,IAAK,CAClC,MAAMkoB,EAAwBH,EAAuB/nB,CAAC,EAChD,CAAE,OAAQ,CAAE,MAAA0N,EAAO,OAAA0R,EAAQ,MAAA+I,EAAO,OAAAC,CAAM,CAAK,EAAGF,EAChDG,EAAuBX,GAAoBA,EAAiB1nB,CAAC,EACnE,GAAIqoB,GACAA,EAAqB,QAAU3a,GAC/B2a,EAAqB,SAAWjJ,GAChCiJ,EAAqB,QAAUF,GAC/BE,EAAqB,SAAWD,EAChCH,EAAoB,KAAK,OAAO,OAAO,OAAO,OAAO,GAAIC,CAAqB,EAAG,CAAE,GAAIG,EAAqB,EAAE,CAAE,CAAC,MAEhH,CACD,KAAK,YAAW,EAChB,KAAK,MAAQ1G,GAAe,QACwB1O,IAASkU,GAA0B,cAAe,IAAI,MAAM,kEAAkE,CAAC,EACnL,MACH,CACJ,CACD,KAAK,SAAS,iBAAmBc,EACjChV,GAAYA,EAASkU,GAA0B,UAAU,EACzD,MACH,CACjB,CAAa,EACI,QAAQ,QAAUvoB,GAAU,CAC7B,KAAK,MAAQ+iB,GAAe,QACwB1O,IAASkU,GAA0B,cAAe,IAAI,MAAM,KAAK,UAAU,OAAO,OAAOvoB,CAAK,EAAE,KAAK,IAAI,GAAK,OAAO,CAAC,CAAC,CAE3L,CAAa,EACI,QAAQ,UAAW,IAAM,CAC0BqU,IAASkU,GAA0B,SAAS,CAEhH,CAAa,CACJ,CACD,OAAO,IACV,CAOD,eAAgB,CACZ,OAAO,KAAK,SAAS,KACxB,CAKD,MAAM,MAAMjF,EAASyD,EAAO,GAAI,CAC5B,OAAO,MAAM,KAAK,KAAK,CACnB,KAAM,WACN,MAAO,QACP,QAAAzD,CACH,EAAEyD,EAAK,SAAW,KAAK,OAAO,CAClC,CAID,MAAM,QAAQA,EAAO,GAAI,CACrB,OAAO,MAAM,KAAK,KAAK,CACnB,KAAM,WACN,MAAO,SACV,EAAEA,CAAI,CACV,CACD,GAAG5W,EAAMqZ,EAAQnV,EAAU,CACvB,OAAI,KAAK,QAAU0O,GAAe,QAAU5S,IAASmY,GAAsB,WACvE,KAAK,OAAO,IAAI,UAAW,kBAAkB,KAAK,KAAK,wDAAwD,EAC/G,KAAK,YAAW,EAAG,KAAK,IAAM,KAAK,UAAS,CAAE,GAE3C,KAAK,IAAInY,EAAMqZ,EAAQnV,CAAQ,CACzC,CAYD,MAAM,SAASvF,EAAOwU,EAASyD,EAAO,GAAI,CACtC,IAAIhL,EACJ,MAAM2N,EAAgB,KAAK,OAAO,iBAC5B,UAAU,KAAK,OAAO,gBAAgB,GACtC,GACN,GAA6BpG,GAAY,KACrC,OAAO,QAAQ,OAAO,oCAAoC,EAE9D,MAAMjmB,EAAU,CACZ,OAAQ,OACR,QAAS,CACL,cAAeqsB,EACf,OAAQ,KAAK,OAAO,OAAS,KAAK,OAAO,OAAS,GAClD,eAAgB,kBACnB,EACD,KAAM,KAAK,UAAU,CACjB,SAAU,CACN,CACI,MAAO,KAAK,SACZ,MAAA5a,EACA,QAASwU,EACT,QAAS,KAAK,OACjB,CACJ,CACjB,CAAa,CACb,EACc/G,EAAW,MAAM,KAAK,kBAAkB,KAAK,qBAAsBlf,GAAU0e,EAAKgL,EAAK,WAAa,MAAQhL,IAAO,OAASA,EAAK,KAAK,OAAO,EACnJ,GAAIQ,EAAS,SAAW,IACpB,MAAO,CAAE,QAAS,IAEtB,IAAI4F,EAAe5F,EAAS,WAC5B,GAAI,CACA,MAAMoN,EAAY,MAAMpN,EAAS,OACjC4F,EAAewH,EAAU,OAASA,EAAU,SAAWxH,CAC1D,MACU,CAAG,CACd,OAAO,QAAQ,OAAO,IAAI,MAAMA,CAAY,CAAC,CAChD,CAUD,MAAM,KAAKjH,EAAM6L,EAAO,GAAI,CACxB,IAAIhL,EAAImB,EACR,GAAI,CAAC,KAAK,SAAQ,GAAMhC,EAAK,OAAS,YAAa,CAI/C,KAAM,CAAE,MAAApM,EAAO,QAAS8a,CAAgB,EAAK1O,EAIvC7d,EAAU,CACZ,OAAQ,OACR,QAAS,CACL,cANc,KAAK,OAAO,iBAC5B,UAAU,KAAK,OAAO,gBAAgB,GACtC,GAKE,OAAQ,KAAK,OAAO,OAAS,KAAK,OAAO,OAAS,GAClD,eAAgB,kBACnB,EACD,KAAM,KAAK,UAAU,CACjB,SAAU,CACN,CACI,MAAO,KAAK,SACZ,MAAAyR,EACA,QAAS8a,EACT,QAAS,KAAK,OACjB,CACJ,CACrB,CAAiB,CACjB,EACY,GAAI,CACA,MAAMrN,EAAW,MAAM,KAAK,kBAAkB,KAAK,qBAAsBlf,GAAU0e,EAAKgL,EAAK,WAAa,MAAQhL,IAAO,OAASA,EAAK,KAAK,OAAO,EACnJ,cAAQmB,EAAKX,EAAS,QAAU,MAAQW,IAAO,OAAS,OAASA,EAAG,OAAQ,GACrEX,EAAS,GAAK,KAAO,OAC/B,OACMvc,EAAO,CACV,OAAIA,EAAM,OAAS,aACR,YAGA,OAEd,CACJ,KAEG,QAAO,IAAI,QAAS6pB,GAAY,CAC5B,IAAI9N,EAAImB,EAAIK,EACZ,MAAM1d,EAAO,KAAK,MAAMqb,EAAK,KAAMA,EAAM6L,EAAK,SAAW,KAAK,OAAO,EACjE7L,EAAK,OAAS,aAAe,EAAG,GAAAqC,GAAML,GAAMnB,EAAK,KAAK,UAAY,MAAQA,IAAO,OAAS,OAASA,EAAG,UAAY,MAAQmB,IAAO,OAAS,OAASA,EAAG,aAAe,MAAQK,IAAO,SAAkBA,EAAG,MACzMsM,EAAQ,IAAI,EAEhBhqB,EAAK,QAAQ,KAAM,IAAMgqB,EAAQ,IAAI,CAAC,EACtChqB,EAAK,QAAQ,QAAS,IAAMgqB,EAAQ,OAAO,CAAC,EAC5ChqB,EAAK,QAAQ,UAAW,IAAMgqB,EAAQ,WAAW,CAAC,CAClE,CAAa,CAER,CAKD,kBAAkBvG,EAAS,CACvB,KAAK,SAAS,cAAcA,CAAO,CACtC,CAUD,YAAYlH,EAAU,KAAK,QAAS,CAChC,KAAK,MAAQ2G,GAAe,QAC5B,MAAM+G,EAAU,IAAM,CAClB,KAAK,OAAO,IAAI,UAAW,SAAS,KAAK,KAAK,EAAE,EAChD,KAAK,SAAS9G,GAAe,MAAO,QAAS,KAAK,SAAQ,CAAE,CACxE,EACQ,KAAK,SAAS,UACd,IAAI+G,EAAY,KAChB,OAAO,IAAI,QAASF,GAAY,CAC5BE,EAAY,IAAIrD,GAAK,KAAM1D,GAAe,MAAO,GAAI5G,CAAO,EAC5D2N,EACK,QAAQ,KAAM,IAAM,CACrBD,IACAD,EAAQ,IAAI,CAC5B,CAAa,EACI,QAAQ,UAAW,IAAM,CAC1BC,IACAD,EAAQ,WAAW,CACnC,CAAa,EACI,QAAQ,QAAS,IAAM,CACxBA,EAAQ,OAAO,CAC/B,CAAa,EACDE,EAAU,KAAI,EACT,KAAK,YACNA,EAAU,QAAQ,KAAM,EAAE,CAE1C,CAAS,EAAE,QAAQ,IAAM,CACyCA,GAAU,SAC5E,CAAS,CACJ,CAMD,UAAW,CACP,KAAK,WAAW,QAASlqB,GAASA,EAAK,QAAO,CAAE,EAChD,KAAK,WAAa,GAClB,KAAK,YAAY,QACjB,KAAK,SAAS,UACd,KAAK,MAAQkjB,GAAe,OAC5B,KAAK,SAAW,EACnB,CAED,MAAM,kBAAkBhjB,EAAK1C,EAAS+e,EAAS,CAC3C,MAAM4N,EAAa,IAAI,gBACjBhd,EAAK,WAAW,IAAMgd,EAAW,MAAK,EAAI5N,CAAO,EACjDG,EAAW,MAAM,KAAK,OAAO,MAAMxc,EAAK,OAAO,OAAO,OAAO,OAAO,GAAI1C,CAAO,EAAG,CAAE,OAAQ2sB,EAAW,MAAQ,EAAC,EACtH,oBAAahd,CAAE,EACRuP,CACV,CAED,MAAMzN,EAAOwU,EAASlH,EAAU,KAAK,QAAS,CAC1C,GAAI,CAAC,KAAK,WACN,KAAM,kBAAkBtN,CAAK,SAAS,KAAK,KAAK,kEAEpD,IAAI4Z,EAAY,IAAIhC,GAAK,KAAM5X,EAAOwU,EAASlH,CAAO,EACtD,OAAI,KAAK,WACLsM,EAAU,KAAI,EAGd,KAAK,iBAAiBA,CAAS,EAE5BA,CACV,CAED,iBAAiBA,EAAW,CAIxB,GAHAA,EAAU,aAAY,EACtB,KAAK,WAAW,KAAKA,CAAS,EAE1B,KAAK,WAAW,OAAS7F,GAAsB,CAC/C,MAAMoH,EAAc,KAAK,WAAW,MAAK,EACrCA,IACAA,EAAY,QAAO,EACnB,KAAK,OAAO,IAAI,UAAW,0CAA0CA,EAAY,KAAK,GAAIA,EAAY,OAAO,EAEpH,CACJ,CASD,WAAWC,EAAQ5G,EAAS6G,EAAM,CAC9B,OAAO7G,CACV,CAED,UAAUK,EAAO,CACb,OAAO,KAAK,QAAUA,CACzB,CAED,UAAW,CACP,OAAO,KAAK,SAAS,GACxB,CAED,SAASxT,EAAMmT,EAASpP,EAAK,CACzB,IAAI6H,EAAImB,EACR,MAAMkN,EAAYja,EAAK,oBACjB,CAAE,MAAAka,EAAO,MAAArqB,EAAO,MAAAsqB,EAAO,KAAAC,CAAI,EAAKvH,GAEtC,GAAI9O,GADW,CAACmW,EAAOrqB,EAAOsqB,EAAOC,CAAI,EACvB,QAAQH,CAAS,GAAK,GAAKlW,IAAQ,KAAK,WACtD,OAEJ,IAAIsW,EAAiB,KAAK,WAAWJ,EAAW9G,EAASpP,CAAG,EAC5D,GAAIoP,GAAW,CAACkH,EACZ,KAAM,8EAEN,CAAC,SAAU,SAAU,QAAQ,EAAE,SAASJ,CAAS,GAChDrO,EAAK,KAAK,SAAS,oBAAsB,MAAQA,IAAO,QAAkBA,EAAG,OAAQ0O,GAAS,CAC3F,IAAI1O,EAAImB,EAAIK,EACZ,QAASxB,EAAK0O,EAAK,UAAY,MAAQ1O,IAAO,OAAS,OAASA,EAAG,SAAW,OAASwB,GAAML,EAAKuN,EAAK,UAAY,MAAQvN,IAAO,OAAS,OAASA,EAAG,SAAW,MAAQK,IAAO,OAAS,OAASA,EAAG,kBAAmB,KAAM6M,CAC/O,CAAa,EAAE,IAAKK,GAASA,EAAK,SAASD,EAAgBtW,CAAG,CAAC,GAGlDgJ,EAAK,KAAK,SAASkN,CAAS,KAAO,MAAQlN,IAAO,QAAkBA,EAAG,OAAQuN,GAAS,CACrF,IAAI1O,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EACxB,GAAI,CAAC,YAAa,WAAY,kBAAkB,EAAE,SAASqM,CAAS,EAChE,GAAI,OAAQK,EAAM,CACd,MAAMC,EAASD,EAAK,GACdE,GAAa5O,EAAK0O,EAAK,UAAY,MAAQ1O,IAAO,OAAS,OAASA,EAAG,MAC7E,OAAQ2O,KACFxN,EAAKoG,EAAQ,OAAS,MAAQpG,IAAO,OAAS,OAASA,EAAG,SAASwN,CAAM,KAC1EC,IAAc,KAC4CA,GAAU,kBAAmB,MAAQpN,EAAK+F,EAAQ,QAAU,MAAQ/F,IAAO,OAAS,OAASA,EAAG,KAAK,kBAAmB,GAC1L,KACI,CACD,MAAMoN,GAAa7M,GAAMN,EAAiDiN,GAAK,UAAY,MAAQjN,IAAO,OAAS,OAASA,EAAG,SAAW,MAAQM,IAAO,OAAS,OAASA,EAAG,kBAAiB,EAC/L,OAAO6M,IAAc,KAAOA,MAAgB5M,EAAuDuF,GAAQ,SAAW,MAAQvF,IAAO,OAAS,OAASA,EAAG,kBAAiB,EAC9K,KAGD,QAAO0M,EAAK,KAAK,kBAAiB,IAAOL,CAE7D,CAAa,EAAE,IAAKK,GAAS,CACb,GAAI,OAAOD,GAAmB,UAAY,QAASA,EAAgB,CAC/D,MAAMI,EAAkBJ,EAAe,KACjC,CAAE,OAAAhK,EAAQ,MAAA+I,EAAO,iBAAAsB,EAAkB,KAAA1a,EAAM,OAAA5E,CAAQ,EAAGqf,EAU1DJ,EAAiB,OAAO,OAAO,OAAO,OAAO,GATrB,CACpB,OAAQhK,EACR,MAAO+I,EACP,iBAAkBsB,EAClB,UAAW1a,EACX,IAAK,CAAE,EACP,IAAK,CAAE,EACP,OAAQ5E,CAChC,CACoF,EAAG,KAAK,mBAAmBqf,CAAe,CAAC,CAC9G,CACDH,EAAK,SAASD,EAAgBtW,CAAG,CACjD,CAAa,CAER,CAED,WAAY,CACR,OAAO,KAAK,QAAU6O,GAAe,MACxC,CAED,WAAY,CACR,OAAO,KAAK,QAAUA,GAAe,MACxC,CAED,YAAa,CACT,OAAO,KAAK,QAAUA,GAAe,OACxC,CAED,YAAa,CACT,OAAO,KAAK,QAAUA,GAAe,OACxC,CAED,gBAAgB7O,EAAK,CACjB,MAAO,cAAcA,CAAG,EAC3B,CAED,IAAI/D,EAAMqZ,EAAQnV,EAAU,CACxB,MAAM+V,EAAYja,EAAK,oBACjB2a,EAAU,CACZ,KAAMV,EACN,OAAQZ,EACR,SAAUnV,CACtB,EACQ,OAAI,KAAK,SAAS+V,CAAS,EACvB,KAAK,SAASA,CAAS,EAAE,KAAKU,CAAO,EAGrC,KAAK,SAASV,CAAS,EAAI,CAACU,CAAO,EAEhC,IACV,CAED,KAAK3a,EAAMqZ,EAAQ,CACf,MAAMY,EAAYja,EAAK,oBACvB,OAAI,KAAK,SAASia,CAAS,IACvB,KAAK,SAASA,CAAS,EAAI,KAAK,SAASA,CAAS,EAAE,OAAQK,GAAS,CACjE,IAAI1O,EACJ,MAAO,IAAIA,EAAK0O,EAAK,QAAU,MAAQ1O,IAAO,OAAS,OAASA,EAAG,kBAAmB,KAAMqO,GACxF5B,GAAgB,QAAQiC,EAAK,OAAQjB,CAAM,EAC/D,CAAa,GAEE,IACV,CAED,OAAO,QAAQuB,EAAMC,EAAM,CACvB,GAAI,OAAO,KAAKD,CAAI,EAAE,SAAW,OAAO,KAAKC,CAAI,EAAE,OAC/C,MAAO,GAEX,UAAWC,KAAKF,EACZ,GAAIA,EAAKE,CAAC,IAAMD,EAAKC,CAAC,EAClB,MAAO,GAGf,MAAO,EACV,CAED,uBAAwB,CACpB,KAAK,YAAY,kBACb,KAAK,OAAO,eACZ,KAAK,QAAO,CAEnB,CAMD,SAAS5W,EAAU,CACf,KAAK,IAAI2O,GAAe,MAAO,CAAE,EAAE3O,CAAQ,CAC9C,CAMD,SAASA,EAAU,CACf,KAAK,IAAI2O,GAAe,MAAO,GAAK2F,GAAWtU,EAASsU,CAAM,CAAC,CAClE,CAMD,UAAW,CACP,OAAO,KAAK,OAAO,YAAa,GAAI,KAAK,UAAS,CACrD,CAED,QAAQvM,EAAU,KAAK,QAAS,CACxB,KAAK,eAGT,KAAK,OAAO,gBAAgB,KAAK,KAAK,EACtC,KAAK,MAAQ2G,GAAe,QAC5B,KAAK,SAAS,OAAO3G,CAAO,EAC/B,CAED,mBAAmBkH,EAAS,CACxB,MAAM4H,EAAU,CACZ,IAAK,CAAE,EACP,IAAK,CAAE,CACnB,EACQ,OAAI5H,EAAQ,OAAS,UAAYA,EAAQ,OAAS,YAC9C4H,EAAQ,IAAMC,GAA+B7H,EAAQ,QAASA,EAAQ,MAAM,IAE5EA,EAAQ,OAAS,UAAYA,EAAQ,OAAS,YAC9C4H,EAAQ,IAAMC,GAA+B7H,EAAQ,QAASA,EAAQ,UAAU,GAE7E4H,CACV,CACL,CC1mBA,MAAMxF,GAAO,IAAM,GAEb0F,GAAsB,CACxB,mBAAoB,KACpB,gBAAiB,GACjB,2BAA4B,GAChC,EACMC,GAAsB,CAAC,IAAM,IAAM,IAAM,GAAK,EAC9CC,GAA6B,IAC7BC,GAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,OAMP,MAAMC,EAAe,CA6BhC,YAAYC,EAAUpuB,EAAS,CAC3B,IAAI0e,EA4CJ,GA3CA,KAAK,iBAAmB,KACxB,KAAK,OAAS,KACd,KAAK,SAAW,IAAI,MACpB,KAAK,SAAW,GAChB,KAAK,aAAe,GAEpB,KAAK,QAAU,GACf,KAAK,OAAS,GACd,KAAK,QAAU4G,GACf,KAAK,UAAY,KACjB,KAAK,oBAAsByI,GAAoB,mBAC/C,KAAK,eAAiB,OACtB,KAAK,oBAAsB,KAC3B,KAAK,kBAAoB1F,GACzB,KAAK,IAAM,EACX,KAAK,eAAiB,KACtB,KAAK,IAAMhD,GACX,KAAK,OAASgD,GACd,KAAK,KAAO,KACZ,KAAK,WAAa,GAClB,KAAK,WAAa,IAAIvC,GACtB,KAAK,qBAAuB,CACxB,KAAM,CAAE,EACR,MAAO,CAAE,EACT,MAAO,CAAE,EACT,QAAS,CAAE,CACvB,EACQ,KAAK,YAAc,KACnB,KAAK,iBAAmB,eACxB,KAAK,qBAAuB,GAC5B,KAAK,aAAe,KAMpB,KAAK,cAAiBlI,GACdA,EACO,IAAIC,IAASD,EAAY,GAAGC,CAAI,EAEpC,IAAIA,IAAS,MAAM,GAAGA,CAAI,EAGjC,EAAG,GAAAa,EAAuD1e,GAAQ,UAAY,MAAQ0e,IAAO,SAAkBA,EAAG,QAClH,MAAM,IAAI,MAAM,4CAA4C,EAEhE,KAAK,OAAS1e,EAAQ,OAAO,OAE7B,KAAK,SAAW,GAAGouB,CAAQ,IAAIxI,GAAW,SAAS,GACnD,KAAK,aAAesD,GAAgBkF,CAAQ,EAC5C,KAAK,mBAAmBpuB,CAAO,EAC/B,KAAK,wBAAuB,EAC5B,KAAK,MAAQ,KAAK,cAAgEA,GAAQ,KAAK,CAClG,CAID,SAAU,CAEN,GAAI,OAAK,aAAc,GACnB,KAAK,gBAAiB,GACrB,KAAK,OAAS,MAAQ,KAAK,YAAa,GAW7C,IARA,KAAK,oBAAoB,YAAY,EAIjC,KAAK,aAAe,CAAC,KAAK,cAC1B,KAAK,eAAe,SAAS,EAG7B,KAAK,UAEL,KAAK,KAAO,IAAI,KAAK,UAAU,KAAK,YAAW,CAAE,MAIjD,IAAI,CACA,KAAK,KAAOykB,GAAiB,gBAAgB,KAAK,YAAW,CAAE,CAClE,OACM9hB,EAAO,CACV,KAAK,oBAAoB,cAAc,EACvC,MAAMmiB,EAAeniB,EAAM,QAE3B,MAAImiB,EAAa,SAAS,SAAS,EACzB,IAAI,MAAM,GAAGA,CAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASrB,EAER,IAAI,MAAM,4BAA4BA,CAAY,EAAE,CAC7D,CAEL,KAAK,yBAAwB,EAChC,CAKD,aAAc,CACV,OAAO,KAAK,cAAc,KAAK,SAAU,OAAO,OAAO,GAAI,KAAK,OAAQ,CAAE,IAAK,KAAK,GAAG,CAAE,CAAC,CAC7F,CAOD,WAAWuJ,EAAM/C,EAAQ,CACrB,GAAI,MAAK,kBAIT,GADA,KAAK,oBAAoB,gBAAiB,EAAI,EAC1C,KAAK,KAAM,CAEX,MAAMgD,EAAgB,WAAW,IAAM,CACnC,KAAK,oBAAoB,cAAc,CAC1C,EAAE,GAAG,EACN,KAAK,KAAK,QAAU,IAAM,CACtB,aAAaA,CAAa,EAC1B,KAAK,oBAAoB,cAAc,CACvD,EAEgB,OAAO,KAAK,KAAK,OAAU,aACvBD,EACA,KAAK,KAAK,MAAMA,EAAM/C,GAAgD,EAAE,EAGxE,KAAK,KAAK,SAGlB,KAAK,oBAAmB,CAC3B,MAEG,KAAK,oBAAoB,cAAc,CAE9C,CAID,aAAc,CACV,OAAO,KAAK,QACf,CAKD,MAAM,cAAchC,EAAS,CACzB,MAAMjJ,EAAS,MAAMiJ,EAAQ,cAC7B,OAAI,KAAK,SAAS,SAAW,GACzB,KAAK,WAAU,EAEZjJ,CACV,CAID,MAAM,mBAAoB,CACtB,MAAMkO,EAAW,MAAM,QAAQ,IAAI,KAAK,SAAS,IAAKjF,GAAYA,EAAQ,YAAW,CAAE,CAAC,EACxF,YAAK,SAAW,GAChB,KAAK,WAAU,EACRiF,CACV,CAMD,IAAIpH,EAAMnB,EAAK1G,EAAM,CACjB,KAAK,OAAO6H,EAAMnB,EAAK1G,CAAI,CAC9B,CAID,iBAAkB,CACd,OAAQ,KAAK,MAAQ,KAAK,KAAK,WAAU,CACrC,KAAKmG,GAAc,WACf,OAAOI,GAAiB,WAC5B,KAAKJ,GAAc,KACf,OAAOI,GAAiB,KAC5B,KAAKJ,GAAc,QACf,OAAOI,GAAiB,QAC5B,QACI,OAAOA,GAAiB,MAC/B,CACJ,CAID,aAAc,CACV,OAAO,KAAK,oBAAsBA,GAAiB,IACtD,CAID,cAAe,CACX,OAAO,KAAK,mBAAqB,YACpC,CAID,iBAAkB,CACd,OAAO,KAAK,mBAAqB,eACpC,CAQD,QAAQS,EAAO9e,EAAS,CAAE,OAAQ,CAAE,GAAI,CACpC,MAAMgnB,EAAgB,YAAYlI,CAAK,GACjCmI,EAAS,KAAK,cAAc,KAAMrN,GAAMA,EAAE,QAAUoN,CAAa,EACvE,GAAKC,EAMD,OAAOA,EANE,CACT,MAAMC,EAAO,IAAIvD,GAAgB,YAAY7E,CAAK,GAAI9e,EAAQ,IAAI,EAClE,YAAK,SAAS,KAAKknB,CAAI,EAChBA,CACV,CAIJ,CAMD,KAAKpP,EAAM,CACP,KAAM,CAAE,MAAAgH,EAAO,MAAA7U,EAAO,QAAAwU,EAAS,IAAApP,CAAG,EAAKyI,EACjCtI,EAAW,IAAM,CACnB,KAAK,OAAOsI,EAAOha,GAAW,CAC1B,IAAIoZ,GACHA,EAAK,KAAK,QAAU,MAAQA,IAAO,QAAkBA,EAAG,KAAKpZ,CAAM,CACpF,CAAa,CACb,EACQ,KAAK,IAAI,OAAQ,GAAGghB,CAAK,IAAI7U,CAAK,KAAKoF,CAAG,IAAKoP,CAAO,EAClD,KAAK,cACLjP,IAGA,KAAK,WAAW,KAAKA,CAAQ,CAEpC,CAUD,MAAM,QAAQsH,EAAQ,KAAM,CACxB,KAAK,aAAe,KAAK,aAAaA,CAAK,EAC3C,GAAI,CACA,MAAM,KAAK,YACd,QACO,CACJ,KAAK,aAAe,IACvB,CACJ,CAID,MAAM,eAAgB,CAClB,IAAII,EACJ,GAAI,CAAC,KAAK,cAAe,CACrB,GAAI,CACA,KAAK,kBAAkB,cAAc,CACxC,OACMmN,EAAG,CACN,KAAK,IAAI,QAAS,8BAA+BA,CAAC,CACrD,CACD,MACH,CAED,GAAI,KAAK,oBAAqB,CAC1B,KAAK,oBAAsB,KAC3B,KAAK,IAAI,YAAa,0DAA0D,EAChF,GAAI,CACA,KAAK,kBAAkB,SAAS,CACnC,OACMA,EAAG,CACN,KAAK,IAAI,QAAS,8BAA+BA,CAAC,CACrD,CAED,KAAK,qBAAuB,IAC3BnN,EAAK,KAAK,QAAU,MAAQA,IAAO,QAAkBA,EAAG,MAAM6G,GAAiB,mBAAmB,EACnG,WAAW,IAAM,CACb,IAAI7G,EACC,KAAK,gBACLA,EAAK,KAAK,kBAAoB,MAAQA,IAAO,QAAkBA,EAAG,gBAAe,CAEtG,EAAeqP,GAAoB,0BAA0B,EACjD,MACH,CAED,KAAK,oBAAsB,KAAK,WAChC,KAAK,KAAK,CACN,MAAO,UACP,MAAO,YACP,QAAS,CAAE,EACX,IAAK,KAAK,mBACtB,CAAS,EACD,GAAI,CACA,KAAK,kBAAkB,MAAM,CAChC,OACMlC,EAAG,CACN,KAAK,IAAI,QAAS,8BAA+BA,CAAC,CACrD,CACD,KAAK,eAAe,WAAW,CAClC,CAKD,YAAY7U,EAAU,CAClB,KAAK,kBAAoBA,CAC5B,CAID,iBAAkB,CACV,KAAK,YAAa,GAAI,KAAK,WAAW,OAAS,IAC/C,KAAK,WAAW,QAASA,GAAaA,EAAU,GAChD,KAAK,WAAa,GAEzB,CAMD,UAAW,CACP,IAAI2X,EAAS,KAAK,IAAM,EACxB,OAAIA,IAAW,KAAK,IAChB,KAAK,IAAM,EAGX,KAAK,IAAMA,EAER,KAAK,IAAI,UACnB,CAMD,gBAAgBrI,EAAO,CACnB,IAAIsI,EAAa,KAAK,SAAS,KAAMxN,GAAMA,EAAE,QAAUkF,IAAUlF,EAAE,UAAS,GAAMA,EAAE,WAAY,EAAC,EAC7FwN,IACA,KAAK,IAAI,YAAa,4BAA4BtI,CAAK,GAAG,EAC1DsI,EAAW,YAAW,EAE7B,CAQD,QAAQtF,EAAS,CACb,KAAK,SAAW,KAAK,SAAS,OAAQlI,GAAMA,EAAE,QAAUkI,EAAQ,KAAK,CACxE,CAED,eAAeuF,EAAY,CACvB,KAAK,OAAOA,EAAW,KAAO7I,GAAQ,CAElC,GAAIA,EAAI,QAAU,WAAaA,EAAI,QAAU,YACzC,GAAI,CACA,KAAK,kBAAkBA,EAAI,QAAQ,SAAW,KAAO,KAAO,OAAO,CACtE,OACM6F,EAAG,CACN,KAAK,IAAI,QAAS,8BAA+BA,CAAC,CACrD,CAGD7F,EAAI,KAAOA,EAAI,MAAQ,KAAK,sBAC5B,KAAK,oBAAsB,MAG/B,KAAM,CAAE,MAAAM,EAAO,MAAA7U,EAAO,QAAAwU,EAAS,IAAApP,CAAG,EAAKmP,EACjC8I,EAAYjY,EAAM,IAAIA,CAAG,IAAM,GAC/BwJ,EAAS4F,EAAQ,QAAU,GACjC,KAAK,IAAI,UAAW,GAAG5F,CAAM,IAAIiG,CAAK,IAAI7U,CAAK,IAAIqd,CAAS,GAAG,KAAI,EAAI7I,CAAO,EAE9E,KAAK,SACA,OAAQqD,GAAYA,EAAQ,UAAUhD,CAAK,CAAC,EAC5C,QAASgD,GAAYA,EAAQ,SAAS7X,EAAOwU,EAASpP,CAAG,CAAC,EAC/D,KAAK,uBAAuB,UAAWmP,CAAG,CACtD,CAAS,CACJ,CAKD,YAAY+I,EAAO,CACf,IAAIrQ,EACAqQ,IAAU,aAAe,KAAK,gBAC9B,cAAc,KAAK,cAAc,EACjC,KAAK,eAAiB,QAEjBA,IAAU,eACdrQ,EAAK,KAAK,kBAAoB,MAAQA,IAAO,QAAkBA,EAAG,MAAK,EAE/E,CAKD,iBAAkB,CACd,KAAK,YAAY,WAAW,EAC5B,KAAK,YAAY,WAAW,CAC/B,CAKD,0BAA2B,CAClB,KAAK,OAGN,eAAgB,KAAK,OAErB,KAAK,KAAK,WAAa,eAE3B,KAAK,KAAK,OAAS,IAAM,KAAK,YAAW,EACzC,KAAK,KAAK,QAAW/b,GAAU,KAAK,aAAaA,CAAK,EACtD,KAAK,KAAK,UAAa8O,GAAU,KAAK,eAAeA,CAAK,EAC1D,KAAK,KAAK,QAAWA,GAAU,KAAK,aAAaA,CAAK,EACzD,CAKD,qBAAsB,CAClB,GAAI,KAAK,KAAM,CACX,GAAI,KAAK,KAAK,aAAegU,GAAc,MACvC,KAAK,KAAK,aAAeA,GAAc,WACvC,GAAI,CACA,KAAK,KAAK,OACb,OACM,EAAG,CACN,KAAK,IAAI,QAAS,2BAA4B,CAAC,CAClD,CAEL,KAAK,KAAK,OAAS,KACnB,KAAK,KAAK,QAAU,KACpB,KAAK,KAAK,UAAY,KACtB,KAAK,KAAK,QAAU,KACpB,KAAK,KAAO,IACf,CACD,KAAK,gBAAe,EACpB,KAAK,SAAS,QAAS6D,GAAYA,EAAQ,SAAQ,CAAE,CACxD,CAED,aAAc,CACV,KAAK,oBAAoB,WAAW,EACpC,KAAK,IAAI,YAAa,gBAAgB,KAAK,YAAW,CAAE,EAAE,GAGtC,KAAK,eACpB,KAAK,aAAe,CAAC,KAAK,iBAAmB,KAAK,UAAY,QAAQ,QAAO,IAE7E,KAAK,IAAM,CACZ,KAAK,gBAAe,CAChC,CAAS,EACI,MAAOuC,GAAM,CACd,KAAK,IAAI,QAAS,oCAAqCA,CAAC,EAExD,KAAK,gBAAe,CAChC,CAAS,EACD,KAAK,YAAY,WAAW,EACvB,KAAK,OAID,KAAK,WACN,KAAK,sBAAqB,EAJ9B,KAAK,gBAAe,EAOxB,KAAK,uBAAuB,MAAM,CACrC,CAED,iBAAkB,CACd,KAAK,gBAAkB,cAAc,KAAK,cAAc,EACxD,KAAK,eAAiB,YAAY,IAAM,KAAK,gBAAiB,KAAK,mBAAmB,CACzF,CAED,uBAAwB,CAChB,KAAK,UACL,KAAK,IAAI,SAAU,4BAA4B,KAAK,SAAS,EAAE,EAG/D,KAAK,IAAI,SAAU,yBAAyB,EAEhD,MAAMmD,EAAY,KAAK,iBAAiB,KAAK,SAAS,EACtD,KAAK,UAAY,IAAI,OAAOA,CAAS,EACrC,KAAK,UAAU,QAAWrsB,GAAU,CAChC,KAAK,IAAI,SAAU,eAAgBA,EAAM,OAAO,EAChD,KAAK,UAAU,WAC3B,EACQ,KAAK,UAAU,UAAa8O,GAAU,CAC9BA,EAAM,KAAK,QAAU,aACrB,KAAK,cAAa,CAElC,EACQ,KAAK,UAAU,YAAY,CACvB,MAAO,QACP,SAAU,KAAK,mBAC3B,CAAS,CACJ,CAED,aAAaA,EAAO,CAChB,IAAIiN,EACJ,KAAK,oBAAoB,cAAc,EACvC,KAAK,IAAI,YAAa,QAASjN,CAAK,EACpC,KAAK,kBAAiB,EACtB,KAAK,YAAY,WAAW,EAEvB,KAAK,uBACLiN,EAAK,KAAK,kBAAoB,MAAQA,IAAO,QAAkBA,EAAG,gBAAe,EAEtF,KAAK,uBAAuB,QAASjN,CAAK,CAC7C,CAED,aAAa9O,EAAO,CAChB,KAAK,oBAAoB,cAAc,EACvC,KAAK,IAAI,YAAa,GAAGA,CAAK,EAAE,EAChC,KAAK,kBAAiB,EACtB,KAAK,uBAAuB,QAASA,CAAK,CAC7C,CAED,mBAAoB,CAChB,KAAK,SAAS,QAAS2mB,GAAYA,EAAQ,SAAS3D,GAAe,KAAK,CAAC,CAC5E,CAED,cAAcjjB,EAAK8E,EAAQ,CACvB,GAAI,OAAO,KAAKA,CAAM,EAAE,SAAW,EAC/B,OAAO9E,EAEX,MAAMqQ,EAASrQ,EAAI,MAAM,IAAI,EAAI,IAAM,IACjCigB,EAAQ,IAAI,gBAAgBnb,CAAM,EACxC,MAAO,GAAG9E,CAAG,GAAGqQ,CAAM,GAAG4P,CAAK,EACjC,CACD,iBAAiBjgB,EAAK,CAClB,IAAIusB,EACJ,GAAIvsB,EACAusB,EAAavsB,MAEZ,CACD,MAAMwsB,EAAO,IAAI,KAAK,CAAChB,EAAa,EAAG,CAAE,KAAM,wBAAwB,CAAE,EACzEe,EAAa,IAAI,gBAAgBC,CAAI,CACxC,CACD,OAAOD,CACV,CAKD,oBAAoB3tB,EAAO6tB,EAAS,GAAO,CACvC,KAAK,iBAAmB7tB,EACpBA,IAAU,aACV,KAAK,qBAAuB,GAEvBA,IAAU,kBACf,KAAK,qBAAuB6tB,EAEnC,CAKD,MAAM,aAAa7Q,EAAQ,KAAM,CAC7B,IAAI8Q,EACA9Q,EACA8Q,EAAc9Q,EAET,KAAK,YAEV8Q,EAAc,MAAM,KAAK,cAGzBA,EAAc,KAAK,iBAEnB,KAAK,kBAAoBA,IACzB,KAAK,iBAAmBA,EACxB,KAAK,SAAS,QAAS9F,GAAY,CAC/B,MAAMrD,EAAU,CACZ,aAAcmJ,EACd,QAASlK,EAC7B,EACgBkK,GAAe9F,EAAQ,kBAAkBrD,CAAO,EAC5CqD,EAAQ,YAAcA,EAAQ,UAAS,GACvCA,EAAQ,MAAM3D,GAAe,aAAc,CACvC,aAAcyJ,CACtC,CAAqB,CAErB,CAAa,EAER,CAKD,MAAM,sBAAuB,CACrB,KAAK,cACL,MAAM,KAAK,YAElB,CAKD,eAAe3Z,EAAU,UAAW,CAChC,KAAK,QAAO,EAAG,MAAOoW,GAAM,CACxB,KAAK,IAAI,QAAS,yBAAyBpW,CAAO,GAAIoW,CAAC,CACnE,CAAS,CACJ,CAKD,uBAAuBpa,EAAO6N,EAAM,CAChC,GAAI,CACA,KAAK,qBAAqB7N,CAAK,EAAE,QAASuF,GAAa,CACnD,GAAI,CACAA,EAASsI,CAAI,CAChB,OACMuM,EAAG,CACN,KAAK,IAAI,QAAS,YAAYpa,CAAK,YAAaoa,CAAC,CACpD,CACjB,CAAa,CACJ,OACMA,EAAG,CACN,KAAK,IAAI,QAAS,oBAAoBpa,CAAK,aAAcoa,CAAC,CAC7D,CACJ,CAKD,yBAA0B,CACtB,KAAK,eAAiB,IAAInE,GAAM,SAAY,CACxC,WAAW,SAAY,CACnB,MAAM,KAAK,uBACN,KAAK,eACN,KAAK,QAAO,CAEhC,EAAeqG,GAAoB,eAAe,CAClD,EAAW,KAAK,gBAAgB,CAC3B,CAKD,mBAAmB/tB,EAAS,CACxB,IAAI0e,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EAAI2O,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAwBhD,OAtBA,KAAK,WAAahR,EAAuD1e,GAAQ,aAAe,MAAQ0e,IAAO,OAASA,EAAK,KAC7H,KAAK,SAAWmB,EAAuD7f,GAAQ,WAAa,MAAQ6f,IAAO,OAASA,EAAKyF,GACzH,KAAK,qBACApF,EAAuDlgB,GAAQ,uBAAyB,MAAQkgB,IAAO,OAASA,EAAK6N,GAAoB,mBAC9I,KAAK,QAAU5N,EAAuDngB,GAAQ,UAAY,MAAQmgB,IAAO,OAASA,EAAK,GACvH,KAAK,aAAeM,EAAuDzgB,GAAQ,eAAiB,MAAQygB,IAAO,OAASA,EAAK,KACjI,KAAK,mBAAqBC,EAAuD1gB,GAAQ,qBAAuB,MAAQ0gB,IAAO,OAASA,EAAK2H,GAC7I,KAAK,KAAOgH,EAAuDrvB,GAAQ,OAAS,MAAQqvB,IAAO,OAASA,EAAKhK,GAE3DrlB,GAAQ,SAC1D,KAAK,OAASA,EAAQ,QAC4BA,GAAQ,SAC1D,KAAK,OAASA,EAAQ,SAC6BA,GAAQ,UAAgEA,GAAQ,aACnI,KAAK,SAAWA,EAAQ,UAAYA,EAAQ,UAC5C,KAAK,OAAS,OAAO,OAAO,OAAO,OAAO,GAAI,KAAK,MAAM,EAAG,CAAE,UAAW,KAAK,QAAU,IAG5F,KAAK,kBACAsvB,EAAuDtvB,GAAQ,oBAAsB,MAAQsvB,IAAO,OAASA,EAAOK,GAC1G3B,GAAoB2B,EAAQ,CAAC,GAAK1B,GAEzC,KAAK,IAAG,CACZ,KAAK9I,GACD,KAAK,QACAoK,EAAuDvvB,GAAQ,UAAY,MAAQuvB,IAAO,OAASA,EAAM,CAACtJ,EAASjP,IACzGA,EAAS,KAAK,UAAUiP,CAAO,CAAC,EAE/C,KAAK,QACAuJ,EAAuDxvB,GAAQ,UAAY,MAAQwvB,IAAO,OAASA,EAAM,CAACvJ,EAASjP,IACzGA,EAAS,KAAK,MAAMiP,CAAO,CAAC,EAE3C,MACJ,KAAKb,GACD,KAAK,QAAUqK,EAAuDzvB,GAAQ,UAAY,MAAQyvB,IAAO,OAASA,EAAK,KAAK,WAAW,OAAO,KAAK,KAAK,UAAU,EAClK,KAAK,QAAUC,EAAuD1vB,GAAQ,UAAY,MAAQ0vB,IAAO,OAASA,EAAK,KAAK,WAAW,OAAO,KAAK,KAAK,UAAU,EAClK,MACJ,QACI,MAAM,IAAI,MAAM,mCAAmC,KAAK,GAAG,EAAE,CACpE,CAED,GAAI,KAAK,OAAQ,CACb,GAAI,OAAO,OAAW,KAAe,CAAC,OAAO,OACzC,MAAM,IAAI,MAAM,6BAA6B,EAEjD,KAAK,UAA8D1vB,GAAQ,SAC9E,CACJ,CACL,CChwBO,MAAM4vB,WAAqB,KAAM,CACpC,YAAY9uB,EAAS,CACjB,MAAMA,CAAO,EACb,KAAK,iBAAmB,GACxB,KAAK,KAAO,cACf,CACL,CACO,SAAS+uB,GAAeltB,EAAO,CAClC,OAAO,OAAOA,GAAU,UAAYA,IAAU,MAAQ,qBAAsBA,CAChF,CACO,MAAMmtB,WAAwBF,EAAa,CAC9C,YAAY9uB,EAASuf,EAAQ0P,EAAY,CACrC,MAAMjvB,CAAO,EACb,KAAK,KAAO,kBACZ,KAAK,OAASuf,EACd,KAAK,WAAa0P,CACrB,CACD,QAAS,CACL,MAAO,CACH,KAAM,KAAK,KACX,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,WAAY,KAAK,UAC7B,CACK,CACL,CACO,MAAMC,WAA4BJ,EAAa,CAClD,YAAY9uB,EAASmvB,EAAe,CAChC,MAAMnvB,CAAO,EACb,KAAK,KAAO,sBACZ,KAAK,cAAgBmvB,CACxB,CACL,CChCO,MAAMtS,GAAgBC,GACrBA,EACO,IAAIC,IAASD,EAAY,GAAGC,CAAI,EAEpC,IAAIA,IAAS,MAAM,GAAGA,CAAI,EAExBqS,GAAkB,IACpB,SAEEC,GAAoBC,GAAS,CACtC,GAAI,MAAM,QAAQA,CAAI,EAClB,OAAOA,EAAK,IAAKC,GAAOF,GAAiBE,CAAE,CAAC,EAE3C,GAAI,OAAOD,GAAS,YAAcA,IAAS,OAAOA,CAAI,EACvD,OAAOA,EAEX,MAAM9qB,EAAS,GACf,cAAO,QAAQ8qB,CAAI,EAAE,QAAQ,CAAC,CAAC7uB,EAAKV,CAAK,IAAM,CAC3C,MAAMyvB,EAAS/uB,EAAI,QAAQ,gBAAkB6f,GAAMA,EAAE,YAAa,EAAC,QAAQ,QAAS,EAAE,CAAC,EACvF9b,EAAOgrB,CAAM,EAAIH,GAAiBtvB,CAAK,CAC/C,CAAK,EACMyE,CACX,EAMairB,GAAiB1vB,GAAU,CACpC,GAAI,OAAOA,GAAU,UAAYA,IAAU,KACvC,MAAO,GAEX,MAAM2vB,EAAY,OAAO,eAAe3vB,CAAK,EAC7C,OAAS2vB,IAAc,MACnBA,IAAc,OAAO,WACrB,OAAO,eAAeA,CAAS,IAAM,OACrC,EAAE,OAAO,eAAe3vB,IACxB,EAAE,OAAO,YAAYA,EAC7B,EAgBa4vB,GAAqBC,GAC1B,CAACA,GAAc,OAAOA,GAAe,UAIrCA,EAAW,SAAW,GAAKA,EAAW,OAAS,KAI/CA,EAAW,KAAM,IAAKA,GAMtBA,EAAW,SAAS,GAAG,GAAKA,EAAW,SAAS,IAAI,EAC7C,GAKa,4BACD,KAAKA,CAAU,ECzEpCC,GAAoBC,GAAQ,CAC9B,IAAIlS,EACJ,OAAOkS,EAAI,KACPA,EAAI,SACJA,EAAI,oBACH,OAAOA,EAAI,OAAU,SAAWA,EAAI,OAASlS,EAAKkS,EAAI,SAAW,MAAQlS,IAAO,OAAS,OAASA,EAAG,UACtG,KAAK,UAAUkS,CAAG,CAC1B,EACMC,GAAc,CAACluB,EAAOmuB,EAAQ9wB,IAAYwe,EAAU,OAAQ,OAAQ,OAAQ,WAAa,CAC3F,MAAMuS,EAAM,MAAMb,KACdvtB,aAAiBouB,GAAO,CAAoD/wB,GAAQ,cACpF2C,EACK,KAAM,EACN,KAAMiuB,GAAQ,CACf,MAAMvQ,EAAS1d,EAAM,QAAU,IACzBotB,EAAwDa,GAAI,YAAevQ,EAAS,GAC1FyQ,EAAO,IAAIhB,GAAgBa,GAAiBC,CAAG,EAAGvQ,EAAQ0P,CAAU,CAAC,CACjF,CAAS,EACI,MAAOa,GAAQ,CAChBE,EAAO,IAAId,GAAoBW,GAAiBC,CAAG,EAAGA,CAAG,CAAC,CACtE,CAAS,EAGDE,EAAO,IAAId,GAAoBW,GAAiBhuB,CAAK,EAAGA,CAAK,CAAC,CAEtE,CAAC,EACKquB,GAAoB,CAACxe,EAAQxS,EAASixB,EAAYve,IAAS,CAC7D,MAAMlL,EAAS,CAAE,OAAAgL,EAAQ,QAA4DxS,GAAQ,SAAY,CAAE,GAC3G,OAAIwS,IAAW,OAAS,CAACE,EACdlL,GAEP+oB,GAAc7d,CAAI,GAClBlL,EAAO,QAAU,OAAO,OAAO,CAAE,eAAgB,oBAAwExH,GAAQ,OAAO,EACxIwH,EAAO,KAAO,KAAK,UAAUkL,CAAI,GAGjClL,EAAO,KAAOkL,EAEoC1S,GAAQ,SAC1DwH,EAAO,OAASxH,EAAQ,QAErB,OAAO,OAAO,OAAO,OAAO,GAAIwH,CAAM,EAAGypB,CAAU,EAC9D,EACA,SAASC,GAAeC,EAAS3e,EAAQ9P,EAAK1C,EAASixB,EAAYve,EAAM,CACrE,OAAO8L,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO,IAAI,QAAQ,CAACgO,EAASsE,IAAW,CACpCK,EAAQzuB,EAAKsuB,GAAkBxe,EAAQxS,EAASixB,EAAYve,CAAI,CAAC,EAC5D,KAAMpN,GAAW,CAClB,GAAI,CAACA,EAAO,GACR,MAAMA,EACV,OAAsDtF,GAAQ,cACnDsF,EACJA,EAAO,MAC9B,CAAa,EACI,KAAMga,GAASkN,EAAQlN,CAAI,CAAC,EAC5B,MAAO3c,GAAUkuB,GAAYluB,EAAOmuB,EAAQ9wB,CAAO,CAAC,CACrE,CAAS,CACT,CAAK,CACL,CACO,SAASikB,GAAIkN,EAASzuB,EAAK1C,EAASixB,EAAY,CACnD,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO0S,GAAeC,EAAS,MAAOzuB,EAAK1C,EAASixB,CAAU,CACtE,CAAK,CACL,CACO,SAASG,GAAKD,EAASzuB,EAAKgQ,EAAM1S,EAASixB,EAAY,CAC1D,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO0S,GAAeC,EAAS,OAAQzuB,EAAK1C,EAASixB,EAAYve,CAAI,CAC7E,CAAK,CACL,CACO,SAAS2e,GAAIF,EAASzuB,EAAKgQ,EAAM1S,EAASixB,EAAY,CACzD,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO0S,GAAeC,EAAS,MAAOzuB,EAAK1C,EAASixB,EAAYve,CAAI,CAC5E,CAAK,CACL,CACO,SAAS2Q,GAAK8N,EAASzuB,EAAK1C,EAASixB,EAAY,CACpD,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO0S,GAAeC,EAAS,OAAQzuB,EAAK,OAAO,OAAO,OAAO,OAAO,CAAE,EAAE1C,CAAO,EAAG,CAAE,cAAe,EAAM,GAAGixB,CAAU,CAClI,CAAK,CACL,CACO,SAASK,GAAOH,EAASzuB,EAAKgQ,EAAM1S,EAASixB,EAAY,CAC5D,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO0S,GAAeC,EAAS,SAAUzuB,EAAK1C,EAASixB,EAAYve,CAAI,CAC/E,CAAK,CACL,CCpFe,MAAM6e,EAAsB,CACvC,YAAYC,EAAYC,EAAoB,CACxC,KAAK,WAAaD,EAClB,KAAK,mBAAqBC,CAC7B,CACD,KAAK3R,EAAaC,EAAY,CAC1B,OAAO,KAAK,QAAS,EAAC,KAAKD,EAAaC,CAAU,CACrD,CACD,SAAU,CACN,OAAOvB,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CACH,MAFW,MAAM,KAAK,cAET,KACb,MAAO,IAC3B,CACa,OACM7b,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACL,CC9BA,IAAI+b,GAIJ,MAAMgT,EAAoB,CACtB,YAAYF,EAAYC,EAAoB,CACxC,KAAK,WAAaD,EAClB,KAAK,mBAAqBC,EAC1B,KAAK/S,EAAE,EAAI,sBACX,KAAK,QAAU,IAClB,CACD,UAAW,CACP,OAAO,IAAI6S,GAAsB,KAAK,WAAY,KAAK,kBAAkB,CAC5E,CACD,KAAKzR,EAAaC,EAAY,CAC1B,OAAO,KAAK,WAAY,EAAC,KAAKD,EAAaC,CAAU,CACxD,CACD,MAAMA,EAAY,CACd,OAAO,KAAK,WAAU,EAAG,MAAMA,CAAU,CAC5C,CACD,QAAQ4R,EAAW,CACf,OAAO,KAAK,WAAU,EAAG,QAAQA,CAAS,CAC7C,CACD,YAAa,CACT,OAAK,KAAK,UACN,KAAK,QAAU,KAAK,WAEjB,KAAK,OACf,CACD,SAAU,CACN,OAAOnT,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CACH,KAAM,MAFK,MAAM,KAAK,cAEH,KAAM,EACzB,MAAO,IAC3B,CACa,OACM7b,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACL,CACA+b,GAAK,OAAO,YACZ,MAAAkT,GAAeF,GC9CTG,GAAyB,CAC3B,MAAO,IACP,OAAQ,EACR,OAAQ,CACJ,OAAQ,OACR,MAAO,KACV,CACL,EACMC,GAAuB,CACzB,aAAc,OACd,YAAa,2BACb,OAAQ,EACZ,EACe,MAAMC,EAAe,CAChC,YAAYrvB,EAAK0b,EAAU,GAAI4T,EAAU5O,EAAO,CAC5C,KAAK,mBAAqB,GAC1B,KAAK,IAAM1gB,EACX,KAAK,QAAU0b,EACf,KAAK,SAAW4T,EAChB,KAAK,MAAQrU,GAAayF,CAAK,CAClC,CAMD,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAQD,eAAe5Q,EAAQ/Q,EAAMwwB,EAAUC,EAAa,CAChD,OAAO1T,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,IAAI9L,EACJ,MAAM1S,EAAU,OAAO,OAAO,OAAO,OAAO,GAAI8xB,EAAoB,EAAGI,CAAW,EAClF,IAAI9T,EAAU,OAAO,OAAO,OAAO,OAAO,CAAE,EAAE,KAAK,OAAO,EAAI5L,IAAW,QAAU,CAAE,WAAY,OAAOxS,EAAQ,MAAM,CAAC,GACvH,MAAMymB,EAAWzmB,EAAQ,SACrB,OAAO,KAAS,KAAeiyB,aAAoB,MACnDvf,EAAO,IAAI,SACXA,EAAK,OAAO,eAAgB1S,EAAQ,YAAY,EAC5CymB,GACA/T,EAAK,OAAO,WAAY,KAAK,eAAe+T,CAAQ,CAAC,EAEzD/T,EAAK,OAAO,GAAIuf,CAAQ,GAEnB,OAAO,SAAa,KAAeA,aAAoB,UAC5Dvf,EAAOuf,EAEFvf,EAAK,IAAI,cAAc,GACxBA,EAAK,OAAO,eAAgB1S,EAAQ,YAAY,EAEhDymB,GAAY,CAAC/T,EAAK,IAAI,UAAU,GAChCA,EAAK,OAAO,WAAY,KAAK,eAAe+T,CAAQ,CAAC,IAIzD/T,EAAOuf,EACP7T,EAAQ,eAAe,EAAI,WAAWpe,EAAQ,YAAY,GAC1Doe,EAAQ,cAAc,EAAIpe,EAAQ,YAC9BymB,IACArI,EAAQ,YAAY,EAAI,KAAK,SAAS,KAAK,eAAeqI,CAAQ,CAAC,IAIrD,OAAO,eAAmB,KAAe/T,aAAgB,gBACtEA,GAAQ,OAAOA,GAAS,UAAY,SAAUA,GAAQ,OAAOA,EAAK,MAAS,aAChE,CAAC1S,EAAQ,SACrBA,EAAQ,OAAS,SAGqCkyB,GAAY,UACtE9T,EAAU,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAO,EAAG8T,EAAY,OAAO,GAE3E,MAAMC,EAAY,KAAK,oBAAoB1wB,CAAI,EACzC2wB,EAAQ,KAAK,cAAcD,CAAS,EACpC7S,EAAO,MAAO9M,GAAU,MAAQ6e,GAAMD,IAAM,KAAK,MAAO,GAAG,KAAK,GAAG,WAAWgB,CAAK,GAAI1f,EAAM,OAAO,OAAO,CAAE,QAAA0L,CAAS,EAAsDpe,GAAQ,OAAU,CAAE,OAAQA,EAAQ,MAAQ,EAAG,CAAE,EAAE,EACrO,MAAO,CACH,KAAM,CAAE,KAAMmyB,EAAW,GAAI7S,EAAK,GAAI,SAAUA,EAAK,GAAK,EAC1D,MAAO,IAC3B,CACa,OACM3c,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CA6CD,OAAOlB,EAAMwwB,EAAUC,EAAa,CAChC,OAAO1T,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO,KAAK,eAAe,OAAQ/c,EAAMwwB,EAAUC,CAAW,CAC1E,CAAS,CACJ,CA8BD,kBAAkBzwB,EAAM6c,EAAO2T,EAAUC,EAAa,CAClD,OAAO1T,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,MAAM2T,EAAY,KAAK,oBAAoB1wB,CAAI,EACzC2wB,EAAQ,KAAK,cAAcD,CAAS,EACpCzvB,EAAM,IAAI,IAAI,KAAK,IAAM,uBAAuB0vB,CAAK,EAAE,EAC7D1vB,EAAI,aAAa,IAAI,QAAS4b,CAAK,EACnC,GAAI,CACA,IAAI5L,EACJ,MAAM1S,EAAU,OAAO,OAAO,CAAE,OAAQ8xB,GAAqB,QAAUI,CAAW,EAC5E9T,EAAU,OAAO,OAAO,OAAO,OAAO,GAAI,KAAK,OAAO,EAAG,CAAE,WAAY,OAAOpe,EAAQ,MAAM,CAAC,CAAE,EACjG,OAAO,KAAS,KAAeiyB,aAAoB,MACnDvf,EAAO,IAAI,SACXA,EAAK,OAAO,eAAgB1S,EAAQ,YAAY,EAChD0S,EAAK,OAAO,GAAIuf,CAAQ,GAEnB,OAAO,SAAa,KAAeA,aAAoB,UAC5Dvf,EAAOuf,EACPvf,EAAK,OAAO,eAAgB1S,EAAQ,YAAY,IAGhD0S,EAAOuf,EACP7T,EAAQ,eAAe,EAAI,WAAWpe,EAAQ,YAAY,GAC1Doe,EAAQ,cAAc,EAAIpe,EAAQ,aAEtC,MAAMsf,EAAO,MAAM+R,GAAI,KAAK,MAAO3uB,EAAI,WAAYgQ,EAAM,CAAE,QAAA0L,CAAS,GACpE,MAAO,CACH,KAAM,CAAE,KAAM+T,EAAW,SAAU7S,EAAK,GAAK,EAC7C,MAAO,IAC3B,CACa,OACM3c,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CA+BD,sBAAsBlB,EAAMzB,EAAS,CACjC,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,IAAI4T,EAAQ,KAAK,cAAc3wB,CAAI,EACnC,MAAM2c,EAAU,OAAO,OAAO,GAAI,KAAK,OAAO,EACQpe,GAAQ,SAC1Doe,EAAQ,UAAU,EAAI,QAE1B,MAAMkB,EAAO,MAAM8R,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,uBAAuBgB,CAAK,GAAI,CAAE,EAAE,CAAE,QAAAhU,CAAS,GACxF1b,EAAM,IAAI,IAAI,KAAK,IAAM4c,EAAK,GAAG,EACjChB,EAAQ5b,EAAI,aAAa,IAAI,OAAO,EAC1C,GAAI,CAAC4b,EACD,MAAM,IAAIsR,GAAa,0BAA0B,EAErD,MAAO,CAAE,KAAM,CAAE,UAAWltB,EAAI,WAAY,KAAAjB,EAAM,MAAA6c,CAAK,EAAI,MAAO,IAAI,CACzE,OACM3b,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CA6CD,OAAOlB,EAAMwwB,EAAUC,EAAa,CAChC,OAAO1T,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO,KAAK,eAAe,MAAO/c,EAAMwwB,EAAUC,CAAW,CACzE,CAAS,CACJ,CA4BD,KAAKG,EAAUC,EAAQtyB,EAAS,CAC5B,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAOA,MAAO,CAAE,KANI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,eAAgB,CAC3D,SAAU,KAAK,SACf,UAAWiB,EACX,eAAgBC,EAChB,kBAAqEtyB,GAAQ,iBAChF,EAAE,CAAE,QAAS,KAAK,OAAS,GACb,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CA4BD,KAAK0vB,EAAUC,EAAQtyB,EAAS,CAC5B,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAOA,MAAO,CAAE,KAAM,CAAE,MANJ,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,eAAgB,CAC3D,SAAU,KAAK,SACf,UAAWiB,EACX,eAAgBC,EAChB,kBAAqEtyB,GAAQ,iBAChF,EAAE,CAAE,QAAS,KAAK,OAAS,IACA,KAAO,MAAO,KAC7C,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAoDD,gBAAgBlB,EAAM8wB,EAAWvyB,EAAS,CACtC,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,IAAI4T,EAAQ,KAAK,cAAc3wB,CAAI,EAC/B6d,EAAO,MAAM8R,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,gBAAgBgB,CAAK,GAAI,OAAO,OAAO,CAAE,UAAAG,CAAW,EAAsDvyB,GAAQ,UAAa,CAAE,UAAWA,EAAQ,SAAS,EAAK,IAAM,CAAE,QAAS,KAAK,OAAO,CAAE,EAC9O,MAAMwyB,EAAwExyB,GAAQ,SAChF,aAAaA,EAAQ,WAAa,GAAO,GAAKA,EAAQ,QAAQ,GAC9D,GAEN,OAAAsf,EAAO,CAAE,UADS,UAAU,GAAG,KAAK,GAAG,GAAGA,EAAK,SAAS,GAAGkT,CAAkB,EAAE,GAExE,CAAE,KAAAlT,EAAM,MAAO,KACzB,OACM3c,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAuCD,iBAAiB+G,EAAO6oB,EAAWvyB,EAAS,CACxC,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,MAAMc,EAAO,MAAM8R,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,gBAAgB,KAAK,QAAQ,GAAI,CAAE,UAAAmB,EAAW,MAAA7oB,CAAK,EAAI,CAAE,QAAS,KAAK,OAAO,CAAE,EACzH8oB,EAAwExyB,GAAQ,SAChF,aAAaA,EAAQ,WAAa,GAAO,GAAKA,EAAQ,QAAQ,GAC9D,GACN,MAAO,CACH,KAAMsf,EAAK,IAAKmT,GAAW,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAK,EAAG,CAAE,UAAWA,EAAM,UAC5E,UAAU,GAAG,KAAK,GAAG,GAAGA,EAAM,SAAS,GAAGD,CAAkB,EAAE,EAC9D,IAAI,CAAE,CAAE,EAClB,MAAO,IAC3B,CACa,OACM7vB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAuCD,SAASlB,EAAMzB,EAAS,CAEpB,MAAM0yB,EADsB,OAA0D1yB,GAAQ,UAAe,IACpE,6BAA+B,SAClE2yB,EAAsB,KAAK,2BAA8E3yB,GAAQ,WAAc,CAAE,GACjI4yB,EAAcD,EAAsB,IAAIA,CAAmB,GAAK,GAChEP,EAAQ,KAAK,cAAc3wB,CAAI,EAC/B+vB,EAAa,IAAMvN,GAAI,KAAK,MAAO,GAAG,KAAK,GAAG,IAAIyO,CAAU,IAAIN,CAAK,GAAGQ,CAAW,GAAI,CACzF,QAAS,KAAK,QACd,cAAe,EAC3B,CAAS,EACD,OAAO,IAAIlB,GAAoBF,EAAY,KAAK,kBAAkB,CACrE,CAgBD,KAAK/vB,EAAM,CACP,OAAO+c,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,MAAM4T,EAAQ,KAAK,cAAc3wB,CAAI,EACrC,GAAI,CACA,MAAM6d,EAAO,MAAM2E,GAAI,KAAK,MAAO,GAAG,KAAK,GAAG,gBAAgBmO,CAAK,GAAI,CACnE,QAAS,KAAK,OAClC,CAAiB,EACD,MAAO,CAAE,KAAMjC,GAAiB7Q,CAAI,EAAG,MAAO,KACjD,OACM3c,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAgBD,OAAOlB,EAAM,CACT,OAAO+c,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,MAAM4T,EAAQ,KAAK,cAAc3wB,CAAI,EACrC,GAAI,CACA,aAAM4hB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,WAAW+O,CAAK,GAAI,CAClD,QAAS,KAAK,OAClC,CAAiB,EACM,CAAE,KAAM,GAAM,MAAO,IAAI,CACnC,OACMzvB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,GAAKA,aAAiBqtB,GAAqB,CAC/D,MAAMC,EAAgBttB,EAAM,cAC5B,GAAI,CAAC,IAAK,GAAG,EAAE,SAAuEstB,GAAc,MAAM,EACtG,MAAO,CAAE,KAAM,GAAO,MAAAttB,EAE7B,CACD,MAAMA,CACT,CACb,CAAS,CACJ,CAmDD,aAAalB,EAAMzB,EAAS,CACxB,MAAMoyB,EAAQ,KAAK,cAAc3wB,CAAI,EAC/BoxB,EAAe,GACfL,EAAwExyB,GAAQ,SAChF,YAAYA,EAAQ,WAAa,GAAO,GAAKA,EAAQ,QAAQ,GAC7D,GACFwyB,IAAuB,IACvBK,EAAa,KAAKL,CAAkB,EAGxC,MAAME,EADsB,OAA0D1yB,GAAQ,UAAe,IACpE,eAAiB,SACpD2yB,EAAsB,KAAK,2BAA8E3yB,GAAQ,WAAc,CAAE,GACnI2yB,IAAwB,IACxBE,EAAa,KAAKF,CAAmB,EAEzC,IAAIC,EAAcC,EAAa,KAAK,GAAG,EACvC,OAAID,IAAgB,KAChBA,EAAc,IAAIA,CAAW,IAE1B,CACH,KAAM,CAAE,UAAW,UAAU,GAAG,KAAK,GAAG,IAAIF,CAAU,WAAWN,CAAK,GAAGQ,CAAW,EAAE,CAAG,CACrG,CACK,CAwBD,OAAOlpB,EAAO,CACV,OAAO8U,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM8S,GAAO,KAAK,MAAO,GAAG,KAAK,GAAG,WAAW,KAAK,QAAQ,GAAI,CAAE,SAAU5nB,CAAK,EAAI,CAAE,QAAS,KAAK,OAAO,CAAE,EAC5G,MAAO,KACzB,OACM/G,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAuHD,KAAKlB,EAAMzB,EAASixB,EAAY,CAC5B,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,MAAM9L,EAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEmf,EAAsB,EAAG7xB,CAAO,EAAG,CAAE,OAAQyB,GAAQ,EAAE,CAAE,EAEpH,MAAO,CAAE,KADI,MAAM2vB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,gBAAgB,KAAK,QAAQ,GAAI1e,EAAM,CAAE,QAAS,KAAK,OAAO,EAAIue,CAAU,EAC5G,MAAO,KACzB,OACMtuB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAQD,OAAO3C,EAASixB,EAAY,CACxB,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,MAAM9L,EAAO,OAAO,OAAO,CAAE,EAAE1S,CAAO,EAEtC,MAAO,CAAE,KADI,MAAMoxB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,mBAAmB,KAAK,QAAQ,GAAI1e,EAAM,CAAE,QAAS,KAAK,OAAO,EAAIue,CAAU,EAC/G,MAAO,KACzB,OACMtuB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACD,eAAe8jB,EAAU,CACrB,OAAO,KAAK,UAAUA,CAAQ,CACjC,CACD,SAASnH,EAAM,CACX,OAAI,OAAO,OAAW,IACX,OAAO,KAAKA,CAAI,EAAE,SAAS,QAAQ,EAEvC,KAAKA,CAAI,CACnB,CACD,cAAc7d,EAAM,CAChB,MAAO,GAAG,KAAK,QAAQ,IAAIA,EAAK,QAAQ,OAAQ,EAAE,CAAC,EACtD,CACD,oBAAoBA,EAAM,CACtB,OAAOA,EAAK,QAAQ,WAAY,EAAE,EAAE,QAAQ,OAAQ,GAAG,CAC1D,CACD,2BAA2BqxB,EAAW,CAClC,MAAMtrB,EAAS,GACf,OAAIsrB,EAAU,OACVtrB,EAAO,KAAK,SAASsrB,EAAU,KAAK,EAAE,EAEtCA,EAAU,QACVtrB,EAAO,KAAK,UAAUsrB,EAAU,MAAM,EAAE,EAExCA,EAAU,QACVtrB,EAAO,KAAK,UAAUsrB,EAAU,MAAM,EAAE,EAExCA,EAAU,QACVtrB,EAAO,KAAK,UAAUsrB,EAAU,MAAM,EAAE,EAExCA,EAAU,SACVtrB,EAAO,KAAK,WAAWsrB,EAAU,OAAO,EAAE,EAEvCtrB,EAAO,KAAK,GAAG,CACzB,CACL,CC79BO,MAAMyd,GAAU,SCLV8N,GAAkB,CAC3B,gBAAiB,cAAc9N,EAAO,EAC1C,ECEe,MAAM+N,EAAiB,CAClC,YAAYtwB,EAAK0b,EAAU,GAAIgF,EAAOsG,EAAM,CACxC,KAAK,mBAAqB,GAC1B,MAAMuJ,EAAU,IAAI,IAAIvwB,CAAG,EAGqBgnB,GAAK,gBAC1B,yBAAyB,KAAKuJ,EAAQ,QAAQ,GAC/C,CAACA,EAAQ,SAAS,SAAS,mBAAmB,IAChEA,EAAQ,SAAWA,EAAQ,SAAS,QAAQ,YAAa,mBAAmB,GAGpF,KAAK,IAAMA,EAAQ,KAAK,QAAQ,MAAO,EAAE,EACzC,KAAK,QAAU,OAAO,OAAO,OAAO,OAAO,GAAIF,EAAe,EAAG3U,CAAO,EACxE,KAAK,MAAQT,GAAayF,CAAK,CAClC,CAMD,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAiCD,YAAYpjB,EAAS,CACjB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CACA,MAAMoU,EAAc,KAAK,+BAA+B5yB,CAAO,EAI/D,MAAO,CAAE,KAHI,MAAMikB,GAAI,KAAK,MAAO,GAAG,KAAK,GAAG,UAAU2O,CAAW,GAAI,CACnE,QAAS,KAAK,OAClC,CAAiB,EACc,MAAO,KACzB,OACMjwB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAkCD,UAAUgN,EAAI,CACV,OAAO6O,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAMyF,GAAI,KAAK,MAAO,GAAG,KAAK,GAAG,WAAWtU,CAAE,GAAI,CAAE,QAAS,KAAK,OAAO,CAAE,EACzE,MAAO,KACzB,OACMhN,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAsCD,aAAauwB,EAAM,CACf,OAAO1U,EAAU,KAAM,UAAW,OAAQ,UAAW7O,EAAI3P,EAAU,CAC/D,OAAQ,EACpB,EAAW,CACC,GAAI,CASA,MAAO,CAAE,KARI,MAAMoxB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,UAAW,CACtD,GAAAzhB,EACA,KAAMA,EACN,KAAM3P,EAAQ,KACd,OAAQA,EAAQ,OAChB,gBAAiBA,EAAQ,cACzB,mBAAoBA,EAAQ,gBAC/B,EAAE,CAAE,QAAS,KAAK,OAAS,GACb,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAoCD,aAAagN,EAAI3P,EAAS,CACtB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAQA,MAAO,CAAE,KAPI,MAAM6S,GAAI,KAAK,MAAO,GAAG,KAAK,GAAG,WAAW1hB,CAAE,GAAI,CAC3D,GAAAA,EACA,KAAMA,EACN,OAAQ3P,EAAQ,OAChB,gBAAiBA,EAAQ,cACzB,mBAAoBA,EAAQ,gBAC/B,EAAE,CAAE,QAAS,KAAK,OAAS,GACb,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAyBD,YAAYgN,EAAI,CACZ,OAAO6O,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,WAAWzhB,CAAE,SAAU,CAAE,EAAE,CAAE,QAAS,KAAK,OAAO,CAAE,EACpF,MAAO,KACzB,OACMhN,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CA0BD,aAAagN,EAAI,CACb,OAAO6O,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM8S,GAAO,KAAK,MAAO,GAAG,KAAK,GAAG,WAAW3hB,CAAE,GAAI,GAAI,CAAE,QAAS,KAAK,OAAO,CAAE,EAChF,MAAO,KACzB,OACMhN,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACD,+BAA+B3C,EAAS,CACpC,MAAMwH,EAAS,GACf,OAAIxH,IACI,UAAWA,IACXwH,EAAO,MAAQ,OAAOxH,EAAQ,KAAK,GAEnC,WAAYA,IACZwH,EAAO,OAAS,OAAOxH,EAAQ,MAAM,GAErCA,EAAQ,SACRwH,EAAO,OAASxH,EAAQ,QAExBA,EAAQ,aACRwH,EAAO,WAAaxH,EAAQ,YAE5BA,EAAQ,YACRwH,EAAO,UAAYxH,EAAQ,YAG5B,OAAO,KAAKwH,CAAM,EAAE,OAAS,EAAI,IAAM,IAAI,gBAAgBA,CAAM,EAAE,SAAQ,EAAK,EAC1F,CACL,CCpWA,IAAI2rB,GAAe,cAAc,KAAM,CACrC,YAAYryB,EAAS4oB,EAAM,CACzB,MAAM5oB,CAAO,EACb,KAAK,KAAO,eACZ,KAAK,OAAS4oB,EAAK,OACnB,KAAK,YAAcA,EAAK,YACxB,KAAK,YAAcA,EAAK,YACxB,KAAK,QAAUA,EAAK,QACpB,KAAK,qBAAuBA,EAAK,cAAgB,+BAAiC,CAAC,IAAK,IAAK,GAAG,EAAE,SAASA,EAAK,MAAM,GAAKA,EAAK,aAAa,SAAS,aAAa,IAAM,EAC1K,CAID,YAAa,CACX,OAAO,KAAK,SAAW,GACxB,CAID,YAAa,CACX,OAAO,KAAK,SAAW,GACxB,CAID,yBAA0B,CACxB,OAAO,KAAK,SAAW,GACxB,CACH,EAGA,SAAS0J,GAASH,EAASxxB,EAAMkhB,EAAO,CACtC,MAAMjgB,EAAM,IAAI,IAAIjB,EAAMwxB,CAAO,EACjC,GAAItQ,EACF,SAAW,CAACphB,EAAKV,CAAK,IAAK,OAAO,QAAQ8hB,CAAK,EACzC9hB,IAAU,QACZ6B,EAAI,aAAa,IAAInB,EAAKV,CAAK,EAIrC,OAAO6B,EAAI,UACb,CAGA,eAAe2wB,GAAiBC,EAAM,CACpC,MAAI,CAACA,GAAQA,EAAK,OAAS,OAClB,GAELA,EAAK,OAAS,SACT,CAAE,cAAe,UAAUA,EAAK,KAAK,IAE1CA,EAAK,OAAS,SACT,CAAE,CAACA,EAAK,IAAI,EAAGA,EAAK,KAAK,EAE9BA,EAAK,OAAS,SACT,MAAMA,EAAK,aAEb,EACT,CACA,SAASC,GAAkBvzB,EAAS,CAClC,MAAMwzB,EAAUxzB,EAAQ,WAAa,WAAW,MAChD,MAAO,CACL,MAAM,QAAQ,CACZ,OAAAwS,EACA,KAAA/Q,EACA,MAAAkhB,EACA,KAAAjQ,EACA,QAAA0L,CACN,EAAO,CACD,MAAM1b,EAAM0wB,GAASpzB,EAAQ,QAASyB,EAAMkhB,CAAK,EAC3C8Q,EAAc,MAAMJ,GAAiBrzB,EAAQ,IAAI,EACjDigB,EAAM,MAAMuT,EAAQ9wB,EAAK,CAC7B,OAAA8P,EACA,QAAS,CACP,GAAGE,EAAO,CAAE,eAAgB,kBAAoB,EAAG,CAAE,EACrD,GAAG+gB,EACH,GAAGrV,CACJ,EACD,KAAM1L,EAAO,KAAK,UAAUA,CAAI,EAAI,MAC5C,CAAO,EACKghB,EAAO,MAAMzT,EAAI,OACjB0T,GAAU1T,EAAI,QAAQ,IAAI,cAAc,GAAK,IAAI,SAAS,kBAAkB,EAC5EX,EAAOqU,GAAUD,EAAO,KAAK,MAAMA,CAAI,EAAIA,EACjD,GAAI,CAACzT,EAAI,GAAI,CACX,MAAM2T,EAAUD,EAASrU,EAAO,OAC1BuU,EAAcD,GAAS,MAC7B,MAAM,IAAIT,GACRU,GAAa,SAAW,8BAA8B5T,EAAI,MAAM,GAChE,CACE,OAAQA,EAAI,OACZ,YAAa4T,GAAa,KAC1B,YAAaA,GAAa,KAC1B,QAASD,CACV,CACX,CACO,CACD,MAAO,CAAE,OAAQ3T,EAAI,OAAQ,QAASA,EAAI,QAAS,KAAAX,EACpD,CACL,CACA,CAGA,SAASwU,GAAgBC,EAAW,CAClC,OAAOA,EAAU,KAAK,GAAG,CAC3B,CACA,IAAIC,GAAsB,KAAM,CAC9B,YAAYn0B,EAAQkT,EAAS,GAAI,CAC/B,KAAK,OAASlT,EACd,KAAK,OAASkT,CACf,CACD,MAAM,eAAekhB,EAAQ,CAC3B,MAAMtR,EAAQsR,EAAS,CAAE,OAAQH,GAAgBG,EAAO,SAAS,GAAM,OAMvE,OALiB,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,MACR,KAAM,GAAG,KAAK,MAAM,cACpB,MAAAtR,CACN,CAAK,GACe,KAAK,WAAW,IAAKuR,IAAQ,CAAE,UAAWA,CAAI,EAAC,CAChE,CACD,MAAM,gBAAgBvkB,EAAI8W,EAAU,CAClC,MAAM0N,EAAU,CACd,UAAWxkB,EAAG,UACd,WAAY8W,GAAU,UAC5B,EAMI,OALiB,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,OACR,KAAM,GAAG,KAAK,MAAM,cACpB,KAAM0N,CACZ,CAAK,GACe,IACjB,CACD,MAAM,cAAcxkB,EAAI,CACtB,MAAM,KAAK,OAAO,QAAQ,CACxB,OAAQ,SACR,KAAM,GAAG,KAAK,MAAM,eAAemkB,GAAgBnkB,EAAG,SAAS,CAAC,EACtE,CAAK,CACF,CACD,MAAM,sBAAsBA,EAAI,CAK9B,MAAO,CACL,YALe,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,MACR,KAAM,GAAG,KAAK,MAAM,eAAemkB,GAAgBnkB,EAAG,SAAS,CAAC,EACtE,CAAK,GAEsB,KAAK,UAChC,CACG,CACD,MAAM,gBAAgBA,EAAI,CACxB,GAAI,CACF,aAAM,KAAK,OAAO,QAAQ,CACxB,OAAQ,OACR,KAAM,GAAG,KAAK,MAAM,eAAemkB,GAAgBnkB,EAAG,SAAS,CAAC,EACxE,CAAO,EACM,EACR,OAAQhN,EAAO,CACd,GAAIA,aAAiBwwB,IAAgBxwB,EAAM,SAAW,IACpD,MAAO,GAET,MAAMA,CACP,CACF,CACD,MAAM,2BAA2BgN,EAAI8W,EAAU,CAC7C,GAAI,CACF,OAAO,MAAM,KAAK,gBAAgB9W,EAAI8W,CAAQ,CAC/C,OAAQ9jB,EAAO,CACd,GAAIA,aAAiBwwB,IAAgBxwB,EAAM,SAAW,IACpD,OAEF,MAAMA,CACP,CACF,CACH,EAGA,SAASyxB,GAAiBL,EAAW,CACnC,OAAOA,EAAU,KAAK,GAAG,CAC3B,CACA,IAAIM,GAAkB,KAAM,CAC1B,YAAYx0B,EAAQkT,EAAS,GAAIuhB,EAAkB,CACjD,KAAK,OAASz0B,EACd,KAAK,OAASkT,EACd,KAAK,iBAAmBuhB,CACzB,CACD,MAAM,WAAWP,EAAW,CAK1B,OAJiB,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,MACR,KAAM,GAAG,KAAK,MAAM,eAAeK,GAAiBL,EAAU,SAAS,CAAC,SAC9E,CAAK,GACe,KAAK,WACtB,CACD,MAAM,YAAYA,EAAWI,EAAS,CACpC,MAAM/V,EAAU,GAChB,OAAI,KAAK,mBACPA,EAAQ,6BAA6B,EAAI,KAAK,mBAE/B,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,OACR,KAAM,GAAG,KAAK,MAAM,eAAegW,GAAiBL,EAAU,SAAS,CAAC,UACxE,KAAMI,EACN,QAAA/V,CACN,CAAK,GACe,KAAK,QACtB,CACD,MAAM,YAAYzO,EAAIwkB,EAAS,CAC7B,MAAMjV,EAAW,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,OACR,KAAM,GAAG,KAAK,MAAM,eAAekV,GAAiBzkB,EAAG,SAAS,CAAC,WAAWA,EAAG,IAAI,GACnF,KAAMwkB,CACZ,CAAK,EACD,MAAO,CACL,oBAAqBjV,EAAS,KAAK,mBAAmB,EACtD,SAAUA,EAAS,KAAK,QAC9B,CACG,CACD,MAAM,UAAUvP,EAAI3P,EAAS,CAC3B,MAAM,KAAK,OAAO,QAAQ,CACxB,OAAQ,SACR,KAAM,GAAG,KAAK,MAAM,eAAeo0B,GAAiBzkB,EAAG,SAAS,CAAC,WAAWA,EAAG,IAAI,GACnF,MAAO,CAAE,eAAgB,OAAO3P,GAAS,OAAS,EAAK,CAAG,CAChE,CAAK,CACF,CACD,MAAM,UAAU2P,EAAI,CAClB,MAAMyO,EAAU,GAChB,OAAI,KAAK,mBACPA,EAAQ,6BAA6B,EAAI,KAAK,mBAE/B,MAAM,KAAK,OAAO,QAAQ,CACzC,OAAQ,MACR,KAAM,GAAG,KAAK,MAAM,eAAegW,GAAiBzkB,EAAG,SAAS,CAAC,WAAWA,EAAG,IAAI,GACnF,QAAAyO,CACN,CAAK,GACe,KAAK,QACtB,CACD,MAAM,YAAYzO,EAAI,CACpB,MAAMyO,EAAU,GACZ,KAAK,mBACPA,EAAQ,6BAA6B,EAAI,KAAK,kBAEhD,GAAI,CACF,aAAM,KAAK,OAAO,QAAQ,CACxB,OAAQ,OACR,KAAM,GAAG,KAAK,MAAM,eAAegW,GAAiBzkB,EAAG,SAAS,CAAC,WAAWA,EAAG,IAAI,GACnF,QAAAyO,CACR,CAAO,EACM,EACR,OAAQzb,EAAO,CACd,GAAIA,aAAiBwwB,IAAgBxwB,EAAM,SAAW,IACpD,MAAO,GAET,MAAMA,CACP,CACF,CACD,MAAM,uBAAuBoxB,EAAWI,EAAS,CAC/C,GAAI,CACF,OAAO,MAAM,KAAK,YAAYJ,EAAWI,CAAO,CACjD,OAAQxxB,EAAO,CACd,GAAIA,aAAiBwwB,IAAgBxwB,EAAM,SAAW,IACpD,OAAO,MAAM,KAAK,UAAU,CAAE,UAAWoxB,EAAU,UAAW,KAAMI,EAAQ,IAAI,CAAE,EAEpF,MAAMxxB,CACP,CACF,CACH,EAGI4xB,GAAqB,KAAM,CAM7B,YAAYv0B,EAAS,CACnB,IAAI+S,EAAS,KACT/S,EAAQ,cACV+S,GAAU,IAAI/S,EAAQ,WAAW,IAEnC,MAAMizB,EAAUjzB,EAAQ,QAAQ,SAAS,GAAG,EAAIA,EAAQ,QAAU,GAAGA,EAAQ,OAAO,IACpF,KAAK,OAASuzB,GAAkB,CAC9B,QAAAN,EACA,KAAMjzB,EAAQ,KACd,UAAWA,EAAQ,KACzB,CAAK,EACD,KAAK,iBAAmBA,EAAQ,kBAAkB,KAAK,GAAG,EAC1D,KAAK,aAAe,IAAIg0B,GAAoB,KAAK,OAAQjhB,CAAM,EAC/D,KAAK,SAAW,IAAIshB,GAAgB,KAAK,OAAQthB,EAAQ,KAAK,gBAAgB,CAC/E,CAgBD,MAAM,eAAekhB,EAAQ,CAC3B,OAAO,KAAK,aAAa,eAAeA,CAAM,CAC/C,CAkBD,MAAM,gBAAgBtkB,EAAI8W,EAAU,CAClC,OAAO,KAAK,aAAa,gBAAgB9W,EAAI8W,CAAQ,CACtD,CAaD,MAAM,cAAc9W,EAAI,CACtB,MAAM,KAAK,aAAa,cAAcA,CAAE,CACzC,CAaD,MAAM,sBAAsBA,EAAI,CAC9B,OAAO,KAAK,aAAa,sBAAsBA,CAAE,CAClD,CAaD,MAAM,WAAWokB,EAAW,CAC1B,OAAO,KAAK,SAAS,WAAWA,CAAS,CAC1C,CAgCD,MAAM,YAAYA,EAAWI,EAAS,CACpC,OAAO,KAAK,SAAS,YAAYJ,EAAWI,CAAO,CACpD,CAsBD,MAAM,YAAYxkB,EAAIwkB,EAAS,CAC7B,OAAO,KAAK,SAAS,YAAYxkB,EAAIwkB,CAAO,CAC7C,CAWD,MAAM,UAAUxkB,EAAI3P,EAAS,CAC3B,MAAM,KAAK,SAAS,UAAU2P,EAAI3P,CAAO,CAC1C,CAcD,MAAM,UAAU2P,EAAI,CAClB,OAAO,KAAK,SAAS,UAAUA,CAAE,CAClC,CAaD,MAAM,gBAAgBA,EAAI,CACxB,OAAO,KAAK,aAAa,gBAAgBA,CAAE,CAC5C,CAaD,MAAM,YAAYA,EAAI,CACpB,OAAO,KAAK,SAAS,YAAYA,CAAE,CACpC,CAuBD,MAAM,2BAA2BA,EAAI8W,EAAU,CAC7C,OAAO,KAAK,aAAa,2BAA2B9W,EAAI8W,CAAQ,CACjE,CA4BD,MAAM,uBAAuBsN,EAAWI,EAAS,CAC/C,OAAO,KAAK,SAAS,uBAAuBJ,EAAWI,CAAO,CAC/D,CACH,ECnhBe,MAAMK,EAAuB,CAkBxC,YAAY9xB,EAAK0b,EAAU,GAAIgF,EAAO,CAClC,KAAK,mBAAqB,GAC1B,KAAK,IAAM1gB,EAAI,QAAQ,MAAO,EAAE,EAChC,KAAK,QAAU,OAAO,OAAO,OAAO,OAAO,GAAIqwB,EAAe,EAAG3U,CAAO,EACxE,KAAK,MAAQT,GAAayF,CAAK,CAClC,CAYD,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAmCD,aAAavQ,EAAM,CACf,OAAO2L,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,UAAW,CAAE,KAAAve,GAAQ,CAAE,QAAS,KAAK,OAAO,CAAE,EAC9E,MAAO,KACzB,OACMlQ,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CA+CD,YAAY3C,EAAS,CACjB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAMiW,EAAc,IAAI,gBAC+Bz0B,GAAQ,QAAW,QACtEy0B,EAAY,IAAI,QAASz0B,EAAQ,MAAM,SAAQ,CAAE,EACEA,GAAQ,SAAY,QACvEy0B,EAAY,IAAI,SAAUz0B,EAAQ,OAAO,SAAQ,CAAE,EACDA,GAAQ,YAC1Dy0B,EAAY,IAAI,aAAcz0B,EAAQ,UAAU,EACEA,GAAQ,WAC1Dy0B,EAAY,IAAI,YAAaz0B,EAAQ,SAAS,EACIA,GAAQ,QAC1Dy0B,EAAY,IAAI,SAAUz0B,EAAQ,MAAM,EAC5C,MAAM4yB,EAAc6B,EAAY,WAC1B/xB,EAAMkwB,EAAc,GAAG,KAAK,GAAG,WAAWA,CAAW,GAAK,GAAG,KAAK,GAAG,UAE3E,MAAO,CAAE,KADI,MAAM3O,GAAI,KAAK,MAAOvhB,EAAK,CAAE,QAAS,KAAK,OAAO,CAAE,EAC5C,MAAO,IAAI,CACnC,OACMC,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAgCD,aAAa+tB,EAAY,CACrB,OAAOlS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM8S,GAAO,KAAK,MAAO,GAAG,KAAK,GAAG,WAAWZ,CAAU,GAAI,GAAI,CAAE,QAAS,KAAK,OAAO,CAAE,EACxF,MAAO,KACzB,OACM/tB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIktB,GAAeltB,CAAK,EACpB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAwID,KAAK+tB,EAAY,CAEb,GAAI,CAACD,GAAkBC,CAAU,EAC7B,MAAM,IAAId,GAAa,oJACgC,EAM3D,OAAO,IAAI2E,GAAmB,CAC1B,QAAS,KAAK,IACd,YAAa7D,EACb,KAAM,CACF,KAAM,SACN,WAAY,IAAMlS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAAE,OAAO,KAAK,OAAQ,CAAE,CAC1F,EACD,MAAO,KAAK,KACxB,CAAS,CACJ,CACL,CC3XO,MAAMuU,GAAkB,CAC3B,gBAAiB,cAAc9N,EAAO,GACtC,eAAgB,kBACpB,ECDO,MAAMyP,WAA4B,KAAM,CAC3C,YAAY5zB,EAAS,CACjB,MAAMA,CAAO,EACb,KAAK,wBAA0B,GAC/B,KAAK,KAAO,qBACf,CACL,CAMO,SAAS6zB,GAAsBhyB,EAAO,CACzC,OAAO,OAAOA,GAAU,UAAYA,IAAU,MAAQ,4BAA6BA,CACvF,CAKO,MAAMiyB,WAA+BF,EAAoB,CAC5D,YAAY5zB,EAASuf,EAAQ0P,EAAY,CACrC,MAAMjvB,CAAO,EACb,KAAK,KAAO,yBACZ,KAAK,OAASuf,EACd,KAAK,WAAa0P,CACrB,CACD,QAAS,CACL,MAAO,CACH,KAAM,KAAK,KACX,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,WAAY,KAAK,UAC7B,CACK,CACL,CAKO,MAAM8E,WAAmCH,EAAoB,CAChE,YAAY5zB,EAASmvB,EAAe,CAChC,MAAMnvB,CAAO,EACb,KAAK,KAAO,6BACZ,KAAK,cAAgBmvB,CACxB,CACL,CAKO,IAAI6E,IACV,SAAUA,EAAyB,CAEhCA,EAAwB,cAAmB,gBAE3CA,EAAwB,0BAA+B,4BAEvDA,EAAwB,0BAA+B,4BAEvDA,EAAwB,uBAA4B,yBAEpDA,EAAwB,2BAAgC,6BAExDA,EAAwB,2BAAgC,4BAC5D,GAAGA,KAA4BA,GAA0B,GAAG,EC5DrD,MAAMnX,GAAgBC,GACrBA,EACO,IAAIC,IAASD,EAAY,GAAGC,CAAI,EAEpC,IAAIA,IAAS,MAAM,GAAGA,CAAI,EAmBxB0S,GAAiB1vB,GAAU,CACpC,GAAI,OAAOA,GAAU,UAAYA,IAAU,KACvC,MAAO,GAEX,MAAM2vB,EAAY,OAAO,eAAe3vB,CAAK,EAC7C,OAAS2vB,IAAc,MACnBA,IAAc,OAAO,WACrB,OAAO,eAAeA,CAAS,IAAM,OACrC,EAAE,OAAO,eAAe3vB,IACxB,EAAE,OAAO,YAAYA,EAC7B,EChCM8vB,GAAoBC,GAAQA,EAAI,KAAOA,EAAI,SAAWA,EAAI,mBAAqBA,EAAI,OAAS,KAAK,UAAUA,CAAG,EAO9GC,GAAc,CAACluB,EAAOmuB,EAAQ9wB,IAAYwe,EAAU,OAAQ,OAAQ,OAAQ,WAAa,CAQ3F,GALuB7b,GACnB,OAAOA,GAAU,UACjB,WAAYA,GACZ,OAAQA,GACR,OAAOA,EAAM,QAAW,UACN,CAAoD3C,GAAQ,cAAgB,CAC9F,MAAMqgB,EAAS1d,EAAM,QAAU,IACzBoyB,EAAgBpyB,EAEtB,GAAI,OAAOoyB,EAAc,MAAS,WAC9BA,EACK,KAAM,EACN,KAAMnE,GAAQ,CACf,MAAMb,EAAwDa,GAAI,YAA0DA,GAAI,MAASvQ,EAAS,GAClJyQ,EAAO,IAAI8D,GAAuBjE,GAAiBC,CAAG,EAAGvQ,EAAQ0P,CAAU,CAAC,CAC5F,CAAa,EACI,MAAM,IAAM,CAEb,MAAMA,EAAa1P,EAAS,GACtBvf,EAAUi0B,EAAc,YAAc,QAAQ1U,CAAM,SAC1DyQ,EAAO,IAAI8D,GAAuB9zB,EAASuf,EAAQ0P,CAAU,CAAC,CAC9E,CAAa,MAEA,CAED,MAAMA,EAAa1P,EAAS,GACtBvf,EAAUi0B,EAAc,YAAc,QAAQ1U,CAAM,SAC1DyQ,EAAO,IAAI8D,GAAuB9zB,EAASuf,EAAQ0P,CAAU,CAAC,CACjE,CACJ,MAEGe,EAAO,IAAI+D,GAA2BlE,GAAiBhuB,CAAK,EAAGA,CAAK,CAAC,CAE7E,CAAC,EASKquB,GAAoB,CAACxe,EAAQxS,EAASixB,EAAYve,IAAS,CAC7D,MAAMlL,EAAS,CAAE,OAAAgL,EAAQ,QAA4DxS,GAAQ,SAAY,CAAE,GAC3G,OAAIwS,IAAW,OAAS,CAACE,EACdlL,GAEP+oB,GAAc7d,CAAI,GAClBlL,EAAO,QAAU,OAAO,OAAO,CAAE,eAAgB,oBAAwExH,GAAQ,OAAO,EACxIwH,EAAO,KAAO,KAAK,UAAUkL,CAAI,GAGjClL,EAAO,KAAOkL,EAEX,OAAO,OAAO,OAAO,OAAO,GAAIlL,CAAM,EAAGypB,CAAU,EAC9D,EAWA,SAASC,GAAeC,EAAS3e,EAAQ9P,EAAK1C,EAASixB,EAAYve,EAAM,CACrE,OAAO8L,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO,IAAI,QAAQ,CAACgO,EAASsE,IAAW,CACpCK,EAAQzuB,EAAKsuB,GAAkBxe,EAAQxS,EAASixB,EAAYve,CAAI,CAAC,EAC5D,KAAMpN,GAAW,CAClB,GAAI,CAACA,EAAO,GACR,MAAMA,EACV,GAAsDtF,GAAQ,cAC1D,OAAOsF,EAEX,MAAM0vB,EAAc1vB,EAAO,QAAQ,IAAI,cAAc,EACrD,MAAI,CAAC0vB,GAAe,CAACA,EAAY,SAAS,kBAAkB,EACjD,GAEJ1vB,EAAO,MAC9B,CAAa,EACI,KAAMga,GAASkN,EAAQlN,CAAI,CAAC,EAC5B,MAAO3c,GAAUkuB,GAAYluB,EAAOmuB,EAAQ9wB,CAAO,CAAC,CACrE,CAAS,CACT,CAAK,CACL,CAuBO,SAASoxB,GAAKD,EAASzuB,EAAKgQ,EAAM1S,EAASixB,EAAY,CAC1D,OAAOzS,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAO0S,GAAeC,EAAS,OAAQzuB,EAAK1C,EAASixB,EAAYve,CAAI,CAC7E,CAAK,CACL,CCzHe,MAAMuiB,EAAe,CAEhC,YAAYvyB,EAAK0b,EAAU,GAAIgF,EAAO,CAClC,KAAK,mBAAqB,GAC1B,KAAK,IAAM1gB,EAAI,QAAQ,MAAO,EAAE,EAChC,KAAK,QAAU,OAAO,OAAO,OAAO,OAAO,GAAIqwB,EAAe,EAAG3U,CAAO,EACxE,KAAK,MAAQT,GAAayF,CAAK,CAClC,CAED,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAED,YAAYpjB,EAAS,CACjB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAIA,MAAO,CAAE,MAHI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,eAAgBpxB,EAAS,CACpE,QAAS,KAAK,OAClC,CAAiB,IACsB,CAAE,EAAE,MAAO,IAAI,CACzC,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,SAASuyB,EAAkBC,EAAW,CAClC,OAAO3W,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,YAAa,CAAE,iBAAA8D,EAAkB,UAAAC,CAAW,EAAE,CAAE,QAAS,KAAK,OAAO,CAAE,EACvG,MAAO,KACzB,OACMxyB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,YAAY3C,EAAS,CACjB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAIA,MAAO,CAAE,KAHI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,eAAgBpxB,EAAS,CACpE,QAAS,KAAK,OAClC,CAAiB,EACc,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,YAAYuyB,EAAkBC,EAAW,CACrC,OAAO3W,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,MADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,eAAgB,CAAE,iBAAA8D,EAAkB,UAAAC,CAAW,EAAE,CAAE,QAAS,KAAK,OAAO,CAAE,IAClG,CAAE,EAAE,MAAO,IAAI,CACzC,OACMxyB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACL,CCzFe,MAAMyyB,EAAc,CAE/B,YAAY1yB,EAAK0b,EAAU,GAAIgF,EAAO,CAClC,KAAK,mBAAqB,GAC1B,KAAK,IAAM1gB,EAAI,QAAQ,MAAO,EAAE,EAChC,KAAK,QAAU,OAAO,OAAO,OAAO,OAAO,GAAIqwB,EAAe,EAAG3U,CAAO,EACxE,KAAK,MAAQT,GAAayF,CAAK,CAClC,CAED,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAED,WAAWpjB,EAAS,CAChB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,GAAIxe,EAAQ,QAAQ,OAAS,GAAKA,EAAQ,QAAQ,OAAS,IACvD,MAAM,IAAI,MAAM,mDAAmD,EAKvE,MAAO,CAAE,MAHI,MAAMoxB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,cAAepxB,EAAS,CACnE,QAAS,KAAK,OAClC,CAAiB,IACsB,CAAE,EAAE,MAAO,IAAI,CACzC,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,WAAW3C,EAAS,CAChB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAIA,MAAO,CAAE,KAHI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,cAAepxB,EAAS,CACnE,QAAS,KAAK,OAClC,CAAiB,EACc,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,YAAY3C,EAAS,CACjB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,GAAIxe,EAAQ,eAAiB,OAAW,CACpC,GAAIA,EAAQ,aAAe,GAAKA,EAAQ,aAAe,GACnD,MAAM,IAAI,MAAM,uCAAuC,EAE3D,GAAIA,EAAQ,eAAiB,SACrBA,EAAQ,aAAe,GAAKA,EAAQ,cAAgBA,EAAQ,cAC5D,MAAM,IAAI,MAAM,sCAAsCA,EAAQ,aAAe,CAAC,EAAE,CAG3F,CAID,MAAO,CAAE,KAHI,MAAMoxB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,eAAgBpxB,EAAS,CACpE,QAAS,KAAK,OAClC,CAAiB,EACc,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,aAAa3C,EAAS,CAClB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAIA,MAAO,CAAE,KAHI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,gBAAiBpxB,EAAS,CACrE,QAAS,KAAK,OAClC,CAAiB,EACc,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,cAAc3C,EAAS,CACnB,OAAOwe,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,GAAIxe,EAAQ,KAAK,OAAS,GAAKA,EAAQ,KAAK,OAAS,IACjD,MAAM,IAAI,MAAM,iDAAiD,EAKrE,MAAO,CAAE,MAHI,MAAMoxB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,iBAAkBpxB,EAAS,CACtE,QAAS,KAAK,OAClC,CAAiB,IACsB,CAAE,EAAE,MAAO,IAAI,CACzC,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACL,CCpIe,MAAM0yB,EAAgB,CAEjC,YAAY3yB,EAAK0b,EAAU,GAAIgF,EAAO,CAClC,KAAK,mBAAqB,GAC1B,KAAK,IAAM1gB,EAAI,QAAQ,MAAO,EAAE,EAChC,KAAK,QAAU,OAAO,OAAO,OAAO,OAAO,GAAIqwB,EAAe,EAAG3U,CAAO,EACxE,KAAK,MAAQT,GAAayF,CAAK,CAClC,CAED,cAAe,CACX,YAAK,mBAAqB,GACnB,IACV,CAED,aAAa8R,EAAkB,CAC3B,OAAO1W,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,MADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,sBAAuB,CAAE,iBAAA8D,GAAoB,CAAE,QAAS,KAAK,OAAO,CAAE,IAC9F,CAAE,EAAE,MAAO,IAAI,CACzC,OACMvyB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,UAAUuyB,EAAkB,CACxB,OAAO1W,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,KADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,mBAAoB,CAAE,iBAAA8D,GAAoB,CAAE,QAAS,KAAK,OAAO,CAAE,EACnG,MAAO,KACzB,OACMvyB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,aAAc,CACV,OAAO6b,EAAU,KAAM,UAAW,OAAQ,UAAWxe,EAAU,GAAI,CAC/D,GAAI,CAIA,MAAO,CAAE,KAHI,MAAMoxB,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,qBAAsBpxB,EAAS,CAC1E,QAAS,KAAK,OAClC,CAAiB,EACc,MAAO,KACzB,OACM2C,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CAED,aAAauyB,EAAkB,CAC3B,OAAO1W,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,GAAI,CAEA,MAAO,CAAE,MADI,MAAM4S,GAAK,KAAK,MAAO,GAAG,KAAK,GAAG,sBAAuB,CAAE,iBAAA8D,GAAoB,CAAE,QAAS,KAAK,OAAO,CAAE,IAC9F,CAAE,EAAE,MAAO,IAAI,CACzC,OACMvyB,EAAO,CACV,GAAI,KAAK,mBACL,MAAMA,EAEV,GAAIgyB,GAAsBhyB,CAAK,EAC3B,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACb,CAAS,CACJ,CACL,CCnDO,MAAM2yB,WAA6BD,EAAgB,CAkBtD,YAAY3yB,EAAK1C,EAAU,GAAI,CAC3B,MAAM0C,EAAK1C,EAAQ,SAAW,GAAIA,EAAQ,KAAK,CAClD,CAmBD,KAAKk1B,EAAkB,CACnB,OAAO,IAAIK,GAAkB,KAAK,IAAK,KAAK,QAASL,EAAkB,KAAK,KAAK,CACpF,CAsBD,aAAaA,EAAkB,CAC3B,MAAMM,EAAS,OAAO,OAAO,KAAM,CAC/B,aAAc,CAAE,IAAK,IAAM,MAAM,YAAc,CAC3D,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,aAAa,KAAK,KAAMN,CAAgB,CAClE,CAAS,CACJ,CAuBD,UAAUA,EAAkB,CACxB,MAAMM,EAAS,OAAO,OAAO,KAAM,CAC/B,UAAW,CAAE,IAAK,IAAM,MAAM,SAAW,CACrD,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,UAAU,KAAK,KAAMN,CAAgB,CAC/D,CAAS,CACJ,CAyBD,aAAc,CACV,MAAMM,EAAS,OAAO,OAAO,KAAM,CAC/B,YAAa,CAAE,IAAK,IAAM,MAAM,WAAa,CACzD,CAAS,EACD,OAAOhX,EAAU,KAAM,UAAW,OAAQ,UAAWxe,EAAU,GAAI,CAC/D,OAAOw1B,EAAO,YAAY,KAAK,KAAMx1B,CAAO,CACxD,CAAS,CACJ,CAsBD,aAAak1B,EAAkB,CAC3B,MAAMM,EAAS,OAAO,OAAO,KAAM,CAC/B,aAAc,CAAE,IAAK,IAAM,MAAM,YAAc,CAC3D,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,aAAa,KAAK,KAAMN,CAAgB,CAClE,CAAS,CACJ,CACL,CAUO,MAAMK,WAA0BN,EAAe,CAclD,YAAYvyB,EAAK0b,EAAS8W,EAAkB9R,EAAO,CAC/C,MAAM1gB,EAAK0b,EAASgF,CAAK,EACzB,KAAK,iBAAmB8R,CAC3B,CA4BD,YAAYl1B,EAAS,CACjB,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,YAAa,CAAE,IAAK,IAAM,MAAM,WAAa,CACzD,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,YAAY,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,gBAAkB,EAAC,CACvI,CAAS,CACJ,CAoBD,aAAc,CACV,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,YAAa,CAAE,IAAK,IAAM,MAAM,WAAa,CACzD,CAAS,EACD,OAAOhX,EAAU,KAAM,UAAW,OAAQ,UAAWxe,EAAU,GAAI,CAC/D,OAAOw1B,EAAO,YAAY,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,gBAAkB,EAAC,CACvI,CAAS,CACJ,CAqBD,SAASm1B,EAAW,CAChB,MAAMK,EAAS,OAAO,OAAO,KAAM,CAC/B,SAAU,CAAE,IAAK,IAAM,MAAM,QAAU,CACnD,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,SAAS,KAAK,KAAM,KAAK,iBAAkBL,CAAS,CAC9E,CAAS,CACJ,CAoBD,YAAYA,EAAW,CACnB,MAAMK,EAAS,OAAO,OAAO,KAAM,CAC/B,YAAa,CAAE,IAAK,IAAM,MAAM,WAAa,CACzD,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,YAAY,KAAK,KAAM,KAAK,iBAAkBL,CAAS,CACjF,CAAS,CACJ,CAgCD,MAAMA,EAAW,CACb,OAAO,IAAIM,GAAiB,KAAK,IAAK,KAAK,QAAS,KAAK,iBAAkBN,EAAW,KAAK,KAAK,CACnG,CACL,CAUO,MAAMM,WAAyBL,EAAc,CAehD,YAAY1yB,EAAK0b,EAAS8W,EAAkBC,EAAW/R,EAAO,CAC1D,MAAM1gB,EAAK0b,EAASgF,CAAK,EACzB,KAAK,iBAAmB8R,EACxB,KAAK,UAAYC,CACpB,CA4BD,WAAWn1B,EAAS,CAChB,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,WAAY,CAAE,IAAK,IAAM,MAAM,UAAY,CACvD,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,WAAW,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,iBAAkB,UAAW,KAAK,SAAW,EAAC,CACjK,CAAS,CACJ,CAuBD,WAAWA,EAAS,CAChB,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,WAAY,CAAE,IAAK,IAAM,MAAM,UAAY,CACvD,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,WAAW,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,iBAAkB,UAAW,KAAK,SAAW,EAAC,CACjK,CAAS,CACJ,CAuBD,aAAc,CACV,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,YAAa,CAAE,IAAK,IAAM,MAAM,WAAa,CACzD,CAAS,EACD,OAAOhX,EAAU,KAAM,UAAW,OAAQ,UAAWxe,EAAU,GAAI,CAC/D,OAAOw1B,EAAO,YAAY,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,iBAAkB,UAAW,KAAK,SAAW,EAAC,CAClK,CAAS,CACJ,CA0BD,aAAaA,EAAS,CAClB,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,aAAc,CAAE,IAAK,IAAM,MAAM,YAAc,CAC3D,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,aAAa,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,iBAAkB,UAAW,KAAK,SAAW,EAAC,CACnK,CAAS,CACJ,CAsBD,cAAcA,EAAS,CACnB,MAAMw1B,EAAS,OAAO,OAAO,KAAM,CAC/B,cAAe,CAAE,IAAK,IAAM,MAAM,aAAe,CAC7D,CAAS,EACD,OAAOhX,EAAU,KAAM,OAAQ,OAAQ,WAAa,CAChD,OAAOgX,EAAO,cAAc,KAAK,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIx1B,CAAO,EAAG,CAAE,iBAAkB,KAAK,iBAAkB,UAAW,KAAK,SAAW,EAAC,CACpK,CAAS,CACJ,CACL,CC1jBO,MAAM01B,WAAsB1C,EAAiB,CAehD,YAAYtwB,EAAK0b,EAAU,GAAIgF,EAAOsG,EAAM,CACxC,MAAMhnB,EAAK0b,EAASgF,EAAOsG,CAAI,CAClC,CAYD,KAAK/Z,EAAI,CACL,OAAO,IAAIoiB,GAAe,KAAK,IAAK,KAAK,QAASpiB,EAAI,KAAK,KAAK,CACnE,CAYD,IAAI,SAAU,CACV,OAAO,IAAI2lB,GAAqB,KAAK,IAAM,UAAW,CAClD,QAAS,KAAK,QACd,MAAO,KAAK,KACxB,CAAS,CACJ,CAYD,IAAI,WAAY,CACZ,OAAO,IAAId,GAAuB,KAAK,IAAM,WAAY,KAAK,QAAS,KAAK,KAAK,CACpF,CACL,CC7DO,MAAMvP,GAAU,SCLvB,IAAI0Q,GAAS,GAET,OAAO,KAAS,IAChBA,GAAS,OAEJ,OAAO,SAAa,IACzBA,GAAS,MAEJ,OAAO,UAAc,KAAe,UAAU,UAAY,cAC/DA,GAAS,eAGTA,GAAS,OAEN,MAAM5C,GAAkB,CAAE,gBAAiB,eAAe4C,EAAM,IAAI1Q,EAAO,IACrE2Q,GAAyB,CAClC,QAAS7C,EACb,EACa8C,GAAqB,CAC9B,OAAQ,QACZ,EACaC,GAAuB,CAChC,iBAAkB,GAClB,eAAgB,GAChB,mBAAoB,GACpB,SAAU,UACd,EACaC,GAA2B,CAAE,EC5B7BpY,GAAgBC,GACrBA,EACO,IAAIC,IAASD,EAAY,GAAGC,CAAI,EAEpC,IAAIA,IAAS,MAAM,GAAGA,CAAI,EAExBmY,GAA4B,IAC9B,QAEEC,GAAgB,CAACC,EAAaC,EAAgBvY,IAAgB,CACvE,MAAMwF,EAAQzF,GAAaC,CAAW,EAChCwY,EAAqBJ,KAC3B,MAAO,OAAOK,EAAOxkB,IAAS,CAC1B,IAAI6M,EACJ,MAAM4X,GAAe5X,EAAM,MAAMyX,EAAgB,KAAO,MAAQzX,IAAO,OAASA,EAAKwX,EACrF,IAAI9X,EAAU,IAAIgY,EAA+DvkB,GAAK,OAAO,EAC7F,OAAKuM,EAAQ,IAAI,QAAQ,GACrBA,EAAQ,IAAI,SAAU8X,CAAW,EAEhC9X,EAAQ,IAAI,eAAe,GAC5BA,EAAQ,IAAI,gBAAiB,UAAUkY,CAAW,EAAE,EAEjDlT,EAAMiT,EAAO,OAAO,OAAO,OAAO,OAAO,GAAIxkB,CAAI,EAAG,CAAE,QAAAuM,CAAO,CAAE,CAAC,CAC/E,CACA,EClBO,SAASmY,GAAoB7zB,EAAK,CACrC,OAAOA,EAAI,SAAS,GAAG,EAAIA,EAAMA,EAAM,GAC3C,CAEO,SAAS8zB,GAAqBx2B,EAASy2B,EAAU,CACpD,IAAI/X,EAAImB,EACR,KAAM,CAAE,GAAI6W,EAAW,KAAMC,EAAa,SAAUC,EAAiB,OAAQC,CAAgB,EAAG72B,EAC1F,CAAE,GAAI61B,EAAoB,KAAMC,EAAsB,SAAUC,EAA0B,OAAQH,CAAyB,EAAGa,EAC9HnxB,EAAS,CACX,GAAI,OAAO,OAAO,OAAO,OAAO,GAAIuwB,CAAkB,EAAGa,CAAS,EAClE,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIZ,CAAoB,EAAGa,CAAW,EACxE,SAAU,OAAO,OAAO,OAAO,OAAO,GAAIZ,CAAwB,EAAGa,CAAe,EACpF,QAAS,CAAE,EACX,OAAQ,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEhB,CAAsB,EAAGiB,CAAa,EAAG,CAAE,QAAS,OAAO,OAAO,OAAO,OAAO,CAAE,GAAInY,EAAqFkX,GAAuB,WAAa,MAAQlX,IAAO,OAASA,EAAK,EAAI,GAAImB,EAAmEgX,GAAc,WAAa,MAAQhX,IAAO,OAASA,EAAK,EAAI,EAAE,EAC3a,YAAa,SAAY,EACjC,EACI,OAAI7f,EAAQ,YACRsF,EAAO,YAActF,EAAQ,YAI7B,OAAOsF,EAAO,YAEXA,CACX,CAQO,SAASwxB,GAAoBC,EAAa,CAC7C,MAAMC,EAAuED,GAAY,OACzF,GAAI,CAACC,EACD,MAAM,IAAI,MAAM,0BAA0B,EAE9C,GAAI,CAACA,EAAW,MAAM,eAAe,EACjC,MAAM,IAAI,MAAM,yDAAyD,EAE7E,GAAI,CACA,OAAO,IAAI,IAAIT,GAAoBS,CAAU,CAAC,CACjD,MACU,CACP,MAAM,MAAM,iDAAiD,CAChE,CACL,CC9CO,MAAM/R,GAAU,SCJVgS,GAAgC,GAAK,IAGrCC,GAA8B,EAI9BC,GAAmBD,GAA8BD,GACjDG,GAAa,wBACbC,GAAc,sBAEdtE,GAAkB,CAAE,gBAAiB,aAAa9N,EAAO,EAAE,EAK3DqS,GAA0B,yBAC1BC,GAAe,CACxB,aAAc,CACV,UAAW,KAAK,MAAM,wBAAwB,EAC9C,KAAM,YACT,CACL,EACaC,GAAkB,uDAClBC,GAAW,GAAK,GAAK,IChB3B,MAAMC,WAAkB,KAAM,CACjC,YAAY52B,EAASuf,EAAQgO,EAAM,CAC/B,MAAMvtB,CAAO,EACb,KAAK,cAAgB,GACrB,KAAK,KAAO,YACZ,KAAK,OAASuf,EACd,KAAK,KAAOgO,CACf,CACL,CACO,SAASsJ,EAAYh1B,EAAO,CAC/B,OAAO,OAAOA,GAAU,UAAYA,IAAU,MAAQ,kBAAmBA,CAC7E,CAWO,MAAMi1B,WAAqBF,EAAU,CACxC,YAAY52B,EAASuf,EAAQgO,EAAM,CAC/B,MAAMvtB,EAASuf,EAAQgO,CAAI,EAC3B,KAAK,KAAO,eACZ,KAAK,OAAShO,EACd,KAAK,KAAOgO,CACf,CACL,CACO,SAASwJ,GAAel1B,EAAO,CAClC,OAAOg1B,EAAYh1B,CAAK,GAAKA,EAAM,OAAS,cAChD,CAeO,MAAMm1B,WAAyBJ,EAAU,CAC5C,YAAY52B,EAASmvB,EAAe,CAChC,MAAMnvB,CAAO,EACb,KAAK,KAAO,mBACZ,KAAK,cAAgBmvB,CACxB,CACL,CAWO,MAAM8H,WAAwBL,EAAU,CAC3C,YAAY52B,EAAS+R,EAAMwN,EAAQgO,EAAM,CACrC,MAAMvtB,EAASuf,EAAQgO,CAAI,EAC3B,KAAK,KAAOxb,EACZ,KAAK,OAASwN,CACjB,CACL,CAWO,MAAM2X,WAAgCD,EAAgB,CACzD,aAAc,CACV,MAAM,wBAAyB,0BAA2B,IAAK,MAAS,CAC3E,CACL,CACO,SAASE,GAA0Bt1B,EAAO,CAC7C,OAAOg1B,EAAYh1B,CAAK,GAAKA,EAAM,OAAS,yBAChD,CAWO,MAAMu1B,WAAsCH,EAAgB,CAC/D,aAAc,CACV,MAAM,+BAAgC,gCAAiC,IAAK,MAAS,CACxF,CACL,CAWO,MAAMI,WAAoCJ,EAAgB,CAC7D,YAAYj3B,EAAS,CACjB,MAAMA,EAAS,8BAA+B,IAAK,MAAS,CAC/D,CACL,CAcO,MAAMs3B,WAAuCL,EAAgB,CAChE,YAAYj3B,EAASu3B,EAAU,KAAM,CACjC,MAAMv3B,EAAS,iCAAkC,IAAK,MAAS,EAC/D,KAAK,QAAU,KACf,KAAK,QAAUu3B,CAClB,CACD,QAAS,CACL,MAAO,CACH,KAAM,KAAK,KACX,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,QAAS,KAAK,OAC1B,CACK,CACL,CACO,SAASC,GAAiC31B,EAAO,CACpD,OAAOg1B,EAAYh1B,CAAK,GAAKA,EAAM,OAAS,gCAChD,CAWO,MAAM41B,WAAuCR,EAAgB,CAChE,YAAYj3B,EAASu3B,EAAU,KAAM,CACjC,MAAMv3B,EAAS,iCAAkC,IAAK,MAAS,EAC/D,KAAK,QAAU,KACf,KAAK,QAAUu3B,CAClB,CACD,QAAS,CACL,MAAO,CACH,KAAM,KAAK,KACX,QAAS,KAAK,QACd,OAAQ,KAAK,OACb,QAAS,KAAK,OAC1B,CACK,CACL,CAWO,MAAMG,WAAgCT,EAAgB,CACzD,YAAYj3B,EAASuf,EAAQ,CACzB,MAAMvf,EAAS,0BAA2Buf,EAAQ,MAAS,CAC9D,CACL,CACO,SAASoY,GAA0B91B,EAAO,CAC7C,OAAOg1B,EAAYh1B,CAAK,GAAKA,EAAM,OAAS,yBAChD,CAgBO,MAAM+1B,WAA8BX,EAAgB,CACvD,YAAYj3B,EAASuf,EAAQsY,EAAS,CAClC,MAAM73B,EAAS,wBAAyBuf,EAAQ,eAAe,EAC/D,KAAK,QAAUsY,CAClB,CACL,CAcO,MAAMC,WAA4Bb,EAAgB,CACrD,YAAYj3B,EAAS,CACjB,MAAMA,EAAS,sBAAuB,IAAK,aAAa,CAC3D,CACL,CCxOA,MAAM+3B,GAAe,mEAAmE,MAAM,EAAE,EAK1FC,GAAmB;AAAA,KAAW,MAAM,EAAE,EAKtCC,IAAkB,IAAM,CAC1B,MAAMC,EAAU,IAAI,MAAM,GAAG,EAC7B,QAASj1B,EAAI,EAAGA,EAAIi1B,EAAQ,OAAQj1B,GAAK,EACrCi1B,EAAQj1B,CAAC,EAAI,GAEjB,QAASA,EAAI,EAAGA,EAAI+0B,GAAiB,OAAQ/0B,GAAK,EAC9Ci1B,EAAQF,GAAiB/0B,CAAC,EAAE,WAAW,CAAC,CAAC,EAAI,GAEjD,QAASA,EAAI,EAAGA,EAAI80B,GAAa,OAAQ90B,GAAK,EAC1Ci1B,EAAQH,GAAa90B,CAAC,EAAE,WAAW,CAAC,CAAC,EAAIA,EAE7C,OAAOi1B,CACX,KAQO,SAASC,GAAgBC,EAAM53B,EAAO63B,EAAM,CAC/C,GAAID,IAAS,KAGT,IAFA53B,EAAM,MAASA,EAAM,OAAS,EAAK43B,EACnC53B,EAAM,YAAc,EACbA,EAAM,YAAc,GAAG,CAC1B,MAAM83B,EAAO93B,EAAM,OAAUA,EAAM,WAAa,EAAM,GACtD63B,EAAKN,GAAaO,CAAG,CAAC,EACtB93B,EAAM,YAAc,CACvB,SAEIA,EAAM,WAAa,EAGxB,IAFAA,EAAM,MAAQA,EAAM,OAAU,EAAIA,EAAM,WACxCA,EAAM,WAAa,EACZA,EAAM,YAAc,GAAG,CAC1B,MAAM83B,EAAO93B,EAAM,OAAUA,EAAM,WAAa,EAAM,GACtD63B,EAAKN,GAAaO,CAAG,CAAC,EACtB93B,EAAM,YAAc,CACvB,CAET,CAQO,SAAS+3B,GAAkBC,EAAUh4B,EAAO63B,EAAM,CACrD,MAAMI,EAAOR,GAAeO,CAAQ,EACpC,GAAIC,EAAO,GAIP,IAFAj4B,EAAM,MAASA,EAAM,OAAS,EAAKi4B,EACnCj4B,EAAM,YAAc,EACbA,EAAM,YAAc,GACvB63B,EAAM73B,EAAM,OAAUA,EAAM,WAAa,EAAM,GAAI,EACnDA,EAAM,YAAc,MAGvB,IAAIi4B,IAAS,GAEd,OAGA,MAAM,IAAI,MAAM,iCAAiC,OAAO,aAAaD,CAAQ,CAAC,GAAG,EAEzF,CA0BO,SAASE,GAAoBC,EAAK,CACrC,MAAMC,EAAO,GACPC,EAAYC,GAAc,CAC5BF,EAAK,KAAK,OAAO,cAAcE,CAAS,CAAC,CACjD,EACUC,EAAY,CACd,QAAS,EACT,UAAW,CACnB,EACUC,EAAW,CAAE,MAAO,EAAG,WAAY,CAAC,EACpCC,EAAYb,GAAS,CACvBc,GAAed,EAAMW,EAAWF,CAAQ,CAChD,EACI,QAAS51B,EAAI,EAAGA,EAAI01B,EAAI,OAAQ11B,GAAK,EACjCs1B,GAAkBI,EAAI,WAAW11B,CAAC,EAAG+1B,EAAUC,CAAQ,EAE3D,OAAOL,EAAK,KAAK,EAAE,CACvB,CAOO,SAASO,GAAgBL,EAAWT,EAAM,CAC7C,GAAIS,GAAa,IAAM,CACnBT,EAAKS,CAAS,EACd,MACH,SACQA,GAAa,KAAO,CACzBT,EAAK,IAAQS,GAAa,CAAE,EAC5BT,EAAK,IAAQS,EAAY,EAAK,EAC9B,MACH,SACQA,GAAa,MAAQ,CAC1BT,EAAK,IAAQS,GAAa,EAAG,EAC7BT,EAAK,IAASS,GAAa,EAAK,EAAK,EACrCT,EAAK,IAAQS,EAAY,EAAK,EAC9B,MACH,SACQA,GAAa,QAAU,CAC5BT,EAAK,IAAQS,GAAa,EAAG,EAC7BT,EAAK,IAASS,GAAa,GAAM,EAAK,EACtCT,EAAK,IAASS,GAAa,EAAK,EAAK,EACrCT,EAAK,IAAQS,EAAY,EAAK,EAC9B,MACH,CACD,MAAM,IAAI,MAAM,mCAAmCA,EAAU,SAAS,EAAE,CAAC,EAAE,CAC/E,CAOO,SAASM,GAAaT,EAAKN,EAAM,CACpC,QAASp1B,EAAI,EAAGA,EAAI01B,EAAI,OAAQ11B,GAAK,EAAG,CACpC,IAAI61B,EAAYH,EAAI,WAAW11B,CAAC,EAChC,GAAI61B,EAAY,OAAUA,GAAa,MAAQ,CAI3C,MAAMO,GAAkBP,EAAY,OAAU,KAAS,MAEvDA,GADsBH,EAAI,WAAW11B,EAAI,CAAC,EAAI,MAAU,MAC5Bo2B,GAAiB,MAC7Cp2B,GAAK,CACR,CACDk2B,GAAgBL,EAAWT,CAAI,CAClC,CACL,CASO,SAASa,GAAed,EAAM53B,EAAO63B,EAAM,CAC9C,GAAI73B,EAAM,UAAY,EAAG,CACrB,GAAI43B,GAAQ,IAAM,CACdC,EAAKD,CAAI,EACT,MACH,CAED,QAASkB,EAAa,EAAGA,EAAa,EAAGA,GAAc,EACnD,GAAM,EAAAlB,GAAS,EAAIkB,EAAe,GAAU,CACxC94B,EAAM,QAAU84B,EAChB,KACH,CAEL,GAAI94B,EAAM,UAAY,EAClBA,EAAM,UAAY43B,EAAO,WAEpB53B,EAAM,UAAY,EACvBA,EAAM,UAAY43B,EAAO,WAEpB53B,EAAM,UAAY,EACvBA,EAAM,UAAY43B,EAAO,MAGzB,OAAM,IAAI,MAAM,wBAAwB,EAE5C53B,EAAM,SAAW,CACpB,SACQA,EAAM,QAAU,EAAG,CACxB,GAAI43B,GAAQ,IACR,MAAM,IAAI,MAAM,wBAAwB,EAE5C53B,EAAM,UAAaA,EAAM,WAAa,EAAM43B,EAAO,GACnD53B,EAAM,SAAW,EACbA,EAAM,UAAY,GAClB63B,EAAK73B,EAAM,SAAS,CAE3B,CACL,CAIO,SAAS+4B,GAAsBZ,EAAK,CACvC,MAAMn0B,EAAS,GACThE,EAAQ,CAAE,MAAO,EAAG,WAAY,CAAC,EACjCg5B,EAAUpB,GAAS,CACrB5zB,EAAO,KAAK4zB,CAAI,CACxB,EACI,QAASn1B,EAAI,EAAGA,EAAI01B,EAAI,OAAQ11B,GAAK,EACjCs1B,GAAkBI,EAAI,WAAW11B,CAAC,EAAGzC,EAAOg5B,CAAM,EAEtD,OAAO,IAAI,WAAWh1B,CAAM,CAChC,CACO,SAASi1B,GAAmBd,EAAK,CACpC,MAAMn0B,EAAS,GACf,OAAA40B,GAAaT,EAAMP,GAAS5zB,EAAO,KAAK4zB,CAAI,CAAC,EACtC,IAAI,WAAW5zB,CAAM,CAChC,CACO,SAASk1B,GAAiBC,EAAO,CACpC,MAAMn1B,EAAS,GACThE,EAAQ,CAAE,MAAO,EAAG,WAAY,CAAC,EACjCo5B,EAAUlyB,GAAS,CACrBlD,EAAO,KAAKkD,CAAI,CACxB,EACI,OAAAiyB,EAAM,QAASvB,GAASD,GAAgBC,EAAM53B,EAAOo5B,CAAM,CAAC,EAE5DzB,GAAgB,KAAM33B,EAAOo5B,CAAM,EAC5Bp1B,EAAO,KAAK,EAAE,CACzB,CC5PO,SAASq1B,GAAUpI,EAAW,CAEjC,OADgB,KAAK,MAAM,KAAK,IAAG,EAAK,GAAI,EAC3BA,CACrB,CAcO,SAASqI,IAAqB,CACjC,OAAO,OAAO,eAAe,CACjC,CACO,MAAMhiB,GAAY,IAAM,OAAO,OAAW,KAAe,OAAO,SAAa,IAC9EiiB,GAAyB,CAC3B,OAAQ,GACR,SAAU,EACd,EAIaC,GAAuB,IAAM,CACtC,GAAI,CAACliB,GAAS,EACV,MAAO,GAEX,GAAI,CACA,GAAI,OAAO,WAAW,cAAiB,SACnC,MAAO,EAEd,MACS,CAEN,MAAO,EACV,CACD,GAAIiiB,GAAuB,OACvB,OAAOA,GAAuB,SAElC,MAAME,EAAY,QAAQ,KAAK,OAAQ,IAAG,KAAK,OAAQ,IACvD,GAAI,CACA,WAAW,aAAa,QAAQA,EAAWA,CAAS,EACpD,WAAW,aAAa,WAAWA,CAAS,EAC5CF,GAAuB,OAAS,GAChCA,GAAuB,SAAW,EACrC,MACS,CAGNA,GAAuB,OAAS,GAChCA,GAAuB,SAAW,EACrC,CACD,OAAOA,GAAuB,QAClC,EAIO,SAASG,GAAuB73B,EAAM,CACzC,MAAMmC,EAAS,GACT5C,EAAM,IAAI,IAAIS,CAAI,EACxB,GAAIT,EAAI,MAAQA,EAAI,KAAK,CAAC,IAAM,IAC5B,GAAI,CACyB,IAAI,gBAAgBA,EAAI,KAAK,UAAU,CAAC,CAAC,EACjD,QAAQ,CAAC7B,EAAOU,IAAQ,CACrC+D,EAAO/D,CAAG,EAAIV,CAC9B,CAAa,CACJ,MACS,CAET,CAGL,OAAA6B,EAAI,aAAa,QAAQ,CAAC7B,EAAOU,IAAQ,CACrC+D,EAAO/D,CAAG,EAAIV,CACtB,CAAK,EACMyE,CACX,CACO,MAAMqY,GAAgBC,GACrBA,EACO,IAAIC,IAASD,EAAY,GAAGC,CAAI,EAEpC,IAAIA,IAAS,MAAM,GAAGA,CAAI,EAExBod,GAA0BC,GAC3B,OAAOA,GAAkB,UAC7BA,IAAkB,MAClB,WAAYA,GACZ,OAAQA,GACR,SAAUA,GACV,OAAOA,EAAc,MAAS,WAGzBC,GAAe,MAAOC,EAAS75B,EAAK+d,IAAS,CACtD,MAAM8b,EAAQ,QAAQ75B,EAAK,KAAK,UAAU+d,CAAI,CAAC,CACnD,EACa+b,GAAe,MAAOD,EAAS75B,IAAQ,CAChD,MAAMV,EAAQ,MAAMu6B,EAAQ,QAAQ75B,CAAG,EACvC,GAAI,CAACV,EACD,OAAO,KAEX,GAAI,CACA,OAAO,KAAK,MAAMA,CAAK,CAC1B,MACU,CACP,OAAOA,CACV,CACL,EACay6B,GAAkB,MAAOF,EAAS75B,IAAQ,CACnD,MAAM65B,EAAQ,WAAW75B,CAAG,CAChC,EAMO,MAAMg6B,EAAS,CAClB,aAAc,CAGV,KAAK,QAAU,IAAIA,GAAS,mBAAmB,CAACtb,EAAKub,IAAQ,CAGzD,KAAK,QAAUvb,EACf,KAAK,OAASub,CAC1B,CAAS,CACJ,CACL,CACAD,GAAS,mBAAqB,QACvB,SAASE,GAAUnd,EAAO,CAC7B,MAAMod,EAAQpd,EAAM,MAAM,GAAG,EAC7B,GAAIod,EAAM,SAAW,EACjB,MAAM,IAAI9C,GAAoB,uBAAuB,EAGzD,QAAS70B,EAAI,EAAGA,EAAI23B,EAAM,OAAQ33B,IAC9B,GAAI,CAACyzB,GAAgB,KAAKkE,EAAM33B,CAAC,CAAC,EAC9B,MAAM,IAAI60B,GAAoB,6BAA6B,EAanE,MAVa,CAET,OAAQ,KAAK,MAAMY,GAAoBkC,EAAM,CAAC,CAAC,CAAC,EAChD,QAAS,KAAK,MAAMlC,GAAoBkC,EAAM,CAAC,CAAC,CAAC,EACjD,UAAWrB,GAAsBqB,EAAM,CAAC,CAAC,EACzC,IAAK,CACD,OAAQA,EAAM,CAAC,EACf,QAASA,EAAM,CAAC,CACnB,CACT,CAEA,CAIO,eAAeC,GAAMC,EAAM,CAC9B,OAAO,MAAM,IAAI,QAASC,GAAW,CACjC,WAAW,IAAMA,EAAO,IAAI,EAAGD,CAAI,CAC3C,CAAK,CACL,CAMO,SAASE,GAAU/4B,EAAIg5B,EAAa,CAsBvC,OArBgB,IAAI,QAAQ,CAACF,EAAQ/K,IAAW,EAG3C,SAAY,CACT,QAASkL,EAAU,EAAGA,EAAU,IAAUA,IACtC,GAAI,CACA,MAAM12B,EAAS,MAAMvC,EAAGi5B,CAAO,EAC/B,GAAI,CAACD,EAAYC,EAAS,KAAM12B,CAAM,EAAG,CACrCu2B,EAAOv2B,CAAM,EACb,MACH,CACJ,OACMumB,EAAG,CACN,GAAI,CAACkQ,EAAYC,EAASnQ,CAAC,EAAG,CAC1BiF,EAAOjF,CAAC,EACR,MACH,CACJ,CAEjB,IACA,CAAK,CAEL,CACA,SAASoQ,GAAQC,EAAK,CAClB,OAAQ,IAAMA,EAAI,SAAS,EAAE,GAAG,OAAO,EAAE,CAC7C,CAEO,SAASC,IAAuB,CAEnC,MAAMC,EAAQ,IAAI,YAAY,EAAc,EAC5C,GAAI,OAAO,OAAW,IAAa,CAC/B,MAAMC,EAAU,qEACVC,EAAaD,EAAQ,OAC3B,IAAIE,EAAW,GACf,QAAS,EAAI,EAAG,EAAI,GAAgB,IAChCA,GAAYF,EAAQ,OAAO,KAAK,MAAM,KAAK,OAAM,EAAKC,CAAU,CAAC,EAErE,OAAOC,CACV,CACD,cAAO,gBAAgBH,CAAK,EACrB,MAAM,KAAKA,EAAOH,EAAO,EAAE,KAAK,EAAE,CAC7C,CACA,eAAeO,GAAOC,EAAc,CAEhC,MAAMC,EADU,IAAI,cACQ,OAAOD,CAAY,EACzCn8B,EAAO,MAAM,OAAO,OAAO,OAAO,UAAWo8B,CAAW,EACxDjC,EAAQ,IAAI,WAAWn6B,CAAI,EACjC,OAAO,MAAM,KAAKm6B,CAAK,EAClB,IAAKrZ,GAAM,OAAO,aAAaA,CAAC,CAAC,EACjC,KAAK,EAAE,CAChB,CACO,eAAeub,GAAsBJ,EAAU,CAIlD,GAAI,EAHqB,OAAO,OAAW,KACvC,OAAO,OAAO,OAAW,KACzB,OAAO,YAAgB,KAGvB,OAAOA,EAEX,MAAMK,EAAS,MAAMJ,GAAOD,CAAQ,EACpC,OAAO,KAAKK,CAAM,EAAE,QAAQ,MAAO,GAAG,EAAE,QAAQ,MAAO,GAAG,EAAE,QAAQ,MAAO,EAAE,CACjF,CACO,eAAeC,GAA0BzB,EAAS0B,EAAYC,EAAqB,GAAO,CAC7F,MAAMC,EAAeb,KACrB,IAAIc,EAAqBD,EACrBD,IACAE,GAAsB,sBAE1B,MAAM9B,GAAaC,EAAS,GAAG0B,CAAU,iBAAkBG,CAAkB,EAC7E,MAAMC,EAAgB,MAAMP,GAAsBK,CAAY,EAE9D,MAAO,CAACE,EADoBF,IAAiBE,EAAgB,QAAU,MAC7B,CAC9C,CAEA,MAAMC,GAAoB,6DACnB,SAASC,GAAwBle,EAAU,CAC9C,MAAMme,EAAane,EAAS,QAAQ,IAAIoY,EAAuB,EAI/D,GAHI,CAAC+F,GAGD,CAACA,EAAW,MAAMF,EAAiB,EACnC,OAAO,KAEX,GAAI,CAEA,OADa,IAAI,KAAK,GAAGE,CAAU,cAAc,CAEpD,MACS,CACN,OAAO,IACV,CACL,CACO,SAASC,GAAYC,EAAK,CAC7B,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,mBAAmB,EAEvC,MAAMC,EAAU,KAAK,MAAM,KAAK,IAAG,EAAK,GAAI,EAC5C,GAAID,GAAOC,EACP,MAAM,IAAI,MAAM,iBAAiB,CAEzC,CACO,SAASC,GAAaC,EAAK,CAC9B,OAAQA,EAAG,CACP,IAAK,QACD,MAAO,CACH,KAAM,oBACN,KAAM,CAAE,KAAM,SAAW,CACzC,EACQ,IAAK,QACD,MAAO,CACH,KAAM,QACN,WAAY,QACZ,KAAM,CAAE,KAAM,SAAW,CACzC,EACQ,QACI,MAAM,IAAI,MAAM,mBAAmB,CAC1C,CACL,CACA,MAAMC,GAAa,iEACZ,SAASC,GAAanE,EAAK,CAC9B,GAAI,CAACkE,GAAW,KAAKlE,CAAG,EACpB,MAAM,IAAI,MAAM,6DAA6D,CAErF,CACO,SAASoE,IAAwB,CACpC,MAAMC,EAAc,GACpB,OAAO,IAAI,MAAMA,EAAa,CAC1B,IAAK,CAACnsB,EAAQosB,IAAS,CACnB,GAAIA,IAAS,4BACT,MAAO,GAIX,GAAI,OAAOA,GAAS,SAAU,CAC1B,MAAMC,EAAQD,EAAK,WACnB,GAAIC,IAAU,8BACVA,IAAU,8BACVA,IAAU,8BAEV,MAEP,CACD,MAAM,IAAI,MAAM,kIAAkID,CAAI,kFAAkF,CAC3O,EACD,IAAK,CAACE,EAASF,IAAS,CACpB,MAAM,IAAI,MAAM,gIAAgIA,CAAI,oHAAoH,CAC3Q,EACD,eAAgB,CAACE,EAASF,IAAS,CAC/B,MAAM,IAAI,MAAM,iIAAiIA,CAAI,oHAAoH,CAC5Q,CACT,CAAK,CACL,CASO,SAASG,GAAyBC,EAAMC,EAAoB,CAC/D,OAAO,IAAI,MAAMD,EAAM,CACnB,IAAK,CAACxsB,EAAQosB,EAAMM,IAAa,CAE7B,GAAIN,IAAS,+BACT,MAAO,GAIX,GAAI,OAAOA,GAAS,SAAU,CAC1B,MAAMC,EAAQD,EAAK,WACnB,GAAIC,IAAU,8BACVA,IAAU,8BACVA,IAAU,+BACVA,IAAU,qCAEV,OAAO,QAAQ,IAAIrsB,EAAQosB,EAAMM,CAAQ,CAEhD,CAED,MAAI,CAACD,EAAmB,OAAS,OAAOL,GAAS,WAE7CK,EAAmB,MAAQ,IAExB,QAAQ,IAAIzsB,EAAQosB,EAAMM,CAAQ,CAC5C,CACT,CAAK,CACL,CAKO,SAASC,GAAUvpB,EAAK,CAC3B,OAAO,KAAK,MAAM,KAAK,UAAUA,CAAG,CAAC,CACzC,CC1WA,MAAM4b,GAAoBC,GAAQA,EAAI,KAAOA,EAAI,SAAWA,EAAI,mBAAqBA,EAAI,OAAS,KAAK,UAAUA,CAAG,EAC9G2N,GAAsB,CAAC,IAAK,IAAK,GAAG,EACnC,eAAe1N,GAAYluB,EAAO,CACrC,IAAI+b,EACJ,GAAI,CAACuc,GAAuBt4B,CAAK,EAC7B,MAAM,IAAI61B,GAAwB7H,GAAiBhuB,CAAK,EAAG,CAAC,EAEhE,GAAI47B,GAAoB,SAAS57B,EAAM,MAAM,EAEzC,MAAM,IAAI61B,GAAwB7H,GAAiBhuB,CAAK,EAAGA,EAAM,MAAM,EAE3E,IAAI2c,EACJ,GAAI,CACAA,EAAO,MAAM3c,EAAM,MACtB,OACMkpB,EAAG,CACN,MAAM,IAAIiM,GAAiBnH,GAAiB9E,CAAC,EAAGA,CAAC,CACpD,CACD,IAAI2S,EACJ,MAAMC,EAAqBrB,GAAwBz6B,CAAK,EAWxD,GAVI87B,GACAA,EAAmB,QAAS,GAAIlH,GAAa,YAAY,EAAE,WAC3D,OAAOjY,GAAS,UAChBA,GACA,OAAOA,EAAK,MAAS,SACrBkf,EAAYlf,EAAK,KAEZ,OAAOA,GAAS,UAAYA,GAAQ,OAAOA,EAAK,YAAe,WACpEkf,EAAYlf,EAAK,YAEhBkf,EAYA,IAAIA,IAAc,gBACnB,MAAM,IAAI9F,GAAsB/H,GAAiBrR,CAAI,EAAG3c,EAAM,SAAU+b,EAAKY,EAAK,iBAAmB,MAAQZ,IAAO,OAAS,OAASA,EAAG,UAAY,EAAE,EAEtJ,GAAI8f,IAAc,oBAInB,MAAM,IAAIxG,WAjBN,OAAO1Y,GAAS,UAChBA,GACA,OAAOA,EAAK,eAAkB,UAC9BA,EAAK,eACL,MAAM,QAAQA,EAAK,cAAc,OAAO,GACxCA,EAAK,cAAc,QAAQ,QAC3BA,EAAK,cAAc,QAAQ,OAAO,CAAC9Z,EAAGzB,IAAMyB,GAAK,OAAOzB,GAAM,SAAU,EAAI,EAC5E,MAAM,IAAI20B,GAAsB/H,GAAiBrR,CAAI,EAAG3c,EAAM,OAAQ2c,EAAK,cAAc,OAAO,EAYxG,MAAM,IAAIsY,GAAajH,GAAiBrR,CAAI,EAAG3c,EAAM,QAAU,IAAK67B,CAAS,CACjF,CACA,MAAMxN,GAAoB,CAACxe,EAAQxS,EAASixB,EAAYve,IAAS,CAC7D,MAAMlL,EAAS,CAAE,OAAAgL,EAAQ,QAA4DxS,GAAQ,SAAY,CAAE,GAC3G,OAAIwS,IAAW,MACJhL,GAEXA,EAAO,QAAU,OAAO,OAAO,CAAE,eAAgB,kCAAsFxH,GAAQ,OAAO,EACtJwH,EAAO,KAAO,KAAK,UAAUkL,CAAI,EAC1B,OAAO,OAAO,OAAO,OAAO,GAAIlL,CAAM,EAAGypB,CAAU,EAC9D,EACO,eAAeyN,EAASvN,EAAS3e,EAAQ9P,EAAK1C,EAAS,CAC1D,IAAI0e,EACJ,MAAMN,EAAU,OAAO,OAAO,GAAsDpe,GAAQ,OAAO,EAC9Foe,EAAQkZ,EAAuB,IAChClZ,EAAQkZ,EAAuB,EAAIC,GAAa,YAAY,EAAE,MAEZv3B,GAAQ,MAC1Doe,EAAQ,cAAmB,UAAUpe,EAAQ,GAAG,IAEpD,MAAMud,GAAMmB,EAAuD1e,GAAQ,SAAW,MAAQ0e,IAAO,OAASA,EAAK,GAC7D1e,GAAQ,aAC1Dud,EAAG,YAAiBvd,EAAQ,YAEhC,MAAM4yB,EAAc,OAAO,KAAKrV,CAAE,EAAE,OAAS,IAAM,IAAI,gBAAgBA,CAAE,EAAE,SAAQ,EAAK,GAClF+B,EAAO,MAAM4R,GAAeC,EAAS3e,EAAQ9P,EAAMkwB,EAAa,CAClE,QAAAxU,EACA,cAAiEpe,GAAQ,aACjF,EAAO,CAAE,EAAoDA,GAAQ,IAAI,EACrE,OAA0DA,GAAQ,MAA2DA,GAAQ,MAAMsf,CAAI,EAAI,CAAE,KAAM,OAAO,OAAO,GAAIA,CAAI,EAAG,MAAO,IAAI,CACnM,CACA,eAAe4R,GAAeC,EAAS3e,EAAQ9P,EAAK1C,EAASixB,EAAYve,EAAM,CAC3E,MAAMisB,EAAgB3N,GAAkBxe,EAAQxS,EAASixB,EAAYve,CAAI,EACzE,IAAIpN,EACJ,GAAI,CACAA,EAAS,MAAM6rB,EAAQzuB,EAAK,OAAO,OAAO,CAAE,EAAEi8B,CAAa,CAAC,CAC/D,OACM9S,EAAG,CAGN,MAAM,IAAI2M,GAAwB7H,GAAiB9E,CAAC,EAAG,CAAC,CAC3D,CAID,GAHKvmB,EAAO,IACR,MAAMurB,GAAYvrB,CAAM,EAE0BtF,GAAQ,cAC1D,OAAOsF,EAEX,GAAI,CACA,OAAO,MAAMA,EAAO,MACvB,OACMumB,EAAG,CACN,MAAMgF,GAAYhF,CAAC,CACtB,CACL,CACO,SAAS+S,GAAiBtf,EAAM,CACnC,IAAIZ,EACJ,IAAImgB,EAAU,KACVC,GAAWxf,CAAI,IACfuf,EAAU,OAAO,OAAO,CAAE,EAAEvf,CAAI,EAC3BA,EAAK,aACNuf,EAAQ,WAAalE,GAAUrb,EAAK,UAAU,IAGtD,MAAM6e,GAAQzf,EAAKY,EAAK,QAAU,MAAQZ,IAAO,OAASA,EAAKY,EAC/D,MAAO,CAAE,KAAM,CAAE,QAAAuf,EAAS,KAAAV,CAAI,EAAI,MAAO,KAC7C,CACO,SAASY,GAAyBzf,EAAM,CAC3C,MAAMJ,EAAW0f,GAAiBtf,CAAI,EACtC,MAAI,CAACJ,EAAS,OACVI,EAAK,eACL,OAAOA,EAAK,eAAkB,UAC9B,MAAM,QAAQA,EAAK,cAAc,OAAO,GACxCA,EAAK,cAAc,QAAQ,QAC3BA,EAAK,cAAc,SACnB,OAAOA,EAAK,cAAc,SAAY,UACtCA,EAAK,cAAc,QAAQ,OAAO,CAAC9Z,EAAGzB,IAAMyB,GAAK,OAAOzB,GAAM,SAAU,EAAI,IAC5Emb,EAAS,KAAK,cAAgBI,EAAK,eAEhCJ,CACX,CACO,SAAS8f,GAAc1f,EAAM,CAChC,IAAIZ,EAEJ,MAAO,CAAE,KAAM,CAAE,MADHA,EAAKY,EAAK,QAAU,MAAQZ,IAAO,OAASA,EAAKY,CACxC,EAAE,MAAO,IAAI,CACxC,CACO,SAAS2f,GAAa3f,EAAM,CAC/B,MAAO,CAAE,KAAAA,EAAM,MAAO,KAC1B,CACO,SAAS4f,GAAsB5f,EAAM,CACxC,KAAM,CAAE,YAAA6f,EAAa,UAAAC,EAAW,aAAAC,EAAc,YAAAC,EAAa,kBAAAC,CAAmB,EAAGjgB,EAAMpa,EAAOs6B,GAAOlgB,EAAM,CAAC,cAAe,YAAa,eAAgB,cAAe,mBAAmB,CAAC,EACrLmgB,EAAa,CACf,YAAAN,EACA,UAAAC,EACA,aAAAC,EACA,YAAAC,EACA,kBAAAC,CACR,EACUpB,EAAO,OAAO,OAAO,CAAE,EAAEj5B,CAAI,EACnC,MAAO,CACH,KAAM,CACF,WAAAu6B,EACA,KAAAtB,CACH,EACD,MAAO,IACf,CACA,CACO,SAASuB,GAAuBpgB,EAAM,CACzC,OAAOA,CACX,CAMA,SAASwf,GAAWxf,EAAM,CACtB,OAAOA,EAAK,cAAgBA,EAAK,eAAiBA,EAAK,UAC3D,CC3JO,MAAMqgB,GAAkB,CAAC,SAAU,QAAS,QAAQ,ECZ5C,MAAMC,EAAe,CAchC,YAAY,CAAE,IAAAl9B,EAAM,GAAI,QAAA0b,EAAU,GAAI,MAAAgF,GAAU,CAC5C,KAAK,IAAM1gB,EACX,KAAK,QAAU0b,EACf,KAAK,MAAQT,GAAayF,CAAK,EAC/B,KAAK,IAAM,CACP,YAAa,KAAK,aAAa,KAAK,IAAI,EACxC,aAAc,KAAK,cAAc,KAAK,IAAI,CACtD,EACQ,KAAK,MAAQ,CACT,YAAa,KAAK,kBAAkB,KAAK,IAAI,EAC7C,aAAc,KAAK,mBAAmB,KAAK,IAAI,EAC/C,UAAW,KAAK,gBAAgB,KAAK,IAAI,EACzC,aAAc,KAAK,mBAAmB,KAAK,IAAI,EAC/C,aAAc,KAAK,mBAAmB,KAAK,IAAI,EAC/C,uBAAwB,KAAK,6BAA6B,KAAK,IAAI,CAC/E,CACK,CAMD,MAAM,QAAQyc,EAAKC,EAAQH,GAAgB,CAAC,EAAG,CAC3C,GAAIA,GAAgB,QAAQG,CAAK,EAAI,EACjC,MAAM,IAAI,MAAM,qDAAqDH,GAAgB,KAAK,IAAI,CAAC,EAAE,EAErG,GAAI,CACA,aAAMjB,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,iBAAiBoB,CAAK,GAAI,CACpE,QAAS,KAAK,QACd,IAAAD,EACA,cAAe,EAC/B,CAAa,EACM,CAAE,KAAM,KAAM,MAAO,IAAI,CACnC,OACMl9B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CAMD,MAAM,kBAAkBo9B,EAAO//B,EAAU,GAAI,CACzC,GAAI,CACA,OAAO,MAAM0+B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,UAAW,CAC5D,KAAM,CAAE,MAAAqB,EAAO,KAAM//B,EAAQ,IAAM,EACnC,QAAS,KAAK,QACd,WAAYA,EAAQ,WACpB,MAAOg/B,EACvB,CAAa,CACJ,OACMr8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,KAAM,IAAM,EAAE,MAAAA,CAAK,EAExC,MAAMA,CACT,CACJ,CAQD,MAAM,aAAa6E,EAAQ,CACvB,GAAI,CACA,KAAM,CAAE,QAAAxH,CAAS,EAAGwH,EAAQtC,EAAOs6B,GAAOh4B,EAAQ,CAAC,SAAS,CAAC,EACvDkL,EAAO,OAAO,OAAO,OAAO,OAAO,GAAIxN,CAAI,EAAGlF,CAAO,EAC3D,MAAI,aAAckF,IAEdwN,EAAK,UAAwDxN,GAAK,SAClE,OAAOwN,EAAK,UAET,MAAMgsB,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,uBAAwB,CACzE,KAAMhsB,EACN,QAAS,KAAK,QACd,MAAOwsB,GACP,WAA8Dl/B,GAAQ,UACtF,CAAa,CACJ,OACM2C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CACH,KAAM,CACF,WAAY,KACZ,KAAM,IACT,EACD,MAAAA,CACpB,EAEY,MAAMA,CACT,CACJ,CAMD,MAAM,WAAWq9B,EAAY,CACzB,GAAI,CACA,OAAO,MAAMtB,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,eAAgB,CACjE,KAAMsB,EACN,QAAS,KAAK,QACd,MAAOhB,EACvB,CAAa,CACJ,OACMr8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,KAAM,IAAM,EAAE,MAAAA,CAAK,EAExC,MAAMA,CACT,CACJ,CAOD,MAAM,UAAU6E,EAAQ,CACpB,IAAIkX,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EAAI2O,EAC5B,GAAI,CACA,MAAM4Q,EAAa,CAAE,SAAU,KAAM,SAAU,EAAG,MAAO,GACnD/gB,EAAW,MAAMwf,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,eAAgB,CAC1E,QAAS,KAAK,QACd,cAAe,GACf,MAAO,CACH,MAAO7e,GAAMnB,EAAqDlX,GAAO,QAAU,MAAQkX,IAAO,OAAS,OAASA,EAAG,cAAgB,MAAQmB,IAAO,OAASA,EAAK,GACpK,UAAWM,GAAMD,EAAqD1Y,GAAO,WAAa,MAAQ0Y,IAAO,OAAS,OAASA,EAAG,cAAgB,MAAQC,IAAO,OAASA,EAAK,EAC9K,EACD,MAAOuf,EACvB,CAAa,EACD,GAAIxgB,EAAS,MACT,MAAMA,EAAS,MACnB,MAAMghB,EAAQ,MAAMhhB,EAAS,OACvBihB,GAAS1f,EAAKvB,EAAS,QAAQ,IAAI,eAAe,KAAO,MAAQuB,IAAO,OAASA,EAAK,EACtF5M,GAASwb,GAAM3O,EAAKxB,EAAS,QAAQ,IAAI,MAAM,KAAO,MAAQwB,IAAO,OAAS,OAASA,EAAG,MAAM,GAAG,KAAO,MAAQ2O,IAAO,OAASA,EAAK,GAC7I,OAAIxb,EAAM,OAAS,IACfA,EAAM,QAASG,GAAS,CACpB,MAAME,EAAO,SAASF,EAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,UAAU,EAAG,CAAC,CAAC,EAChEosB,EAAM,KAAK,MAAMpsB,EAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC,EACvDisB,EAAW,GAAGG,CAAG,MAAM,EAAIlsB,CAC/C,CAAiB,EACD+rB,EAAW,MAAQ,SAASE,CAAK,GAE9B,CAAE,KAAM,OAAO,OAAO,OAAO,OAAO,GAAID,CAAK,EAAGD,CAAU,EAAG,MAAO,IAAI,CAClF,OACMt9B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,MAAO,EAAI,EAAE,MAAAA,CAAK,EAEvC,MAAMA,CACT,CACJ,CAQD,MAAM,YAAY09B,EAAK,CACnBzC,GAAayC,CAAG,EAChB,GAAI,CACA,OAAO,MAAM3B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,gBAAgB2B,CAAG,GAAI,CACvE,QAAS,KAAK,QACd,MAAOrB,EACvB,CAAa,CACJ,OACMr8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,KAAM,IAAM,EAAE,MAAAA,CAAK,EAExC,MAAMA,CACT,CACJ,CAQD,MAAM,eAAe09B,EAAKL,EAAY,CAClCpC,GAAayC,CAAG,EAChB,GAAI,CACA,OAAO,MAAM3B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,gBAAgB2B,CAAG,GAAI,CACvE,KAAML,EACN,QAAS,KAAK,QACd,MAAOhB,EACvB,CAAa,CACJ,OACMr8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,KAAM,IAAM,EAAE,MAAAA,CAAK,EAExC,MAAMA,CACT,CACJ,CAUD,MAAM,WAAWgN,EAAI2wB,EAAmB,GAAO,CAC3C1C,GAAajuB,CAAE,EACf,GAAI,CACA,OAAO,MAAM+uB,EAAS,KAAK,MAAO,SAAU,GAAG,KAAK,GAAG,gBAAgB/uB,CAAE,GAAI,CACzE,QAAS,KAAK,QACd,KAAM,CACF,mBAAoB2wB,CACvB,EACD,MAAOtB,EACvB,CAAa,CACJ,OACMr8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,KAAM,IAAM,EAAE,MAAAA,CAAK,EAExC,MAAMA,CACT,CACJ,CACD,MAAM,aAAa6E,EAAQ,CACvBo2B,GAAap2B,EAAO,MAAM,EAC1B,GAAI,CACA,KAAM,CAAE,KAAA8X,EAAM,MAAA3c,CAAK,EAAK,MAAM+7B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,gBAAgBl3B,EAAO,MAAM,WAAY,CAC1G,QAAS,KAAK,QACd,MAAQ+4B,IACG,CAAE,KAAM,CAAE,QAAAA,CAAS,EAAE,MAAO,IAAI,EAE3D,CAAa,EACD,MAAO,CAAE,KAAAjhB,EAAM,MAAA3c,EAClB,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CACD,MAAM,cAAc6E,EAAQ,CACxBo2B,GAAap2B,EAAO,MAAM,EAC1Bo2B,GAAap2B,EAAO,EAAE,EACtB,GAAI,CAIA,MAAO,CAAE,KAHI,MAAMk3B,EAAS,KAAK,MAAO,SAAU,GAAG,KAAK,GAAG,gBAAgBl3B,EAAO,MAAM,YAAYA,EAAO,EAAE,GAAI,CAC/G,QAAS,KAAK,OAC9B,CAAa,EACc,MAAO,KACzB,OACM7E,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CAOD,MAAM,kBAAkB6E,EAAQ,CAC5B,IAAIkX,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EAAI2O,EAC5B,GAAI,CACA,MAAM4Q,EAAa,CAAE,SAAU,KAAM,SAAU,EAAG,MAAO,GACnD/gB,EAAW,MAAMwf,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,uBAAwB,CAClF,QAAS,KAAK,QACd,cAAe,GACf,MAAO,CACH,MAAO7e,GAAMnB,EAAqDlX,GAAO,QAAU,MAAQkX,IAAO,OAAS,OAASA,EAAG,cAAgB,MAAQmB,IAAO,OAASA,EAAK,GACpK,UAAWM,GAAMD,EAAqD1Y,GAAO,WAAa,MAAQ0Y,IAAO,OAAS,OAASA,EAAG,cAAgB,MAAQC,IAAO,OAASA,EAAK,EAC9K,EACD,MAAOuf,EACvB,CAAa,EACD,GAAIxgB,EAAS,MACT,MAAMA,EAAS,MACnB,MAAMshB,EAAU,MAAMthB,EAAS,OACzBihB,GAAS1f,EAAKvB,EAAS,QAAQ,IAAI,eAAe,KAAO,MAAQuB,IAAO,OAASA,EAAK,EACtF5M,GAASwb,GAAM3O,EAAKxB,EAAS,QAAQ,IAAI,MAAM,KAAO,MAAQwB,IAAO,OAAS,OAASA,EAAG,MAAM,GAAG,KAAO,MAAQ2O,IAAO,OAASA,EAAK,GAC7I,OAAIxb,EAAM,OAAS,IACfA,EAAM,QAASG,GAAS,CACpB,MAAME,EAAO,SAASF,EAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,UAAU,EAAG,CAAC,CAAC,EAChEosB,EAAM,KAAK,MAAMpsB,EAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC,EACvDisB,EAAW,GAAGG,CAAG,MAAM,EAAIlsB,CAC/C,CAAiB,EACD+rB,EAAW,MAAQ,SAASE,CAAK,GAE9B,CAAE,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIK,CAAO,EAAGP,CAAU,EAAG,MAAO,IAAI,CACpF,OACMt9B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,CAAE,QAAS,EAAI,EAAE,MAAAA,CAAK,EAEzC,MAAMA,CACT,CACJ,CAOD,MAAM,mBAAmB6E,EAAQ,CAC7B,GAAI,CACA,OAAO,MAAMk3B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,uBAAwB,CACzE,KAAMl3B,EACN,QAAS,KAAK,QACd,MAAQ3H,IACG,CAAE,KAAMA,EAAQ,MAAO,IAAI,EAEtD,CAAa,CACJ,OACM8C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CAOD,MAAM,gBAAgB89B,EAAU,CAC5B,GAAI,CACA,OAAO,MAAM/B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,wBAAwB+B,CAAQ,GAAI,CACpF,QAAS,KAAK,QACd,MAAQ5gC,IACG,CAAE,KAAMA,EAAQ,MAAO,IAAI,EAEtD,CAAa,CACJ,OACM8C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CAOD,MAAM,mBAAmB89B,EAAUj5B,EAAQ,CACvC,GAAI,CACA,OAAO,MAAMk3B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,wBAAwB+B,CAAQ,GAAI,CACpF,KAAMj5B,EACN,QAAS,KAAK,QACd,MAAQ3H,IACG,CAAE,KAAMA,EAAQ,MAAO,IAAI,EAEtD,CAAa,CACJ,OACM8C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CAOD,MAAM,mBAAmB89B,EAAU,CAC/B,GAAI,CACA,aAAM/B,EAAS,KAAK,MAAO,SAAU,GAAG,KAAK,GAAG,wBAAwB+B,CAAQ,GAAI,CAChF,QAAS,KAAK,QACd,cAAe,EAC/B,CAAa,EACM,CAAE,KAAM,KAAM,MAAO,IAAI,CACnC,OACM99B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CAOD,MAAM,6BAA6B89B,EAAU,CACzC,GAAI,CACA,OAAO,MAAM/B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,wBAAwB+B,CAAQ,qBAAsB,CACvG,QAAS,KAAK,QACd,MAAQ5gC,IACG,CAAE,KAAMA,EAAQ,MAAO,IAAI,EAEtD,CAAa,CACJ,OACM8C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,MAAO,CAAE,KAAM,KAAM,MAAAA,GAEzB,MAAMA,CACT,CACJ,CACL,CChbO,SAAS+9B,GAA0BC,EAAQ,GAAI,CAClD,MAAO,CACH,QAAUp/B,GACCo/B,EAAMp/B,CAAG,GAAK,KAEzB,QAAS,CAACA,EAAKV,IAAU,CACrB8/B,EAAMp/B,CAAG,EAAIV,CAChB,EACD,WAAaU,GAAQ,CACjB,OAAOo/B,EAAMp/B,CAAG,CACnB,CACT,CACA,CCZO,MAAMq/B,GAAY,CAIrB,MAAO,CAAC,EAAE,YACN9F,GAAsB,GACtB,WAAW,cACX,WAAW,aAAa,QAAQ,gCAAgC,IAAM,OAC9E,EAiBO,MAAM+F,WAAgC,KAAM,CAC/C,YAAY//B,EAAS,CACjB,MAAMA,CAAO,EACb,KAAK,iBAAmB,EAC3B,CACL,CAWO,MAAMggC,WAAyCD,EAAwB,CAC9E,CA4CO,eAAeE,GAAcluB,EAAMmuB,EAAgBj+B,EAAI,CACtD69B,GAAU,MAGd,MAAMK,EAAkB,IAAI,WAAW,gBACvC,OAAID,EAAiB,GACjB,WAAW,IAAM,CACbC,EAAgB,MAAK,EACjBL,GAAU,KAGjB,EAAEI,CAAc,EAUd,MAAM,QAAQ,QAAS,EAAC,KAAK,IAAM,WAAW,UAAU,MAAM,QAAQnuB,EAAMmuB,IAAmB,EAChG,CACE,KAAM,YACN,YAAa,EAChB,EACC,CACE,KAAM,YACN,OAAQC,EAAgB,MAC3B,EAAE,MAAOC,GAAS,CACnB,GAAIA,EAAM,CACFN,GAAU,MAGd,GAAI,CACA,OAAO,MAAM79B,EAAE,CAClB,QACO,CACA69B,GAAU,KAGjB,CACJ,KACI,CACD,GAAII,IAAmB,EACnB,MAAIJ,GAAU,MAGR,IAAIE,GAAiC,sDAAsDjuB,CAAI,sBAAsB,EAG3H,GAAI+tB,GAAU,MACV,GAAI,CACA,MAAMt7B,EAAS,MAAM,WAAW,UAAU,MAAM,MAAK,CAExD,MACS,CAET,CAOL,OAAO,MAAMvC,EAAE,CAEtB,CACJ,EAAC,CACN,CC5JO,SAASo+B,IAAqB,CACjC,GAAI,OAAO,YAAe,SAE1B,GAAI,CACA,OAAO,eAAe,OAAO,UAAW,YAAa,CACjD,IAAK,UAAY,CACb,OAAO,IACV,EACD,aAAc,EAC1B,CAAS,EAED,UAAU,WAAa,UAEvB,OAAO,OAAO,UAAU,SAC3B,MACS,CACF,OAAO,KAAS,MAEhB,KAAK,WAAa,KAEzB,CACL,CCvBO,SAASC,GAAWC,EAAS,CAChC,GAAI,CAAC,sBAAsB,KAAKA,CAAO,EACnC,MAAM,IAAI,MAAM,+BAA+BA,CAAO,eAAe,EAEzE,OAAOA,EAAQ,aACnB,CACO,SAASC,GAAQC,EAAK,CACzB,OAAO,SAASA,EAAK,EAAE,CAC3B,CACO,SAASC,GAAM3gC,EAAO,CACzB,MAAM45B,EAAQ,IAAI,YAAa,EAAC,OAAO55B,CAAK,EAE5C,MAAQ,KADI,MAAM,KAAK45B,EAAQvB,GAASA,EAAK,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAAC,EAAE,KAAK,EAAE,CAEvF,CAIO,SAASuI,GAAkBxQ,EAAY,CAC1C,IAAIvS,EACJ,KAAM,CAAE,QAAAgjB,EAAS,OAAAC,EAAQ,eAAAC,EAAgB,SAAAC,EAAW,IAAI,KAAQ,MAAAC,EAAO,UAAAC,EAAW,UAAAC,EAAW,UAAAC,EAAW,OAAAC,EAAQ,IAAAC,EAAK,QAAAld,CAAU,EAAGgM,EAElI,CACI,GAAI,CAAC,OAAO,UAAUyQ,CAAO,EACzB,MAAM,IAAI,MAAM,iHAAiHA,CAAO,EAAE,EAC9I,GAAI,CAACC,EACD,MAAM,IAAI,MAAM,kFAAkF,EACtG,GAAIG,GAASA,EAAM,OAAS,EACxB,MAAM,IAAI,MAAM,+GAA+GA,CAAK,EAAE,EAC1I,GAAI,CAACK,EACD,MAAM,IAAI,MAAM,4EAA4E,EAChG,GAAIld,IAAY,IACZ,MAAM,IAAI,MAAM,iGAAiGA,CAAO,EAAE,EAC9H,GAAK,GAAAvG,EAAKuS,EAAW,aAAe,MAAQvS,IAAO,SAAkBA,EAAG,SAAS;AAAA,CAAI,EACjF,MAAM,IAAI,MAAM,gHAAgHuS,EAAW,SAAS,EAAE,CAC7J,CAED,MAAMoQ,EAAUD,GAAWnQ,EAAW,OAAO,EACvCmR,EAASF,EAAS,GAAGA,CAAM,MAAMP,CAAM,GAAKA,EAC5CU,EAAYpR,EAAW,UAAY,GAAGA,EAAW,SAAS;AAAA,EAAO,GACjEle,EAAS,GAAGqvB,CAAM;AAAA,EAAsDf,CAAO;AAAA;AAAA,EAAOgB,CAAS,GACrG,IAAIC,EAAS,QAAQH,CAAG;AAAA,WAAcld,CAAO;AAAA,YAAeyc,CAAO,GAAGI,EAAQ;AAAA,SAAYA,CAAK,GAAK,EAAE;AAAA,aAAgBD,EAAS,YAAa,IAO5I,GANID,IACAU,GAAU;AAAA,mBAAsBV,EAAe,YAAW,CAAE,IAC5DG,IACAO,GAAU;AAAA,cAAiBP,EAAU,YAAW,CAAE,IAClDC,IACAM,GAAU;AAAA,cAAiBN,CAAS,IACpCC,EAAW,CACX,IAAIM,EAAU;AAAA,YACd,UAAWC,KAAYP,EAAW,CAC9B,GAAI,CAACO,GAAY,OAAOA,GAAa,SACjC,MAAM,IAAI,MAAM,qHAAqHA,CAAQ,EAAE,EACnJD,GAAW;AAAA,IAAOC,CAAQ,EAC7B,CACDF,GAAUC,CACb,CACD,MAAO,GAAGxvB,CAAM;AAAA,EAAKuvB,CAAM,EAC/B,CCvCO,MAAMG,WAAsB,KAAM,CACrC,YAAY,CAAE,QAAA3hC,EAAS,KAAAutB,EAAM,MAAAzN,EAAO,KAAA/N,CAAI,EAAK,CACzC,IAAI6L,EAEJ,MAAM5d,EAAS,CAAE,MAAA8f,CAAK,CAAE,EACxB,KAAK,kBAAoB,GACzB,KAAK,MAAQlC,EAAK7L,IAA2C+N,aAAiB,MAAQA,EAAM,KAAO,WAAgB,MAAQlC,IAAO,OAASA,EAAK,gBAChJ,KAAK,KAAO2P,CACf,CACL,CAKO,MAAMqU,WAA6BD,EAAc,CACpD,YAAY3hC,EAASmvB,EAAe,CAChC,MAAM,CACF,KAAM,uCACN,MAAOA,EACP,QAAAnvB,CACZ,CAAS,EACD,KAAK,KAAO,uBACZ,KAAK,cAAgBmvB,CACxB,CACL,CAkBO,SAAS0S,GAA0B,CAAE,MAAAhgC,EAAO,QAAA3C,GAAY,CAC3D,IAAI0e,EAAImB,EAAIK,EACZ,KAAM,CAAE,UAAA0iB,CAAW,EAAG5iC,EACtB,GAAI,CAAC4iC,EACD,MAAM,MAAM,iDAAiD,EAEjE,GAAIjgC,EAAM,OAAS,cACf,GAAI3C,EAAQ,kBAAkB,YAE1B,OAAO,IAAIyiC,GAAc,CACrB,QAAS,iDACT,KAAM,yBACN,MAAO9/B,CACvB,CAAa,UAGAA,EAAM,OAAS,kBAAmB,CACvC,KAAM+b,EAAKkkB,EAAU,0BAA4B,MAAQlkB,IAAO,OAAS,OAASA,EAAG,sBAAwB,GAEzG,OAAO,IAAI+jB,GAAc,CACrB,QAAS,qFACT,KAAM,8DACN,MAAO9/B,CACvB,CAAa,EAEA,GAEL3C,EAAQ,YAAc,iBAChB6f,EAAK+iB,EAAU,0BAA4B,MAAQ/iB,IAAO,OAAS,OAASA,EAAG,oBAAsB,WAEvG,OAAO,IAAI4iB,GAAc,CACrB,QAAS,6FACT,KAAM,gDACN,MAAO9/B,CACvB,CAAa,EAEA,KAAMud,EAAK0iB,EAAU,0BAA4B,MAAQ1iB,IAAO,OAAS,OAASA,EAAG,oBAAsB,WAE5G,OAAO,IAAIuiB,GAAc,CACrB,QAAS,6EACT,KAAM,wDACN,MAAO9/B,CACvB,CAAa,CAER,KACI,IAAIA,EAAM,OAAS,oBAGpB,OAAO,IAAI8/B,GAAc,CACrB,QAAS,8CACT,KAAM,4CACN,MAAO9/B,CACnB,CAAS,EAEA,GAAIA,EAAM,OAAS,kBAKpB,OAAO,IAAI8/B,GAAc,CACrB,QAAS9/B,EAAM,QACf,KAAM,uCACN,MAAOA,CACnB,CAAS,EAEA,GAAIA,EAAM,OAAS,oBAEpB,OAD8BigC,EAAU,iBAAiB,OAAQC,GAAUA,EAAM,OAAS,YAAY,EAC5E,SAAW,EAE1B,IAAIJ,GAAc,CACrB,QAAS,wDACT,KAAM,mCACN,MAAO9/B,CACvB,CAAa,EAGE,IAAI8/B,GAAc,CACrB,QAAS,wFACT,KAAM,wDACN,MAAO9/B,CACnB,CAAS,EAEA,GAAIA,EAAM,OAAS,gBAAiB,CACrC,MAAMmgC,EAAkB,OAAO,SAAS,SACxC,GAAKC,GAAcD,CAAe,GAQ7B,GAAIF,EAAU,GAAG,KAAOE,EAEzB,OAAO,IAAIL,GAAc,CACrB,QAAS,cAAcG,EAAU,GAAG,EAAE,+BACtC,KAAM,sBACN,MAAOjgC,CACvB,CAAa,MAZD,QAAO,IAAI8/B,GAAc,CACrB,QAAS,GAAG,OAAO,SAAS,QAAQ,wBACpC,KAAM,uBACN,MAAO9/B,CACvB,CAAa,CAUR,SACQA,EAAM,OAAS,aACpB,GAAIigC,EAAU,KAAK,GAAG,WAAa,GAAKA,EAAU,KAAK,GAAG,WAAa,GAEnE,OAAO,IAAIH,GAAc,CACrB,QAAS,8CACT,KAAM,+BACN,MAAO9/B,CACvB,CAAa,UAGAA,EAAM,OAAS,eAGpB,OAAO,IAAI8/B,GAAc,CACrB,QAAS,sGACT,KAAM,oCACN,MAAO9/B,CACnB,CAAS,EAEL,OAAO,IAAI8/B,GAAc,CACrB,QAAS,4CACT,KAAM,uCACN,MAAO9/B,CACf,CAAK,CACL,CAUO,SAASqgC,GAA4B,CAAE,MAAArgC,EAAO,QAAA3C,GAAY,CAC7D,KAAM,CAAE,UAAA4iC,CAAW,EAAG5iC,EACtB,GAAI,CAAC4iC,EACD,MAAM,MAAM,iDAAiD,EAEjE,GAAIjgC,EAAM,OAAS,cACf,GAAI3C,EAAQ,kBAAkB,YAE1B,OAAO,IAAIyiC,GAAc,CACrB,QAAS,mDACT,KAAM,yBACN,MAAO9/B,CACvB,CAAa,MAGJ,IAAIA,EAAM,OAAS,kBAKpB,OAAO,IAAI8/B,GAAc,CACrB,QAAS9/B,EAAM,QACf,KAAM,uCACN,MAAOA,CACnB,CAAS,EAEA,GAAIA,EAAM,OAAS,gBAAiB,CACrC,MAAMmgC,EAAkB,OAAO,SAAS,SACxC,GAAKC,GAAcD,CAAe,GAQ7B,GAAIF,EAAU,OAASE,EAExB,OAAO,IAAIL,GAAc,CACrB,QAAS,cAAcG,EAAU,IAAI,+BACrC,KAAM,sBACN,MAAOjgC,CACvB,CAAa,MAZD,QAAO,IAAI8/B,GAAc,CACrB,QAAS,GAAG,OAAO,SAAS,QAAQ,wBACpC,KAAM,uBACN,MAAO9/B,CACvB,CAAa,CAUR,SACQA,EAAM,OAAS,eAGpB,OAAO,IAAI8/B,GAAc,CACrB,QAAS,+GACT,KAAM,oCACN,MAAO9/B,CACnB,CAAS,EAEL,OAAO,IAAI8/B,GAAc,CACrB,QAAS,4CACT,KAAM,uCACN,MAAO9/B,CACf,CAAK,CACL,CClPO,MAAMsgC,EAAqB,CAQ9B,sBAAuB,CAEnB,GAAI,KAAK,WAAY,CACjB,MAAMC,EAAa,IAAI,MAAM,mDAAmD,EAChFA,EAAW,KAAO,aAClB,KAAK,WAAW,MAAMA,CAAU,CACnC,CACD,MAAMC,EAAgB,IAAI,gBAC1B,YAAK,WAAaA,EACXA,EAAc,MACxB,CAOD,gBAAiB,CACb,GAAI,KAAK,WAAY,CACjB,MAAMD,EAAa,IAAI,MAAM,gDAAgD,EAC7EA,EAAW,KAAO,aAClB,KAAK,WAAW,MAAMA,CAAU,EAChC,KAAK,WAAa,MACrB,CACJ,CACL,CAOO,MAAME,GAAuB,IAAIH,GAUjC,SAASI,GAAqCrjC,EAAS,CAC1D,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,0CAA0C,EAG9D,GAAI,OAAO,oBAAwB,KAC/B,iCAAkC,qBAClC,OAAO,oBACF,8BAAiC,WAEtC,OAAO,oBAAoB,6BAE3BA,CAAO,EAIX,KAAM,CAAE,UAAWsjC,EAAc,KAAMC,EAAU,mBAAAC,CAAkB,EAAKxjC,EAASyjC,EAAcjE,GAAOx/B,EAEpG,CAAC,YAAa,OAAQ,oBAAoB,CAAC,EAEvC0jC,EAAYrJ,GAAsBiJ,CAAY,EAAE,OAEhDnF,EAAO,OAAO,OAAO,OAAO,OAAO,GAAIoF,CAAQ,EAAG,CAAE,GAAIlJ,GAAsBkJ,EAAS,EAAE,EAAE,MAAM,CAAE,EAEnGj+B,EAAS,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEm+B,CAAW,EAAG,CAAE,UAAAC,EAC3D,KAAAvF,CAAM,GAEV,GAAIqF,GAAsBA,EAAmB,OAAS,EAAG,CACrDl+B,EAAO,mBAAqB,IAAI,MAAMk+B,EAAmB,MAAM,EAC/D,QAASz/B,EAAI,EAAGA,EAAIy/B,EAAmB,OAAQz/B,IAAK,CAChD,MAAM4/B,EAAOH,EAAmBz/B,CAAC,EACjCuB,EAAO,mBAAmBvB,CAAC,EAAI,OAAO,OAAO,OAAO,OAAO,GAAI4/B,CAAI,EAAG,CAAE,GAAItJ,GAAsBsJ,EAAK,EAAE,EAAE,OAAQ,KAAMA,EAAK,MAAQ,aAElI,WAAYA,EAAK,UAAU,CAAE,CACpC,CACJ,CACD,OAAOr+B,CACX,CAUO,SAASs+B,GAAoC5jC,EAAS,CACzD,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,yCAAyC,EAG7D,GAAI,OAAO,oBAAwB,KAC/B,gCAAiC,qBACjC,OAAO,oBACF,6BAAgC,WAErC,OAAO,oBAAoB,4BAA4BA,CAAO,EAIlE,KAAM,CAAE,UAAWsjC,EAAc,iBAAAO,CAAkB,EAAG7jC,EAASyjC,EAAcjE,GAAOx/B,EAElF,CAAC,YAAa,kBAAkB,CAAC,EAE7B0jC,EAAYrJ,GAAsBiJ,CAAY,EAAE,OAEhDh+B,EAAS,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEm+B,CAAW,EAAG,CAAE,UAAAC,CAAS,CAAE,EAE1E,GAAIG,GAAoBA,EAAiB,OAAS,EAAG,CACjDv+B,EAAO,iBAAmB,IAAI,MAAMu+B,EAAiB,MAAM,EAC3D,QAAS9/B,EAAI,EAAGA,EAAI8/B,EAAiB,OAAQ9/B,IAAK,CAC9C,MAAM4/B,EAAOE,EAAiB9/B,CAAC,EAC/BuB,EAAO,iBAAiBvB,CAAC,EAAI,OAAO,OAAO,OAAO,OAAO,GAAI4/B,CAAI,EAAG,CAAE,GAAItJ,GAAsBsJ,EAAK,EAAE,EAAE,OAAQ,KAAMA,EAAK,MAAQ,aAEhI,WAAYA,EAAK,UAAU,CAAE,CACpC,CACJ,CACD,OAAOr+B,CACX,CAUO,SAASw+B,GAAoCC,EAAY,CAC5D,IAAIrlB,EAEJ,GAAI,WAAYqlB,GAAc,OAAOA,EAAW,QAAW,WAEvD,OAAOA,EAAW,SAEtB,MAAMC,EAA2BD,EACjC,MAAO,CACH,GAAIA,EAAW,GACf,MAAOA,EAAW,GAClB,SAAU,CACN,kBAAmBvJ,GAAiB,IAAI,WAAWuJ,EAAW,SAAS,iBAAiB,CAAC,EACzF,eAAgBvJ,GAAiB,IAAI,WAAWuJ,EAAW,SAAS,cAAc,CAAC,CACtF,EACD,KAAM,aACN,uBAAwBA,EAAW,0BAA2B,EAE9D,yBAA2BrlB,EAAKslB,EAAyB,2BAA6B,MAAQtlB,IAAO,OAASA,EAAK,MAC3H,CACA,CAUO,SAASulB,GAAmCF,EAAY,CAC3D,IAAIrlB,EAEJ,GAAI,WAAYqlB,GAAc,OAAOA,EAAW,QAAW,WAEvD,OAAOA,EAAW,SAKtB,MAAMC,EAA2BD,EAC3BG,EAAyBH,EAAW,4BACpCI,EAAoBJ,EAAW,SACrC,MAAO,CACH,GAAIA,EAAW,GACf,MAAOA,EAAW,GAClB,SAAU,CACN,kBAAmBvJ,GAAiB,IAAI,WAAW2J,EAAkB,iBAAiB,CAAC,EACvF,eAAgB3J,GAAiB,IAAI,WAAW2J,EAAkB,cAAc,CAAC,EACjF,UAAW3J,GAAiB,IAAI,WAAW2J,EAAkB,SAAS,CAAC,EACvE,WAAYA,EAAkB,WACxB3J,GAAiB,IAAI,WAAW2J,EAAkB,UAAU,CAAC,EAC7D,MACT,EACD,KAAM,aACN,uBAAAD,EAEA,yBAA2BxlB,EAAKslB,EAAyB,2BAA6B,MAAQtlB,IAAO,OAASA,EAAK,MAC3H,CACA,CAcO,SAASqkB,GAAcqB,EAAU,CACpC,OAEAA,IAAa,aAAe,0CAA0C,KAAKA,CAAQ,CACvF,CAQA,SAASC,IAA0B,CAC/B,IAAI3lB,EAAImB,EACR,MAAO,CAAC,EAAEjH,GAAW,GACjB,wBAAyB,QACzB,OAAO,qBACP,gBAAiB,WACjB,QAAS8F,EAA2D,WAAU,eAAiB,MAAQA,IAAO,OAAS,OAASA,EAAG,SAAY,YAC/I,QAASmB,EAA2D,WAAU,eAAiB,MAAQA,IAAO,OAAS,OAASA,EAAG,MAAS,WACpJ,CAUO,eAAeykB,GAAiBtkC,EAAS,CAC5C,GAAI,CACA,MAAMkf,EAAW,MAAM,UAAU,YAAY,OAE7Clf,CAAO,EACP,OAAKkf,EAMCA,aAAoB,oBAMnB,CAAE,KAAMA,EAAU,MAAO,IAAI,EALzB,CACH,KAAM,KACN,MAAO,IAAIwjB,GAAqB,8CAA+CxjB,CAAQ,CACvG,EATmB,CACH,KAAM,KACN,MAAO,IAAIwjB,GAAqB,4BAA6BxjB,CAAQ,CACrF,CASK,OACM0R,EAAK,CACR,MAAO,CACH,KAAM,KACN,MAAO+R,GAA0B,CAC7B,MAAO/R,EACP,QAAA5wB,CAChB,CAAa,CACb,CACK,CACL,CAUO,eAAeukC,GAAcvkC,EAAS,CACzC,GAAI,CACA,MAAMkf,EAAW,MAAM,UAAU,YAAY,IAE7Clf,CAAO,EACP,OAAKkf,EAMCA,aAAoB,oBAMnB,CAAE,KAAMA,EAAU,MAAO,IAAI,EALzB,CACH,KAAM,KACN,MAAO,IAAIwjB,GAAqB,8CAA+CxjB,CAAQ,CACvG,EATmB,CACH,KAAM,KACN,MAAO,IAAIwjB,GAAqB,4BAA6BxjB,CAAQ,CACrF,CASK,OACM0R,EAAK,CACR,MAAO,CACH,KAAM,KACN,MAAOoS,GAA4B,CAC/B,MAAOpS,EACP,QAAA5wB,CAChB,CAAa,CACb,CACK,CACL,CACO,MAAMwkC,GAA2B,CACpC,MAAO,CAAC,cAAc,EACtB,uBAAwB,CACpB,wBAAyB,iBACzB,mBAAoB,GAEpB,iBAAkB,YAClB,YAAa,aAChB,EACD,YAAa,QACjB,EACaC,GAA0B,CAEnC,iBAAkB,YAClB,MAAO,CAAC,cAAc,EACtB,YAAa,QACjB,EACA,SAASC,MAAaC,EAAS,CAC3B,MAAMC,EAAY3b,GAAQA,IAAQ,MAAQ,OAAOA,GAAQ,UAAY,CAAC,MAAM,QAAQA,CAAG,EACjF4b,EAAqB5b,GAAQA,aAAe,aAAe,YAAY,OAAOA,CAAG,EACjF3jB,EAAS,GACf,UAAWw/B,KAAUH,EACjB,GAAKG,EAEL,UAAWvjC,KAAOujC,EAAQ,CACtB,MAAMjkC,EAAQikC,EAAOvjC,CAAG,EACxB,GAAIV,IAAU,OAEd,GAAI,MAAM,QAAQA,CAAK,EAEnByE,EAAO/D,CAAG,EAAIV,UAETgkC,EAAkBhkC,CAAK,EAC5ByE,EAAO/D,CAAG,EAAIV,UAET+jC,EAAS/jC,CAAK,EAAG,CACtB,MAAMkkC,EAAWz/B,EAAO/D,CAAG,EACvBqjC,EAASG,CAAQ,EACjBz/B,EAAO/D,CAAG,EAAImjC,GAAUK,EAAUlkC,CAAK,EAGvCyE,EAAO/D,CAAG,EAAImjC,GAAU7jC,CAAK,CAEpC,MAEGyE,EAAO/D,CAAG,EAAIV,CAErB,CAEL,OAAOyE,CACX,CAWO,SAAS0/B,GAA+BC,EAAaC,EAAW,CACnE,OAAOR,GAAUF,GAA0BS,EAAaC,GAAa,CAAE,EAC3E,CAUO,SAASC,GAA8BF,EAAaC,EAAW,CAClE,OAAOR,GAAUD,GAAyBQ,EAAaC,GAAa,CAAE,EAC1E,CASO,MAAME,EAAY,CACrB,YAAYvlC,EAAQ,CAChB,KAAK,OAASA,EAEd,KAAK,OAAS,KAAK,QAAQ,KAAK,IAAI,EACpC,KAAK,UAAY,KAAK,WAAW,KAAK,IAAI,EAC1C,KAAK,OAAS,KAAK,QAAQ,KAAK,IAAI,EACpC,KAAK,aAAe,KAAK,cAAc,KAAK,IAAI,EAChD,KAAK,SAAW,KAAK,UAAU,KAAK,IAAI,CAC3C,CAUD,MAAM,QAAQ2H,EAAQ,CAClB,OAAO,KAAK,OAAO,IAAI,OAAO,OAAO,OAAO,OAAO,OAAO,GAAIA,CAAM,EAAG,CAAE,WAAY,UAAY,EAAC,CACrG,CAeD,MAAM,WAAW,CAAE,SAAA69B,EAAU,SAAAC,EAAU,aAAAC,EAAc,OAAAzmB,CAAS,EAAEomB,EAAW,CACvE,GAAI,CAEA,KAAM,CAAE,KAAMM,EAAmB,MAAOC,GAAmB,MAAM,KAAK,OAAO,IAAI,UAAU,CACvF,SAAAJ,EACA,SAAAC,CAChB,CAAa,EACD,GAAI,CAACE,EACD,MAAO,CAAE,KAAM,KAAM,MAAOC,CAAc,EAE9C,MAAMC,EAAc5mB,GAAgDskB,GAAqB,uBAEzF,GAAIoC,EAAkB,SAAS,OAAS,SAAU,CAC9C,KAAM,CAAE,KAAArH,CAAI,EAAKqH,EAAkB,SAAS,mBAAmB,UAC1DrH,EAAK,OACNA,EAAK,KAAO,GAAGA,EAAK,EAAE,IAAIoH,CAAY,IAErCpH,EAAK,cACNA,EAAK,YAAcA,EAAK,KAE/B,CACD,OAAQqH,EAAkB,SAAS,KAAI,CACnC,IAAK,SAAU,CACX,MAAMxlC,EAAUglC,GAA+BQ,EAAkB,SAAS,mBAAmB,UAAiEN,GAAU,MAAM,EACxK,CAAE,KAAA5lB,EAAM,MAAA3c,CAAO,EAAG,MAAM2hC,GAAiB,CAC3C,UAAWtkC,EACX,OAAQ0lC,CAChC,CAAqB,EACD,OAAIpmB,EACO,CACH,KAAM,CACF,SAAA+lB,EACA,YAAaG,EAAkB,GAC/B,SAAU,CACN,KAAMA,EAAkB,SAAS,KACjC,oBAAqBlmB,CACxB,CACJ,EACD,MAAO,IACnC,EAE2B,CAAE,KAAM,KAAM,MAAA3c,EACxB,CACD,IAAK,UAAW,CACZ,MAAM3C,EAAUmlC,GAA8BK,EAAkB,SAAS,mBAAmB,UAAiEN,GAAU,OAAO,EACxK,CAAE,KAAA5lB,EAAM,MAAA3c,GAAU,MAAM4hC,GAAc,OAAO,OAAO,OAAO,OAAO,GAAIiB,EAAkB,SAAS,kBAAkB,EAAG,CAAE,UAAWxlC,EAAS,OAAQ0lC,CAAa,EAAC,EACxK,OAAIpmB,EACO,CACH,KAAM,CACF,SAAA+lB,EACA,YAAaG,EAAkB,GAC/B,SAAU,CACN,KAAMA,EAAkB,SAAS,KACjC,oBAAqBlmB,CACxB,CACJ,EACD,MAAO,IACnC,EAE2B,CAAE,KAAM,KAAM,MAAA3c,EACxB,CACJ,CACJ,OACMA,EAAO,CACV,OAAIg1B,EAAYh1B,CAAK,EACV,CAAE,KAAM,KAAM,MAAAA,GAElB,CACH,KAAM,KACN,MAAO,IAAIm1B,GAAiB,gCAAiCn1B,CAAK,CAClF,CACS,CACJ,CAaD,MAAM,QAAQ,CAAE,YAAAgjC,EAAa,SAAAN,EAAU,SAAAC,CAAQ,EAAK,CAChD,OAAO,KAAK,OAAO,IAAI,OAAO,CAC1B,SAAAD,EACA,YAAAM,EACA,SAAUL,CACtB,CAAS,CACJ,CAiBD,MAAM,cAAc,CAAE,SAAAD,EAAU,SAAU,CAAE,KAAAO,EAAO,OAAO,OAAW,IAAc,OAAO,SAAS,SAAW,OAAW,UAAAC,EAAY,OAAO,OAAW,IAAc,CAAC,OAAO,SAAS,MAAM,EAAI,OAAW,OAAA/mB,CAAM,EAAM,CAAE,GAAKomB,EAAW,CACrO,GAAI,CAACU,EACD,MAAO,CACH,KAAM,KACN,MAAO,IAAIlO,GAAU,8CAA8C,CACnF,EAEQ,GAAI,CACA,GAAI,CAAC2M,GAAuB,EACxB,MAAO,CACH,KAAM,KACN,MAAO,IAAIvM,GAAiB,oCAAqC,IAAI,CACzF,EAGY,KAAM,CAAE,KAAM0N,EAAmB,MAAOC,GAAmB,MAAM,KAAK,UAAU,CAC5E,SAAAJ,EACA,SAAU,CAAE,KAAAO,EAAM,UAAAC,CAAW,EAC7B,OAAA/mB,CAChB,EAAe,CAAE,QAASomB,CAAS,CAAE,EACzB,GAAI,CAACM,EACD,MAAO,CAAE,KAAM,KAAM,MAAOC,CAAc,EAE9C,KAAM,CAAE,SAAAH,CAAU,EAAGE,EAErB,OAAO,KAAK,QAAQ,CAChB,SAAAH,EACA,YAAaG,EAAkB,YAC/B,SAAU,CACN,KAAMF,EAAS,KACf,KAAAM,EACA,UAAAC,EACA,oBAAqBP,EAAS,mBACjC,CACjB,CAAa,CACJ,OACM3iC,EAAO,CACV,OAAIg1B,EAAYh1B,CAAK,EACV,CAAE,KAAM,KAAM,MAAAA,GAElB,CACH,KAAM,KACN,MAAO,IAAIm1B,GAAiB,mCAAoCn1B,CAAK,CACrF,CACS,CACJ,CAgBD,MAAM,UAAU,CAAE,aAAA4iC,EAAc,SAAU,CAAE,KAAAK,EAAO,OAAO,OAAW,IAAc,OAAO,SAAS,SAAW,OAAW,UAAAC,EAAY,OAAO,OAAW,IAAc,CAAC,OAAO,SAAS,MAAM,EAAI,OAAW,OAAA/mB,CAAM,EAAM,CAAE,GAAKomB,EAAW,CACrO,GAAI,CAACU,EACD,MAAO,CACH,KAAM,KACN,MAAO,IAAIlO,GAAU,4CAA4C,CACjF,EAEQ,GAAI,CACA,GAAI,CAAC2M,GAAuB,EACxB,MAAO,CACH,KAAM,KACN,MAAO,IAAIvM,GAAiB,oCAAqC,IAAI,CACzF,EAGY,KAAM,CAAE,KAAMgO,EAAQ,MAAOC,GAAgB,MAAM,KAAK,QAAQ,CAC5D,aAAAR,CAChB,CAAa,EACD,GAAI,CAACO,EACD,aAAM,KAAK,OAAO,IACb,YAAa,EACb,KAAMvF,GAAY,CACnB,IAAI7hB,EACJ,OAAQA,EAAK6hB,EAAQ,QAAU,MAAQ7hB,IAAO,OAAS,OAASA,EAAG,IAAI,KAAM/W,GAAMA,EAAE,cAAgB,YACjGA,EAAE,gBAAkB49B,GACpB59B,EAAE,SAAW,YAAY,CACjD,CAAiB,EACI,KAAMm+B,GAAYA,EAAS,KAAK,OAAO,IAAI,SAAS,CAAE,SAA0DA,GAAO,GAAI,EAAI,MAAO,EACpI,CAAE,KAAM,KAAM,MAAOC,CAAW,EAG3C,KAAM,CAAE,KAAMP,EAAmB,MAAOC,GAAmB,MAAM,KAAK,WAAW,CAC7E,SAAUK,EAAO,GACjB,aAAcA,EAAO,cACrB,SAAU,CAAE,KAAAF,EAAM,UAAAC,CAAW,EAC7B,OAAA/mB,CAChB,EAAe,CACC,OAAQomB,CACxB,CAAa,EACD,OAAKM,EAGE,KAAK,QAAQ,CAChB,SAAUM,EAAO,GACjB,YAAaN,EAAkB,YAC/B,SAAU,CACN,KAAAI,EACA,UAAAC,EACA,KAAML,EAAkB,SAAS,KACjC,oBAAqBA,EAAkB,SAAS,mBACnD,CACjB,CAAa,EAXU,CAAE,KAAM,KAAM,MAAOC,CAAc,CAYjD,OACM9iC,EAAO,CACV,OAAIg1B,EAAYh1B,CAAK,EACV,CAAE,KAAM,KAAM,MAAAA,GAElB,CACH,KAAM,KACN,MAAO,IAAIm1B,GAAiB,+BAAgCn1B,CAAK,CACjF,CACS,CACJ,CACL,CCtpBAw+B,KACA,MAAM6E,GAAkB,CACpB,IAAK5O,GACL,WAAYC,GACZ,iBAAkB,GAClB,eAAgB,GAChB,mBAAoB,GACpB,QAAStE,GACT,SAAU,WACV,MAAO,GACP,6BAA8B,GAC9B,aAAc,EAClB,EACA,eAAekT,GAASpzB,EAAMmuB,EAAgBj+B,EAAI,CAC9C,OAAO,MAAMA,EAAE,CACnB,CASA,MAAMmjC,GAAc,GACpB,MAAMC,EAAa,CAIf,IAAI,MAAO,CACP,IAAIznB,EAAImB,EACR,OAAQA,GAAMnB,EAAKwnB,GAAY,KAAK,UAAU,KAAO,MAAQxnB,IAAO,OAAS,OAASA,EAAG,QAAU,MAAQmB,IAAO,OAASA,EAAK,CAAE,KAAM,GAC3I,CACD,IAAI,KAAKhf,EAAO,CACZqlC,GAAY,KAAK,UAAU,EAAI,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,GAAY,KAAK,UAAU,CAAC,EAAG,CAAE,KAAMrlC,CAAK,CAAE,CAChH,CACD,IAAI,gBAAiB,CACjB,IAAI6d,EAAImB,EACR,OAAQA,GAAMnB,EAAKwnB,GAAY,KAAK,UAAU,KAAO,MAAQxnB,IAAO,OAAS,OAASA,EAAG,YAAc,MAAQmB,IAAO,OAASA,EAAK,OAAO,gBAC9I,CACD,IAAI,eAAehf,EAAO,CACtBqlC,GAAY,KAAK,UAAU,EAAI,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,GAAY,KAAK,UAAU,CAAC,EAAG,CAAE,SAAUrlC,CAAK,CAAE,CACpH,CAeD,YAAYb,EAAS,CACjB,IAAI0e,EAAImB,EAAIK,EAIZ,KAAK,YAAc,KACnB,KAAK,cAAgB,KACrB,KAAK,oBAAsB,IAAI,IAC/B,KAAK,kBAAoB,KACzB,KAAK,0BAA4B,KACjC,KAAK,mBAAqB,KAO1B,KAAK,kBAAoB,KACzB,KAAK,mBAAqB,GAC1B,KAAK,6BAA+B,GACpC,KAAK,0BAA4B,GACjC,KAAK,aAAe,GACpB,KAAK,cAAgB,GAIrB,KAAK,iBAAmB,KACxB,KAAK,OAAS,QAAQ,IACtB,MAAM6B,EAAW,OAAO,OAAO,OAAO,OAAO,GAAIikB,EAAe,EAAGhmC,CAAO,EAQ1E,GAPA,KAAK,WAAa+hB,EAAS,WAC3B,KAAK,YAAcrD,EAAKynB,GAAa,eAAe,KAAK,UAAU,KAAO,MAAQznB,IAAO,OAASA,EAAK,EACvGynB,GAAa,eAAe,KAAK,UAAU,EAAI,KAAK,WAAa,EACjE,KAAK,iBAAmB,CAAC,CAACpkB,EAAS,MAC/B,OAAOA,EAAS,OAAU,aAC1B,KAAK,OAASA,EAAS,OAEvB,KAAK,WAAa,GAAKnJ,GAAS,EAAI,CACpC,MAAM9X,EAAU,GAAG,KAAK,WAAY,iNAEhC,KAAK,gBAGZ,CAmED,GAlEA,KAAK,eAAiBihB,EAAS,eAC/B,KAAK,iBAAmBA,EAAS,iBACjC,KAAK,MAAQ,IAAI6d,GAAe,CAC5B,IAAK7d,EAAS,IACd,QAASA,EAAS,QAClB,MAAOA,EAAS,KAC5B,CAAS,EACD,KAAK,IAAMA,EAAS,IACpB,KAAK,QAAUA,EAAS,QACxB,KAAK,MAAQpE,GAAaoE,EAAS,KAAK,EACxC,KAAK,KAAOA,EAAS,MAAQkkB,GAC7B,KAAK,mBAAqBlkB,EAAS,mBACnC,KAAK,SAAWA,EAAS,SACzB,KAAK,6BAA+BA,EAAS,6BAC7C,KAAK,aAAeA,EAAS,aACzBA,EAAS,KACT,KAAK,KAAOA,EAAS,KAEhBnJ,GAAS,IAAQ,GAAAiH,EAA6D,YAAW,aAAe,MAAQA,IAAO,SAAkBA,EAAG,OACjJ,KAAK,KAAOkhB,GAGZ,KAAK,KAAOkF,GAEX,KAAK,OACN,KAAK,KAAO,CAAE,KAAM,CAAE,GACtB,KAAK,eAAiB,OAAO,kBAEjC,KAAK,IAAM,CACP,OAAQ,KAAK,QAAQ,KAAK,IAAI,EAC9B,OAAQ,KAAK,QAAQ,KAAK,IAAI,EAC9B,SAAU,KAAK,UAAU,KAAK,IAAI,EAClC,UAAW,KAAK,WAAW,KAAK,IAAI,EACpC,YAAa,KAAK,aAAa,KAAK,IAAI,EACxC,mBAAoB,KAAK,oBAAoB,KAAK,IAAI,EACtD,+BAAgC,KAAK,gCAAgC,KAAK,IAAI,EAC9E,SAAU,IAAIb,GAAY,IAAI,CAC1C,EACQ,KAAK,MAAQ,CACT,wBAAyB,KAAK,yBAAyB,KAAK,IAAI,EAChE,qBAAsB,KAAK,sBAAsB,KAAK,IAAI,EAC1D,kBAAmB,KAAK,mBAAmB,KAAK,IAAI,EACpD,WAAY,KAAK,iBAAiB,KAAK,IAAI,EAC3C,YAAa,KAAK,kBAAkB,KAAK,IAAI,CACzD,EACY,KAAK,gBACDrjB,EAAS,QACT,KAAK,QAAUA,EAAS,QAGpB+Y,GAAoB,EACpB,KAAK,QAAU,WAAW,cAG1B,KAAK,cAAgB,GACrB,KAAK,QAAU4F,GAA0B,KAAK,aAAa,GAG/D3e,EAAS,cACT,KAAK,YAAcA,EAAS,eAIhC,KAAK,cAAgB,GACrB,KAAK,QAAU2e,GAA0B,KAAK,aAAa,GAE3D9nB,GAAW,GAAI,WAAW,kBAAoB,KAAK,gBAAkB,KAAK,WAAY,CACtF,GAAI,CACA,KAAK,iBAAmB,IAAI,WAAW,iBAAiB,KAAK,UAAU,CAC1E,MACS,CAET,EACAsH,EAAK,KAAK,oBAAsB,MAAQA,IAAO,QAAkBA,EAAG,iBAAiB,UAAW,MAAOzO,GAAU,CAC9G,KAAK,OAAO,2DAA4DA,CAAK,EAC7E,MAAM,KAAK,sBAAsBA,EAAM,KAAK,MAAOA,EAAM,KAAK,QAAS,EAAK,CAC5F,CAAa,CACJ,CACD,KAAK,WAAU,CAClB,CAID,uBAAwB,CACpB,OAAO,KAAK,YACf,CAMD,cAAcnM,EAAQ,CAClB,GAAI,KAAK,cAAgBA,GAAUA,EAAO,MACtC,MAAMA,EAAO,MAEjB,OAAOA,CACV,CACD,YAAa,CACT,MAAQ,gBACD,KAAK,UAAU,IAAI,KAAK,UAAU,KAAK2f,EAAO,KAAK,IAAI,KAAM,EAAC,YAAW,CAAE,EACrF,CACD,UAAUpH,EAAM,CACZ,OAAI,KAAK,kBACL,KAAK,OAAO,KAAK,WAAU,EAAI,GAAGA,CAAI,EAEnC,IACV,CAMD,MAAM,YAAa,CACf,OAAI,KAAK,kBACE,MAAM,KAAK,mBAEtB,KAAK,mBAAqB,SACf,MAAM,KAAK,aAAa,GAAI,SACxB,MAAM,KAAK,aACrB,KAEE,MAAM,KAAK,kBACrB,CAOD,MAAM,aAAc,CAChB,IAAIa,EACJ,GAAI,CACA,IAAIlX,EAAS,GACT4+B,EAAkB,OAgBtB,GAfIxtB,GAAS,IACTpR,EAASwzB,GAAuB,OAAO,SAAS,IAAI,EAChD,KAAK,yBAAyBxzB,CAAM,EACpC4+B,EAAkB,WAEb,MAAM,KAAK,gBAAgB5+B,CAAM,IACtC4+B,EAAkB,SAStBxtB,GAAS,GAAM,KAAK,oBAAsBwtB,IAAoB,OAAQ,CACtE,KAAM,CAAE,KAAA9mB,EAAM,MAAA3c,GAAU,MAAM,KAAK,mBAAmB6E,EAAQ4+B,CAAe,EAC7E,GAAIzjC,EAAO,CAEP,GADA,KAAK,OAAO,iBAAkB,mCAAoCA,CAAK,EACnE21B,GAAiC31B,CAAK,EAAG,CACzC,MAAM67B,GAAa9f,EAAK/b,EAAM,WAAa,MAAQ+b,IAAO,OAAS,OAASA,EAAG,KAC/E,GAAI8f,IAAc,2BACdA,IAAc,sBACdA,IAAc,gCACd,MAAO,CAAE,MAAA77B,CAAK,CAErB,CAGD,aAAM,KAAK,iBACJ,CAAE,MAAAA,CAAK,CACjB,CACD,KAAM,CAAE,QAAAk8B,EAAS,aAAAwH,CAAc,EAAG/mB,EAClC,YAAK,OAAO,iBAAkB,0BAA2Buf,EAAS,gBAAiBwH,CAAY,EAC/F,MAAM,KAAK,aAAaxH,CAAO,EAC/B,WAAW,SAAY,CACfwH,IAAiB,WACjB,MAAM,KAAK,sBAAsB,oBAAqBxH,CAAO,EAG7D,MAAM,KAAK,sBAAsB,YAAaA,CAAO,CAE5D,EAAE,CAAC,EACG,CAAE,MAAO,KACnB,CAED,aAAM,KAAK,qBACJ,CAAE,MAAO,KACnB,OACMl8B,EAAO,CACV,OAAIg1B,EAAYh1B,CAAK,EACV,KAAK,cAAc,CAAE,MAAAA,CAAO,GAEhC,KAAK,cAAc,CACtB,MAAO,IAAIm1B,GAAiB,yCAA0Cn1B,CAAK,CAC3F,CAAa,CACJ,QACO,CACJ,MAAM,KAAK,0BACX,KAAK,OAAO,iBAAkB,KAAK,CACtC,CACJ,CAMD,MAAM,kBAAkB2jC,EAAa,CACjC,IAAI5nB,EAAImB,EAAIK,EACZ,GAAI,CACA,MAAMD,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,UAAW,CACjE,QAAS,KAAK,QACd,KAAM,CACF,MAAO7e,GAAMnB,EAA+D4nB,GAAY,WAAa,MAAQ5nB,IAAO,OAAS,OAASA,EAAG,QAAU,MAAQmB,IAAO,OAASA,EAAK,CAAE,EAClL,qBAAsB,CAAE,eAAgBK,EAA+DomB,GAAY,WAAa,MAAQpmB,IAAO,OAAS,OAASA,EAAG,YAAc,CACrL,EACD,MAAO0e,EACvB,CAAa,EACK,CAAE,KAAAtf,EAAM,MAAA3c,CAAO,EAAGsd,EACxB,GAAItd,GAAS,CAAC2c,EACV,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAO3c,CAAO,GAEnF,MAAMk8B,EAAUvf,EAAK,QACf6e,EAAO7e,EAAK,KAClB,OAAIA,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAauf,CAAO,GAElD,KAAK,cAAc,CAAE,KAAM,CAAE,KAAAV,EAAM,QAAAU,GAAW,MAAO,IAAI,CAAE,CACrE,OACMl8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAWD,MAAM,OAAO2jC,EAAa,CACtB,IAAI5nB,EAAImB,EAAIK,EACZ,GAAI,CACA,IAAID,EACJ,GAAI,UAAWqmB,EAAa,CACxB,KAAM,CAAE,MAAAvG,EAAO,SAAAwG,EAAU,QAAAvmC,CAAO,EAAKsmC,EACrC,IAAIpJ,EAAgB,KAChBsJ,EAAsB,KACtB,KAAK,WAAa,SAElB,CAACtJ,EAAesJ,CAAmB,EAAI,MAAM3J,GAA0B,KAAK,QAAS,KAAK,UAAU,GAExG5c,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,UAAW,CAC3D,QAAS,KAAK,QACd,WAA8D1+B,GAAQ,gBACtE,KAAM,CACF,MAAA+/B,EACA,SAAAwG,EACA,MAAO7nB,EAAuD1e,GAAQ,QAAU,MAAQ0e,IAAO,OAASA,EAAK,CAAE,EAC/G,qBAAsB,CAAE,cAAiE1e,GAAQ,YAAc,EAC/G,eAAgBk9B,EAChB,sBAAuBsJ,CAC1B,EACD,MAAO5H,EAC3B,CAAiB,CACJ,SACQ,UAAW0H,EAAa,CAC7B,KAAM,CAAE,MAAAG,EAAO,SAAAF,EAAU,QAAAvmC,CAAO,EAAKsmC,EACrCrmB,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,UAAW,CAC3D,QAAS,KAAK,QACd,KAAM,CACF,MAAA+H,EACA,SAAAF,EACA,MAAO1mB,EAAuD7f,GAAQ,QAAU,MAAQ6f,IAAO,OAASA,EAAK,CAAE,EAC/G,SAAUK,EAAuDlgB,GAAQ,WAAa,MAAQkgB,IAAO,OAASA,EAAK,MACnH,qBAAsB,CAAE,cAAiElgB,GAAQ,YAAc,CAClH,EACD,MAAO4+B,EAC3B,CAAiB,CACJ,KAEG,OAAM,IAAIzG,GAA4B,iEAAiE,EAE3G,KAAM,CAAE,KAAA7Y,EAAM,MAAA3c,CAAO,EAAGsd,EACxB,GAAItd,GAAS,CAAC2c,EACV,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAO3c,CAAO,GAEnF,MAAMk8B,EAAUvf,EAAK,QACf6e,EAAO7e,EAAK,KAClB,OAAIA,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAauf,CAAO,GAElD,KAAK,cAAc,CAAE,KAAM,CAAE,KAAAV,EAAM,QAAAU,GAAW,MAAO,IAAI,CAAE,CACrE,OACMl8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CASD,MAAM,mBAAmB2jC,EAAa,CAClC,GAAI,CACA,IAAIrmB,EACJ,GAAI,UAAWqmB,EAAa,CACxB,KAAM,CAAE,MAAAvG,EAAO,SAAAwG,EAAU,QAAAvmC,CAAO,EAAKsmC,EACrCrmB,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,6BAA8B,CAC9E,QAAS,KAAK,QACd,KAAM,CACF,MAAAqB,EACA,SAAAwG,EACA,qBAAsB,CAAE,cAAiEvmC,GAAQ,YAAc,CAClH,EACD,MAAO++B,EAC3B,CAAiB,CACJ,SACQ,UAAWuH,EAAa,CAC7B,KAAM,CAAE,MAAAG,EAAO,SAAAF,EAAU,QAAAvmC,CAAO,EAAKsmC,EACrCrmB,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,6BAA8B,CAC9E,QAAS,KAAK,QACd,KAAM,CACF,MAAA+H,EACA,SAAAF,EACA,qBAAsB,CAAE,cAAiEvmC,GAAQ,YAAc,CAClH,EACD,MAAO++B,EAC3B,CAAiB,CACJ,KAEG,OAAM,IAAI5G,GAA4B,iEAAiE,EAE3G,KAAM,CAAE,KAAA7Y,EAAM,MAAA3c,CAAO,EAAGsd,EACxB,GAAItd,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAEvE,GAAI,CAAC2c,GAAQ,CAACA,EAAK,SAAW,CAACA,EAAK,KAAM,CAC3C,MAAMonB,EAAoB,IAAIxO,GAC9B,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAOwO,CAAmB,EAC9F,CACD,OAAIpnB,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAaA,EAAK,OAAO,GAEvD,KAAK,cAAc,CACtB,KAAM,OAAO,OAAO,CAAE,KAAMA,EAAK,KAAM,QAASA,EAAK,OAAS,EAAGA,EAAK,cAAgB,CAAE,aAAcA,EAAK,aAAe,EAAG,IAAM,EACnI,MAAA3c,CAChB,CAAa,CACJ,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAKD,MAAM,gBAAgB2jC,EAAa,CAC/B,IAAI5nB,EAAImB,EAAIK,EAAIC,EAChB,OAAO,MAAM,KAAK,sBAAsBmmB,EAAY,SAAU,CAC1D,YAAa5nB,EAAK4nB,EAAY,WAAa,MAAQ5nB,IAAO,OAAS,OAASA,EAAG,WAC/E,QAASmB,EAAKymB,EAAY,WAAa,MAAQzmB,IAAO,OAAS,OAASA,EAAG,OAC3E,aAAcK,EAAKomB,EAAY,WAAa,MAAQpmB,IAAO,OAAS,OAASA,EAAG,YAChF,qBAAsBC,EAAKmmB,EAAY,WAAa,MAAQnmB,IAAO,OAAS,OAASA,EAAG,mBACpG,CAAS,CACJ,CAID,MAAM,uBAAuBwmB,EAAU,CACnC,aAAM,KAAK,kBACJ,KAAK,aAAa,GAAI,SAClB,KAAK,wBAAwBA,CAAQ,CAC/C,CACJ,CAQD,MAAM,eAAeL,EAAa,CAC9B,KAAM,CAAE,MAAAM,CAAO,EAAGN,EAClB,OAAQM,EAAK,CACT,IAAK,WACD,OAAO,MAAM,KAAK,mBAAmBN,CAAW,EACpD,IAAK,SACD,OAAO,MAAM,KAAK,iBAAiBA,CAAW,EAClD,QACI,MAAM,IAAI,MAAM,yCAAyCM,CAAK,GAAG,CACxE,CACJ,CACD,MAAM,mBAAmBN,EAAa,CAClC,IAAI5nB,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EAAI2O,EAAIC,EAAIC,EAAIC,EAAIC,EAE5C,IAAI3uB,EACA+lC,EACJ,GAAI,YAAaP,EACbxlC,EAAUwlC,EAAY,QACtBO,EAAYP,EAAY,cAEvB,CACD,KAAM,CAAE,MAAAM,EAAO,OAAAE,EAAQ,UAAAzE,EAAW,QAAAriC,CAAO,EAAKsmC,EAC9C,IAAIS,EACJ,GAAKnuB,GAAS,EAMT,GAAI,OAAOkuB,GAAW,SACvBC,EAAiBD,MAEhB,CACD,MAAME,EAAY,OAClB,GAAI,aAAcA,GACd,OAAOA,EAAU,UAAa,UAC9B,YAAaA,EAAU,UACvB,OAAOA,EAAU,SAAS,SAAY,WACtCD,EAAiBC,EAAU,aAG3B,OAAM,IAAI,MAAM,6TAA6T,CAEpV,KApBiB,CACd,GAAI,OAAOF,GAAW,UAAY,CAAoD9mC,GAAQ,IAC1F,MAAM,IAAI,MAAM,uFAAuF,EAE3G+mC,EAAiBD,CACpB,CAgBD,MAAMpkC,EAAM,IAAI,KAAKgc,EAAuD1e,GAAQ,OAAS,MAAQ0e,IAAO,OAASA,EAAK,OAAO,SAAS,IAAI,EACxIuoB,EAAW,MAAMF,EAClB,QAAQ,CACT,OAAQ,qBACxB,CAAa,EACI,KAAMG,GAASA,CAAI,EACnB,MAAM,IAAM,CACb,MAAM,IAAI,MAAM,4EAA4E,CAC5G,CAAa,EACD,GAAI,CAACD,GAAYA,EAAS,SAAW,EACjC,MAAM,IAAI,MAAM,kFAAkF,EAEtG,MAAM5F,EAAUD,GAAW6F,EAAS,CAAC,CAAC,EACtC,IAAIvF,GAAW7hB,EAAuD7f,GAAQ,sBAAwB,MAAQ6f,IAAO,OAAS,OAASA,EAAG,QAC1I,GAAI,CAAC6hB,EAAS,CACV,MAAMyF,EAAa,MAAMJ,EAAe,QAAQ,CAC5C,OAAQ,aAC5B,CAAiB,EACDrF,EAAUJ,GAAQ6F,CAAU,CAC/B,CACD,MAAMC,EAAc,CAChB,OAAQ1kC,EAAI,KACZ,QAAS2+B,EACT,UAAWgB,EACX,IAAK3/B,EAAI,KACT,QAAS,IACT,QAASg/B,EACT,OAAQxhB,EAAuDlgB,GAAQ,sBAAwB,MAAQkgB,IAAO,OAAS,OAASA,EAAG,MACnI,UAAWO,GAAMN,EAAuDngB,GAAQ,sBAAwB,MAAQmgB,IAAO,OAAS,OAASA,EAAG,YAAc,MAAQM,IAAO,OAASA,EAAK,IAAI,KAC3L,gBAAiBC,EAAuD1gB,GAAQ,sBAAwB,MAAQ0gB,IAAO,OAAS,OAASA,EAAG,eAC5I,WAAY2O,EAAuDrvB,GAAQ,sBAAwB,MAAQqvB,IAAO,OAAS,OAASA,EAAG,UACvI,WAAYC,EAAuDtvB,GAAQ,sBAAwB,MAAQsvB,IAAO,OAAS,OAASA,EAAG,UACvI,WAAYC,EAAuDvvB,GAAQ,sBAAwB,MAAQuvB,IAAO,OAAS,OAASA,EAAG,SACvJ,EACYzuB,EAAU2gC,GAAkB2F,CAAW,EAEvCP,EAAa,MAAME,EAAe,QAAQ,CACtC,OAAQ,gBACR,OAAQ,CAACvF,GAAM1gC,CAAO,EAAGugC,CAAO,CACnC,EACJ,CACD,GAAI,CACA,KAAM,CAAE,KAAA/hB,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,yBAA0B,CAC5F,QAAS,KAAK,QACd,KAAM,OAAO,OAAO,CAAE,MAAO,WAAY,QAAA59B,EACrC,UAAA+lC,GAAgB,GAAArX,EAAK8W,EAAY,WAAa,MAAQ9W,IAAO,SAAkBA,EAAG,aAChF,CAAE,qBAAsB,CAAE,eAAgBC,EAAK6W,EAAY,WAAa,MAAQ7W,IAAO,OAAS,OAASA,EAAG,YAAY,CAAI,EAC5H,IAAM,EACZ,MAAOmP,EACvB,CAAa,EACD,GAAIj8B,EACA,MAAMA,EAEV,GAAI,CAAC2c,GAAQ,CAACA,EAAK,SAAW,CAACA,EAAK,KAAM,CACtC,MAAMonB,EAAoB,IAAIxO,GAC9B,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAOwO,CAAmB,EAC9F,CACD,OAAIpnB,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAaA,EAAK,OAAO,GAEvD,KAAK,cAAc,CAAE,KAAM,OAAO,OAAO,GAAIA,CAAI,EAAG,MAAA3c,CAAK,CAAE,CACrE,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CACD,MAAM,iBAAiB2jC,EAAa,CAChC,IAAI5nB,EAAImB,EAAIK,EAAIC,EAAIM,EAAIC,EAAI2O,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAChD,IAAI5uB,EACA+lC,EACJ,GAAI,YAAaP,EACbxlC,EAAUwlC,EAAY,QACtBO,EAAYP,EAAY,cAEvB,CACD,KAAM,CAAE,MAAAM,EAAO,OAAAE,EAAQ,UAAAzE,EAAW,QAAAriC,CAAO,EAAKsmC,EAC9C,IAAIS,EACJ,GAAKnuB,GAAS,EAMT,GAAI,OAAOkuB,GAAW,SACvBC,EAAiBD,MAEhB,CACD,MAAME,EAAY,OAClB,GAAI,WAAYA,GACZ,OAAOA,EAAU,QAAW,WAC1B,WAAYA,EAAU,QAAU,OAAOA,EAAU,OAAO,QAAW,YAChE,gBAAiBA,EAAU,QACxB,OAAOA,EAAU,OAAO,aAAgB,YAChDD,EAAiBC,EAAU,WAG3B,OAAM,IAAI,MAAM,uTAAuT,CAE9U,KArBiB,CACd,GAAI,OAAOF,GAAW,UAAY,CAAoD9mC,GAAQ,IAC1F,MAAM,IAAI,MAAM,uFAAuF,EAE3G+mC,EAAiBD,CACpB,CAiBD,MAAMpkC,EAAM,IAAI,KAAKgc,EAAuD1e,GAAQ,OAAS,MAAQ0e,IAAO,OAASA,EAAK,OAAO,SAAS,IAAI,EAC9I,GAAI,WAAYqoB,GAAkBA,EAAe,OAAQ,CACrD,MAAMM,EAAS,MAAMN,EAAe,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,CAAE,SAAU,IAAI,KAAI,EAAG,YAAW,GAAwD/mC,GAAQ,gBAAgB,EAAG,CAEtM,QAAS,IAAK,OAAQ0C,EAAI,KAAM,IAAKA,EAAI,IAAM,GAAI2/B,EAAY,CAAE,UAAAA,CAAS,EAAK,IAAM,GACzF,IAAIiF,EACJ,GAAI,MAAM,QAAQD,CAAM,GAAKA,EAAO,CAAC,GAAK,OAAOA,EAAO,CAAC,GAAM,SAC3DC,EAAkBD,EAAO,CAAC,UAErBA,GACL,OAAOA,GAAW,UAClB,kBAAmBA,GACnB,cAAeA,EACfC,EAAkBD,MAGlB,OAAM,IAAI,MAAM,uEAAuE,EAE3F,GAAI,kBAAmBC,GACnB,cAAeA,IACd,OAAOA,EAAgB,eAAkB,UACtCA,EAAgB,yBAAyB,aAC7CA,EAAgB,qBAAqB,WACrCxmC,EACI,OAAOwmC,EAAgB,eAAkB,SACnCA,EAAgB,cAChB,IAAI,YAAW,EAAG,OAAOA,EAAgB,aAAa,EAChET,EAAYS,EAAgB,cAG5B,OAAM,IAAI,MAAM,0GAA0G,CAEjI,KACI,CACD,GAAI,EAAE,gBAAiBP,IACnB,OAAOA,EAAe,aAAgB,YACtC,EAAE,cAAeA,IACjB,OAAOA,GAAmB,UAC1B,CAACA,EAAe,WAChB,EAAE,aAAcA,EAAe,YAC/B,OAAOA,EAAe,UAAU,UAAa,WAC7C,MAAM,IAAI,MAAM,iGAAiG,EAErHjmC,EAAU,CACN,GAAG4B,EAAI,IAAI,kDACXqkC,EAAe,UAAU,SAAU,EACnC,GAAI1E,EAAY,CAAC,GAAIA,EAAW,EAAE,EAAI,CAAC,EAAE,EACzC,aACA,QAAQ3/B,EAAI,IAAI,GAChB,eAAewd,GAAML,EAAuD7f,GAAQ,oBAAsB,MAAQ6f,IAAO,OAAS,OAASA,EAAG,YAAc,MAAQK,IAAO,OAASA,EAAK,IAAI,KAAI,EAAG,YAAa,IACjN,GAAM,GAAAC,EAAuDngB,GAAQ,oBAAsB,MAAQmgB,IAAO,SAAkBA,EAAG,UACzH,CAAC,eAAengB,EAAQ,iBAAiB,SAAS,EAAE,EACpD,GACN,GAAM,GAAAygB,EAAuDzgB,GAAQ,oBAAsB,MAAQygB,IAAO,SAAkBA,EAAG,eACzH,CAAC,oBAAoBzgB,EAAQ,iBAAiB,cAAc,EAAE,EAC9D,GACN,GAAM,GAAA0gB,EAAuD1gB,GAAQ,oBAAsB,MAAQ0gB,IAAO,SAAkBA,EAAG,QACzH,CAAC,aAAa1gB,EAAQ,iBAAiB,OAAO,EAAE,EAChD,GACN,GAAM,GAAAqvB,EAAuDrvB,GAAQ,oBAAsB,MAAQqvB,IAAO,SAAkBA,EAAG,MAAS,CAAC,UAAUrvB,EAAQ,iBAAiB,KAAK,EAAE,EAAI,GACvL,GAAM,GAAAsvB,EAAuDtvB,GAAQ,oBAAsB,MAAQsvB,IAAO,SAAkBA,EAAG,UACzH,CAAC,eAAetvB,EAAQ,iBAAiB,SAAS,EAAE,EACpD,GACN,GAAM,GAAAwvB,GAAMD,EAAuDvvB,GAAQ,oBAAsB,MAAQuvB,IAAO,OAAS,OAASA,EAAG,aAAe,MAAQC,IAAO,SAAkBA,EAAG,OAClL,CACE,YACA,GAAGxvB,EAAQ,iBAAiB,UAAU,IAAKwiC,GAAa,KAAKA,CAAQ,EAAE,CAC1E,EACC,EAC1B,EAAkB,KAAK;AAAA,CAAI,EACX,MAAM+E,EAAiB,MAAMR,EAAe,YAAY,IAAI,YAAa,EAAC,OAAOjmC,CAAO,EAAG,MAAM,EACjG,GAAI,CAACymC,GAAkB,EAAEA,aAA0B,YAC/C,MAAM,IAAI,MAAM,0EAA0E,EAE9FV,EAAYU,CACf,CACJ,CACD,GAAI,CACA,KAAM,CAAE,KAAAjoB,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,yBAA0B,CAC5F,QAAS,KAAK,QACd,KAAM,OAAO,OAAO,CAAE,MAAO,SAAU,QAAA59B,EAAS,UAAW05B,GAAiBqM,CAAS,CAAC,EAAO,GAAApX,EAAK6W,EAAY,WAAa,MAAQ7W,IAAO,SAAkBA,EAAG,aACzJ,CAAE,qBAAsB,CAAE,eAAgBC,EAAK4W,EAAY,WAAa,MAAQ5W,IAAO,OAAS,OAASA,EAAG,YAAY,CAAI,EAC5H,IAAM,EACZ,MAAOkP,EACvB,CAAa,EACD,GAAIj8B,EACA,MAAMA,EAEV,GAAI,CAAC2c,GAAQ,CAACA,EAAK,SAAW,CAACA,EAAK,KAAM,CACtC,MAAMonB,EAAoB,IAAIxO,GAC9B,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAOwO,CAAmB,EAC9F,CACD,OAAIpnB,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAaA,EAAK,OAAO,GAEvD,KAAK,cAAc,CAAE,KAAM,OAAO,OAAO,GAAIA,CAAI,EAAG,MAAA3c,CAAK,CAAE,CACrE,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CACD,MAAM,wBAAwBgkC,EAAU,CACpC,MAAMa,EAAc,MAAMnM,GAAa,KAAK,QAAS,GAAG,KAAK,UAAU,gBAAgB,EACjF,CAAC2B,EAAcqJ,CAAY,GAAKmB,GAA+D,IAAI,MAAM,GAAG,EAClH,GAAI,CACA,KAAM,CAAE,KAAAloB,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,yBAA0B,CAC5F,QAAS,KAAK,QACd,KAAM,CACF,UAAWiI,EACX,cAAe3J,CAClB,EACD,MAAO4B,EACvB,CAAa,EAED,GADA,MAAMtD,GAAgB,KAAK,QAAS,GAAG,KAAK,UAAU,gBAAgB,EAClE34B,EACA,MAAMA,EAEV,GAAI,CAAC2c,GAAQ,CAACA,EAAK,SAAW,CAACA,EAAK,KAAM,CACtC,MAAMonB,EAAoB,IAAIxO,GAC9B,OAAO,KAAK,cAAc,CACtB,KAAM,CAAE,KAAM,KAAM,QAAS,KAAM,aAAc,IAAM,EACvD,MAAOwO,CAC3B,CAAiB,CACJ,CACD,OAAIpnB,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAaA,EAAK,OAAO,GAEvD,KAAK,cAAc,CAAE,KAAM,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAI,EAAG,CAAE,aAAc+mB,GAAkE,IAAM,GAAG,MAAA1jC,CAAK,CAAE,CAC9K,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CACtB,KAAM,CAAE,KAAM,KAAM,QAAS,KAAM,aAAc,IAAM,EACvD,MAAAA,CACpB,CAAiB,EAEL,MAAMA,CACT,CACJ,CAKD,MAAM,kBAAkB2jC,EAAa,CACjC,GAAI,CACA,KAAM,CAAE,QAAAtmC,EAAS,SAAAynC,EAAU,MAAAnpB,EAAO,aAAAopB,EAAc,MAAA5F,CAAO,EAAGwE,EACpDrmB,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,6BAA8B,CACpF,QAAS,KAAK,QACd,KAAM,CACF,SAAA+I,EACA,SAAUnpB,EACV,aAAAopB,EACA,MAAA5F,EACA,qBAAsB,CAAE,cAAiE9hC,GAAQ,YAAc,CAClH,EACD,MAAO4+B,EACvB,CAAa,EACK,CAAE,KAAAtf,EAAM,MAAA3c,CAAO,EAAGsd,EACxB,GAAItd,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAEvE,GAAI,CAAC2c,GAAQ,CAACA,EAAK,SAAW,CAACA,EAAK,KAAM,CAC3C,MAAMonB,EAAoB,IAAIxO,GAC9B,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAOwO,CAAmB,EAC9F,CACD,OAAIpnB,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,YAAaA,EAAK,OAAO,GAEvD,KAAK,cAAc,CAAE,KAAAA,EAAM,MAAA3c,CAAO,EAC5C,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAkBD,MAAM,cAAc2jC,EAAa,CAC7B,IAAI5nB,EAAImB,EAAIK,EAAIC,EAAIM,EACpB,GAAI,CACA,GAAI,UAAW6lB,EAAa,CACxB,KAAM,CAAE,MAAAvG,EAAO,QAAA//B,CAAS,EAAGsmC,EAC3B,IAAIpJ,EAAgB,KAChBsJ,EAAsB,KACtB,KAAK,WAAa,SAElB,CAACtJ,EAAesJ,CAAmB,EAAI,MAAM3J,GAA0B,KAAK,QAAS,KAAK,UAAU,GAExG,KAAM,CAAE,MAAAl6B,CAAK,EAAK,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,OAAQ,CACpE,QAAS,KAAK,QACd,KAAM,CACF,MAAAqB,EACA,MAAOrhB,EAAuD1e,GAAQ,QAAU,MAAQ0e,IAAO,OAASA,EAAK,CAAE,EAC/G,aAAcmB,EAAuD7f,GAAQ,oBAAsB,MAAQ6f,IAAO,OAASA,EAAK,GAChI,qBAAsB,CAAE,cAAiE7f,GAAQ,YAAc,EAC/G,eAAgBk9B,EAChB,sBAAuBsJ,CAC1B,EACD,WAA8DxmC,GAAQ,eAC1F,CAAiB,EACD,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAA2C,CAAO,EAC3E,CACD,GAAI,UAAW2jC,EAAa,CACxB,KAAM,CAAE,MAAAG,EAAO,QAAAzmC,CAAS,EAAGsmC,EACrB,CAAE,KAAAhnB,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,OAAQ,CAC1E,QAAS,KAAK,QACd,KAAM,CACF,MAAA+H,EACA,MAAOvmB,EAAuDlgB,GAAQ,QAAU,MAAQkgB,IAAO,OAASA,EAAK,CAAE,EAC/G,aAAcC,EAAuDngB,GAAQ,oBAAsB,MAAQmgB,IAAO,OAASA,EAAK,GAChI,qBAAsB,CAAE,cAAiEngB,GAAQ,YAAc,EAC/G,SAAUygB,EAAuDzgB,GAAQ,WAAa,MAAQygB,IAAO,OAASA,EAAK,KACtH,CACrB,CAAiB,EACD,OAAO,KAAK,cAAc,CACtB,KAAM,CAAE,KAAM,KAAM,QAAS,KAAM,UAAuDnB,GAAK,UAAY,EAC3G,MAAA3c,CACpB,CAAiB,CACJ,CACD,MAAM,IAAIw1B,GAA4B,mDAAmD,CAC5F,OACMx1B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAID,MAAM,UAAU6E,EAAQ,CACpB,IAAIkX,EAAImB,EACR,GAAI,CACA,IAAI8nB,EACAC,EACA,YAAapgC,IACbmgC,GAAcjpB,EAAKlX,EAAO,WAAa,MAAQkX,IAAO,OAAS,OAASA,EAAG,WAC3EkpB,GAAgB/nB,EAAKrY,EAAO,WAAa,MAAQqY,IAAO,OAAS,OAASA,EAAG,cAEjF,KAAM,CAAE,KAAAP,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,UAAW,CAC7E,QAAS,KAAK,QACd,KAAM,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEl3B,CAAM,EAAG,CAAE,qBAAsB,CAAE,cAAeogC,CAAc,EAAE,EACxG,WAAAD,EACA,MAAO/I,EACvB,CAAa,EACD,GAAIj8B,EACA,MAAMA,EAEV,GAAI,CAAC2c,EAED,MAD+B,IAAI,MAAM,0CAA0C,EAGvF,MAAMuf,EAAUvf,EAAK,QACf6e,EAAO7e,EAAK,KAClB,OAAsDuf,GAAQ,eAC1D,MAAM,KAAK,aAAaA,CAAO,EAC/B,MAAM,KAAK,sBAAsBr3B,EAAO,MAAQ,WAAa,oBAAsB,YAAaq3B,CAAO,GAEpG,KAAK,cAAc,CAAE,KAAM,CAAE,KAAAV,EAAM,QAAAU,GAAW,MAAO,IAAI,CAAE,CACrE,OACMl8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAeD,MAAM,cAAc6E,EAAQ,CACxB,IAAIkX,EAAImB,EAAIK,EAAIC,EAAIM,EACpB,GAAI,CACA,IAAIyc,EAAgB,KAChBsJ,EAAsB,KACtB,KAAK,WAAa,SAElB,CAACtJ,EAAesJ,CAAmB,EAAI,MAAM3J,GAA0B,KAAK,QAAS,KAAK,UAAU,GAExG,MAAMv3B,EAAS,MAAMo5B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,OAAQ,CACjE,KAAM,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,CAAE,EAAG,eAAgBl3B,EAAS,CAAE,YAAaA,EAAO,UAAY,EAAG,IAAI,EAAK,WAAYA,EAAS,CAAE,OAAQA,EAAO,MAAM,EAAK,IAAM,EAAE,CAAE,aAAcqY,GAAMnB,EAAKlX,EAAO,WAAa,MAAQkX,IAAO,OAAS,OAASA,EAAG,cAAgB,MAAQmB,IAAO,OAASA,EAAK,MAAW,GAAM,GAAAK,EAAqD1Y,GAAO,WAAa,MAAQ0Y,IAAO,SAAkBA,EAAG,aACzc,CAAE,qBAAsB,CAAE,cAAe1Y,EAAO,QAAQ,YAAY,CAAI,EACxE,IAAM,EAAE,CAAE,mBAAoB,GAAM,eAAgB01B,EAAe,sBAAuBsJ,EAAqB,EACrH,QAAS,KAAK,QACd,MAAOvH,EACvB,CAAa,EAED,MAAM,GAAA9e,EAAK7a,EAAO,QAAU,MAAQ6a,IAAO,SAAkBA,EAAG,KAAQvH,MAAe,EAAG,GAAA6H,EAAKjZ,EAAO,WAAa,MAAQiZ,IAAO,SAAkBA,EAAG,sBACnJ,OAAO,SAAS,OAAOnb,EAAO,KAAK,GAAG,EAEnC,KAAK,cAAcA,CAAM,CACnC,OACM3C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAKD,MAAM,gBAAiB,CACnB,aAAM,KAAK,kBACJ,MAAM,KAAK,aAAa,GAAI,SACxB,MAAM,KAAK,iBACrB,CACJ,CACD,MAAM,iBAAkB,CACpB,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAO2C,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAO,EAAI,MAAOgJ,CAAe,EAAGviC,EACpD,GAAIuiC,EACA,MAAMA,EACV,GAAI,CAAChJ,EACD,MAAM,IAAI7G,GACd,KAAM,CAAE,MAAAr1B,CAAK,EAAK,MAAM+7B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,kBAAmB,CAC9E,QAAS,KAAK,QACd,IAAKG,EAAQ,YACjC,CAAiB,EACD,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAl8B,CAAO,EACxF,CAAa,CACJ,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAID,MAAM,OAAO2jC,EAAa,CACtB,GAAI,CACA,MAAMwB,EAAW,GAAG,KAAK,GAAG,UAC5B,GAAI,UAAWxB,EAAa,CACxB,KAAM,CAAE,MAAAvG,EAAO,KAAAjtB,EAAM,QAAA9S,CAAO,EAAKsmC,EAC3B,CAAE,MAAA3jC,CAAK,EAAK,MAAM+7B,EAAS,KAAK,MAAO,OAAQoJ,EAAU,CAC3D,QAAS,KAAK,QACd,KAAM,CACF,MAAA/H,EACA,KAAAjtB,EACA,qBAAsB,CAAE,cAAiE9S,GAAQ,YAAc,CAClH,EACD,WAA8DA,GAAQ,eAC1F,CAAiB,EACD,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAA2C,CAAO,EAC3E,SACQ,UAAW2jC,EAAa,CAC7B,KAAM,CAAE,MAAAG,EAAO,KAAA3zB,EAAM,QAAA9S,CAAO,EAAKsmC,EAC3B,CAAE,KAAAhnB,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,OAAQoJ,EAAU,CACjE,QAAS,KAAK,QACd,KAAM,CACF,MAAArB,EACA,KAAA3zB,EACA,qBAAsB,CAAE,cAAiE9S,GAAQ,YAAc,CAClH,CACrB,CAAiB,EACD,OAAO,KAAK,cAAc,CACtB,KAAM,CAAE,KAAM,KAAM,QAAS,KAAM,UAAuDsf,GAAK,UAAY,EAC3G,MAAA3c,CACpB,CAAiB,CACJ,CACD,MAAM,IAAIw1B,GAA4B,6DAA6D,CACtG,OACMx1B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAYD,MAAM,YAAa,CACf,aAAM,KAAK,kBACI,MAAM,KAAK,aAAa,GAAI,SAChC,KAAK,YAAY,MAAO2C,GACpBA,CACV,CACJ,CAEJ,CAID,MAAM,aAAa07B,EAAgBj+B,EAAI,CACnC,KAAK,OAAO,gBAAiB,QAASi+B,CAAc,EACpD,GAAI,CACA,GAAI,KAAK,aAAc,CACnB,MAAM+G,EAAO,KAAK,cAAc,OAC1B,KAAK,cAAc,KAAK,cAAc,OAAS,CAAC,EAChD,QAAQ,QAAO,EACfziC,GAAU,UACZ,MAAMyiC,EACC,MAAMhlC,EAAE,MAEnB,YAAK,cAAc,MAAM,SAAY,CACjC,GAAI,CACA,MAAMuC,CACT,MACS,CAET,CACJ,IAAG,EACGA,CACV,CACD,OAAO,MAAM,KAAK,KAAK,QAAQ,KAAK,UAAU,GAAI07B,EAAgB,SAAY,CAC1E,KAAK,OAAO,gBAAiB,gCAAiC,KAAK,UAAU,EAC7E,GAAI,CACA,KAAK,aAAe,GACpB,MAAM17B,EAASvC,IAWf,IAVA,KAAK,cAAc,MAAM,SAAY,CACjC,GAAI,CACA,MAAMuC,CACT,MACS,CAET,CACJ,IAAG,EACJ,MAAMA,EAEC,KAAK,cAAc,QAAQ,CAC9B,MAAM0iC,EAAS,CAAC,GAAG,KAAK,aAAa,EACrC,MAAM,QAAQ,IAAIA,CAAM,EACxB,KAAK,cAAc,OAAO,EAAGA,EAAO,MAAM,CAC7C,CACD,OAAO,MAAM1iC,CAChB,QACO,CACJ,KAAK,OAAO,gBAAiB,gCAAiC,KAAK,UAAU,EAC7E,KAAK,aAAe,EACvB,CACjB,CAAa,CACJ,QACO,CACJ,KAAK,OAAO,gBAAiB,KAAK,CACrC,CACJ,CAOD,MAAM,YAAYvC,EAAI,CAClB,KAAK,OAAO,eAAgB,OAAO,EACnC,GAAI,CAEA,MAAMuC,EAAS,MAAM,KAAK,gBAC1B,OAAO,MAAMvC,EAAGuC,CAAM,CACzB,QACO,CACJ,KAAK,OAAO,eAAgB,KAAK,CACpC,CACJ,CAMD,MAAM,eAAgB,CAClB,KAAK,OAAO,mBAAoB,OAAO,EAClC,KAAK,cACN,KAAK,OAAO,mBAAoB,oCAAqC,IAAI,MAAK,EAAG,KAAK,EAE1F,GAAI,CACA,IAAI2iC,EAAiB,KACrB,MAAMC,EAAe,MAAM7M,GAAa,KAAK,QAAS,KAAK,UAAU,EAWrE,GAVA,KAAK,OAAO,gBAAiB,uBAAwB6M,CAAY,EAC7DA,IAAiB,OACb,KAAK,gBAAgBA,CAAY,EACjCD,EAAiBC,GAGjB,KAAK,OAAO,gBAAiB,mCAAmC,EAChE,MAAM,KAAK,mBAGf,CAACD,EACD,MAAO,CAAE,KAAM,CAAE,QAAS,IAAI,EAAI,MAAO,MAO7C,MAAME,EAAaF,EAAe,WAC5BA,EAAe,WAAa,IAAO,KAAK,IAAK,EAAG9Q,GAChD,GAEN,GADA,KAAK,OAAO,mBAAoB,cAAcgR,EAAa,GAAK,MAAM,WAAY,aAAcF,EAAe,UAAU,EACrH,CAACE,EAAY,CACb,GAAI,KAAK,YAAa,CAClB,MAAMC,EAAa,MAAM/M,GAAa,KAAK,YAAa,KAAK,WAAa,OAAO,EACvB+M,GAAU,KAChEH,EAAe,KAAOG,EAAU,KAGhCH,EAAe,KAAOpK,IAE7B,CAGD,GAAI,KAAK,QAAQ,UACboK,EAAe,MACf,CAACA,EAAe,KAAK,0BAA2B,CAChD,MAAM7J,EAAqB,CAAE,MAAO,KAAK,yBAAyB,EAClE6J,EAAe,KAAO/J,GAAyB+J,EAAe,KAAM7J,CAAkB,EAElFA,EAAmB,QACnB,KAAK,0BAA4B,GAExC,CACD,MAAO,CAAE,KAAM,CAAE,QAAS6J,CAAc,EAAI,MAAO,KACtD,CACD,KAAM,CAAE,KAAMpJ,EAAS,MAAAl8B,CAAO,EAAG,MAAM,KAAK,kBAAkBslC,EAAe,aAAa,EAC1F,OAAItlC,EACO,KAAK,cAAc,CAAE,KAAM,CAAE,QAAS,IAAI,EAAI,MAAAA,CAAK,CAAE,EAEzD,KAAK,cAAc,CAAE,KAAM,CAAE,QAAAk8B,GAAW,MAAO,IAAI,CAAE,CAC/D,QACO,CACJ,KAAK,OAAO,mBAAoB,KAAK,CACxC,CACJ,CAQD,MAAM,QAAQgB,EAAK,CACf,OAAIA,EACO,MAAM,KAAK,SAASA,CAAG,GAElC,MAAM,KAAK,kBACI,MAAM,KAAK,aAAa,GAAI,SAChC,MAAM,KAAK,UACrB,EAEJ,CACD,MAAM,SAASA,EAAK,CAChB,GAAI,CACA,OAAIA,EACO,MAAMnB,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,QAAS,CACzD,QAAS,KAAK,QACd,IAAKmB,EACL,MAAOb,EAC3B,CAAiB,EAEE,MAAM,KAAK,YAAY,MAAO15B,GAAW,CAC5C,IAAIoZ,EAAImB,EAAIK,EACZ,KAAM,CAAE,KAAAZ,EAAM,MAAA3c,CAAO,EAAG2C,EACxB,GAAI3C,EACA,MAAMA,EAGV,MAAI,EAAG,GAAA+b,EAAKY,EAAK,WAAa,MAAQZ,IAAO,SAAkBA,EAAG,eAAiB,CAAC,KAAK,6BAC9E,CAAE,KAAM,CAAE,KAAM,IAAM,EAAE,MAAO,IAAIsZ,IAEvC,MAAM0G,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,QAAS,CACzD,QAAS,KAAK,QACd,KAAMxe,GAAML,EAAKP,EAAK,WAAa,MAAQO,IAAO,OAAS,OAASA,EAAG,gBAAkB,MAAQK,IAAO,OAASA,EAAK,OACtH,MAAO8e,EAC3B,CAAiB,CACjB,CAAa,CACJ,OACMr8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAIs1B,GAA0Bt1B,CAAK,IAG/B,MAAM,KAAK,iBACX,MAAM24B,GAAgB,KAAK,QAAS,GAAG,KAAK,UAAU,gBAAgB,GAEnE,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,IAAI,EAAI,MAAA34B,CAAK,CAAE,EAE7D,MAAMA,CACT,CACJ,CAID,MAAM,WAAWq9B,EAAYhgC,EAAU,GAAI,CACvC,aAAM,KAAK,kBACJ,MAAM,KAAK,aAAa,GAAI,SACxB,MAAM,KAAK,YAAYggC,EAAYhgC,CAAO,CACpD,CACJ,CACD,MAAM,YAAYggC,EAAYhgC,EAAU,GAAI,CACxC,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOsF,GAAW,CAC5C,KAAM,CAAE,KAAM+iC,EAAa,MAAOR,CAAY,EAAKviC,EACnD,GAAIuiC,EACA,MAAMA,EAEV,GAAI,CAACQ,EAAY,QACb,MAAM,IAAIrQ,GAEd,MAAM6G,EAAUwJ,EAAY,QAC5B,IAAInL,EAAgB,KAChBsJ,EAAsB,KACtB,KAAK,WAAa,QAAUxG,EAAW,OAAS,OAEhD,CAAC9C,EAAesJ,CAAmB,EAAI,MAAM3J,GAA0B,KAAK,QAAS,KAAK,UAAU,GAExG,KAAM,CAAE,KAAAvd,EAAM,MAAOgpB,CAAW,EAAG,MAAM5J,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,QAAS,CACrF,QAAS,KAAK,QACd,WAA8D1+B,GAAQ,gBACtE,KAAM,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEggC,CAAU,EAAG,CAAE,eAAgB9C,EAAe,sBAAuBsJ,CAAmB,CAAE,EAChI,IAAK3H,EAAQ,aACb,MAAOG,EAC3B,CAAiB,EACD,GAAIsJ,EACA,MAAMA,EAEV,OAAAzJ,EAAQ,KAAOvf,EAAK,KACpB,MAAM,KAAK,aAAauf,CAAO,EAC/B,MAAM,KAAK,sBAAsB,eAAgBA,CAAO,EACjD,KAAK,cAAc,CAAE,KAAM,CAAE,KAAMA,EAAQ,IAAM,EAAE,MAAO,IAAM,EACvF,CAAa,CACJ,OACMl8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,IAAI,EAAI,MAAAA,CAAK,CAAE,EAE7D,MAAMA,CACT,CACJ,CAMD,MAAM,WAAWslC,EAAgB,CAC7B,aAAM,KAAK,kBACJ,MAAM,KAAK,aAAa,GAAI,SACxB,MAAM,KAAK,YAAYA,CAAc,CAC/C,CACJ,CACD,MAAM,YAAYA,EAAgB,CAC9B,GAAI,CACA,GAAI,CAACA,EAAe,cAAgB,CAACA,EAAe,cAChD,MAAM,IAAIjQ,GAEd,MAAMwF,EAAU,KAAK,IAAG,EAAK,IAC7B,IAAI7C,EAAY6C,EACZ2K,EAAa,GACbtJ,EAAU,KACd,KAAM,CAAE,QAAA5Y,CAAS,EAAGwV,GAAUwM,EAAe,YAAY,EAKzD,GAJIhiB,EAAQ,MACR0U,EAAY1U,EAAQ,IACpBkiB,EAAaxN,GAAa6C,GAE1B2K,EAAY,CACZ,KAAM,CAAE,KAAMI,EAAkB,MAAA5lC,CAAO,EAAG,MAAM,KAAK,kBAAkBslC,EAAe,aAAa,EACnG,GAAItlC,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAOA,CAAO,GAEnF,GAAI,CAAC4lC,EACD,MAAO,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAO,MAEzD1J,EAAU0J,CACb,KACI,CACD,KAAM,CAAE,KAAAjpB,EAAM,MAAA3c,GAAU,MAAM,KAAK,SAASslC,EAAe,YAAY,EACvE,GAAItlC,EACA,MAAMA,EAEVk8B,EAAU,CACN,aAAcoJ,EAAe,aAC7B,cAAeA,EAAe,cAC9B,KAAM3oB,EAAK,KACX,WAAY,SACZ,WAAYqb,EAAY6C,EACxB,WAAY7C,CAChC,EACgB,MAAM,KAAK,aAAakE,CAAO,EAC/B,MAAM,KAAK,sBAAsB,YAAaA,CAAO,CACxD,CACD,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAMA,EAAQ,KAAM,QAAAA,CAAS,EAAE,MAAO,IAAM,EACnF,OACMl8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,QAAS,KAAM,KAAM,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAOD,MAAM,eAAeslC,EAAgB,CACjC,aAAM,KAAK,kBACJ,MAAM,KAAK,aAAa,GAAI,SACxB,MAAM,KAAK,gBAAgBA,CAAc,CACnD,CACJ,CACD,MAAM,gBAAgBA,EAAgB,CAClC,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAO3iC,GAAW,CAC5C,IAAIoZ,EACJ,GAAI,CAACupB,EAAgB,CACjB,KAAM,CAAE,KAAA3oB,EAAM,MAAA3c,CAAO,EAAG2C,EACxB,GAAI3C,EACA,MAAMA,EAEVslC,GAAkBvpB,EAAKY,EAAK,WAAa,MAAQZ,IAAO,OAASA,EAAK,MACzE,CACD,GAAI,CAAkEupB,GAAe,cACjF,MAAM,IAAIjQ,GAEd,KAAM,CAAE,KAAM6G,EAAS,MAAAl8B,CAAO,EAAG,MAAM,KAAK,kBAAkBslC,EAAe,aAAa,EAC1F,OAAItlC,EACO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAOA,CAAO,GAE9Ek8B,EAGE,KAAK,cAAc,CAAE,KAAM,CAAE,KAAMA,EAAQ,KAAM,QAAAA,CAAS,EAAE,MAAO,IAAM,GAFrE,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EAAE,MAAO,IAAM,EAGlG,CAAa,CACJ,OACMl8B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACJ,CAID,MAAM,mBAAmB6E,EAAQ4+B,EAAiB,CAC9C,GAAI,CACA,GAAI,CAACxtB,GAAW,EACZ,MAAM,IAAIwf,GAA+B,sBAAsB,EAEnE,GAAI5wB,EAAO,OAASA,EAAO,mBAAqBA,EAAO,WAGnD,MAAM,IAAI4wB,GAA+B5wB,EAAO,mBAAqB,kDAAmD,CACpH,MAAOA,EAAO,OAAS,oBACvB,KAAMA,EAAO,YAAc,kBAC/C,CAAiB,EAGL,OAAQ4+B,EAAe,CACnB,IAAK,WACD,GAAI,KAAK,WAAa,OAClB,MAAM,IAAI7N,GAA+B,4BAA4B,EAEzE,MACJ,IAAK,OACD,GAAI,KAAK,WAAa,WAClB,MAAM,IAAIH,GAA+B,sCAAsC,EAEnF,MACJ,QAEH,CAED,GAAIgO,IAAoB,OAAQ,CAE5B,GADA,KAAK,OAAO,iBAAkB,QAAS,eAAgB,EAAI,EACvD,CAAC5+B,EAAO,KACR,MAAM,IAAI+wB,GAA+B,mBAAmB,EAChE,KAAM,CAAE,KAAAjZ,EAAM,MAAA3c,GAAU,MAAM,KAAK,wBAAwB6E,EAAO,IAAI,EACtE,GAAI7E,EACA,MAAMA,EACV,MAAMD,EAAM,IAAI,IAAI,OAAO,SAAS,IAAI,EACxC,OAAAA,EAAI,aAAa,OAAO,MAAM,EAC9B,OAAO,QAAQ,aAAa,OAAO,QAAQ,MAAO,GAAIA,EAAI,SAAQ,CAAE,EAC7D,CAAE,KAAM,CAAE,QAAS4c,EAAK,QAAS,aAAc,IAAM,EAAE,MAAO,KACxE,CACD,KAAM,CAAE,eAAAkpB,EAAgB,uBAAAC,EAAwB,aAAAf,EAAc,cAAAgB,EAAe,WAAAC,EAAY,WAAAC,EAAY,WAAAC,CAAa,EAAGrhC,EACrH,GAAI,CAACkgC,GAAgB,CAACiB,GAAc,CAACD,GAAiB,CAACG,EACnD,MAAM,IAAIzQ,GAA+B,2BAA2B,EAExE,MAAMoF,EAAU,KAAK,MAAM,KAAK,IAAG,EAAK,GAAI,EACtCjL,EAAY,SAASoW,CAAU,EACrC,IAAIhO,EAAY6C,EAAUjL,EACtBqW,IACAjO,EAAY,SAASiO,CAAU,IAETjO,EAAY6C,GACd,KAAQvG,GAGhC,MAAM4K,EAAWlH,EAAYpI,EACzBiL,EAAUqE,GAAY,KAGjBrE,EAAUqE,EAAW,EAG9B,KAAM,CAAE,KAAAviB,EAAM,MAAA3c,CAAO,EAAG,MAAM,KAAK,SAAS+kC,CAAY,EACxD,GAAI/kC,EACA,MAAMA,EACV,MAAMk8B,EAAU,CACZ,eAAA2J,EACA,uBAAAC,EACA,aAAAf,EACA,WAAYnV,EACZ,WAAYoI,EACZ,cAAA+N,EACA,WAAYG,EACZ,KAAMvpB,EAAK,IAC3B,EAEY,cAAO,SAAS,KAAO,GACvB,KAAK,OAAO,wBAAyB,+BAA+B,EAC7D,KAAK,cAAc,CAAE,KAAM,CAAE,QAAAuf,EAAS,aAAcr3B,EAAO,IAAM,EAAE,MAAO,IAAM,EAC1F,OACM7E,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,QAAS,KAAM,aAAc,MAAQ,MAAAA,CAAO,GAEpF,MAAMA,CACT,CACJ,CAID,yBAAyB6E,EAAQ,CAC7B,MAAO,GAAQA,EAAO,cAAgBA,EAAO,kBAChD,CAID,MAAM,gBAAgBA,EAAQ,CAC1B,MAAMshC,EAAwB,MAAMzN,GAAa,KAAK,QAAS,GAAG,KAAK,UAAU,gBAAgB,EACjG,MAAO,CAAC,EAAE7zB,EAAO,MAAQshC,EAC5B,CASD,MAAM,QAAQ9oC,EAAU,CAAE,MAAO,QAAQ,EAAI,CACzC,aAAM,KAAK,kBACJ,MAAM,KAAK,aAAa,GAAI,SACxB,MAAM,KAAK,SAASA,CAAO,CACrC,CACJ,CACD,MAAM,SAAS,CAAE,MAAA8/B,CAAK,EAAK,CAAE,MAAO,QAAQ,EAAI,CAC5C,OAAO,MAAM,KAAK,YAAY,MAAOx6B,GAAW,CAC5C,IAAIoZ,EACJ,KAAM,CAAE,KAAAY,EAAM,MAAOuoB,CAAY,EAAKviC,EACtC,GAAIuiC,EACA,OAAO,KAAK,cAAc,CAAE,MAAOA,CAAc,GAErD,MAAMvR,GAAe5X,EAAKY,EAAK,WAAa,MAAQZ,IAAO,OAAS,OAASA,EAAG,aAChF,GAAI4X,EAAa,CACb,KAAM,CAAE,MAAA3zB,CAAO,EAAG,MAAM,KAAK,MAAM,QAAQ2zB,EAAawJ,CAAK,EAC7D,GAAIn9B,GAGI,EAAEk1B,GAAel1B,CAAK,IACrBA,EAAM,SAAW,KAAOA,EAAM,SAAW,KAAOA,EAAM,SAAW,MAClE,OAAO,KAAK,cAAc,CAAE,MAAAA,CAAO,EAG9C,CACD,OAAIm9B,IAAU,WACV,MAAM,KAAK,iBACX,MAAMxE,GAAgB,KAAK,QAAS,GAAG,KAAK,UAAU,gBAAgB,GAEnE,KAAK,cAAc,CAAE,MAAO,IAAM,EACrD,CAAS,CACJ,CACD,kBAAkBtkB,EAAU,CACxB,MAAMrH,EAAKirB,KACLmO,EAAe,CACjB,GAAAp5B,EACA,SAAAqH,EACA,YAAa,IAAM,CACf,KAAK,OAAO,iBAAkB,wCAAyCrH,CAAE,EACzE,KAAK,oBAAoB,OAAOA,CAAE,CACrC,CACb,EACQ,YAAK,OAAO,uBAAwB,8BAA+BA,CAAE,EACrE,KAAK,oBAAoB,IAAIA,EAAIo5B,CAAY,GAC5C,UACG,MAAM,KAAK,kBACX,MAAM,KAAK,aAAa,GAAI,SAAY,CACpC,KAAK,oBAAoBp5B,CAAE,CAC3C,CAAa,MAEE,CAAE,KAAM,CAAE,aAAAo5B,CAAY,EAChC,CACD,MAAM,oBAAoBp5B,EAAI,CAC1B,OAAO,MAAM,KAAK,YAAY,MAAOrK,GAAW,CAC5C,IAAIoZ,EAAImB,EACR,GAAI,CACA,KAAM,CAAE,KAAM,CAAE,QAAAgf,CAAS,EAAE,MAAAl8B,CAAK,EAAM2C,EACtC,GAAI3C,EACA,MAAMA,EACV,OAAQ+b,EAAK,KAAK,oBAAoB,IAAI/O,CAAE,KAAO,MAAQ+O,IAAO,OAAS,OAASA,EAAG,SAAS,kBAAmBmgB,CAAO,GAC1H,KAAK,OAAO,kBAAmB,cAAelvB,EAAI,UAAWkvB,CAAO,CACvE,OACMjO,EAAK,CACR,OAAQ/Q,EAAK,KAAK,oBAAoB,IAAIlQ,CAAE,KAAO,MAAQkQ,IAAO,OAAS,OAASA,EAAG,SAAS,kBAAmB,IAAI,GACvH,KAAK,OAAO,kBAAmB,cAAelQ,EAAI,QAASihB,CAAG,CAEjE,CACb,CAAS,CACJ,CAQD,MAAM,sBAAsBmP,EAAO//B,EAAU,GAAI,CAC7C,IAAIk9B,EAAgB,KAChBsJ,EAAsB,KACtB,KAAK,WAAa,SAElB,CAACtJ,EAAesJ,CAAmB,EAAI,MAAM3J,GAA0B,KAAK,QAAS,KAAK,WAAY,EAClH,GAEQ,GAAI,CACA,OAAO,MAAM6B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,WAAY,CAC7D,KAAM,CACF,MAAAqB,EACA,eAAgB7C,EAChB,sBAAuBsJ,EACvB,qBAAsB,CAAE,cAAexmC,EAAQ,YAAc,CAChE,EACD,QAAS,KAAK,QACd,WAAYA,EAAQ,UACpC,CAAa,CACJ,OACM2C,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAID,MAAM,mBAAoB,CACtB,IAAI+b,EACJ,GAAI,CACA,KAAM,CAAE,KAAAY,EAAM,MAAA3c,CAAK,EAAK,MAAM,KAAK,QAAO,EAC1C,GAAIA,EACA,MAAMA,EACV,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,YAAa+b,EAAKY,EAAK,KAAK,cAAgB,MAAQZ,IAAO,OAASA,EAAK,IAAM,MAAO,IAAI,CAAE,CACnI,OACM/b,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CACD,MAAM,aAAa2jC,EAAa,CAC5B,MAAI,UAAWA,EACJ,KAAK,oBAAoBA,CAAW,EAExC,KAAK,kBAAkBA,CAAW,CAC5C,CACD,MAAM,kBAAkBA,EAAa,CACjC,IAAI5nB,EACJ,GAAI,CACA,KAAM,CAAE,KAAAY,EAAM,MAAA3c,CAAO,EAAG,MAAM,KAAK,YAAY,MAAO2C,GAAW,CAC7D,IAAIoZ,EAAImB,EAAIK,EAAIC,EAAIM,EACpB,KAAM,CAAE,KAAAnB,EAAM,MAAA3c,CAAO,EAAG2C,EACxB,GAAI3C,EACA,MAAMA,EACV,MAAMD,EAAM,MAAM,KAAK,mBAAmB,GAAG,KAAK,GAAG,6BAA8B4jC,EAAY,SAAU,CACrG,YAAa5nB,EAAK4nB,EAAY,WAAa,MAAQ5nB,IAAO,OAAS,OAASA,EAAG,WAC/E,QAASmB,EAAKymB,EAAY,WAAa,MAAQzmB,IAAO,OAAS,OAASA,EAAG,OAC3E,aAAcK,EAAKomB,EAAY,WAAa,MAAQpmB,IAAO,OAAS,OAASA,EAAG,YAChF,oBAAqB,EACzC,CAAiB,EACD,OAAO,MAAMwe,EAAS,KAAK,MAAO,MAAOh8B,EAAK,CAC1C,QAAS,KAAK,QACd,KAAM+d,GAAMN,EAAKb,EAAK,WAAa,MAAQa,IAAO,OAAS,OAASA,EAAG,gBAAkB,MAAQM,IAAO,OAASA,EAAK,MAC1I,CAAiB,CACjB,CAAa,EACD,GAAI9d,EACA,MAAMA,EACV,OAAIiW,GAAS,GAAM,EAAG,GAAA8F,EAAK4nB,EAAY,WAAa,MAAQ5nB,IAAO,SAAkBA,EAAG,sBACpF,OAAO,SAAS,OAAmDY,GAAK,GAAG,EAExE,KAAK,cAAc,CACtB,KAAM,CAAE,SAAUgnB,EAAY,SAAU,IAAiDhnB,GAAK,GAAK,EACnG,MAAO,IACvB,CAAa,CACJ,OACM3c,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,SAAU2jC,EAAY,SAAU,IAAK,MAAQ,MAAA3jC,CAAO,GAE5F,MAAMA,CACT,CACJ,CACD,MAAM,oBAAoB2jC,EAAa,CACnC,OAAO,MAAM,KAAK,YAAY,MAAOhhC,GAAW,CAC5C,IAAIoZ,EACJ,GAAI,CACA,KAAM,CAAE,MAAOmpB,EAAc,KAAM,CAAE,QAAAhJ,CAAO,CAAK,EAAGv5B,EACpD,GAAIuiC,EACA,MAAMA,EACV,KAAM,CAAE,QAAA7nC,EAAS,SAAAynC,EAAU,MAAAnpB,EAAO,aAAAopB,EAAc,MAAA5F,CAAO,EAAGwE,EACpDrmB,EAAM,MAAMye,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,6BAA8B,CACpF,QAAS,KAAK,QACd,KAAMhgB,EAAuDmgB,GAAQ,gBAAkB,MAAQngB,IAAO,OAASA,EAAK,OACpH,KAAM,CACF,SAAA+oB,EACA,SAAUnpB,EACV,aAAAopB,EACA,MAAA5F,EACA,cAAe,GACf,qBAAsB,CAAE,cAAiE9hC,GAAQ,YAAc,CAClH,EACD,MAAO4+B,EAC3B,CAAiB,EACK,CAAE,KAAAtf,EAAM,MAAA3c,CAAO,EAAGsd,EACxB,OAAItd,EACO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAEnE,CAAC2c,GAAQ,CAACA,EAAK,SAAW,CAACA,EAAK,KAC9B,KAAK,cAAc,CACtB,KAAM,CAAE,KAAM,KAAM,QAAS,IAAM,EACnC,MAAO,IAAI4Y,EACnC,CAAqB,GAED5Y,EAAK,UACL,MAAM,KAAK,aAAaA,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,eAAgBA,EAAK,OAAO,GAE1D,KAAK,cAAc,CAAE,KAAAA,EAAM,MAAA3c,CAAO,GAC5C,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,KAAM,KAAM,QAAS,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,CACb,CAAS,CACJ,CAID,MAAM,eAAeqmC,EAAU,CAC3B,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAO1jC,GAAW,CAC5C,IAAIoZ,EAAImB,EACR,KAAM,CAAE,KAAAP,EAAM,MAAA3c,CAAO,EAAG2C,EACxB,GAAI3C,EACA,MAAMA,EAEV,OAAO,MAAM+7B,EAAS,KAAK,MAAO,SAAU,GAAG,KAAK,GAAG,oBAAoBsK,EAAS,WAAW,GAAI,CAC/F,QAAS,KAAK,QACd,KAAMnpB,GAAMnB,EAAKY,EAAK,WAAa,MAAQZ,IAAO,OAAS,OAASA,EAAG,gBAAkB,MAAQmB,IAAO,OAASA,EAAK,MAC1I,CAAiB,CACjB,CAAa,CACJ,OACMld,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAKD,MAAM,oBAAoBsmC,EAAc,CACpC,MAAMC,EAAY,wBAAwBD,EAAa,UAAU,EAAG,CAAC,CAAC,OACtE,KAAK,OAAOC,EAAW,OAAO,EAC9B,GAAI,CACA,MAAMC,EAAY,KAAK,MAEvB,OAAO,MAAMrN,GAAU,MAAOE,IACtBA,EAAU,GACV,MAAML,GAAM,IAAM,KAAK,IAAI,EAAGK,EAAU,CAAC,CAAC,EAE9C,KAAK,OAAOkN,EAAW,qBAAsBlN,CAAO,EAC7C,MAAM0C,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,kCAAmC,CACpF,KAAM,CAAE,cAAeuK,CAAc,EACrC,QAAS,KAAK,QACd,MAAOrK,EAC3B,CAAiB,GACF,CAAC5C,EAASr5B,IAAU,CACnB,MAAMymC,EAAsB,IAAM,KAAK,IAAI,EAAGpN,CAAO,EACrD,OAAQr5B,GACJ81B,GAA0B91B,CAAK,GAE/B,KAAK,IAAK,EAAGymC,EAAsBD,EAAYlS,EACnE,CAAa,CACJ,OACMt0B,EAAO,CAEV,GADA,KAAK,OAAOumC,EAAW,QAASvmC,CAAK,EACjCg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,CAAE,QAAS,KAAM,KAAM,MAAQ,MAAAA,CAAO,GAE5E,MAAMA,CACT,QACO,CACJ,KAAK,OAAOumC,EAAW,KAAK,CAC/B,CACJ,CACD,gBAAgBhB,EAAc,CAM1B,OALuB,OAAOA,GAAiB,UAC3CA,IAAiB,MACjB,iBAAkBA,GAClB,kBAAmBA,GACnB,eAAgBA,CAEvB,CACD,MAAM,sBAAsBT,EAAUznC,EAAS,CAC3C,MAAM0C,EAAM,MAAM,KAAK,mBAAmB,GAAG,KAAK,GAAG,aAAc+kC,EAAU,CACzE,WAAYznC,EAAQ,WACpB,OAAQA,EAAQ,OAChB,YAAaA,EAAQ,WACjC,CAAS,EACD,YAAK,OAAO,2BAA4B,WAAYynC,EAAU,UAAWznC,EAAS,MAAO0C,CAAG,EAExFkW,GAAW,GAAI,CAAC5Y,EAAQ,qBACxB,OAAO,SAAS,OAAO0C,CAAG,EAEvB,CAAE,KAAM,CAAE,SAAA+kC,EAAU,IAAA/kC,CAAG,EAAI,MAAO,KAC5C,CAKD,MAAM,oBAAqB,CACvB,IAAIgc,EAAImB,EACR,MAAMqpB,EAAY,wBAClB,KAAK,OAAOA,EAAW,OAAO,EAC9B,GAAI,CACA,MAAMjB,EAAkB,MAAM5M,GAAa,KAAK,QAAS,KAAK,UAAU,EACxE,GAAI4M,GAAkB,KAAK,YAAa,CACpC,IAAIG,EAAa,MAAM/M,GAAa,KAAK,YAAa,KAAK,WAAa,OAAO,EAC3E,CAAC,KAAK,QAAQ,UAAY,OAAO,GAAG,KAAK,QAAS,KAAK,WAAW,GAAK,CAAC+M,IAKxEA,EAAY,CAAE,KAAMH,EAAe,IAAI,EACvC,MAAM9M,GAAa,KAAK,YAAa,KAAK,WAAa,QAASiN,CAAS,GAE7EH,EAAe,MAAQvpB,EAA2D0pB,GAAU,QAAU,MAAQ1pB,IAAO,OAASA,EAAKmf,IACtI,SACQoK,GAAkB,CAACA,EAAe,MAGnC,CAACA,EAAe,KAAM,CAEtB,MAAMoB,EAAgB,MAAMhO,GAAa,KAAK,QAAS,KAAK,WAAa,OAAO,EAC5EgO,GAA6EA,GAAa,MAC1FpB,EAAe,KAAOoB,EAAa,KACnC,MAAM/N,GAAgB,KAAK,QAAS,KAAK,WAAa,OAAO,EAC7D,MAAMH,GAAa,KAAK,QAAS,KAAK,WAAY8M,CAAc,GAGhEA,EAAe,KAAOpK,IAE7B,CAGL,GADA,KAAK,OAAOqL,EAAW,uBAAwBjB,CAAc,EACzD,CAAC,KAAK,gBAAgBA,CAAc,EAAG,CACvC,KAAK,OAAOiB,EAAW,sBAAsB,EACzCjB,IAAmB,MACnB,MAAM,KAAK,iBAEf,MACH,CACD,MAAMqB,IAAsBzpB,EAAKooB,EAAe,cAAgB,MAAQpoB,IAAO,OAASA,EAAK,KAAY,IAAO,KAAK,IAAK,EAAGsX,GAE7H,GADA,KAAK,OAAO+R,EAAW,cAAcI,EAAoB,GAAK,MAAM,2BAA2BnS,EAAgB,GAAG,EAC9GmS,GACA,GAAI,KAAK,kBAAoBrB,EAAe,cAAe,CACvD,KAAM,CAAE,MAAAtlC,CAAK,EAAK,MAAM,KAAK,kBAAkBslC,EAAe,aAAa,EACvEtlC,IAEK81B,GAA0B91B,CAAK,IAChC,KAAK,OAAOumC,EAAW,kEAAmEvmC,CAAK,EAC/F,MAAM,KAAK,kBAGtB,UAEIslC,EAAe,MACpBA,EAAe,KAAK,4BAA8B,GAElD,GAAI,CACA,KAAM,CAAE,KAAA3oB,EAAM,MAAOgpB,CAAW,EAAG,MAAM,KAAK,SAASL,EAAe,YAAY,EAC9E,CAACK,GAA0DhpB,GAAK,MAChE2oB,EAAe,KAAO3oB,EAAK,KAC3B,MAAM,KAAK,aAAa2oB,CAAc,EACtC,MAAM,KAAK,sBAAsB,YAAaA,CAAc,GAG5D,KAAK,OAAOiB,EAAW,0DAA0D,CAExF,OACMK,EAAc,CAEjB,KAAK,OAAOL,EAAW,2DAA4DK,CAAY,CAClG,MAMD,MAAM,KAAK,sBAAsB,YAAatB,CAAc,CAEnE,OACMrX,EAAK,CACR,KAAK,OAAOsY,EAAW,QAAStY,CAAG,EAEnC,MACH,QACO,CACJ,KAAK,OAAOsY,EAAW,KAAK,CAC/B,CACJ,CACD,MAAM,kBAAkBD,EAAc,CAClC,IAAIvqB,EAAImB,EACR,GAAI,CAACopB,EACD,MAAM,IAAIjR,GAGd,GAAI,KAAK,mBACL,OAAO,KAAK,mBAAmB,QAEnC,MAAMkR,EAAY,sBAAsBD,EAAa,UAAU,EAAG,CAAC,CAAC,OACpE,KAAK,OAAOC,EAAW,OAAO,EAC9B,GAAI,CACA,KAAK,mBAAqB,IAAI3N,GAC9B,KAAM,CAAE,KAAAjc,EAAM,MAAA3c,CAAO,EAAG,MAAM,KAAK,oBAAoBsmC,CAAY,EACnE,GAAItmC,EACA,MAAMA,EACV,GAAI,CAAC2c,EAAK,QACN,MAAM,IAAI0Y,GACd,MAAM,KAAK,aAAa1Y,EAAK,OAAO,EACpC,MAAM,KAAK,sBAAsB,kBAAmBA,EAAK,OAAO,EAChE,MAAMha,EAAS,CAAE,KAAMga,EAAK,QAAS,MAAO,MAC5C,YAAK,mBAAmB,QAAQha,CAAM,EAC/BA,CACV,OACM3C,EAAO,CAEV,GADA,KAAK,OAAOumC,EAAW,QAASvmC,CAAK,EACjCg1B,EAAYh1B,CAAK,EAAG,CACpB,MAAM2C,EAAS,CAAE,KAAM,KAAM,MAAA3C,CAAK,EAClC,OAAK81B,GAA0B91B,CAAK,GAChC,MAAM,KAAK,kBAEd+b,EAAK,KAAK,sBAAwB,MAAQA,IAAO,QAAkBA,EAAG,QAAQpZ,CAAM,EAC9EA,CACV,CACD,MAACua,EAAK,KAAK,sBAAwB,MAAQA,IAAO,QAAkBA,EAAG,OAAOld,CAAK,EAC7EA,CACT,QACO,CACJ,KAAK,mBAAqB,KAC1B,KAAK,OAAOumC,EAAW,KAAK,CAC/B,CACJ,CACD,MAAM,sBAAsBz3B,EAAOotB,EAAStT,EAAY,GAAM,CAC1D,MAAM2d,EAAY,0BAA0Bz3B,CAAK,IACjD,KAAK,OAAOy3B,EAAW,QAASrK,EAAS,eAAetT,CAAS,EAAE,EACnE,GAAI,CACI,KAAK,kBAAoBA,GACzB,KAAK,iBAAiB,YAAY,CAAE,MAAA9Z,EAAO,QAAAotB,CAAS,GAExD,MAAM3wB,EAAS,GACTs7B,EAAW,MAAM,KAAK,KAAK,oBAAoB,QAAQ,EAAE,IAAI,MAAOhmB,GAAM,CAC5E,GAAI,CACA,MAAMA,EAAE,SAAS/R,EAAOotB,CAAO,CAClC,OACMhT,EAAG,CACN3d,EAAO,KAAK2d,CAAC,CAChB,CACjB,CAAa,EAED,GADA,MAAM,QAAQ,IAAI2d,CAAQ,EACtBt7B,EAAO,OAAS,EAAG,CACnB,QAASnK,EAAI,EAAGA,EAAImK,EAAO,OAAQnK,GAAK,EAAG,CAG3C,MAAMmK,EAAO,CAAC,CACjB,CACJ,QACO,CACJ,KAAK,OAAOg7B,EAAW,KAAK,CAC/B,CACJ,CAKD,MAAM,aAAarK,EAAS,CACxB,KAAK,OAAO,kBAAmBA,CAAO,EAGtC,KAAK,0BAA4B,GAEjC,MAAM4K,EAAmB,OAAO,OAAO,CAAE,EAAE5K,CAAO,EAC5C6K,EAAcD,EAAiB,MAAQA,EAAiB,KAAK,4BAA8B,GACjG,GAAI,KAAK,YAAa,CACd,CAACC,GAAeD,EAAiB,MAEjC,MAAMtO,GAAa,KAAK,YAAa,KAAK,WAAa,QAAS,CAC5D,KAAMsO,EAAiB,IAC3C,CAAiB,EAUL,MAAME,EAAkB,OAAO,OAAO,CAAE,EAAEF,CAAgB,EAC1D,OAAOE,EAAgB,KACvB,MAAMC,EAAwBtL,GAAUqL,CAAe,EACvD,MAAMxO,GAAa,KAAK,QAAS,KAAK,WAAYyO,CAAqB,CAC1E,KACI,CAID,MAAMC,EAAgBvL,GAAUmL,CAAgB,EAChD,MAAMtO,GAAa,KAAK,QAAS,KAAK,WAAY0O,CAAa,CAClE,CACJ,CACD,MAAM,gBAAiB,CACnB,KAAK,OAAO,mBAAmB,EAC/B,MAAMvO,GAAgB,KAAK,QAAS,KAAK,UAAU,EACnD,MAAMA,GAAgB,KAAK,QAAS,KAAK,WAAa,gBAAgB,EACtE,MAAMA,GAAgB,KAAK,QAAS,KAAK,WAAa,OAAO,EACzD,KAAK,aACL,MAAMA,GAAgB,KAAK,YAAa,KAAK,WAAa,OAAO,EAErE,MAAM,KAAK,sBAAsB,aAAc,IAAI,CACtD,CAOD,kCAAmC,CAC/B,KAAK,OAAO,qCAAqC,EACjD,MAAMtkB,EAAW,KAAK,0BACtB,KAAK,0BAA4B,KACjC,GAAI,CACIA,GAAY4B,MAAgE,QAAO,qBACnF,OAAO,oBAAoB,mBAAoB5B,CAAQ,CAE9D,MACS,CAET,CACJ,CAKD,MAAM,mBAAoB,CACtB,MAAM,KAAK,mBACX,KAAK,OAAO,sBAAsB,EAClC,MAAM8yB,EAAS,YAAY,IAAM,KAAK,sBAAqB,EAAI7S,EAA6B,EAC5F,KAAK,kBAAoB6S,EACrBA,GAAU,OAAOA,GAAW,UAAY,OAAOA,EAAO,OAAU,WAOhEA,EAAO,MAAK,EAGP,OAAO,KAAS,KAAe,OAAO,KAAK,YAAe,YAI/D,KAAK,WAAWA,CAAM,EAK1B,WAAW,SAAY,CACnB,MAAM,KAAK,kBACX,MAAM,KAAK,uBACd,EAAE,CAAC,CACP,CAKD,MAAM,kBAAmB,CACrB,KAAK,OAAO,qBAAqB,EACjC,MAAMA,EAAS,KAAK,kBACpB,KAAK,kBAAoB,KACrBA,GACA,cAAcA,CAAM,CAE3B,CAuBD,MAAM,kBAAmB,CACrB,KAAK,iCAAgC,EACrC,MAAM,KAAK,mBACd,CASD,MAAM,iBAAkB,CACpB,KAAK,iCAAgC,EACrC,MAAM,KAAK,kBACd,CAID,MAAM,uBAAwB,CAC1B,KAAK,OAAO,2BAA4B,OAAO,EAC/C,GAAI,CACA,MAAM,KAAK,aAAa,EAAG,SAAY,CACnC,GAAI,CACA,MAAMC,EAAM,KAAK,MACjB,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOzkC,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAS,GAAMv5B,EAC/B,GAAI,CAACu5B,GAAW,CAACA,EAAQ,eAAiB,CAACA,EAAQ,WAAY,CAC3D,KAAK,OAAO,2BAA4B,YAAY,EACpD,MACH,CAED,MAAMmL,EAAiB,KAAK,OAAOnL,EAAQ,WAAa,IAAOkL,GAAO9S,EAA6B,EACnG,KAAK,OAAO,2BAA4B,2BAA2B+S,CAAc,wBAAwB/S,EAA6B,4BAA4BC,EAA2B,QAAQ,EACjM8S,GAAkB9S,IAClB,MAAM,KAAK,kBAAkB2H,EAAQ,aAAa,CAElF,CAAyB,CACJ,MACS,CAET,CACJ,QACO,CACJ,KAAK,OAAO,2BAA4B,KAAK,CAChD,CACjB,CAAa,CACJ,OACM,EAAG,CACN,GAAI,EAAE,kBAAoB,aAAagC,GACnC,KAAK,OAAO,4CAA4C,MAGxD,OAAM,CAEb,CACJ,CAMD,MAAM,yBAA0B,CAE5B,GADA,KAAK,OAAO,4BAA4B,EACpC,CAACjoB,GAAS,GAAM,CAAkD,QAAO,iBACzE,OAAI,KAAK,kBAEL,KAAK,iBAAgB,EAElB,GAEX,GAAI,CACA,KAAK,0BAA4B,SAAY,MAAM,KAAK,qBAAqB,EAAK,EAClC,QAAO,iBAAiB,mBAAoB,KAAK,yBAAyB,EAG1H,MAAM,KAAK,qBAAqB,EAAI,CACvC,MACa,CAEb,CACJ,CAID,MAAM,qBAAqBqxB,EAAsB,CAC7C,MAAMC,EAAa,yBAAyBD,CAAoB,IAChE,KAAK,OAAOC,EAAY,kBAAmB,SAAS,eAAe,EAC/D,SAAS,kBAAoB,WACzB,KAAK,kBAGL,KAAK,kBAAiB,EAErBD,IAKD,MAAM,KAAK,kBACX,MAAM,KAAK,aAAa,GAAI,SAAY,CACpC,GAAI,SAAS,kBAAoB,UAAW,CACxC,KAAK,OAAOC,EAAY,0GAA0G,EAElI,MACH,CAED,MAAM,KAAK,oBAC/B,CAAiB,IAGA,SAAS,kBAAoB,UAC9B,KAAK,kBACL,KAAK,iBAAgB,CAGhC,CAOD,MAAM,mBAAmBxnC,EAAK+kC,EAAUznC,EAAS,CAC7C,MAAMmqC,EAAY,CAAC,YAAY,mBAAmB1C,CAAQ,CAAC,EAAE,EAO7D,GANsDznC,GAAQ,YAC1DmqC,EAAU,KAAK,eAAe,mBAAmBnqC,EAAQ,UAAU,CAAC,EAAE,EAEpBA,GAAQ,QAC1DmqC,EAAU,KAAK,UAAU,mBAAmBnqC,EAAQ,MAAM,CAAC,EAAE,EAE7D,KAAK,WAAa,OAAQ,CAC1B,KAAM,CAACk9B,EAAesJ,CAAmB,EAAI,MAAM3J,GAA0B,KAAK,QAAS,KAAK,UAAU,EACpGuN,EAAa,IAAI,gBAAgB,CACnC,eAAgB,GAAG,mBAAmBlN,CAAa,CAAC,GACpD,sBAAuB,GAAG,mBAAmBsJ,CAAmB,CAAC,EACjF,CAAa,EACD2D,EAAU,KAAKC,EAAW,SAAU,EACvC,CACD,GAAsDpqC,GAAQ,YAAa,CACvE,MAAM2iB,EAAQ,IAAI,gBAAgB3iB,EAAQ,WAAW,EACrDmqC,EAAU,KAAKxnB,EAAM,SAAU,EAClC,CACD,OAAsD3iB,GAAQ,qBAC1DmqC,EAAU,KAAK,sBAAsBnqC,EAAQ,mBAAmB,EAAE,EAE/D,GAAG0C,CAAG,IAAIynC,EAAU,KAAK,GAAG,CAAC,EACvC,CACD,MAAM,UAAU3iC,EAAQ,CACpB,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOlC,GAAW,CAC5C,IAAIoZ,EACJ,KAAM,CAAE,KAAM2pB,EAAa,MAAOR,CAAY,EAAKviC,EACnD,OAAIuiC,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAE1D,MAAMnJ,EAAS,KAAK,MAAO,SAAU,GAAG,KAAK,GAAG,YAAYl3B,EAAO,QAAQ,GAAI,CAClF,QAAS,KAAK,QACd,KAAMkX,EAA+D2pB,GAAY,WAAa,MAAQ3pB,IAAO,OAAS,OAASA,EAAG,YACtJ,CAAiB,CACjB,CAAa,CACJ,OACM/b,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CACD,MAAM,QAAQ6E,EAAQ,CAClB,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOlC,GAAW,CAC5C,IAAIoZ,EAAImB,EACR,KAAM,CAAE,KAAMwoB,EAAa,MAAOR,CAAY,EAAKviC,EACnD,GAAIuiC,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAEjE,MAAMn1B,EAAO,OAAO,OAAO,CAAE,cAAelL,EAAO,aAAc,YAAaA,EAAO,UAAY,EAAGA,EAAO,aAAe,QACpH,CAAE,MAAOA,EAAO,KAAO,EACvBA,EAAO,aAAe,OAClB,CAAE,OAAQA,EAAO,MAAQ,EACzB,IACJ,CAAE,KAAA8X,EAAM,MAAA3c,GAAW,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,WAAY,CAC/E,KAAAhsB,EACA,QAAS,KAAK,QACd,KAAMgM,EAA+D2pB,GAAY,WAAa,MAAQ3pB,IAAO,OAAS,OAASA,EAAG,YACrI,GACD,OAAI/b,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,GAE/C6E,EAAO,aAAe,QAAU8X,EAAK,OAAS,SAAY,GAAAO,EAAiDP,GAAK,QAAU,MAAQO,IAAO,SAAkBA,EAAG,WAC9JP,EAAK,KAAK,QAAU,4BAA4BA,EAAK,KAAK,OAAO,IAE9D,KAAK,cAAc,CAAE,KAAAA,EAAM,MAAO,IAAI,CAAE,EAC/D,CAAa,CACJ,OACM3c,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CACD,MAAM,QAAQ6E,EAAQ,CAClB,OAAO,KAAK,aAAa,GAAI,SAAY,CACrC,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOlC,GAAW,CAC5C,IAAIoZ,EACJ,KAAM,CAAE,KAAM2pB,EAAa,MAAOR,CAAY,EAAKviC,EACnD,GAAIuiC,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAEjE,MAAMn1B,EAAO,OAAO,OAAO,CAAE,aAAclL,EAAO,aAAgB,aAAcA,EAC1E,CACE,SAAU,OAAO,OAAO,OAAO,OAAO,GAAIA,EAAO,QAAQ,EAAG,CAAE,oBAAqBA,EAAO,SAAS,OAAS,SAClGs8B,GAAoCt8B,EAAO,SAAS,mBAAmB,EACvEy8B,GAAmCz8B,EAAO,SAAS,mBAAmB,CAAC,CAAE,CACtF,EACC,CAAE,KAAMA,EAAO,IAAI,GACnB,CAAE,KAAA8X,EAAM,MAAA3c,CAAK,EAAK,MAAM+7B,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,YAAYl3B,EAAO,QAAQ,UAAW,CACxG,KAAAkL,EACA,QAAS,KAAK,QACd,KAAMgM,EAA+D2pB,GAAY,WAAa,MAAQ3pB,IAAO,OAAS,OAASA,EAAG,YAC1J,CAAqB,EACD,OAAI/b,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,GAEnD,MAAM,KAAK,aAAa,OAAO,OAAO,CAAE,WAAY,KAAK,MAAM,KAAK,IAAG,EAAK,GAAI,EAAI2c,EAAK,UAAY,EAAEA,CAAI,CAAC,EAC5G,MAAM,KAAK,sBAAsB,yBAA0BA,CAAI,EACxD,KAAK,cAAc,CAAE,KAAAA,EAAM,MAAA3c,CAAO,GAC7D,CAAiB,CACJ,OACMA,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACb,CAAS,CACJ,CACD,MAAM,WAAW6E,EAAQ,CACrB,OAAO,KAAK,aAAa,GAAI,SAAY,CACrC,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOlC,GAAW,CAC5C,IAAIoZ,EACJ,KAAM,CAAE,KAAM2pB,EAAa,MAAOR,CAAY,EAAKviC,EACnD,GAAIuiC,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAEjE,MAAM3oB,EAAY,MAAMwf,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,YAAYl3B,EAAO,QAAQ,aAAc,CACrG,KAAMA,EACN,QAAS,KAAK,QACd,KAAMkX,EAA+D2pB,GAAY,WAAa,MAAQ3pB,IAAO,OAAS,OAASA,EAAG,YACrI,GACD,GAAIQ,EAAS,MACT,OAAOA,EAEX,KAAM,CAAE,KAAAI,CAAM,EAAGJ,EACjB,GAAII,EAAK,OAAS,WACd,MAAO,CAAE,KAAAA,EAAM,MAAO,MAE1B,OAAQA,EAAK,SAAS,KAAI,CACtB,IAAK,SACD,MAAO,CACH,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIA,CAAI,EAAG,CAAE,SAAU,OAAO,OAAO,OAAO,OAAO,GAAIA,EAAK,QAAQ,EAAG,CAAE,mBAAoB,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,EAAK,SAAS,kBAAkB,EAAG,CAAE,UAAW+jB,GAAqC/jB,EAAK,SAAS,mBAAmB,SAAS,CAAG,EAAG,GAAG,EACvS,MAAO,IACvC,EACwB,IAAK,UACD,MAAO,CACH,KAAM,OAAO,OAAO,OAAO,OAAO,GAAIA,CAAI,EAAG,CAAE,SAAU,OAAO,OAAO,OAAO,OAAO,GAAIA,EAAK,QAAQ,EAAG,CAAE,mBAAoB,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,EAAK,SAAS,kBAAkB,EAAG,CAAE,UAAWskB,GAAoCtkB,EAAK,SAAS,mBAAmB,SAAS,CAAG,EAAG,GAAG,EACtS,MAAO,IACvC,CACqB,CACrB,CAAiB,CACJ,OACM3c,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACb,CAAS,CACJ,CAID,MAAM,oBAAoB6E,EAAQ,CAG9B,KAAM,CAAE,KAAM6iC,EAAe,MAAO5E,GAAmB,MAAM,KAAK,WAAW,CACzE,SAAUj+B,EAAO,QAC7B,CAAS,EACD,OAAIi+B,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAc,CAAE,EAE5D,MAAM,KAAK,QAAQ,CACtB,SAAUj+B,EAAO,SACjB,YAAa6iC,EAAc,GAC3B,KAAM7iC,EAAO,IACzB,CAAS,CACJ,CAID,MAAM,cAAe,CACjB,IAAIkX,EAEJ,KAAM,CAAE,KAAM,CAAE,KAAAyf,GAAQ,MAAOmK,GAAe,MAAM,KAAK,UACzD,GAAIA,EACA,MAAO,CAAE,KAAM,KAAM,MAAOA,CAAS,EAEzC,MAAMhpB,EAAO,CACT,IAAK,CAAE,EACP,MAAO,CAAE,EACT,KAAM,CAAE,EACR,SAAU,CAAE,CACxB,EAEQ,UAAWwmB,KAAWpnB,EAAiDyf,GAAK,WAAa,MAAQzf,IAAO,OAASA,EAAK,GAClHY,EAAK,IAAI,KAAKwmB,CAAM,EAChBA,EAAO,SAAW,YAElBxmB,EAAKwmB,EAAO,WAAW,EAAE,KAAKA,CAAM,EAG5C,MAAO,CACH,KAAAxmB,EACA,MAAO,IACnB,CACK,CAID,MAAM,iCAAkC,CACpC,IAAIZ,EAAImB,EACR,KAAM,CAAE,KAAM,CAAE,QAAAgf,GAAW,MAAOgJ,GAAkB,MAAM,KAAK,aAC/D,GAAIA,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAEjE,GAAI,CAAChJ,EACD,MAAO,CACH,KAAM,CAAE,aAAc,KAAM,UAAW,KAAM,6BAA8B,EAAI,EAC/E,MAAO,IACvB,EAEQ,KAAM,CAAE,QAAA5Y,CAAS,EAAGwV,GAAUoD,EAAQ,YAAY,EAClD,IAAIyL,EAAe,KACfrkB,EAAQ,MACRqkB,EAAerkB,EAAQ,KAE3B,IAAIskB,EAAYD,IACSzqB,GAAMnB,EAAKmgB,EAAQ,KAAK,WAAa,MAAQngB,IAAO,OAAS,OAASA,EAAG,OAAQonB,GAAWA,EAAO,SAAW,UAAU,KAAO,MAAQjmB,IAAO,OAASA,EAAK,IACjK,OAAS,IACzB0qB,EAAY,QAEhB,MAAMC,EAA+BvkB,EAAQ,KAAO,GACpD,MAAO,CAAE,KAAM,CAAE,aAAAqkB,EAAc,UAAAC,EAAW,6BAAAC,GAAgC,MAAO,KACpF,CASD,MAAM,yBAAyBC,EAAiB,CAC5C,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOnlC,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAO,EAAI,MAAOgJ,CAAe,EAAGviC,EACpD,OAAIuiC,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAE5DhJ,EAGE,MAAMH,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,yBAAyB+L,CAAe,GAAI,CAC5F,QAAS,KAAK,QACd,IAAK5L,EAAQ,aACb,MAAQvf,IAAU,CAAE,KAAAA,EAAM,MAAO,IAAI,EACzD,CAAiB,EANU,KAAK,cAAc,CAAE,KAAM,KAAM,MAAO,IAAI0Y,EAAyB,CAAE,CAOlG,CAAa,CACJ,OACMr1B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAKD,MAAM,sBAAsB8nC,EAAiBzqC,EAAS,CAClD,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOsF,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAO,EAAI,MAAOgJ,CAAe,EAAGviC,EACpD,GAAIuiC,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAEjE,GAAI,CAAChJ,EACD,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAO,IAAI7G,EAAyB,CAAE,EAElF,MAAM9Y,EAAW,MAAMwf,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,yBAAyB+L,CAAe,WAAY,CAC/G,QAAS,KAAK,QACd,IAAK5L,EAAQ,aACb,KAAM,CAAE,OAAQ,SAAW,EAC3B,MAAQvf,IAAU,CAAE,KAAAA,EAAM,MAAO,IAAI,EACzD,CAAiB,EACD,OAAIJ,EAAS,MAAQA,EAAS,KAAK,cAE3BtG,GAAW,GAAI,CAAoD5Y,GAAQ,qBAC3E,OAAO,SAAS,OAAOkf,EAAS,KAAK,YAAY,EAGlDA,CACvB,CAAa,CACJ,OACMvc,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAKD,MAAM,mBAAmB8nC,EAAiBzqC,EAAS,CAC/C,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOsF,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAO,EAAI,MAAOgJ,CAAe,EAAGviC,EACpD,GAAIuiC,EACA,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAEjE,GAAI,CAAChJ,EACD,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAO,IAAI7G,EAAyB,CAAE,EAElF,MAAM9Y,EAAW,MAAMwf,EAAS,KAAK,MAAO,OAAQ,GAAG,KAAK,GAAG,yBAAyB+L,CAAe,WAAY,CAC/G,QAAS,KAAK,QACd,IAAK5L,EAAQ,aACb,KAAM,CAAE,OAAQ,MAAQ,EACxB,MAAQvf,IAAU,CAAE,KAAAA,EAAM,MAAO,IAAI,EACzD,CAAiB,EACD,OAAIJ,EAAS,MAAQA,EAAS,KAAK,cAE3BtG,GAAW,GAAI,CAAoD5Y,GAAQ,qBAC3E,OAAO,SAAS,OAAOkf,EAAS,KAAK,YAAY,EAGlDA,CACvB,CAAa,CACJ,OACMvc,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAKD,MAAM,kBAAmB,CACrB,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAO2C,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAO,EAAI,MAAOgJ,CAAe,EAAGviC,EACpD,OAAIuiC,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAE5DhJ,EAGE,MAAMH,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,qBAAsB,CACtE,QAAS,KAAK,QACd,IAAKG,EAAQ,aACb,MAAQvf,IAAU,CAAE,KAAAA,EAAM,MAAO,IAAI,EACzD,CAAiB,EANU,KAAK,cAAc,CAAE,KAAM,KAAM,MAAO,IAAI0Y,EAAyB,CAAE,CAOlG,CAAa,CACJ,OACMr1B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CAKD,MAAM,kBAAkB3C,EAAS,CAC7B,GAAI,CACA,OAAO,MAAM,KAAK,YAAY,MAAOsF,GAAW,CAC5C,KAAM,CAAE,KAAM,CAAE,QAAAu5B,CAAO,EAAI,MAAOgJ,CAAe,EAAGviC,EACpD,OAAIuiC,EACO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAOA,CAAY,CAAE,EAE5DhJ,GAGL,MAAMH,EAAS,KAAK,MAAO,SAAU,GAAG,KAAK,GAAG,qBAAsB,CAClE,QAAS,KAAK,QACd,IAAKG,EAAQ,aACb,MAAO,CAAE,UAAW7+B,EAAQ,QAAU,EACtC,cAAe,EACnC,CAAiB,EACM,CAAE,KAAM,GAAI,MAAO,IAAI,GARnB,KAAK,cAAc,CAAE,KAAM,KAAM,MAAO,IAAIg4B,EAAyB,CAAE,CASlG,CAAa,CACJ,OACMr1B,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CACD,MAAM,SAAS+nC,EAAKC,EAAO,CAAE,KAAM,CAAE,GAAI,CAErC,IAAIC,EAAMD,EAAK,KAAK,KAAMppC,GAAQA,EAAI,MAAQmpC,CAAG,EACjD,GAAIE,EACA,OAAOA,EAEX,MAAMb,EAAM,KAAK,MAIjB,GAFAa,EAAM,KAAK,KAAK,KAAK,KAAMrpC,GAAQA,EAAI,MAAQmpC,CAAG,EAE9CE,GAAO,KAAK,eAAiBnT,GAAWsS,EACxC,OAAOa,EAGX,KAAM,CAAE,KAAAtrB,EAAM,MAAA3c,GAAU,MAAM+7B,EAAS,KAAK,MAAO,MAAO,GAAG,KAAK,GAAG,yBAA0B,CAC3F,QAAS,KAAK,OAC1B,CAAS,EACD,GAAI/7B,EACA,MAAMA,EASV,MAPI,CAAC2c,EAAK,MAAQA,EAAK,KAAK,SAAW,IAGvC,KAAK,KAAOA,EACZ,KAAK,eAAiByqB,EAEtBa,EAAMtrB,EAAK,KAAK,KAAM/d,GAAQA,EAAI,MAAQmpC,CAAG,EACzC,CAACE,GACM,KAEJA,CACV,CAiBD,MAAM,UAAU/K,EAAK7/B,EAAU,GAAI,CAC/B,GAAI,CACA,IAAIse,EAAQuhB,EACZ,GAAI,CAACvhB,EAAO,CACR,KAAM,CAAE,KAAAgB,EAAM,MAAA3c,CAAK,EAAK,MAAM,KAAK,WAAU,EAC7C,GAAIA,GAAS,CAAC2c,EAAK,QACf,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAA3c,CAAK,CAAE,EAEnD2b,EAAQgB,EAAK,QAAQ,YACxB,CACD,KAAM,CAAE,OAAAqH,EAAQ,QAAAV,EAAS,UAAA4gB,EAAW,IAAK,CAAE,OAAQgE,EAAW,QAAS9jB,CAAU,CAAK,EAAG0U,GAAUnd,CAAK,EAChDte,GAAQ,cAE5Ds9B,GAAYrX,EAAQ,GAAG,EAE3B,MAAM6kB,EAAa,CAACnkB,EAAO,KACvBA,EAAO,IAAI,WAAW,IAAI,GAC1B,CAACA,EAAO,KACR,EAAE,WAAY,YAAc,WAAY,WAAW,QACjD,KACA,MAAM,KAAK,SAASA,EAAO,IAAwD3mB,GAAQ,KAAQ,CAAE,KAAMA,EAAQ,IAAM,EAAqDA,GAAQ,IAAI,EAEhM,GAAI,CAAC8qC,EAAY,CACb,KAAM,CAAE,MAAAnoC,CAAK,EAAK,MAAM,KAAK,QAAQ2b,CAAK,EAC1C,GAAI3b,EACA,MAAMA,EAGV,MAAO,CACH,KAAM,CACF,OAAQsjB,EACR,OAAAU,EACA,UAAAkgB,CACH,EACD,MAAO,IAC3B,CACa,CACD,MAAMkE,EAAYtN,GAAa9W,EAAO,GAAG,EAEnCic,EAAY,MAAM,OAAO,OAAO,UAAU,MAAOkI,EAAYC,EAAW,GAAM,CAChF,QAChB,CAAa,EAGD,GAAI,CADY,MAAM,OAAO,OAAO,OAAOA,EAAWnI,EAAWiE,EAAWtM,GAAmB,GAAGsQ,CAAS,IAAI9jB,CAAU,EAAE,CAAC,EAExH,MAAM,IAAI6R,GAAoB,uBAAuB,EAGzD,MAAO,CACH,KAAM,CACF,OAAQ3S,EACR,OAAAU,EACA,UAAAkgB,CACH,EACD,MAAO,IACvB,CACS,OACMlkC,EAAO,CACV,GAAIg1B,EAAYh1B,CAAK,EACjB,OAAO,KAAK,cAAc,CAAE,KAAM,KAAM,MAAAA,CAAK,CAAE,EAEnD,MAAMA,CACT,CACJ,CACL,CACAwjC,GAAa,eAAiB,CAAE,ECjtFhC,MAAM6E,GAAa7E,GCAZ,MAAM8E,WAA2BD,EAAW,CAC/C,YAAYhrC,EAAS,CACjB,MAAMA,CAAO,CAChB,CACL,CCQe,MAAMkrC,EAAe,CAqBhC,YAAYnU,EAAab,EAAal2B,EAAS,CAC3C,IAAI0e,EAAImB,EAAIK,EACZ,KAAK,YAAc6W,EACnB,KAAK,YAAcb,EACnB,MAAMjD,EAAU6D,GAAoBC,CAAW,EAC/C,GAAI,CAACb,EACD,MAAM,IAAI,MAAM,0BAA0B,EAC9C,KAAK,YAAc,IAAI,IAAI,cAAejD,CAAO,EACjD,KAAK,YAAY,SAAW,KAAK,YAAY,SAAS,QAAQ,OAAQ,IAAI,EAC1E,KAAK,QAAU,IAAI,IAAI,UAAWA,CAAO,EACzC,KAAK,WAAa,IAAI,IAAI,aAAcA,CAAO,EAC/C,KAAK,aAAe,IAAI,IAAI,eAAgBA,CAAO,EAEnD,MAAMkY,EAAoB,MAAMlY,EAAQ,SAAS,MAAM,GAAG,EAAE,CAAC,CAAC,cACxDmY,EAAW,CACb,GAAIvV,GACJ,SAAUE,GACV,KAAM,OAAO,OAAO,OAAO,OAAO,GAAID,EAAoB,EAAG,CAAE,WAAYqV,EAAmB,EAC9F,OAAQvV,EACpB,EACc7T,EAAWyU,GAAqBx2B,GAAmD,GAAIorC,CAAQ,EACrG,KAAK,YAAc1sB,EAAKqD,EAAS,KAAK,cAAgB,MAAQrD,IAAO,OAASA,EAAK,GACnF,KAAK,SAAWmB,EAAKkC,EAAS,OAAO,WAAa,MAAQlC,IAAO,OAASA,EAAK,GAC1EkC,EAAS,aAIV,KAAK,YAAcA,EAAS,YAC5B,KAAK,KAAO,IAAI,MAAM,GAAI,CACtB,IAAK,CAACra,EAAGq2B,IAAS,CACd,MAAM,IAAI,MAAM,6GAA6G,OAAOA,CAAI,CAAC,kBAAkB,CAC9J,CACjB,CAAa,GARD,KAAK,KAAO,KAAK,yBAAyB7d,EAAK6B,EAAS,QAAU,MAAQ7B,IAAO,OAASA,EAAK,GAAI,KAAK,QAAS6B,EAAS,OAAO,KAAK,EAU1I,KAAK,MAAQkU,GAAcC,EAAa,KAAK,gBAAgB,KAAK,IAAI,EAAGnU,EAAS,OAAO,KAAK,EAC9F,KAAK,SAAW,KAAK,oBAAoB,OAAO,OAAO,CAAE,QAAS,KAAK,QAAS,YAAa,KAAK,gBAAgB,KAAK,IAAI,CAAC,EAAIA,EAAS,QAAQ,CAAC,EAC9I,KAAK,aAEL,KAAK,YAAa,EACb,KAAMzD,GAAU,KAAK,SAAS,QAAQA,CAAK,CAAC,EAC5C,MAAOuN,KAAmE,EAEnF,KAAK,KAAO,IAAI9H,GAAgB,IAAI,IAAI,UAAWkP,CAAO,EAAE,KAAM,CAC9D,QAAS,KAAK,QACd,OAAQlR,EAAS,GAAG,OACpB,MAAO,KAAK,KACxB,CAAS,EACD,KAAK,QAAU,IAAIspB,GAAsB,KAAK,WAAW,KAAM,KAAK,QAAS,KAAK,MAAyDrrC,GAAQ,OAAO,EACrJ+hB,EAAS,aACV,KAAK,qBAAoB,CAEhC,CAID,IAAI,WAAY,CACZ,OAAO,IAAI5D,GAAgB,KAAK,aAAa,KAAM,CAC/C,QAAS,KAAK,QACd,YAAa,KAAK,KAC9B,CAAS,CACJ,CAMD,KAAK6F,EAAU,CACX,OAAO,KAAK,KAAK,KAAKA,CAAQ,CACjC,CASD,OAAOb,EAAQ,CACX,OAAO,KAAK,KAAK,OAAOA,CAAM,CACjC,CAyBD,IAAIpgB,EAAI8a,EAAO,GAAI7d,EAAU,CACzB,KAAM,GACN,IAAK,GACL,MAAO,MACf,EAAO,CACC,OAAO,KAAK,KAAK,IAAI+C,EAAI8a,EAAM7d,CAAO,CACzC,CAQD,QAAQ6S,EAAM6W,EAAO,CAAE,OAAQ,CAAE,GAAI,CACjC,OAAO,KAAK,SAAS,QAAQ7W,EAAM6W,CAAI,CAC1C,CAID,aAAc,CACV,OAAO,KAAK,SAAS,aACxB,CAOD,cAAcJ,EAAS,CACnB,OAAO,KAAK,SAAS,cAAcA,CAAO,CAC7C,CAID,mBAAoB,CAChB,OAAO,KAAK,SAAS,mBACxB,CACD,MAAM,iBAAkB,CACpB,IAAI5K,EAAImB,EACR,GAAI,KAAK,YACL,OAAO,MAAM,KAAK,cAEtB,KAAM,CAAE,KAAAP,CAAI,EAAK,MAAM,KAAK,KAAK,WAAU,EAC3C,OAAQO,GAAMnB,EAAKY,EAAK,WAAa,MAAQZ,IAAO,OAAS,OAASA,EAAG,gBAAkB,MAAQmB,IAAO,OAASA,EAAK,KAAK,WAChI,CACD,wBAAwB,CAAE,iBAAAyrB,EAAkB,eAAAC,EAAgB,mBAAAC,EAAoB,QAAApQ,EAAS,YAAAqQ,EAAa,WAAA3O,EAAY,SAAA4O,EAAU,KAAAxK,EAAM,MAAAyK,EAAO,aAAAC,CAAY,EAAKxtB,EAASgF,EAAO,CACtK,MAAMqQ,EAAc,CAChB,cAAe,UAAU,KAAK,WAAW,GACzC,OAAQ,GAAG,KAAK,WAAW,EACvC,EACQ,OAAO,IAAIwX,GAAmB,CAC1B,IAAK,KAAK,QAAQ,KAClB,QAAS,OAAO,OAAO,OAAO,OAAO,GAAIxX,CAAW,EAAGrV,CAAO,EAC9D,WAAY0e,EACZ,iBAAAwO,EACA,eAAAC,EACA,mBAAAC,EACA,QAAApQ,EACA,YAAAqQ,EACA,SAAAC,EACA,KAAAxK,EACA,MAAAyK,EACA,aAAAC,EACA,MAAAxoB,EAGA,6BAA8B,OAAO,KAAK,KAAK,OAAO,EAAE,KAAM7hB,GAAQA,EAAI,YAAW,IAAO,eAAe,CACvH,CAAS,CACJ,CACD,oBAAoBvB,EAAS,CACzB,OAAO,IAAImuB,GAAe,KAAK,YAAY,KAAM,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEnuB,CAAO,EAAG,CAAE,OAAQ,OAAO,OAAO,CAAE,OAAQ,KAAK,WAAW,EAAsDA,GAAQ,MAAM,CAAC,CAAE,CAAC,CACxN,CACD,sBAAuB,CAInB,OAHa,KAAK,KAAK,kBAAkB,CAACyR,EAAOotB,IAAY,CACzD,KAAK,oBAAoBptB,EAAO,SAA4DotB,GAAQ,YAAY,CAC5H,CAAS,CAEJ,CACD,oBAAoBptB,EAAOqzB,EAAQxmB,EAAO,EACjC7M,IAAU,mBAAqBA,IAAU,cAC1C,KAAK,qBAAuB6M,GAC5B,KAAK,mBAAqBA,EAC1B,KAAK,SAAS,QAAQA,CAAK,GAEtB7M,IAAU,eACf,KAAK,SAAS,UACVqzB,GAAU,WACV,KAAK,KAAK,UACd,KAAK,mBAAqB,OAEjC,CACL,CCrNO,MAAM+G,GAAe,CAAC9U,EAAab,EAAal2B,IAC5C,IAAIkrC,GAAenU,EAAab,EAAal2B,CAAO,EAG/D,SAAS8rC,IAA+B,CAMpC,GAJI,OAAO,OAAW,KAIlB,OAAO,QAAY,IACnB,MAAO,GAGX,MAAMC,EAAiB,QAAQ,QAC/B,GAAoCA,GAAmB,KACnD,MAAO,GAEX,MAAMC,EAAeD,EAAe,MAAM,WAAW,EACrD,OAAKC,EAGgB,SAASA,EAAa,CAAC,EAAG,EAAE,GAC1B,GAHZ,EAIf,CACIF,KC1CJ,wDACA,IAAIG,IACH,SAAUA,EAAe,CAOtBA,EAAc,cAAmB,gBAQjCA,EAAc,YAAiB,aACnC,GAAGA,KAAkBA,GAAgB,CAAE,EAAC,EACxC,MAAMC,WAA2B,KAAM,CACnC,YAAYprC,EAASutB,EAAM/O,EAAM,CAC7B,MAAMxe,CAAO,EACb,KAAK,QAAUA,EACf,KAAK,KAAOutB,EACZ,KAAK,KAAO/O,CACf,CACL,CACA,MAAM6sB,GAAiBC,GAAQ,CAC3B,IAAI1tB,EAAImB,EACR,OAA8CusB,GAAI,cACvC,UAED,GAAAvsB,GAAMnB,EAA+C0tB,GAAI,UAAY,MAAQ1tB,IAAO,OAAS,OAASA,EAAG,mBAAqB,MAAQmB,IAAO,SAAkBA,EAAG,OACjK,MAGA,KAEf,EAEMwsB,GAAmBD,GAAQ,CAC7B,MAAME,EAAoBF,EAAI,yBAA2B,KACnDG,EAAMH,EAAI,WAAa,GACvBI,EAAWD,EAAI,QAAUA,EAAI,SAAW,GACxCE,EAAc,IACTH,IAAsB,KAAOA,EAAkB,KAAOH,GAAcC,CAAG,EAE5EM,EAAmB,IAAMD,EAAa,IAAK,MAC3CE,EAAqBC,GAAe,CACtC,MAAMC,EAASC,EAAkB,IAAIF,CAAU,EAK/C,MAJoD,GAAAC,GAAO,UAAU,IAAIJ,EAAa,IAIlFM,EAAgBH,CAAU,EAKtC,EACUG,EAAmBH,GAAe,CAAE,IAAIluB,EAAI,OAAQA,EAAK6tB,EAAI,iBAAmB,MAAQ7tB,IAAO,OAAS,OAASA,EAAG,KAAM6K,GAAMA,EAAE,OAASqjB,CAAU,GACrJ/b,EAAeD,GAAQwb,EAAI,QAAQ,MAAMxb,CAAG,EAC5Ckc,EAAoB,IAAI,IACxBE,EAAiB,CAACJ,EAAYK,EAAoB,KAAO,CAC3D,MAAMC,EAAmBJ,EAAkB,IAAIF,CAAU,EACzD,GAAIM,EAEA,OAAOA,EAAiB,MAE5B,MAAMC,EAAWV,IACXW,EAAeL,EAAgBH,CAAU,EAC/C,IAAIS,EACJ,MAAMC,EAA2B,UACzB,CAACD,GAAoBF,KAAYF,EACjCI,EACI,OAAOJ,EAAkBE,CAAQ,GAAM,WAChCE,EAAmB,MAAMJ,EAAkBE,CAAQ,EAAG,EACtDE,EAAmBJ,EAAkBE,CAAQ,EAEnDb,IAAsB,MAAQ,CAACe,GAAoB,QAASJ,IACjEI,EACI,OAAOJ,EAAkB,KAAW,WAC7BI,EAAmB,MAAMJ,EAAkB,IAAQ,EACnDI,EAAmBJ,EAAkB,KAE7CI,GAELE,EAAqB,CAACC,EAAMzP,IAAS,CACvC,IAAIrf,EAAImB,EACR,GAAIutB,EAAc,CACd,MAAMK,EAA2EL,GAAa,QAAQ,KAAMztC,IAAMo+B,IAASp+B,GAAE,IAAI,EACjI,GAAI8tC,EACA,OAAIA,EAAa,QAAU,UACfztC,IAAYusC,EAAI,cAAcK,EAAY7O,EAAK,WAAY/9B,EAAO,EAGnE,CAACA,GAASgX,IAAau1B,EAAI,eAAeK,EAAY7O,EAAK,SAAQ,EAAI/9B,GAASgX,CAAQ,EAGlG,GAAIw2B,EACL,OAAQ9uB,EAAK8uB,EAAKzP,CAAI,KAAO,MAAQrf,IAAO,OAAS,OAASA,EAAG,KAAK8uB,CAAI,CAEjF,KACI,IAAIA,EACL,OAAQ3tB,EAAK2tB,EAAKzP,CAAI,KAAO,MAAQle,IAAO,OAAS,OAASA,EAAG,KAAK2tB,CAAI,EAG1E,MAAM,IAAItB,GAAmB,IAAIU,CAAU,kCAAkCO,CAAQ,GAAIlB,GAAc,aAAa,EAEpI,EACcyB,EAA6B3P,GAAS,CACxC,IAAIzM,EACJ,MAAMqc,EAAU,IAAI9vB,IAAS,CACzB,MAAM+vB,EAAIN,EAAwB,EAAG,KAAME,IAAS,CAChD,MAAMzqC,EAAKwqC,EAAmBC,GAAMzP,CAAI,EACxC,GAAIh7B,EAAI,CACJ,MAAM6qC,GAAI7qC,EAAG,GAAG8a,CAAI,EACpB,OAAAyT,EAA+Csc,IAAE,OAC1CA,EACV,KAEG,OAAM,IAAI1B,GAAmB,IAAIU,CAAU,IAAI7O,CAAI,6BAA6BoP,CAAQ,GAAIlB,GAAc,aAAa,CAE/I,CAAiB,EACD,OAAIlO,IAAS,gBACT6P,EAAE,OAAS,SAAYtc,KAEpBsc,CACvB,EAEY,OAAAD,EAAQ,SAAW,IAAM,GAAG5P,EAAK,SAAQ,CAAE,0BAC3C,OAAO,eAAe4P,EAAS,OAAQ,CACnC,MAAO5P,EACP,SAAU,GACV,aAAc,EAC9B,CAAa,EACM4P,CACnB,EACcE,EAAcH,EAA0B,aAAa,EACrDI,EAAiBJ,EAA0B,gBAAgB,EAC3DK,EAAoB,CAACC,EAAWh3B,IAAa,CAC/C,MAAMi3B,EAAOJ,EAAY,CAAE,UAAAG,CAAW,EAAEh3B,CAAQ,EAC1Csa,EAAS,SAAY,CACvB,MAAM4c,GAAa,MAAMD,EACzBH,EAAe,CACX,UAAAE,EACA,WAAAE,EACH,EAAEl3B,CAAQ,CAC3B,EACkB42B,EAAI,IAAI,QAASphB,IAAYyhB,EAAK,KAAK,IAAMzhB,GAAQ,CAAE,OAAA8E,CAAQ,EAAC,CAAC,EACvE,OAAAsc,EAAE,OAAS,SAAY,CAEnB,MAAMtc,EAAM,CAC5B,EACmBsc,CACnB,EACcO,EAAQ,IAAI,MAAM,GAAI,CACxB,IAAIzmC,EAAGq2B,EAAM,CACT,OAAQA,EAAI,CAER,IAAK,WACD,OACJ,IAAK,SACD,MAAO,KAAO,CAAE,GACpB,IAAK,cACD,OAAOqP,EAAeW,EAAoBF,EAC9C,IAAK,iBACD,OAAOC,EACX,QACI,OAAOJ,EAA0B3P,CAAI,CAC5C,CACJ,CACb,CAAS,EACD,OAAAyO,EAAQI,CAAU,EAAIuB,EACtBrB,EAAkB,IAAIF,EAAY,CAC9B,KAAMA,EACN,MAAAuB,EACA,UAAW,IAAI,IAAI,CAAC,GAAG,OAAO,KAAKlB,CAAiB,EAAG,GAAIG,EAAe,CAACD,CAAQ,EAAI,EAAG,CAAC,CACvG,CAAS,EACMgB,CACf,EAEI,OAAK5B,EAAI,iBACLA,EAAI,eAAkB6B,GAAaA,GAEvC7B,EAAI,YAAcE,EAClBF,EAAI,YAAc1b,EAClB0b,EAAI,iBAAmBG,EACvBH,EAAI,kBAAoBI,EACxBJ,EAAI,eAAiBS,EACrBT,EAAI,UAAYL,GAChBK,EAAI,MAAQ,CAAC,CAACA,EAAI,MAClBA,EAAI,iBAAmB,CAAC,CAACA,EAAI,iBACtBA,CACX,EACM8B,GAAuBjC,GAASA,EAAI,UAAYC,GAAgBD,CAAG,EAEnEkC,GAA0BD,GAAoB,OAAO,WAAe,IACpE,WACA,OAAO,KAAS,IACZ,KACA,OAAO,OAAW,IACd,OACA,OAAO,OAAW,IACd,OACA,EAAE,EACdrB,GAAiBsB,GAAU,eAKjC,MAAMC,EAAU,CACZ,aAAc,CACV,KAAK,UAAY,GACjB,KAAK,uBAAyB,GAC9B,KAAK,gBAAkB,EAC1B,CACD,YAAYP,EAAWQ,EAAc,CACjC,IAAIC,EAAgB,GACF,KAAK,UAAUT,CAAS,IAEtC,KAAK,UAAUA,CAAS,EAAI,GAC5BS,EAAgB,IAEpB,KAAK,UAAUT,CAAS,EAAE,KAAKQ,CAAY,EAG3C,MAAME,EAAiB,KAAK,gBAAgBV,CAAS,EACjDU,GAAkB,CAACA,EAAe,YAClC,KAAK,kBAAkBA,CAAc,EAErCD,GACA,KAAK,8BAA8BT,CAAS,EAEhD,MAAM1c,EAAS,SAAY,KAAK,eAAe0c,EAAWQ,CAAY,EAEtE,OADU,QAAQ,QAAQ,CAAE,OAAAld,CAAQ,EAEvC,CACD,MAAM,oBAAqB,CACvB,KAAK,UAAY,GACjB,UAAWpvB,KAAY,KAAK,gBACxB,KAAK,qBAAqB,KAAK,gBAAgBA,CAAQ,CAAC,EAE5D,KAAK,gBAAkB,EAC1B,CACD,gBAAgB8rC,EAAW1uB,EAAMqvB,EAAqB,CAClD,MAAMC,EAAY,KAAK,UAAUZ,CAAS,EAC1C,GAAI,CAACY,EAAW,CACZ,GAAID,EAAqB,CACrB,IAAI9wB,EAAO,KAAK,uBAAuBmwB,CAAS,EAC3CnwB,IACDA,EAAO,IAEXA,EAAK,KAAKyB,CAAI,EACd,KAAK,uBAAuB0uB,CAAS,EAAInwB,CAC5C,CACD,MACH,CACD+wB,EAAU,QAAS1sC,GAAaA,EAASod,CAAI,CAAC,CACjD,CACD,aAAa0uB,EAAW,CACpB,IAAItvB,EACJ,MAAO,CAAC,EAAG,GAAAA,EAAK,KAAK,UAAUsvB,CAAS,KAAO,MAAQtvB,IAAO,SAAkBA,EAAG,OACtF,CACD,uBAAuBmwB,EAAiBC,EAAiB,CACrD,KAAK,gBAAgBA,CAAe,EAAI,CACpC,WAAY,GACZ,gBAAAD,EACA,gBAAAC,EACA,QAAUr9B,GAAU,CAChB,KAAK,gBAAgBq9B,EAAiBr9B,CAAK,CAC9C,CACb,CACK,CACD,cAAcuU,EAAM,kBAAmB,CACnC,OAAO,IAAIsoB,GAAU,UAAUtoB,EAAKimB,GAAc,aAAa,CAClE,CACD,YAAYjmB,EAAM,gBAAiB,CAC/B,OAAO,IAAIsoB,GAAU,UAAUtoB,EAAKimB,GAAc,WAAW,CAChE,CACD,MAAM,eAAe+B,EAAWQ,EAAc,CAC1C,MAAMI,EAAY,KAAK,UAAUZ,CAAS,EAC1C,GAAI,CAACY,EACD,OAEJ,MAAMxtC,EAAQwtC,EAAU,QAAQJ,CAAY,EAC5C,KAAK,UAAUR,CAAS,EAAE,OAAO5sC,EAAO,CAAC,EAGpC,KAAK,UAAU4sC,CAAS,EAAE,QAC3B,KAAK,qBAAqB,KAAK,gBAAgBA,CAAS,CAAC,CAEhE,CACD,kBAAkBe,EAAQ,CACtB,OAAO,iBAAiBA,EAAO,gBAAiBA,EAAO,OAAO,EAC9DA,EAAO,WAAa,EACvB,CACD,qBAAqBA,EAAQ,CACpBA,IAGL,OAAO,oBAAoBA,EAAO,gBAAiBA,EAAO,OAAO,EACjEA,EAAO,WAAa,GACvB,CACD,8BAA8Bf,EAAW,CACrC,MAAMnwB,EAAO,KAAK,uBAAuBmwB,CAAS,EAC7CnwB,IAGL,OAAO,KAAK,uBAAuBmwB,CAAS,EAC5CnwB,EAAK,QAASmxB,GAAQ,CAClB,KAAK,gBAAgBhB,EAAWgB,CAAG,CAC/C,CAAS,EACJ,CACL,CASA,MAAMC,GAAUxV,GAAQ,mBAAmBA,CAAG,EACzC,QAAQ,uBAAwB,kBAAkB,EAClD,QAAQ,QAAS,MAAM,EAKtByV,GAAUzV,GAAQA,EAAI,QAAQ,mBAAoB,kBAAkB,EAC1E,MAAM0V,WAAkCZ,EAAU,CAC9C,MAAM,YAAa,CACf,MAAMa,EAAU,SAAS,OACnBC,EAAY,GAClB,OAAAD,EAAQ,MAAM,GAAG,EAAE,QAASE,GAAW,CACnC,GAAIA,EAAO,QAAU,EACjB,OAEJ,GAAI,CAAC/tC,EAAKV,CAAK,EAAIyuC,EAAO,QAAQ,IAAK,YAAY,EAAE,MAAM,YAAY,EACvE/tC,EAAM2tC,GAAO3tC,CAAG,EAAE,KAAI,EACtBV,EAAQquC,GAAOruC,CAAK,EAAE,KAAI,EAC1BwuC,EAAU9tC,CAAG,EAAIV,CAC7B,CAAS,EACMwuC,CACV,CACD,MAAM,UAAUrvC,EAAS,CACrB,GAAI,CAEA,MAAMuvC,EAAaN,GAAOjvC,EAAQ,GAAG,EAC/BwvC,EAAeP,GAAOjvC,EAAQ,KAAK,EAEnCyvC,EAAU,cAAczvC,EAAQ,SAAW,IAAI,QAAQ,WAAY,EAAE,CAAC,GACtEyB,GAAQzB,EAAQ,MAAQ,KAAK,QAAQ,QAAS,EAAE,EAChD2hC,EAAS3hC,EAAQ,KAAO,MAAQA,EAAQ,IAAI,OAAS,EAAI,UAAUA,EAAQ,GAAG,GAAK,GACzF,SAAS,OAAS,GAAGuvC,CAAU,IAAIC,GAAgB,EAAE,GAAGC,CAAO,UAAUhuC,CAAI,KAAKkgC,CAAM,GAC3F,OACMh/B,EAAO,CACV,OAAO,QAAQ,OAAOA,CAAK,CAC9B,CACJ,CACD,MAAM,aAAa3C,EAAS,CACxB,GAAI,CACA,SAAS,OAAS,GAAGA,EAAQ,GAAG,cACnC,OACM2C,EAAO,CACV,OAAO,QAAQ,OAAOA,CAAK,CAC9B,CACJ,CACD,MAAM,cAAe,CACjB,GAAI,CACA,MAAMysC,EAAU,SAAS,OAAO,MAAM,GAAG,GAAK,GAC9C,UAAWE,KAAUF,EACjB,SAAS,OAASE,EAAO,QAAQ,MAAO,EAAE,EAAE,QAAQ,MAAO,aAAa,IAAI,KAAI,EAAG,YAAa,UAAS,CAEhH,OACM3sC,EAAO,CACV,OAAO,QAAQ,OAAOA,CAAK,CAC9B,CACJ,CACD,MAAM,iBAAkB,CACpB,GAAI,CACA,MAAM,KAAK,cACd,OACMA,EAAO,CACV,OAAO,QAAQ,OAAOA,CAAK,CAC9B,CACJ,CACL,CACyBqqC,GAAe,mBAAoB,CACxD,IAAK,IAAM,IAAImC,EACnB,CAAC,EAMD,MAAMO,GAAmB,MAAOxgB,GAAS,IAAI,QAAQ,CAAC1C,EAASsE,IAAW,CACtE,MAAM6e,EAAS,IAAI,WACnBA,EAAO,OAAS,IAAM,CAClB,MAAMC,EAAeD,EAAO,OAE5BnjB,EAAQojB,EAAa,QAAQ,GAAG,GAAK,EAAIA,EAAa,MAAM,GAAG,EAAE,CAAC,EAAIA,CAAY,CAC1F,EACID,EAAO,QAAWhtC,GAAUmuB,EAAOnuB,CAAK,EACxCgtC,EAAO,cAAczgB,CAAI,CAC7B,CAAC,EAKK2gB,GAAuB,CAACzxB,EAAU,KAAO,CAC3C,MAAM0xB,EAAe,OAAO,KAAK1xB,CAAO,EAMxC,OALoB,OAAO,KAAKA,CAAO,EAAE,IAAKwP,GAAMA,EAAE,kBAAiB,CAAE,EAC1C,OAAO,CAACrK,EAAKhiB,EAAKH,KAC7CmiB,EAAIhiB,CAAG,EAAI6c,EAAQ0xB,EAAa1uC,CAAK,CAAC,EAC/BmiB,GACR,CAAE,EAET,EAMMwsB,GAAiB,CAACvoC,EAAQwoC,EAAe,KACtCxoC,EAEU,OAAO,QAAQA,CAAM,EAAE,OAAO,CAACyoC,EAAa/4B,IAAU,CACjE,KAAM,CAAC3V,EAAKV,CAAK,EAAIqW,EACrB,IAAIs4B,EACApf,EACJ,OAAI,MAAM,QAAQvvB,CAAK,GACnBuvB,EAAO,GACPvvB,EAAM,QAAS44B,GAAQ,CACnB+V,EAAeQ,EAAe,mBAAmBvW,CAAG,EAAIA,EACxDrJ,GAAQ,GAAG7uB,CAAG,IAAIiuC,CAAY,GAC9C,CAAa,EAEDpf,EAAK,MAAM,EAAG,EAAE,IAGhBof,EAAeQ,EAAe,mBAAmBnvC,CAAK,EAAIA,EAC1DuvB,EAAO,GAAG7uB,CAAG,IAAIiuC,CAAY,IAE1B,GAAGS,CAAW,IAAI7f,CAAI,EAChC,EAAE,EAAE,EAES,OAAO,CAAC,EArBX,KA4BT8f,GAAmB,CAAClwC,EAASmwC,EAAQ,KAAO,CAC9C,MAAM9I,EAAS,OAAO,OAAO,CAAE,OAAQrnC,EAAQ,QAAU,MAAO,QAASA,EAAQ,OAAS,EAAEmwC,CAAK,EAG3Fr9B,EADU+8B,GAAqB7vC,EAAQ,OAAO,EAC/B,cAAc,GAAK,GAExC,GAAI,OAAOA,EAAQ,MAAS,SACxBqnC,EAAO,KAAOrnC,EAAQ,aAGjB8S,EAAK,SAAS,mCAAmC,EAAG,CACzD,MAAMtL,EAAS,IAAI,gBACnB,SAAW,CAACjG,EAAKV,CAAK,IAAK,OAAO,QAAQb,EAAQ,MAAQ,EAAE,EACxDwH,EAAO,IAAIjG,EAAKV,CAAK,EAEzBwmC,EAAO,KAAO7/B,EAAO,UACxB,SACQsL,EAAK,SAAS,qBAAqB,GAAK9S,EAAQ,gBAAgB,SAAU,CAC/E,MAAM4S,EAAO,IAAI,SACjB,GAAI5S,EAAQ,gBAAgB,SACxBA,EAAQ,KAAK,QAAQ,CAACa,EAAOU,IAAQ,CACjCqR,EAAK,OAAOrR,EAAKV,CAAK,CACtC,CAAa,MAGD,WAAWU,KAAO,OAAO,KAAKvB,EAAQ,IAAI,EACtC4S,EAAK,OAAOrR,EAAKvB,EAAQ,KAAKuB,CAAG,CAAC,EAG1C8lC,EAAO,KAAOz0B,EACd,MAAMwL,EAAU,IAAI,QAAQipB,EAAO,OAAO,EAC1CjpB,EAAQ,OAAO,cAAc,EAC7BipB,EAAO,QAAUjpB,CACpB,MACQtL,EAAK,SAAS,kBAAkB,GAAK,OAAO9S,EAAQ,MAAS,YAClEqnC,EAAO,KAAO,KAAK,UAAUrnC,EAAQ,IAAI,GAE7C,OAAOqnC,CACX,EAEA,MAAM+I,WAA+B7B,EAAU,CAK3C,MAAM,QAAQvuC,EAAS,CACnB,MAAMqwC,EAAcH,GAAiBlwC,EAASA,EAAQ,aAAa,EAC7DmqC,EAAY4F,GAAe/vC,EAAQ,OAAQA,EAAQ,qBAAqB,EACxE0C,EAAMynC,EAAY,GAAGnqC,EAAQ,GAAG,IAAImqC,CAAS,GAAKnqC,EAAQ,IAC1Dkf,EAAW,MAAM,MAAMxc,EAAK2tC,CAAW,EACvCrb,EAAc9V,EAAS,QAAQ,IAAI,cAAc,GAAK,GAE5D,GAAI,CAAE,aAAAG,EAAe,MAAQ,EAAGH,EAAS,GAAKlf,EAAU,GAEpDg1B,EAAY,SAAS,kBAAkB,IACvC3V,EAAe,QAEnB,IAAIC,EACA4P,EACJ,OAAQ7P,EAAY,CAChB,IAAK,cACL,IAAK,OACD6P,EAAO,MAAMhQ,EAAS,OACtBI,EAAO,MAAMowB,GAAiBxgB,CAAI,EAClC,MACJ,IAAK,OACD5P,EAAO,MAAMJ,EAAS,OACtB,MACJ,IAAK,WACL,IAAK,OACL,QACII,EAAO,MAAMJ,EAAS,MAC7B,CAED,MAAMd,EAAU,GAChB,OAAAc,EAAS,QAAQ,QAAQ,CAACre,EAAOU,IAAQ,CACrC6c,EAAQ7c,CAAG,EAAIV,CAC3B,CAAS,EACM,CACH,KAAAye,EACA,QAAAlB,EACA,OAAQc,EAAS,OACjB,IAAKA,EAAS,GAC1B,CACK,CAKD,MAAM,IAAIlf,EAAS,CACf,OAAO,KAAK,QAAQ,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAO,EAAG,CAAE,OAAQ,KAAK,CAAE,CAAC,CACnF,CAKD,MAAM,KAAKA,EAAS,CAChB,OAAO,KAAK,QAAQ,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAO,EAAG,CAAE,OAAQ,MAAM,CAAE,CAAC,CACpF,CAKD,MAAM,IAAIA,EAAS,CACf,OAAO,KAAK,QAAQ,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAO,EAAG,CAAE,OAAQ,KAAK,CAAE,CAAC,CACnF,CAKD,MAAM,MAAMA,EAAS,CACjB,OAAO,KAAK,QAAQ,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAO,EAAG,CAAE,OAAQ,OAAO,CAAE,CAAC,CACrF,CAKD,MAAM,OAAOA,EAAS,CAClB,OAAO,KAAK,QAAQ,OAAO,OAAO,OAAO,OAAO,CAAE,EAAEA,CAAO,EAAG,CAAE,OAAQ,QAAQ,CAAE,CAAC,CACtF,CACL,CACK,MAACswC,GAAgBtD,GAAe,gBAAiB,CAClD,IAAK,IAAM,IAAIoD,EACnB,CAAC,EAMD,IAAIG,IACH,SAAUA,EAAiB,CAMxBA,EAAgB,KAAU,OAM1BA,EAAgB,MAAW,QAQ3BA,EAAgB,QAAa,SACjC,GAAGA,KAAoBA,GAAkB,CAAE,EAAC,EAI5C,IAAIC,IACH,SAAUA,EAAe,CAMtBA,EAAc,UAAe,YAM7BA,EAAc,cAAmB,eACrC,GAAGA,KAAkBA,GAAgB,CAAE,EAAC,EACxC,MAAMC,WAA4BlC,EAAU,CACxC,MAAM,UAAW,CACb,KAAK,YAAY,uBAAuB,CAC3C,CACD,MAAM,cAAe,CACjB,KAAK,YAAY,uBAAuB,CAC3C,CACD,MAAM,MAAO,CACT,KAAK,YAAY,uBAAuB,CAC3C,CACD,MAAM,MAAO,CACT,KAAK,YAAY,uBAAuB,CAC3C,CACL,CACmBvB,GAAe,aAAc,CAC5C,IAAK,IAAM,IAAIyD,EACnB,CAAC,EChoBD,MAAMC,GAAM1D,GAAe,MAAO,CAC9B,IAAK,IAAMz5B,EAAA,WAAO,mBAAO,wIAAE,KAAK5T,GAAK,IAAIA,EAAE,MAAQ,CACvD,CAAC,ECFKgxC,GAAU3D,GAAe,UAAW,CACtC,IAAK,IAAMz5B,EAAA,WAAO,mBAAO,wIAAE,KAAK5T,GAAK,IAAIA,EAAE,UAAY,CAC3D,CAAC,ECHM,IAAIixC,GACV,SAAUA,EAAM,CACbA,EAAK,YAAelpC,GAAM,GAC1B,SAASmpC,EAASC,EAAM,CAAG,CAC3BF,EAAK,SAAWC,EAChB,SAASE,EAAYC,EAAI,CACrB,MAAM,IAAI,KACb,CACDJ,EAAK,YAAcG,EACnBH,EAAK,YAAeK,GAAU,CAC1B,MAAMl8B,EAAM,GACZ,UAAWqb,KAAQ6gB,EACfl8B,EAAIqb,CAAI,EAAIA,EAEhB,OAAOrb,CACf,EACI67B,EAAK,mBAAsB77B,GAAQ,CAC/B,MAAMm8B,EAAYN,EAAK,WAAW77B,CAAG,EAAE,OAAQ6Y,GAAM,OAAO7Y,EAAIA,EAAI6Y,CAAC,CAAC,GAAM,QAAQ,EAC9EujB,EAAW,GACjB,UAAWvjB,KAAKsjB,EACZC,EAASvjB,CAAC,EAAI7Y,EAAI6Y,CAAC,EAEvB,OAAOgjB,EAAK,aAAaO,CAAQ,CACzC,EACIP,EAAK,aAAgB77B,GACV67B,EAAK,WAAW77B,CAAG,EAAE,IAAI,SAAU8W,EAAG,CACzC,OAAO9W,EAAI8W,CAAC,CACxB,CAAS,EAEL+kB,EAAK,WAAa,OAAO,OAAO,MAAS,WAClC77B,GAAQ,OAAO,KAAKA,CAAG,EACvB3D,GAAW,CACV,MAAM6D,EAAO,GACb,UAAW1T,KAAO6P,EACV,OAAO,UAAU,eAAe,KAAKA,EAAQ7P,CAAG,GAChD0T,EAAK,KAAK1T,CAAG,EAGrB,OAAO0T,CACnB,EACI27B,EAAK,KAAO,CAAC7nB,EAAKqoB,IAAY,CAC1B,UAAWhhB,KAAQrH,EACf,GAAIqoB,EAAQhhB,CAAI,EACZ,OAAOA,CAGvB,EACIwgB,EAAK,UAAY,OAAO,OAAO,WAAc,WACtC3nB,GAAQ,OAAO,UAAUA,CAAG,EAC5BA,GAAQ,OAAOA,GAAQ,UAAY,OAAO,SAASA,CAAG,GAAK,KAAK,MAAMA,CAAG,IAAMA,EACtF,SAASooB,EAAWjV,EAAOkV,EAAY,MAAO,CAC1C,OAAOlV,EAAM,IAAKnT,GAAS,OAAOA,GAAQ,SAAW,IAAIA,CAAG,IAAMA,CAAI,EAAE,KAAKqoB,CAAS,CACzF,CACDV,EAAK,WAAaS,EAClBT,EAAK,sBAAwB,CAAClpC,EAAG7G,IACzB,OAAOA,GAAU,SACVA,EAAM,WAEVA,CAEf,GAAG+vC,IAASA,EAAO,CAAE,EAAC,EACf,IAAIW,IACV,SAAUA,EAAY,CACnBA,EAAW,YAAc,CAACtsC,EAAOusC,KACtB,CACH,GAAGvsC,EACH,GAAGusC,CACf,EAEA,GAAGD,KAAeA,GAAa,CAAE,EAAC,EAC3B,MAAME,EAAgBb,EAAK,YAAY,CAC1C,SACA,MACA,SACA,UACA,QACA,UACA,OACA,SACA,SACA,WACA,YACA,OACA,QACA,SACA,UACA,UACA,OACA,QACA,MACA,KACJ,CAAC,EACYc,GAAiBpyB,GAAS,CAEnC,OADU,OAAOA,EACR,CACL,IAAK,YACD,OAAOmyB,EAAc,UACzB,IAAK,SACD,OAAOA,EAAc,OACzB,IAAK,SACD,OAAO,OAAO,MAAMnyB,CAAI,EAAImyB,EAAc,IAAMA,EAAc,OAClE,IAAK,UACD,OAAOA,EAAc,QACzB,IAAK,WACD,OAAOA,EAAc,SACzB,IAAK,SACD,OAAOA,EAAc,OACzB,IAAK,SACD,OAAOA,EAAc,OACzB,IAAK,SACD,OAAI,MAAM,QAAQnyB,CAAI,EACXmyB,EAAc,MAErBnyB,IAAS,KACFmyB,EAAc,KAErBnyB,EAAK,MAAQ,OAAOA,EAAK,MAAS,YAAcA,EAAK,OAAS,OAAOA,EAAK,OAAU,WAC7EmyB,EAAc,QAErB,OAAO,IAAQ,KAAenyB,aAAgB,IACvCmyB,EAAc,IAErB,OAAO,IAAQ,KAAenyB,aAAgB,IACvCmyB,EAAc,IAErB,OAAO,KAAS,KAAenyB,aAAgB,KACxCmyB,EAAc,KAElBA,EAAc,OACzB,QACI,OAAOA,EAAc,OAC5B,CACL,ECnIaE,EAAef,EAAK,YAAY,CACzC,eACA,kBACA,SACA,gBACA,8BACA,qBACA,oBACA,oBACA,sBACA,eACA,iBACA,YACA,UACA,6BACA,kBACA,YACJ,CAAC,EAKM,MAAMgB,WAAiB,KAAM,CAChC,IAAI,QAAS,CACT,OAAO,KAAK,MACf,CACD,YAAYC,EAAQ,CAChB,QACA,KAAK,OAAS,GACd,KAAK,SAAYC,GAAQ,CACrB,KAAK,OAAS,CAAC,GAAG,KAAK,OAAQA,CAAG,CAC9C,EACQ,KAAK,UAAY,CAACC,EAAO,KAAO,CAC5B,KAAK,OAAS,CAAC,GAAG,KAAK,OAAQ,GAAGA,CAAI,CAClD,EACQ,MAAMC,EAAc,WAAW,UAC3B,OAAO,eAEP,OAAO,eAAe,KAAMA,CAAW,EAGvC,KAAK,UAAYA,EAErB,KAAK,KAAO,WACZ,KAAK,OAASH,CACjB,CACD,OAAOI,EAAS,CACZ,MAAMC,EAASD,GACX,SAAUE,EAAO,CACb,OAAOA,EAAM,OAC7B,EACcC,EAAc,CAAE,QAAS,IACzBC,EAAgB1vC,GAAU,CAC5B,UAAWwvC,KAASxvC,EAAM,OACtB,GAAIwvC,EAAM,OAAS,gBACfA,EAAM,YAAY,IAAIE,CAAY,UAE7BF,EAAM,OAAS,sBACpBE,EAAaF,EAAM,eAAe,UAE7BA,EAAM,OAAS,oBACpBE,EAAaF,EAAM,cAAc,UAE5BA,EAAM,KAAK,SAAW,EAC3BC,EAAY,QAAQ,KAAKF,EAAOC,CAAK,CAAC,MAErC,CACD,IAAIG,EAAOF,EACPruC,EAAI,EACR,KAAOA,EAAIouC,EAAM,KAAK,QAAQ,CAC1B,MAAM9hB,EAAK8hB,EAAM,KAAKpuC,CAAC,EACNA,IAAMouC,EAAM,KAAK,OAAS,GAYvCG,EAAKjiB,CAAE,EAAIiiB,EAAKjiB,CAAE,GAAK,CAAE,QAAS,IAClCiiB,EAAKjiB,CAAE,EAAE,QAAQ,KAAK6hB,EAAOC,CAAK,CAAC,GAXnCG,EAAKjiB,CAAE,EAAIiiB,EAAKjiB,CAAE,GAAK,CAAE,QAAS,IAatCiiB,EAAOA,EAAKjiB,CAAE,EACdtsB,GACH,CACJ,CAEjB,EACQ,OAAAsuC,EAAa,IAAI,EACVD,CACV,CACD,OAAO,OAAOvxC,EAAO,CACjB,GAAI,EAAEA,aAAiB+wC,IACnB,MAAM,IAAI,MAAM,mBAAmB/wC,CAAK,EAAE,CAEjD,CACD,UAAW,CACP,OAAO,KAAK,OACf,CACD,IAAI,SAAU,CACV,OAAO,KAAK,UAAU,KAAK,OAAQ+vC,EAAK,sBAAuB,CAAC,CACnE,CACD,IAAI,SAAU,CACV,OAAO,KAAK,OAAO,SAAW,CACjC,CACD,QAAQsB,EAAUC,GAAUA,EAAM,QAAS,CACvC,MAAMC,EAAc,GACdG,EAAa,GACnB,UAAWT,KAAO,KAAK,OACnB,GAAIA,EAAI,KAAK,OAAS,EAAG,CACrB,MAAMU,EAAUV,EAAI,KAAK,CAAC,EAC1BM,EAAYI,CAAO,EAAIJ,EAAYI,CAAO,GAAK,GAC/CJ,EAAYI,CAAO,EAAE,KAAKN,EAAOJ,CAAG,CAAC,CACxC,MAEGS,EAAW,KAAKL,EAAOJ,CAAG,CAAC,EAGnC,MAAO,CAAE,WAAAS,EAAY,YAAAH,EACxB,CACD,IAAI,YAAa,CACb,OAAO,KAAK,SACf,CACL,CACAR,GAAS,OAAUC,GACD,IAAID,GAASC,CAAM,EChIrC,MAAMY,GAAW,CAACN,EAAOO,IAAS,CAC9B,IAAI5xC,EACJ,OAAQqxC,EAAM,KAAI,CACd,KAAKR,EAAa,aACVQ,EAAM,WAAaV,EAAc,UACjC3wC,EAAU,WAGVA,EAAU,YAAYqxC,EAAM,QAAQ,cAAcA,EAAM,QAAQ,GAEpE,MACJ,KAAKR,EAAa,gBACd7wC,EAAU,mCAAmC,KAAK,UAAUqxC,EAAM,SAAUvB,EAAK,qBAAqB,CAAC,GACvG,MACJ,KAAKe,EAAa,kBACd7wC,EAAU,kCAAkC8vC,EAAK,WAAWuB,EAAM,KAAM,IAAI,CAAC,GAC7E,MACJ,KAAKR,EAAa,cACd7wC,EAAU,gBACV,MACJ,KAAK6wC,EAAa,4BACd7wC,EAAU,yCAAyC8vC,EAAK,WAAWuB,EAAM,OAAO,CAAC,GACjF,MACJ,KAAKR,EAAa,mBACd7wC,EAAU,gCAAgC8vC,EAAK,WAAWuB,EAAM,OAAO,CAAC,eAAeA,EAAM,QAAQ,IACrG,MACJ,KAAKR,EAAa,kBACd7wC,EAAU,6BACV,MACJ,KAAK6wC,EAAa,oBACd7wC,EAAU,+BACV,MACJ,KAAK6wC,EAAa,aACd7wC,EAAU,eACV,MACJ,KAAK6wC,EAAa,eACV,OAAOQ,EAAM,YAAe,SACxB,aAAcA,EAAM,YACpBrxC,EAAU,gCAAgCqxC,EAAM,WAAW,QAAQ,IAC/D,OAAOA,EAAM,WAAW,UAAa,WACrCrxC,EAAU,GAAGA,CAAO,sDAAsDqxC,EAAM,WAAW,QAAQ,KAGlG,eAAgBA,EAAM,WAC3BrxC,EAAU,mCAAmCqxC,EAAM,WAAW,UAAU,IAEnE,aAAcA,EAAM,WACzBrxC,EAAU,iCAAiCqxC,EAAM,WAAW,QAAQ,IAGpEvB,EAAK,YAAYuB,EAAM,UAAU,EAGhCA,EAAM,aAAe,QAC1BrxC,EAAU,WAAWqxC,EAAM,UAAU,GAGrCrxC,EAAU,UAEd,MACJ,KAAK6wC,EAAa,UACVQ,EAAM,OAAS,QACfrxC,EAAU,sBAAsBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,WAAa,WAAW,IAAIA,EAAM,OAAO,cAChHA,EAAM,OAAS,SACpBrxC,EAAU,uBAAuBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,WAAa,MAAM,IAAIA,EAAM,OAAO,gBAC5GA,EAAM,OAAS,SACpBrxC,EAAU,kBAAkBqxC,EAAM,MAAQ,oBAAsBA,EAAM,UAAY,4BAA8B,eAAe,GAAGA,EAAM,OAAO,GAC1IA,EAAM,OAAS,SACpBrxC,EAAU,kBAAkBqxC,EAAM,MAAQ,oBAAsBA,EAAM,UAAY,4BAA8B,eAAe,GAAGA,EAAM,OAAO,GAC1IA,EAAM,OAAS,OACpBrxC,EAAU,gBAAgBqxC,EAAM,MAAQ,oBAAsBA,EAAM,UAAY,4BAA8B,eAAe,GAAG,IAAI,KAAK,OAAOA,EAAM,OAAO,CAAC,CAAC,GAE/JrxC,EAAU,gBACd,MACJ,KAAK6wC,EAAa,QACVQ,EAAM,OAAS,QACfrxC,EAAU,sBAAsBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,UAAY,WAAW,IAAIA,EAAM,OAAO,cAC/GA,EAAM,OAAS,SACpBrxC,EAAU,uBAAuBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,UAAY,OAAO,IAAIA,EAAM,OAAO,gBAC5GA,EAAM,OAAS,SACpBrxC,EAAU,kBAAkBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,wBAA0B,WAAW,IAAIA,EAAM,OAAO,GACzHA,EAAM,OAAS,SACpBrxC,EAAU,kBAAkBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,wBAA0B,WAAW,IAAIA,EAAM,OAAO,GACzHA,EAAM,OAAS,OACpBrxC,EAAU,gBAAgBqxC,EAAM,MAAQ,UAAYA,EAAM,UAAY,2BAA6B,cAAc,IAAI,IAAI,KAAK,OAAOA,EAAM,OAAO,CAAC,CAAC,GAEpJrxC,EAAU,gBACd,MACJ,KAAK6wC,EAAa,OACd7wC,EAAU,gBACV,MACJ,KAAK6wC,EAAa,2BACd7wC,EAAU,2CACV,MACJ,KAAK6wC,EAAa,gBACd7wC,EAAU,gCAAgCqxC,EAAM,UAAU,GAC1D,MACJ,KAAKR,EAAa,WACd7wC,EAAU,wBACV,MACJ,QACIA,EAAU4xC,EAAK,aACf9B,EAAK,YAAYuB,CAAK,CAC7B,CACD,MAAO,CAAE,QAAArxC,CAAO,CACpB,EACA6xC,GAAeF,GC3Gf,IAAIG,GAAmBD,GAKhB,SAASE,IAAc,CAC1B,OAAOD,EACX,CCNO,MAAME,GAAatrC,GAAW,CACjC,KAAM,CAAE,KAAA8X,EAAM,KAAA7d,EAAM,UAAAsxC,EAAW,UAAAC,CAAS,EAAKxrC,EACvCyrC,EAAW,CAAC,GAAGxxC,EAAM,GAAIuxC,EAAU,MAAQ,CAAE,CAAC,EAC9CE,EAAY,CACd,GAAGF,EACH,KAAMC,CACd,EACI,GAAID,EAAU,UAAY,OACtB,MAAO,CACH,GAAGA,EACH,KAAMC,EACN,QAASD,EAAU,OAC/B,EAEI,IAAIluB,EAAe,GACnB,MAAMquB,EAAOJ,EACR,OAAQpzC,GAAM,CAAC,CAACA,CAAC,EACjB,MAAO,EACP,UACL,UAAWyzC,KAAOD,EACdruB,EAAesuB,EAAIF,EAAW,CAAE,KAAA5zB,EAAM,aAAcwF,CAAY,CAAE,EAAE,QAExE,MAAO,CACH,GAAGkuB,EACH,KAAMC,EACN,QAASnuB,CACjB,CACA,EAEO,SAASuuB,EAAkBlkC,EAAK6jC,EAAW,CAC9C,MAAMM,EAAcT,KACdV,EAAQW,GAAU,CACpB,UAAWE,EACX,KAAM7jC,EAAI,KACV,KAAMA,EAAI,KACV,UAAW,CACPA,EAAI,OAAO,mBACXA,EAAI,eACJmkC,EACAA,IAAgBX,GAAkB,OAAYA,EACjD,EAAC,OAAQnvB,GAAM,CAAC,CAACA,CAAC,CAC3B,CAAK,EACDrU,EAAI,OAAO,OAAO,KAAKgjC,CAAK,CAChC,CACO,MAAMoB,EAAY,CACrB,aAAc,CACV,KAAK,MAAQ,OAChB,CACD,OAAQ,CACA,KAAK,QAAU,UACf,KAAK,MAAQ,QACpB,CACD,OAAQ,CACA,KAAK,QAAU,YACf,KAAK,MAAQ,UACpB,CACD,OAAO,WAAWlzB,EAAQmzB,EAAS,CAC/B,MAAMC,EAAa,GACnB,UAAWttC,KAAKqtC,EAAS,CACrB,GAAIrtC,EAAE,SAAW,UACb,OAAOutC,EACPvtC,EAAE,SAAW,SACbka,EAAO,MAAK,EAChBozB,EAAW,KAAKttC,EAAE,KAAK,CAC1B,CACD,MAAO,CAAE,OAAQka,EAAO,MAAO,MAAOozB,CAAU,CACnD,CACD,aAAa,iBAAiBpzB,EAAQszB,EAAO,CACzC,MAAMC,EAAY,GAClB,UAAWC,KAAQF,EAAO,CACtB,MAAMpyC,EAAM,MAAMsyC,EAAK,IACjBhzC,EAAQ,MAAMgzC,EAAK,MACzBD,EAAU,KAAK,CACX,IAAAryC,EACA,MAAAV,CAChB,CAAa,CACJ,CACD,OAAO0yC,GAAY,gBAAgBlzB,EAAQuzB,CAAS,CACvD,CACD,OAAO,gBAAgBvzB,EAAQszB,EAAO,CAClC,MAAMG,EAAc,GACpB,UAAWD,KAAQF,EAAO,CACtB,KAAM,CAAE,IAAApyC,EAAK,MAAAV,CAAO,EAAGgzC,EAGvB,GAFItyC,EAAI,SAAW,WAEfV,EAAM,SAAW,UACjB,OAAO6yC,EACPnyC,EAAI,SAAW,SACf8e,EAAO,MAAK,EACZxf,EAAM,SAAW,SACjBwf,EAAO,MAAK,EACZ9e,EAAI,QAAU,cAAgB,OAAOV,EAAM,MAAU,KAAegzC,EAAK,aACzEC,EAAYvyC,EAAI,KAAK,EAAIV,EAAM,MAEtC,CACD,MAAO,CAAE,OAAQwf,EAAO,MAAO,MAAOyzB,CAAW,CACpD,CACL,CACO,MAAMJ,EAAU,OAAO,OAAO,CACjC,OAAQ,SACZ,CAAC,EACYK,GAASlzC,IAAW,CAAE,OAAQ,QAAS,MAAAA,CAAK,GAC5CmzC,GAAMnzC,IAAW,CAAE,OAAQ,QAAS,MAAAA,CAAK,GACzCozC,GAAazwB,GAAMA,EAAE,SAAW,UAChC0wB,GAAW1wB,GAAMA,EAAE,SAAW,QAC9B2wB,GAAW3wB,GAAMA,EAAE,SAAW,QAC9B4wB,GAAW5wB,GAAM,OAAO,QAAY,KAAeA,aAAa,QC5GtE,IAAI6wB,GACV,SAAUA,EAAW,CAClBA,EAAU,SAAYvzC,GAAY,OAAOA,GAAY,SAAW,CAAE,QAAAA,CAAO,EAAKA,GAAW,GAEzFuzC,EAAU,SAAYvzC,GAAY,OAAOA,GAAY,SAAWA,EAAUA,GAAS,OACvF,GAAGuzC,IAAcA,EAAY,GAAG,ECAhC,MAAMC,EAAmB,CACrB,YAAYrgB,EAAQpzB,EAAOY,EAAMF,EAAK,CAClC,KAAK,YAAc,GACnB,KAAK,OAAS0yB,EACd,KAAK,KAAOpzB,EACZ,KAAK,MAAQY,EACb,KAAK,KAAOF,CACf,CACD,IAAI,MAAO,CACP,OAAK,KAAK,YAAY,SACd,MAAM,QAAQ,KAAK,IAAI,EACvB,KAAK,YAAY,KAAK,GAAG,KAAK,MAAO,GAAG,KAAK,IAAI,EAGjD,KAAK,YAAY,KAAK,GAAG,KAAK,MAAO,KAAK,IAAI,GAG/C,KAAK,WACf,CACL,CACA,MAAMgzC,GAAe,CAACplC,EAAK7J,IAAW,CAClC,GAAI6uC,GAAQ7uC,CAAM,EACd,MAAO,CAAE,QAAS,GAAM,KAAMA,EAAO,KAAK,EAG1C,GAAI,CAAC6J,EAAI,OAAO,OAAO,OACnB,MAAM,IAAI,MAAM,2CAA2C,EAE/D,MAAO,CACH,QAAS,GACT,IAAI,OAAQ,CACR,GAAI,KAAK,OACL,OAAO,KAAK,OAChB,MAAMxM,EAAQ,IAAIivC,GAASziC,EAAI,OAAO,MAAM,EAC5C,YAAK,OAASxM,EACP,KAAK,MACf,CACb,CAEA,EACA,SAAS6xC,EAAoBhtC,EAAQ,CACjC,GAAI,CAACA,EACD,MAAO,GACX,KAAM,CAAE,SAAAirC,EAAU,mBAAAgC,EAAoB,eAAAC,EAAgB,YAAAC,CAAW,EAAKntC,EACtE,GAAIirC,IAAagC,GAAsBC,GACnC,MAAM,IAAI,MAAM,0FAA0F,EAE9G,OAAIjC,EACO,CAAE,SAAUA,EAAU,YAAAkC,GAa1B,CAAE,SAZS,CAACC,EAAKzlC,IAAQ,CAC5B,KAAM,CAAE,QAAArO,CAAS,EAAG0G,EACpB,OAAIotC,EAAI,OAAS,qBACN,CAAE,QAAS9zC,GAAWqO,EAAI,YAAY,EAE7C,OAAOA,EAAI,KAAS,IACb,CAAE,QAASrO,GAAW4zC,GAAkBvlC,EAAI,YAAY,EAE/DylC,EAAI,OAAS,eACN,CAAE,QAASzlC,EAAI,cACnB,CAAE,QAASrO,GAAW2zC,GAAsBtlC,EAAI,YAAY,CAC3E,EACkC,YAAAwlC,EAClC,CACO,MAAME,CAAQ,CACjB,IAAI,aAAc,CACd,OAAO,KAAK,KAAK,WACpB,CACD,SAASxe,EAAO,CACZ,OAAOqb,GAAcrb,EAAM,IAAI,CAClC,CACD,gBAAgBA,EAAOlnB,EAAK,CACxB,OAAQA,GAAO,CACX,OAAQknB,EAAM,OAAO,OACrB,KAAMA,EAAM,KACZ,WAAYqb,GAAcrb,EAAM,IAAI,EACpC,eAAgB,KAAK,KAAK,SAC1B,KAAMA,EAAM,KACZ,OAAQA,EAAM,MAC1B,CACK,CACD,oBAAoBA,EAAO,CACvB,MAAO,CACH,OAAQ,IAAIkd,GACZ,IAAK,CACD,OAAQld,EAAM,OAAO,OACrB,KAAMA,EAAM,KACZ,WAAYqb,GAAcrb,EAAM,IAAI,EACpC,eAAgB,KAAK,KAAK,SAC1B,KAAMA,EAAM,KACZ,OAAQA,EAAM,MACjB,CACb,CACK,CACD,WAAWA,EAAO,CACd,MAAM/wB,EAAS,KAAK,OAAO+wB,CAAK,EAChC,GAAI+d,GAAQ9uC,CAAM,EACd,MAAM,IAAI,MAAM,wCAAwC,EAE5D,OAAOA,CACV,CACD,YAAY+wB,EAAO,CACf,MAAM/wB,EAAS,KAAK,OAAO+wB,CAAK,EAChC,OAAO,QAAQ,QAAQ/wB,CAAM,CAChC,CACD,MAAMga,EAAM9X,EAAQ,CAChB,MAAMlC,EAAS,KAAK,UAAUga,EAAM9X,CAAM,EAC1C,GAAIlC,EAAO,QACP,OAAOA,EAAO,KAClB,MAAMA,EAAO,KAChB,CACD,UAAUga,EAAM9X,EAAQ,CACpB,MAAM2H,EAAM,CACR,OAAQ,CACJ,OAAQ,CAAE,EACV,MAAO3H,GAAQ,OAAS,GACxB,mBAAoBA,GAAQ,QAC/B,EACD,KAAMA,GAAQ,MAAQ,CAAE,EACxB,eAAgB,KAAK,KAAK,SAC1B,OAAQ,KACR,KAAA8X,EACA,WAAYoyB,GAAcpyB,CAAI,CAC1C,EACcha,EAAS,KAAK,WAAW,CAAE,KAAAga,EAAM,KAAMnQ,EAAI,KAAM,OAAQA,CAAK,GACpE,OAAOolC,GAAaplC,EAAK7J,CAAM,CAClC,CACD,YAAYga,EAAM,CACd,MAAMnQ,EAAM,CACR,OAAQ,CACJ,OAAQ,CAAE,EACV,MAAO,CAAC,CAAC,KAAK,WAAW,EAAE,KAC9B,EACD,KAAM,CAAE,EACR,eAAgB,KAAK,KAAK,SAC1B,OAAQ,KACR,KAAAmQ,EACA,WAAYoyB,GAAcpyB,CAAI,CAC1C,EACQ,GAAI,CAAC,KAAK,WAAW,EAAE,MACnB,GAAI,CACA,MAAMha,EAAS,KAAK,WAAW,CAAE,KAAAga,EAAM,KAAM,GAAI,OAAQnQ,CAAG,CAAE,EAC9D,OAAOglC,GAAQ7uC,CAAM,EACf,CACE,MAAOA,EAAO,KACjB,EACC,CACE,OAAQ6J,EAAI,OAAO,MAC3C,CACa,OACMyhB,EAAK,CACJA,GAAK,SAAS,YAAa,GAAE,SAAS,aAAa,IACnD,KAAK,WAAW,EAAE,MAAQ,IAE9BzhB,EAAI,OAAS,CACT,OAAQ,CAAE,EACV,MAAO,EAC3B,CACa,CAEL,OAAO,KAAK,YAAY,CAAE,KAAAmQ,EAAM,KAAM,GAAI,OAAQnQ,CAAG,CAAE,EAAE,KAAM7J,GAAW6uC,GAAQ7uC,CAAM,EAClF,CACE,MAAOA,EAAO,KACjB,EACC,CACE,OAAQ6J,EAAI,OAAO,MACnC,CAAa,CACR,CACD,MAAM,WAAWmQ,EAAM9X,EAAQ,CAC3B,MAAMlC,EAAS,MAAM,KAAK,eAAega,EAAM9X,CAAM,EACrD,GAAIlC,EAAO,QACP,OAAOA,EAAO,KAClB,MAAMA,EAAO,KAChB,CACD,MAAM,eAAega,EAAM9X,EAAQ,CAC/B,MAAM2H,EAAM,CACR,OAAQ,CACJ,OAAQ,CAAE,EACV,mBAAoB3H,GAAQ,SAC5B,MAAO,EACV,EACD,KAAMA,GAAQ,MAAQ,CAAE,EACxB,eAAgB,KAAK,KAAK,SAC1B,OAAQ,KACR,KAAA8X,EACA,WAAYoyB,GAAcpyB,CAAI,CAC1C,EACcw1B,EAAmB,KAAK,OAAO,CAAE,KAAAx1B,EAAM,KAAMnQ,EAAI,KAAM,OAAQA,CAAK,GACpE7J,EAAS,MAAO8uC,GAAQU,CAAgB,EAAIA,EAAmB,QAAQ,QAAQA,CAAgB,GACrG,OAAOP,GAAaplC,EAAK7J,CAAM,CAClC,CACD,OAAOyvC,EAAOj0C,EAAS,CACnB,MAAMk0C,EAAsB/rB,GACpB,OAAOnoB,GAAY,UAAY,OAAOA,EAAY,IAC3C,CAAE,QAAAA,CAAO,EAEX,OAAOA,GAAY,WACjBA,EAAQmoB,CAAG,EAGXnoB,EAGf,OAAO,KAAK,YAAY,CAACmoB,EAAK9Z,IAAQ,CAClC,MAAM7J,EAASyvC,EAAM9rB,CAAG,EAClBgsB,EAAW,IAAM9lC,EAAI,SAAS,CAChC,KAAMwiC,EAAa,OACnB,GAAGqD,EAAmB/rB,CAAG,CACzC,CAAa,EACD,OAAI,OAAO,QAAY,KAAe3jB,aAAkB,QAC7CA,EAAO,KAAMga,GACXA,EAKM,IAJP21B,IACO,GAKd,EAEA3vC,EAKM,IAJP2vC,IACO,GAKvB,CAAS,CACJ,CACD,WAAWF,EAAOG,EAAgB,CAC9B,OAAO,KAAK,YAAY,CAACjsB,EAAK9Z,IACrB4lC,EAAM9rB,CAAG,EAKH,IAJP9Z,EAAI,SAAS,OAAO+lC,GAAmB,WAAaA,EAAejsB,EAAK9Z,CAAG,EAAI+lC,CAAc,EACtF,GAKd,CACJ,CACD,YAAYC,EAAY,CACpB,OAAO,IAAIC,GAAW,CAClB,OAAQ,KACR,SAAUC,EAAsB,WAChC,OAAQ,CAAE,KAAM,aAAc,WAAAF,CAAY,CACtD,CAAS,CACJ,CACD,YAAYA,EAAY,CACpB,OAAO,KAAK,YAAYA,CAAU,CACrC,CACD,YAAYG,EAAK,CAEb,KAAK,IAAM,KAAK,eAChB,KAAK,KAAOA,EACZ,KAAK,MAAQ,KAAK,MAAM,KAAK,IAAI,EACjC,KAAK,UAAY,KAAK,UAAU,KAAK,IAAI,EACzC,KAAK,WAAa,KAAK,WAAW,KAAK,IAAI,EAC3C,KAAK,eAAiB,KAAK,eAAe,KAAK,IAAI,EACnD,KAAK,IAAM,KAAK,IAAI,KAAK,IAAI,EAC7B,KAAK,OAAS,KAAK,OAAO,KAAK,IAAI,EACnC,KAAK,WAAa,KAAK,WAAW,KAAK,IAAI,EAC3C,KAAK,YAAc,KAAK,YAAY,KAAK,IAAI,EAC7C,KAAK,SAAW,KAAK,SAAS,KAAK,IAAI,EACvC,KAAK,SAAW,KAAK,SAAS,KAAK,IAAI,EACvC,KAAK,QAAU,KAAK,QAAQ,KAAK,IAAI,EACrC,KAAK,MAAQ,KAAK,MAAM,KAAK,IAAI,EACjC,KAAK,QAAU,KAAK,QAAQ,KAAK,IAAI,EACrC,KAAK,GAAK,KAAK,GAAG,KAAK,IAAI,EAC3B,KAAK,IAAM,KAAK,IAAI,KAAK,IAAI,EAC7B,KAAK,UAAY,KAAK,UAAU,KAAK,IAAI,EACzC,KAAK,MAAQ,KAAK,MAAM,KAAK,IAAI,EACjC,KAAK,QAAU,KAAK,QAAQ,KAAK,IAAI,EACrC,KAAK,MAAQ,KAAK,MAAM,KAAK,IAAI,EACjC,KAAK,SAAW,KAAK,SAAS,KAAK,IAAI,EACvC,KAAK,KAAO,KAAK,KAAK,KAAK,IAAI,EAC/B,KAAK,SAAW,KAAK,SAAS,KAAK,IAAI,EACvC,KAAK,WAAa,KAAK,WAAW,KAAK,IAAI,EAC3C,KAAK,WAAa,KAAK,WAAW,KAAK,IAAI,EAC3C,KAAK,WAAW,EAAI,CAChB,QAAS,EACT,OAAQ,MACR,SAAWh2B,GAAS,KAAK,WAAW,EAAEA,CAAI,CACtD,CACK,CACD,UAAW,CACP,OAAOi2B,GAAY,OAAO,KAAM,KAAK,IAAI,CAC5C,CACD,UAAW,CACP,OAAOC,GAAY,OAAO,KAAM,KAAK,IAAI,CAC5C,CACD,SAAU,CACN,OAAO,KAAK,WAAW,UAC1B,CACD,OAAQ,CACJ,OAAOC,GAAS,OAAO,IAAI,CAC9B,CACD,SAAU,CACN,OAAOC,GAAW,OAAO,KAAM,KAAK,IAAI,CAC3C,CACD,GAAGC,EAAQ,CACP,OAAOC,GAAS,OAAO,CAAC,KAAMD,CAAM,EAAG,KAAK,IAAI,CACnD,CACD,IAAIE,EAAU,CACV,OAAOC,GAAgB,OAAO,KAAMD,EAAU,KAAK,IAAI,CAC1D,CACD,UAAU/iB,EAAW,CACjB,OAAO,IAAIsiB,GAAW,CAClB,GAAGZ,EAAoB,KAAK,IAAI,EAChC,OAAQ,KACR,SAAUa,EAAsB,WAChC,OAAQ,CAAE,KAAM,YAAa,UAAAviB,CAAW,CACpD,CAAS,CACJ,CACD,QAAQwiB,EAAK,CACT,MAAMS,EAAmB,OAAOT,GAAQ,WAAaA,EAAM,IAAMA,EACjE,OAAO,IAAIU,GAAW,CAClB,GAAGxB,EAAoB,KAAK,IAAI,EAChC,UAAW,KACX,aAAcuB,EACd,SAAUV,EAAsB,UAC5C,CAAS,CACJ,CACD,OAAQ,CACJ,OAAO,IAAIY,GAAW,CAClB,SAAUZ,EAAsB,WAChC,KAAM,KACN,GAAGb,EAAoB,KAAK,IAAI,CAC5C,CAAS,CACJ,CACD,MAAMc,EAAK,CACP,MAAMY,EAAiB,OAAOZ,GAAQ,WAAaA,EAAM,IAAMA,EAC/D,OAAO,IAAIa,GAAS,CAChB,GAAG3B,EAAoB,KAAK,IAAI,EAChC,UAAW,KACX,WAAY0B,EACZ,SAAUb,EAAsB,QAC5C,CAAS,CACJ,CACD,SAASV,EAAa,CAClB,MAAMyB,EAAO,KAAK,YAClB,OAAO,IAAIA,EAAK,CACZ,GAAG,KAAK,KACR,YAAAzB,CACZ,CAAS,CACJ,CACD,KAAKhjC,EAAQ,CACT,OAAO0kC,GAAY,OAAO,KAAM1kC,CAAM,CACzC,CACD,UAAW,CACP,OAAO2kC,GAAY,OAAO,IAAI,CACjC,CACD,YAAa,CACT,OAAO,KAAK,UAAU,MAAS,EAAE,OACpC,CACD,YAAa,CACT,OAAO,KAAK,UAAU,IAAI,EAAE,OAC/B,CACL,CACA,MAAMC,GAAY,iBACZC,GAAa,cACbC,GAAY,4BAGZC,GAAY,yFACZC,GAAc,oBACdC,GAAW,mDACXC,GAAgB,2SAahBC,GAAa,qFAIbC,GAAc,uDACpB,IAAIC,GAEJ,MAAMC,GAAY,sHACZC,GAAgB,2IAGhBC,GAAY,wpBACZC,GAAgB,0rBAEhBC,GAAc,mEAEdC,GAAiB,yEAMjBC,GAAkB,oMAClBC,GAAY,IAAI,OAAO,IAAID,EAAe,GAAG,EACnD,SAASE,GAAgB55B,EAAM,CAC3B,IAAI65B,EAAqB,WACrB75B,EAAK,UACL65B,EAAqB,GAAGA,CAAkB,UAAU75B,EAAK,SAAS,IAE7DA,EAAK,WAAa,OACvB65B,EAAqB,GAAGA,CAAkB,cAE9C,MAAMC,EAAoB95B,EAAK,UAAY,IAAM,IACjD,MAAO,8BAA8B65B,CAAkB,IAAIC,CAAiB,EAChF,CACA,SAASC,GAAU/5B,EAAM,CACrB,OAAO,IAAI,OAAO,IAAI45B,GAAgB55B,CAAI,CAAC,GAAG,CAClD,CAEO,SAASg6B,GAAch6B,EAAM,CAChC,IAAIi6B,EAAQ,GAAGP,EAAe,IAAIE,GAAgB55B,CAAI,CAAC,GACvD,MAAM6L,EAAO,GACb,OAAAA,EAAK,KAAK7L,EAAK,MAAQ,KAAO,GAAG,EAC7BA,EAAK,QACL6L,EAAK,KAAK,sBAAsB,EACpCouB,EAAQ,GAAGA,CAAK,IAAIpuB,EAAK,KAAK,GAAG,CAAC,IAC3B,IAAI,OAAO,IAAIouB,CAAK,GAAG,CAClC,CACA,SAASC,GAAUC,EAAI/yB,EAAS,CAI5B,MAHK,IAAAA,IAAY,MAAQ,CAACA,IAAYgyB,GAAU,KAAKe,CAAE,IAGlD/yB,IAAY,MAAQ,CAACA,IAAYkyB,GAAU,KAAKa,CAAE,EAI3D,CACA,SAASC,GAAWpY,EAAKnC,EAAK,CAC1B,GAAI,CAACkZ,GAAS,KAAK/W,CAAG,EAClB,MAAO,GACX,GAAI,CACA,KAAM,CAAClZ,CAAM,EAAIkZ,EAAI,MAAM,GAAG,EAC9B,GAAI,CAAClZ,EACD,MAAO,GAEX,MAAMuxB,EAASvxB,EACV,QAAQ,KAAM,GAAG,EACjB,QAAQ,KAAM,GAAG,EACjB,OAAOA,EAAO,QAAW,EAAKA,EAAO,OAAS,GAAM,EAAI,GAAG,EAC1D3iB,EAAU,KAAK,MAAM,KAAKk0C,CAAM,CAAC,EAOvC,MANI,SAAOl0C,GAAY,UAAYA,IAAY,MAE3C,QAASA,GAAWA,GAAS,MAAQ,OAErC,CAACA,EAAQ,KAET05B,GAAO15B,EAAQ,MAAQ05B,EAG9B,MACK,CACF,MAAO,EACV,CACL,CACA,SAASya,GAAYH,EAAI/yB,EAAS,CAI9B,MAHK,IAAAA,IAAY,MAAQ,CAACA,IAAYiyB,GAAc,KAAKc,CAAE,IAGtD/yB,IAAY,MAAQ,CAACA,IAAYmyB,GAAc,KAAKY,CAAE,EAI/D,CACO,MAAMI,WAAkBvD,CAAQ,CACnC,OAAOxe,EAAO,CAKV,GAJI,KAAK,KAAK,SACVA,EAAM,KAAO,OAAOA,EAAM,IAAI,GAEf,KAAK,SAASA,CAAK,IACnBob,EAAc,OAAQ,CACrC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,OACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,MAAMrzB,EAAS,IAAIkzB,GACnB,IAAIpkC,EACJ,UAAW4lC,KAAS,KAAK,KAAK,OAC1B,GAAIA,EAAM,OAAS,MACX1e,EAAM,KAAK,OAAS0e,EAAM,QAC1B5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAASoD,EAAM,MACf,KAAM,SACN,UAAW,GACX,MAAO,GACP,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,MAChB1e,EAAM,KAAK,OAAS0e,EAAM,QAC1B5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAASoD,EAAM,MACf,KAAM,SACN,UAAW,GACX,MAAO,GACP,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,SAAU,CAC9B,MAAMsD,EAAShiB,EAAM,KAAK,OAAS0e,EAAM,MACnCuD,EAAWjiB,EAAM,KAAK,OAAS0e,EAAM,OACvCsD,GAAUC,KACVnpC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACjCkpC,EACAhF,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAASoD,EAAM,MACf,KAAM,SACN,UAAW,GACX,MAAO,GACP,QAASA,EAAM,OAC3C,CAAyB,EAEIuD,GACLjF,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAASoD,EAAM,MACf,KAAM,SACN,UAAW,GACX,MAAO,GACP,QAASA,EAAM,OAC3C,CAAyB,EAEL10B,EAAO,MAAK,EAEnB,SACQ00B,EAAM,OAAS,QACf+B,GAAW,KAAKzgB,EAAM,IAAI,IAC3BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,QACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,QACfiC,KACDA,GAAa,IAAI,OAAOD,GAAa,GAAG,GAEvCC,GAAW,KAAK3gB,EAAM,IAAI,IAC3BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,QACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,OACf2B,GAAU,KAAKrgB,EAAM,IAAI,IAC1BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,OACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,SACf4B,GAAY,KAAKtgB,EAAM,IAAI,IAC5BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,SACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,OACfwB,GAAU,KAAKlgB,EAAM,IAAI,IAC1BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,OACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,QACfyB,GAAW,KAAKngB,EAAM,IAAI,IAC3BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,QACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,OACf0B,GAAU,KAAKpgB,EAAM,IAAI,IAC1BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,OACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,WAGX00B,EAAM,OAAS,MACpB,GAAI,CACA,IAAI,IAAI1e,EAAM,IAAI,CACrB,MACK,CACFlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,MACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,CACf,MAEI00B,EAAM,OAAS,SACpBA,EAAM,MAAM,UAAY,EACLA,EAAM,MAAM,KAAK1e,EAAM,IAAI,IAE1ClnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,QACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,IAGX00B,EAAM,OAAS,OACpB1e,EAAM,KAAOA,EAAM,KAAK,KAAI,EAEvB0e,EAAM,OAAS,WACf1e,EAAM,KAAK,SAAS0e,EAAM,MAAOA,EAAM,QAAQ,IAChD5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,eACnB,WAAY,CAAE,SAAUoD,EAAM,MAAO,SAAUA,EAAM,QAAU,EAC/D,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,cACpB1e,EAAM,KAAOA,EAAM,KAAK,YAAW,EAE9B0e,EAAM,OAAS,cACpB1e,EAAM,KAAOA,EAAM,KAAK,YAAW,EAE9B0e,EAAM,OAAS,aACf1e,EAAM,KAAK,WAAW0e,EAAM,KAAK,IAClC5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,eACnB,WAAY,CAAE,WAAYoD,EAAM,KAAO,EACvC,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,WACf1e,EAAM,KAAK,SAAS0e,EAAM,KAAK,IAChC5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,eACnB,WAAY,CAAE,SAAUoD,EAAM,KAAO,EACrC,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,WACN8C,GAAc9C,CAAK,EACtB,KAAK1e,EAAM,IAAI,IACtBlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,eACnB,WAAY,WACZ,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,OACNyC,GACH,KAAKnhB,EAAM,IAAI,IACtBlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,eACnB,WAAY,OACZ,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,OACN6C,GAAU7C,CAAK,EAClB,KAAK1e,EAAM,IAAI,IACtBlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,eACnB,WAAY,OACZ,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,WACf8B,GAAc,KAAKxgB,EAAM,IAAI,IAC9BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,WACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,KACfgD,GAAU1hB,EAAM,KAAM0e,EAAM,OAAO,IACpC5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,KACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,MACfkD,GAAW5hB,EAAM,KAAM0e,EAAM,GAAG,IACjC5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,MACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,OACfoD,GAAY9hB,EAAM,KAAM0e,EAAM,OAAO,IACtC5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,OACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,SACfsC,GAAY,KAAKhhB,EAAM,IAAI,IAC5BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,SACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,YACfuC,GAAe,KAAKjhB,EAAM,IAAI,IAC/BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,WAAY,YACZ,KAAMwiC,EAAa,eACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAIhBuwB,EAAK,YAAYmE,CAAK,EAG9B,MAAO,CAAE,OAAQ10B,EAAO,MAAO,MAAOgW,EAAM,KAC/C,CACD,OAAOyhB,EAAOS,EAAYz3C,EAAS,CAC/B,OAAO,KAAK,WAAYwe,GAASw4B,EAAM,KAAKx4B,CAAI,EAAG,CAC/C,WAAAi5B,EACA,KAAM5G,EAAa,eACnB,GAAG0C,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,UAAUi0C,EAAO,CACb,OAAO,IAAIqD,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQrD,CAAK,CAC/C,CAAS,CACJ,CACD,MAAMj0C,EAAS,CACX,OAAO,KAAK,UAAU,CAAE,KAAM,QAAS,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CAC1E,CACD,IAAIA,EAAS,CACT,OAAO,KAAK,UAAU,CAAE,KAAM,MAAO,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CACxE,CACD,MAAMA,EAAS,CACX,OAAO,KAAK,UAAU,CAAE,KAAM,QAAS,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CAC1E,CACD,KAAKA,EAAS,CACV,OAAO,KAAK,UAAU,CAAE,KAAM,OAAQ,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CACzE,CACD,OAAOA,EAAS,CACZ,OAAO,KAAK,UAAU,CAAE,KAAM,SAAU,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CAC3E,CACD,KAAKA,EAAS,CACV,OAAO,KAAK,UAAU,CAAE,KAAM,OAAQ,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CACzE,CACD,MAAMA,EAAS,CACX,OAAO,KAAK,UAAU,CAAE,KAAM,QAAS,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CAC1E,CACD,KAAKA,EAAS,CACV,OAAO,KAAK,UAAU,CAAE,KAAM,OAAQ,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CACzE,CACD,OAAOA,EAAS,CACZ,OAAO,KAAK,UAAU,CAAE,KAAM,SAAU,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CAC3E,CACD,UAAUA,EAAS,CAEf,OAAO,KAAK,UAAU,CAClB,KAAM,YACN,GAAGuzC,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,IAAId,EAAS,CACT,OAAO,KAAK,UAAU,CAAE,KAAM,MAAO,GAAGq0C,EAAU,SAASr0C,CAAO,CAAC,CAAE,CACxE,CACD,GAAGA,EAAS,CACR,OAAO,KAAK,UAAU,CAAE,KAAM,KAAM,GAAGq0C,EAAU,SAASr0C,CAAO,CAAC,CAAE,CACvE,CACD,KAAKA,EAAS,CACV,OAAO,KAAK,UAAU,CAAE,KAAM,OAAQ,GAAGq0C,EAAU,SAASr0C,CAAO,CAAC,CAAE,CACzE,CACD,SAASA,EAAS,CACd,OAAI,OAAOA,GAAY,SACZ,KAAK,UAAU,CAClB,KAAM,WACN,UAAW,KACX,OAAQ,GACR,MAAO,GACP,QAASA,CACzB,CAAa,EAEE,KAAK,UAAU,CAClB,KAAM,WACN,UAAW,OAAOA,GAAS,UAAc,IAAc,KAAOA,GAAS,UACvE,OAAQA,GAAS,QAAU,GAC3B,MAAOA,GAAS,OAAS,GACzB,GAAGq0C,EAAU,SAASr0C,GAAS,OAAO,CAClD,CAAS,CACJ,CACD,KAAKc,EAAS,CACV,OAAO,KAAK,UAAU,CAAE,KAAM,OAAQ,QAAAA,CAAO,CAAE,CAClD,CACD,KAAKd,EAAS,CACV,OAAI,OAAOA,GAAY,SACZ,KAAK,UAAU,CAClB,KAAM,OACN,UAAW,KACX,QAASA,CACzB,CAAa,EAEE,KAAK,UAAU,CAClB,KAAM,OACN,UAAW,OAAOA,GAAS,UAAc,IAAc,KAAOA,GAAS,UACvE,GAAGq0C,EAAU,SAASr0C,GAAS,OAAO,CAClD,CAAS,CACJ,CACD,SAASc,EAAS,CACd,OAAO,KAAK,UAAU,CAAE,KAAM,WAAY,GAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CAAE,CAC7E,CACD,MAAMg3C,EAAOh3C,EAAS,CAClB,OAAO,KAAK,UAAU,CAClB,KAAM,QACN,MAAOg3C,EACP,GAAGzD,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,SAASD,EAAOb,EAAS,CACrB,OAAO,KAAK,UAAU,CAClB,KAAM,WACN,MAAOa,EACP,SAAUb,GAAS,SACnB,GAAGq0C,EAAU,SAASr0C,GAAS,OAAO,CAClD,CAAS,CACJ,CACD,WAAWa,EAAOC,EAAS,CACvB,OAAO,KAAK,UAAU,CAClB,KAAM,aACN,MAAOD,EACP,GAAGwzC,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,SAASD,EAAOC,EAAS,CACrB,OAAO,KAAK,UAAU,CAClB,KAAM,WACN,MAAOD,EACP,GAAGwzC,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,IAAI03C,EAAW13C,EAAS,CACpB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO03C,EACP,GAAGnE,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,IAAI23C,EAAW33C,EAAS,CACpB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO23C,EACP,GAAGpE,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CACD,OAAO43C,EAAK53C,EAAS,CACjB,OAAO,KAAK,UAAU,CAClB,KAAM,SACN,MAAO43C,EACP,GAAGrE,EAAU,SAASvzC,CAAO,CACzC,CAAS,CACJ,CAID,SAASA,EAAS,CACd,OAAO,KAAK,IAAI,EAAGuzC,EAAU,SAASvzC,CAAO,CAAC,CACjD,CACD,MAAO,CACH,OAAO,IAAIs3C,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQ,CAAE,KAAM,OAAQ,CAC1D,CAAS,CACJ,CACD,aAAc,CACV,OAAO,IAAIA,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQ,CAAE,KAAM,cAAe,CACjE,CAAS,CACJ,CACD,aAAc,CACV,OAAO,IAAIA,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQ,CAAE,KAAM,cAAe,CACjE,CAAS,CACJ,CACD,IAAI,YAAa,CACb,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMO,GAAOA,EAAG,OAAS,UAAU,CAChE,CACD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,MAAM,CAC5D,CACD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,MAAM,CAC5D,CACD,IAAI,YAAa,CACb,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,UAAU,CAChE,CACD,IAAI,SAAU,CACV,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,OAAO,CAC7D,CACD,IAAI,OAAQ,CACR,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,KAAK,CAC3D,CACD,IAAI,SAAU,CACV,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,OAAO,CAC7D,CACD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,MAAM,CAC5D,CACD,IAAI,UAAW,CACX,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,QAAQ,CAC9D,CACD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,MAAM,CAC5D,CACD,IAAI,SAAU,CACV,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,OAAO,CAC7D,CACD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,MAAM,CAC5D,CACD,IAAI,MAAO,CACP,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,IAAI,CAC1D,CACD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,MAAM,CAC5D,CACD,IAAI,UAAW,CACX,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,QAAQ,CAC9D,CACD,IAAI,aAAc,CAEd,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMA,GAAOA,EAAG,OAAS,WAAW,CACjE,CACD,IAAI,WAAY,CACZ,IAAIC,EAAM,KACV,UAAWD,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRC,IAAQ,MAAQD,EAAG,MAAQC,KAC3BA,EAAMD,EAAG,OAGrB,OAAOC,CACV,CACD,IAAI,WAAY,CACZ,IAAIC,EAAM,KACV,UAAWF,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRE,IAAQ,MAAQF,EAAG,MAAQE,KAC3BA,EAAMF,EAAG,OAGrB,OAAOE,CACV,CACL,CACAT,GAAU,OAAU5wC,GACT,IAAI4wC,GAAU,CACjB,OAAQ,CAAE,EACV,SAAU/C,EAAsB,UAChC,OAAQ7tC,GAAQ,QAAU,GAC1B,GAAGgtC,EAAoBhtC,CAAM,CACrC,CAAK,EAGL,SAASsxC,GAAmB7vB,EAAK8vB,EAAM,CACnC,MAAMC,GAAe/vB,EAAI,WAAW,MAAM,GAAG,EAAE,CAAC,GAAK,IAAI,OACnDgwB,GAAgBF,EAAK,WAAW,MAAM,GAAG,EAAE,CAAC,GAAK,IAAI,OACrDG,EAAWF,EAAcC,EAAeD,EAAcC,EACtDE,EAAS,OAAO,SAASlwB,EAAI,QAAQiwB,CAAQ,EAAE,QAAQ,IAAK,EAAE,CAAC,EAC/DE,EAAU,OAAO,SAASL,EAAK,QAAQG,CAAQ,EAAE,QAAQ,IAAK,EAAE,CAAC,EACvE,OAAQC,EAASC,EAAW,IAAMF,CACtC,CACO,MAAMG,WAAkBxE,CAAQ,CACnC,aAAc,CACV,MAAM,GAAG,SAAS,EAClB,KAAK,IAAM,KAAK,IAChB,KAAK,IAAM,KAAK,IAChB,KAAK,KAAO,KAAK,UACpB,CACD,OAAOxe,EAAO,CAKV,GAJI,KAAK,KAAK,SACVA,EAAM,KAAO,OAAOA,EAAM,IAAI,GAEf,KAAK,SAASA,CAAK,IACnBob,EAAc,OAAQ,CACrC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,OACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,IAAIvkC,EACJ,MAAMkR,EAAS,IAAIkzB,GACnB,UAAWwB,KAAS,KAAK,KAAK,OACtBA,EAAM,OAAS,MACVnE,EAAK,UAAUva,EAAM,IAAI,IAC1BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAU,UACV,SAAU,QACV,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,OACHA,EAAM,UAAY1e,EAAM,KAAO0e,EAAM,MAAQ1e,EAAM,MAAQ0e,EAAM,SAE9E5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAASoD,EAAM,MACf,KAAM,SACN,UAAWA,EAAM,UACjB,MAAO,GACP,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,OACLA,EAAM,UAAY1e,EAAM,KAAO0e,EAAM,MAAQ1e,EAAM,MAAQ0e,EAAM,SAE5E5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAASoD,EAAM,MACf,KAAM,SACN,UAAWA,EAAM,UACjB,MAAO,GACP,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,aAChB+D,GAAmBziB,EAAM,KAAM0e,EAAM,KAAK,IAAM,IAChD5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,gBACnB,WAAYoD,EAAM,MAClB,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,SACf,OAAO,SAAS1e,EAAM,IAAI,IAC3BlnB,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,WACnB,QAASoD,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAIhBuwB,EAAK,YAAYmE,CAAK,EAG9B,MAAO,CAAE,OAAQ10B,EAAO,MAAO,MAAOgW,EAAM,KAC/C,CACD,IAAIx1B,EAAOC,EAAS,CAChB,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAMwzC,EAAU,SAASvzC,CAAO,CAAC,CACvE,CACD,GAAGD,EAAOC,EAAS,CACf,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAOwzC,EAAU,SAASvzC,CAAO,CAAC,CACxE,CACD,IAAID,EAAOC,EAAS,CAChB,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAMwzC,EAAU,SAASvzC,CAAO,CAAC,CACvE,CACD,GAAGD,EAAOC,EAAS,CACf,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAOwzC,EAAU,SAASvzC,CAAO,CAAC,CACxE,CACD,SAASqmB,EAAMtmB,EAAOy4C,EAAWx4C,EAAS,CACtC,OAAO,IAAIu4C,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CACJ,GAAG,KAAK,KAAK,OACb,CACI,KAAAlyB,EACA,MAAAtmB,EACA,UAAAy4C,EACA,QAASjF,EAAU,SAASvzC,CAAO,CACtC,CACJ,CACb,CAAS,CACJ,CACD,UAAUi0C,EAAO,CACb,OAAO,IAAIsE,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQtE,CAAK,CAC/C,CAAS,CACJ,CACD,IAAIj0C,EAAS,CACT,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,SAASA,EAAS,CACd,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,EACP,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,SAASA,EAAS,CACd,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,EACP,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,YAAYA,EAAS,CACjB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,EACP,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,YAAYA,EAAS,CACjB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,EACP,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,WAAWD,EAAOC,EAAS,CACvB,OAAO,KAAK,UAAU,CAClB,KAAM,aACN,MAAOD,EACP,QAASwzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,OAAOA,EAAS,CACZ,OAAO,KAAK,UAAU,CAClB,KAAM,SACN,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,KAAKA,EAAS,CACV,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,UAAW,GACX,MAAO,OAAO,iBACd,QAASuzC,EAAU,SAASvzC,CAAO,CACtC,GAAE,UAAU,CACT,KAAM,MACN,UAAW,GACX,MAAO,OAAO,iBACd,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,IAAI,UAAW,CACX,IAAI83C,EAAM,KACV,UAAWD,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRC,IAAQ,MAAQD,EAAG,MAAQC,KAC3BA,EAAMD,EAAG,OAGrB,OAAOC,CACV,CACD,IAAI,UAAW,CACX,IAAIC,EAAM,KACV,UAAWF,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRE,IAAQ,MAAQF,EAAG,MAAQE,KAC3BA,EAAMF,EAAG,OAGrB,OAAOE,CACV,CACD,IAAI,OAAQ,CACR,MAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAMF,GAAOA,EAAG,OAAS,OAAUA,EAAG,OAAS,cAAgB/H,EAAK,UAAU+H,EAAG,KAAK,CAAE,CACrH,CACD,IAAI,UAAW,CACX,IAAIE,EAAM,KACND,EAAM,KACV,UAAWD,KAAM,KAAK,KAAK,OAAQ,CAC/B,GAAIA,EAAG,OAAS,UAAYA,EAAG,OAAS,OAASA,EAAG,OAAS,aACzD,MAAO,GAEFA,EAAG,OAAS,OACbC,IAAQ,MAAQD,EAAG,MAAQC,KAC3BA,EAAMD,EAAG,OAERA,EAAG,OAAS,QACbE,IAAQ,MAAQF,EAAG,MAAQE,KAC3BA,EAAMF,EAAG,MAEpB,CACD,OAAO,OAAO,SAASC,CAAG,GAAK,OAAO,SAASC,CAAG,CACrD,CACL,CACAQ,GAAU,OAAU7xC,GACT,IAAI6xC,GAAU,CACjB,OAAQ,CAAE,EACV,SAAUhE,EAAsB,UAChC,OAAQ7tC,GAAQ,QAAU,GAC1B,GAAGgtC,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAM+xC,WAAkB1E,CAAQ,CACnC,aAAc,CACV,MAAM,GAAG,SAAS,EAClB,KAAK,IAAM,KAAK,IAChB,KAAK,IAAM,KAAK,GACnB,CACD,OAAOxe,EAAO,CACV,GAAI,KAAK,KAAK,OACV,GAAI,CACAA,EAAM,KAAO,OAAOA,EAAM,IAAI,CACjC,MACK,CACF,OAAO,KAAK,iBAAiBA,CAAK,CACrC,CAGL,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,OAC7B,OAAO,KAAK,iBAAiBpb,CAAK,EAEtC,IAAIlnB,EACJ,MAAMkR,EAAS,IAAIkzB,GACnB,UAAWwB,KAAS,KAAK,KAAK,OACtBA,EAAM,OAAS,OACEA,EAAM,UAAY1e,EAAM,KAAO0e,EAAM,MAAQ1e,EAAM,MAAQ0e,EAAM,SAE9E5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,KAAM,SACN,QAASoD,EAAM,MACf,UAAWA,EAAM,UACjB,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,OACLA,EAAM,UAAY1e,EAAM,KAAO0e,EAAM,MAAQ1e,EAAM,MAAQ0e,EAAM,SAE5E5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,KAAM,SACN,QAASoD,EAAM,MACf,UAAWA,EAAM,UACjB,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,aAChB1e,EAAM,KAAO0e,EAAM,QAAU,OAAO,CAAC,IACrC5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,gBACnB,WAAYoD,EAAM,MAClB,QAASA,EAAM,OACvC,CAAqB,EACD10B,EAAO,MAAK,GAIhBuwB,EAAK,YAAYmE,CAAK,EAG9B,MAAO,CAAE,OAAQ10B,EAAO,MAAO,MAAOgW,EAAM,KAC/C,CACD,iBAAiBA,EAAO,CACpB,MAAMlnB,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,OACxB,SAAUtiC,EAAI,UAC1B,CAAS,EACMukC,CACV,CACD,IAAI7yC,EAAOC,EAAS,CAChB,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAMwzC,EAAU,SAASvzC,CAAO,CAAC,CACvE,CACD,GAAGD,EAAOC,EAAS,CACf,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAOwzC,EAAU,SAASvzC,CAAO,CAAC,CACxE,CACD,IAAID,EAAOC,EAAS,CAChB,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAMwzC,EAAU,SAASvzC,CAAO,CAAC,CACvE,CACD,GAAGD,EAAOC,EAAS,CACf,OAAO,KAAK,SAAS,MAAOD,EAAO,GAAOwzC,EAAU,SAASvzC,CAAO,CAAC,CACxE,CACD,SAASqmB,EAAMtmB,EAAOy4C,EAAWx4C,EAAS,CACtC,OAAO,IAAIy4C,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CACJ,GAAG,KAAK,KAAK,OACb,CACI,KAAApyB,EACA,MAAAtmB,EACA,UAAAy4C,EACA,QAASjF,EAAU,SAASvzC,CAAO,CACtC,CACJ,CACb,CAAS,CACJ,CACD,UAAUi0C,EAAO,CACb,OAAO,IAAIwE,GAAU,CACjB,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQxE,CAAK,CAC/C,CAAS,CACJ,CACD,SAASj0C,EAAS,CACd,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,OAAO,CAAC,EACf,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,SAASA,EAAS,CACd,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,OAAO,CAAC,EACf,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,YAAYA,EAAS,CACjB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,OAAO,CAAC,EACf,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,YAAYA,EAAS,CACjB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO,OAAO,CAAC,EACf,UAAW,GACX,QAASuzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,WAAWD,EAAOC,EAAS,CACvB,OAAO,KAAK,UAAU,CAClB,KAAM,aACN,MAAAD,EACA,QAASwzC,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,IAAI,UAAW,CACX,IAAI83C,EAAM,KACV,UAAWD,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRC,IAAQ,MAAQD,EAAG,MAAQC,KAC3BA,EAAMD,EAAG,OAGrB,OAAOC,CACV,CACD,IAAI,UAAW,CACX,IAAIC,EAAM,KACV,UAAWF,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRE,IAAQ,MAAQF,EAAG,MAAQE,KAC3BA,EAAMF,EAAG,OAGrB,OAAOE,CACV,CACL,CACAU,GAAU,OAAU/xC,GACT,IAAI+xC,GAAU,CACjB,OAAQ,CAAE,EACV,SAAUlE,EAAsB,UAChC,OAAQ7tC,GAAQ,QAAU,GAC1B,GAAGgtC,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMgyC,WAAmB3E,CAAQ,CACpC,OAAOxe,EAAO,CAKV,GAJI,KAAK,KAAK,SACVA,EAAM,KAAO,EAAQA,EAAM,MAEZ,KAAK,SAASA,CAAK,IACnBob,EAAc,QAAS,CACtC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,QACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACL,CACAmjB,GAAW,OAAUhyC,GACV,IAAIgyC,GAAW,CAClB,SAAUnE,EAAsB,WAChC,OAAQ7tC,GAAQ,QAAU,GAC1B,GAAGgtC,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMiyC,WAAgB5E,CAAQ,CACjC,OAAOxe,EAAO,CAKV,GAJI,KAAK,KAAK,SACVA,EAAM,KAAO,IAAI,KAAKA,EAAM,IAAI,GAEjB,KAAK,SAASA,CAAK,IACnBob,EAAc,KAAM,CACnC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,KACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,GAAI,OAAO,MAAMrd,EAAM,KAAK,QAAS,GAAG,CACpC,MAAMlnB,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,YACnC,CAAa,EACM+B,CACV,CACD,MAAMrzB,EAAS,IAAIkzB,GACnB,IAAIpkC,EACJ,UAAW4lC,KAAS,KAAK,KAAK,OACtBA,EAAM,OAAS,MACX1e,EAAM,KAAK,QAAO,EAAK0e,EAAM,QAC7B5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAASoD,EAAM,QACf,UAAW,GACX,MAAO,GACP,QAASA,EAAM,MACf,KAAM,MAC9B,CAAqB,EACD10B,EAAO,MAAK,GAGX00B,EAAM,OAAS,MAChB1e,EAAM,KAAK,QAAO,EAAK0e,EAAM,QAC7B5lC,EAAM,KAAK,gBAAgBknB,EAAOlnB,CAAG,EACrCkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAASoD,EAAM,QACf,UAAW,GACX,MAAO,GACP,QAASA,EAAM,MACf,KAAM,MAC9B,CAAqB,EACD10B,EAAO,MAAK,GAIhBuwB,EAAK,YAAYmE,CAAK,EAG9B,MAAO,CACH,OAAQ10B,EAAO,MACf,MAAO,IAAI,KAAKgW,EAAM,KAAK,QAAO,CAAE,CAChD,CACK,CACD,UAAU0e,EAAO,CACb,OAAO,IAAI0E,GAAQ,CACf,GAAG,KAAK,KACR,OAAQ,CAAC,GAAG,KAAK,KAAK,OAAQ1E,CAAK,CAC/C,CAAS,CACJ,CACD,IAAI2E,EAAS54C,EAAS,CAClB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO44C,EAAQ,QAAS,EACxB,QAASrF,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,IAAI64C,EAAS74C,EAAS,CAClB,OAAO,KAAK,UAAU,CAClB,KAAM,MACN,MAAO64C,EAAQ,QAAS,EACxB,QAAStF,EAAU,SAASvzC,CAAO,CAC/C,CAAS,CACJ,CACD,IAAI,SAAU,CACV,IAAI83C,EAAM,KACV,UAAWD,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRC,IAAQ,MAAQD,EAAG,MAAQC,KAC3BA,EAAMD,EAAG,OAGrB,OAAOC,GAAO,KAAO,IAAI,KAAKA,CAAG,EAAI,IACxC,CACD,IAAI,SAAU,CACV,IAAIC,EAAM,KACV,UAAWF,KAAM,KAAK,KAAK,OACnBA,EAAG,OAAS,QACRE,IAAQ,MAAQF,EAAG,MAAQE,KAC3BA,EAAMF,EAAG,OAGrB,OAAOE,GAAO,KAAO,IAAI,KAAKA,CAAG,EAAI,IACxC,CACL,CACAY,GAAQ,OAAUjyC,GACP,IAAIiyC,GAAQ,CACf,OAAQ,CAAE,EACV,OAAQjyC,GAAQ,QAAU,GAC1B,SAAU6tC,EAAsB,QAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMoyC,WAAkB/E,CAAQ,CACnC,OAAOxe,EAAO,CAEV,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,OAAQ,CACrC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,OACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACL,CACAujB,GAAU,OAAUpyC,GACT,IAAIoyC,GAAU,CACjB,SAAUvE,EAAsB,UAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMqyC,WAAqBhF,CAAQ,CACtC,OAAOxe,EAAO,CAEV,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,UAAW,CACxC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,UACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACL,CACAwjB,GAAa,OAAUryC,GACZ,IAAIqyC,GAAa,CACpB,SAAUxE,EAAsB,aAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMsyC,WAAgBjF,CAAQ,CACjC,OAAOxe,EAAO,CAEV,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,KAAM,CACnC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,KACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACL,CACAyjB,GAAQ,OAAUtyC,GACP,IAAIsyC,GAAQ,CACf,SAAUzE,EAAsB,QAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMuyC,WAAelF,CAAQ,CAChC,aAAc,CACV,MAAM,GAAG,SAAS,EAElB,KAAK,KAAO,EACf,CACD,OAAOxe,EAAO,CACV,OAAO2d,GAAG3d,EAAM,IAAI,CACvB,CACL,CACA0jB,GAAO,OAAUvyC,GACN,IAAIuyC,GAAO,CACd,SAAU1E,EAAsB,OAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMwyC,WAAmBnF,CAAQ,CACpC,aAAc,CACV,MAAM,GAAG,SAAS,EAElB,KAAK,SAAW,EACnB,CACD,OAAOxe,EAAO,CACV,OAAO2d,GAAG3d,EAAM,IAAI,CACvB,CACL,CACA2jB,GAAW,OAAUxyC,GACV,IAAIwyC,GAAW,CAClB,SAAU3E,EAAsB,WAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMyyC,WAAiBpF,CAAQ,CAClC,OAAOxe,EAAO,CACV,MAAMlnB,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,MACxB,SAAUtiC,EAAI,UAC1B,CAAS,EACMukC,CACV,CACL,CACAuG,GAAS,OAAUzyC,GACR,IAAIyyC,GAAS,CAChB,SAAU5E,EAAsB,SAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAM0yC,WAAgBrF,CAAQ,CACjC,OAAOxe,EAAO,CAEV,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,UAAW,CACxC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,KACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACL,CACA6jB,GAAQ,OAAU1yC,GACP,IAAI0yC,GAAQ,CACf,SAAU7E,EAAsB,QAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMiuC,WAAiBZ,CAAQ,CAClC,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,EAAK,OAAAkR,CAAM,EAAK,KAAK,oBAAoBgW,CAAK,EAChDif,EAAM,KAAK,KACjB,GAAInmC,EAAI,aAAesiC,EAAc,MACjC,OAAA4B,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,MACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,EAEX,GAAI4B,EAAI,cAAgB,KAAM,CAC1B,MAAM+C,EAASlpC,EAAI,KAAK,OAASmmC,EAAI,YAAY,MAC3CgD,EAAWnpC,EAAI,KAAK,OAASmmC,EAAI,YAAY,OAC/C+C,GAAUC,KACVjF,EAAkBlkC,EAAK,CACnB,KAAMkpC,EAAS1G,EAAa,QAAUA,EAAa,UACnD,QAAU2G,EAAWhD,EAAI,YAAY,MAAQ,OAC7C,QAAU+C,EAAS/C,EAAI,YAAY,MAAQ,OAC3C,KAAM,QACN,UAAW,GACX,MAAO,GACP,QAASA,EAAI,YAAY,OAC7C,CAAiB,EACDj1B,EAAO,MAAK,EAEnB,CA2BD,GA1BIi1B,EAAI,YAAc,MACdnmC,EAAI,KAAK,OAASmmC,EAAI,UAAU,QAChCjC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAAS2D,EAAI,UAAU,MACvB,KAAM,QACN,UAAW,GACX,MAAO,GACP,QAASA,EAAI,UAAU,OAC3C,CAAiB,EACDj1B,EAAO,MAAK,GAGhBi1B,EAAI,YAAc,MACdnmC,EAAI,KAAK,OAASmmC,EAAI,UAAU,QAChCjC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAAS2D,EAAI,UAAU,MACvB,KAAM,QACN,UAAW,GACX,MAAO,GACP,QAASA,EAAI,UAAU,OAC3C,CAAiB,EACDj1B,EAAO,MAAK,GAGhBlR,EAAI,OAAO,MACX,OAAO,QAAQ,IAAI,CAAC,GAAGA,EAAI,IAAI,EAAE,IAAI,CAACihB,EAAMrsB,IACjCuxC,EAAI,KAAK,YAAY,IAAIhB,GAAmBnlC,EAAKihB,EAAMjhB,EAAI,KAAMpL,CAAC,CAAC,CAC7E,CAAC,EAAE,KAAMuB,GACCiuC,GAAY,WAAWlzB,EAAQ/a,CAAM,CAC/C,EAEL,MAAMA,EAAS,CAAC,GAAG6J,EAAI,IAAI,EAAE,IAAI,CAACihB,EAAMrsB,IAC7BuxC,EAAI,KAAK,WAAW,IAAIhB,GAAmBnlC,EAAKihB,EAAMjhB,EAAI,KAAMpL,CAAC,CAAC,CAC5E,EACD,OAAOwvC,GAAY,WAAWlzB,EAAQ/a,CAAM,CAC/C,CACD,IAAI,SAAU,CACV,OAAO,KAAK,KAAK,IACpB,CACD,IAAIkzC,EAAW13C,EAAS,CACpB,OAAO,IAAI20C,GAAS,CAChB,GAAG,KAAK,KACR,UAAW,CAAE,MAAO+C,EAAW,QAASnE,EAAU,SAASvzC,CAAO,CAAG,CACjF,CAAS,CACJ,CACD,IAAI23C,EAAW33C,EAAS,CACpB,OAAO,IAAI20C,GAAS,CAChB,GAAG,KAAK,KACR,UAAW,CAAE,MAAOgD,EAAW,QAASpE,EAAU,SAASvzC,CAAO,CAAG,CACjF,CAAS,CACJ,CACD,OAAO43C,EAAK53C,EAAS,CACjB,OAAO,IAAI20C,GAAS,CAChB,GAAG,KAAK,KACR,YAAa,CAAE,MAAOiD,EAAK,QAASrE,EAAU,SAASvzC,CAAO,CAAG,CAC7E,CAAS,CACJ,CACD,SAASA,EAAS,CACd,OAAO,KAAK,IAAI,EAAGA,CAAO,CAC7B,CACL,CACA20C,GAAS,OAAS,CAACtyB,EAAQ3b,IAChB,IAAIiuC,GAAS,CAChB,KAAMtyB,EACN,UAAW,KACX,UAAW,KACX,YAAa,KACb,SAAUkyB,EAAsB,SAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEL,SAAS2yC,GAAeh3B,EAAQ,CAC5B,GAAIA,aAAkBi3B,GAAW,CAC7B,MAAMC,EAAW,GACjB,UAAW94C,KAAO4hB,EAAO,MAAO,CAC5B,MAAMm3B,EAAcn3B,EAAO,MAAM5hB,CAAG,EACpC84C,EAAS94C,CAAG,EAAIg0C,GAAY,OAAO4E,GAAeG,CAAW,CAAC,CACjE,CACD,OAAO,IAAIF,GAAU,CACjB,GAAGj3B,EAAO,KACV,MAAO,IAAMk3B,CACzB,CAAS,CACJ,KACI,QAAIl3B,aAAkBsyB,GAChB,IAAIA,GAAS,CAChB,GAAGtyB,EAAO,KACV,KAAMg3B,GAAeh3B,EAAO,OAAO,CAC/C,CAAS,EAEIA,aAAkBoyB,GAChBA,GAAY,OAAO4E,GAAeh3B,EAAO,OAAQ,EAAC,EAEpDA,aAAkBqyB,GAChBA,GAAY,OAAO2E,GAAeh3B,EAAO,OAAQ,EAAC,EAEpDA,aAAkBo3B,GAChBA,GAAS,OAAOp3B,EAAO,MAAM,IAAKiN,GAAS+pB,GAAe/pB,CAAI,CAAC,CAAC,EAGhEjN,CAEf,CACO,MAAMi3B,WAAkBvF,CAAQ,CACnC,aAAc,CACV,MAAM,GAAG,SAAS,EAClB,KAAK,QAAU,KAKf,KAAK,UAAY,KAAK,YAqCtB,KAAK,QAAU,KAAK,MACvB,CACD,YAAa,CACT,GAAI,KAAK,UAAY,KACjB,OAAO,KAAK,QAChB,MAAM2F,EAAQ,KAAK,KAAK,MAAK,EACvBvlC,EAAO27B,EAAK,WAAW4J,CAAK,EAClC,YAAK,QAAU,CAAE,MAAAA,EAAO,KAAAvlC,CAAI,EACrB,KAAK,OACf,CACD,OAAOohB,EAAO,CAEV,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,OAAQ,CACrC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,OACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,KAAM,CAAE,OAAArzB,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EAChD,CAAE,MAAAmkB,EAAO,KAAMC,CAAS,EAAK,KAAK,aAClCC,EAAY,GAClB,GAAI,EAAE,KAAK,KAAK,oBAAoBT,IAAY,KAAK,KAAK,cAAgB,SACtE,UAAW14C,KAAO4N,EAAI,KACbsrC,EAAU,SAASl5C,CAAG,GACvBm5C,EAAU,KAAKn5C,CAAG,EAI9B,MAAMoyC,EAAQ,GACd,UAAWpyC,KAAOk5C,EAAW,CACzB,MAAME,EAAeH,EAAMj5C,CAAG,EACxBV,EAAQsO,EAAI,KAAK5N,CAAG,EAC1BoyC,EAAM,KAAK,CACP,IAAK,CAAE,OAAQ,QAAS,MAAOpyC,CAAK,EACpC,MAAOo5C,EAAa,OAAO,IAAIrG,GAAmBnlC,EAAKtO,EAAOsO,EAAI,KAAM5N,CAAG,CAAC,EAC5E,UAAWA,KAAO4N,EAAI,IACtC,CAAa,CACJ,CACD,GAAI,KAAK,KAAK,oBAAoB8qC,GAAU,CACxC,MAAMW,EAAc,KAAK,KAAK,YAC9B,GAAIA,IAAgB,cAChB,UAAWr5C,KAAOm5C,EACd/G,EAAM,KAAK,CACP,IAAK,CAAE,OAAQ,QAAS,MAAOpyC,CAAK,EACpC,MAAO,CAAE,OAAQ,QAAS,MAAO4N,EAAI,KAAK5N,CAAG,CAAG,CACxE,CAAqB,UAGAq5C,IAAgB,SACjBF,EAAU,OAAS,IACnBrH,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,kBACnB,KAAM+I,CAC9B,CAAqB,EACDr6B,EAAO,MAAK,WAGXu6B,IAAgB,QAGrB,MAAM,IAAI,MAAM,sDAAsD,CAE7E,KACI,CAED,MAAMC,EAAW,KAAK,KAAK,SAC3B,UAAWt5C,KAAOm5C,EAAW,CACzB,MAAM75C,EAAQsO,EAAI,KAAK5N,CAAG,EAC1BoyC,EAAM,KAAK,CACP,IAAK,CAAE,OAAQ,QAAS,MAAOpyC,CAAK,EACpC,MAAOs5C,EAAS,OAAO,IAAIvG,GAAmBnlC,EAAKtO,EAAOsO,EAAI,KAAM5N,CAAG,CACtE,EACD,UAAWA,KAAO4N,EAAI,IAC1C,CAAiB,CACJ,CACJ,CACD,OAAIA,EAAI,OAAO,MACJ,QAAQ,QAAS,EACnB,KAAK,SAAY,CAClB,MAAMykC,EAAY,GAClB,UAAWC,KAAQF,EAAO,CACtB,MAAMpyC,EAAM,MAAMsyC,EAAK,IACjBhzC,EAAQ,MAAMgzC,EAAK,MACzBD,EAAU,KAAK,CACX,IAAAryC,EACA,MAAAV,EACA,UAAWgzC,EAAK,SACxC,CAAqB,CACJ,CACD,OAAOD,CACvB,CAAa,EACI,KAAMA,GACAL,GAAY,gBAAgBlzB,EAAQuzB,CAAS,CACvD,EAGML,GAAY,gBAAgBlzB,EAAQszB,CAAK,CAEvD,CACD,IAAI,OAAQ,CACR,OAAO,KAAK,KAAK,OACpB,CACD,OAAO7yC,EAAS,CACZ,OAAAuzC,EAAU,SACH,IAAI+F,GAAU,CACjB,GAAG,KAAK,KACR,YAAa,SACb,GAAIt5C,IAAY,OACV,CACE,SAAU,CAACqxC,EAAOhjC,IAAQ,CACtB,MAAM2rC,EAAe,KAAK,KAAK,WAAW3I,EAAOhjC,CAAG,EAAE,SAAWA,EAAI,aACrE,OAAIgjC,EAAM,OAAS,oBACR,CACH,QAASkC,EAAU,SAASvzC,CAAO,EAAE,SAAWg6C,CAChF,EAC+B,CACH,QAASA,CACrC,CACqB,CACJ,EACC,EAClB,CAAS,CACJ,CACD,OAAQ,CACJ,OAAO,IAAIV,GAAU,CACjB,GAAG,KAAK,KACR,YAAa,OACzB,CAAS,CACJ,CACD,aAAc,CACV,OAAO,IAAIA,GAAU,CACjB,GAAG,KAAK,KACR,YAAa,aACzB,CAAS,CACJ,CAkBD,OAAOW,EAAc,CACjB,OAAO,IAAIX,GAAU,CACjB,GAAG,KAAK,KACR,MAAO,KAAO,CACV,GAAG,KAAK,KAAK,MAAO,EACpB,GAAGW,CACnB,EACA,CAAS,CACJ,CAMD,MAAMC,EAAS,CAUX,OATe,IAAIZ,GAAU,CACzB,YAAaY,EAAQ,KAAK,YAC1B,SAAUA,EAAQ,KAAK,SACvB,MAAO,KAAO,CACV,GAAG,KAAK,KAAK,MAAO,EACpB,GAAGA,EAAQ,KAAK,MAAO,CACvC,GACY,SAAU3F,EAAsB,SAC5C,CAAS,CAEJ,CAoCD,OAAO9zC,EAAK4hB,EAAQ,CAChB,OAAO,KAAK,QAAQ,CAAE,CAAC5hB,CAAG,EAAG4hB,CAAQ,EACxC,CAsBD,SAAS/hB,EAAO,CACZ,OAAO,IAAIg5C,GAAU,CACjB,GAAG,KAAK,KACR,SAAUh5C,CACtB,CAAS,CACJ,CACD,KAAK65C,EAAM,CACP,MAAMT,EAAQ,GACd,UAAWj5C,KAAOqvC,EAAK,WAAWqK,CAAI,EAC9BA,EAAK15C,CAAG,GAAK,KAAK,MAAMA,CAAG,IAC3Bi5C,EAAMj5C,CAAG,EAAI,KAAK,MAAMA,CAAG,GAGnC,OAAO,IAAI64C,GAAU,CACjB,GAAG,KAAK,KACR,MAAO,IAAMI,CACzB,CAAS,CACJ,CACD,KAAKS,EAAM,CACP,MAAMT,EAAQ,GACd,UAAWj5C,KAAOqvC,EAAK,WAAW,KAAK,KAAK,EACnCqK,EAAK15C,CAAG,IACTi5C,EAAMj5C,CAAG,EAAI,KAAK,MAAMA,CAAG,GAGnC,OAAO,IAAI64C,GAAU,CACjB,GAAG,KAAK,KACR,MAAO,IAAMI,CACzB,CAAS,CACJ,CAID,aAAc,CACV,OAAOL,GAAe,IAAI,CAC7B,CACD,QAAQc,EAAM,CACV,MAAMZ,EAAW,GACjB,UAAW94C,KAAOqvC,EAAK,WAAW,KAAK,KAAK,EAAG,CAC3C,MAAM0J,EAAc,KAAK,MAAM/4C,CAAG,EAC9B05C,GAAQ,CAACA,EAAK15C,CAAG,EACjB84C,EAAS94C,CAAG,EAAI+4C,EAGhBD,EAAS94C,CAAG,EAAI+4C,EAAY,SAAQ,CAE3C,CACD,OAAO,IAAIF,GAAU,CACjB,GAAG,KAAK,KACR,MAAO,IAAMC,CACzB,CAAS,CACJ,CACD,SAASY,EAAM,CACX,MAAMZ,EAAW,GACjB,UAAW94C,KAAOqvC,EAAK,WAAW,KAAK,KAAK,EACxC,GAAIqK,GAAQ,CAACA,EAAK15C,CAAG,EACjB84C,EAAS94C,CAAG,EAAI,KAAK,MAAMA,CAAG,MAE7B,CAED,IAAI25C,EADgB,KAAK,MAAM35C,CAAG,EAElC,KAAO25C,aAAoB3F,IACvB2F,EAAWA,EAAS,KAAK,UAE7Bb,EAAS94C,CAAG,EAAI25C,CACnB,CAEL,OAAO,IAAId,GAAU,CACjB,GAAG,KAAK,KACR,MAAO,IAAMC,CACzB,CAAS,CACJ,CACD,OAAQ,CACJ,OAAOc,GAAcvK,EAAK,WAAW,KAAK,KAAK,CAAC,CACnD,CACL,CACAwJ,GAAU,OAAS,CAACI,EAAOhzC,IAChB,IAAI4yC,GAAU,CACjB,MAAO,IAAMI,EACb,YAAa,QACb,SAAUP,GAAS,OAAQ,EAC3B,SAAU5E,EAAsB,UAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEL4yC,GAAU,aAAe,CAACI,EAAOhzC,IACtB,IAAI4yC,GAAU,CACjB,MAAO,IAAMI,EACb,YAAa,SACb,SAAUP,GAAS,OAAQ,EAC3B,SAAU5E,EAAsB,UAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEL4yC,GAAU,WAAa,CAACI,EAAOhzC,IACpB,IAAI4yC,GAAU,CACjB,MAAAI,EACA,YAAa,QACb,SAAUP,GAAS,OAAQ,EAC3B,SAAU5E,EAAsB,UAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMouC,WAAiBf,CAAQ,CAClC,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,CAAK,EAAG,KAAK,oBAAoBknB,CAAK,EACxCr2B,EAAU,KAAK,KAAK,QAC1B,SAASo7C,EAAc5H,EAAS,CAE5B,UAAWluC,KAAUkuC,EACjB,GAAIluC,EAAO,OAAO,SAAW,QACzB,OAAOA,EAAO,OAGtB,UAAWA,KAAUkuC,EACjB,GAAIluC,EAAO,OAAO,SAAW,QAEzB,OAAA6J,EAAI,OAAO,OAAO,KAAK,GAAG7J,EAAO,IAAI,OAAO,MAAM,EAC3CA,EAAO,OAItB,MAAM+1C,EAAc7H,EAAQ,IAAKluC,GAAW,IAAIssC,GAAStsC,EAAO,IAAI,OAAO,MAAM,CAAC,EAClF,OAAA+tC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,cACnB,YAAA0J,CAChB,CAAa,EACM3H,CACV,CACD,GAAIvkC,EAAI,OAAO,MACX,OAAO,QAAQ,IAAInP,EAAQ,IAAI,MAAO21C,GAAW,CAC7C,MAAM2F,EAAW,CACb,GAAGnsC,EACH,OAAQ,CACJ,GAAGA,EAAI,OACP,OAAQ,CAAE,CACb,EACD,OAAQ,IAC5B,EACgB,MAAO,CACH,OAAQ,MAAMwmC,EAAO,YAAY,CAC7B,KAAMxmC,EAAI,KACV,KAAMA,EAAI,KACV,OAAQmsC,CAChC,CAAqB,EACD,IAAKA,CACzB,CACA,CAAa,CAAC,EAAE,KAAKF,CAAa,EAErB,CACD,IAAIG,EACJ,MAAM1J,EAAS,GACf,UAAW8D,KAAU31C,EAAS,CAC1B,MAAMs7C,EAAW,CACb,GAAGnsC,EACH,OAAQ,CACJ,GAAGA,EAAI,OACP,OAAQ,CAAE,CACb,EACD,OAAQ,IAC5B,EACsB7J,EAASqwC,EAAO,WAAW,CAC7B,KAAMxmC,EAAI,KACV,KAAMA,EAAI,KACV,OAAQmsC,CAC5B,CAAiB,EACD,GAAIh2C,EAAO,SAAW,QAClB,OAAOA,EAEFA,EAAO,SAAW,SAAW,CAACi2C,IACnCA,EAAQ,CAAE,OAAAj2C,EAAQ,IAAKg2C,CAAQ,GAE/BA,EAAS,OAAO,OAAO,QACvBzJ,EAAO,KAAKyJ,EAAS,OAAO,MAAM,CAEzC,CACD,GAAIC,EACA,OAAApsC,EAAI,OAAO,OAAO,KAAK,GAAGosC,EAAM,IAAI,OAAO,MAAM,EAC1CA,EAAM,OAEjB,MAAMF,EAAcxJ,EAAO,IAAKA,GAAW,IAAID,GAASC,CAAM,CAAC,EAC/D,OAAAwB,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,cACnB,YAAA0J,CAChB,CAAa,EACM3H,CACV,CACJ,CACD,IAAI,SAAU,CACV,OAAO,KAAK,KAAK,OACpB,CACL,CACAkC,GAAS,OAAS,CAAC4F,EAAOh0C,IACf,IAAIouC,GAAS,CAChB,QAAS4F,EACT,SAAUnG,EAAsB,SAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAqIL,SAASi0C,GAAYj2C,EAAGC,EAAG,CACvB,MAAMi2C,EAAQhK,GAAclsC,CAAC,EACvBm2C,EAAQjK,GAAcjsC,CAAC,EAC7B,GAAID,IAAMC,EACN,MAAO,CAAE,MAAO,GAAM,KAAMD,CAAC,EAE5B,GAAIk2C,IAAUjK,EAAc,QAAUkK,IAAUlK,EAAc,OAAQ,CACvE,MAAMmK,EAAQhL,EAAK,WAAWnrC,CAAC,EACzBo2C,EAAajL,EAAK,WAAWprC,CAAC,EAAE,OAAQjE,GAAQq6C,EAAM,QAAQr6C,CAAG,IAAM,EAAE,EACzEu6C,EAAS,CAAE,GAAGt2C,EAAG,GAAGC,CAAC,EAC3B,UAAWlE,KAAOs6C,EAAY,CAC1B,MAAME,EAAcN,GAAYj2C,EAAEjE,CAAG,EAAGkE,EAAElE,CAAG,CAAC,EAC9C,GAAI,CAACw6C,EAAY,MACb,MAAO,CAAE,MAAO,IAEpBD,EAAOv6C,CAAG,EAAIw6C,EAAY,IAC7B,CACD,MAAO,CAAE,MAAO,GAAM,KAAMD,CAAM,CACrC,SACQJ,IAAUjK,EAAc,OAASkK,IAAUlK,EAAc,MAAO,CACrE,GAAIjsC,EAAE,SAAWC,EAAE,OACf,MAAO,CAAE,MAAO,IAEpB,MAAMu2C,EAAW,GACjB,QAAS56C,EAAQ,EAAGA,EAAQoE,EAAE,OAAQpE,IAAS,CAC3C,MAAM66C,EAAQz2C,EAAEpE,CAAK,EACf86C,EAAQz2C,EAAErE,CAAK,EACf26C,EAAcN,GAAYQ,EAAOC,CAAK,EAC5C,GAAI,CAACH,EAAY,MACb,MAAO,CAAE,MAAO,IAEpBC,EAAS,KAAKD,EAAY,IAAI,CACjC,CACD,MAAO,CAAE,MAAO,GAAM,KAAMC,CAAQ,CACvC,KACI,QAAIN,IAAUjK,EAAc,MAAQkK,IAAUlK,EAAc,MAAQ,CAACjsC,GAAM,CAACC,EACtE,CAAE,MAAO,GAAM,KAAMD,CAAC,EAGtB,CAAE,MAAO,GAExB,CACO,MAAMswC,WAAwBjB,CAAQ,CACzC,OAAOxe,EAAO,CACV,KAAM,CAAE,OAAAhW,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EAChD8lB,EAAe,CAACC,EAAYC,IAAgB,CAC9C,GAAIpI,GAAUmI,CAAU,GAAKnI,GAAUoI,CAAW,EAC9C,OAAO3I,EAEX,MAAM4I,EAASb,GAAYW,EAAW,MAAOC,EAAY,KAAK,EAC9D,OAAKC,EAAO,QAMRpI,GAAQkI,CAAU,GAAKlI,GAAQmI,CAAW,IAC1Ch8B,EAAO,MAAK,EAET,CAAE,OAAQA,EAAO,MAAO,MAAOi8B,EAAO,QARzCjJ,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,0BACvC,CAAiB,EACM+B,EAMvB,EACQ,OAAIvkC,EAAI,OAAO,MACJ,QAAQ,IAAI,CACf,KAAK,KAAK,KAAK,YAAY,CACvB,KAAMA,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CAC5B,CAAiB,EACD,KAAK,KAAK,MAAM,YAAY,CACxB,KAAMA,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CAC5B,CAAiB,CACjB,CAAa,EAAE,KAAK,CAAC,CAACotC,EAAMC,CAAK,IAAML,EAAaI,EAAMC,CAAK,CAAC,EAG7CL,EAAa,KAAK,KAAK,KAAK,WAAW,CAC1C,KAAMhtC,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CACX,GAAG,KAAK,KAAK,MAAM,WAAW,CAC3B,KAAMA,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CACX,EAAC,CAET,CACL,CACA2mC,GAAgB,OAAS,CAACyG,EAAMC,EAAOh1C,IAC5B,IAAIsuC,GAAgB,CACvB,KAAMyG,EACN,MAAOC,EACP,SAAUnH,EAAsB,gBAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAGE,MAAM+yC,WAAiB1F,CAAQ,CAClC,OAAOxe,EAAO,CACV,KAAM,CAAE,OAAAhW,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EACtD,GAAIlnB,EAAI,aAAesiC,EAAc,MACjC,OAAA4B,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,MACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,EAEX,GAAIvkC,EAAI,KAAK,OAAS,KAAK,KAAK,MAAM,OAClC,OAAAkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAAS,KAAK,KAAK,MAAM,OACzB,UAAW,GACX,MAAO,GACP,KAAM,OACtB,CAAa,EACM+B,EAGP,CADS,KAAK,KAAK,MACVvkC,EAAI,KAAK,OAAS,KAAK,KAAK,MAAM,SAC3CkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAAS,KAAK,KAAK,MAAM,OACzB,UAAW,GACX,MAAO,GACP,KAAM,OACtB,CAAa,EACDtxB,EAAO,MAAK,GAEhB,MAAM4wB,EAAQ,CAAC,GAAG9hC,EAAI,IAAI,EACrB,IAAI,CAACihB,EAAMqsB,IAAc,CAC1B,MAAMt5B,EAAS,KAAK,KAAK,MAAMs5B,CAAS,GAAK,KAAK,KAAK,KACvD,OAAKt5B,EAEEA,EAAO,OAAO,IAAImxB,GAAmBnlC,EAAKihB,EAAMjhB,EAAI,KAAMstC,CAAS,CAAC,EADhE,IAEvB,CAAS,EACI,OAAQj5B,GAAM,CAAC,CAACA,CAAC,EACtB,OAAIrU,EAAI,OAAO,MACJ,QAAQ,IAAI8hC,CAAK,EAAE,KAAMuC,GACrBD,GAAY,WAAWlzB,EAAQmzB,CAAO,CAChD,EAGMD,GAAY,WAAWlzB,EAAQ4wB,CAAK,CAElD,CACD,IAAI,OAAQ,CACR,OAAO,KAAK,KAAK,KACpB,CACD,KAAK/rC,EAAM,CACP,OAAO,IAAIq1C,GAAS,CAChB,GAAG,KAAK,KACR,KAAAr1C,CACZ,CAAS,CACJ,CACL,CACAq1C,GAAS,OAAS,CAACmC,EAASl1C,IAAW,CACnC,GAAI,CAAC,MAAM,QAAQk1C,CAAO,EACtB,MAAM,IAAI,MAAM,uDAAuD,EAE3E,OAAO,IAAInC,GAAS,CAChB,MAAOmC,EACP,SAAUrH,EAAsB,SAChC,KAAM,KACN,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,CACL,EAuDO,MAAMm1C,WAAe9H,CAAQ,CAChC,IAAI,WAAY,CACZ,OAAO,KAAK,KAAK,OACpB,CACD,IAAI,aAAc,CACd,OAAO,KAAK,KAAK,SACpB,CACD,OAAOxe,EAAO,CACV,KAAM,CAAE,OAAAhW,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EACtD,GAAIlnB,EAAI,aAAesiC,EAAc,IACjC,OAAA4B,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,IACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,EAEX,MAAMkJ,EAAU,KAAK,KAAK,QACpBC,EAAY,KAAK,KAAK,UACtBlJ,EAAQ,CAAC,GAAGxkC,EAAI,KAAK,QAAO,CAAE,EAAE,IAAI,CAAC,CAAC5N,EAAKV,CAAK,EAAGO,KAC9C,CACH,IAAKw7C,EAAQ,OAAO,IAAItI,GAAmBnlC,EAAK5N,EAAK4N,EAAI,KAAM,CAAC/N,EAAO,KAAK,CAAC,CAAC,EAC9E,MAAOy7C,EAAU,OAAO,IAAIvI,GAAmBnlC,EAAKtO,EAAOsO,EAAI,KAAM,CAAC/N,EAAO,OAAO,CAAC,CAAC,CACtG,EACS,EACD,GAAI+N,EAAI,OAAO,MAAO,CAClB,MAAM2tC,EAAW,IAAI,IACrB,OAAO,QAAQ,UAAU,KAAK,SAAY,CACtC,UAAWjJ,KAAQF,EAAO,CACtB,MAAMpyC,EAAM,MAAMsyC,EAAK,IACjBhzC,EAAQ,MAAMgzC,EAAK,MACzB,GAAItyC,EAAI,SAAW,WAAaV,EAAM,SAAW,UAC7C,OAAO6yC,GAEPnyC,EAAI,SAAW,SAAWV,EAAM,SAAW,UAC3Cwf,EAAO,MAAK,EAEhBy8B,EAAS,IAAIv7C,EAAI,MAAOV,EAAM,KAAK,CACtC,CACD,MAAO,CAAE,OAAQwf,EAAO,MAAO,MAAOy8B,CAAQ,CAC9D,CAAa,CACJ,KACI,CACD,MAAMA,EAAW,IAAI,IACrB,UAAWjJ,KAAQF,EAAO,CACtB,MAAMpyC,EAAMsyC,EAAK,IACXhzC,EAAQgzC,EAAK,MACnB,GAAItyC,EAAI,SAAW,WAAaV,EAAM,SAAW,UAC7C,OAAO6yC,GAEPnyC,EAAI,SAAW,SAAWV,EAAM,SAAW,UAC3Cwf,EAAO,MAAK,EAEhBy8B,EAAS,IAAIv7C,EAAI,MAAOV,EAAM,KAAK,CACtC,CACD,MAAO,CAAE,OAAQwf,EAAO,MAAO,MAAOy8B,CAAQ,CACjD,CACJ,CACL,CACAH,GAAO,OAAS,CAACC,EAASC,EAAWr1C,IAC1B,IAAIm1C,GAAO,CACd,UAAAE,EACA,QAAAD,EACA,SAAUvH,EAAsB,OAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMu1C,WAAelI,CAAQ,CAChC,OAAOxe,EAAO,CACV,KAAM,CAAE,OAAAhW,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EACtD,GAAIlnB,EAAI,aAAesiC,EAAc,IACjC,OAAA4B,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,IACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,EAEX,MAAM4B,EAAM,KAAK,KACbA,EAAI,UAAY,MACZnmC,EAAI,KAAK,KAAOmmC,EAAI,QAAQ,QAC5BjC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,UACnB,QAAS2D,EAAI,QAAQ,MACrB,KAAM,MACN,UAAW,GACX,MAAO,GACP,QAASA,EAAI,QAAQ,OACzC,CAAiB,EACDj1B,EAAO,MAAK,GAGhBi1B,EAAI,UAAY,MACZnmC,EAAI,KAAK,KAAOmmC,EAAI,QAAQ,QAC5BjC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,QACnB,QAAS2D,EAAI,QAAQ,MACrB,KAAM,MACN,UAAW,GACX,MAAO,GACP,QAASA,EAAI,QAAQ,OACzC,CAAiB,EACDj1B,EAAO,MAAK,GAGpB,MAAMw8B,EAAY,KAAK,KAAK,UAC5B,SAASG,EAAYC,EAAU,CAC3B,MAAMC,EAAY,IAAI,IACtB,UAAWrsC,KAAWosC,EAAU,CAC5B,GAAIpsC,EAAQ,SAAW,UACnB,OAAO6iC,EACP7iC,EAAQ,SAAW,SACnBwP,EAAO,MAAK,EAChB68B,EAAU,IAAIrsC,EAAQ,KAAK,CAC9B,CACD,MAAO,CAAE,OAAQwP,EAAO,MAAO,MAAO68B,CAAS,CAClD,CACD,MAAMD,EAAW,CAAC,GAAG9tC,EAAI,KAAK,QAAQ,EAAE,IAAI,CAACihB,EAAMrsB,IAAM84C,EAAU,OAAO,IAAIvI,GAAmBnlC,EAAKihB,EAAMjhB,EAAI,KAAMpL,CAAC,CAAC,CAAC,EACzH,OAAIoL,EAAI,OAAO,MACJ,QAAQ,IAAI8tC,CAAQ,EAAE,KAAMA,GAAaD,EAAYC,CAAQ,CAAC,EAG9DD,EAAYC,CAAQ,CAElC,CACD,IAAIE,EAASr8C,EAAS,CAClB,OAAO,IAAIi8C,GAAO,CACd,GAAG,KAAK,KACR,QAAS,CAAE,MAAOI,EAAS,QAAS9I,EAAU,SAASvzC,CAAO,CAAG,CAC7E,CAAS,CACJ,CACD,IAAIs8C,EAASt8C,EAAS,CAClB,OAAO,IAAIi8C,GAAO,CACd,GAAG,KAAK,KACR,QAAS,CAAE,MAAOK,EAAS,QAAS/I,EAAU,SAASvzC,CAAO,CAAG,CAC7E,CAAS,CACJ,CACD,KAAKu8C,EAAMv8C,EAAS,CAChB,OAAO,KAAK,IAAIu8C,EAAMv8C,CAAO,EAAE,IAAIu8C,EAAMv8C,CAAO,CACnD,CACD,SAASA,EAAS,CACd,OAAO,KAAK,IAAI,EAAGA,CAAO,CAC7B,CACL,CACAi8C,GAAO,OAAS,CAACF,EAAWr1C,IACjB,IAAIu1C,GAAO,CACd,UAAAF,EACA,QAAS,KACT,QAAS,KACT,SAAUxH,EAAsB,OAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAoHE,MAAM81C,WAAgBzI,CAAQ,CACjC,IAAI,QAAS,CACT,OAAO,KAAK,KAAK,QACpB,CACD,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,CAAK,EAAG,KAAK,oBAAoBknB,CAAK,EAE9C,OADmB,KAAK,KAAK,OAAM,EACjB,OAAO,CAAE,KAAMlnB,EAAI,KAAM,KAAMA,EAAI,KAAM,OAAQA,CAAK,EAC3E,CACL,CACAmuC,GAAQ,OAAS,CAACC,EAAQ/1C,IACf,IAAI81C,GAAQ,CACf,OAAQC,EACR,SAAUlI,EAAsB,QAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMg2C,WAAmB3I,CAAQ,CACpC,OAAOxe,EAAO,CACV,GAAIA,EAAM,OAAS,KAAK,KAAK,MAAO,CAChC,MAAMlnB,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,SAAUA,EAAI,KACd,KAAMwiC,EAAa,gBACnB,SAAU,KAAK,KAAK,KACpC,CAAa,EACM+B,CACV,CACD,MAAO,CAAE,OAAQ,QAAS,MAAOrd,EAAM,IAAI,CAC9C,CACD,IAAI,OAAQ,CACR,OAAO,KAAK,KAAK,KACpB,CACL,CACAmnB,GAAW,OAAS,CAAC38C,EAAO2G,IACjB,IAAIg2C,GAAW,CAClB,MAAO38C,EACP,SAAUw0C,EAAsB,WAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEL,SAAS2zC,GAAc34B,EAAQhb,EAAQ,CACnC,OAAO,IAAIi2C,GAAQ,CACf,OAAAj7B,EACA,SAAU6yB,EAAsB,QAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,CACL,CACO,MAAMi2C,WAAgB5I,CAAQ,CACjC,OAAOxe,EAAO,CACV,GAAI,OAAOA,EAAM,MAAS,SAAU,CAChC,MAAMlnB,EAAM,KAAK,gBAAgBknB,CAAK,EAChCqnB,EAAiB,KAAK,KAAK,OACjC,OAAArK,EAAkBlkC,EAAK,CACnB,SAAUyhC,EAAK,WAAW8M,CAAc,EACxC,SAAUvuC,EAAI,WACd,KAAMwiC,EAAa,YACnC,CAAa,EACM+B,CACV,CAID,GAHK,KAAK,SACN,KAAK,OAAS,IAAI,IAAI,KAAK,KAAK,MAAM,GAEtC,CAAC,KAAK,OAAO,IAAIrd,EAAM,IAAI,EAAG,CAC9B,MAAMlnB,EAAM,KAAK,gBAAgBknB,CAAK,EAChCqnB,EAAiB,KAAK,KAAK,OACjC,OAAArK,EAAkBlkC,EAAK,CACnB,SAAUA,EAAI,KACd,KAAMwiC,EAAa,mBACnB,QAAS+L,CACzB,CAAa,EACMhK,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACD,IAAI,SAAU,CACV,OAAO,KAAK,KAAK,MACpB,CACD,IAAI,MAAO,CACP,MAAMsnB,EAAa,GACnB,UAAW10B,KAAO,KAAK,KAAK,OACxB00B,EAAW10B,CAAG,EAAIA,EAEtB,OAAO00B,CACV,CACD,IAAI,QAAS,CACT,MAAMA,EAAa,GACnB,UAAW10B,KAAO,KAAK,KAAK,OACxB00B,EAAW10B,CAAG,EAAIA,EAEtB,OAAO00B,CACV,CACD,IAAI,MAAO,CACP,MAAMA,EAAa,GACnB,UAAW10B,KAAO,KAAK,KAAK,OACxB00B,EAAW10B,CAAG,EAAIA,EAEtB,OAAO00B,CACV,CACD,QAAQn7B,EAAQo7B,EAAS,KAAK,KAAM,CAChC,OAAOH,GAAQ,OAAOj7B,EAAQ,CAC1B,GAAG,KAAK,KACR,GAAGo7B,CACf,CAAS,CACJ,CACD,QAAQp7B,EAAQo7B,EAAS,KAAK,KAAM,CAChC,OAAOH,GAAQ,OAAO,KAAK,QAAQ,OAAQI,GAAQ,CAACr7B,EAAO,SAASq7B,CAAG,CAAC,EAAG,CACvE,GAAG,KAAK,KACR,GAAGD,CACf,CAAS,CACJ,CACL,CACAH,GAAQ,OAAStC,GACV,MAAM2C,WAAsBjJ,CAAQ,CACvC,OAAOxe,EAAO,CACV,MAAM0nB,EAAmBnN,EAAK,mBAAmB,KAAK,KAAK,MAAM,EAC3DzhC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,GAAIlnB,EAAI,aAAesiC,EAAc,QAAUtiC,EAAI,aAAesiC,EAAc,OAAQ,CACpF,MAAMiM,EAAiB9M,EAAK,aAAamN,CAAgB,EACzD,OAAA1K,EAAkBlkC,EAAK,CACnB,SAAUyhC,EAAK,WAAW8M,CAAc,EACxC,SAAUvuC,EAAI,WACd,KAAMwiC,EAAa,YACnC,CAAa,EACM+B,CACV,CAID,GAHK,KAAK,SACN,KAAK,OAAS,IAAI,IAAI9C,EAAK,mBAAmB,KAAK,KAAK,MAAM,CAAC,GAE/D,CAAC,KAAK,OAAO,IAAIva,EAAM,IAAI,EAAG,CAC9B,MAAMqnB,EAAiB9M,EAAK,aAAamN,CAAgB,EACzD,OAAA1K,EAAkBlkC,EAAK,CACnB,SAAUA,EAAI,KACd,KAAMwiC,EAAa,mBACnB,QAAS+L,CACzB,CAAa,EACMhK,CACV,CACD,OAAOM,GAAG3d,EAAM,IAAI,CACvB,CACD,IAAI,MAAO,CACP,OAAO,KAAK,KAAK,MACpB,CACL,CACAynB,GAAc,OAAS,CAACt7B,EAAQhb,IACrB,IAAIs2C,GAAc,CACrB,OAAQt7B,EACR,SAAU6yB,EAAsB,cAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMkuC,WAAmBb,CAAQ,CACpC,QAAS,CACL,OAAO,KAAK,KAAK,IACpB,CACD,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,CAAK,EAAG,KAAK,oBAAoBknB,CAAK,EAC9C,GAAIlnB,EAAI,aAAesiC,EAAc,SAAWtiC,EAAI,OAAO,QAAU,GACjE,OAAAkkC,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,QACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,EAEX,MAAMsK,EAAc7uC,EAAI,aAAesiC,EAAc,QAAUtiC,EAAI,KAAO,QAAQ,QAAQA,EAAI,IAAI,EAClG,OAAO6kC,GAAGgK,EAAY,KAAM1+B,GACjB,KAAK,KAAK,KAAK,WAAWA,EAAM,CACnC,KAAMnQ,EAAI,KACV,SAAUA,EAAI,OAAO,kBACrC,CAAa,CACJ,CAAC,CACL,CACL,CACAumC,GAAW,OAAS,CAACvyB,EAAQ3b,IAClB,IAAIkuC,GAAW,CAClB,KAAMvyB,EACN,SAAUkyB,EAAsB,WAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAM4tC,WAAmBP,CAAQ,CACpC,WAAY,CACR,OAAO,KAAK,KAAK,MACpB,CACD,YAAa,CACT,OAAO,KAAK,KAAK,OAAO,KAAK,WAAaQ,EAAsB,WAC1D,KAAK,KAAK,OAAO,WAAY,EAC7B,KAAK,KAAK,MACnB,CACD,OAAOhf,EAAO,CACV,KAAM,CAAE,OAAAhW,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EAChD4nB,EAAS,KAAK,KAAK,QAAU,KAC7BC,EAAW,CACb,SAAWlP,GAAQ,CACfqE,EAAkBlkC,EAAK6/B,CAAG,EACtBA,EAAI,MACJ3uB,EAAO,MAAK,EAGZA,EAAO,MAAK,CAEnB,EACD,IAAI,MAAO,CACP,OAAOlR,EAAI,IACd,CACb,EAEQ,GADA+uC,EAAS,SAAWA,EAAS,SAAS,KAAKA,CAAQ,EAC/CD,EAAO,OAAS,aAAc,CAC9B,MAAME,EAAYF,EAAO,UAAU9uC,EAAI,KAAM+uC,CAAQ,EACrD,GAAI/uC,EAAI,OAAO,MACX,OAAO,QAAQ,QAAQgvC,CAAS,EAAE,KAAK,MAAOA,GAAc,CACxD,GAAI99B,EAAO,QAAU,UACjB,OAAOqzB,EACX,MAAMpuC,EAAS,MAAM,KAAK,KAAK,OAAO,YAAY,CAC9C,KAAM64C,EACN,KAAMhvC,EAAI,KACV,OAAQA,CAChC,CAAqB,EACD,OAAI7J,EAAO,SAAW,UACXouC,EACPpuC,EAAO,SAAW,SAElB+a,EAAO,QAAU,QACV0zB,GAAMzuC,EAAO,KAAK,EACtBA,CAC3B,CAAiB,EAEA,CACD,GAAI+a,EAAO,QAAU,UACjB,OAAOqzB,EACX,MAAMpuC,EAAS,KAAK,KAAK,OAAO,WAAW,CACvC,KAAM64C,EACN,KAAMhvC,EAAI,KACV,OAAQA,CAC5B,CAAiB,EACD,OAAI7J,EAAO,SAAW,UACXouC,EACPpuC,EAAO,SAAW,SAElB+a,EAAO,QAAU,QACV0zB,GAAMzuC,EAAO,KAAK,EACtBA,CACV,CACJ,CACD,GAAI24C,EAAO,OAAS,aAAc,CAC9B,MAAMG,EAAqB76B,GAAQ,CAC/B,MAAMje,EAAS24C,EAAO,WAAW16B,EAAK26B,CAAQ,EAC9C,GAAI/uC,EAAI,OAAO,MACX,OAAO,QAAQ,QAAQ7J,CAAM,EAEjC,GAAIA,aAAkB,QAClB,MAAM,IAAI,MAAM,2FAA2F,EAE/G,OAAOie,CACvB,EACY,GAAIpU,EAAI,OAAO,QAAU,GAAO,CAC5B,MAAMkvC,EAAQ,KAAK,KAAK,OAAO,WAAW,CACtC,KAAMlvC,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CAC5B,CAAiB,EACD,OAAIkvC,EAAM,SAAW,UACV3K,GACP2K,EAAM,SAAW,SACjBh+B,EAAO,MAAK,EAEhB+9B,EAAkBC,EAAM,KAAK,EACtB,CAAE,OAAQh+B,EAAO,MAAO,MAAOg+B,EAAM,OAC/C,KAEG,QAAO,KAAK,KAAK,OAAO,YAAY,CAAE,KAAMlvC,EAAI,KAAM,KAAMA,EAAI,KAAM,OAAQA,CAAK,GAAE,KAAMkvC,GACnFA,EAAM,SAAW,UACV3K,GACP2K,EAAM,SAAW,SACjBh+B,EAAO,MAAK,EACT+9B,EAAkBC,EAAM,KAAK,EAAE,KAAK,KAChC,CAAE,OAAQh+B,EAAO,MAAO,MAAOg+B,EAAM,OAC/C,EACJ,CAER,CACD,GAAIJ,EAAO,OAAS,YAChB,GAAI9uC,EAAI,OAAO,QAAU,GAAO,CAC5B,MAAMjM,EAAO,KAAK,KAAK,OAAO,WAAW,CACrC,KAAMiM,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CAC5B,CAAiB,EACD,GAAI,CAACglC,GAAQjxC,CAAI,EACb,OAAOwwC,EACX,MAAMpuC,EAAS24C,EAAO,UAAU/6C,EAAK,MAAOg7C,CAAQ,EACpD,GAAI54C,aAAkB,QAClB,MAAM,IAAI,MAAM,iGAAiG,EAErH,MAAO,CAAE,OAAQ+a,EAAO,MAAO,MAAO/a,CAAM,CAC/C,KAEG,QAAO,KAAK,KAAK,OAAO,YAAY,CAAE,KAAM6J,EAAI,KAAM,KAAMA,EAAI,KAAM,OAAQA,CAAK,GAAE,KAAMjM,GAClFixC,GAAQjxC,CAAI,EAEV,QAAQ,QAAQ+6C,EAAO,UAAU/6C,EAAK,MAAOg7C,CAAQ,CAAC,EAAE,KAAM54C,IAAY,CAC7E,OAAQ+a,EAAO,MACf,MAAO/a,CACV,EAAC,EAJSouC,CAKd,EAGT9C,EAAK,YAAYqN,CAAM,CAC1B,CACL,CACA7I,GAAW,OAAS,CAACjyB,EAAQ86B,EAAQz2C,IAC1B,IAAI4tC,GAAW,CAClB,OAAAjyB,EACA,SAAUkyB,EAAsB,WAChC,OAAA4I,EACA,GAAGzJ,EAAoBhtC,CAAM,CACrC,CAAK,EAEL4tC,GAAW,qBAAuB,CAACkJ,EAAYn7B,EAAQ3b,IAC5C,IAAI4tC,GAAW,CAClB,OAAAjyB,EACA,OAAQ,CAAE,KAAM,aAAc,UAAWm7B,CAAY,EACrD,SAAUjJ,EAAsB,WAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAGE,MAAM+tC,WAAoBV,CAAQ,CACrC,OAAOxe,EAAO,CAEV,OADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,UACtBuC,GAAG,MAAS,EAEhB,KAAK,KAAK,UAAU,OAAO3d,CAAK,CAC1C,CACD,QAAS,CACL,OAAO,KAAK,KAAK,SACpB,CACL,CACAkf,GAAY,OAAS,CAACziC,EAAMtL,IACjB,IAAI+tC,GAAY,CACnB,UAAWziC,EACX,SAAUuiC,EAAsB,YAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMguC,WAAoBX,CAAQ,CACrC,OAAOxe,EAAO,CAEV,OADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,KACtBuC,GAAG,IAAI,EAEX,KAAK,KAAK,UAAU,OAAO3d,CAAK,CAC1C,CACD,QAAS,CACL,OAAO,KAAK,KAAK,SACpB,CACL,CACAmf,GAAY,OAAS,CAAC1iC,EAAMtL,IACjB,IAAIguC,GAAY,CACnB,UAAW1iC,EACX,SAAUuiC,EAAsB,YAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMwuC,WAAmBnB,CAAQ,CACpC,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,CAAK,EAAG,KAAK,oBAAoBknB,CAAK,EAC9C,IAAI/W,EAAOnQ,EAAI,KACf,OAAIA,EAAI,aAAesiC,EAAc,YACjCnyB,EAAO,KAAK,KAAK,gBAEd,KAAK,KAAK,UAAU,OAAO,CAC9B,KAAAA,EACA,KAAMnQ,EAAI,KACV,OAAQA,CACpB,CAAS,CACJ,CACD,eAAgB,CACZ,OAAO,KAAK,KAAK,SACpB,CACL,CACA6mC,GAAW,OAAS,CAACljC,EAAMtL,IAChB,IAAIwuC,GAAW,CAClB,UAAWljC,EACX,SAAUuiC,EAAsB,WAChC,aAAc,OAAO7tC,EAAO,SAAY,WAAaA,EAAO,QAAU,IAAMA,EAAO,QACnF,GAAGgtC,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAM2uC,WAAiBtB,CAAQ,CAClC,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,CAAK,EAAG,KAAK,oBAAoBknB,CAAK,EAExCkoB,EAAS,CACX,GAAGpvC,EACH,OAAQ,CACJ,GAAGA,EAAI,OACP,OAAQ,CAAE,CACb,CACb,EACc7J,EAAS,KAAK,KAAK,UAAU,OAAO,CACtC,KAAMi5C,EAAO,KACb,KAAMA,EAAO,KACb,OAAQ,CACJ,GAAGA,CACN,CACb,CAAS,EACD,OAAInK,GAAQ9uC,CAAM,EACPA,EAAO,KAAMA,IACT,CACH,OAAQ,QACR,MAAOA,EAAO,SAAW,QACnBA,EAAO,MACP,KAAK,KAAK,WAAW,CACnB,IAAI,OAAQ,CACR,OAAO,IAAIssC,GAAS2M,EAAO,OAAO,MAAM,CAC3C,EACD,MAAOA,EAAO,IAC1C,CAAyB,CACzB,EACa,EAGM,CACH,OAAQ,QACR,MAAOj5C,EAAO,SAAW,QACnBA,EAAO,MACP,KAAK,KAAK,WAAW,CACnB,IAAI,OAAQ,CACR,OAAO,IAAIssC,GAAS2M,EAAO,OAAO,MAAM,CAC3C,EACD,MAAOA,EAAO,IACtC,CAAqB,CACrB,CAEK,CACD,aAAc,CACV,OAAO,KAAK,KAAK,SACpB,CACL,CACApI,GAAS,OAAS,CAACrjC,EAAMtL,IACd,IAAI2uC,GAAS,CAChB,UAAWrjC,EACX,SAAUuiC,EAAsB,SAChC,WAAY,OAAO7tC,EAAO,OAAU,WAAaA,EAAO,MAAQ,IAAMA,EAAO,MAC7E,GAAGgtC,EAAoBhtC,CAAM,CACrC,CAAK,EAEE,MAAMg3C,WAAe3J,CAAQ,CAChC,OAAOxe,EAAO,CAEV,GADmB,KAAK,SAASA,CAAK,IACnBob,EAAc,IAAK,CAClC,MAAMtiC,EAAM,KAAK,gBAAgBknB,CAAK,EACtC,OAAAgd,EAAkBlkC,EAAK,CACnB,KAAMwiC,EAAa,aACnB,SAAUF,EAAc,IACxB,SAAUtiC,EAAI,UAC9B,CAAa,EACMukC,CACV,CACD,MAAO,CAAE,OAAQ,QAAS,MAAOrd,EAAM,IAAI,CAC9C,CACL,CACAmoB,GAAO,OAAUh3C,GACN,IAAIg3C,GAAO,CACd,SAAUnJ,EAAsB,OAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAGE,MAAMyuC,WAAmBpB,CAAQ,CACpC,OAAOxe,EAAO,CACV,KAAM,CAAE,IAAAlnB,CAAK,EAAG,KAAK,oBAAoBknB,CAAK,EACxC/W,EAAOnQ,EAAI,KACjB,OAAO,KAAK,KAAK,KAAK,OAAO,CACzB,KAAAmQ,EACA,KAAMnQ,EAAI,KACV,OAAQA,CACpB,CAAS,CACJ,CACD,QAAS,CACL,OAAO,KAAK,KAAK,IACpB,CACL,CACO,MAAMknC,WAAoBxB,CAAQ,CACrC,OAAOxe,EAAO,CACV,KAAM,CAAE,OAAAhW,EAAQ,IAAAlR,CAAG,EAAK,KAAK,oBAAoBknB,CAAK,EACtD,GAAIlnB,EAAI,OAAO,MAqBX,OApBoB,SAAY,CAC5B,MAAMsvC,EAAW,MAAM,KAAK,KAAK,GAAG,YAAY,CAC5C,KAAMtvC,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CAC5B,CAAiB,EACD,OAAIsvC,EAAS,SAAW,UACb/K,EACP+K,EAAS,SAAW,SACpBp+B,EAAO,MAAK,EACL0zB,GAAM0K,EAAS,KAAK,GAGpB,KAAK,KAAK,IAAI,YAAY,CAC7B,KAAMA,EAAS,MACf,KAAMtvC,EAAI,KACV,OAAQA,CAChC,CAAqB,CAErB,GAC8B,EAEjB,CACD,MAAMsvC,EAAW,KAAK,KAAK,GAAG,WAAW,CACrC,KAAMtvC,EAAI,KACV,KAAMA,EAAI,KACV,OAAQA,CACxB,CAAa,EACD,OAAIsvC,EAAS,SAAW,UACb/K,EACP+K,EAAS,SAAW,SACpBp+B,EAAO,MAAK,EACL,CACH,OAAQ,QACR,MAAOo+B,EAAS,KACpC,GAGuB,KAAK,KAAK,IAAI,WAAW,CAC5B,KAAMA,EAAS,MACf,KAAMtvC,EAAI,KACV,OAAQA,CAC5B,CAAiB,CAER,CACJ,CACD,OAAO,OAAO3J,EAAGC,EAAG,CAChB,OAAO,IAAI4wC,GAAY,CACnB,GAAI7wC,EACJ,IAAKC,EACL,SAAU4vC,EAAsB,WAC5C,CAAS,CACJ,CACL,CACO,MAAMiB,WAAoBzB,CAAQ,CACrC,OAAOxe,EAAO,CACV,MAAM/wB,EAAS,KAAK,KAAK,UAAU,OAAO+wB,CAAK,EACzCqoB,EAAUp/B,IACR60B,GAAQ70B,CAAI,IACZA,EAAK,MAAQ,OAAO,OAAOA,EAAK,KAAK,GAElCA,GAEX,OAAO80B,GAAQ9uC,CAAM,EAAIA,EAAO,KAAMga,GAASo/B,EAAOp/B,CAAI,CAAC,EAAIo/B,EAAOp5C,CAAM,CAC/E,CACD,QAAS,CACL,OAAO,KAAK,KAAK,SACpB,CACL,CACAgxC,GAAY,OAAS,CAACxjC,EAAMtL,IACjB,IAAI8uC,GAAY,CACnB,UAAWxjC,EACX,SAAUuiC,EAAsB,YAChC,GAAGb,EAAoBhtC,CAAM,CACrC,CAAK,EAiDO4yC,GAAU,WAEf,IAAI/E,GACV,SAAUA,EAAuB,CAC9BA,EAAsB,UAAe,YACrCA,EAAsB,UAAe,YACrCA,EAAsB,OAAY,SAClCA,EAAsB,UAAe,YACrCA,EAAsB,WAAgB,aACtCA,EAAsB,QAAa,UACnCA,EAAsB,UAAe,YACrCA,EAAsB,aAAkB,eACxCA,EAAsB,QAAa,UACnCA,EAAsB,OAAY,SAClCA,EAAsB,WAAgB,aACtCA,EAAsB,SAAc,WACpCA,EAAsB,QAAa,UACnCA,EAAsB,SAAc,WACpCA,EAAsB,UAAe,YACrCA,EAAsB,SAAc,WACpCA,EAAsB,sBAA2B,wBACjDA,EAAsB,gBAAqB,kBAC3CA,EAAsB,SAAc,WACpCA,EAAsB,UAAe,YACrCA,EAAsB,OAAY,SAClCA,EAAsB,OAAY,SAClCA,EAAsB,YAAiB,cACvCA,EAAsB,QAAa,UACnCA,EAAsB,WAAgB,aACtCA,EAAsB,QAAa,UACnCA,EAAsB,WAAgB,aACtCA,EAAsB,cAAmB,gBACzCA,EAAsB,YAAiB,cACvCA,EAAsB,YAAiB,cACvCA,EAAsB,WAAgB,aACtCA,EAAsB,SAAc,WACpCA,EAAsB,WAAgB,aACtCA,EAAsB,WAAgB,aACtCA,EAAsB,YAAiB,cACvCA,EAAsB,YAAiB,aAC3C,GAAGA,IAA0BA,EAAwB,CAAE,EAAC,EAUxD,MAAMsJ,GAAavG,GAAU,OAWX6B,GAAS,OAETxE,GAAS,OAC3B,MAAMmJ,GAAaxE,GAAU,OACJA,GAAU,aACjBxE,GAAS,OAEFE,GAAgB,OACvByE,GAAS,OAO3B,MAAMsE,GAAWpB,GAAQ,OAEL/H,GAAW,OAEVH,GAAY,OACZC,GAAY,OCzlHpB,MAAAsJ,GAAYC,GAAS,CAChC,KAAMC,GAAO,CAAC,cAAe,aAAc,MAAM,CAAC,EAClD,cAAeC,GAAS,EAAE,SAAS,EACnC,yBAA0BA,GAAS,EAAE,SAAS,EAC9C,qBAAsBD,GAAO,CAAC,OAAQ,SAAU,UAAU,CAAC,EAAE,QAAQ,MAAM,CAC7E,CAAC,ECLYn6B,GAAMi6B,GAAU,MAAM,CACjC,KAAM,aACN,cAAe,OACf,yBAA0B,GAAgB,yBAC1C,wBAAsC,oBACxC,CAAC,ECAYI,GAAY,CACvB,GAAGr6B,GACH,IAAK,GACL,KAAM,GACN,IAAK,GAEL,kBAAmB,4BACnB,uBAAwB,mNACxB,kBAAmB,wBACnB,wBAAyB,GAAgB,wBACzC,qBAAsB,GAAgB,qBACtC,+BAAgC,GAAgB,+BAChD,sBAAuB,GAAgB,sBACvC,mBAAoB,GAAgB,mBACpC,qBAAsB,GAAgB,qBACtC,uBAAwB,IACxB,uBAAwB,GAAgB,uBACxC,WAAY,GAAgB,WAC5B,sBAAuB,GAAgB,sBACvC,6BAA8B,GAAgB,6BAC9C,4BAA0C,wBAC5C,ECxBas6B,GAAQD,GAAU,IAClBE,GAASF,GAAU,KACnB7qC,GAAO6qC,GAAU,KAGjBG,GAAWH,GAAU,cACrBI,GAAeJ,GAAU,kBACzBK,GAAoBL,GAAU,uBAC9BM,GAAeN,GAAU,kBAGzBO,GAAqBP,GAAU,0BAA4B,IAC3DQ,GAAkBR,GAAU,uBAAyB,IACrDS,GAA4BT,GAAU,iCAAmC,IACzEU,GAAmBV,GAAU,wBAA0B,IACvDW,GAAgBX,GAAU,qBAAuB,IACjDY,GAAkBZ,GAAU,uBAAyB,IACrDa,GAAoBb,GAAU,yBAA2B,IACzDc,GAAoBd,GAAU,yBAA2B,IAGzDe,GAAgBf,GAAU,aAAe,OAGzCgB,GAAmBhB,GAAU,sBAC7BiB,GAA0BjB,GAAU,6BACpCkB,GAAsBlB,GAAU,yBAetC,SAASmB,IAA0C,CAClD,MAAAjc,EAAW,OAAO,SAAS,SAC3Bkc,EAAW,OAAO,SAAS,SAC3BC,EAAqB,OAAO,OAAW,KAAe,EAAQjS,IAAW,qBACzEkS,EAAgB,kCAWtB,GAAIpc,IAAa,oBAAsBA,IAAa,gBAAkBA,IAAa,mBAS1ExhB,MAR2B,CAChC,OAAQ49B,EACR,UAAWA,EACX,YAAa,aACb,cAAe,GACf,aAAc,IAOlB,GAAIpc,IAAa,mBASRxhB,MAR2B,CAChC,OAAQ,kCACR,UAAW,kCACX,YAAa,UACb,cAAe,GACf,aAAc,IAOd,GAAAwhB,EAAS,SAAS,YAAY,EASzBxhB,MAR2B,CAChC,OAAQ49B,EACR,UAAWA,EACX,YAAa,aACb,cAAe,GACf,aAAc,IAOd,GAAAD,GAAsB,CAACpB,GASlBv8B,MAR2B,CAChC,OAAQ49B,EACR,UAAWA,EACX,YAAa,aACb,cAAe,GACf,aAAc,IAQd,GAASnsC,KAAS,cAAe,CAE7B,MAAAosC,EADarc,IAAa,aAAeA,EAAS,WAAW,MAAM,EAC5C,YAAcA,EACrCsc,EAAY,GAAGJ,CAAQ,KAAKG,CAAO,QASlC79B,MAR2B,CAChC,OAAQ89B,EACR,UAAWA,EACX,YAAa,cACb,cAAe,GACf,aAAc,GAIlB,CAGA,OAAIrB,GACgC,CAChC,OAAQA,GACR,UAAWA,GACX,YAAsB,aACtB,cAAe,CAACD,GAChB,aAAcA,EAAA,EAOd,CAACmB,IAAuBnc,IAAa,aAAeA,EAAS,WAAW,WAAW,GAAKA,EAAS,WAAW,UAAU,GACtF,CAChC,OAAQ,wBACR,UAAW,wBACX,YAAa,cACb,cAAe,GACf,aAAc,IAOgB,CAChC,OAAQoc,EACR,UAAWA,EACX,YAAa,aACb,cAAe,GACf,aAAc,GAIlB,CAEO,SAASG,IAAoB,CAClC,OAAON,GAAuB,QAChC,CAEO,SAASO,IAAuB,CAWrC,OAVeP,KAUD,SAChB,CAEO,SAASQ,IAAyB,CACvC,OAAOR,GAAuB,eAChC,CAEO,SAASS,IAAwB,CACtC,OAAOT,GAAuB,cAChC,shBCrLMtpB,GAAcuoB,GACdyB,GAAkBxB,GAoBlB7S,GAAmB,IAAM,CAC7B,GAAI,OAAO,OAAW,IAAoB,SAG1C,MAAMsU,EAAkB,EAAQ1S,IAAW,mBAAoB,EAGzD2S,EAAgB3S,IAAW,kBAAoB,MAgB9C,OAXU0S,GAAmBC,CAYtC,EAIA,SAASC,GAAeC,EAAe,CAC/B,MAAAC,EAAcl+C,GAAiB,CACnC,GAAI,CAACi+C,EAAa,OAAAj+C,EAClB,MAAMouC,EAAYpuC,EAAK,SAAS,GAAG,EAAI,IAAM,IAC7C,MAAO,GAAGA,CAAI,GAAGouC,CAAS,QAAQ,mBAAmB6P,CAAI,CAAC,IAU5D,GAPezU,KAUb,OAAO0U,EAFa,0BAES,EAO/B,GAHmB,OAAO,SAAS,WAAa,aAAe,OAAO,SAAS,WAAa,YAG5E,CAER,MAAAC,EAAW,GADK,OAAO,SAAS,MACL,iBAIjC,OAAOD,EAAWC,CAAQ,CAC5B,CAGI,SAAgB,uBAIXD,EAAW,GAAgB,sBAAsB,EAQnDA,EAJS,wCAIS,CAC3B,CAEO,MAAME,GAAwBH,GAAkBD,GAAeC,CAAI,EAE1E,IAAII,GAAkD,KAEtD,MAAMC,GAA2B,SAAY,CACvC,IAAC9U,MAAsB6U,GAAoB,OAmF1BA,GAjFN,MAAME,GAAa,YAAY,aAAc,MAAO,CAAE,IAAA/+C,KAAU,CACzE,IAMF,MAAMg/C,EAAqBh/C,GAAOA,EAAI,WAAW,0BAA0B,EAGrEi/C,EAAkBj/C,IACtBA,EAAI,SAAS,gCAAgC,GAC7CA,EAAI,SAAS,yBAAyB,GACtCA,EAAI,SAAS,yBAAyB,GAGpC,IAACg/C,GAAsB,CAACC,EAE1B,OAYF,GANA,MAAMhR,GAAQ,QAAQ,MAAO/f,GAAQ,EAEpC,EAIG8wB,EAAoB,CAItB,IAAIrzB,EAAsB,KACtB/sB,EAAuB,KAEvB,IAEF,MAAMsgD,EAAS,IAAI,IAAIl/C,EAAI,QAAQ,cAAe,UAAU,CAAC,EACtD2rB,EAAAuzB,EAAO,aAAa,IAAI,MAAM,EAC7BtgD,EAAAsgD,EAAO,aAAa,IAAI,OAAO,OAG3B,CAEd,CAGA,GAAIvzB,EACE,IAEI,MAAE,KAAA/O,EAAM,MAAA3c,GAAU,MAAMk/C,EAAS,KAAK,uBAAuBxzB,CAAI,EAEnE1rB,GAGO2c,GAAM,aAGL,CAEd,CAEJ,CAGA,OAAO,cAAc,IAAI,YAAY,mBAAoB,CAAE,OAAQ,CAAE,QAAS,GAAO,UAAW,EAAK,EAAG,CAAC,EAIzG,MAAMwiC,EAAe,kBAAoBp/C,EAAI,SAAS,GAAG,EAAIA,EAAI,UAAUA,EAAI,QAAQ,GAAG,CAAC,EAAI,IAK/F,OAAO,SAAS,KAAOo/C,OACX,CAEd,EACD,CAIH,EAEMC,GAAiB,IAAM,CAC3B,GAAI,SAAO,OAAW,KAClB,IACF,OAAO,OAAO,kBACA,CAEP,MACT,CACF,EAEMC,GAAuB,CAC3B,KAAM,CACJ,iBAAkB,GAClB,eAAgB,GAChB,mBAAoB,GACpB,SAAU,MACZ,EACA,GAAI,CACF,OAAQ,QACV,EACA,OAAQ,CACN,QAAS,CACP,gBAAiB,oBACnB,CACF,CACF,EAEMC,GAAcF,GAAe,EAC/BE,KACFD,GAAgB,KAAO,CACrB,GAAGA,GAAgB,KACnB,QAASC,GACT,WAAY,qBAUhB,MAAMC,GAAqB,WAGdL,EACXK,GAAmB,oBAClBrW,GAAa9U,GAAagqB,GAAiBiB,EAAe,EAExDE,GAAmB,qBACtBA,GAAmB,mBAAqBL,GA4BnC,MAAMvuB,GAAO,CAClB,OAAQ,MAAOyM,EAAewG,EAAkB4b,EAAgB,KAAO,CACjE,IACF,KAAM,CAAE,KAAA7iC,EAAM,MAAA3c,CAAA,EAAU,MAAMk/C,EAAS,KAAK,OAAO,CACjD,MAAA9hB,EACA,SAAAwG,EACA,QAAS,CACP,KAAM4b,EACN,gBAAiBjB,GAAe,CAClC,EACD,EAMM,OAAE,KAAA5hC,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,OAAQ,MAAOo9B,EAAewG,IAAqB,CAC7C,IACF,KAAM,CAAE,KAAAjnB,EAAM,MAAA3c,CAAA,EAAU,MAAMk/C,EAAS,KAAK,mBAAmB,CAC7D,MAAA9hB,EACA,SAAAwG,CAAA,CACD,EAMM,OAAE,KAAAjnB,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEI,gBAAiB,MAAO8kC,EAAyBznC,IAAgC,CAC/E,MAAMoiD,EAAS1V,KACX0V,GACF,MAAMZ,GAAyB,EAG7B,IAWI,MAAAa,EAAcnB,GAAelhD,GAAS,IAAI,EAM5CoiD,GACK,qBAAc,IAAI,YAAY,mBAAoB,CAAE,OAAQ,CAAE,QAAS,GAAQ,EAAC,EAGzF,KAAM,CAAE,KAAA9iC,EAAM,MAAA3c,CAAA,EAAS,MAAMk/C,EAAS,KAAK,gBAAgB,CACzD,SAAApa,EACA,QAAS,CACP,WAAY4a,EACZ,oBAAqBD,EACrB,YAAa,CACX,YAAa,UACb,OAAQ,SACV,CACF,EACD,EAED,OAAIz/C,EAEEy/C,GACF,OAAO,cAAc,IAAI,YAAY,mBAAoB,CAAE,OAAQ,CAAE,QAAS,GAAO,MAAO,EAAK,EAAG,CAAC,EAE9FA,GAAU9iC,GAAM,KAUzB,MAAMqxB,GAAQ,KAAK,CACjB,IAAKrxB,EAAK,IACV,kBAAmB,aACpB,EAGI,CAAE,KAAAA,EAAM,MAAA3c,SACRA,EAAY,CAEnB,OAAIy/C,GACF,OAAO,cAAc,IAAI,YAAY,mBAAoB,CAAE,OAAQ,CAAE,QAAS,GAAO,MAAO,EAAK,EAAG,CAAC,EAEhG,CAAE,KAAM,KAAM,MAAO,CAAE,QAASz/C,EAAM,SAAW,gCAC1D,CACF,EAEJ,QAAS,SAAY,CACf,IACF,KAAM,CAAE,MAAAA,CAAM,EAAI,MAAMk/C,EAAS,KAAK,QAAQ,EAM9C,MAAO,CAAE,MAAAl/C,CAAM,QACRA,EAAY,CAEnB,MAAO,CAAE,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC9C,CACF,EAEA,eAAgB,SAAY,CACtB,IACI,MAAE,KAAM,CAAE,KAAAw7B,GAAQ,MAAAx7B,CAAU,QAAMk/C,EAAS,KAAK,UAM/C,OAAE,KAAA1jB,EAAM,MAAAx7B,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,kBAAoBqU,GACX6qC,EAAS,KAAK,kBAAkB7qC,CAAQ,CAEnD,EAGasrC,GAAW,CACtB,YAAa,CACX,MAAM,OAAOt/B,EAAe,GAAI,CAC1B,IACF,IAAIL,EAAQk/B,EACT,KAAK,aAAa,EAClB,OAAO;AAAA;AAAA;AAAA;AAAA,WAIP,EAEC7+B,EAAQ,WACVL,EAAQA,EAAM,GAAG,WAAYK,EAAQ,QAAQ,GAG3CA,EAAQ,SACVL,EAAQA,EAAM,GAAG,SAAUK,EAAQ,MAAM,GAGvCA,EAAQ,SACFL,IAAM,GAAG,gBAAgBK,EAAQ,MAAM,wBAAwBA,EAAQ,MAAM,GAAG,GAG1F,KAAM,CAAE,KAAA1D,EAAM,MAAA3c,CAAA,EAAU,MAAMggB,EAC3B,MAAM,aAAc,CAAE,UAAW,EAAO,GACxC,MAAMK,EAAQ,OAAS,EAAE,EAE5B,OAAIrgB,GAAS,CAACA,EAAM,QAAQ,SAAS,UAAU,GAAMA,EAAM,QAAQ,SAAS,gBAAgB,EAIrF,CAAE,KAAA2c,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,MAAM,QAAQgN,EAAY,CACpB,IACI,MAAE,KAAA2P,EAAM,MAAA3c,GAAU,MAAMk/C,EAC3B,KAAK,aAAa,EAClB,OAAO;AAAA;AAAA;AAAA;AAAA,WAIP,EACA,GAAG,KAAMlyC,CAAE,EACX,OAAO,EAEV,OAAIhN,GAAS,CAACA,EAAM,QAAQ,SAAS,UAAU,GAAMA,EAAM,QAAQ,SAAS,gBAAgB,EAIrF,CAAE,KAAA2c,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,MAAM,OAAO4/C,EAAqB,CAC5B,IACF,KAAM,CAAE,KAAAjjC,EAAM,MAAA3c,GAAU,MAAMk/C,EAC3B,KAAK,aAAa,EAClB,OAAOU,CAAc,EACrB,SACA,OAAO,EAMH,OAAE,KAAAjjC,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,CACF,EAEA,MAAO,CACL,MAAM,WAAW6/C,EAAgB,CAC3B,IACF,KAAM,CAAE,KAAAljC,EAAM,MAAA3c,CAAA,EAAU,MAAMk/C,EAC3B,KAAK,OAAO,EACZ,OAAO,GAAG,EACV,GAAG,KAAMW,CAAM,EACf,SAEH,OAAI7/C,GAAS,CAACA,EAAM,QAAQ,SAAS,UAAU,GAAMA,EAAM,QAAQ,SAAS,gBAAgB,EAIrF,CAAE,KAAA2c,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,MAAM,cAAc6/C,EAAgBC,EAAc,CAC5C,IACF,KAAM,CAAE,KAAAnjC,EAAM,MAAA3c,GAAU,MAAMk/C,EAC3B,KAAK,OAAO,EACZ,OAAOY,CAAO,EACd,GAAG,KAAMD,CAAM,EACf,SACA,SAMI,OAAE,KAAAljC,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,CACF,EAEA,QAAS,CACP,MAAM,WAAW6/C,EAAgBE,EAAmB,MAAO,CACrD,IACI,MAAE,KAAApjC,EAAM,MAAA3c,GAAU,MAAMk/C,EAC3B,KAAK,SAAS,EACd,OAAO,GAAG,EACV,GAAG,UAAWW,CAAM,EACpB,GAAG,WAAYE,CAAQ,EACvB,SAEH,OAAI//C,GAAS,CAACA,EAAM,QAAQ,SAAS,UAAU,GAAMA,EAAM,QAAQ,SAAS,gBAAgB,EAIrF,CAAE,KAAA2c,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,MAAM,gBAAgB6/C,EAAgBG,EAAgB,GAAI,CACpD,IACI,MAAE,KAAArjC,EAAM,MAAA3c,CAAA,EAAU,MAAMk/C,EAC3B,KAAK,qBAAqB,EAC1B,OAAO,GAAG,EACV,GAAG,UAAWW,CAAM,EACpB,MAAM,aAAc,CAAE,UAAW,GAAO,EACxC,MAAMG,CAAK,EAEd,OAAIhgD,GAAS,CAACA,EAAM,QAAQ,SAAS,UAAU,GAAMA,EAAM,QAAQ,SAAS,gBAAgB,EAIrF,CAAE,KAAA2c,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,CACF,EAGA,SAAU,CACR,MAAM,kBAAkBigD,EAAsBD,EAAgB,GAAI,CAC5D,IACI,MAAE,KAAArjC,EAAM,MAAA3c,GAAU,MAAMk/C,EAC3B,KAAK,UAAU,EACf,OAAO;AAAA;AAAA;AAAA,WAGP,EACA,GAAG,gBAAiBe,CAAY,EAChC,GAAG,oBAAqB,IAAI,EAC5B,MAAM,aAAc,CAAE,UAAW,EAAO,GACxC,MAAMD,CAAK,EAEd,OAAIhgD,GAAS,CAACA,EAAM,QAAQ,SAAS,UAAU,GAAMA,EAAM,QAAQ,SAAS,gBAAgB,EAIrF,CAAE,KAAA2c,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,EAEA,MAAM,OAAOkgD,EAAkB,CACzB,IACF,KAAM,CAAE,KAAAvjC,EAAM,MAAA3c,CAAM,EAAI,MAAMk/C,EAC3B,KAAK,UAAU,EACf,OAAOgB,CAAW,EAClB,OAAO;AAAA;AAAA;AAAA,WAGP,EACA,SAMI,OAAE,KAAAvjC,EAAM,MAAA3c,SACRA,EAAY,CAEZ,OAAE,KAAM,KAAM,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC1D,CACF,CACF,CACF,EAEI+pC,MACuB8U,KCzkBpB,MAAMsB,GAAiBC,GAAoB,EAC9C,CAAC3tC,EAAK6O,KAAS,CACb,SAAU,CAAC,EACX,aAAc,CAAC,EACf,UAAW,GACX,MAAO,KACP,cAAe,KAGf,IAAI,SAAU,CAGZ,OAFcA,IACW,SAAS,KAAUxe,KAAE,WAAa,KAAK,GAC7C,WAAa,CAClC,EAEA,IAAI,cAAe,CAGjB,OAFcwe,IACW,SAAS,KAAUxe,KAAE,WAAa,KAAK,GAC7C,OAAS,CAC9B,EAEA,IAAI,iBAAkB,CAGpB,OAFcwe,IACW,SAAS,KAAUxe,KAAE,WAAa,KAAK,GAC7C,UAAY,CACjC,EAEA,iBAAkB,SAAY,CAKxB2P,EAAA,CACF,SAAU,CAAC,EACX,aAAc,CAAC,EACf,UAAW,GACX,MAAO,KACR,CACH,EAEA,kBAAmB,SAAY,CACvB,MAAA6O,EAAA,EAAM,kBACd,EAGA,UAAW,MAAO++B,EAAgBN,EAAkB,QAAU,CACxD,IAEF,GAAI,MAAMM,CAAM,GAAKA,GAAU,EACvB,UAAI,MAAM,6BAA6B,EAI/C,MAAMC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EAEvE,GAAI,CAACO,GAAkBA,EAAe,UAAYD,EAC1C,UAAI,MAAM,oBAAoB,EAIhC,MAAAE,EAAeD,EAAe,UAAYD,EAC1CG,EAAcF,EAAe,SAAWD,EAGxCI,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,WACN,OAAAJ,EACA,YAAa,8BACb,SAAU,KACV,OAAQ,YACR,UAAW,QAAQ,KAAK,IAAK,IAC7B,SAAAN,EACA,IAAK,GAGPttC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IACvB+hD,KAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,UAAWH,EAAc,SAAUC,EAAa,MAAOD,EAAeC,CACpF,EAAAE,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,MAAO,IACP,IAKE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IACF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBQ,EACnB,iBAAkBC,EAClB,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CACD,WAAY,mBACb,EAEH,MAAMtB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAMilB,EAAY,KAClB,SAAUA,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAEW,CAElB,QAEOzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,uBAC1D,MAAAyS,EAAA,CAAE,MAAO0P,CAAA,CAAc,EACrBniB,CACR,CACF,EAEA,SAAU,MAAOqgD,EAAgBN,EAAkB,MAAOlwC,EAAiB,kBAAoB,CAC7F4C,EAAI,CAAE,UAAW,GAAM,MAAO,IAAM,GAEhC,IAEF,GAAI,MAAM4tC,CAAM,GAAKA,GAAU,EACvB,UAAI,MAAM,6BAA6B,EAI/C,MAAMC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EACjEQ,GAAgBD,GAAgB,WAAa,GAAKD,EAClDM,EAAWJ,GAAgBD,GAAgB,UAAY,GAGvDG,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,UACN,OAAAJ,EACA,YAAa,GAAGxwC,CAAM,WACtB,SAAU,KACV,OAAQ,YACR,UAAW,OAAO,KAAK,IAAK,IAC5B,SAAAkwC,EACA,IAAK,GAIPttC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IAAI+hD,GAC3BA,EAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,UAAWH,EAAc,MAAOI,CAC9C,EAAAD,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,UAAW,GACX,MAAO,IACP,IAGE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IAEF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBQ,EACnB,iBAAkBD,GAAgB,UAAY,EAC9C,iBAAkBA,GAAgB,WAAa,GAAKD,EACpD,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CACD,WAAY,mBACb,EAGH,MAAMnB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAMilB,EAAY,KAClB,SAAUA,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAIW,CAGlB,CAEO,OAAAA,QAEAzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,sBAC9D,MAAAyS,EAAI,CAAE,UAAW,GAAO,MAAO0P,CAAc,GACvCniB,CACR,CACF,EAEA,SAAU,MAAOqgD,EAAgBN,EAAkB,MAAOa,EAAsB,iBAAmB,CACjGnuC,EAAI,CAAE,UAAW,GAAM,MAAO,IAAM,GAEhC,IAEF,GAAI,MAAM4tC,CAAM,GAAKA,GAAU,EACvB,UAAI,MAAM,6BAA6B,EAI/C,MAAMC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EAEvE,GAAI,CAACO,GAAkBA,EAAe,UAAYD,EAC1C,UAAI,MAAM,oBAAoB,EAGhC,MAAAE,EAAeD,EAAe,UAAYD,EAC1CM,EAAWJ,EAAeD,EAAe,SAGzCG,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,WACN,OAAAJ,EACA,YAAa,iBAAiBO,CAAW,GACzC,SAAU,KACV,OAAQ,YACR,UAAW,OAAO,KAAK,IAAK,IAC5B,SAAAb,EACA,IAAK,GAIPttC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IAAI+hD,GAC3BA,EAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,UAAWH,EAAc,MAAOI,CAC9C,EAAAD,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,UAAW,GACX,MAAO,IACP,IAGE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IACF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBQ,EACnB,iBAAkBD,EAAe,SACjC,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CAAE,WAAY,mBAAoB,EAEvC,MAAMpB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAMilB,EAAY,KAClB,SAAUA,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAEW,CAElB,CAGO,OAAAA,QAEAzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,2BAC9D,MAAAyS,EAAI,CAAE,UAAW,GAAO,MAAO0P,CAAc,GACvCniB,CACR,CACF,EAEA,eAAgB,MAAOqgD,EAAgBrO,EAAqBiO,EAAsBF,EAAkB,QAAU,CAC5GttC,EAAI,CAAE,UAAW,GAAM,MAAO,IAAM,GAEhC,IAEF,GAAI,MAAM4tC,CAAM,GAAKA,GAAU,EACvB,UAAI,MAAM,6BAA6B,EAI/C,MAAMC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EAEvE,GAAI,CAACO,GAAkBA,EAAe,UAAYD,EAC1C,UAAI,MAAM,oBAAoB,EAGhC,MAAAE,EAAeD,EAAe,UAAYD,EAC1CG,EAAcF,EAAe,SAAWD,EACxCM,EAAWJ,EAAeC,EAG1BC,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,WACN,OAAAJ,EACA,YAAArO,EACA,SAAU,KACV,OAAQ,YACR,UAAW,QAAQ,KAAK,IAAK,IAC7B,SAAA+N,EACA,IAAK,EACL,aAAAE,CAAA,EAIFxtC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IACvB+hD,KAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,UAAWH,EAAc,SAAUC,EAAa,MAAOG,CACrE,EAAAD,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,UAAW,GACX,MAAO,IACP,IAGE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IACF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBQ,EACnB,iBAAkBC,EAClB,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CAAE,WAAY,mBAAoB,EAEvC,MAAMtB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAMilB,EAAY,KAClB,SAAUA,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAEW,CAElB,CAGO,OAAAA,QAEAzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,4BAC9D,MAAAyS,EAAI,CAAE,UAAW,GAAO,MAAO0P,CAAc,GACvCniB,CACR,CACF,EAEA,UAAW,MAAOqgD,EAAgBrO,EAAqBiO,EAAsBF,EAAkB,QAAU,CACvGttC,EAAI,CAAE,UAAW,GAAM,MAAO,IAAM,GAEhC,IAEF,MAAM6tC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EACjEQ,GAAgBD,GAAgB,WAAa,GAAKD,EAClDG,EAAc,KAAK,IAAI,GAAIF,GAAgB,UAAY,GAAKD,CAAM,EAClEM,EAAWJ,EAAeC,EAG1BC,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,MACN,OAAAJ,EACA,YAAArO,EACA,SAAU,KACV,OAAQ,YACR,UAAW,OAAO,KAAK,IAAK,IAC5B,SAAA+N,EACA,IAAK,EACL,aAAAE,CAAA,EAIFxtC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IACvB+hD,KAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,UAAWH,EAAc,SAAUC,EAAa,MAAOG,CACrE,EAAAD,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,UAAW,GACX,MAAO,IACP,IAGE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IACF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBQ,EACnB,iBAAkBC,EAClB,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CAAE,WAAY,mBAAoB,EAEvC,MAAMtB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAM,cACN,SAAUilB,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,cAAeR,EACf,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAEW,CAElB,CAGO,OAAAQ,QAEAzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,uBAC9D,MAAAyS,EAAI,CAAE,UAAW,GAAO,MAAO0P,CAAc,GACvCniB,CACR,CACF,EAEA,WAAY,MAAOqgD,EAAgBrO,EAAqBiO,EAAsBF,EAAkB,QAAU,CACxGttC,EAAI,CAAE,UAAW,GAAM,MAAO,IAAM,GAEhC,IAEF,MAAM6tC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EACjES,EAAc,KAAK,IAAI,GAAIF,GAAgB,UAAY,GAAKD,CAAM,EAClEM,GAAYL,GAAgB,WAAa,GAAKE,EAG9CC,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,OACN,OAAAJ,EACA,YAAArO,EACA,SAAU,KACV,OAAQ,YACR,UAAW,QAAQ,KAAK,IAAK,IAC7B,SAAA+N,EACA,IAAK,EACL,aAAAE,CAAA,EAIFxtC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IAAI+hD,GAC3BA,EAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,SAAUF,EAAa,MAAOG,CAC5C,EAAAD,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,UAAW,GACX,MAAO,IACP,IAGE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IACF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBO,GAAgB,WAAa,EAChD,iBAAkBE,EAClB,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CAAE,WAAY,mBAAoB,EAEvC,MAAMtB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAM,OACN,SAAUilB,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,cAAeR,EACf,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAEW,CAElB,CAGO,OAAAQ,QAEAzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,wBAC9D,MAAAyS,EAAI,CAAE,UAAW,GAAO,MAAO0P,CAAc,GACvCniB,CACR,CACF,EAEA,cAAe,MAAOqgD,EAAgBQ,EAAgB7O,EAAsB+N,EAAkB,QAAU,CACtGttC,EAAI,CAAE,UAAW,GAAM,MAAO,IAAM,GAEhC,IAEF,GAAI,MAAM4tC,CAAM,GAAKA,GAAU,EACvB,UAAI,MAAM,6BAA6B,EAI/C,MAAMC,EADQh/B,IACe,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,EAEvE,GAAI,CAACO,GAAkBA,EAAe,UAAYD,EAC1C,UAAI,MAAM,oBAAoB,EAGhC,MAAAE,EAAeD,EAAe,UAAYD,EAC1CM,EAAWJ,EAAeD,EAAe,SAGzCG,EAA2B,CAC/B,GAAI,MAAM,KAAK,IAAK,KAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAC/D,KAAM,eACN,OAAAJ,EACA,YAAarO,GAAe,eAAe6O,CAAM,GACjD,SAAU,KACV,OAAQ,YACR,UAAW,OAAO,KAAK,IAAK,IAC5B,SAAAd,EACA,IAAK,EACL,OAAAc,CAAA,EAIFpuC,EAAI9T,IAAU,CACZ,SAAUA,EAAM,SAAS,IAAI+hD,GAC3BA,EAAQ,WAAaX,EACjB,CAAE,GAAGW,EAAS,UAAWH,EAAc,MAAOI,CAC9C,EAAAD,CACN,EACA,aAAc,CAACD,EAAa,GAAG9hD,EAAM,YAAY,EACjD,UAAW,GACX,MAAO,IACP,IAGE,IACI,MAAE,KAAM,CAAE,KAAA68B,IAAW,MAAM0jB,EAAS,KAAK,UAC3C1jB,IACF,MAAM0jB,EACH,KAAK,SAAS,EACd,OAAO,CACN,QAAS1jB,EAAK,GACd,SAAAukB,EACA,kBAAmBQ,EACnB,iBAAkBD,EAAe,SACjC,WAAY,IAAI,KAAK,EAAE,YAAY,GAClC,CAAE,WAAY,mBAAoB,EAEvC,MAAMpB,EACH,KAAK,qBAAqB,EAC1B,OAAO,CACN,QAAS1jB,EAAK,GACd,KAAMilB,EAAY,KAClB,SAAUA,EAAY,SACtB,OAAQA,EAAY,OACpB,OAAQA,EAAY,OACpB,UAAWA,EAAY,UACvB,YAAaA,EAAY,YACzB,QAASI,EACT,WAAY,IAAI,KAAK,EAAE,YAAY,EACpC,QAEW,CAElB,CAGO,OAAAJ,QAEAzgD,EAAO,CACd,MAAMmiB,EAAeniB,aAAiB,MAAQA,EAAM,QAAU,2BAC9D,MAAAyS,EAAI,CAAE,UAAW,GAAO,MAAO0P,CAAc,GACvCniB,CACR,CACF,EAEA,WAAY,CAAC+/C,EAAkB,QACfz+B,IACQ,SAAS,KAAUxe,KAAE,WAAai9C,CAAQ,GAChD,WAAa,EAG/B,sBAAwB1/B,GAAmE,CAEzF,IAAIygC,EAAe,CAAC,GADNx/B,IACe,YAAY,EAEzC,OAAIjB,GAAS,OACXygC,EAAeA,EAAa,OAAOC,GAAMA,EAAG,OAAS1gC,EAAQ,IAAI,GAG/DA,GAAS,WACXygC,EAAeA,EAAa,OAAOC,GAAMA,EAAG,WAAa1gC,EAAQ,QAAQ,GAGvEA,GAAS,QACXygC,EAAeA,EAAa,MAAM,EAAGzgC,EAAQ,KAAK,GAG7CygC,CACT,EAEA,WAAY,IAAM,CACZruC,EAAA,CAAE,MAAO,KAAM,CACrB,GAEJ,EChsBIuuC,GAAqC,IAAI,IACzCC,GAA6B/wC,GAAS,CAC1C,MAAMgxC,EAAMF,GAAmB,IAAI9wC,CAAI,EACvC,OAAKgxC,EACE,OAAO,YACZ,OAAO,QAAQA,EAAI,MAAM,EAAE,IAAI,CAAC,CAACtiD,EAAKuiD,CAAI,IAAM,CAACviD,EAAKuiD,EAAK,SAAU,EAAC,CAC1E,EAHmB,EAInB,EACMC,GAA+B,CAACpjB,EAAOqjB,EAAoBhkD,IAAY,CAC3E,GAAI2gC,IAAU,OACZ,MAAO,CACL,KAAM,YACN,WAAYqjB,EAAmB,QAAQhkD,CAAO,CACpD,EAEE,MAAMikD,EAAqBN,GAAmB,IAAI3jD,EAAQ,IAAI,EAC9D,GAAIikD,EACF,MAAO,CAAE,KAAM,UAAW,MAAAtjB,EAAO,GAAGsjB,CAAkB,EAExD,MAAMC,EAAgB,CACpB,WAAYF,EAAmB,QAAQhkD,CAAO,EAC9C,OAAQ,CAAE,CACd,EACE,OAAA2jD,GAAmB,IAAI3jD,EAAQ,KAAMkkD,CAAa,EAC3C,CAAE,KAAM,UAAW,MAAAvjB,EAAO,GAAGujB,CAAa,CACnD,EACMC,GAAe,CAACphD,EAAIqhD,EAAkB,CAAE,IAAK,CAAChvC,EAAK6O,EAAK4/B,IAAQ,CACpE,KAAM,CAAE,QAAAQ,EAAS,oBAAAC,EAAqB,MAAA3jB,EAAO,GAAG3gC,CAAS,EAAGokD,EAC5D,IAAIJ,EACJ,GAAI,CACFA,GAAsBK,GAA6B,KAAsE,OAAO,4BACjI,MAAY,CACZ,CACD,GAAI,CAACL,EAMH,OAAOjhD,EAAGqS,EAAK6O,EAAK4/B,CAAG,EAEzB,KAAM,CAAE,WAAAU,EAAY,GAAGC,CAAuB,EAAGT,GAA6BpjB,EAAOqjB,EAAoBhkD,CAAO,EAChH,IAAIykD,EAAc,GAClBZ,EAAI,SAAW,CAACviD,EAAOojD,EAASC,IAAiB,CAC/C,MAAMj5B,EAAItW,EAAI9T,EAAOojD,CAAO,EAC5B,GAAI,CAACD,EAAa,OAAO/4B,EACzB,MAAMzpB,EAAS0iD,IAAiB,OAAS,CAAE,KAAML,GAAuB,WAAa,EAAG,OAAOK,GAAiB,SAAW,CAAE,KAAMA,CAAY,EAAKA,EACpJ,OAAIhkB,IAAU,QACkB4jB,GAAW,KAAKtiD,EAAQgiB,EAAG,CAAE,EACpDyH,IAEqB64B,GAAW,KACvC,CACE,GAAGtiD,EACH,KAAM,GAAG0+B,CAAK,IAAI1+B,EAAO,IAAI,EAC9B,EACD,CACE,GAAG2hD,GAA0B5jD,EAAQ,IAAI,EACzC,CAAC2gC,CAAK,EAAGkjB,EAAI,SAAU,CACxB,CACP,EACWn4B,EACX,EACE,MAAMk5B,EAAuB,IAAIp/C,IAAM,CACrC,MAAMq/C,EAAsBJ,EAC5BA,EAAc,GACdrvC,EAAI,GAAG5P,CAAC,EACRi/C,EAAcI,CAClB,EACQC,EAAe/hD,EAAG8gD,EAAI,SAAU5/B,EAAK4/B,CAAG,EAc9C,GAbIW,EAAsB,OAAS,YACHD,GAAW,KAAKO,CAAY,GAE1DN,EAAsB,OAAOA,EAAsB,KAAK,EAAIX,EAC9BU,GAAW,KACvC,OAAO,YACL,OAAO,QAAQC,EAAsB,MAAM,EAAE,IAAI,CAAC,CAACjjD,EAAKwjD,CAAM,IAAM,CAClExjD,EACAA,IAAQijD,EAAsB,MAAQM,EAAeC,EAAO,SAAU,CAChF,CAAS,CACF,CACP,GAEMlB,EAAI,sBAAwB,OAAOA,EAAI,UAAa,WAAY,CAClE,IAAImB,EAAiC,GACrC,MAAMC,EAAmBpB,EAAI,SAC7BA,EAAI,SAAW,IAAIr+C,IAAM,CAOvBy/C,EAAiB,GAAGz/C,CAAC,CAC3B,CACG,CACD,OAAA++C,EAAW,UAAWzjD,GAAY,CAChC,IAAI4d,EACJ,OAAQ5d,EAAQ,KAAI,CAClB,IAAK,SACH,OAAI,OAAOA,EAAQ,SAAY,SAI7B,OAEKokD,GACLpkD,EAAQ,QACPmB,GAAW,CACV,GAAIA,EAAO,OAAS,aAAc,CAChC,GAAI0+B,IAAU,OAAQ,CACpBikB,EAAqB3iD,EAAO,KAAK,EACjC,MACD,CACG,OAAO,KAAKA,EAAO,KAAK,EAAE,OAS9B,MAAMkjD,EAAoBljD,EAAO,MAAM0+B,CAAK,EAC5C,GAAoCwkB,GAAsB,KACxD,OAEE,KAAK,UAAUtB,EAAI,SAAU,KAAM,KAAK,UAAUsB,CAAiB,GACrEP,EAAqBO,CAAiB,EAExC,MACD,CACItB,EAAI,sBACL,OAAOA,EAAI,UAAa,YAC5BA,EAAI,SAAS5hD,CAAM,CACpB,CACX,EACM,IAAK,WACH,OAAQnB,EAAQ,QAAQ,KAAI,CAC1B,IAAK,QAEH,OADA8jD,EAAqBE,CAAY,EAC7BnkB,IAAU,OACyB4jB,GAAW,KAAKV,EAAI,SAAQ,CAAE,EAEhCU,GAAW,KAAKX,GAA0B5jD,EAAQ,IAAI,CAAC,EAC9F,IAAK,SACH,GAAI2gC,IAAU,OAAQ,CACU4jB,GAAW,KAAKV,EAAI,SAAQ,CAAE,EAC5D,MACD,CACD,OAAqCU,GAAW,KAAKX,GAA0B5jD,EAAQ,IAAI,CAAC,EAC9F,IAAK,WACH,OAAOklD,GAAcpkD,EAAQ,MAAQQ,GAAU,CAC7C,GAAIq/B,IAAU,OAAQ,CACpBikB,EAAqBtjD,CAAK,EACIijD,GAAW,KAAKV,EAAI,SAAQ,CAAE,EAC5D,MACD,CACDe,EAAqBtjD,EAAMq/B,CAAK,CAAC,EACH4jB,GAAW,KAAKX,GAA0B5jD,EAAQ,IAAI,CAAC,CACnG,CAAa,EACH,IAAK,gBACL,IAAK,iBACH,OAAOklD,GAAcpkD,EAAQ,MAAQQ,GAAU,CAC7C,GAAIq/B,IAAU,OAAQ,CACpBikB,EAAqBtjD,CAAK,EAC1B,MACD,CACG,KAAK,UAAUuiD,EAAI,SAAU,KAAM,KAAK,UAAUviD,EAAMq/B,CAAK,CAAC,GAChEikB,EAAqBtjD,EAAMq/B,CAAK,CAAC,CAEjD,CAAa,EACH,IAAK,eAAgB,CACnB,KAAM,CAAE,gBAAAykB,CAAe,EAAKtkD,EAAQ,QAC9BukD,GAAqB3mC,EAAK0mC,EAAgB,eAAe,MAAM,EAAE,EAAE,CAAC,IAAM,KAAO,OAAS1mC,EAAG,MACnG,GAAI,CAAC2mC,EAAmB,OAEtBT,EADEjkB,IAAU,OACS0kB,EAEAA,EAAkB1kB,CAAK,CAFN,EAIV4jB,GAAW,KACvC,KAEAa,CACd,EACY,MACD,CACD,IAAK,kBACH,OAAOX,EAAc,CAACA,CACzB,CACD,MACH,CACL,CAAG,EACMK,CACT,EACMQ,GAAWnB,GACXe,GAAgB,CAACK,EAAaC,IAAM,CACxC,IAAIC,EACJ,GAAI,CACFA,EAAS,KAAK,MAAMF,CAAW,CAChC,MAAW,CAKX,CACGE,IAAW,QAAQD,EAAEC,CAAM,CACjC,EA6BA,SAASC,GAAkBC,EAAY3lD,EAAS,CAC9C,IAAIo7B,EACJ,GAAI,CACFA,EAAUuqB,EAAU,CACrB,MAAY,CACX,MACD,CAsBD,MArBuB,CACrB,QAAU9yC,GAAS,CACjB,IAAI6L,EACJ,MAAMknC,EAASC,GACTA,IAAS,KACJ,KAEF,KAAK,MAAMA,EAAiC7lD,GAAQ,OAAO,EAE9Dy5B,GAAO/a,EAAK0c,EAAQ,QAAQvoB,CAAI,IAAM,KAAO6L,EAAK,KACxD,OAAI+a,aAAe,QACVA,EAAI,KAAKmsB,CAAK,EAEhBA,EAAMnsB,CAAG,CACjB,EACD,QAAS,CAAC5mB,EAAMizC,IAAa1qB,EAAQ,QACnCvoB,EACA,KAAK,UAAUizC,EAAqC9lD,GAAQ,QAAQ,CACrE,EACD,WAAa6S,GAASuoB,EAAQ,WAAWvoB,CAAI,CACjD,CAEA,CACA,MAAMkzC,GAAchjD,GAAQszB,GAAU,CACpC,GAAI,CACF,MAAM/wB,EAASvC,EAAGszB,CAAK,EACvB,OAAI/wB,aAAkB,QACbA,EAEF,CACL,KAAK0gD,EAAa,CAChB,OAAOD,GAAWC,CAAW,EAAE1gD,CAAM,CACtC,EACD,MAAM2gD,EAAa,CACjB,OAAO,IACR,CACP,CACG,OAAQp6B,EAAG,CACV,MAAO,CACL,KAAKq6B,EAAc,CACjB,OAAO,IACR,EACD,MAAMC,EAAY,CAChB,OAAOJ,GAAWI,CAAU,EAAEt6B,CAAC,CAChC,CACP,CACG,CACH,EACMu6B,GAAU,CAACxjC,EAAQqiB,IAAgB,CAAC7vB,EAAK6O,EAAK4/B,IAAQ,CAC1D,IAAI7jD,EAAU,CACZ,WAAY,IAAM,aAClB,UAAW,KAAK,UAChB,YAAa,KAAK,MAClB,WAAasB,GAAUA,EACvB,QAAS,EACT,MAAO,CAAC+kD,EAAgBl8B,KAAkB,CACxC,GAAGA,EACH,GAAGk8B,CACT,GACI,GAAGphB,CACP,EACMqhB,EAAc,GAClB,MAAMC,EAAqC,IAAI,IACzCC,EAA2C,IAAI,IACrD,IAAIprB,EACJ,GAAI,CACFA,EAAUp7B,EAAQ,YACnB,MAAY,CACZ,CACD,GAAI,CAACo7B,EACH,OAAOxY,EACL,IAAI/E,IAAS,CAIXzI,EAAI,GAAGyI,CAAI,CACZ,EACDoG,EACA4/B,CACN,EAEE,MAAM4C,EAAoBV,GAAW/lD,EAAQ,SAAS,EAChD0mD,EAAU,IAAM,CACpB,MAAMplD,EAAQtB,EAAQ,WAAW,CAAE,GAAGikB,EAAK,EAAE,EAC7C,IAAI0iC,EACJ,MAAMC,EAAWH,EAAkB,CAAE,MAAAnlD,EAAO,QAAStB,EAAQ,OAAS,GAAE,KACrE6mD,GAAoBzrB,EAAQ,QAAQp7B,EAAQ,KAAM6mD,CAAe,CACxE,EAAM,MAAOh7B,GAAM,CACb86B,EAAc96B,CACpB,CAAK,EACD,GAAI86B,EACF,MAAMA,EAER,OAAOC,CACX,EACQE,EAAgBjD,EAAI,SAC1BA,EAAI,SAAW,CAACviD,EAAOojD,IAAY,CACjCoC,EAAcxlD,EAAOojD,CAAO,EACvBgC,EAAO,CAChB,EACE,MAAMK,EAAenkC,EACnB,IAAI/E,IAAS,CACXzI,EAAI,GAAGyI,CAAI,EACN6oC,EAAO,CACb,EACDziC,EACA4/B,CACJ,EACE,IAAImD,EACJ,MAAMC,EAAU,IAAM,CACpB,IAAIvoC,EACJ,GAAI,CAAC0c,EAAS,OACdkrB,EAAc,GACdC,EAAmB,QAASr7C,GAAOA,EAAG+Y,EAAK,EAAC,EAC5C,MAAMijC,IAA4BxoC,EAAK1e,EAAQ,qBAAuB,KAAO,OAAS0e,EAAG,KAAK1e,EAASikB,EAAG,CAAE,IAAM,OAClH,OAAO8hC,GAAW3qB,EAAQ,QAAQ,KAAKA,CAAO,CAAC,EAAEp7B,EAAQ,IAAI,EAAE,KAAMmnD,GAAiB,CACpF,GAAIA,EACF,OAAOnnD,EAAQ,YAAYmnD,CAAY,CAE/C,CAAK,EAAE,KAAMC,GAA6B,CACpC,GAAIA,EACF,GAAI,OAAOA,EAAyB,SAAY,UAAYA,EAAyB,UAAYpnD,EAAQ,SACvG,GAAIA,EAAQ,QACV,OAAOA,EAAQ,QACbonD,EAAyB,MACzBA,EAAyB,OACvC,MAMU,QAAOA,EAAyB,KAG1C,CAAK,EAAE,KAAMC,GAAkB,CACzB,IAAIC,EACJ,OAAAN,EAAmBhnD,EAAQ,MACzBqnD,GACCC,EAAMrjC,EAAG,IAAO,KAAOqjC,EAAMP,CACtC,EACM3xC,EAAI4xC,EAAkB,EAAI,EACnBN,EAAO,CACpB,CAAK,EAAE,KAAK,IAAM,CAC+BQ,IAAwBF,EAAkB,MAAM,EAC3FV,EAAc,GACdE,EAAyB,QAASt7C,GAAOA,EAAG87C,CAAgB,CAAC,CACnE,CAAK,EAAE,MAAOn7B,GAAM,CAC6Bq7B,IAAwB,OAAQr7B,CAAC,CAClF,CAAK,CACL,EACE,OAAAg4B,EAAI,QAAU,CACZ,WAAa0D,GAAe,CAC1BvnD,EAAU,CACR,GAAGA,EACH,GAAGunD,CACX,EACUA,EAAW,aACbnsB,EAAUmsB,EAAW,aAExB,EACD,aAAc,IAAM,CACSnsB,GAAQ,WAAWp7B,EAAQ,IAAI,CAC3D,EACD,WAAY,IAAMA,EAClB,UAAW,IAAMinD,EAAS,EAC1B,YAAa,IAAMX,EACnB,UAAYp7C,IACVq7C,EAAmB,IAAIr7C,CAAE,EAClB,IAAM,CACXq7C,EAAmB,OAAOr7C,CAAE,CACpC,GAEI,kBAAoBA,IAClBs7C,EAAyB,IAAIt7C,CAAE,EACxB,IAAM,CACXs7C,EAAyB,OAAOt7C,CAAE,CAC1C,EAEA,EACE+7C,IACOD,GAAoBD,CAC7B,EACMS,GAAU,CAAC5kC,EAAQqiB,IAAgB,CAAC7vB,EAAK6O,EAAK4/B,IAAQ,CAC1D,IAAI7jD,EAAU,CACZ,QAAS0lD,GAAkB,IAAM,YAAY,EAC7C,WAAapkD,GAAUA,EACvB,QAAS,EACT,MAAO,CAAC+kD,EAAgBl8B,KAAkB,CACxC,GAAGA,EACH,GAAGk8B,CACT,GACI,GAAGphB,CACP,EACMqhB,EAAc,GAClB,MAAMC,EAAqC,IAAI,IACzCC,EAA2C,IAAI,IACrD,IAAIprB,EAAUp7B,EAAQ,QACtB,GAAI,CAACo7B,EACH,OAAOxY,EACL,IAAI/E,IAAS,CAIXzI,EAAI,GAAGyI,CAAI,CACZ,EACDoG,EACA4/B,CACN,EAEE,MAAM6C,EAAU,IAAM,CACpB,MAAMplD,EAAQtB,EAAQ,WAAW,CAAE,GAAGikB,EAAK,EAAE,EAC7C,OAAOmX,EAAQ,QAAQp7B,EAAQ,KAAM,CACnC,MAAAsB,EACA,QAAStB,EAAQ,OACvB,CAAK,CACL,EACQ8mD,EAAgBjD,EAAI,SAC1BA,EAAI,SAAW,CAACviD,EAAOojD,IAAY,CACjCoC,EAAcxlD,EAAOojD,CAAO,EACvBgC,EAAO,CAChB,EACE,MAAMK,EAAenkC,EACnB,IAAI/E,IAAS,CACXzI,EAAI,GAAGyI,CAAI,EACN6oC,EAAO,CACb,EACDziC,EACA4/B,CACJ,EACEA,EAAI,gBAAkB,IAAMkD,EAC5B,IAAIC,EACJ,MAAMC,EAAU,IAAM,CACpB,IAAIvoC,EAAImB,EACR,GAAI,CAACub,EAAS,OACdkrB,EAAc,GACdC,EAAmB,QAASr7C,GAAO,CACjC,IAAIo8C,EACJ,OAAOp8C,GAAIo8C,EAAMrjC,EAAK,IAAK,KAAOqjC,EAAMP,CAAY,CAC1D,CAAK,EACD,MAAMG,IAA4BrnC,EAAK7f,EAAQ,qBAAuB,KAAO,OAAS6f,EAAG,KAAK7f,GAAU0e,EAAKuF,EAAK,IAAK,KAAOvF,EAAKqoC,CAAY,IAAM,OACrJ,OAAOhB,GAAW3qB,EAAQ,QAAQ,KAAKA,CAAO,CAAC,EAAEp7B,EAAQ,IAAI,EAAE,KAAMonD,GAA6B,CAChG,GAAIA,EACF,GAAI,OAAOA,EAAyB,SAAY,UAAYA,EAAyB,UAAYpnD,EAAQ,SACvG,GAAIA,EAAQ,QACV,MAAO,CACL,GACAA,EAAQ,QACNonD,EAAyB,MACzBA,EAAyB,OAC1B,CACf,MAMU,OAAO,CAAC,GAAOA,EAAyB,KAAK,EAGjD,MAAO,CAAC,GAAO,MAAM,CAC3B,CAAK,EAAE,KAAMK,GAAoB,CAC3B,IAAIH,EACJ,KAAM,CAACI,EAAUL,CAAa,EAAII,EAMlC,GALAT,EAAmBhnD,EAAQ,MACzBqnD,GACCC,EAAMrjC,EAAG,IAAO,KAAOqjC,EAAMP,CACtC,EACM3xC,EAAI4xC,EAAkB,EAAI,EACtBU,EACF,OAAOhB,EAAO,CAEtB,CAAK,EAAE,KAAK,IAAM,CAC+BQ,IAAwBF,EAAkB,MAAM,EAC3FA,EAAmB/iC,EAAG,EACtBqiC,EAAc,GACdE,EAAyB,QAASt7C,GAAOA,EAAG87C,CAAgB,CAAC,CACnE,CAAK,EAAE,MAAOn7B,GAAM,CAC6Bq7B,IAAwB,OAAQr7B,CAAC,CAClF,CAAK,CACL,EACE,OAAAg4B,EAAI,QAAU,CACZ,WAAa0D,GAAe,CAC1BvnD,EAAU,CACR,GAAGA,EACH,GAAGunD,CACX,EACUA,EAAW,UACbnsB,EAAUmsB,EAAW,QAExB,EACD,aAAc,IAAM,CACSnsB,GAAQ,WAAWp7B,EAAQ,IAAI,CAC3D,EACD,WAAY,IAAMA,EAClB,UAAW,IAAMinD,EAAS,EAC1B,YAAa,IAAMX,EACnB,UAAYp7C,IACVq7C,EAAmB,IAAIr7C,CAAE,EAClB,IAAM,CACXq7C,EAAmB,OAAOr7C,CAAE,CACpC,GAEI,kBAAoBA,IAClBs7C,EAAyB,IAAIt7C,CAAE,EACxB,IAAM,CACXs7C,EAAyB,OAAOt7C,CAAE,CAC1C,EAEA,EACOlL,EAAQ,eACXinD,IAEKD,GAAoBD,CAC7B,EACMY,GAAc,CAAC/kC,EAAQqiB,IACvB,eAAgBA,GAAe,cAAeA,GAAe,gBAAiBA,EAMzEmhB,GAAQxjC,EAAQqiB,CAAW,EAE7BuiB,GAAQ5kC,EAAQqiB,CAAW,EAE9B2iB,GAAUD,GCngBHE,GAAuB9E,GAA0B,EAC5D6E,GACE,CAACxyC,EAAK6O,KAAS,CACb,cAAe,CAAC,EAChB,YAAa,EACb,OAAQ,CAAC,EACT,SAAU,CACR,mBAAoB,GACpB,SAAU,GACV,cAAe,GACf,QAAS,GACT,kBAAmB,GACnB,mBAAoB,GACpB,UAAW,WACb,EAEA,gBAAkB6jC,GAAqB,CACrC,MAAMC,EAA6B,CACjC,GAAGD,EACH,GAAI,OAAO,WAAW,EACtB,UAAW,IAAI,KAAK,EAAE,YAAY,EAClC,KAAM,IAGR1yC,EAAK9T,IAAW,CACd,cAAe,CAACymD,EAAc,GAAGzmD,EAAM,aAAa,EACpD,YAAaA,EAAM,YAAc,CACjC,IAGE,CAAC,qBAAsB,QAAQ,EAAE,SAASymD,EAAa,IAAI,GAC7D9jC,EAAA,EAAM,SAAS,CACb,KAAM,UACN,MAAO8jC,EAAa,MACpB,QAASA,EAAa,QACtB,SAAU,IACX,EAIC9jC,EAAA,EAAM,SAAS,mBACbA,EAAA,EAAE,qBAAqB8jC,CAAY,CAE3C,EAEA,WAAap4C,GAAO,CAClByF,EAAK9T,IAAW,CACd,cAAeA,EAAM,cAAc,IAAK0B,GACtCA,EAAE,KAAO2M,EAAK,CAAE,GAAG3M,EAAG,KAAM,IAASA,CACvC,EACA,YAAa,KAAK,IAAI,EAAG1B,EAAM,YAAc,CAAC,CAC9C,GACJ,EAEA,cAAe,IAAM,CACnB8T,EAAK9T,IAAW,CACd,cAAeA,EAAM,cAAc,IAAK0B,IAAO,CAAE,GAAGA,EAAG,KAAM,IAAO,EACpE,YAAa,CACb,GACJ,EAEA,mBAAqB2M,GAAO,CAC1ByF,EAAK9T,GAAU,CACb,MAAMymD,EAAezmD,EAAM,cAAc,KAAU0B,KAAE,KAAO2M,CAAE,EACxDq4C,EAAYD,GAAgB,CAACA,EAAa,KAEzC,OACL,cAAezmD,EAAM,cAAc,OAAQ0B,GAAMA,EAAE,KAAO2M,CAAE,EAC5D,YAAaq4C,EAAY,KAAK,IAAI,EAAG1mD,EAAM,YAAc,CAAC,EAAIA,EAAM,YACtE,CACD,CACH,EAEA,sBAAuB,IAAM,CAC3B8T,EAAI,CAAE,cAAe,GAAI,YAAa,CAAG,EAC3C,EAEA,eAAiB6yC,GAAgB,CAC/B7yC,EAAK9T,IAAW,CACd,SAAU,CAAE,GAAGA,EAAM,SAAU,GAAG2mD,CAAY,CAC9C,GACJ,EAEA,SAAWC,GAAc,CACvB,MAAMC,EAA2B,CAC/B,GAAGD,EACH,GAAI,OAAO,WAAW,GAGxB9yC,EAAK9T,IAAW,CACd,OAAQ,CAAC,GAAGA,EAAM,OAAQ6mD,CAAK,CAC/B,GACJ,EAEA,YAAcx4C,GAAO,CACnByF,EAAK9T,IAAW,CACd,OAAQA,EAAM,OAAO,OAAQ8mD,GAAMA,EAAE,KAAOz4C,CAAE,CAC9C,GACJ,EAEA,YAAa,IAAM,CACjByF,EAAI,CAAE,OAAQ,CAAC,EAAG,CACpB,EAEA,kBAAmB,SACX,iBAAkB,OAKpB,aAAa,aAAe,UACvB,GAGL,aAAa,aAAe,SACX,MAAM,aAAa,sBAChB,UAGjB,GAZE,GAeX,gBAAiB,SAAY,CAE3B,GAAI,CADkB,MAAM6O,EAAI,EAAE,kBAAkB,EAE5C,UAAI,MAAM,gCAAgC,EAMlD7O,EAAK9T,IAAW,CACd,SAAU,CAAE,GAAGA,EAAM,SAAU,kBAAmB,EAAK,CACvD,GACJ,EAEA,oBAAqB,SAAY,CAI/B8T,EAAK9T,IAAW,CACd,SAAU,CAAE,GAAGA,EAAM,SAAU,kBAAmB,EAAM,CACxD,GACJ,EAGA,qBAAuBymD,GAA+B,CACpD,GAAI,EAAE,iBAAkB,SAAW,aAAa,aAAe,UAC7D,OAGF,MAAMM,EAA4D,CAChE,KAAMN,EAAa,QACnB,KAAM,oBACN,MAAO,kBACP,IAAKA,EAAa,GAClB,SAAU,IAGNO,EAAmB,IAAI,aAAaP,EAAa,MAAOM,CAAW,EAEzEC,EAAiB,QAAU,IAAM,CAC/B,OAAO,MAAM,EACbA,EAAiB,MAAM,EAGnBP,EAAa,MAAM,eAErB,OAAO,SAAS,KAAO,gBAAgBA,EAAa,KAAK,YAAY,GACvE,EAIF,WAAW,IAAM,CACfO,EAAiB,MAAM,GACtB,GAAI,CACT,EAGA,sBAAuB,CAAC1F,EAAsB2F,IAA4B,CACxE,KAAM,CAAE,gBAAAC,EAAiB,SAAAC,CAAS,EAAIxkC,EAAI,EAG1BukC,EAAA,CACd,KAAM,mBACN,MAAO,sBACP,QAAS,IAAID,CAAe,sDAC5B,KAAM,CAAE,aAAA3F,EAAc,OAAQ,qBAAsB,EACrD,EAGQ6F,EAAA,CACP,KAAM,OACN,MAAO,sBACP,QAAS,mCAAmCF,CAAe,IAC3D,SAAU,IACX,CACH,EAEA,0BAA2B,CAAC3F,EAAsB2F,EAAyBG,EAAyBC,IAAoB,CACtH,KAAM,CAAE,gBAAAH,EAAiB,SAAAC,CAAS,EAAIxkC,EAAI,EAEpCnjB,EAAU4nD,IAAY,MACxB,WAAWC,EAAS,IAAIA,CAAM,GAAK,EAAE,QAAQJ,CAAe,KAC5D,6BAA6BA,CAAe,4BAGhCC,EAAA,CACd,KAAM,uBACN,MAAOE,IAAY,MAAQ,WAAa,sBACxC,QAAA5nD,EACA,KAAM,CAAE,aAAA8hD,EAAc,QAAA8F,EAAS,OAAAC,CAAO,EACvC,EAGQF,EAAA,CACP,KAAMC,IAAY,MAAQ,UAAY,OACtC,MAAOA,IAAY,MAAQ,cAAgB,yBAC3C,QAAA5nD,EACA,SAAU4nD,IAAY,MAAQ,IAAQ,IACvC,CACH,EAEA,YAAa,CAAC5nD,EAAiB8nD,IAAmB,CAChD3kC,EAAA,EAAM,SAAS,CACb,KAAM,UACN,MAAO2kC,GAAS,UAChB,QAAA9nD,EACA,SAAU,IACX,CACH,EAEA,UAAW,CAACA,EAAiB8nD,IAAmB,CAC9C3kC,EAAA,EAAM,SAAS,CACb,KAAM,QACN,MAAO2kC,GAAS,QAChB,QAAA9nD,EACA,SAAU,IACX,CACH,IAEF,CACE,KAAM,yBACN,WAAaQ,IAAW,CACtB,cAAeA,EAAM,cACrB,SAAUA,EAAM,UAEpB,CACF,CACF,EAsEaunD,GAAc,CAAC/nD,EAAiB8nD,IAAmB,CACzCf,GAAA,WAAW,SAAS,CACvC,KAAM,UACN,MAAOe,GAAS,UAChB,QAAA9nD,EACA,SAAU,IACX,CACH,EAEagoD,GAAY,CAAChoD,EAAiB8nD,IAAmB,CACvCf,GAAA,WAAW,SAAS,CACvC,KAAM,QACN,MAAOe,GAAS,QAChB,QAAA9nD,EACA,SAAU,IACX,CACH,EC/YMioD,GAAM,gBAECC,GAAmBvnD,GAAkB,CAC5C,IACF,MAAMwnB,EACJxnB,GACA,GAAG,OAAO,SAAS,QAAQ,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,IAAI,GAC9D,uBAAQsnD,GAAK9/B,CAAG,OAEjB,CAEhB,CACF,EAEaggC,GAAkB,IAAqB,CAC9C,IACI,MAAAthD,EAAI,eAAe,QAAQohD,EAAG,EACpC,sBAAe,WAAWA,EAAG,EAEtBphD,CAAA,MACD,CACC,WACT,CACF,EAEauhD,GAAwBtb,GAA8B,CACjE,GAAI,CAACA,EAAU,UAGX,IACF,MAAMlrC,EAAM,IAAI,IAAIkrC,EAAG,OAAO,SAAS,MAAM,EAE7C,OAAIlrC,EAAI,SAAW,OAAO,SAAS,OAE1B,IAEFA,EAAI,SAAWA,EAAI,OAASA,EAAI,UACjC,CAER,CAGA,OAAKkrC,EAAE,WAAW,GAAG,EAKdA,EAHE,GAIX,ECIMub,GAAuB,MAAO3G,GAA2C,CACzE,IACF,KAAM,CAAE,KAAAljC,EAAM,MAAA3c,CAAA,EAAU,MAAMk/C,EAC3B,KAAK,OAAO,EACZ,OAAO,wGAAwG,EAC/G,GAAG,KAAMW,CAAM,EACf,SAEC,OAAA7/C,GAAS,CAAC2c,EACL,GAGF,CACL,SAAUA,EAAK,SACf,qBAAsBA,EAAK,qBAC3B,uBAAwBA,EAAK,uBAC7B,cAAeA,EAAK,cAEpB,SAAUA,EAAK,UAAY,OAC3B,UAAWA,EAAK,WAAa,OAC7B,WAAYA,EAAK,YAAc,aAErB,CAEZ,MAAO,EACT,CACF,EAGM8pC,GAAsB,CAACC,EAAmBC,IAAiD,CAC/F,GAAI,CAACD,EAAqB,YAEpB,MAAA5iC,EAAW4iC,EAAa,eAAiB,GACzCE,EAAcF,EAAa,cAAgB,GAGjD,IAAIG,EAAY,GACZC,EAAW,GACXC,EAAS,GAEb,GAAIjjC,EAAS,UAAW,CACtB,MAAMkjC,EAAYljC,EAAS,UAAU,MAAM,GAAG,EAClC+iC,EAAAG,EAAU,CAAC,GAAK,GAC5BF,EAAWE,EAAU,MAAM,CAAC,EAAE,KAAK,GAAG,GAAK,QAE3CH,EAAY/iC,EAAS,WAAaA,EAAS,YAAcA,EAAS,YAAc,OAChFgjC,EAAWhjC,EAAS,UAAYA,EAAS,WAAaA,EAAS,aAAe,GAI5EA,EAAS,WACXijC,EAASjjC,EAAS,WACTA,EAAS,QAClBijC,EAASjjC,EAAS,QACTA,EAAS,QAClBijC,EAASjjC,EAAS,OAEpB,MAAMmjC,EAAWnjC,EAAS,UAAYA,EAAS,oBAAsBA,EAAS,WAAa4iC,EAAa,OAAO,MAAM,GAAG,EAAE,CAAC,GAAK,GAC1HQ,EAAWpjC,EAAS,WAAa,GAAG+iC,CAAS,IAAIC,CAAQ,GAAG,OAE3D,OACL,GAAIJ,EAAa,GACjB,MAAOA,EAAa,OAAS,GAC7B,UAAAG,EACA,SAAAC,EACA,MAAOJ,EAAa,MACpB,OAAQC,GAAiB,YAAcI,EACvC,WAAYJ,GAAiB,YAAcI,EAC3C,SAAUH,EAAY,UAAY,QAClC,IAAK9iC,EAAS,IACd,cAAeA,EAAS,eAAiB,EACzC,cAAeA,EAAS,eAAiB,EACzC,QAASA,EAAS,SAAW,EAC7B,kBAAmBA,EAAS,mBAAqB,EACjD,iBAAkBA,EAAS,kBAAoB,EAC/C,KAAMA,EAAS,MAAQ,EACvB,MAAOA,EAAS,OAAS,gBACzB,UAAW4iC,EAAa,YAAkB,WAAO,YAAY,EAC7D,SAAUC,GAAiB,UAAYM,EACvC,UAAWN,GAAiB,WAAaO,EACzC,YAAa,GAAQpjC,EAAS,aAAeA,EAAS,UAEtD,SAAU6iC,GAAiB,UAAY,KACvC,qBAAsBA,GAAiB,sBAAwB,KAC/D,uBAAwBA,GAAiB,wBAA0B,KACnE,cAAeA,GAAiB,eAAiB,KAErD,EAGA,IAAIQ,GAA6B,GAC7BC,GAA2B,GAG3BC,GAAqB,GACrBC,GAAsB,GACtBC,GAAgB,EACpB,MAAMC,GAAyB,IAElBC,EAAerH,GAAkB,EAC5C6E,GACE,CAACxyC,EAAK6O,KAAS,CACb,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe,EAEf,eAAgB,SAAY,CAC1B,MAAM3iB,EAAQ2iB,IACR8lB,EAAM,KAAK,MAGjB,GAAI,CAAAggB,IAKA,EAAAzoD,EAAM,aAAgByoC,EAAMzoC,EAAM,cAAgB,KAKlD,IAAAA,EAAM,iBAAmBA,EAAM,MAAQA,EAAM,OAAUyoC,EAAMzoC,EAAM,cAAgB,IAAS,CAC1F8T,EAAA,CACF,QAAS,GACT,YAAa,GACb,cAAe20B,CAAA,CAChB,EACD,MACF,CAGA,GAAI,CAAAzoC,EAAM,QAIiB,CAAAyoD,GAAA,GAC3B30C,EAAI,CAAE,QAAS,GAAM,cAAe20B,CAAK,GAErC,IAEI,MAAE,KAAM,CAAE,QAAAlL,GAAW,MAAAl8B,CAAU,QAAMk/C,EAAS,KAAK,aAEzD,GAAIl/C,EAAO,CACLyS,EAAA,CACF,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe20B,CAAA,CAChB,EACD,MACF,CAEA,GAAIlL,GAAS,KAAM,CAEjB,MAAMyqB,EAAkB,MAAMH,GAAqBtqB,EAAQ,KAAK,EAAE,EAC5DwrB,EAAgBjB,GAAoBvqB,EAAQ,KAAMyqB,CAAe,EAEnEl0C,EAAA,CACF,gBAAiB,GACjB,KAAMi1C,EACN,MAAOxrB,EAAQ,aACf,QAAS,GACT,YAAa,GACb,cAAekL,CAAA,CAChB,OAEG30B,EAAA,CACF,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe20B,CAAA,CAChB,OAGgB,CAEf30B,EAAA,CACF,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe20B,CAAA,CAChB,SACD,CAC2BggB,GAAA,EAC7B,GACF,EAEA,MAAO,MAAOhqB,EAAewG,IAAqB,CAC5CnxB,EAAA,CAAE,QAAS,GAAM,EAEjB,IACI,MAAE,KAAAkK,EAAM,MAAA3c,GAAU,MAAM2wB,GAAK,OAAOyM,EAAOwG,CAAQ,EAEzD,GAAI5jC,EAAO,CACT,IAAI2nD,EAAc,+CAElB,MAAI3nD,EAAM,QAAQ,SAAS,2BAA2B,EACtC2nD,EAAA,+CACL3nD,EAAM,QAAQ,SAAS,qBAAqB,IACvC2nD,EAAA,4DAGZl1C,EAAA,CAAE,QAAS,GAAO,EACtB0zC,GAAUwB,CAAW,EACf,IAAI,MAAMA,CAAW,CAC7B,CAEA,MAAMC,EAAWjrC,GAAM,KACjBuf,EAAUvf,GAAM,QAEtB,GAAIirC,GAAY1rB,EAAS,CAEvB,MAAMyqB,EAAkB,MAAMH,GAAqBoB,EAAS,EAAE,EACxDF,EAAgBjB,GAAoBmB,EAAUjB,CAAe,EAE/Dl0C,EAAA,CACF,gBAAiB,GACjB,KAAMi1C,EACN,MAAOxrB,EAAQ,aACf,QAAS,GACT,YAAa,GACb,cAAe,KAAK,IAAI,EACzB,EAEWgqB,GAAA,iBAAiBwB,GAAe,SAAS,GAAG,CAC1D,QAEO1nD,EAAY,CACf,MAAAyS,EAAA,CAAE,QAAS,GAAO,EAChBzS,CACR,CACF,EAEA,SAAU,MAAOo9B,EAAewG,EAAkBijB,EAAmBC,IAAqB,CACpFr0C,EAAA,CAAE,QAAS,GAAM,EAEjB,IACE,GAAAmxB,EAAS,OAAS,EACd,UAAI,MAAM,6CAA6C,EAG/D,MAAM4b,EAAW,CACf,KAAM,CACJ,UAAAqH,EACA,SAAAC,EACA,WAAYD,EACZ,UAAWC,EACX,UAAW,GAAGD,CAAS,IAAIC,CAAQ,EACrC,GAGI,CAAE,KAAAnqC,EAAM,MAAA3c,CAAM,EAAI,MAAM2wB,GAAK,OAAOyM,EAAOwG,EAAU4b,CAAQ,EAEnE,GAAIx/C,EAAO,CACT,IAAI2nD,EAAc,yCAElB,MAAI3nD,EAAM,QAAQ,SAAS,yBAAyB,EACpC2nD,EAAA,qEACL3nD,EAAM,QAAQ,SAAS,6BAA6B,IAC/C2nD,EAAA,gDAGZl1C,EAAA,CAAE,QAAS,GAAO,EACtB0zC,GAAUwB,CAAW,EACf,IAAI,MAAMA,CAAW,CAC7B,CAEA,MAAMC,EAAWjrC,GAAM,KAEvB,GAAIirC,EAAU,CAEZ,MAAMjB,EAAkB,MAAMH,GAAqBoB,EAAS,EAAE,EACxDF,EAAgBjB,GAAoBmB,EAAUjB,CAAe,EAG/DhqC,GAAM,SACJlK,EAAA,CACF,gBAAiB,GACjB,KAAMi1C,EACN,MAAO/qC,EAAK,QAAQ,aACpB,QAAS,GACT,YAAa,GACb,cAAe,KAAK,IAAI,EACzB,EACWupC,GAAA,0BAA0BwB,GAAe,SAAS,GAAG,IAG7Dj1C,EAAA,CACF,gBAAiB,GACjB,KAAMi1C,EACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe,KAAK,IAAI,EACzB,EACWxB,GAAA,0BAA0BwB,GAAe,SAAS,mDAAmD,EAErH,QAEO1nD,EAAY,CACf,MAAAyS,EAAA,CAAE,QAAS,GAAO,EAChBzS,CACR,CACF,EAEA,eAAgB,MAAO8kC,GAAiC,CAClDryB,EAAA,CAAE,QAAS,GAAM,EAEjB,IACF,MAAMqI,EAAc,GAAG,OAAO,SAAS,QAAQ,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,IAAI,GAC/FurC,GAAgBvrC,CAAW,EAErB,MAAE,KAAA6B,EAAM,MAAA3c,CAAU,QAAM2wB,GAAK,gBAAgBmU,EAAU,CAAE,KAAMhqB,CAAA,CAAa,EAElF,GAAI9a,EACE,MAAAyS,EAAA,CAAE,QAAS,GAAO,EACZ0zC,GAAA,GAAGrhB,CAAQ,oCAAoC,EACnD,IAAI,MAAM9kC,EAAM,OAAO,QAKxBA,EAAY,CACf,MAAAyS,EAAA,CAAE,QAAS,GAAO,EAChBzS,CACR,CACF,EAEA,oBAAqB,SAAY,CAC3B,IACF,KAAM,CAAE,KAAA2c,EAAM,MAAA3c,GAAU,MAAMk/C,EAAS,KAAK,aAE5C,GAAIl/C,EACF,MAAAmmD,GAAU,0CAA0C,EAC9C,IAAI,MAAMnmD,EAAM,OAAO,EAG3B,GAAA2c,EAAK,SAAS,KAAM,CAEtB,MAAMgqC,EAAkB,MAAMH,GAAqB7pC,EAAK,QAAQ,KAAK,EAAE,EACjE+qC,EAAgBjB,GAAoB9pC,EAAK,QAAQ,KAAMgqC,CAAe,EAExEl0C,EAAA,CACF,gBAAiB,GACjB,KAAMi1C,EACN,MAAO/qC,EAAK,QAAQ,aACpB,QAAS,GACT,YAAa,GACb,cAAe,KAAK,IAAI,EACzB,EAEK,MAAAkrC,EAAaH,GAAe,UAAY,QACxCI,EAAeD,EAAW,OAAO,CAAC,EAAE,YAAY,EAAIA,EAAW,MAAM,CAAC,EAC5E,OAAA3B,GAAY,WAAWwB,GAAe,SAAS,oBAAoBI,CAAY,GAAG,EAE3EJ,CAAA,KAED,WAAI,MAAM,4CAA4C,QAGvD1nD,EAAY,CACf,MAAAyS,EAAA,CAAE,QAAS,GAAO,EAChBzS,CACR,CACF,EAEA,OAAQ,SAAY,CACdyS,EAAA,CAAE,QAAS,GAAM,EAEjB,IACF,KAAM,CAAE,MAAAzS,CAAU,QAAM2wB,GAAK,QAAQ,EAMjCle,EAAA,CACF,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe,EAChB,EAEDyzC,GAAY,yBAAyB,OAElB,CAEfzzC,EAAA,CACF,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,QAAS,GACT,YAAa,GACb,cAAe,EAChB,CACH,CACF,EAEA,cAAe,MAAOs1C,GAAqB,CACrCt1C,EAAA,CAAE,QAAS,GAAM,EAEjB,IACI,MAAAu1C,EAAc1mC,EAAM,OAC1B,GAAI,CAAC0mC,EACG,UAAI,MAAM,mBAAmB,EAGrC,KAAM,CAAE,KAAArrC,EAAM,MAAA3c,CAAA,EAAU,MAAMk/C,EAAS,KAAK,WAAW,CACrD,KAAM,CACJ,UAAW6I,EAAY,WAAaC,EAAY,UAChD,SAAUD,EAAY,UAAYC,EAAY,SAC9C,IAAKD,EAAY,MAAQ,OAAYA,EAAY,IAAMC,EAAY,GACrE,EACD,EAED,GAAIhoD,EACF,MAAM,IAAI,MAAMA,EAAM,SAAW,0BAA0B,EAG7D,GAAI2c,GAAM,KAAM,CAEd,MAAMgqC,EAAkB,MAAMH,GAAqB7pC,EAAK,KAAK,EAAE,EACzDsrC,EAAcxB,GAAoB9pC,EAAK,KAAMgqC,CAAe,EAI9D,IACI,MAAAO,EAAW,GAAGe,GAAa,WAAa,EAAE,IAAIA,GAAa,UAAY,EAAE,GAAG,KAAK,EACvF,GAAIf,EAAU,CACZ,KAAM,CAAE,UAAAlJ,GAAc,MAAAptC,EAAA,IAAM,uCACtBs3C,EAASlK,IACTzhC,EAAW,MAAM,MAAM,GAAG2rC,CAAM,iBAAiBvrC,EAAK,KAAK,EAAE,WAAY,CAC7E,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,UAAU,CAAE,UAAWuqC,EAAU,EAC7C,EACG,IAAC3qC,EAAS,GAAI,CACV,MAAA4rC,EAAU,MAAM5rC,EAAS,OAAO,MAAM,KAAO,CAAG,IAK1D,OACoB,CAEtB,CAEI9J,EAAA,CACF,KAAMw1C,EACN,QAAS,GACT,cAAe,KAAK,IAAI,EACzB,EACD/B,GAAY,+BAA+B,CAC7C,QAEOlmD,EAAY,CACfyS,EAAA,CAAE,QAAS,GAAO,EACtB,MAAM4Q,EAAM,OAAOrjB,GAAO,SAAY,SAAWA,EAAM,QAAU,GAC3DooD,EAAiB/kC,EAAI,cAAc,SAAS,iBAAiB,GAAKA,EAAI,cAAc,SAAS,eAAe,EAElH,MACE8iC,GADEiC,EACQ,uFAEA/kC,GAAO,6CAF+E,EAI5FrjB,CACR,CACF,EAGA,aAAc,MAAOqoD,GAAe,CAClC,MAAM1pD,EAAQ2iB,IACd,GAAI,CAAC3iB,EAAM,KAAY,UAAI,MAAM,mBAAmB,EAC9C,MAAAkhD,EAASlhD,EAAM,KAAK,GAEpB2pD,EAAMD,EAAK,KAAK,MAAM,GAAG,EAAE,IAAO,eAAiB,SAEnDvpD,EAAO,GAAG+gD,CAAM,IAAI,KAAK,KAAK,IAAIyI,CAAG,GAGrC,CAAE,KAAMC,EAAY,MAAOC,GAAgB,MAAMtJ,EAAS,QAC7D,KAAK,SAAS,EACd,OAAOpgD,EAAMupD,EAAM,CAAE,aAAc,OAAQ,OAAQ,GAAM,YAAaA,EAAK,KAAM,EAEpF,GAAIG,EAAa,CAET,MAAAC,GADMD,EAAY,SAAW,IACjB,cAEd,MAAAC,EAAM,SAAS,WAAW,GAAKA,EAAM,SAAS,WAAW,GAAKA,EAAM,SAAS,sBAAsB,EACrGtC,GAAU,uDAAuD,EACxDsC,EAAM,SAAS,MAAM,GAAKA,EAAM,SAAS,cAAc,GAAKA,EAAM,SAAS,mBAAmB,EACvGtC,GAAU,6DAA6D,EAEvEA,GAAU,2CAA2C,EAEjDqC,CACR,CAGM,MAAE,KAAME,CAAkB,EAAAxJ,EAAS,QAAQ,KAAK,SAAS,EAAE,aAAaqJ,EAAW,IAAI,EACvFI,EAAYD,EAAc,UAG1B,CAAE,KAAME,EAAY,MAAOC,CAAA,EAAY,MAAM3J,EAAS,KAAK,WAAW,CAAE,KAAM,CAAE,WAAYyJ,CAAA,CAAa,GAC/G,GAAIE,EACF,MAAA1C,GAAU,mCAAmC,EACvC0C,EAIR,MAAMlJ,GAAS,MAAM,cAAcE,EAAQ,CAAE,WAAY8I,EAAW,EAG9D,MAAAhC,EAAkB,MAAMH,GAAqB3G,CAAM,EACnDoI,EAAcW,GAAY,KAAOnC,GAAoBmC,EAAW,KAAMjC,CAAe,EAAI,KAC/F,OAAIsB,GACFx1C,EAAI,CAAE,KAAMw1C,EAAa,cAAe,KAAK,MAAO,EAEtD/B,GAAY,wBAAwB,EAC7ByC,CACT,IAEF,CACE,KAAM,wBACN,QAAS5F,GAAkB,IAAM,YAAY,EAC7C,WAAapkD,IAAW,CACtB,gBAAiBA,EAAM,gBACvB,KAAMA,EAAM,KACZ,MAAOA,EAAM,MACb,YAAaA,EAAM,YACnB,cAAeA,EAAM,gBAEvB,QAAS,CACX,CACF,CACF,EAGI,OAAO,OAAW,KAAe,CAACwoD,KACPA,GAAA,GAE7BjI,EAAS,KAAK,kBAAkB,CAACpwC,EAAOotB,IAAY,CAC5C,MAAAkL,EAAM,KAAK,MACXyY,EAAS3jB,GAAS,MAAM,IAAM,GAMhC,GAHa,GAAGptB,CAAK,IAAI+wC,CAAM,KAGlB,GAAGwH,EAAkB,IAAIC,EAAmB,IACxDlgB,EAAMmgB,GAAiBC,GAC1B,OAImBH,GAAAv4C,EACCw4C,GAAAzH,EACN0H,GAAAngB,EAEV,MAAA5f,EAAeigC,EAAa,WAG9B,GAAA34C,IAAU,aAAeotB,GAAS,MAEhC,IAAC1U,EAAa,iBAAmBA,EAAa,MAAM,KAAO0U,EAAQ,KAAK,GAAI,CACxE,MAAAwrB,EAAgBjB,GAAoBvqB,EAAQ,IAAI,EAItDurB,EAAa,SAAS,CACpB,gBAAiB,GACjB,KAAMC,EACN,MAAOxrB,EAAQ,aACf,QAAS,GACT,YAAa,GACb,cAAekL,CAAA,CAChB,CACH,OAGOt4B,IAAU,aAIjB24C,EAAa,SAAS,CACpB,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,cAAe,EAChB,EAGM34C,IAAU,mBAAqBotB,GAAS,MAE3C1U,EAAa,iBAAmBA,EAAa,MAAM,KAAO0U,EAAQ,KAAK,IACzEurB,EAAa,SAAS,CACpB,MAAOvrB,EAAQ,aACf,cAAekL,CAAA,CAChB,CAEL,CAED,GCrpBI,MAAM1hB,GAAO,IAAM,CAAC,EAEdojC,GAAa,CAAC,ECGdC,GAAe,KAAkB,CAC5C,gBAAiBrjC,GACjB,WAAYA,GACZ,aAAc,IAAM,GACpB,aAAc,IAAM,EACpB,MAAOojC,EACT,GCOaE,GAA6C,CACxD,YAAa,CACX,MAAO,sBACP,YAAa,gDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,kBAChB,EACA,aAAc,CACZ,MAAO,sBACP,YAAa,oDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,mBAChB,EACA,aAAc,CACZ,MAAO,sBACP,YAAa,oCACb,WAAY,uBACZ,aAAc,sBACd,aAAc,mBAChB,EACA,iBAAkB,CAChB,MAAO,sBACP,YAAa,gDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,uBAChB,EACA,kBAAmB,CACjB,MAAO,sBACP,YAAa,+DACb,WAAY,uBACZ,aAAc,sBACd,aAAc,wBAChB,EACA,mBAAoB,CAClB,MAAO,qBACP,YAAa,2CACb,WAAY,uBACZ,aAAc,sBACd,aAAc,yBAChB,EACA,gBAAiB,CACf,MAAO,8BACP,YAAa,sDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,sBAChB,EACA,UAAW,CACT,MAAO,uBACP,YAAa,oDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,gBAChB,EACA,eAAgB,CACd,MAAO,4BACP,YAAa,qDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,qBAChB,EACA,eAAgB,CACd,MAAO,2BACP,YAAa,8CACb,WAAY,uBACZ,aAAc,sBACd,aAAc,qBAChB,EACA,cAAe,CACb,MAAO,kBACP,YAAa,yCACb,WAAY,uBACZ,aAAc,sBACd,aAAc,oBAChB,EACA,iBAAkB,CAChB,MAAO,8BACP,YAAa,sDACb,WAAY,uBACZ,aAAc,sBACd,aAAc,uBAChB,CACF,EAEaC,GAA8B,CACzC,MAAO,UACP,YAAa,kCACb,WAAY,uBACZ,aAAc,sBACd,aAAc,eAChB,EAgBmE,OAAO,QAAQD,EAAU,EAAE,OAC5F,CAACpoC,EAAK,CAAChiB,EAAKmD,CAAI,KAAO,CACrB,GAAG6e,EACH,CAAChiB,CAAG,EAAG,CACL,IAAAA,EACA,MAAOmD,EAAK,MACZ,YAAaA,EAAK,YAClB,WAAY,SACZ,aAAc,aACd,eAAgBA,EAAK,YACvB,IAEF,CAAC,CACH,ECxHA,MAAM2yB,GAAc,kBACdw0B,GAAiB,gBAGvB,IAAIC,GAA+B,CACjC,OAAQ,GACR,cAAe,KACf,WAAY,KACZ,QAAS,OACT,SAAU,IACZ,EAGA,MAAMC,OAAkB,IAGlBC,GAAoB,IAAM,CAClBD,GAAA,QAAoB/0C,KAAU,EAC5C,EAGMi1C,GAAuBxJ,GAAoC,CAC/DqJ,GAAgB,CAAE,GAAGA,GAAe,GAAGrJ,CAAQ,EAC7BuJ,IACpB,EAGME,GAAqB,CAACC,EAAoBlmC,IAAsC,CAChF,IACa,uBAAQoR,GAAa,KAAK,UAAU,CAAE,OAAA80B,EAAQ,QAAAlmC,CAAS,EAAC,EAEvE,MAAM7L,EAAa,OAAO,SAAS,SAAW,OAAO,SAAS,OAE/C,uBAAQyxC,GAAgBzxC,CAAU,OAEnC,CAEhB,CACF,EAWMgyC,GAAmB,IAAwE,CAC3F,IACI,MAAAC,EAAS,eAAe,QAAQh1B,EAAW,EACjD,GAAIg1B,EACK,YAAK,MAAMA,CAAM,OAEZ,CAEhB,CACO,WACT,EAqBaC,GAAc,IAAM,CAC/B,KAAM,EAAGC,CAAW,EAAIC,EAAA,SAAS,CAAE,GAEnCC,mBAAU,IAAM,CACd,MAAMz1C,EAAW,IAAMu1C,EAAY,EAAE,EACrC,OAAAR,GAAY,IAAI/0C,CAAQ,EACjB,IAAM,CACX+0C,GAAY,OAAO/0C,CAAQ,EAE/B,EAAG,CAAE,GAEE,CACL,OAAQ80C,GAAc,OACtB,cAAeA,GAAc,cAC7B,WAAYA,GAAc,WAC1B,QAASA,GAAc,QAE3B,EAMaY,GAAgBhjC,GAKpB,IAAI,QAAyB8C,GAAY,CACxC,MAAAmgC,EAAiBhB,GAAWjiC,EAAK,MAAM,EACvCkjC,EAAyBljC,EAAK,aAChC,CAAE,GAAGijC,EAAgB,GAAGjjC,EAAK,YAC7B,EAAAijC,EAGeT,GAAAxiC,EAAK,OAAQA,EAAK,OAAO,EAExBuiC,GAAA,CAClB,OAAQ,GACR,cAAeviC,EAAK,OACpB,WAAAkjC,EACA,QAASljC,EAAK,QACd,SAAU8C,CAAA,CACX,EACF,EAMUqgC,GAAmBvnD,GAAiC,CAK/D,KAAM,CAAE,SAAAwnD,EAAU,cAAAC,EAAe,QAAA9mC,CAAA,EAAY6lC,GAGzC,IACF,eAAe,WAAWz0B,EAAW,OACvB,CAEhB,CAEoB40B,GAAA,CAClB,OAAQ,GACR,cAAe,KACf,WAAY,KACZ,QAAS,OACT,SAAU,KACX,EAGG3mD,EAAO,SAAW,WAAaynD,GAAiBA,IAAkB,gBACpEC,GAAsBD,EAAe9mC,CAAO,EAG1C6mC,GACFA,EAASxnD,CAAM,CAEnB,EAKM0nD,GAAwB,CAACb,EAAoBlmC,IAAsC,CAKvF,OAAQkmC,EAAQ,CACd,IAAK,cAEH,MAEF,IAAK,eAEH,MAEF,IAAK,qBAEH,WAAW,IAAM,CACT,MAAAc,EAAW,SAAS,cAAc,mBAAmB,EACvDA,GACFA,EAAS,MAAM,GAEhB,GAAG,EACN,MAEF,IAAK,mBAEChnC,GAAS,cAEX,WAAW,IAAM,CACT,MAAAinC,EAAW,SAAS,cAAc,wBAAwB,EAC5DA,GACFA,EAAS,MAAM,GAEhB,GAAG,EAER,KAKJ,CACF,EAoCaC,GAAqB,IAAwE,CACxG,MAAMC,EAAYhB,KAClB,OAAIgB,GAMkBnB,GAAA,CAClB,cAAemB,EAAU,OACzB,QAASA,EAAU,QAEpB,EAEMA,GAEF,IACT,ECrRMC,GAAkBC,gBAA+C,MAAS,EAEnEC,GAAc,IAAM,CACzB,MAAA93C,EAAU+3C,aAAWH,EAAe,EAC1C,GAAI53C,IAAY,OACR,UAAI,MAAM,oDAAoD,EAE/D,OAAAA,CACT,EAMag4C,GAAoD,CAAC,CAAE,SAAAx/C,KAAe,CACjF,MAAMpN,EAA6B,CACjC,SAAAghD,CAAA,EAGF,OACG6L,MAAAL,GAAgB,SAAhB,CAAyB,MAAAxsD,EACvB,SAAAoN,CACH,EAEJ,ECZM0/C,GAAqBL,gBAAkD,MAAS,EAEzEM,GAAiB,IAAM,CAC5B,MAAAn4C,EAAU+3C,aAAWG,EAAkB,EAC7C,GAAIl4C,IAAY,OACR,UAAI,MAAM,2DAA2D,EAEtE,OAAAA,CACT,EAOMo4C,GAAmB,IAEZC,GAA0D,CAAC,CAAE,SAAA7/C,KAAe,CACjF,MAAE,SAAA4zC,GAAa0L,KACf,CAACpvB,EAAM4vB,CAAO,EAAIvB,WAAsB,IAAI,EAC5C,CAAC3tB,EAASmvB,CAAU,EAAIxB,WAAyB,IAAI,EACrD,CAACyB,EAASC,CAAU,EAAI1B,WAAS,EAAI,EACrC,CAAC2B,EAAaC,CAAc,EAAI5B,WAAS,EAAK,EAG9C6B,EAAeC,SAAwE,IAAI,EAEjG7B,YAAU,IAAM,CACd,IAAI8B,EAAU,GAEd,MAAMC,EAAwB,SAAY,CACpC,IACI,MAAAC,EAAS,eAAe,QAAQ,oBAAoB,EAC1D,GAAI,CAACA,EAAQ,OAEb,eAAe,WAAW,oBAAoB,EACxC,MAAAhJ,EAAS,KAAK,MAAMgJ,CAAM,EAC5BhJ,GAAQ,cAAgBA,GAAQ,eAC5B,MAAA5D,EAAS,KAAK,WAAW,CAC7B,aAAc4D,EAAO,aACrB,cAAeA,EAAO,cACvB,OAEW,CAEhB,IAIwB,SAAY,CAChC,IACF,MAAM+I,EAAsB,EACtB,MAAE,KAAM,CAAE,QAAA3vB,CAAW,QAAAl8B,CAAU,QAAMk/C,EAAS,KAAK,aACzD,GAAI,CAAC0M,EAAS,OAEV5rD,IAGFqrD,EAAWnvB,CAAO,EACVA,KAAS,MAAQ,IAAI,QAEjB,SAEd,CACI0vB,IACFL,EAAW,EAAK,EAChBE,EAAe,EAAI,EAEvB,MAMF,KAAM,CAAE,KAAM,CAAE,aAAArlB,CAAe,GAAI8Y,EAAS,KAAK,kBAC/C,MAAOpwC,EAAOotB,IAAY,CACxB,GAAI,CAAC0vB,EAAS,OAER,MAAAxkB,EAAM,KAAK,MACXyY,EAAS3jB,GAAS,MAAM,IAAM,GAC9B6vB,EAAYL,EAAa,QAG3BK,GACAA,EAAU,QAAUj9C,GACpBi9C,EAAU,SAAWlM,GACpBzY,EAAM2kB,EAAU,KAAQb,KAK7BQ,EAAa,QAAU,CAAE,MAAA58C,EAAO,OAAA+wC,EAAQ,KAAMzY,GAO9CikB,EAAWnvB,CAAO,EACVA,KAAS,MAAQ,IAAI,EAC7BqvB,EAAW,EAAK,EAClB,GAGF,MAAO,IAAM,CACDK,EAAA,GACVxlB,EAAa,YAAY,EAC3B,EACC,CAAC8Y,CAAQ,CAAC,EA0Fb,MAAMhhD,EAAgC,CACpC,KAAAs9B,EACA,QAAAU,EACA,QAAAovB,EACA,YAAAE,EACA,gBAAiB,EAAQhwB,EACzB,OA9Fa,MAAO4B,EAAewG,IAAqB,CACpD,IACF,KAAM,CAAE,MAAA5jC,CAAM,EAAI,MAAMk/C,EAAS,KAAK,mBAAmB,CACvD,MAAA9hB,EACA,SAAAwG,CAAA,CACD,EACD,MAAO,CAAE,MAAA5jC,CAAM,QACRA,EAAY,CACnB,MAAO,CAAE,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC9C,GAsFA,OAnFa,MAAOo9B,EAAewG,EAAkB4b,EAAgB,KAAO,CACxE,IACF,KAAM,CAAE,MAAAx/C,CAAM,EAAI,MAAMk/C,EAAS,KAAK,OAAO,CAC3C,MAAA9hB,EACA,SAAAwG,EACA,QAAS,CACP,KAAM4b,EACN,gBACI,2BAEN,EACD,EACD,MAAO,CAAE,MAAAx/C,CAAM,QACRA,EAAY,CACnB,MAAO,CAAE,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC9C,GAqEA,QAlEc,SAAY,CACtB,IACF,KAAM,CAAE,MAAAA,CAAM,EAAI,MAAMk/C,EAAS,KAAK,QAAQ,EAC9C,MAAO,CAAE,MAAAl/C,CAAM,QACRA,EAAY,CACnB,MAAO,CAAE,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC9C,GA6DA,iBA1DuB,SAAY,CAC/B,IAEcqmD,KAIhB,MAAM7H,EADc,GAAG,OAAO,SAAS,QAAQ,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,IAAI,GAEzFkB,EAAcf,GAAqBH,CAAI,EAMvC,CAAE,MAAAx+C,CAAU,QAAMgsD,GAAY,gBAAgB,SAAU,CAAE,KAAAxN,CAAA,CAAM,EAMtE,MAAO,CAAE,MAAAx+C,CAAM,QACRA,EAAY,CAEnB,MAAO,CAAE,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC9C,GAmCA,oBAhC0B,MAAOo9B,GAAkB,CAC/C,IAEcipB,KAIhB,MAAM7H,EADc,GAAG,OAAO,SAAS,QAAQ,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,IAAI,GAEzFyN,EAAkBtN,GAAqBH,CAAI,EAE3C,CAAE,MAAAx+C,CAAM,EAAI,MAAMk/C,EAAS,KAAK,cAAc,CAClD,MAAA9hB,EACA,QAAS,CACP,gBAAA6uB,CACF,EACD,EACD,MAAO,CAAE,MAAAjsD,CAAM,QACRA,EAAY,CACnB,MAAO,CAAE,MAAO,CAAE,QAASA,EAAM,SAAW,gCAC9C,EAaA,EAGF,OACG+qD,MAAAC,GAAmB,SAAnB,CAA4B,MAAA9sD,EAC1B,SAAAoN,CACH,EAEJ,EC3OM4gD,GAAe,OAAO,OAAO,IAAI,EACvCA,GAAa,KAAU,IACvBA,GAAa,MAAW,IACxBA,GAAa,KAAU,IACvBA,GAAa,KAAU,IACvBA,GAAa,QAAa,IAC1BA,GAAa,QAAa,IAC1BA,GAAa,KAAU,IACvB,MAAMC,GAAuB,OAAO,OAAO,IAAI,EAC/C,OAAO,KAAKD,EAAY,EAAE,QAASttD,GAAQ,CACvCutD,GAAqBD,GAAattD,CAAG,CAAC,EAAIA,CAC9C,CAAC,EACD,MAAMwtD,GAAe,CAAE,KAAM,QAAS,KAAM,cAAgB,ECXtDC,GAAiB,OAAO,MAAS,YAClC,OAAO,KAAS,KACb,OAAO,UAAU,SAAS,KAAK,IAAI,IAAM,2BAC3CC,GAAwB,OAAO,aAAgB,WAE/CC,GAAUn6C,GACL,OAAO,YAAY,QAAW,WAC/B,YAAY,OAAOA,CAAG,EACtBA,GAAOA,EAAI,kBAAkB,YAEjCo6C,GAAe,CAAC,CAAE,KAAAr8C,EAAM,KAAAwM,CAAI,EAAI8vC,EAAgBp4C,IAC9Cg4C,IAAkB1vC,aAAgB,KAC9B8vC,EACOp4C,EAASsI,CAAI,EAGb+vC,GAAmB/vC,EAAMtI,CAAQ,EAGvCi4C,KACJ3vC,aAAgB,aAAe4vC,GAAO5vC,CAAI,GACvC8vC,EACOp4C,EAASsI,CAAI,EAGb+vC,GAAmB,IAAI,KAAK,CAAC/vC,CAAI,CAAC,EAAGtI,CAAQ,EAIrDA,EAAS63C,GAAa/7C,CAAI,GAAKwM,GAAQ,GAAG,EAE/C+vC,GAAqB,CAAC/vC,EAAMtI,IAAa,CAC3C,MAAMs4C,EAAa,IAAI,WACvB,OAAAA,EAAW,OAAS,UAAY,CAC5B,MAAM/sB,EAAU+sB,EAAW,OAAO,MAAM,GAAG,EAAE,CAAC,EAC9Ct4C,EAAS,KAAOurB,GAAW,GAAG,CACtC,EACW+sB,EAAW,cAAchwC,CAAI,CACxC,EACA,SAASiJ,GAAQjJ,EAAM,CACnB,OAAIA,aAAgB,WACTA,EAEFA,aAAgB,YACd,IAAI,WAAWA,CAAI,EAGnB,IAAI,WAAWA,EAAK,OAAQA,EAAK,WAAYA,EAAK,UAAU,CAE3E,CACA,IAAIiwC,GACG,SAASC,GAAqBC,EAAQz4C,EAAU,CACnD,GAAIg4C,IAAkBS,EAAO,gBAAgB,KACzC,OAAOA,EAAO,KAAK,YAAa,EAAC,KAAKlnC,EAAO,EAAE,KAAKvR,CAAQ,EAE3D,GAAIi4C,KACJQ,EAAO,gBAAgB,aAAeP,GAAOO,EAAO,IAAI,GACzD,OAAOz4C,EAASuR,GAAQknC,EAAO,IAAI,CAAC,EAExCN,GAAaM,EAAQ,GAAQC,GAAY,CAChCH,KACDA,GAAe,IAAI,aAEvBv4C,EAASu4C,GAAa,OAAOG,CAAO,CAAC,CAC7C,CAAK,CACL,CCjEA,MAAMC,GAAQ,mEAERC,GAAS,OAAO,WAAe,IAAc,CAAE,EAAG,IAAI,WAAW,GAAG,EAC1E,QAAS7rD,EAAI,EAAGA,EAAI4rD,GAAM,OAAQ5rD,IAC9B6rD,GAAOD,GAAM,WAAW5rD,CAAC,CAAC,EAAIA,EAkB3B,MAAMmrC,GAAUgJ,GAAW,CAC9B,IAAI2X,EAAe3X,EAAO,OAAS,IAAMQ,EAAMR,EAAO,OAAQn0C,EAAG6pC,EAAI,EAAGkiB,EAAUC,EAAUC,EAAUC,EAClG/X,EAAOA,EAAO,OAAS,CAAC,IAAM,MAC9B2X,IACI3X,EAAOA,EAAO,OAAS,CAAC,IAAM,KAC9B2X,KAGR,MAAMK,EAAc,IAAI,YAAYL,CAAY,EAAGp1B,EAAQ,IAAI,WAAWy1B,CAAW,EACrF,IAAKnsD,EAAI,EAAGA,EAAI20C,EAAK30C,GAAK,EACtB+rD,EAAWF,GAAO1X,EAAO,WAAWn0C,CAAC,CAAC,EACtCgsD,EAAWH,GAAO1X,EAAO,WAAWn0C,EAAI,CAAC,CAAC,EAC1CisD,EAAWJ,GAAO1X,EAAO,WAAWn0C,EAAI,CAAC,CAAC,EAC1CksD,EAAWL,GAAO1X,EAAO,WAAWn0C,EAAI,CAAC,CAAC,EAC1C02B,EAAMmT,GAAG,EAAKkiB,GAAY,EAAMC,GAAY,EAC5Ct1B,EAAMmT,GAAG,GAAMmiB,EAAW,KAAO,EAAMC,GAAY,EACnDv1B,EAAMmT,GAAG,GAAMoiB,EAAW,IAAM,EAAMC,EAAW,GAErD,OAAOC,CACX,ECxCMjB,GAAwB,OAAO,aAAgB,WACxCkB,GAAe,CAACC,EAAeC,IAAe,CACvD,GAAI,OAAOD,GAAkB,SACzB,MAAO,CACH,KAAM,UACN,KAAME,GAAUF,EAAeC,CAAU,CACrD,EAEI,MAAMv9C,EAAOs9C,EAAc,OAAO,CAAC,EACnC,OAAIt9C,IAAS,IACF,CACH,KAAM,UACN,KAAMy9C,GAAmBH,EAAc,UAAU,CAAC,EAAGC,CAAU,CAC3E,EAEuBvB,GAAqBh8C,CAAI,EAIrCs9C,EAAc,OAAS,EACxB,CACE,KAAMtB,GAAqBh8C,CAAI,EAC/B,KAAMs9C,EAAc,UAAU,CAAC,CAClC,EACC,CACE,KAAMtB,GAAqBh8C,CAAI,CAC3C,EATei8C,EAUf,EACMwB,GAAqB,CAACjxC,EAAM+wC,IAAe,CAC7C,GAAIpB,GAAuB,CACvB,MAAMjrD,EAAUkrC,GAAO5vB,CAAI,EAC3B,OAAOgxC,GAAUtsD,EAASqsD,CAAU,CACvC,KAEG,OAAO,CAAE,OAAQ,GAAM,KAAA/wC,EAE/B,EACMgxC,GAAY,CAAChxC,EAAM+wC,IAAe,CACpC,OAAQA,EAAU,CACd,IAAK,OACD,OAAI/wC,aAAgB,KAETA,EAIA,IAAI,KAAK,CAACA,CAAI,CAAC,EAE9B,IAAK,cACL,QACI,OAAIA,aAAgB,YAETA,EAIAA,EAAK,MAEvB,CACL,EC1DMkxC,GAAY,OAAO,aAAa,EAAE,EAClCC,GAAgB,CAACC,EAAS15C,IAAa,CAEzC,MAAM25C,EAASD,EAAQ,OACjBE,EAAiB,IAAI,MAAMD,CAAM,EACvC,IAAIvwC,EAAQ,EACZswC,EAAQ,QAAQ,CAACjB,EAAQ1rD,IAAM,CAE3BorD,GAAaM,EAAQ,GAAQW,GAAkB,CAC3CQ,EAAe7sD,CAAC,EAAIqsD,EAChB,EAAEhwC,IAAUuwC,GACZ35C,EAAS45C,EAAe,KAAKJ,EAAS,CAAC,CAEvD,CAAS,CACT,CAAK,CACL,EACMK,GAAgB,CAACxqC,EAAgBgqC,IAAe,CAClD,MAAMO,EAAiBvqC,EAAe,MAAMmqC,EAAS,EAC/CE,EAAU,GAChB,QAAS3sD,EAAI,EAAGA,EAAI6sD,EAAe,OAAQ7sD,IAAK,CAC5C,MAAM+sD,EAAgBX,GAAaS,EAAe7sD,CAAC,EAAGssD,CAAU,EAEhE,GADAK,EAAQ,KAAKI,CAAa,EACtBA,EAAc,OAAS,QACvB,KAEP,CACD,OAAOJ,CACX,EACO,SAASK,IAA4B,CACxC,OAAO,IAAI,gBAAgB,CACvB,UAAUtB,EAAQ9iC,EAAY,CAC1B6iC,GAAqBC,EAASW,GAAkB,CAC5C,MAAMY,EAAgBZ,EAAc,OACpC,IAAIzpC,EAEJ,GAAIqqC,EAAgB,IAChBrqC,EAAS,IAAI,WAAW,CAAC,EACzB,IAAI,SAASA,EAAO,MAAM,EAAE,SAAS,EAAGqqC,CAAa,UAEhDA,EAAgB,MAAO,CAC5BrqC,EAAS,IAAI,WAAW,CAAC,EACzB,MAAMC,EAAO,IAAI,SAASD,EAAO,MAAM,EACvCC,EAAK,SAAS,EAAG,GAAG,EACpBA,EAAK,UAAU,EAAGoqC,CAAa,CAClC,KACI,CACDrqC,EAAS,IAAI,WAAW,CAAC,EACzB,MAAMC,EAAO,IAAI,SAASD,EAAO,MAAM,EACvCC,EAAK,SAAS,EAAG,GAAG,EACpBA,EAAK,aAAa,EAAG,OAAOoqC,CAAa,CAAC,CAC7C,CAEGvB,EAAO,MAAQ,OAAOA,EAAO,MAAS,WACtC9oC,EAAO,CAAC,GAAK,KAEjBgG,EAAW,QAAQhG,CAAM,EACzBgG,EAAW,QAAQyjC,CAAa,CAChD,CAAa,CACJ,CACT,CAAK,CACL,CACA,IAAIa,GACJ,SAASC,GAAYC,EAAQ,CACzB,OAAOA,EAAO,OAAO,CAAC5tC,EAAK6tC,IAAU7tC,EAAM6tC,EAAM,OAAQ,CAAC,CAC9D,CACA,SAASC,GAAaF,EAAQ9T,EAAM,CAChC,GAAI8T,EAAO,CAAC,EAAE,SAAW9T,EACrB,OAAO8T,EAAO,QAElB,MAAMjqC,EAAS,IAAI,WAAWm2B,CAAI,EAClC,IAAIiU,EAAI,EACR,QAASvtD,EAAI,EAAGA,EAAIs5C,EAAMt5C,IACtBmjB,EAAOnjB,CAAC,EAAIotD,EAAO,CAAC,EAAEG,GAAG,EACrBA,IAAMH,EAAO,CAAC,EAAE,SAChBA,EAAO,MAAK,EACZG,EAAI,GAGZ,OAAIH,EAAO,QAAUG,EAAIH,EAAO,CAAC,EAAE,SAC/BA,EAAO,CAAC,EAAIA,EAAO,CAAC,EAAE,MAAMG,CAAC,GAE1BpqC,CACX,CACO,SAASqqC,GAA0BC,EAAYnB,EAAY,CACzDY,KACDA,GAAe,IAAI,aAEvB,MAAME,EAAS,GACf,IAAI7vD,EAAQ,EACRmwD,EAAiB,GACjBC,EAAW,GACf,OAAO,IAAI,gBAAgB,CACvB,UAAUN,EAAOzkC,EAAY,CAEzB,IADAwkC,EAAO,KAAKC,CAAK,IACJ,CACT,GAAI9vD,IAAU,EAA2B,CACrC,GAAI4vD,GAAYC,CAAM,EAAI,EACtB,MAEJ,MAAMxqC,EAAS0qC,GAAaF,EAAQ,CAAC,EACrCO,GAAY/qC,EAAO,CAAC,EAAI,OAAU,IAClC8qC,EAAiB9qC,EAAO,CAAC,EAAI,IACzB8qC,EAAiB,IACjBnwD,EAAQ,EAEHmwD,IAAmB,IACxBnwD,EAAQ,EAGRA,EAAQ,CAEf,SACQA,IAAU,EAAuC,CACtD,GAAI4vD,GAAYC,CAAM,EAAI,EACtB,MAEJ,MAAMQ,EAAcN,GAAaF,EAAQ,CAAC,EAC1CM,EAAiB,IAAI,SAASE,EAAY,OAAQA,EAAY,WAAYA,EAAY,MAAM,EAAE,UAAU,CAAC,EACzGrwD,EAAQ,CACX,SACQA,IAAU,EAAuC,CACtD,GAAI4vD,GAAYC,CAAM,EAAI,EACtB,MAEJ,MAAMQ,EAAcN,GAAaF,EAAQ,CAAC,EACpCvqC,EAAO,IAAI,SAAS+qC,EAAY,OAAQA,EAAY,WAAYA,EAAY,MAAM,EAClF3uD,EAAI4jB,EAAK,UAAU,CAAC,EAC1B,GAAI5jB,EAAI,KAAK,IAAI,EAAG,GAAK,EAAE,EAAI,EAAG,CAE9B2pB,EAAW,QAAQoiC,EAAY,EAC/B,KACH,CACD0C,EAAiBzuD,EAAI,KAAK,IAAI,EAAG,EAAE,EAAI4jB,EAAK,UAAU,CAAC,EACvDtlB,EAAQ,CACX,KACI,CACD,GAAI4vD,GAAYC,CAAM,EAAIM,EACtB,MAEJ,MAAMnyC,EAAO+xC,GAAaF,EAAQM,CAAc,EAChD9kC,EAAW,QAAQwjC,GAAauB,EAAWpyC,EAAO2xC,GAAa,OAAO3xC,CAAI,EAAG+wC,CAAU,CAAC,EACxF/uD,EAAQ,CACX,CACD,GAAImwD,IAAmB,GAAKA,EAAiBD,EAAY,CACrD7kC,EAAW,QAAQoiC,EAAY,EAC/B,KACH,CACJ,CACJ,CACT,CAAK,CACL,CACO,MAAMzO,GAAW,ECpJjB,SAASsR,GAAQ78C,EAAK,CAC3B,GAAIA,EAAK,OAAO88C,GAAM98C,CAAG,CAC3B,CAUA,SAAS88C,GAAM98C,EAAK,CAClB,QAASxT,KAAOqwD,GAAQ,UACtB78C,EAAIxT,CAAG,EAAIqwD,GAAQ,UAAUrwD,CAAG,EAElC,OAAOwT,CACT,CAWA68C,GAAQ,UAAU,GAClBA,GAAQ,UAAU,iBAAmB,SAASngD,EAAO1O,EAAG,CACtD,YAAK,WAAa,KAAK,YAAc,IACpC,KAAK,WAAW,IAAM0O,CAAK,EAAI,KAAK,WAAW,IAAMA,CAAK,GAAK,CAAE,GAC/D,KAAK1O,CAAE,EACH,IACT,EAYA6uD,GAAQ,UAAU,KAAO,SAASngD,EAAO1O,EAAG,CAC1C,SAAS+uD,GAAK,CACZ,KAAK,IAAIrgD,EAAOqgD,CAAE,EAClB/uD,EAAG,MAAM,KAAM,SAAS,CACzB,CAED,OAAA+uD,EAAG,GAAK/uD,EACR,KAAK,GAAG0O,EAAOqgD,CAAE,EACV,IACT,EAYAF,GAAQ,UAAU,IAClBA,GAAQ,UAAU,eAClBA,GAAQ,UAAU,mBAClBA,GAAQ,UAAU,oBAAsB,SAASngD,EAAO1O,EAAG,CAIzD,GAHA,KAAK,WAAa,KAAK,YAAc,GAG5B,UAAU,QAAf,EACF,YAAK,WAAa,GACX,KAIT,IAAIgvD,EAAY,KAAK,WAAW,IAAMtgD,CAAK,EAC3C,GAAI,CAACsgD,EAAW,OAAO,KAGvB,GAAS,UAAU,QAAf,EACF,cAAO,KAAK,WAAW,IAAMtgD,CAAK,EAC3B,KAKT,QADIvG,EACKnH,EAAI,EAAGA,EAAIguD,EAAU,OAAQhuD,IAEpC,GADAmH,EAAK6mD,EAAUhuD,CAAC,EACZmH,IAAOnI,GAAMmI,EAAG,KAAOnI,EAAI,CAC7BgvD,EAAU,OAAOhuD,EAAG,CAAC,EACrB,KACD,CAKH,OAAIguD,EAAU,SAAW,GACvB,OAAO,KAAK,WAAW,IAAMtgD,CAAK,EAG7B,IACT,EAUAmgD,GAAQ,UAAU,KAAO,SAASngD,EAAM,CACtC,KAAK,WAAa,KAAK,YAAc,GAKrC,QAHIoM,EAAO,IAAI,MAAM,UAAU,OAAS,CAAC,EACrCk0C,EAAY,KAAK,WAAW,IAAMtgD,CAAK,EAElC1N,EAAI,EAAGA,EAAI,UAAU,OAAQA,IACpC8Z,EAAK9Z,EAAI,CAAC,EAAI,UAAUA,CAAC,EAG3B,GAAIguD,EAAW,CACbA,EAAYA,EAAU,MAAM,CAAC,EAC7B,QAAShuD,EAAI,EAAG20C,EAAMqZ,EAAU,OAAQhuD,EAAI20C,EAAK,EAAE30C,EACjDguD,EAAUhuD,CAAC,EAAE,MAAM,KAAM8Z,CAAI,CAEhC,CAED,OAAO,IACT,EAGA+zC,GAAQ,UAAU,aAAeA,GAAQ,UAAU,KAUnDA,GAAQ,UAAU,UAAY,SAASngD,EAAM,CAC3C,YAAK,WAAa,KAAK,YAAc,GAC9B,KAAK,WAAW,IAAMA,CAAK,GAAK,EACzC,EAUAmgD,GAAQ,UAAU,aAAe,SAASngD,EAAM,CAC9C,MAAO,CAAC,CAAE,KAAK,UAAUA,CAAK,EAAE,MAClC,ECxKO,MAAMugD,IAAY,IACM,OAAO,SAAY,YAAc,OAAO,QAAQ,SAAY,WAE3E9mD,GAAO,QAAQ,QAAO,EAAG,KAAKA,CAAE,EAGjC,CAACA,EAAI+mD,IAAiBA,EAAa/mD,EAAI,CAAC,KAG1CgnD,IAAkB,IACvB,OAAO,KAAS,IACT,KAEF,OAAO,OAAW,IAChB,OAGA,SAAS,aAAa,OAGxBC,GAAoB,cCnB1B,SAASC,GAAKr9C,KAAQpC,EAAM,CAC/B,OAAOA,EAAK,OAAO,CAAC4Q,EAAKqK,KACjB7Y,EAAI,eAAe6Y,CAAC,IACpBrK,EAAIqK,CAAC,EAAI7Y,EAAI6Y,CAAC,GAEXrK,GACR,CAAE,EACT,CAEA,MAAM8uC,GAAqBC,GAAW,WAChCC,GAAuBD,GAAW,aACjC,SAASE,GAAsBz9C,EAAK2U,EAAM,CACzCA,EAAK,iBACL3U,EAAI,aAAes9C,GAAmB,KAAKC,EAAU,EACrDv9C,EAAI,eAAiBw9C,GAAqB,KAAKD,EAAU,IAGzDv9C,EAAI,aAAeu9C,GAAW,WAAW,KAAKA,EAAU,EACxDv9C,EAAI,eAAiBu9C,GAAW,aAAa,KAAKA,EAAU,EAEpE,CAEA,MAAMG,GAAkB,KAEjB,SAASC,GAAW39C,EAAK,CAC5B,OAAI,OAAOA,GAAQ,SACR49C,GAAW59C,CAAG,EAGlB,KAAK,MAAMA,EAAI,YAAcA,EAAI,MAAQ09C,EAAe,CACnE,CACA,SAASE,GAAWl5B,EAAK,CACrB,IAAIrY,EAAI,EAAGuvC,EAAS,EACpB,QAAS5sD,EAAI,EAAG6uD,EAAIn5B,EAAI,OAAQ11B,EAAI6uD,EAAG7uD,IACnCqd,EAAIqY,EAAI,WAAW11B,CAAC,EAChBqd,EAAI,IACJuvC,GAAU,EAELvvC,EAAI,KACTuvC,GAAU,EAELvvC,EAAI,OAAUA,GAAK,MACxBuvC,GAAU,GAGV5sD,IACA4sD,GAAU,GAGlB,OAAOA,CACX,CAIO,SAASl0B,IAAe,CAC3B,OAAQ,KAAK,MAAM,SAAS,EAAE,EAAE,UAAU,CAAC,EACvC,KAAK,OAAQ,EAAC,SAAS,EAAE,EAAE,UAAU,EAAG,CAAC,CACjD,CClDO,SAASwS,GAAOl6B,EAAK,CACxB,IAAI0kB,EAAM,GACV,QAAS11B,KAAKgR,EACNA,EAAI,eAAehR,CAAC,IAChB01B,EAAI,SACJA,GAAO,KACXA,GAAO,mBAAmB11B,CAAC,EAAI,IAAM,mBAAmBgR,EAAIhR,CAAC,CAAC,GAGtE,OAAO01B,CACX,CAOO,SAASyV,GAAO3xB,EAAI,CACvB,IAAIs1C,EAAM,GACNlf,EAAQp2B,EAAG,MAAM,GAAG,EACxB,QAASxZ,EAAI,EAAG6uD,EAAIjf,EAAM,OAAQ5vC,EAAI6uD,EAAG7uD,IAAK,CAC1C,IAAI8vC,EAAOF,EAAM5vC,CAAC,EAAE,MAAM,GAAG,EAC7B8uD,EAAI,mBAAmBhf,EAAK,CAAC,CAAC,CAAC,EAAI,mBAAmBA,EAAK,CAAC,CAAC,CAChE,CACD,OAAOgf,CACX,CC7BO,MAAMC,WAAuB,KAAM,CACtC,YAAYxnC,EAAQqpB,EAAal/B,EAAS,CACtC,MAAM6V,CAAM,EACZ,KAAK,YAAcqpB,EACnB,KAAK,QAAUl/B,EACf,KAAK,KAAO,gBACf,CACL,CACO,MAAMs9C,WAAkBnB,EAAQ,CAOnC,YAAYloC,EAAM,CACd,QACA,KAAK,SAAW,GAChB8oC,GAAsB,KAAM9oC,CAAI,EAChC,KAAK,KAAOA,EACZ,KAAK,MAAQA,EAAK,MAClB,KAAK,OAASA,EAAK,OACnB,KAAK,eAAiB,CAACA,EAAK,WAC/B,CAUD,QAAQ4B,EAAQqpB,EAAal/B,EAAS,CAClC,aAAM,aAAa,QAAS,IAAIq9C,GAAexnC,EAAQqpB,EAAal/B,CAAO,CAAC,EACrE,IACV,CAID,MAAO,CACH,YAAK,WAAa,UAClB,KAAK,OAAM,EACJ,IACV,CAID,OAAQ,CACJ,OAAI,KAAK,aAAe,WAAa,KAAK,aAAe,UACrD,KAAK,QAAO,EACZ,KAAK,QAAO,GAET,IACV,CAMD,KAAKi7C,EAAS,CACN,KAAK,aAAe,QACpB,KAAK,MAAMA,CAAO,CAKzB,CAMD,QAAS,CACL,KAAK,WAAa,OAClB,KAAK,SAAW,GAChB,MAAM,aAAa,MAAM,CAC5B,CAOD,OAAOpxC,EAAM,CACT,MAAMmwC,EAASU,GAAa7wC,EAAM,KAAK,OAAO,UAAU,EACxD,KAAK,SAASmwC,CAAM,CACvB,CAMD,SAASA,EAAQ,CACb,MAAM,aAAa,SAAUA,CAAM,CACtC,CAMD,QAAQp3B,EAAS,CACb,KAAK,WAAa,SAClB,MAAM,aAAa,QAASA,CAAO,CACtC,CAMD,MAAM26B,EAAS,CAAG,CAClB,UAAU7vC,EAAQR,EAAQ,GAAI,CAC1B,OAAQQ,EACJ,MACA,KAAK,UAAW,EAChB,KAAK,MAAO,EACZ,KAAK,KAAK,KACV,KAAK,OAAOR,CAAK,CACxB,CACD,WAAY,CACR,MAAMyhB,EAAW,KAAK,KAAK,SAC3B,OAAOA,EAAS,QAAQ,GAAG,IAAM,GAAKA,EAAW,IAAMA,EAAW,GACrE,CACD,OAAQ,CACJ,OAAI,KAAK,KAAK,OACR,KAAK,KAAK,QAAU,EAAO,KAAK,KAAK,OAAS,MAC3C,CAAC,KAAK,KAAK,QAAU,OAAO,KAAK,KAAK,IAAI,IAAM,IAC9C,IAAM,KAAK,KAAK,KAGhB,EAEd,CACD,OAAOzhB,EAAO,CACV,MAAMswC,EAAehkB,GAAOtsB,CAAK,EACjC,OAAOswC,EAAa,OAAS,IAAMA,EAAe,EACrD,CACL,CC1IO,MAAMC,WAAgBH,EAAU,CACnC,aAAc,CACV,MAAM,GAAG,SAAS,EAClB,KAAK,SAAW,EACnB,CACD,IAAI,MAAO,CACP,MAAO,SACV,CAOD,QAAS,CACL,KAAK,MAAK,CACb,CAOD,MAAMC,EAAS,CACX,KAAK,WAAa,UAClB,MAAMG,EAAQ,IAAM,CAChB,KAAK,WAAa,SAClBH,GACZ,EACQ,GAAI,KAAK,UAAY,CAAC,KAAK,SAAU,CACjC,IAAI7yB,EAAQ,EACR,KAAK,WACLA,IACA,KAAK,KAAK,eAAgB,UAAY,CAClC,EAAEA,GAASgzB,GAC/B,CAAiB,GAEA,KAAK,WACNhzB,IACA,KAAK,KAAK,QAAS,UAAY,CAC3B,EAAEA,GAASgzB,GAC/B,CAAiB,EAER,MAEGA,GAEP,CAMD,OAAQ,CACJ,KAAK,SAAW,GAChB,KAAK,OAAM,EACX,KAAK,aAAa,MAAM,CAC3B,CAMD,OAAO7zC,EAAM,CACT,MAAMtI,EAAYy4C,GAAW,CAMzB,GAJkB,KAAK,aAAnB,WAAiCA,EAAO,OAAS,QACjD,KAAK,OAAM,EAGCA,EAAO,OAAnB,QACA,YAAK,QAAQ,CAAE,YAAa,gCAAkC,GACvD,GAGX,KAAK,SAASA,CAAM,CAChC,EAEQoB,GAAcvxC,EAAM,KAAK,OAAO,UAAU,EAAE,QAAQtI,CAAQ,EAE3C,KAAK,aAAlB,WAEA,KAAK,SAAW,GAChB,KAAK,aAAa,cAAc,EACjB,KAAK,aAAhB,QACA,KAAK,MAAK,EAKrB,CAMD,SAAU,CACN,MAAMgW,EAAQ,IAAM,CAChB,KAAK,MAAM,CAAC,CAAE,KAAM,OAAO,CAAE,CAAC,CAC1C,EACuB,KAAK,aAAhB,OACAA,IAKA,KAAK,KAAK,OAAQA,CAAK,CAE9B,CAOD,MAAM0jC,EAAS,CACX,KAAK,SAAW,GAChBD,GAAcC,EAAUpxC,GAAS,CAC7B,KAAK,QAAQA,EAAM,IAAM,CACrB,KAAK,SAAW,GAChB,KAAK,aAAa,OAAO,CACzC,CAAa,CACb,CAAS,CACJ,CAMD,KAAM,CACF,MAAM6D,EAAS,KAAK,KAAK,OAAS,QAAU,OACtCR,EAAQ,KAAK,OAAS,GAE5B,OAAc,KAAK,KAAK,oBAApB,KACAA,EAAM,KAAK,KAAK,cAAc,EAAI8Z,GAAY,GAE9C,CAAC,KAAK,gBAAkB,CAAC9Z,EAAM,MAC/BA,EAAM,IAAM,GAET,KAAK,UAAUQ,EAAQR,CAAK,CACtC,CACL,CC/IA,IAAI9hB,GAAQ,GACZ,GAAI,CACAA,GAAQ,OAAO,eAAmB,KAC9B,oBAAqB,IAAI,cACjC,MACY,CAGZ,CACO,MAAMuyD,GAAUvyD,GCLvB,SAASwyD,IAAQ,CAAG,CACb,MAAMC,WAAgBJ,EAAQ,CAOjC,YAAYxpC,EAAM,CAEd,GADA,MAAMA,CAAI,EACN,OAAO,SAAa,IAAa,CACjC,MAAM6pC,EAAqB,SAAS,WAAtB,SACd,IAAIC,EAAO,SAAS,KAEfA,IACDA,EAAOD,EAAQ,MAAQ,MAE3B,KAAK,GACA,OAAO,SAAa,KACjB7pC,EAAK,WAAa,SAAS,UAC3B8pC,IAAS9pC,EAAK,IACzB,CACJ,CAQD,QAAQpK,EAAMvc,EAAI,CACd,MAAM0wD,EAAM,KAAK,QAAQ,CACrB,OAAQ,OACR,KAAMn0C,CAClB,CAAS,EACDm0C,EAAI,GAAG,UAAW1wD,CAAE,EACpB0wD,EAAI,GAAG,QAAS,CAACC,EAAWj+C,IAAY,CACpC,KAAK,QAAQ,iBAAkBi+C,EAAWj+C,CAAO,CAC7D,CAAS,CACJ,CAMD,QAAS,CACL,MAAMg+C,EAAM,KAAK,UACjBA,EAAI,GAAG,OAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,EACrCA,EAAI,GAAG,QAAS,CAACC,EAAWj+C,IAAY,CACpC,KAAK,QAAQ,iBAAkBi+C,EAAWj+C,CAAO,CAC7D,CAAS,EACD,KAAK,QAAUg+C,CAClB,CACL,QACO,MAAME,WAAgB/B,EAAQ,CAOjC,YAAYgC,EAAezxB,EAAKzY,EAAM,CAClC,QACA,KAAK,cAAgBkqC,EACrBpB,GAAsB,KAAM9oC,CAAI,EAChC,KAAK,MAAQA,EACb,KAAK,QAAUA,EAAK,QAAU,MAC9B,KAAK,KAAOyY,EACZ,KAAK,MAAsBzY,EAAK,OAAnB,OAA0BA,EAAK,KAAO,KACnD,KAAK,QAAO,CACf,CAMD,SAAU,CACN,IAAIhL,EACJ,MAAMgL,EAAO0oC,GAAK,KAAK,MAAO,QAAS,MAAO,MAAO,aAAc,OAAQ,KAAM,UAAW,qBAAsB,WAAW,EAC7H1oC,EAAK,QAAU,CAAC,CAAC,KAAK,MAAM,GAC5B,MAAMmqC,EAAO,KAAK,KAAO,KAAK,cAAcnqC,CAAI,EAChD,GAAI,CACAmqC,EAAI,KAAK,KAAK,QAAS,KAAK,KAAM,EAAI,EACtC,GAAI,CACA,GAAI,KAAK,MAAM,aAAc,CAEzBA,EAAI,uBAAyBA,EAAI,sBAAsB,EAAI,EAC3D,QAAS9vD,KAAK,KAAK,MAAM,aACjB,KAAK,MAAM,aAAa,eAAeA,CAAC,GACxC8vD,EAAI,iBAAiB9vD,EAAG,KAAK,MAAM,aAAaA,CAAC,CAAC,CAG7D,CACJ,MACS,CAAG,CACb,GAAe,KAAK,UAAhB,OACA,GAAI,CACA8vD,EAAI,iBAAiB,eAAgB,0BAA0B,CAClE,MACS,CAAG,CAEjB,GAAI,CACAA,EAAI,iBAAiB,SAAU,KAAK,CACvC,MACS,CAAG,EACZn1C,EAAK,KAAK,MAAM,aAAe,MAAQA,IAAO,QAAkBA,EAAG,WAAWm1C,CAAG,EAE9E,oBAAqBA,IACrBA,EAAI,gBAAkB,KAAK,MAAM,iBAEjC,KAAK,MAAM,iBACXA,EAAI,QAAU,KAAK,MAAM,gBAE7BA,EAAI,mBAAqB,IAAM,CAC3B,IAAIn1C,EACAm1C,EAAI,aAAe,KAClBn1C,EAAK,KAAK,MAAM,aAAe,MAAQA,IAAO,QAAkBA,EAAG,aAEpEm1C,EAAI,kBAAkB,YAAY,CAAC,GAE7BA,EAAI,aAAV,IAEQA,EAAI,SAAZ,KAA+BA,EAAI,SAAb,KACtB,KAAK,QAAO,EAKZ,KAAK,aAAa,IAAM,CACpB,KAAK,SAAS,OAAOA,EAAI,QAAW,SAAWA,EAAI,OAAS,CAAC,CAChE,EAAE,CAAC,EAExB,EACYA,EAAI,KAAK,KAAK,KAAK,CACtB,OACMhoC,EAAG,CAIN,KAAK,aAAa,IAAM,CACpB,KAAK,SAASA,CAAC,CAClB,EAAE,CAAC,EACJ,MACH,CACG,OAAO,SAAa,MACpB,KAAK,OAAS8nC,GAAQ,gBACtBA,GAAQ,SAAS,KAAK,MAAM,EAAI,KAEvC,CAMD,SAAS/iC,EAAK,CACV,KAAK,aAAa,QAASA,EAAK,KAAK,IAAI,EACzC,KAAK,SAAS,EAAI,CACrB,CAMD,SAASkjC,EAAW,CAChB,GAAI,EAAgB,OAAO,KAAK,KAA5B,KAA6C,KAAK,OAAd,MAIxC,IADA,KAAK,KAAK,mBAAqBT,GAC3BS,EACA,GAAI,CACA,KAAK,KAAK,OACb,MACS,CAAG,CAEb,OAAO,SAAa,KACpB,OAAOH,GAAQ,SAAS,KAAK,MAAM,EAEvC,KAAK,KAAO,KACf,CAMD,SAAU,CACN,MAAMr0C,EAAO,KAAK,KAAK,aACnBA,IAAS,OACT,KAAK,aAAa,OAAQA,CAAI,EAC9B,KAAK,aAAa,SAAS,EAC3B,KAAK,SAAQ,EAEpB,CAMD,OAAQ,CACJ,KAAK,SAAQ,CAChB,CACL,EACAq0C,GAAQ,cAAgB,EACxBA,GAAQ,SAAW,GAMnB,GAAI,OAAO,SAAa,KAEpB,GAAI,OAAO,aAAgB,WAEvB,YAAY,WAAYI,EAAa,UAEhC,OAAO,kBAAqB,WAAY,CAC7C,MAAMC,EAAmB,eAAgB1B,GAAa,WAAa,SACnE,iBAAiB0B,EAAkBD,GAAe,EAAK,CAC1D,EAEL,SAASA,IAAgB,CACrB,QAAShwD,KAAK4vD,GAAQ,SACdA,GAAQ,SAAS,eAAe5vD,CAAC,GACjC4vD,GAAQ,SAAS5vD,CAAC,EAAE,MAAK,CAGrC,CACA,MAAMkwD,GAAW,UAAY,CACzB,MAAMJ,EAAMK,GAAW,CACnB,QAAS,EACjB,CAAK,EACD,OAAOL,GAAOA,EAAI,eAAiB,IACvC,IAQO,MAAMM,WAAYb,EAAQ,CAC7B,YAAY5pC,EAAM,CACd,MAAMA,CAAI,EACV,MAAM0qC,EAAc1qC,GAAQA,EAAK,YACjC,KAAK,eAAiBuqC,IAAW,CAACG,CACrC,CACD,QAAQ1qC,EAAO,GAAI,CACf,cAAO,OAAOA,EAAM,CAAE,GAAI,KAAK,EAAI,EAAE,KAAK,IAAI,EACvC,IAAIiqC,GAAQO,GAAY,KAAK,IAAG,EAAIxqC,CAAI,CAClD,CACL,CACA,SAASwqC,GAAWxqC,EAAM,CACtB,MAAM2qC,EAAU3qC,EAAK,QAErB,GAAI,CACA,GAAoB,OAAO,eAAvB,MAA0C,CAAC2qC,GAAWjB,IACtD,OAAO,IAAI,cAElB,MACS,CAAG,CACb,GAAI,CAACiB,EACD,GAAI,CACA,OAAO,IAAI/B,GAAW,CAAC,QAAQ,EAAE,OAAO,QAAQ,EAAE,KAAK,GAAG,CAAC,EAAE,mBAAmB,CACnF,MACS,CAAG,CAErB,CCzQA,MAAMgC,GAAgB,OAAO,UAAc,KACvC,OAAO,UAAU,SAAY,UAC7B,UAAU,QAAQ,YAAa,IAAK,cACjC,MAAMC,WAAexB,EAAU,CAClC,IAAI,MAAO,CACP,MAAO,WACV,CACD,QAAS,CACL,MAAM5wB,EAAM,KAAK,MACXpd,EAAY,KAAK,KAAK,UAEtB2E,EAAO4qC,GACP,CAAE,EACFlC,GAAK,KAAK,KAAM,QAAS,oBAAqB,MAAO,MAAO,aAAc,OAAQ,KAAM,UAAW,qBAAsB,eAAgB,kBAAmB,SAAU,aAAc,SAAU,qBAAqB,EACrN,KAAK,KAAK,eACV1oC,EAAK,QAAU,KAAK,KAAK,cAE7B,GAAI,CACA,KAAK,GAAK,KAAK,aAAayY,EAAKpd,EAAW2E,CAAI,CACnD,OACMkH,EAAK,CACR,OAAO,KAAK,aAAa,QAASA,CAAG,CACxC,CACD,KAAK,GAAG,WAAa,KAAK,OAAO,WACjC,KAAK,kBAAiB,CACzB,CAMD,mBAAoB,CAChB,KAAK,GAAG,OAAS,IAAM,CACf,KAAK,KAAK,WACV,KAAK,GAAG,QAAQ,QAEpB,KAAK,OAAM,CACvB,EACQ,KAAK,GAAG,QAAW4jC,GAAe,KAAK,QAAQ,CAC3C,YAAa,8BACb,QAASA,CACrB,CAAS,EACD,KAAK,GAAG,UAAaC,GAAO,KAAK,OAAOA,EAAG,IAAI,EAC/C,KAAK,GAAG,QAAW,GAAM,KAAK,QAAQ,kBAAmB,CAAC,CAC7D,CACD,MAAM/D,EAAS,CACX,KAAK,SAAW,GAGhB,QAAS3sD,EAAI,EAAGA,EAAI2sD,EAAQ,OAAQ3sD,IAAK,CACrC,MAAM0rD,EAASiB,EAAQ3sD,CAAC,EAClB2wD,EAAa3wD,IAAM2sD,EAAQ,OAAS,EAC1CvB,GAAaM,EAAQ,KAAK,eAAiBnwC,GAAS,CAIhD,GAAI,CACA,KAAK,QAAQmwC,EAAQnwC,CAAI,CAC5B,MACS,CACT,CACGo1C,GAGA1C,GAAS,IAAM,CACX,KAAK,SAAW,GAChB,KAAK,aAAa,OAAO,CACjD,EAAuB,KAAK,YAAY,CAExC,CAAa,CACJ,CACJ,CACD,SAAU,CACF,OAAO,KAAK,GAAO,MACnB,KAAK,GAAG,QAAU,IAAM,GACxB,KAAK,GAAG,QACR,KAAK,GAAK,KAEjB,CAMD,KAAM,CACF,MAAM7uC,EAAS,KAAK,KAAK,OAAS,MAAQ,KACpCR,EAAQ,KAAK,OAAS,GAE5B,OAAI,KAAK,KAAK,oBACVA,EAAM,KAAK,KAAK,cAAc,EAAI8Z,GAAY,GAG7C,KAAK,iBACN9Z,EAAM,IAAM,GAET,KAAK,UAAUQ,EAAQR,CAAK,CACtC,CACL,CACA,MAAMgyC,GAAgBrC,GAAW,WAAaA,GAAW,aAUlD,MAAMttC,WAAWuvC,EAAO,CAC3B,aAAapyB,EAAKpd,EAAW2E,EAAM,CAC/B,OAAQ4qC,GAIF,IAAIK,GAAcxyB,EAAKpd,EAAW2E,CAAI,EAHtC3E,EACI,IAAI4vC,GAAcxyB,EAAKpd,CAAS,EAChC,IAAI4vC,GAAcxyB,CAAG,CAElC,CACD,QAAQyyB,EAASt1C,EAAM,CACnB,KAAK,GAAG,KAAKA,CAAI,CACpB,CACL,CCjHO,MAAMu1C,WAAW9B,EAAU,CAC9B,IAAI,MAAO,CACP,MAAO,cACV,CACD,QAAS,CACL,GAAI,CAEA,KAAK,WAAa,IAAI,aAAa,KAAK,UAAU,OAAO,EAAG,KAAK,KAAK,iBAAiB,KAAK,IAAI,CAAC,CACpG,OACMniC,EAAK,CACR,OAAO,KAAK,aAAa,QAASA,CAAG,CACxC,CACD,KAAK,WAAW,OACX,KAAK,IAAM,CACZ,KAAK,QAAO,CACxB,CAAS,EACI,MAAOA,GAAQ,CAChB,KAAK,QAAQ,qBAAsBA,CAAG,CAClD,CAAS,EAED,KAAK,WAAW,MAAM,KAAK,IAAM,CAC7B,KAAK,WAAW,0BAA2B,EAAC,KAAMkkC,GAAW,CACzD,MAAMC,EAAgBxD,GAA0B,OAAO,iBAAkB,KAAK,OAAO,UAAU,EACzF5hB,EAASmlB,EAAO,SAAS,YAAYC,CAAa,EAAE,YACpDC,EAAgBjE,KACtBiE,EAAc,SAAS,OAAOF,EAAO,QAAQ,EAC7C,KAAK,QAAUE,EAAc,SAAS,UAAS,EAC/C,MAAMC,EAAO,IAAM,CACftlB,EACK,KAAM,EACN,KAAK,CAAC,CAAE,KAAAulB,EAAM,MAAAr0D,KAAY,CACvBq0D,IAGJ,KAAK,SAASr0D,CAAK,EACnBo0D,IACxB,CAAqB,EACI,MAAOrkC,GAAQ,CACxC,CAAqB,CACrB,EACgBqkC,IACA,MAAMxF,EAAS,CAAE,KAAM,QACnB,KAAK,MAAM,MACXA,EAAO,KAAO,WAAW,KAAK,MAAM,GAAG,MAE3C,KAAK,QAAQ,MAAMA,CAAM,EAAE,KAAK,IAAM,KAAK,OAAM,CAAE,CACnE,CAAa,CACb,CAAS,CACJ,CACD,MAAMiB,EAAS,CACX,KAAK,SAAW,GAChB,QAAS3sD,EAAI,EAAGA,EAAI2sD,EAAQ,OAAQ3sD,IAAK,CACrC,MAAM0rD,EAASiB,EAAQ3sD,CAAC,EAClB2wD,EAAa3wD,IAAM2sD,EAAQ,OAAS,EAC1C,KAAK,QAAQ,MAAMjB,CAAM,EAAE,KAAK,IAAM,CAC9BiF,GACA1C,GAAS,IAAM,CACX,KAAK,SAAW,GAChB,KAAK,aAAa,OAAO,CACjD,EAAuB,KAAK,YAAY,CAExC,CAAa,CACJ,CACJ,CACD,SAAU,CACN,IAAItzC,GACHA,EAAK,KAAK,cAAgB,MAAQA,IAAO,QAAkBA,EAAG,MAAK,CACvE,CACL,CC5EO,MAAMy2C,GAAa,CACtB,UAAWnwC,GACX,aAAc6vC,GACd,QAASV,EACb,ECYMiB,GAAK,sPACL15B,GAAQ,CACV,SAAU,WAAY,YAAa,WAAY,OAAQ,WAAY,OAAQ,OAAQ,WAAY,OAAQ,YAAa,OAAQ,QAAS,QACzI,EACO,SAASkqB,GAAMnsB,EAAK,CACvB,GAAIA,EAAI,OAAS,IACb,KAAM,eAEV,MAAM47B,EAAM57B,EAAKh0B,EAAIg0B,EAAI,QAAQ,GAAG,EAAG5N,EAAI4N,EAAI,QAAQ,GAAG,EACtDh0B,GAAK,IAAMomB,GAAK,KAChB4N,EAAMA,EAAI,UAAU,EAAGh0B,CAAC,EAAIg0B,EAAI,UAAUh0B,EAAGomB,CAAC,EAAE,QAAQ,KAAM,GAAG,EAAI4N,EAAI,UAAU5N,EAAG4N,EAAI,MAAM,GAEpG,IAAI95B,EAAIy1D,GAAG,KAAK37B,GAAO,EAAE,EAAG0I,EAAM,GAAIp+B,EAAI,GAC1C,KAAOA,KACHo+B,EAAIzG,GAAM33B,CAAC,CAAC,EAAIpE,EAAEoE,CAAC,GAAK,GAE5B,OAAI0B,GAAK,IAAMomB,GAAK,KAChBsW,EAAI,OAASkzB,EACblzB,EAAI,KAAOA,EAAI,KAAK,UAAU,EAAGA,EAAI,KAAK,OAAS,CAAC,EAAE,QAAQ,KAAM,GAAG,EACvEA,EAAI,UAAYA,EAAI,UAAU,QAAQ,IAAK,EAAE,EAAE,QAAQ,IAAK,EAAE,EAAE,QAAQ,KAAM,GAAG,EACjFA,EAAI,QAAU,IAElBA,EAAI,UAAYmzB,GAAUnzB,EAAKA,EAAI,IAAO,EAC1CA,EAAI,SAAWozB,GAASpzB,EAAKA,EAAI,KAAQ,EAClCA,CACX,CACA,SAASmzB,GAAUvgD,EAAKtT,EAAM,CAC1B,MAAM+zD,EAAO,WAAYC,EAAQh0D,EAAK,QAAQ+zD,EAAM,GAAG,EAAE,MAAM,GAAG,EAClE,OAAI/zD,EAAK,MAAM,EAAG,CAAC,GAAK,KAAOA,EAAK,SAAW,IAC3Cg0D,EAAM,OAAO,EAAG,CAAC,EAEjBh0D,EAAK,MAAM,EAAE,GAAK,KAClBg0D,EAAM,OAAOA,EAAM,OAAS,EAAG,CAAC,EAE7BA,CACX,CACA,SAASF,GAASpzB,EAAKxf,EAAO,CAC1B,MAAMrD,EAAO,GACb,OAAAqD,EAAM,QAAQ,4BAA6B,SAAU+yC,EAAIC,EAAIC,EAAI,CACzDD,IACAr2C,EAAKq2C,CAAE,EAAIC,EAEvB,CAAK,EACMt2C,CACX,CCxDA,MAAMu2C,GAAqB,OAAO,kBAAqB,YACnD,OAAO,qBAAwB,WAC7BC,GAA0B,GAC5BD,IAGA,iBAAiB,UAAW,IAAM,CAC9BC,GAAwB,QAAS5zD,GAAaA,EAAU,EAC3D,EAAE,EAAK,EAyBL,MAAM6zD,WAA6BnE,EAAQ,CAO9C,YAAYzvB,EAAKzY,EAAM,CAiBnB,GAhBA,QACA,KAAK,WAAayoC,GAClB,KAAK,YAAc,GACnB,KAAK,eAAiB,EACtB,KAAK,cAAgB,GACrB,KAAK,aAAe,GACpB,KAAK,YAAc,GAKnB,KAAK,iBAAmB,IACpBhwB,GAAoB,OAAOA,GAApB,WACPzY,EAAOyY,EACPA,EAAM,MAENA,EAAK,CACL,MAAM6zB,EAAYpQ,GAAMzjB,CAAG,EAC3BzY,EAAK,SAAWssC,EAAU,KAC1BtsC,EAAK,OACDssC,EAAU,WAAa,SAAWA,EAAU,WAAa,MAC7DtsC,EAAK,KAAOssC,EAAU,KAClBA,EAAU,QACVtsC,EAAK,MAAQssC,EAAU,MAC9B,MACQtsC,EAAK,OACVA,EAAK,SAAWk8B,GAAMl8B,EAAK,IAAI,EAAE,MAErC8oC,GAAsB,KAAM9oC,CAAI,EAChC,KAAK,OACOA,EAAK,QAAb,KACMA,EAAK,OACL,OAAO,SAAa,KAA4B,SAAS,WAAtB,SACzCA,EAAK,UAAY,CAACA,EAAK,OAEvBA,EAAK,KAAO,KAAK,OAAS,MAAQ,MAEtC,KAAK,SACDA,EAAK,WACA,OAAO,SAAa,IAAc,SAAS,SAAW,aAC/D,KAAK,KACDA,EAAK,OACA,OAAO,SAAa,KAAe,SAAS,KACvC,SAAS,KACT,KAAK,OACD,MACA,MAClB,KAAK,WAAa,GAClB,KAAK,kBAAoB,GACzBA,EAAK,WAAW,QAAS0+B,GAAM,CAC3B,MAAM6N,EAAgB7N,EAAE,UAAU,KAClC,KAAK,WAAW,KAAK6N,CAAa,EAClC,KAAK,kBAAkBA,CAAa,EAAI7N,CACpD,CAAS,EACD,KAAK,KAAO,OAAO,OAAO,CACtB,KAAM,aACN,MAAO,GACP,gBAAiB,GACjB,QAAS,GACT,eAAgB,IAChB,gBAAiB,GACjB,iBAAkB,GAClB,mBAAoB,GACpB,kBAAmB,CACf,UAAW,IACd,EACD,iBAAkB,CAAE,EACpB,oBAAqB,EACxB,EAAE1+B,CAAI,EACP,KAAK,KAAK,KACN,KAAK,KAAK,KAAK,QAAQ,MAAO,EAAE,GAC3B,KAAK,KAAK,iBAAmB,IAAM,IACxC,OAAO,KAAK,KAAK,OAAU,WAC3B,KAAK,KAAK,MAAQwlB,GAAO,KAAK,KAAK,KAAK,GAExC2mB,KACI,KAAK,KAAK,sBAIV,KAAK,2BAA6B,IAAM,CAChC,KAAK,YAEL,KAAK,UAAU,qBACf,KAAK,UAAU,QAEvC,EACgB,iBAAiB,eAAgB,KAAK,2BAA4B,EAAK,GAEvE,KAAK,WAAa,cAClB,KAAK,sBAAwB,IAAM,CAC/B,KAAK,SAAS,kBAAmB,CAC7B,YAAa,yBACrC,CAAqB,CACrB,EACgBC,GAAwB,KAAK,KAAK,qBAAqB,IAG3D,KAAK,KAAK,kBACV,KAAK,WAAa,QAEtB,KAAK,MAAK,CACb,CAQD,gBAAgBjjD,EAAM,CAClB,MAAM8P,EAAQ,OAAO,OAAO,CAAE,EAAE,KAAK,KAAK,KAAK,EAE/CA,EAAM,IAAM29B,GAEZ39B,EAAM,UAAY9P,EAEd,KAAK,KACL8P,EAAM,IAAM,KAAK,IACrB,MAAM+G,EAAO,OAAO,OAAO,GAAI,KAAK,KAAM,CACtC,MAAA/G,EACA,OAAQ,KACR,SAAU,KAAK,SACf,OAAQ,KAAK,OACb,KAAM,KAAK,IACd,EAAE,KAAK,KAAK,iBAAiB9P,CAAI,CAAC,EACnC,OAAO,IAAI,KAAK,kBAAkBA,CAAI,EAAE6W,CAAI,CAC/C,CAMD,OAAQ,CACJ,GAAI,KAAK,WAAW,SAAW,EAAG,CAE9B,KAAK,aAAa,IAAM,CACpB,KAAK,aAAa,QAAS,yBAAyB,CACvD,EAAE,CAAC,EACJ,MACH,CACD,MAAMusC,EAAgB,KAAK,KAAK,iBAC5BF,GAAqB,uBACrB,KAAK,WAAW,QAAQ,WAAW,IAAM,GACvC,YACA,KAAK,WAAW,CAAC,EACvB,KAAK,WAAa,UAClB,MAAMG,EAAY,KAAK,gBAAgBD,CAAa,EACpDC,EAAU,KAAI,EACd,KAAK,aAAaA,CAAS,CAC9B,CAMD,aAAaA,EAAW,CAChB,KAAK,WACL,KAAK,UAAU,qBAGnB,KAAK,UAAYA,EAEjBA,EACK,GAAG,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EACpC,GAAG,SAAU,KAAK,UAAU,KAAK,IAAI,CAAC,EACtC,GAAG,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EACpC,GAAG,QAAU5qC,GAAW,KAAK,SAAS,kBAAmBA,CAAM,CAAC,CACxE,CAMD,QAAS,CACL,KAAK,WAAa,OAClByqC,GAAqB,sBACD,KAAK,UAAU,OAA/B,YACJ,KAAK,aAAa,MAAM,EACxB,KAAK,MAAK,CACb,CAMD,UAAUtG,EAAQ,CACd,GAAkB,KAAK,aAAnB,WACW,KAAK,aAAhB,QACc,KAAK,aAAnB,UAIA,OAHA,KAAK,aAAa,SAAUA,CAAM,EAElC,KAAK,aAAa,WAAW,EACrBA,EAAO,KAAI,CACf,IAAK,OACD,KAAK,YAAY,KAAK,MAAMA,EAAO,IAAI,CAAC,EACxC,MACJ,IAAK,OACD,KAAK,YAAY,MAAM,EACvB,KAAK,aAAa,MAAM,EACxB,KAAK,aAAa,MAAM,EACxB,KAAK,kBAAiB,EACtB,MACJ,IAAK,QACD,MAAM7+B,EAAM,IAAI,MAAM,cAAc,EAEpCA,EAAI,KAAO6+B,EAAO,KAClB,KAAK,SAAS7+B,CAAG,EACjB,MACJ,IAAK,UACD,KAAK,aAAa,OAAQ6+B,EAAO,IAAI,EACrC,KAAK,aAAa,UAAWA,EAAO,IAAI,EACxC,KACP,CAIR,CAOD,YAAYnwC,EAAM,CACd,KAAK,aAAa,YAAaA,CAAI,EACnC,KAAK,GAAKA,EAAK,IACf,KAAK,UAAU,MAAM,IAAMA,EAAK,IAChC,KAAK,cAAgBA,EAAK,aAC1B,KAAK,aAAeA,EAAK,YACzB,KAAK,YAAcA,EAAK,WACxB,KAAK,OAAM,EAEM,KAAK,aAAlB,UAEJ,KAAK,kBAAiB,CACzB,CAMD,mBAAoB,CAChB,KAAK,eAAe,KAAK,iBAAiB,EAC1C,MAAM62C,EAAQ,KAAK,cAAgB,KAAK,aACxC,KAAK,iBAAmB,KAAK,IAAG,EAAKA,EACrC,KAAK,kBAAoB,KAAK,aAAa,IAAM,CAC7C,KAAK,SAAS,cAAc,CAC/B,EAAEA,CAAK,EACJ,KAAK,KAAK,WACV,KAAK,kBAAkB,OAE9B,CAMD,UAAW,CACP,KAAK,YAAY,OAAO,EAAG,KAAK,cAAc,EAI9C,KAAK,eAAiB,EACZ,KAAK,YAAY,SAAvB,EACA,KAAK,aAAa,OAAO,EAGzB,KAAK,MAAK,CAEjB,CAMD,OAAQ,CACJ,GAAiB,KAAK,aAAlB,UACA,KAAK,UAAU,UACf,CAAC,KAAK,WACN,KAAK,YAAY,OAAQ,CACzB,MAAMzF,EAAU,KAAK,sBACrB,KAAK,UAAU,KAAKA,CAAO,EAG3B,KAAK,eAAiBA,EAAQ,OAC9B,KAAK,aAAa,OAAO,CAC5B,CACJ,CAOD,qBAAsB,CAIlB,GAAI,EAH2B,KAAK,aAChC,KAAK,UAAU,OAAS,WACxB,KAAK,YAAY,OAAS,GAE1B,OAAO,KAAK,YAEhB,IAAI0F,EAAc,EAClB,QAASryD,EAAI,EAAGA,EAAI,KAAK,YAAY,OAAQA,IAAK,CAC9C,MAAMub,EAAO,KAAK,YAAYvb,CAAC,EAAE,KAIjC,GAHIub,IACA82C,GAAe1D,GAAWpzC,CAAI,GAE9Bvb,EAAI,GAAKqyD,EAAc,KAAK,YAC5B,OAAO,KAAK,YAAY,MAAM,EAAGryD,CAAC,EAEtCqyD,GAAe,CAClB,CACD,OAAO,KAAK,WACf,CAUa,iBAAkB,CAC5B,GAAI,CAAC,KAAK,iBACN,MAAO,GACX,MAAMjuB,EAAa,KAAK,IAAG,EAAK,KAAK,iBACrC,OAAIA,IACA,KAAK,iBAAmB,EACxB6pB,GAAS,IAAM,CACX,KAAK,SAAS,cAAc,CAC5C,EAAe,KAAK,YAAY,GAEjB7pB,CACV,CASD,MAAMniB,EAAKhmB,EAAS+C,EAAI,CACpB,YAAK,YAAY,UAAWijB,EAAKhmB,EAAS+C,CAAE,EACrC,IACV,CASD,KAAKijB,EAAKhmB,EAAS+C,EAAI,CACnB,YAAK,YAAY,UAAWijB,EAAKhmB,EAAS+C,CAAE,EACrC,IACV,CAUD,YAAY+P,EAAMwM,EAAMtf,EAAS+C,EAAI,CASjC,GARmB,OAAOuc,GAAtB,aACAvc,EAAKuc,EACLA,EAAO,QAEQ,OAAOtf,GAAtB,aACA+C,EAAK/C,EACLA,EAAU,MAEI,KAAK,aAAnB,WAA8C,KAAK,aAAlB,SACjC,OAEJA,EAAUA,GAAW,GACrBA,EAAQ,SAAqBA,EAAQ,WAAlB,GACnB,MAAMyvD,EAAS,CACX,KAAM38C,EACN,KAAMwM,EACN,QAAStf,CACrB,EACQ,KAAK,aAAa,eAAgByvD,CAAM,EACxC,KAAK,YAAY,KAAKA,CAAM,EACxB1sD,GACA,KAAK,KAAK,QAASA,CAAE,EACzB,KAAK,MAAK,CACb,CAID,OAAQ,CACJ,MAAMiqB,EAAQ,IAAM,CAChB,KAAK,SAAS,cAAc,EAC5B,KAAK,UAAU,OAC3B,EACcqpC,EAAkB,IAAM,CAC1B,KAAK,IAAI,UAAWA,CAAe,EACnC,KAAK,IAAI,eAAgBA,CAAe,EACxCrpC,GACZ,EACcspC,EAAiB,IAAM,CAEzB,KAAK,KAAK,UAAWD,CAAe,EACpC,KAAK,KAAK,eAAgBA,CAAe,CACrD,EACQ,OAAkB,KAAK,aAAnB,WAA4C,KAAK,aAAhB,UACjC,KAAK,WAAa,UACd,KAAK,YAAY,OACjB,KAAK,KAAK,QAAS,IAAM,CACjB,KAAK,UACLC,IAGAtpC,GAExB,CAAiB,EAEI,KAAK,UACVspC,IAGAtpC,KAGD,IACV,CAMD,SAAS4D,EAAK,CAEV,GADAmlC,GAAqB,sBAAwB,GACzC,KAAK,KAAK,kBACV,KAAK,WAAW,OAAS,GACzB,KAAK,aAAe,UACpB,YAAK,WAAW,QACT,KAAK,QAEhB,KAAK,aAAa,QAASnlC,CAAG,EAC9B,KAAK,SAAS,kBAAmBA,CAAG,CACvC,CAMD,SAAStF,EAAQqpB,EAAa,CAC1B,GAAkB,KAAK,aAAnB,WACW,KAAK,aAAhB,QACc,KAAK,aAAnB,UAA+B,CAS/B,GAPA,KAAK,eAAe,KAAK,iBAAiB,EAE1C,KAAK,UAAU,mBAAmB,OAAO,EAEzC,KAAK,UAAU,QAEf,KAAK,UAAU,qBACXkhB,KACI,KAAK,4BACL,oBAAoB,eAAgB,KAAK,2BAA4B,EAAK,EAE1E,KAAK,uBAAuB,CAC5B,MAAM9xD,EAAI+xD,GAAwB,QAAQ,KAAK,qBAAqB,EAChE/xD,IAAM,IACN+xD,GAAwB,OAAO/xD,EAAG,CAAC,CAE1C,CAGL,KAAK,WAAa,SAElB,KAAK,GAAK,KAEV,KAAK,aAAa,QAASunB,EAAQqpB,CAAW,EAG9C,KAAK,YAAc,GACnB,KAAK,eAAiB,CACzB,CACJ,CACL,CACAohB,GAAqB,SAAWzV,GAwBzB,MAAMiW,WAA0BR,EAAqB,CACxD,aAAc,CACV,MAAM,GAAG,SAAS,EAClB,KAAK,UAAY,EACpB,CACD,QAAS,CAEL,GADA,MAAM,OAAM,EACG,KAAK,aAAhB,QAA8B,KAAK,KAAK,QACxC,QAAShyD,EAAI,EAAGA,EAAI,KAAK,UAAU,OAAQA,IACvC,KAAK,OAAO,KAAK,UAAUA,CAAC,CAAC,CAGxC,CAOD,OAAO8O,EAAM,CACT,IAAIqjD,EAAY,KAAK,gBAAgBrjD,CAAI,EACrC2jD,EAAS,GACbT,GAAqB,sBAAwB,GAC7C,MAAMU,EAAkB,IAAM,CACtBD,IAEJN,EAAU,KAAK,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAS,EAAC,EAChDA,EAAU,KAAK,SAAWlwC,GAAQ,CAC9B,GAAI,CAAAwwC,EAEJ,GAAexwC,EAAI,OAAf,QAAmCA,EAAI,OAAhB,QAAsB,CAG7C,GAFA,KAAK,UAAY,GACjB,KAAK,aAAa,YAAakwC,CAAS,EACpC,CAACA,EACD,OACJH,GAAqB,sBACDG,EAAU,OAA1B,YACJ,KAAK,UAAU,MAAM,IAAM,CACnBM,GAEa,KAAK,aAAlB,WAEJE,IACA,KAAK,aAAaR,CAAS,EAC3BA,EAAU,KAAK,CAAC,CAAE,KAAM,SAAS,CAAE,CAAC,EACpC,KAAK,aAAa,UAAWA,CAAS,EACtCA,EAAY,KACZ,KAAK,UAAY,GACjB,KAAK,MAAK,EAClC,CAAqB,CACJ,KACI,CACD,MAAMtlC,EAAM,IAAI,MAAM,aAAa,EAEnCA,EAAI,UAAYslC,EAAU,KAC1B,KAAK,aAAa,eAAgBtlC,CAAG,CACxC,CACjB,CAAa,EACb,EACQ,SAAS+lC,GAAkB,CACnBH,IAGJA,EAAS,GACTE,IACAR,EAAU,MAAK,EACfA,EAAY,KACf,CAED,MAAMU,EAAWhmC,GAAQ,CACrB,MAAMjuB,EAAQ,IAAI,MAAM,gBAAkBiuB,CAAG,EAE7CjuB,EAAM,UAAYuzD,EAAU,KAC5BS,IACA,KAAK,aAAa,eAAgBh0D,CAAK,CACnD,EACQ,SAASk0D,GAAmB,CACxBD,EAAQ,kBAAkB,CAC7B,CAED,SAASE,GAAU,CACfF,EAAQ,eAAe,CAC1B,CAED,SAASG,EAAUt2D,EAAI,CACfy1D,GAAaz1D,EAAG,OAASy1D,EAAU,MACnCS,GAEP,CAED,MAAMD,EAAU,IAAM,CAClBR,EAAU,eAAe,OAAQO,CAAe,EAChDP,EAAU,eAAe,QAASU,CAAO,EACzCV,EAAU,eAAe,QAASW,CAAgB,EAClD,KAAK,IAAI,QAASC,CAAO,EACzB,KAAK,IAAI,YAAaC,CAAS,CAC3C,EACQb,EAAU,KAAK,OAAQO,CAAe,EACtCP,EAAU,KAAK,QAASU,CAAO,EAC/BV,EAAU,KAAK,QAASW,CAAgB,EACxC,KAAK,KAAK,QAASC,CAAO,EAC1B,KAAK,KAAK,YAAaC,CAAS,EAC5B,KAAK,UAAU,QAAQ,cAAc,IAAM,IAC3ClkD,IAAS,eAET,KAAK,aAAa,IAAM,CACf2jD,GACDN,EAAU,KAAI,CAErB,EAAE,GAAG,EAGNA,EAAU,KAAI,CAErB,CACD,YAAY52C,EAAM,CACd,KAAK,UAAY,KAAK,gBAAgBA,EAAK,QAAQ,EACnD,MAAM,YAAYA,CAAI,CACzB,CAOD,gBAAgB03C,EAAU,CACtB,MAAMC,EAAmB,GACzB,QAASlzD,EAAI,EAAGA,EAAIizD,EAAS,OAAQjzD,IAC7B,CAAC,KAAK,WAAW,QAAQizD,EAASjzD,CAAC,CAAC,GACpCkzD,EAAiB,KAAKD,EAASjzD,CAAC,CAAC,EAEzC,OAAOkzD,CACV,CACL,QAoBO,cAAqBV,EAAkB,CAC1C,YAAYp0B,EAAKzY,EAAO,GAAI,CACxB,MAAMwtC,EAAI,OAAO/0B,GAAQ,SAAWA,EAAMzY,GACtC,CAACwtC,EAAE,YACFA,EAAE,YAAc,OAAOA,EAAE,WAAW,CAAC,GAAM,YAC5CA,EAAE,YAAcA,EAAE,YAAc,CAAC,UAAW,YAAa,cAAc,GAClE,IAAKjB,GAAkBkB,GAAmBlB,CAAa,CAAC,EACxD,OAAQ7N,GAAM,CAAC,CAACA,CAAC,GAE1B,MAAMjmB,EAAK+0B,CAAC,CACf,CACL,EC5sBO,SAASx0D,GAAIy/B,EAAK1gC,EAAO,GAAI21D,EAAK,CACrC,IAAIriD,EAAMotB,EAEVi1B,EAAMA,GAAQ,OAAO,SAAa,KAAe,SACrCj1B,GAAR,OACAA,EAAMi1B,EAAI,SAAW,KAAOA,EAAI,MAEhC,OAAOj1B,GAAQ,WACHA,EAAI,OAAO,CAAC,IAApB,MACYA,EAAI,OAAO,CAAC,IAApB,IACAA,EAAMi1B,EAAI,SAAWj1B,EAGrBA,EAAMi1B,EAAI,KAAOj1B,GAGpB,sBAAsB,KAAKA,CAAG,IACX,OAAOi1B,EAAvB,IACAj1B,EAAMi1B,EAAI,SAAW,KAAOj1B,EAG5BA,EAAM,WAAaA,GAI3BptB,EAAM6wC,GAAMzjB,CAAG,GAGdptB,EAAI,OACD,cAAc,KAAKA,EAAI,QAAQ,EAC/BA,EAAI,KAAO,KAEN,eAAe,KAAKA,EAAI,QAAQ,IACrCA,EAAI,KAAO,QAGnBA,EAAI,KAAOA,EAAI,MAAQ,IAEvB,MAAMsiD,EADOtiD,EAAI,KAAK,QAAQ,GAAG,IAAM,GACnB,IAAMA,EAAI,KAAO,IAAMA,EAAI,KAE/C,OAAAA,EAAI,GAAKA,EAAI,SAAW,MAAQsiD,EAAO,IAAMtiD,EAAI,KAAOtT,EAExDsT,EAAI,KACAA,EAAI,SACA,MACAsiD,GACCD,GAAOA,EAAI,OAASriD,EAAI,KAAO,GAAK,IAAMA,EAAI,MAChDA,CACX,CC1DA,MAAMk6C,GAAwB,OAAO,aAAgB,WAC/CC,GAAUn6C,GACL,OAAO,YAAY,QAAW,WAC/B,YAAY,OAAOA,CAAG,EACtBA,EAAI,kBAAkB,YAE1BuiD,GAAW,OAAO,UAAU,SAC5BtI,GAAiB,OAAO,MAAS,YAClC,OAAO,KAAS,KACbsI,GAAS,KAAK,IAAI,IAAM,2BAC1BC,GAAiB,OAAO,MAAS,YAClC,OAAO,KAAS,KACbD,GAAS,KAAK,IAAI,IAAM,2BAMzB,SAAS5F,GAAS38C,EAAK,CAC1B,OAASk6C,KAA0Bl6C,aAAe,aAAem6C,GAAOn6C,CAAG,IACtEi6C,IAAkBj6C,aAAe,MACjCwiD,IAAkBxiD,aAAe,IAC1C,CACO,SAASyiD,GAAUziD,EAAK0iD,EAAQ,CACnC,GAAI,CAAC1iD,GAAO,OAAOA,GAAQ,SACvB,MAAO,GAEX,GAAI,MAAM,QAAQA,CAAG,EAAG,CACpB,QAAShR,EAAI,EAAG6uD,EAAI79C,EAAI,OAAQhR,EAAI6uD,EAAG7uD,IACnC,GAAIyzD,GAAUziD,EAAIhR,CAAC,CAAC,EAChB,MAAO,GAGf,MAAO,EACV,CACD,GAAI2tD,GAAS38C,CAAG,EACZ,MAAO,GAEX,GAAIA,EAAI,QACJ,OAAOA,EAAI,QAAW,YACtB,UAAU,SAAW,EACrB,OAAOyiD,GAAUziD,EAAI,OAAQ,EAAE,EAAI,EAEvC,UAAWxT,KAAOwT,EACd,GAAI,OAAO,UAAU,eAAe,KAAKA,EAAKxT,CAAG,GAAKi2D,GAAUziD,EAAIxT,CAAG,CAAC,EACpE,MAAO,GAGf,MAAO,EACX,CCzCO,SAASm2D,GAAkBjI,EAAQ,CACtC,MAAMztC,EAAU,GACV21C,EAAalI,EAAO,KACpBmI,EAAOnI,EACb,OAAAmI,EAAK,KAAOC,GAAmBF,EAAY31C,CAAO,EAClD41C,EAAK,YAAc51C,EAAQ,OACpB,CAAE,OAAQ41C,EAAM,QAAS51C,CAAO,CAC3C,CACA,SAAS61C,GAAmBv4C,EAAM0C,EAAS,CACvC,GAAI,CAAC1C,EACD,OAAOA,EACX,GAAIoyC,GAASpyC,CAAI,EAAG,CAChB,MAAMw4C,EAAc,CAAE,aAAc,GAAM,IAAK91C,EAAQ,QACvD,OAAAA,EAAQ,KAAK1C,CAAI,EACVw4C,CACV,SACQ,MAAM,QAAQx4C,CAAI,EAAG,CAC1B,MAAMy4C,EAAU,IAAI,MAAMz4C,EAAK,MAAM,EACrC,QAASvb,EAAI,EAAGA,EAAIub,EAAK,OAAQvb,IAC7Bg0D,EAAQh0D,CAAC,EAAI8zD,GAAmBv4C,EAAKvb,CAAC,EAAGie,CAAO,EAEpD,OAAO+1C,CACV,SACQ,OAAOz4C,GAAS,UAAY,EAAEA,aAAgB,MAAO,CAC1D,MAAMy4C,EAAU,GAChB,UAAWx2D,KAAO+d,EACV,OAAO,UAAU,eAAe,KAAKA,EAAM/d,CAAG,IAC9Cw2D,EAAQx2D,CAAG,EAAIs2D,GAAmBv4C,EAAK/d,CAAG,EAAGygB,CAAO,GAG5D,OAAO+1C,CACV,CACD,OAAOz4C,CACX,CASO,SAAS04C,GAAkBvI,EAAQztC,EAAS,CAC/C,OAAAytC,EAAO,KAAOwI,GAAmBxI,EAAO,KAAMztC,CAAO,EACrD,OAAOytC,EAAO,YACPA,CACX,CACA,SAASwI,GAAmB34C,EAAM0C,EAAS,CACvC,GAAI,CAAC1C,EACD,OAAOA,EACX,GAAIA,GAAQA,EAAK,eAAiB,GAAM,CAIpC,GAHqB,OAAOA,EAAK,KAAQ,UACrCA,EAAK,KAAO,GACZA,EAAK,IAAM0C,EAAQ,OAEnB,OAAOA,EAAQ1C,EAAK,GAAG,EAGvB,MAAM,IAAI,MAAM,qBAAqB,CAE5C,SACQ,MAAM,QAAQA,CAAI,EACvB,QAASvb,EAAI,EAAGA,EAAIub,EAAK,OAAQvb,IAC7Bub,EAAKvb,CAAC,EAAIk0D,GAAmB34C,EAAKvb,CAAC,EAAGie,CAAO,UAG5C,OAAO1C,GAAS,SACrB,UAAW/d,KAAO+d,EACV,OAAO,UAAU,eAAe,KAAKA,EAAM/d,CAAG,IAC9C+d,EAAK/d,CAAG,EAAI02D,GAAmB34C,EAAK/d,CAAG,EAAGygB,CAAO,GAI7D,OAAO1C,CACX,CC5EA,MAAM44C,GAAkB,CACpB,UACA,gBACA,aACA,gBACA,cACA,gBACJ,EAMa5X,GAAW,EACjB,IAAI6X,GACV,SAAUA,EAAY,CACnBA,EAAWA,EAAW,QAAa,CAAC,EAAI,UACxCA,EAAWA,EAAW,WAAgB,CAAC,EAAI,aAC3CA,EAAWA,EAAW,MAAW,CAAC,EAAI,QACtCA,EAAWA,EAAW,IAAS,CAAC,EAAI,MACpCA,EAAWA,EAAW,cAAmB,CAAC,EAAI,gBAC9CA,EAAWA,EAAW,aAAkB,CAAC,EAAI,eAC7CA,EAAWA,EAAW,WAAgB,CAAC,EAAI,YAC/C,GAAGA,IAAeA,EAAa,CAAE,EAAC,EAI3B,MAAMC,EAAQ,CAMjB,YAAYC,EAAU,CAClB,KAAK,SAAWA,CACnB,CAOD,OAAOtjD,EAAK,CACR,OAAIA,EAAI,OAASojD,EAAW,OAASpjD,EAAI,OAASojD,EAAW,MACrDX,GAAUziD,CAAG,EACN,KAAK,eAAe,CACvB,KAAMA,EAAI,OAASojD,EAAW,MACxBA,EAAW,aACXA,EAAW,WACjB,IAAKpjD,EAAI,IACT,KAAMA,EAAI,KACV,GAAIA,EAAI,EAC5B,CAAiB,EAGF,CAAC,KAAK,eAAeA,CAAG,CAAC,CACnC,CAID,eAAeA,EAAK,CAEhB,IAAI0kB,EAAM,GAAK1kB,EAAI,KAEnB,OAAIA,EAAI,OAASojD,EAAW,cACxBpjD,EAAI,OAASojD,EAAW,cACxB1+B,GAAO1kB,EAAI,YAAc,KAIzBA,EAAI,KAAeA,EAAI,MAAZ,MACX0kB,GAAO1kB,EAAI,IAAM,KAGTA,EAAI,IAAZ,OACA0kB,GAAO1kB,EAAI,IAGHA,EAAI,MAAZ,OACA0kB,GAAO,KAAK,UAAU1kB,EAAI,KAAM,KAAK,QAAQ,GAE1C0kB,CACV,CAMD,eAAe1kB,EAAK,CAChB,MAAMujD,EAAiBZ,GAAkB3iD,CAAG,EACtC6iD,EAAO,KAAK,eAAeU,EAAe,MAAM,EAChDt2C,EAAUs2C,EAAe,QAC/B,OAAAt2C,EAAQ,QAAQ41C,CAAI,EACb51C,CACV,CACL,CAEA,SAAS4iB,GAAS/jC,EAAO,CACrB,OAAO,OAAO,UAAU,SAAS,KAAKA,CAAK,IAAM,iBACrD,CAMO,MAAM03D,WAAgB3G,EAAQ,CAMjC,YAAY4G,EAAS,CACjB,QACA,KAAK,QAAUA,CAClB,CAMD,IAAIzjD,EAAK,CACL,IAAI06C,EACJ,GAAI,OAAO16C,GAAQ,SAAU,CACzB,GAAI,KAAK,cACL,MAAM,IAAI,MAAM,iDAAiD,EAErE06C,EAAS,KAAK,aAAa16C,CAAG,EAC9B,MAAM0jD,EAAgBhJ,EAAO,OAAS0I,EAAW,aAC7CM,GAAiBhJ,EAAO,OAAS0I,EAAW,YAC5C1I,EAAO,KAAOgJ,EAAgBN,EAAW,MAAQA,EAAW,IAE5D,KAAK,cAAgB,IAAIO,GAAoBjJ,CAAM,EAE/CA,EAAO,cAAgB,GACvB,MAAM,aAAa,UAAWA,CAAM,GAKxC,MAAM,aAAa,UAAWA,CAAM,CAE3C,SACQiC,GAAS38C,CAAG,GAAKA,EAAI,OAE1B,GAAK,KAAK,cAIN06C,EAAS,KAAK,cAAc,eAAe16C,CAAG,EAC1C06C,IAEA,KAAK,cAAgB,KACrB,MAAM,aAAa,UAAWA,CAAM,OAPxC,OAAM,IAAI,MAAM,kDAAkD,MAYtE,OAAM,IAAI,MAAM,iBAAmB16C,CAAG,CAE7C,CAOD,aAAa0kB,EAAK,CACd,IAAI11B,EAAI,EAER,MAAM6pC,EAAI,CACN,KAAM,OAAOnU,EAAI,OAAO,CAAC,CAAC,CACtC,EACQ,GAAI0+B,EAAWvqB,EAAE,IAAI,IAAM,OACvB,MAAM,IAAI,MAAM,uBAAyBA,EAAE,IAAI,EAGnD,GAAIA,EAAE,OAASuqB,EAAW,cACtBvqB,EAAE,OAASuqB,EAAW,WAAY,CAClC,MAAMQ,EAAQ50D,EAAI,EAClB,KAAO01B,EAAI,OAAO,EAAE11B,CAAC,IAAM,KAAOA,GAAK01B,EAAI,QAAQ,CACnD,MAAMm/B,EAAMn/B,EAAI,UAAUk/B,EAAO50D,CAAC,EAClC,GAAI60D,GAAO,OAAOA,CAAG,GAAKn/B,EAAI,OAAO11B,CAAC,IAAM,IACxC,MAAM,IAAI,MAAM,qBAAqB,EAEzC6pC,EAAE,YAAc,OAAOgrB,CAAG,CAC7B,CAED,GAAYn/B,EAAI,OAAO11B,EAAI,CAAC,IAAxB,IAA2B,CAC3B,MAAM40D,EAAQ50D,EAAI,EAClB,KAAO,EAAEA,GAED,EADM01B,EAAI,OAAO11B,CAAC,IAClB,KAEAA,IAAM01B,EAAI,SAAd,CAGJmU,EAAE,IAAMnU,EAAI,UAAUk/B,EAAO50D,CAAC,CACjC,MAEG6pC,EAAE,IAAM,IAGZ,MAAMuT,EAAO1nB,EAAI,OAAO11B,EAAI,CAAC,EAC7B,GAAWo9C,IAAP,IAAe,OAAOA,CAAI,GAAKA,EAAM,CACrC,MAAMwX,EAAQ50D,EAAI,EAClB,KAAO,EAAEA,GAAG,CACR,MAAMqd,EAAIqY,EAAI,OAAO11B,CAAC,EACtB,GAAYqd,GAAR,MAAa,OAAOA,CAAC,GAAKA,EAAG,CAC7B,EAAErd,EACF,KACH,CACD,GAAIA,IAAM01B,EAAI,OACV,KACP,CACDmU,EAAE,GAAK,OAAOnU,EAAI,UAAUk/B,EAAO50D,EAAI,CAAC,CAAC,CAC5C,CAED,GAAI01B,EAAI,OAAO,EAAE11B,CAAC,EAAG,CACjB,MAAMkiB,EAAU,KAAK,SAASwT,EAAI,OAAO11B,CAAC,CAAC,EAC3C,GAAIw0D,GAAQ,eAAe3qB,EAAE,KAAM3nB,CAAO,EACtC2nB,EAAE,KAAO3nB,MAGT,OAAM,IAAI,MAAM,iBAAiB,CAExC,CACD,OAAO2nB,CACV,CACD,SAASnU,EAAK,CACV,GAAI,CACA,OAAO,KAAK,MAAMA,EAAK,KAAK,OAAO,CACtC,MACS,CACN,MAAO,EACV,CACJ,CACD,OAAO,eAAe3mB,EAAMmT,EAAS,CACjC,OAAQnT,EAAI,CACR,KAAKqlD,EAAW,QACZ,OAAOvzB,GAAS3e,CAAO,EAC3B,KAAKkyC,EAAW,WACZ,OAAOlyC,IAAY,OACvB,KAAKkyC,EAAW,cACZ,OAAO,OAAOlyC,GAAY,UAAY2e,GAAS3e,CAAO,EAC1D,KAAKkyC,EAAW,MAChB,KAAKA,EAAW,aACZ,OAAQ,MAAM,QAAQlyC,CAAO,IACxB,OAAOA,EAAQ,CAAC,GAAM,UAClB,OAAOA,EAAQ,CAAC,GAAM,UACnBiyC,GAAgB,QAAQjyC,EAAQ,CAAC,CAAC,IAAM,IACxD,KAAKkyC,EAAW,IAChB,KAAKA,EAAW,WACZ,OAAO,MAAM,QAAQlyC,CAAO,CACnC,CACJ,CAID,SAAU,CACF,KAAK,gBACL,KAAK,cAAc,yBACnB,KAAK,cAAgB,KAE5B,CACL,CASA,MAAMyyC,EAAoB,CACtB,YAAYjJ,EAAQ,CAChB,KAAK,OAASA,EACd,KAAK,QAAU,GACf,KAAK,UAAYA,CACpB,CASD,eAAeoJ,EAAS,CAEpB,GADA,KAAK,QAAQ,KAAKA,CAAO,EACrB,KAAK,QAAQ,SAAW,KAAK,UAAU,YAAa,CAEpD,MAAMpJ,EAASuI,GAAkB,KAAK,UAAW,KAAK,OAAO,EAC7D,YAAK,uBAAsB,EACpBvI,CACV,CACD,OAAO,IACV,CAID,wBAAyB,CACrB,KAAK,UAAY,KACjB,KAAK,QAAU,EAClB,CACL,kKCtTO,SAASqC,GAAG/8C,EAAK0/C,EAAI1xD,EAAI,CAC5B,OAAAgS,EAAI,GAAG0/C,EAAI1xD,CAAE,EACN,UAAsB,CACzBgS,EAAI,IAAI0/C,EAAI1xD,CAAE,CACtB,CACA,CCEA,MAAMm1D,GAAkB,OAAO,OAAO,CAClC,QAAS,EACT,cAAe,EACf,WAAY,EACZ,cAAe,EAEf,YAAa,EACb,eAAgB,CACpB,CAAC,EAyBM,MAAMY,WAAelH,EAAQ,CAIhC,YAAYmH,EAAIC,EAAKtvC,EAAM,CACvB,QAeA,KAAK,UAAY,GAKjB,KAAK,UAAY,GAIjB,KAAK,cAAgB,GAIrB,KAAK,WAAa,GAOlB,KAAK,OAAS,GAKd,KAAK,UAAY,EACjB,KAAK,IAAM,EAwBX,KAAK,KAAO,GACZ,KAAK,MAAQ,GACb,KAAK,GAAKqvC,EACV,KAAK,IAAMC,EACPtvC,GAAQA,EAAK,OACb,KAAK,KAAOA,EAAK,MAErB,KAAK,MAAQ,OAAO,OAAO,CAAE,EAAEA,CAAI,EAC/B,KAAK,GAAG,cACR,KAAK,KAAI,CAChB,CAeD,IAAI,cAAe,CACf,MAAO,CAAC,KAAK,SAChB,CAMD,WAAY,CACR,GAAI,KAAK,KACL,OACJ,MAAMqvC,EAAK,KAAK,GAChB,KAAK,KAAO,CACRjH,GAAGiH,EAAI,OAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,EACrCjH,GAAGiH,EAAI,SAAU,KAAK,SAAS,KAAK,IAAI,CAAC,EACzCjH,GAAGiH,EAAI,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAC,EACvCjH,GAAGiH,EAAI,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAC,CACnD,CACK,CAkBD,IAAI,QAAS,CACT,MAAO,CAAC,CAAC,KAAK,IACjB,CAWD,SAAU,CACN,OAAI,KAAK,UACE,MACX,KAAK,UAAS,EACT,KAAK,GAAG,eACT,KAAK,GAAG,OACG,KAAK,GAAG,cAAnB,QACA,KAAK,OAAM,EACR,KACV,CAID,MAAO,CACH,OAAO,KAAK,SACf,CAgBD,QAAQl7C,EAAM,CACV,OAAAA,EAAK,QAAQ,SAAS,EACtB,KAAK,KAAK,MAAM,KAAMA,CAAI,EACnB,IACV,CAkBD,KAAK42C,KAAO52C,EAAM,CACd,IAAIa,EAAImB,EAAIK,EACZ,GAAIg4C,GAAgB,eAAezD,CAAE,EACjC,MAAM,IAAI,MAAM,IAAMA,EAAG,SAAQ,EAAK,4BAA4B,EAGtE,GADA52C,EAAK,QAAQ42C,CAAE,EACX,KAAK,MAAM,SAAW,CAAC,KAAK,MAAM,WAAa,CAAC,KAAK,MAAM,SAC3D,YAAK,YAAY52C,CAAI,EACd,KAEX,MAAM4xC,EAAS,CACX,KAAM0I,EAAW,MACjB,KAAMt6C,CAClB,EAIQ,GAHA4xC,EAAO,QAAU,GACjBA,EAAO,QAAQ,SAAW,KAAK,MAAM,WAAa,GAE/B,OAAO5xC,EAAKA,EAAK,OAAS,CAAC,GAA1C,WAA6C,CAC7C,MAAMlO,EAAK,KAAK,MACVspD,EAAMp7C,EAAK,MACjB,KAAK,qBAAqBlO,EAAIspD,CAAG,EACjCxJ,EAAO,GAAK9/C,CACf,CACD,MAAMupD,GAAuBr5C,GAAMnB,EAAK,KAAK,GAAG,UAAY,MAAQA,IAAO,OAAS,OAASA,EAAG,aAAe,MAAQmB,IAAO,OAAS,OAASA,EAAG,SAC7Is5C,EAAc,KAAK,WAAa,EAAG,GAAAj5C,EAAK,KAAK,GAAG,UAAY,MAAQA,IAAO,SAAkBA,EAAG,gBAAe,GAErH,OADsB,KAAK,MAAM,UAAY,CAACg5C,IAGrCC,GACL,KAAK,wBAAwB1J,CAAM,EACnC,KAAK,OAAOA,CAAM,GAGlB,KAAK,WAAW,KAAKA,CAAM,GAE/B,KAAK,MAAQ,GACN,IACV,CAID,qBAAqB9/C,EAAIspD,EAAK,CAC1B,IAAIv6C,EACJ,MAAMK,GAAWL,EAAK,KAAK,MAAM,WAAa,MAAQA,IAAO,OAASA,EAAK,KAAK,MAAM,WACtF,GAAIK,IAAY,OAAW,CACvB,KAAK,KAAKpP,CAAE,EAAIspD,EAChB,MACH,CAED,MAAMlqC,EAAQ,KAAK,GAAG,aAAa,IAAM,CACrC,OAAO,KAAK,KAAKpf,CAAE,EACnB,QAAS5L,EAAI,EAAGA,EAAI,KAAK,WAAW,OAAQA,IACpC,KAAK,WAAWA,CAAC,EAAE,KAAO4L,GAC1B,KAAK,WAAW,OAAO5L,EAAG,CAAC,EAGnCk1D,EAAI,KAAK,KAAM,IAAI,MAAM,yBAAyB,CAAC,CACtD,EAAEl6C,CAAO,EACJhc,EAAK,IAAI8a,IAAS,CAEpB,KAAK,GAAG,eAAekR,CAAK,EAC5BkqC,EAAI,MAAM,KAAMp7C,CAAI,CAChC,EACQ9a,EAAG,UAAY,GACf,KAAK,KAAK4M,CAAE,EAAI5M,CACnB,CAiBD,YAAY0xD,KAAO52C,EAAM,CACrB,OAAO,IAAI,QAAQ,CAAC2O,EAASsE,IAAW,CACpC,MAAM/tB,EAAK,CAACq2D,EAAMC,IACPD,EAAOtoC,EAAOsoC,CAAI,EAAI5sC,EAAQ6sC,CAAI,EAE7Ct2D,EAAG,UAAY,GACf8a,EAAK,KAAK9a,CAAE,EACZ,KAAK,KAAK0xD,EAAI,GAAG52C,CAAI,CACjC,CAAS,CACJ,CAMD,YAAYA,EAAM,CACd,IAAIo7C,EACA,OAAOp7C,EAAKA,EAAK,OAAS,CAAC,GAAM,aACjCo7C,EAAMp7C,EAAK,OAEf,MAAM4xC,EAAS,CACX,GAAI,KAAK,YACT,SAAU,EACV,QAAS,GACT,KAAA5xC,EACA,MAAO,OAAO,OAAO,CAAE,UAAW,EAAM,EAAE,KAAK,KAAK,CAChE,EACQA,EAAK,KAAK,CAAC+S,KAAQ0oC,IACX7J,IAAW,KAAK,OAAO,CAAC,EAExB,QAEa7+B,IAAQ,KAEjB6+B,EAAO,SAAW,KAAK,MAAM,UAC7B,KAAK,OAAO,QACRwJ,GACAA,EAAIroC,CAAG,IAKf,KAAK,OAAO,QACRqoC,GACAA,EAAI,KAAM,GAAGK,CAAY,GAGjC7J,EAAO,QAAU,GACV,KAAK,cACf,EACD,KAAK,OAAO,KAAKA,CAAM,EACvB,KAAK,YAAW,CACnB,CAOD,YAAY8J,EAAQ,GAAO,CACvB,GAAI,CAAC,KAAK,WAAa,KAAK,OAAO,SAAW,EAC1C,OAEJ,MAAM9J,EAAS,KAAK,OAAO,CAAC,EACxBA,EAAO,SAAW,CAAC8J,IAGvB9J,EAAO,QAAU,GACjBA,EAAO,WACP,KAAK,MAAQA,EAAO,MACpB,KAAK,KAAK,MAAM,KAAMA,EAAO,IAAI,EACpC,CAOD,OAAOA,EAAQ,CACXA,EAAO,IAAM,KAAK,IAClB,KAAK,GAAG,QAAQA,CAAM,CACzB,CAMD,QAAS,CACD,OAAO,KAAK,MAAQ,WACpB,KAAK,KAAMnwC,GAAS,CAChB,KAAK,mBAAmBA,CAAI,CAC5C,CAAa,EAGD,KAAK,mBAAmB,KAAK,IAAI,CAExC,CAOD,mBAAmBA,EAAM,CACrB,KAAK,OAAO,CACR,KAAM64C,EAAW,QACjB,KAAM,KAAK,KACL,OAAO,OAAO,CAAE,IAAK,KAAK,KAAM,OAAQ,KAAK,WAAa,EAAE74C,CAAI,EAChEA,CAClB,CAAS,CACJ,CAOD,QAAQsR,EAAK,CACJ,KAAK,WACN,KAAK,aAAa,gBAAiBA,CAAG,CAE7C,CAQD,QAAQtF,EAAQqpB,EAAa,CACzB,KAAK,UAAY,GACjB,OAAO,KAAK,GACZ,KAAK,aAAa,aAAcrpB,EAAQqpB,CAAW,EACnD,KAAK,WAAU,CAClB,CAOD,YAAa,CACT,OAAO,KAAK,KAAK,IAAI,EAAE,QAAShlC,GAAO,CAEnC,GAAI,CADe,KAAK,WAAW,KAAM8/C,GAAW,OAAOA,EAAO,EAAE,IAAM9/C,CAAE,EAC3D,CAEb,MAAMspD,EAAM,KAAK,KAAKtpD,CAAE,EACxB,OAAO,KAAK,KAAKA,CAAE,EACfspD,EAAI,WACJA,EAAI,KAAK,KAAM,IAAI,MAAM,8BAA8B,CAAC,CAE/D,CACb,CAAS,CACJ,CAOD,SAASxJ,EAAQ,CAEb,GADsBA,EAAO,MAAQ,KAAK,IAG1C,OAAQA,EAAO,KAAI,CACf,KAAK0I,EAAW,QACR1I,EAAO,MAAQA,EAAO,KAAK,IAC3B,KAAK,UAAUA,EAAO,KAAK,IAAKA,EAAO,KAAK,GAAG,EAG/C,KAAK,aAAa,gBAAiB,IAAI,MAAM,2LAA2L,CAAC,EAE7O,MACJ,KAAK0I,EAAW,MAChB,KAAKA,EAAW,aACZ,KAAK,QAAQ1I,CAAM,EACnB,MACJ,KAAK0I,EAAW,IAChB,KAAKA,EAAW,WACZ,KAAK,MAAM1I,CAAM,EACjB,MACJ,KAAK0I,EAAW,WACZ,KAAK,aAAY,EACjB,MACJ,KAAKA,EAAW,cACZ,KAAK,QAAO,EACZ,MAAMvnC,EAAM,IAAI,MAAM6+B,EAAO,KAAK,OAAO,EAEzC7+B,EAAI,KAAO6+B,EAAO,KAAK,KACvB,KAAK,aAAa,gBAAiB7+B,CAAG,EACtC,KACP,CACJ,CAOD,QAAQ6+B,EAAQ,CACZ,MAAM5xC,EAAO4xC,EAAO,MAAQ,GAChBA,EAAO,IAAf,MACA5xC,EAAK,KAAK,KAAK,IAAI4xC,EAAO,EAAE,CAAC,EAE7B,KAAK,UACL,KAAK,UAAU5xC,CAAI,EAGnB,KAAK,cAAc,KAAK,OAAO,OAAOA,CAAI,CAAC,CAElD,CACD,UAAUA,EAAM,CACZ,GAAI,KAAK,eAAiB,KAAK,cAAc,OAAQ,CACjD,MAAM+wB,EAAY,KAAK,cAAc,MAAK,EAC1C,UAAW1sC,KAAY0sC,EACnB1sC,EAAS,MAAM,KAAM2b,CAAI,CAEhC,CACD,MAAM,KAAK,MAAM,KAAMA,CAAI,EACvB,KAAK,MAAQA,EAAK,QAAU,OAAOA,EAAKA,EAAK,OAAS,CAAC,GAAM,WAC7D,KAAK,YAAcA,EAAKA,EAAK,OAAS,CAAC,EAE9C,CAMD,IAAIlO,EAAI,CACJ,MAAM6pD,EAAO,KACb,IAAIC,EAAO,GACX,OAAO,YAAa57C,EAAM,CAElB47C,IAEJA,EAAO,GACPD,EAAK,OAAO,CACR,KAAMrB,EAAW,IACjB,GAAIxoD,EACJ,KAAMkO,CACtB,CAAa,EACb,CACK,CAOD,MAAM4xC,EAAQ,CACV,MAAMwJ,EAAM,KAAK,KAAKxJ,EAAO,EAAE,EAC3B,OAAOwJ,GAAQ,aAGnB,OAAO,KAAK,KAAKxJ,EAAO,EAAE,EAEtBwJ,EAAI,WACJxJ,EAAO,KAAK,QAAQ,IAAI,EAG5BwJ,EAAI,MAAM,KAAMxJ,EAAO,IAAI,EAC9B,CAMD,UAAU9/C,EAAI+pD,EAAK,CACf,KAAK,GAAK/pD,EACV,KAAK,UAAY+pD,GAAO,KAAK,OAASA,EACtC,KAAK,KAAOA,EACZ,KAAK,UAAY,GACjB,KAAK,aAAY,EACjB,KAAK,aAAa,SAAS,EAC3B,KAAK,YAAY,EAAI,CACxB,CAMD,cAAe,CACX,KAAK,cAAc,QAAS77C,GAAS,KAAK,UAAUA,CAAI,CAAC,EACzD,KAAK,cAAgB,GACrB,KAAK,WAAW,QAAS4xC,GAAW,CAChC,KAAK,wBAAwBA,CAAM,EACnC,KAAK,OAAOA,CAAM,CAC9B,CAAS,EACD,KAAK,WAAa,EACrB,CAMD,cAAe,CACX,KAAK,QAAO,EACZ,KAAK,QAAQ,sBAAsB,CACtC,CAQD,SAAU,CACF,KAAK,OAEL,KAAK,KAAK,QAASkK,GAAeA,EAAY,GAC9C,KAAK,KAAO,QAEhB,KAAK,GAAG,SAAY,IAAI,CAC3B,CAiBD,YAAa,CACT,OAAI,KAAK,WACL,KAAK,OAAO,CAAE,KAAMxB,EAAW,UAAY,GAG/C,KAAK,QAAO,EACR,KAAK,WAEL,KAAK,QAAQ,sBAAsB,EAEhC,IACV,CAMD,OAAQ,CACJ,OAAO,KAAK,YACf,CAUD,SAASyB,EAAU,CACf,YAAK,MAAM,SAAWA,EACf,IACV,CAUD,IAAI,UAAW,CACX,YAAK,MAAM,SAAW,GACf,IACV,CAcD,QAAQ76C,EAAS,CACb,YAAK,MAAM,QAAUA,EACd,IACV,CAYD,MAAM7c,EAAU,CACZ,YAAK,cAAgB,KAAK,eAAiB,GAC3C,KAAK,cAAc,KAAKA,CAAQ,EACzB,IACV,CAYD,WAAWA,EAAU,CACjB,YAAK,cAAgB,KAAK,eAAiB,GAC3C,KAAK,cAAc,QAAQA,CAAQ,EAC5B,IACV,CAmBD,OAAOA,EAAU,CACb,GAAI,CAAC,KAAK,cACN,OAAO,KAEX,GAAIA,EAAU,CACV,MAAM0sC,EAAY,KAAK,cACvB,QAAS7qC,EAAI,EAAGA,EAAI6qC,EAAU,OAAQ7qC,IAClC,GAAI7B,IAAa0sC,EAAU7qC,CAAC,EACxB,OAAA6qC,EAAU,OAAO7qC,EAAG,CAAC,EACd,IAGlB,MAEG,KAAK,cAAgB,GAEzB,OAAO,IACV,CAKD,cAAe,CACX,OAAO,KAAK,eAAiB,EAChC,CAcD,cAAc7B,EAAU,CACpB,YAAK,sBAAwB,KAAK,uBAAyB,GAC3D,KAAK,sBAAsB,KAAKA,CAAQ,EACjC,IACV,CAcD,mBAAmBA,EAAU,CACzB,YAAK,sBAAwB,KAAK,uBAAyB,GAC3D,KAAK,sBAAsB,QAAQA,CAAQ,EACpC,IACV,CAmBD,eAAeA,EAAU,CACrB,GAAI,CAAC,KAAK,sBACN,OAAO,KAEX,GAAIA,EAAU,CACV,MAAM0sC,EAAY,KAAK,sBACvB,QAAS7qC,EAAI,EAAGA,EAAI6qC,EAAU,OAAQ7qC,IAClC,GAAI7B,IAAa0sC,EAAU7qC,CAAC,EACxB,OAAA6qC,EAAU,OAAO7qC,EAAG,CAAC,EACd,IAGlB,MAEG,KAAK,sBAAwB,GAEjC,OAAO,IACV,CAKD,sBAAuB,CACnB,OAAO,KAAK,uBAAyB,EACxC,CAQD,wBAAwB0rD,EAAQ,CAC5B,GAAI,KAAK,uBAAyB,KAAK,sBAAsB,OAAQ,CACjE,MAAM7gB,EAAY,KAAK,sBAAsB,MAAK,EAClD,UAAW1sC,KAAY0sC,EACnB1sC,EAAS,MAAM,KAAMutD,EAAO,IAAI,CAEvC,CACJ,CACL,CCt2BO,SAASoK,GAAQnwC,EAAM,CAC1BA,EAAOA,GAAQ,GACf,KAAK,GAAKA,EAAK,KAAO,IACtB,KAAK,IAAMA,EAAK,KAAO,IACvB,KAAK,OAASA,EAAK,QAAU,EAC7B,KAAK,OAASA,EAAK,OAAS,GAAKA,EAAK,QAAU,EAAIA,EAAK,OAAS,EAClE,KAAK,SAAW,CACpB,CAOAmwC,GAAQ,UAAU,SAAW,UAAY,CACrC,IAAIC,EAAK,KAAK,GAAK,KAAK,IAAI,KAAK,OAAQ,KAAK,UAAU,EACxD,GAAI,KAAK,OAAQ,CACb,IAAIC,EAAO,KAAK,SACZC,EAAY,KAAK,MAAMD,EAAO,KAAK,OAASD,CAAE,EAClDA,EAAM,KAAK,MAAMC,EAAO,EAAE,EAAI,EAA2BD,EAAKE,EAAtBF,EAAKE,CAChD,CACD,OAAO,KAAK,IAAIF,EAAI,KAAK,GAAG,EAAI,CACpC,EAMAD,GAAQ,UAAU,MAAQ,UAAY,CAClC,KAAK,SAAW,CACpB,EAMAA,GAAQ,UAAU,OAAS,SAAUjhB,EAAK,CACtC,KAAK,GAAKA,CACd,EAMAihB,GAAQ,UAAU,OAAS,SAAUhhB,EAAK,CACtC,KAAK,IAAMA,CACf,EAMAghB,GAAQ,UAAU,UAAY,SAAUI,EAAQ,CAC5C,KAAK,OAASA,CAClB,EC3DO,MAAMC,WAAgBtI,EAAQ,CACjC,YAAYzvB,EAAKzY,EAAM,CACnB,IAAIhL,EACJ,QACA,KAAK,KAAO,GACZ,KAAK,KAAO,GACRyjB,GAAoB,OAAOA,GAApB,WACPzY,EAAOyY,EACPA,EAAM,QAEVzY,EAAOA,GAAQ,GACfA,EAAK,KAAOA,EAAK,MAAQ,aACzB,KAAK,KAAOA,EACZ8oC,GAAsB,KAAM9oC,CAAI,EAChC,KAAK,aAAaA,EAAK,eAAiB,EAAK,EAC7C,KAAK,qBAAqBA,EAAK,sBAAwB,GAAQ,EAC/D,KAAK,kBAAkBA,EAAK,mBAAqB,GAAI,EACrD,KAAK,qBAAqBA,EAAK,sBAAwB,GAAI,EAC3D,KAAK,qBAAqBhL,EAAKgL,EAAK,uBAAyB,MAAQhL,IAAO,OAASA,EAAK,EAAG,EAC7F,KAAK,QAAU,IAAIm7C,GAAQ,CACvB,IAAK,KAAK,kBAAmB,EAC7B,IAAK,KAAK,qBAAsB,EAChC,OAAQ,KAAK,oBAAqB,CAC9C,CAAS,EACD,KAAK,QAAgBnwC,EAAK,SAAb,KAAuB,IAAQA,EAAK,OAAO,EACxD,KAAK,YAAc,SACnB,KAAK,IAAMyY,EACX,MAAMg4B,EAAUzwC,EAAK,QAAU0wC,GAC/B,KAAK,QAAU,IAAID,EAAQ,QAC3B,KAAK,QAAU,IAAIA,EAAQ,QAC3B,KAAK,aAAezwC,EAAK,cAAgB,GACrC,KAAK,cACL,KAAK,KAAI,CAChB,CACD,aAAa/hB,EAAG,CACZ,OAAK,UAAU,QAEf,KAAK,cAAgB,CAAC,CAACA,EAClBA,IACD,KAAK,cAAgB,IAElB,MALI,KAAK,aAMnB,CACD,qBAAqBA,EAAG,CACpB,OAAIA,IAAM,OACC,KAAK,uBAChB,KAAK,sBAAwBA,EACtB,KACV,CACD,kBAAkBA,EAAG,CACjB,IAAI+W,EACJ,OAAI/W,IAAM,OACC,KAAK,oBAChB,KAAK,mBAAqBA,GACzB+W,EAAK,KAAK,WAAa,MAAQA,IAAO,QAAkBA,EAAG,OAAO/W,CAAC,EAC7D,KACV,CACD,oBAAoBA,EAAG,CACnB,IAAI+W,EACJ,OAAI/W,IAAM,OACC,KAAK,sBAChB,KAAK,qBAAuBA,GAC3B+W,EAAK,KAAK,WAAa,MAAQA,IAAO,QAAkBA,EAAG,UAAU/W,CAAC,EAChE,KACV,CACD,qBAAqBA,EAAG,CACpB,IAAI+W,EACJ,OAAI/W,IAAM,OACC,KAAK,uBAChB,KAAK,sBAAwBA,GAC5B+W,EAAK,KAAK,WAAa,MAAQA,IAAO,QAAkBA,EAAG,OAAO/W,CAAC,EAC7D,KACV,CACD,QAAQA,EAAG,CACP,OAAK,UAAU,QAEf,KAAK,SAAWA,EACT,MAFI,KAAK,QAGnB,CAOD,sBAAuB,CAEf,CAAC,KAAK,eACN,KAAK,eACL,KAAK,QAAQ,WAAa,GAE1B,KAAK,UAAS,CAErB,CAQD,KAAK5E,EAAI,CACL,GAAI,CAAC,KAAK,YAAY,QAAQ,MAAM,EAChC,OAAO,KACX,KAAK,OAAS,IAAIs3D,GAAO,KAAK,IAAK,KAAK,IAAI,EAC5C,MAAMjvC,EAAS,KAAK,OACdouC,EAAO,KACb,KAAK,YAAc,UACnB,KAAK,cAAgB,GAErB,MAAMc,EAAiBxI,GAAG1mC,EAAQ,OAAQ,UAAY,CAClDouC,EAAK,OAAM,EACXz2D,GAAMA,EAAE,CACpB,CAAS,EACK0L,EAAWmiB,GAAQ,CACrB,KAAK,QAAO,EACZ,KAAK,YAAc,SACnB,KAAK,aAAa,QAASA,CAAG,EAC1B7tB,EACAA,EAAG6tB,CAAG,EAIN,KAAK,qBAAoB,CAEzC,EAEc2pC,EAAWzI,GAAG1mC,EAAQ,QAAS3c,CAAO,EAC5C,GAAc,KAAK,WAAf,GAAyB,CACzB,MAAMsQ,EAAU,KAAK,SAEfgQ,EAAQ,KAAK,aAAa,IAAM,CAClCurC,IACA7rD,EAAQ,IAAI,MAAM,SAAS,CAAC,EAC5B2c,EAAO,MAAK,CACf,EAAErM,CAAO,EACN,KAAK,KAAK,WACVgQ,EAAM,MAAK,EAEf,KAAK,KAAK,KAAK,IAAM,CACjB,KAAK,eAAeA,CAAK,CACzC,CAAa,CACJ,CACD,YAAK,KAAK,KAAKurC,CAAc,EAC7B,KAAK,KAAK,KAAKC,CAAQ,EAChB,IACV,CAOD,QAAQx3D,EAAI,CACR,OAAO,KAAK,KAAKA,CAAE,CACtB,CAMD,QAAS,CAEL,KAAK,QAAO,EAEZ,KAAK,YAAc,OACnB,KAAK,aAAa,MAAM,EAExB,MAAMqoB,EAAS,KAAK,OACpB,KAAK,KAAK,KAAK0mC,GAAG1mC,EAAQ,OAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,EAAG0mC,GAAG1mC,EAAQ,OAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,EAAG0mC,GAAG1mC,EAAQ,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAC,EAAG0mC,GAAG1mC,EAAQ,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAC,EAEhM0mC,GAAG,KAAK,QAAS,UAAW,KAAK,UAAU,KAAK,IAAI,CAAC,CAAC,CACzD,CAMD,QAAS,CACL,KAAK,aAAa,MAAM,CAC3B,CAMD,OAAOxyC,EAAM,CACT,GAAI,CACA,KAAK,QAAQ,IAAIA,CAAI,CACxB,OACMuM,EAAG,CACN,KAAK,QAAQ,cAAeA,CAAC,CAChC,CACJ,CAMD,UAAU4jC,EAAQ,CAEduC,GAAS,IAAM,CACX,KAAK,aAAa,SAAUvC,CAAM,CAC9C,EAAW,KAAK,YAAY,CACvB,CAMD,QAAQ7+B,EAAK,CACT,KAAK,aAAa,QAASA,CAAG,CACjC,CAOD,OAAOooC,EAAKtvC,EAAM,CACd,IAAI0B,EAAS,KAAK,KAAK4tC,CAAG,EAC1B,OAAK5tC,EAII,KAAK,cAAgB,CAACA,EAAO,QAClCA,EAAO,QAAO,GAJdA,EAAS,IAAI0tC,GAAO,KAAME,EAAKtvC,CAAI,EACnC,KAAK,KAAKsvC,CAAG,EAAI5tC,GAKdA,CACV,CAOD,SAASA,EAAQ,CACb,MAAMovC,EAAO,OAAO,KAAK,KAAK,IAAI,EAClC,UAAWxB,KAAOwB,EAEd,GADe,KAAK,KAAKxB,CAAG,EACjB,OACP,OAGR,KAAK,OAAM,CACd,CAOD,QAAQvJ,EAAQ,CACZ,MAAMmB,EAAiB,KAAK,QAAQ,OAAOnB,CAAM,EACjD,QAAS1rD,EAAI,EAAGA,EAAI6sD,EAAe,OAAQ7sD,IACvC,KAAK,OAAO,MAAM6sD,EAAe7sD,CAAC,EAAG0rD,EAAO,OAAO,CAE1D,CAMD,SAAU,CACN,KAAK,KAAK,QAASkK,GAAeA,EAAY,GAC9C,KAAK,KAAK,OAAS,EACnB,KAAK,QAAQ,SAChB,CAMD,QAAS,CACL,KAAK,cAAgB,GACrB,KAAK,cAAgB,GACrB,KAAK,QAAQ,cAAc,CAC9B,CAMD,YAAa,CACT,OAAO,KAAK,QACf,CAUD,QAAQruC,EAAQqpB,EAAa,CACzB,IAAIj2B,EACJ,KAAK,QAAO,GACXA,EAAK,KAAK,UAAY,MAAQA,IAAO,QAAkBA,EAAG,MAAK,EAChE,KAAK,QAAQ,QACb,KAAK,YAAc,SACnB,KAAK,aAAa,QAAS4M,EAAQqpB,CAAW,EAC1C,KAAK,eAAiB,CAAC,KAAK,eAC5B,KAAK,UAAS,CAErB,CAMD,WAAY,CACR,GAAI,KAAK,eAAiB,KAAK,cAC3B,OAAO,KACX,MAAM6kB,EAAO,KACb,GAAI,KAAK,QAAQ,UAAY,KAAK,sBAC9B,KAAK,QAAQ,QACb,KAAK,aAAa,kBAAkB,EACpC,KAAK,cAAgB,OAEpB,CACD,MAAMrD,EAAQ,KAAK,QAAQ,SAAQ,EACnC,KAAK,cAAgB,GACrB,MAAMpnC,EAAQ,KAAK,aAAa,IAAM,CAC9ByqC,EAAK,gBAET,KAAK,aAAa,oBAAqBA,EAAK,QAAQ,QAAQ,EAExD,CAAAA,EAAK,eAETA,EAAK,KAAM5oC,GAAQ,CACXA,GACA4oC,EAAK,cAAgB,GACrBA,EAAK,UAAS,EACd,KAAK,aAAa,kBAAmB5oC,CAAG,GAGxC4oC,EAAK,YAAW,CAExC,CAAiB,EACJ,EAAErD,CAAK,EACJ,KAAK,KAAK,WACVpnC,EAAM,MAAK,EAEf,KAAK,KAAK,KAAK,IAAM,CACjB,KAAK,eAAeA,CAAK,CACzC,CAAa,CACJ,CACJ,CAMD,aAAc,CACV,MAAMiN,EAAU,KAAK,QAAQ,SAC7B,KAAK,cAAgB,GACrB,KAAK,QAAQ,QACb,KAAK,aAAa,YAAaA,CAAO,CACzC,CACL,CCxWA,MAAMy+B,GAAQ,GACd,SAAS7K,GAAOztB,EAAKzY,EAAM,CACnB,OAAOyY,GAAQ,WACfzY,EAAOyY,EACPA,EAAM,QAEVzY,EAAOA,GAAQ,GACf,MAAM+7B,EAAS/iD,GAAIy/B,EAAKzY,EAAK,MAAQ,YAAY,EAC3Cob,EAAS2gB,EAAO,OAChB91C,EAAK81C,EAAO,GACZhkD,EAAOgkD,EAAO,KACdiV,EAAgBD,GAAM9qD,CAAE,GAAKlO,KAAQg5D,GAAM9qD,CAAE,EAAE,KAC/Cu0C,EAAgBx6B,EAAK,UACvBA,EAAK,sBAAsB,GACjBA,EAAK,YAAf,IACAgxC,EACJ,IAAI3B,EACJ,OAAI7U,EACA6U,EAAK,IAAImB,GAAQp1B,EAAQpb,CAAI,GAGxB+wC,GAAM9qD,CAAE,IACT8qD,GAAM9qD,CAAE,EAAI,IAAIuqD,GAAQp1B,EAAQpb,CAAI,GAExCqvC,EAAK0B,GAAM9qD,CAAE,GAEb81C,EAAO,OAAS,CAAC/7B,EAAK,QACtBA,EAAK,MAAQ+7B,EAAO,UAEjBsT,EAAG,OAAOtT,EAAO,KAAM/7B,CAAI,CACtC,CAGA,OAAO,OAAOkmC,GAAQ,CAClB,QAAAsK,GACA,OAAApB,GACA,GAAIlJ,GACJ,QAASA,EACb,CAAC,ECvCM,MAAM+K,GAAK,CAChB,cAAe,CAACnY,EAAgBoY,IAC9B,CAAC,SAAU,UAAWpY,GAASoY,GAAiB,IAAI,aAAa,EAEnE,eAAgB,CAACpY,EAAgBG,EAAQ,KAAO,CAAC,SAAU,WAAYH,EAAQG,CAAK,EAEpF,cAAgBH,GAAmB,CAAC,iBAAkBA,CAAM,EAE5D,YAAa,CAACnhB,EAAoCK,IAChD,CAAC,eAAgBL,GAAW,MAAOK,CAAO,EAE5C,kBAAoBkhB,GAAyB,CAAC,qBAAsBA,CAAY,EAEhF,WAAaA,GAAyB,CAAC,aAAcA,CAAY,EAEjE,aAAc,CAACvhB,EAAiB5iB,EAAsBZ,IACpD,CAAC,eAAgBwjB,EAAS5iB,EAAcZ,GAAQ,EAAE,EAEpD,gBAAiB,CAAC2kC,EAAgBG,EAAQ,KAAO,CAAC,mBAAoBH,EAAQG,CAAK,EAGnF,gBAAiB,CAACC,EAAsBjgC,EAAek4C,EAAcpzB,IACnE,CAAC,mBAAoBmb,EAAcjgC,EAAOk4C,EAAMpzB,CAAQ,CAC5D,srGCxBMqzB,GAAmBC,GAAY,SAAW,QAInCC,GAAa,CACxB,QAASF,GACT,KAAM,aACN,YAAa,6BAEb,IAAK,CAEH,IAAKza,KAAuB,OAC5B,QAAS,KACT,QAAS,CACX,EAEA,SAAU,CACR,IAAKb,EACP,EAEA,SAAU,CACR,gBAAiB,GACjB,iBAAkB,GAClB,kBAAmB,GACnB,iBAAkB,EACpB,EAEA,OAAQ,CACN,eAAgB,IAChB,eAAgB,EAChB,qBAAsB,IACtB,iBAAkB,GACpB,EAEA,GAAI,CACF,MAAO,CACL,aAAc,UACd,YAAa,CACX,MAAO,CACL,GAAI,UACJ,IAAK,UACL,IAAK,UACL,IAAK,SACP,CACF,CACF,EACA,WAAY,CACV,SAAU,CACR,KAAM,IACN,OAAQ,IACR,KAAM,GACR,CACF,CACF,CACF,EAGaqB,GAAgB,IAAM1B,GACtB2B,GAAe,IAAM1B,GAGrBuB,GAAY,IAAMqa,GAAW,IAAI,IACjCC,GAAiB,IAAMD,GAAW,SAAS,IAG3CE,GAAa,IAAMF,GAAW,QAC9BG,GAAiB,IAAM,GAAGH,GAAW,IAAI,KAAKA,GAAW,OAAO,GAGhEI,GAAoBC,GACxBL,GAAW,SAASK,CAAO,6OCtD9BC,GAAsC,CAC1C,WAAY,EACZ,aAAc,IACd,SAAU,IACV,cAAe,CACjB,EAKM3/B,GAASm+B,GACb,IAAI,QAAmBttC,GAAA,WAAWA,EAASstC,CAAE,CAAC,EAK1CyB,GAAc,CAAC54D,EAAY64D,EAAuBC,IAClDD,GAAiBC,EAAmB,GAGpC,GAAA94D,EAAM,OAAS,aAAeA,EAAM,QAAQ,SAAS,iBAAiB,GAKtEA,EAAM,OAAS,aAAeA,EAAM,QAAU,KAK9CA,EAAM,OAAS,cAAgBA,EAAM,OAAS,gBAU9C+4D,GAAiB,CAACF,EAAuBx7D,IAAkC,CACzE,MAAAm2D,EAAQn2D,EAAQ,aAAgB,KAAK,IAAIA,EAAQ,cAAgBw7D,EAAgB,CAAC,EACxF,OAAO,KAAK,IAAIrF,EAAOn2D,EAAQ,QAAS,CAC1C,EAKa27D,GAAiB,MAC5Bj5D,EACA1C,EAAwB,KACF,CAChB,MACJ,QAAA+e,EAAU,KACV,aAAA68C,EAAeN,GACf,GAAGO,CACD,EAAA77D,EAEE87D,EAAc,CAAE,GAAGR,GAAuB,GAAGM,CAAa,EAC5D,IAAAG,EAEJ,QAAS//B,EAAU,EAAGA,GAAW8/B,EAAY,WAAc,EAAG9/B,IACxD,IAII,MAAArP,EAAa,IAAI,gBACjBhO,EAAY,WAAW,IAAMgO,EAAW,QAAS5N,CAAO,EAExDvM,EAAS,OAAOqpD,EAAa,QAAU,KAAK,EAAE,cAC9CG,EAAYxpD,IAAW,OAASA,IAAW,OAI3C4L,EAAkC,CACtC,OAAQ,mBACR,GAAIy9C,EAAa,SAGbI,EAAU,OAAOJ,EAAa,KAAS,KAAeA,EAAa,OAAS,KAC9E,CAACG,GAAaC,GAAW,EAAE,iBAAkB79C,IAAY,EAAE,iBAAkBA,KAC/EA,EAAQ,cAAc,EAAI,oBAGtB,MAAAc,EAAW,MAAM,MAAMxc,EAAK,CAChC,GAAGm5D,EACH,OAAQlvC,EAAW,OACnB,QAAAvO,CAAA,CACD,EAKG,GAHJ,aAAaO,CAAS,EAGlB,CAACO,EAAS,GAAI,CACV,MAAAvc,EAAQ,IAAI,MAAM,uBAAuBuc,EAAS,MAAM,IAAIA,EAAS,UAAU,EAAE,EACtF,MAAAvc,EAAc,KAAO,YACrBA,EAAc,OAASuc,EAAS,OAChCvc,EAAc,SAAWuc,EACpBvc,CACR,CAGO,OAAAuc,QAEAvc,EAAY,CAKnB,GAJYo5D,EAAAp5D,EAIR44D,GAAY54D,EAAOq5B,EAAS8/B,EAAY,UAAW,EAAG,CAClD,MAAA3F,EAAQuF,GAAe1/B,EAAS8/B,CAAW,EAEjD,MAAMngC,GAAMw6B,CAAK,EACjB,QACF,CAGA,KACF,CAII,MAAA4F,CACR,EAKaG,GAAY,CACvB,IAAK,MAAOp0B,EAAkB9nC,EAAwB,KAAO,CAC3D,MAAM0C,EAAM,GAAGi+C,GAAW,IAAG7Y,CAAQ,GAKrC,OAJiB,MAAM6zB,GAAej5D,EAAK,CACzC,OAAQ,MACR,GAAG1C,CAAA,CACJ,GACe,MAClB,EAEA,KAAM,MAAO8nC,EAAkBxoB,EAAYtf,EAAwB,KAAO,CACxE,MAAM0C,EAAM,GAAGi+C,GAAW,IAAG7Y,CAAQ,GAMrC,OALiB,MAAM6zB,GAAej5D,EAAK,CACzC,OAAQ,OACR,KAAM4c,EAAO,KAAK,UAAUA,CAAI,EAAI,OACpC,GAAGtf,CAAA,CACJ,GACe,MAClB,EAEA,IAAK,MAAO8nC,EAAkBxoB,EAAYtf,EAAwB,KAAO,CACvE,MAAM0C,EAAM,GAAGi+C,GAAW,IAAG7Y,CAAQ,GAMrC,OALiB,MAAM6zB,GAAej5D,EAAK,CACzC,OAAQ,MACR,KAAM4c,EAAO,KAAK,UAAUA,CAAI,EAAI,OACpC,GAAGtf,CAAA,CACJ,GACe,MAClB,EAEA,OAAQ,MAAO8nC,EAAkB9nC,EAAwB,KAAO,CAC9D,MAAM0C,EAAM,GAAGi+C,GAAW,IAAG7Y,CAAQ,GAKrC,OAJiB,MAAM6zB,GAAej5D,EAAK,CACzC,OAAQ,SACR,GAAG1C,CAAA,CACJ,GACe,MAClB,CACF,ECrLMm8D,GAAe,GAWRC,GAAsBrZ,GAAyB,EAC1D6E,GACE,CAACxyC,EAAK6O,KAAS,CAEb,KAA8B,SAC9B,cAAek4C,GACf,cAAe,GACf,QAAU9nD,GAAS,CACjB,MAAM/S,EAAQ2iB,IAEV,GAAA5P,IAAS,QAAU,CAAC8nD,GAAc,CAChC/mD,EAAA,CAAE,KAAM,SAAU,EACtB,MACF,CACA,GAAIf,IAAS,QAAU,CAAC/S,EAAM,cAAe,CAE3C8T,EAAI,CAAE,KAA8B,SAAU,EAC9C,MACF,CACIA,EAAA,CAAE,KAAAf,EAAM,CACd,EACA,eAAiBgwC,GAAY,CACvBjvC,EAAA,CAAE,cAAeivC,CAAA,CAAS,EAE9B,MAAM/iD,EAAQ2iB,IACV,CAACogC,GAAW/iD,EAAM,OAAS,QAC7B8T,EAAI,CAAE,KAA8B,SAAU,CAElD,IAEF,CACE,KAAM,kBACN,QAAS,EACT,WAAa,IAAO,CAAE,KAAM,EAAE,IAAK,GAEnC,mBAAoB,IAAO9T,GAAU,CAC9BA,GACgBA,EAAM,OAAS,QAClCA,EAAM,QAAQ,QAAQ,CAG1B,CACF,CACF,CACF,ECpDA,SAAS+6D,GAAc7Z,EAA4BI,EAAsB0Z,EAAkBtZ,EAAgB,CAClG,aAAOR,GAAU,MAAM,IAAII,CAAY,IAAI0Z,CAAQ,IAAItZ,CAAM,EACtE,CAEA,SAASuZ,GAAqBC,EAAsBC,EAAQ,EAAI,GAAK,IAAc,CAC7E,IACI,MAAAC,EAAM,eAAe,QAAQF,CAAY,EACzCzyB,EAAM,KAAK,MACjB,GAAI2yB,EAAK,CACD,MAAAjX,EAAS,KAAK,MAAMiX,CAAG,EAC7B,GAAIjX,GAAUA,EAAO,IAAM1b,EAAM0b,EAAO,GAAKgX,EAC3C,OAAOhX,EAAO,EAElB,CACM,MAAA91C,EAAM,OAAO,OAAW,KAAe,eAAgB,OACxD,OAAe,aAChB,GAAGo6B,CAAG,IAAI,KAAK,SAAS,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC,GAClC,8BAAQyyB,EAAc,KAAK,UAAU,CAAE,GAAA7sD,EAAI,GAAIo6B,CAAK,EAAC,EAC7Dp6B,CAAA,MACD,CAEN,MAAO,GAAG,KAAK,IAAI,CAAC,IAAI,KAAK,SAAS,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC,EAC7D,CACF,CA2HA,MAAMgtD,GAA4B,CAAChnB,EAAqB,KAAyB,CAC/E,MAAMinB,EAAcjnB,EAAO,aAAeA,EAAO,cAAgB,EAC3DknB,EAAclnB,EAAO,aAAeA,EAAO,cAAgBA,EAAO,MAAQ,EAEzE,OACL,GAAIA,EAAO,IAAM,GACjB,cAAeA,EAAO,eAAiBA,EAAO,cAAgB,GAC9D,MAAOA,EAAO,OAASA,EAAO,MAAQ,SACtC,aAAcA,EAAO,cAAgBinB,EACrC,aAAcjnB,EAAO,cAAgBknB,EACrC,WAAYlnB,EAAO,YAAcA,EAAO,OAAS,EACjD,YAAAinB,EACA,YAAAC,CAAA,CAEJ,EAEMC,GAAsB,CAACC,EAA6B,KAAmB,CACrE,MAAA/8D,EAAU,MAAM,QAAQ+8D,EAAW,OAAO,EAC5CA,EAAW,QAAQ,IAAIJ,EAAyB,EAChD,GAEEK,EAAYD,EAAW,YAAcA,EAAW,WAAaA,EAAW,WAAa,EACrFE,EAAWF,EAAW,WAAaA,EAAW,UAAYA,EAAW,eAAiB,EACtFG,EAAgBH,EAAW,gBAAkBA,EAAW,eAAiBA,EAAW,SACpFI,EAAmBJ,EAAW,mBAAqBA,EAAW,kBAAoB,SAClFK,EACJL,EAAW,mBACXA,EAAW,kBACXA,EAAW,cACX,EACIM,EACJN,EAAW,aACXA,EAAW,YACV,MAAM,QAASA,EAAmB,KAAK,EAAKA,EAAmB,MAAM,OAAS,OAAQA,EAAmB,OAAS,CAAC,GAChHO,EACJP,EAAW,gBACXA,EAAW,eACV,MAAM,QAASA,EAAmB,QAAQ,EACtCA,EAAmB,SAAS,OAC7B,OAAQA,EAAmB,UAAY,CAAC,GAEvC,OACL,GAAGA,EACH,QAAA/8D,EACA,WAAY+8D,EAAW,YAAcC,EACrC,UAAAA,EACA,UAAWD,EAAW,WAAaE,EACnC,SAAAA,EACA,eAAgBF,EAAW,gBAAkBG,EAC7C,cAAAA,EACA,kBAAmBH,EAAW,mBAAqBI,EACnD,iBAAAA,EACA,kBAAmBJ,EAAW,mBAAqBK,EACnD,iBAAAA,EACA,YAAaL,EAAW,aAAeM,EACvC,UAAAA,EACA,eAAgBN,EAAW,gBAAkBO,EAC7C,aAAAA,CAAA,CAEJ,EAEMC,GAAuB,CAACtsB,EAA0B,KACtDA,EAAM,IAAI6rB,EAAmB,EA4EzBhY,GAAgC,CACpC,YAAa,CAAC,EACd,oBAAqB,CAAC,EACtB,gBAAiB,CAAC,EAClB,mBAAoB,CAAC,EACrB,qBAAsB,CAAC,EACvB,sBAAuB,CAAC,EACxB,uBAAwB,CAAC,EACzB,QAAS,GACT,YAAa,GACb,MAAO,KACP,YAAa,GACb,cAAe,EACf,cAAe,KACf,aAAc,GACd,WAAY,CACV,KAAM,EACN,MAAO,GACP,MAAO,EACP,QAAS,GACT,QAAS,EACX,EACA,QAAS,CACP,SAAU,MACV,OAAQ,EACV,EACA,aAAc,CAAC,CACjB,EAEa0Y,GAAqBza,GAA4C,CAAC3tC,EAAK6O,KAAS,CAC3F,GAAG6gC,GAEH,iBAAkB,MAAOt9C,EAAS,KAAO,CACjC,MACJ,KAAA0M,EAAO,EACP,SAAAupD,EAAWx5C,IAAM,QAAQ,SACzB,OAAA5jB,EAAS4jB,IAAM,QAAQ,OACvB,OAAAy5C,EAAS,EACP,EAAAl2D,EAEEm2D,EAAc,KAAK,MACnB,CAAE,cAAAC,EAAe,YAAaC,GAAuB55C,EAAI,EAG3D,IAACy5C,GAAUxpD,IAAS,GAAKypD,EAAcC,EAAgB,KAASC,EAAmB,OAAS,EAE9F,OAGI,MAAAC,EAAgBJ,GAAUxpD,EAAO,EACnCkB,EAAA,CACF,CAAC0oD,EAAgB,cAAgB,SAAS,EAAG,GAC7C,MAAO,KACR,EAEG,IAGI,MAAArpC,EAAc,IAAI,gBAAgB,CACtC,KAAMvgB,EAAK,SAAS,EACpB,MAAO,KACP,GAAIupD,IAAa,OAAS,CAAE,SAAAA,CAAS,EACrC,GAAIp9D,EAAO,KAAK,GAAK,CAAE,OAAQA,EAAO,MAAO,EAC9C,EAEKif,EAAO,MAAM48C,GAAU,IAAI,uBAAuBznC,CAAW,GAAI,CACrE,QAAS,IACT,aAAc,CAAE,WAAY,CAAE,EAC/B,EAEKspC,EAAiBR,GAAqBj+C,EAAK,MAAQ,CAAE,GACrD2gB,EAAa3gB,EAAK,YAAc,GAItClK,EAAc9T,IAAA,CACZ,YAAao8D,EAAS,CAAC,GAAGp8D,EAAM,YAAa,GAAGy8D,CAAc,EAAIA,EAClE,QAAS,GACT,YAAa,GACb,MAAO,KACP,YAAa,GACb,cAAeJ,EACf,WAAY,CACV,KAAM19B,EAAW,MAAQ/rB,EACzB,MAAO+rB,EAAW,OAAS,GAC3B,MAAOA,EAAW,OAAS,EAC3B,QAASA,EAAW,SAAW,GAC/B,QAASA,EAAW,SAAW,EACjC,EACA,QAAS,CAAE,SAAAw9B,EAAU,OAAAp9D,CAAO,CAC5B,UAEKsC,EAAO,CAEVyS,EAAA,CACF,QAAS,GACT,YAAa,GACb,MAAOzS,aAAiB,MAAQA,EAAM,QAAU,8BAEjD,CACH,CACF,EAGA,oBAAqB,SAAY,CAC/B,KAAM,CAAE,WAAAs9B,EAAY,YAAA+9B,CAAY,EAAI/5C,EAAI,EAEpC+5C,GAAe,CAAC/9B,EAAW,SAMzB,MAAAhc,IAAM,iBAAiB,CAC3B,KAAMgc,EAAW,KAAO,EACxB,OAAQ,GACT,CACH,EAGA,WAAag+B,GAAe,CAE1B,MAAMC,EAAiB,CAAE,GADFj6C,EAAM,UACe,GAAGg6C,CAAW,EAI1D7oD,EAAc9T,IAAA,CACZ,QAAS48D,EACT,WAAY,CAAE,GAAG58D,EAAM,WAAY,KAAM,CAAE,EAC3C,YAAa,CAAC,CACd,IAGF2iB,EAAA,EAAM,iBAAiB,CACrB,SAAUi6C,EAAe,SACzB,OAAQA,EAAe,OACxB,CACH,EAGA,gBAAiB,IAAM,CAErB9oD,EAAc9T,IAAA,CACZ,WAAY,CAAE,GAAGwjD,GAAa,UAAW,EACzC,QAAS,CAAE,GAAGA,GAAa,OAAQ,EACnC,YAAa,CAAC,CACd,GACJ,EAGA,mBAAoB,MAAOyU,EAAQ,KAAU,CACrC,MAAE,cAAAqE,GAAkB35C,IACpB05C,EAAc,KAAK,MAGzB,GAAI,GAACpE,GAASoE,EAAcC,EAAgB,KAM5C,CAAAxoD,EAAc9T,IAAA,CACZ,cAAe,EACf,WAAY,CAAE,GAAGA,EAAM,WAAY,KAAM,CAAE,EAC3C,YAAa,CAAC,CACd,IAEE,IACI,MAAA2iB,EAAA,EAAM,yBAELthB,EAAO,CAER,MAAAA,CACR,EACF,EAEA,yBAA0B,SAAY,CAChCyS,EAAA,CAAE,QAAS,GAAM,EAEjB,IACF,MAAM8J,EAAW,MAAM,MAAM,GAAGyhC,GAAW,+BAA8B,EAErE,IAACzhC,EAAS,GACZ,MAAM,IAAI,MAAM,yCAAyCA,EAAS,UAAU,EAAE,EAG1E,MAAAI,EAAO,MAAMJ,EAAS,OACtBi/C,EAAsBZ,GAAqBj+C,EAAK,MAAQ,CAAE,GAE5DlK,EAAA,CACF,oBAAA+oD,EACA,QAAS,GACT,MAAO,KACR,QAIMx7D,EAAO,CAERyS,EAAA,CACF,QAAS,GACX,MAAOzS,aAAiB,MAAQA,EAAM,QAAU,uCACjD,CACH,CACF,EAEA,qBAAsB,MAAO6/C,GAAmB,CAC1CptC,EAAA,CAAE,QAAS,GAAM,EAEjB,IACI,MAAA8J,EAAW,MAAM,MAAM,GAAGyhC,IAAW,4BAA4B6B,CAAM,EAAE,EAE3E,IAACtjC,EAAS,GACZ,MAAM,IAAI,MAAM,qCAAqCA,EAAS,UAAU,EAAE,EAGtE,MAAAI,EAAO,MAAMJ,EAAS,OACtBk/C,EAAkBb,GAAqBj+C,EAAK,MAAQ,CAAE,GAExDlK,EAAA,CACF,gBAAAgpD,EACA,QAAS,GACT,MAAO,KACR,QAEMz7D,EAAO,CAEVyS,EAAA,CACF,QAAS,GACT,MAAOzS,aAAiB,MAAQA,EAAM,QAAU,mCACjD,CACH,CACF,EAEA,wBAAyB,MAAO6/C,GAAmB,CAC7CptC,EAAA,CAAE,QAAS,GAAM,EAEjB,IACI,MAAA8J,EAAW,MAAM,MAAM,GAAGyhC,IAAW,+BAA+B6B,CAAM,EAAE,EAE9E,IAACtjC,EAAS,GACZ,MAAM,IAAI,MAAM,wCAAwCA,EAAS,UAAU,EAAE,EAGzE,MAAAI,EAAO,MAAMJ,EAAS,OACtBm/C,EAAqBd,GAAqBj+C,EAAK,MAAQ,CAAE,GAE3DlK,EAAA,CACF,mBAAAipD,EACA,QAAS,GACT,MAAO,KACR,QAEM17D,EAAO,CAEVyS,EAAA,CACF,QAAS,GACT,MAAOzS,aAAiB,MAAQA,EAAM,QAAU,sCACjD,CACH,CACF,EAEA,oBAAqB,MAAOgN,GAAe,CACrC,IAEI,MAAE,YAAA2uD,GAAgBr6C,IAClB8gB,EAAWu5B,EAAY,QAAU1wB,EAAE,KAAOj+B,CAAE,GAAK,KAEjDuP,EAAW,MAAM,MAAM,GAAGyhC,IAAW,uBAAuBhxC,CAAE,EAAE,EAElE,IAACuP,EAAS,GAER,OAAAA,EAAS,OAKN6lB,EAGH,MAAAzlB,EAAO,MAAMJ,EAAS,OACtBq/C,EAAkBzB,GAAoBx9C,EAAK,IAAI,EAErD,OAAKi/C,GAOLnpD,EAAa9T,GAAA,CACL,MAAAk9D,EAASC,GACbA,EAAK,KAAO9uD,EAAK,CAAE,GAAG8uD,EAAM,GAAGF,CAAA,EAAoBE,EAO9C,OACL,aAN4BC,GAC5BA,EAAK,QAAaD,EAAK,KAAO9uD,CAAE,EAC5B+uD,EAAK,IAAIF,CAAK,EACd,CAAC,GAAGE,EAAMH,CAAe,GAGKj9D,EAAM,WAAW,EACnD,gBAAiBA,EAAM,gBAAgB,IAAIk9D,CAAK,EAChD,mBAAoBl9D,EAAM,mBAAmB,IAAIk9D,CAAK,EACtD,uBAAwBl9D,EAAM,uBAAuB,IAAIk9D,CAAK,EAC9D,oBAAqBl9D,EAAM,oBAAoB,IAAIk9D,CAAK,EACxD,qBAAsBl9D,EAAM,qBAAqB,IAAIk9D,CAAK,EAC5D,CACD,EAEMD,GAzBEx5B,OA0BK,CAGR,MAAE,YAAAu5B,GAAgBr6C,IACxB,OAAOq6C,EAAY,KAAK1wB,GAAKA,EAAE,KAAOj+B,CAAE,GAAK,IAC/C,CACF,EAEA,iBAAkB,MAAO4yC,GAAwB,CAC/CntC,EAAI,CAAE,QAAS,GAAM,MAAO,IAAM,GAE9B,IACF,MAAM8J,EAAW,MAAM,MAAM,GAAGyhC,GAAA,CAAW,sBAAuB,CAChE,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU4B,CAAc,EACpC,EAEG,IAACrjC,EAAS,GACZ,MAAM,IAAI,MAAM,gCAAgCA,EAAS,UAAU,EAAE,EAGjE,MAAAI,EAAO,MAAMJ,EAAS,OAExB,IAACI,EAAK,KACF,UAAI,MAAM,+CAA+C,EAG3D,MAAAq/C,EAAgB7B,GAAoBx9C,EAAK,IAAI,EAGnD,GAAI,CAACq/C,GAAiB,CAACA,EAAc,GAC7B,UAAI,MAAM,kDAAkD,EAIpEvpD,EAAc9T,IAAA,CACZ,YAAa,CAACq9D,EAAe,GAAGr9D,EAAM,WAAW,EACjD,QAAS,GACT,MAAO,IACP,IAGF,WAAW,IAAM,CACf2iB,EAAA,EAAM,oBACL,GAAG,EAGN7O,EAAc9T,IAAA,CACZ,uBAAwB,CAACq9D,EAAe,GAAGr9D,EAAM,sBAAsB,CACvE,IAGE,IACF,KAAM,CAAE,KAAA68B,CAAA,EAASisB,EAAa,SAAS,EACnCjsB,GAAM,IAER,WAAW,IAAM,CACXla,IAAE,4BAA4Bka,EAAK,EAAE,GACxC,GAAI,OAEG,CAEd,CAGO,OAAAwgC,QAEAh8D,EAAO,CAEV,MAAAyS,EAAA,CACF,QAAS,GACT,MAAOzS,aAAiB,MAAQA,EAAM,QAAU,8BACjD,EACKA,CACR,CACF,EAEA,gBAAiB,MAAOigD,EAAsB0Z,EAAkBtZ,EAAgBR,EAAiBoY,IAAkC,CACjIxlD,EAAI,CAAE,QAAS,GAAM,MAAO,IAAM,GAE9B,IAKI,MAAAwpD,EAAUxC,GAAoB,WAC9ByC,EAAeD,EAAQ,KACvBE,EAAeD,IAAiB,SAMtC,GALmBA,IAAiB,QAAUD,EAAQ,cAKtC,CAGd,MAAMpC,EAAeH,GAAc7Z,EAAQI,EAAc0Z,EAAUtZ,CAAM,EAErE,IADa/+B,IAAM,cAAgB,IAC1Bu4C,CAAY,EAAG,CAEtBpnD,EAAA,CAAE,QAAS,GAAO,EACtB,MACF,CACAA,EAAc9T,IAAA,CAAE,aAAc,CAAE,GAAIA,EAAM,cAAgB,GAAK,CAACk7D,CAAY,EAAG,KAAS,EAClF,MAAAx6B,EAAYu6B,GAAqBC,CAAY,EAE7Ct9C,EAAW,MAAM,MAAM,GAAGyhC,IAAW,oBAAoBiC,CAAY,aAAc,CACvF,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,UAAU,CACnB,SAAA0Z,EACA,UAAWtZ,EACX,OAAAR,EACA,YAAa,OACb,UAAAxgB,CAAA,CACD,EACF,EAEG,IAAC9iB,EAAS,GAAI,CACV,MAAA6/C,EAAY,MAAM7/C,EAAS,OAAO,MAAM,KAAO,CAAG,IACpD,MAAA6/C,EAAU,QAAU,qBAChB,IAAI,MAAM,oBAAoB,EAElCA,EAAU,QAAU,gBAChB,IAAI,MAAM,eAAe,EAE7BA,EAAU,QAAU,mBAChB,IAAI,MAAM,6DAA6D,EAEzE,IAAI,MAAMA,EAAU,SAAW,wCAAwC,CAC/E,CAEM,MAAAz5D,EAAS,MAAM4Z,EAAS,OAGxB8/C,EAAoB15D,GAAQ,MAAM,WAClC25D,EAAW35D,GAAQ,MAAM,MAE/B,OAAA8P,EAAa9T,GAAA,CACL,MAAA49D,EAAmBT,GACnB,CAACA,GAAQA,EAAK,KAAO7b,EAAqB6b,EACvCO,EAAoB,CAAE,GAAGP,EAAM,GAAGO,GAAsBP,EAG1D,OACL,YAAan9D,EAAM,YAAY,IAAI49D,CAAe,EAClD,gBAAiB59D,EAAM,gBAAgB,IAAI49D,CAAe,EAC1D,mBAAoB59D,EAAM,mBAAmB,IAAI49D,CAAe,EAChE,uBAAwB59D,EAAM,uBAAuB,IAAI49D,CAAe,EACxE,sBAAuBD,EACnB,CACE,GAAG39D,EAAM,sBAAsB,UAAgB4V,EAAM,KAAO+nD,EAAS,EAAE,EACvEA,GAEF39D,EAAM,sBACV,QAAS,GACT,MAAO,KACT,CACD,EAGD8T,EAAa9T,GAAA,CACX,MAAM6/C,EAAO,CAAE,GAAI7/C,EAAM,cAAgB,CAAI,GAC7C,cAAO6/C,EAAKqb,CAAY,EACjB,CAAE,aAAcrb,EAAK,CAC7B,EAEM77C,CACT,CAGA,GAAIw5D,EAAc,CAIhB,MAAMtC,EAAeH,GAAc7Z,EAAQI,EAAc0Z,EAAUtZ,CAAM,EAErE,IADa/+B,IAAM,cAAgB,IAC1Bu4C,CAAY,EAAG,CAEtBpnD,EAAA,CAAE,QAAS,GAAO,EACtB,MACF,CAEAA,EAAc9T,IAAA,CAAE,aAAc,CAAE,GAAIA,EAAM,cAAgB,GAAK,CAACk7D,CAAY,EAAG,KAAS,EAClF,MAAAx6B,EAAYu6B,GAAqBC,CAAY,EAE7Ct9C,EAAW,MAAM,MAAM,GAAGyhC,IAAW,oBAAoBiC,CAAY,aAAc,CACvF,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAA0Z,EACA,UAAWtZ,EACX,OAAAR,EACA,cAAeoY,GAAiB,OAChC,UAAA54B,CAAA,CACD,EACF,EAEG,IAAC9iB,EAAS,GAAI,CACV,MAAA6/C,EAAY,MAAM7/C,EAAS,OAAO,MAAM,KAAO,CAAG,IAGpD,MAAA6/C,EAAU,QAAU,sBAChB,IAAI,MAAM,qBAAqB,EAGnCA,EAAU,QAAU,mBAChB,IAAI,MAAM,6DAA6D,EAGzE,IAAI,MAAMA,EAAU,SAAW,wCAAwC,CAC/E,CAEM,MAAAz5D,EAAS,MAAM4Z,EAAS,OAGxB8/C,EAAoB15D,GAAQ,MAAM,WAClC25D,EAAW35D,GAAQ,MAAM,MAE/B8P,EAAa9T,GAAA,CACL,MAAA49D,EAAmBT,GACnB,CAACA,GAAQA,EAAK,KAAO7b,EAAqB6b,EACvCO,EACH,CAAE,GAAGP,EAAM,GAAGO,GACd,CACE,GAAGP,EACH,YAAaA,EAAK,YAAc,GAAKzb,EACrC,mBAAoByb,EAAK,mBAAqB,GAAK,GAIpD,OACL,YAAan9D,EAAM,YAAY,IAAI49D,CAAe,EAClD,gBAAiB59D,EAAM,gBAAgB,IAAI49D,CAAe,EAC1D,mBAAoB59D,EAAM,mBAAmB,IAAI49D,CAAe,EAChE,uBAAwB59D,EAAM,uBAAuB,IAAI49D,CAAe,EACxE,sBAAuBD,EACnB,CACE,GAAG39D,EAAM,sBAAsB,UAAgB4V,EAAM,KAAO+nD,EAAS,EAAE,EACvEA,GAEF39D,EAAM,sBACV,QAAS,GACT,MAAO,KACT,CACD,EAGG,IACF,KAAM,CAAE,KAAA68B,CAAA,EAASisB,EAAa,SAAS,EACnCjsB,GAAM,IACR,MAAM,QAAQ,IAAI,CAChBla,IAAM,4BAA4Bka,EAAK,EAAE,EACzCla,IAAM,2BAA2Bka,EAAK,EAAE,EACzC,OAEgB,CAErB,CAEA,OAAA/oB,EAAa9T,GAAA,CACX,MAAM6/C,EAAO,CAAE,GAAI7/C,EAAM,cAAgB,CAAI,GAC7C,cAAO6/C,EAAKqb,CAAY,EACjB,CAAE,aAAcrb,EAAK,CAC7B,EAEM77C,CAAA,KACF,CAIL,MAAMk3D,EAAeH,GAAc7Z,EAAQI,EAAc0Z,EAAUtZ,CAAM,EAErE,IADa/+B,IAAM,cAAgB,IAC1Bu4C,CAAY,EAAG,CAEtBpnD,EAAA,CAAE,QAAS,GAAO,EACtB,MACF,CACAA,EAAc9T,IAAA,CAAE,aAAc,CAAE,GAAIA,EAAM,cAAgB,GAAK,CAACk7D,CAAY,EAAG,KAAS,EAClF,MAAAx6B,EAAYu6B,GAAqBC,CAAY,EAE7Ct9C,EAAW,MAAM,MAAM,GAAGyhC,IAAW,oBAAoBiC,CAAY,aAAc,CACvF,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAA0Z,EACA,UAAWtZ,EACX,OAAAR,EACA,YAAa,OACb,UAAAxgB,CAAA,CACD,EACF,EAEG,IAAC9iB,EAAS,GAAI,CACV,MAAA6/C,EAAY,MAAM7/C,EAAS,OAAO,MAAM,KAAO,CAAG,IACpD,MAAA6/C,EAAU,QAAU,qBAChB,IAAI,MAAM,oBAAoB,EAElCA,EAAU,QAAU,mBAChB,IAAI,MAAM,6DAA6D,EAEzE,IAAI,MAAMA,EAAU,SAAW,wCAAwC,CAC/E,CAEM,MAAAz5D,EAAS,MAAM4Z,EAAS,OAGxB8/C,EAAoB15D,GAAQ,MAAM,WAClC25D,EAAW35D,GAAQ,MAAM,MAE/B8P,EAAa9T,GAAA,CACL,MAAA49D,EAAmBT,GACnB,CAACA,GAAQA,EAAK,KAAO7b,EAAqB6b,EACvCO,EAAoB,CAAE,GAAGP,EAAM,GAAGO,GAAsBP,EAG1D,OACL,YAAan9D,EAAM,YAAY,IAAI49D,CAAe,EAClD,gBAAiB59D,EAAM,gBAAgB,IAAI49D,CAAe,EAC1D,mBAAoB59D,EAAM,mBAAmB,IAAI49D,CAAe,EAChE,uBAAwB59D,EAAM,uBAAuB,IAAI49D,CAAe,EACxE,sBAAuBD,EACnB,CACE,GAAG39D,EAAM,sBAAsB,UAAgB4V,EAAM,KAAO+nD,EAAS,EAAE,EACvEA,GAEF39D,EAAM,sBACV,QAAS,GACT,MAAO,KACT,CACD,EAEG,IACF,KAAM,CAAE,KAAA68B,CAAA,EAASisB,EAAa,SAAS,EACnCjsB,GAAM,IACR,MAAM,QAAQ,IAAI,CAChBla,IAAM,4BAA4Bka,EAAK,EAAE,EACzCla,IAAM,2BAA2Bka,EAAK,EAAE,EACzC,OAEgB,CAErB,CAEA,OAAA/oB,EAAa9T,GAAA,CACX,MAAM6/C,EAAO,CAAE,GAAI7/C,EAAM,cAAgB,CAAI,GAC7C,cAAO6/C,EAAKqb,CAAY,EACjB,CAAE,aAAcrb,EAAK,CAC7B,EAEM77C,CACT,QAEO3C,EAAO,CAId,IAAImiB,EAAe,6BACnB,MAAIniB,aAAiB,QACfA,EAAM,QAAQ,SAAS,mBAAmB,GAAKA,EAAM,QAAQ,SAAS,uBAAuB,EAChFmiB,EAAA,iFAEfA,EAAeniB,EAAM,SAIrByS,EAAA,CACF,QAAS,GACT,MAAO0P,CAAA,CACR,EACKniB,CAAA,QACN,CAEI,IACF,MAAM65D,EAAeH,GAAc7Z,EAAQI,EAAc0Z,EAAUtZ,CAAM,EACzE5tC,EAAa9T,GAAA,CACX,MAAM6/C,EAAO,CAAE,GAAI7/C,EAAM,cAAgB,CAAI,GAC7C,cAAO6/C,EAAKqb,CAAY,EACjB,CAAE,aAAcrb,EAAK,CAC7B,OACK,CAAC,CACX,CACF,EAMA,oBAAqB,MAAOyB,EAAsB0Z,EAAkB6C,EAAmB3c,IAAmB,CACxGptC,EAAI,CAAE,QAAS,GAAM,MAAO,IAAM,GAE9B,IAIF,MAAMonD,EAAeH,GAAc7Z,EAAQI,EAAc0Z,EAAU6C,CAAS,EAExE,IADal7C,IAAM,cAAgB,IAC1Bu4C,CAAY,EAAG,CAEtBpnD,EAAA,CAAE,QAAS,GAAO,EACtB,MACF,CACAA,EAAc9T,IAAA,CAAE,aAAc,CAAE,GAAIA,EAAM,cAAgB,GAAK,CAACk7D,CAAY,EAAG,KAAS,EAClF,MAAAx6B,EAAYu6B,GAAqBC,CAAY,EAE7Ct9C,EAAW,MAAM,MAAM,GAAGyhC,IAAW,oBAAoBiC,CAAY,aAAc,CACvF,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAA0Z,EACA,UAAA6C,EACA,OAAA3c,EACA,YAAa,OACb,UAAAxgB,CAAA,CACD,EACF,EAEG,IAAC9iB,EAAS,GAAI,CACV,MAAA6/C,EAAY,MAAM7/C,EAAS,OAAO,MAAM,KAAO,CAAG,IACpD,MAAA6/C,EAAU,QAAU,qBAChB,IAAI,MAAM,qDAAqD,EAEnEA,EAAU,QAAU,gBAChB,IAAI,MAAM,qCAAqC,EAEnDA,EAAU,QAAU,mBAChB,IAAI,MAAM,6DAA6D,EAEzE,IAAI,MAAMA,EAAU,SAAW,wCAAwC,CAC/E,CAEM,MAAAz5D,EAAS,MAAM4Z,EAAS,OAGxB8/C,EAAoB15D,GAAQ,MAAM,WAClC25D,EAAW35D,GAAQ,MAAM,MAE/B8P,EAAa9T,GAAA,CACL,MAAA49D,EAAmBT,GACnB,CAACA,GAAQA,EAAK,KAAO7b,EAAqB6b,EACvCO,EAAoB,CAAE,GAAGP,EAAM,GAAGO,GAAsBP,EAG1D,OACL,YAAan9D,EAAM,YAAY,IAAI49D,CAAe,EAClD,gBAAiB59D,EAAM,gBAAgB,IAAI49D,CAAe,EAC1D,mBAAoB59D,EAAM,mBAAmB,IAAI49D,CAAe,EAChE,uBAAwB59D,EAAM,uBAAuB,IAAI49D,CAAe,EACxE,sBAAuBD,EACnB,CACE,GAAG39D,EAAM,sBAAsB,UAAgB4V,EAAM,KAAO+nD,EAAS,EAAE,EACvEA,GAEF39D,EAAM,sBACV,QAAS,GACT,MAAO,KACT,CACD,EAEG,IACF,KAAM,CAAE,KAAA68B,CAAA,EAASisB,EAAa,SAAS,EACnCjsB,GAAM,IACR,MAAM,QAAQ,IAAI,CAChBla,IAAM,4BAA4Bka,EAAK,EAAE,EACzCla,IAAM,2BAA2Bka,EAAK,EAAE,EACzC,OAEgB,CAErB,CAGA,OAAA/oB,EAAa9T,GAAA,CACX,MAAM6/C,EAAO,CAAE,GAAI7/C,EAAM,cAAgB,CAAI,GAC7C,cAAO6/C,EAAKqb,CAAY,EACjB,CAAE,aAAcrb,EAAK,CAC7B,EAEM77C,QACA3C,EAAO,CAEd,IAAImiB,EAAe,6BACnB,MAAIniB,aAAiB,QACnBmiB,EAAeniB,EAAM,SAEvByS,EAAI,CAAE,QAAS,GAAO,MAAO0P,CAAc,GACrCniB,CACR,CACF,EAEA,mBAAoB,SAAY,CAC1ByS,EAAA,CAAE,aAAc,GAAM,EAEtB,IAGF,MAAMkK,EAAO,MAAM48C,GAAU,IAAI,qCAAsC,CACrE,QAAS,IACT,aAAc,CAAE,WAAY,CAAE,EAC/B,EAEG,GAAA58C,EAAK,SAAWA,EAAK,KACnBlK,EAAA,CACF,cAAekK,EAAK,KACpB,aAAc,GACf,MAIK,WAAI,MAAM,+BAA+B,OAGnC,CAIR,MAAE,YAAAg/C,GAAgBr6C,IAClBm7C,EAA+B,CACnC,YAAad,EAAY,OAAO,CAACe,EAAKZ,IAASY,GAAOZ,EAAK,YAAc,GAAI,CAAC,EAAE,QAAQ,CAAC,EACzF,kBAAmBH,EAAY,UAAeG,EAAK,SAAW,MAAM,EAAE,OACtE,WAAYH,EAAY,OAAS,EAAI,IAAM,IAC3C,UAAWA,EAAY,OAAO,CAACe,EAAKZ,IAASY,GAAOZ,EAAK,YAAc,GAAI,CAAC,EAC5E,SAAUH,EAAY,OAAS,EAAI,EAAI,GAGrClpD,EAAA,CACF,cAAegqD,EACf,aAAc,GACf,CAGH,CACF,EAGA,yBAA2Bxc,GAGlB,GAGT,6BAA+BA,GAGtB,GAGT,WAAY,IAAM,CACZxtC,EAAA,CAAE,MAAO,KAAM,CACrB,EAGA,2BAA4B,MAAOotC,GAAmB,CAChD,IAQI,MAAA8c,GALO,MAAMpD,GAAU,IAAI,mCAAmC1Z,CAAM,GAAI,CAC5E,QAAS,IACT,aAAc,CAAE,WAAY,CAAE,EAC/B,GAEkC,MAAQ,GAEvCptC,EAAA,CAAE,sBAAAkqD,EAAuB,OAGf,CAGhB,CACF,EAEA,4BAA6B,MAAO9c,GAAmB,CACjD,IAQI,MAAA+c,GALO,MAAMrD,GAAU,IAAI,+BAA+B1Z,CAAM,GAAI,CACxE,QAAS,IACT,aAAc,CAAE,WAAY,CAAE,EAC/B,GAEmC,MAAQ,GAExCptC,EAAA,CAAE,uBAAAmqD,EAAwB,OAGhB,CAGhB,CACF,EAGA,yBAA2B/c,GAAmB,CACtC,MAAE,sBAAA8c,GAA0Br7C,IAClC,OAAOq7C,EAAsB,OAAgBpoD,KAAM,UAAYsrC,CAAM,CACvE,EAEA,0BAA4BA,GAAmB,CACvC,MAAE,uBAAA+c,GAA2Bt7C,IACnC,OAAOs7C,EAAuB,OAAqBxC,KAAW,aAAeva,CAAM,CACrF,EAKA,iBAAkB,MAAOI,EAAsBH,IAAiB,CAC1D,IAGI,MAAAvjC,EAAW,MAAM,MAAM,GAAGyhC,IAAW,uBAAuBiC,CAAY,GAAI,CAChF,OAAQ,MACR,QAAS,CACP,eAAgB,mBAChB,OAAU,kBACZ,EACA,KAAM,KAAK,UAAUH,CAAO,EAC7B,EAEG,IAACvjC,EAAS,GACZ,MAAM,IAAI,MAAM,gCAAgCA,EAAS,UAAU,EAAE,EAIvE,MAAM8/C,GADO,MAAM9/C,EAAS,QACG,KAG/B9J,EAAc9T,IAAA,CACZ,YAAaA,EAAM,YAAY,IAAIm9D,GACjCA,EAAK,KAAO7b,EAAe,CAAE,GAAG6b,EAAM,GAAGO,CAAA,EAAsBP,CACjE,EACA,uBAAwBn9D,EAAM,uBAAuB,IAAIm9D,GACvDA,EAAK,KAAO7b,EAAe,CAAE,GAAG6b,EAAM,GAAGO,CAAA,EAAsBP,CACjE,CACA,UAIK97D,EAAO,CAER,MAAAA,CACR,CACF,EAEA,iBAAkB,MAAOigD,GAAyB,CAC5C,IAGI,MAAA1jC,EAAW,MAAM,MAAM,GAAGyhC,IAAW,uBAAuBiC,CAAY,GAAI,CAChF,OAAQ,SACR,QAAS,CACP,eAAgB,mBAChB,OAAU,kBACZ,EACD,EAEG,IAAC1jC,EAAS,GACZ,MAAM,IAAI,MAAM,gCAAgCA,EAAS,UAAU,EAAE,EAIvE9J,EAAc9T,IAAA,CACZ,YAAaA,EAAM,YAAY,OAAem9D,KAAK,KAAO7b,CAAY,EACtE,mBAAoBthD,EAAM,mBAAmB,OAAem9D,KAAK,KAAO7b,CAAY,EACpF,uBAAwBthD,EAAM,uBAAuB,OAAem9D,KAAK,KAAO7b,CAAY,EAC5F,oBAAqBthD,EAAM,oBAAoB,OAAem9D,KAAK,KAAO7b,CAAY,EACtF,qBAAsBthD,EAAM,qBAAqB,OAAem9D,KAAK,KAAO7b,CAAY,CACxF,IAGE,IACF,KAAM,CAAE,KAAAzkB,CAAA,EAASisB,EAAa,SAAS,EAEjC,MAAAnmC,EAAM,qBAAmB,EAAI,EAC7B,MAAAA,EAAA,EAAM,2BACRka,GAAM,KACR,MAAMla,EAAI,EAAE,4BAA4Bka,EAAK,EAAE,EAC/C,MAAMla,EAAI,EAAE,2BAA2Bka,EAAK,EAAE,QAE3B,CAEvB,QAIOx7B,EAAO,CAER,MAAAA,CACR,CACF,EAEA,gBAAiB,MAAOigD,GAAyB,CAC3C,IAGI,MAAA1jC,EAAW,MAAM,MAAM,GAAGyhC,IAAW,uBAAuBiC,CAAY,SAAU,CACtF,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,OAAU,kBACZ,EACD,EAEG,IAAC1jC,EAAS,GACZ,MAAM,IAAI,MAAM,+BAA+BA,EAAS,UAAU,EAAE,EAItE,MAAM8/C,GADO,MAAM9/C,EAAS,QACG,KAG/B9J,EAAa9T,GAAA,CACX,MAAM49D,EAAmBT,GACvBA,EAAK,KAAO7b,EACR,CAAE,GAAG6b,EAAM,GAAGO,EAAmB,OAAQ,UACzCP,EAEC,OACL,YAAan9D,EAAM,YAAY,IAAI49D,CAAe,EAClD,uBAAwB59D,EAAM,uBAAuB,IAAI49D,CAAe,EACxE,mBAAoB59D,EAAM,mBAAmB,IAAI49D,CAAe,EAChE,gBAAiB59D,EAAM,gBAAgB,IAAI49D,CAAe,EAC1D,oBAAqB59D,EAAM,oBAAoB,IAAI49D,CAAe,EAClE,qBAAsB59D,EAAM,qBAAqB,IAAI49D,CAAe,EACtE,CACD,QAIMv8D,EAAO,CAER,MAAAA,CACR,CACF,EAEA,wBAAyB,MAAOigD,GAAyB,CACnD,IAGI,MAAA1jC,EAAW,MAAM,MAAM,GAAGyhC,IAAW,uBAAuBiC,CAAY,YAAa,CACzF,OAAQ,MACR,QAAS,CACP,eAAgB,mBAChB,OAAU,kBACZ,EACD,EAEG,OAAC1jC,EAAS,IAKD,MAAMA,EAAS,QAChB,MAAQ,GAJX,QAMK,CAEd,MAAO,EACT,CACF,EAEA,4BAA6B,MAAO0jC,GAAyB,CACvD,IAGI,MAAA1jC,EAAW,MAAM,MAAM,GAAGyhC,IAAW,uBAAuBiC,CAAY,gBAAiB,CAC7F,OAAQ,MACR,QAAS,CACP,eAAgB,mBAChB,OAAU,kBACZ,EACD,EAEG,OAAC1jC,EAAS,IAKD,MAAMA,EAAS,QAChB,MAAQ,GAJX,QAMK,CAEd,MAAO,EACT,CACF,EAEA,MAAO,IAAM,CACX9J,EAAI0vC,EAAY,CAClB,CACF,EAAE,EC/2CI0a,GAA2B,SAAY,CAC3C,KAAM,CAAE,mBAAAC,CAAA,EAAuBjC,GAAmB,SAAS,EAC3D,GAAI,OAAOiC,GAAuB,WAC9B,IAEF,MAAMA,EAAmB,EAAI,OACf,CAEhB,CACF,EAEaC,GAAoC,CAAC,CAAE,SAAAzxD,KAAe,CAC3D,MAAE,KAAAkwB,GAASyvB,KACX+R,EAAcC,KACdC,EAAYvR,SAAsB,IAAI,EAE5C7B,mBAAU,IAAM,CACd,MAAM/pD,EAAMk+C,GAAe,UAAQ,MAAO,EAAE,EAEtCx1B,EAAS2tC,GAAGr2D,EAAK,CACrB,WAAY,CAAC,YAAa,SAAS,EACnC,gBAAiB,GACjB,YAAa,GACb,aAAc,GACd,qBAAsB,GACtB,kBAAmB,IACnB,QAAS,IACV,EACDm9D,EAAU,QAAUz0C,EAEbA,EAAA,GAAG,UAAW,IAAM,EAG1B,EAEMA,EAAA,GAAG,gBAAkBzoB,GAAU,EAErC,EAEMyoB,EAAA,GAAG,aAAeE,GAAW,EAEnC,EAEK,MAAAw0C,EAAkB75C,GAAgC,CAClD,CAACkY,GAAM,IAAMlY,EAAQ,SAAWkY,EAAK,KAE7BwhC,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,cAAcx8B,EAAK,EAAE,EAAG,EACzDwhC,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,eAAex8B,EAAK,EAAE,EAAG,EAC1DwhC,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,cAAcx8B,EAAK,EAAE,EAAG,EACrEwhC,EAAY,kBAAkB,CAAE,SAAU,CAAC,cAAc,CAAG,KAGxDI,EAAsB95C,GAAsC,CAC5DA,EAAQ,eACE05C,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,WAAW10C,EAAQ,YAAY,EAAG,EACnE05C,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,kBAAkB10C,EAAQ,YAAY,EAAG,EACjFu5C,GAAyB,EAChC,EAGIQ,EAAwB/5C,GAAsC,CAC9DA,EAAQ,eACE05C,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,WAAW10C,EAAQ,YAAY,EAAG,EACnE05C,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,kBAAkB10C,EAAQ,YAAY,EAAG,EAClFkY,GAAM,IACIwhC,EAAA,kBAAkB,CAAE,SAAUhF,GAAG,cAAcx8B,EAAK,EAAE,EAAG,EAElEqhC,GAAyB,EAChC,EAGK,OAAAp0C,EAAA,GAAG,gBAAiB00C,CAAc,EAClC10C,EAAA,GAAG,oBAAqB20C,CAAkB,EAC1C30C,EAAA,GAAG,sBAAuB40C,CAAoB,EAE9C,IAAM,CACJ50C,EAAA,IAAI,gBAAiB00C,CAAc,EACnC10C,EAAA,IAAI,oBAAqB20C,CAAkB,EAC3C30C,EAAA,IAAI,sBAAuB40C,CAAoB,EACtD50C,EAAO,MAAM,EAEd,GAAC+S,GAAM,GAAIwhC,CAAW,CAAC,oBAEhB,SAAA1xD,CAAS,EACrB,EC9FA;AAAA;AAAA;AAAA;AAAA;AAAA,GAOA,IAAIgyD,GAAoB,CACtB,MAAO,6BACP,MAAO,GACP,OAAQ,GACR,QAAS,YACT,KAAM,OACN,OAAQ,eACR,YAAa,EACb,cAAe,QACf,eAAgB,OAClB,ECjBA;AAAA;AAAA;AAAA;AAAA;AAAA,GAUA,MAAMC,GAAeC,GAAWA,EAAO,QAAQ,qBAAsB,OAAO,EAAE,cAAc,OACtFC,EAAmB,CAACC,EAAUC,IAAa,CAC/C,MAAMC,EAAYC,EAAU,WAC1B,CAAC,CAAE,MAAAC,EAAQ,eAAgB,KAAApjB,EAAO,GAAI,YAAAqjB,EAAc,EAAG,oBAAAC,EAAqB,UAAAllD,EAAY,GAAI,SAAAxN,EAAU,GAAG/I,CAAM,EAAE2R,IAAQ+pD,EAAa,cACpI,MACA,CACE,IAAA/pD,EACA,GAAGopD,GACH,MAAO5iB,EACP,OAAQA,EACR,OAAQojB,EACR,YAAaE,EAAsB,OAAOD,CAAW,EAAI,GAAK,OAAOrjB,CAAI,EAAIqjB,EAC7E,UAAW,CAAC,SAAU,UAAUR,GAAYG,CAAQ,CAAC,GAAI5kD,CAAS,EAAE,KAAK,GAAG,EAC5E,GAAGvW,CACJ,EACD,CACE,GAAGo7D,EAAS,IAAI,CAAC,CAACO,EAAKC,CAAK,IAAMF,EAAa,cAACC,EAAKC,CAAK,CAAC,EAC3D,GAAG,MAAM,QAAQ7yD,CAAQ,EAAIA,EAAW,CAACA,CAAQ,CAClD,CACF,CACL,EACE,OAAAsyD,EAAU,YAAc,GAAGF,CAAQ,GAC5BE,CACT,ECjCA;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACQ,GAAWX,EAAiB,WAAY,CAC5C,CAAC,OAAQ,CAAE,EAAG,4BAA6B,IAAK,QAAQ,CAAE,CAC5D,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACY,GAAcZ,EAAiB,cAAe,CAClD,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,GAAI,KAAM,IAAK,QAAQ,CAAE,EACjE,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,QAAS,GAAI,KAAM,GAAI,KAAM,IAAK,QAAQ,CAAE,CACvE,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACa,GAAgBb,EAAiB,gBAAiB,CACtD,CACE,OACA,CACE,EAAG,4EACH,IAAK,QACN,CACF,EACD,CAAC,OAAQ,CAAE,EAAG,UAAW,IAAK,QAAQ,CAAE,EACxC,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,CAAC,ECnBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACc,GAAYd,EAAiB,YAAa,CAC9C,CAAC,OAAQ,CAAE,EAAG,iBAAkB,IAAK,QAAQ,CAAE,EAC/C,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMe,GAAaf,EAAiB,aAAc,CAChD,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,gBAAiB,IAAK,QAAQ,CAAE,CAChD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACgB,GAAahB,EAAiB,aAAc,CAChD,CACE,OACA,CACE,EAAG,kKACH,IAAK,QACN,CACF,EACD,CAAC,OAAQ,CAAE,EAAG,gBAAiB,IAAK,QAAQ,CAAE,CAChD,CAAC,EClBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMiB,GAAMjB,EAAiB,MAAO,CAClC,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,OAAQ,CAAE,EAAG,qBAAsB,IAAK,QAAQ,CAAE,CACrD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACkB,GAAYlB,EAAiB,YAAa,CAC9C,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,EAC3C,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACmB,GAAOnB,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CAAC,OAAQ,CAAE,EAAG,iCAAkC,IAAK,QAAQ,CAAE,CACjE,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACoB,GAAWpB,EAAiB,WAAY,CAC5C,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACvF,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAChE,CAAC,OAAQ,CAAE,GAAI,IAAK,GAAI,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC9D,CAAC,OAAQ,CAAE,GAAI,IAAK,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,IAAK,QAAQ,CAAE,CACnE,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACqB,GAAcrB,EAAiB,cAAe,CAClD,CAAC,OAAQ,CAAE,EAAG,qCAAsC,IAAK,QAAQ,CAAE,EACnE,CAAC,OAAQ,CAAE,EAAG,iBAAkB,IAAK,QAAQ,CAAE,CACjD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACsB,GAAQtB,EAAiB,QAAS,CAAC,CAAC,OAAQ,CAAE,EAAG,kBAAmB,IAAK,QAAQ,CAAE,CAAC,CAAC,ECT3F;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACuB,GAAcvB,EAAiB,cAAe,CAClD,CAAC,OAAQ,CAAE,EAAG,eAAgB,IAAK,QAAQ,CAAE,CAC/C,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMwB,GAAcxB,EAAiB,cAAe,CAClD,CAAC,OAAQ,CAAE,EAAG,iBAAkB,IAAK,QAAQ,CAAE,CACjD,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMyB,GAAezB,EAAiB,eAAgB,CACpD,CAAC,OAAQ,CAAE,EAAG,gBAAiB,IAAK,QAAQ,CAAE,CAChD,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM0B,GAAY1B,EAAiB,YAAa,CAAC,CAAC,OAAQ,CAAE,EAAG,iBAAkB,IAAK,QAAQ,CAAE,CAAC,CAAC,ECTlG;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM2B,GAAgB3B,EAAiB,gBAAiB,CACtD,CAAC,OAAQ,CAAE,EAAG,gBAAiB,IAAK,OAAO,CAAE,EAC7C,CAAC,OAAQ,CAAE,EAAG,iBAAkB,IAAK,QAAQ,CAAE,CACjD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM4B,GAAS5B,EAAiB,SAAU,CACxC,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,EACxD,CAAC,OAAQ,CAAE,GAAI,QAAS,GAAI,KAAM,GAAI,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EACnE,CAAC,OAAQ,CAAE,GAAI,OAAQ,GAAI,OAAQ,GAAI,OAAQ,GAAI,KAAM,IAAK,QAAQ,CAAE,EACxE,CAAC,OAAQ,CAAE,GAAI,QAAS,GAAI,QAAS,GAAI,QAAS,GAAI,KAAM,IAAK,QAAQ,CAAE,CAC7E,CAAC,ECfD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC6B,GAAQ7B,EAAiB,QAAS,CACtC,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,WAAY,CAAE,OAAQ,mBAAoB,IAAK,QAAQ,CAAE,CAC5D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM8B,GAAQ9B,EAAiB,QAAS,CACtC,CAAC,SAAU,CAAE,GAAI,IAAK,GAAI,IAAK,EAAG,IAAK,IAAK,SAAU,EACtD,CAAC,OAAQ,CAAE,EAAG,kCAAmC,IAAK,QAAQ,CAAE,EAChE,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,8BAA+B,IAAK,QAAQ,CAAE,CAC9D,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM+B,GAAU/B,EAAiB,UAAW,CAC1C,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,UAAW,CAAE,OAAQ,yDAA0D,IAAK,QAAQ,CAAE,CACjG,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACgC,GAAOhC,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACvF,CAAC,OAAQ,CAAE,EAAG,0DAA2D,IAAK,QAAQ,CAAE,CAC1F,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACiC,GAAajC,EAAiB,aAAc,CAChD,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,GAAI,KAAM,IAAK,QAAQ,CAAE,EACjE,CAAC,OAAQ,CAAE,EAAG,oDAAqD,IAAK,QAAQ,CAAE,CACpF,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACkC,GAAWlC,EAAiB,WAAY,CAC5C,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CAAC,WAAY,CAAE,OAAQ,mBAAoB,IAAK,QAAQ,CAAE,EAC1D,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,IAAK,QAAQ,CAAE,CACnE,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACmC,GAAenC,EAAiB,eAAgB,CACpD,CAAC,OAAQ,CAAE,EAAG,2DAA4D,IAAK,QAAQ,CAAE,EACzF,CAAC,WAAY,CAAE,OAAQ,iBAAkB,IAAK,QAAQ,CAAE,EACxD,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,IAAK,QAAQ,CAAE,CACnE,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMoC,GAAMpC,EAAiB,MAAO,CAClC,CAAC,OAAQ,CAAE,EAAG,+CAAgD,IAAK,QAAQ,CAAE,EAC7E,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,CAC1D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMqC,GAASrC,EAAiB,SAAU,CACxC,CAAC,UAAW,CAAE,OAAQ,8CAA+C,IAAK,QAAQ,CAAE,CACtF,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMsC,GAAOtC,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,EAAG,4DAA6D,IAAK,QAAQ,CAAE,EAC1F,CAAC,OAAQ,CAAE,GAAI,IAAK,GAAI,IAAK,GAAI,KAAM,GAAI,KAAM,IAAK,QAAQ,CAAE,CAClE,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMuC,GAAOvC,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,GAAI,IAAK,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,IAAK,QAAQ,CAAE,EACjE,CAAC,OAAQ,CAAE,GAAI,IAAK,GAAI,KAAM,GAAI,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC/D,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CACE,OACA,CACE,EAAG,sFACH,IAAK,QACN,CACF,CACH,CAAC,ECpBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACwC,GAAQxC,EAAiB,QAAS,CACtC,CAAC,OAAQ,CAAE,EAAG,2CAA4C,IAAK,QAAQ,CAAE,EACzE,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,EAC3C,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,CAAC,ECfD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMyC,GAAazC,EAAiB,aAAc,CAChD,CACE,OACA,CACE,EAAG,8HACH,IAAK,QACN,CACF,CACH,CAAC,ECjBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC0C,GAAa1C,EAAiB,aAAc,CAChD,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,OAAQ,CAAE,EAAG,uCAAwC,IAAK,QAAQ,CAAE,EACrE,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM2C,GAAO3C,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,EAAG,iDAAkD,IAAK,QAAQ,CAAE,EAC/E,CAAC,WAAY,CAAE,OAAQ,wBAAyB,IAAK,QAAQ,CAAE,CACjE,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM4C,GAAkB5C,EAAiB,kBAAmB,CAC1D,CAAC,OAAQ,CAAE,MAAO,IAAK,OAAQ,IAAK,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC5E,CAAC,OAAQ,CAAE,MAAO,IAAK,OAAQ,IAAK,EAAG,KAAM,EAAG,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC7E,CAAC,OAAQ,CAAE,MAAO,IAAK,OAAQ,IAAK,EAAG,KAAM,EAAG,KAAM,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC9E,CAAC,OAAQ,CAAE,MAAO,IAAK,OAAQ,IAAK,EAAG,IAAK,EAAG,KAAM,GAAI,IAAK,IAAK,QAAQ,CAAE,CAC/E,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC6C,EAAU7C,EAAiB,UAAW,CAC1C,CAAC,OAAQ,CAAE,EAAG,8BAA+B,IAAK,QAAQ,CAAE,CAC9D,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC8C,GAAO9C,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,KAAM,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACxF,CAAC,OAAQ,CAAE,EAAG,2BAA4B,IAAK,QAAQ,CAAE,CAC3D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC+C,GAAO/C,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC9E,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,CAC5E,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMgD,GAAUhD,EAAiB,UAAW,CAC1C,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,IAAK,GAAI,IAAK,GAAI,KAAM,IAAK,QAAQ,CAAE,EAChE,CAAC,SAAU,CAAE,GAAI,MAAO,GAAI,MAAO,EAAG,MAAO,IAAK,SAAU,EAC5D,CAAC,SAAU,CAAE,GAAI,OAAQ,GAAI,OAAQ,EAAG,MAAO,IAAK,SAAU,CAChE,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMiD,GAAOjD,EAAiB,OAAQ,CACpC,CAAC,UAAW,CAAE,OAAQ,qBAAsB,IAAK,QAAQ,CAAE,CAC7D,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACkD,GAAOlD,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMmD,GAAQnD,EAAiB,QAAS,CACtC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,OAAO,CAAE,EACxC,CAAC,OAAQ,CAAE,EAAG,+BAAgC,IAAK,QAAQ,CAAE,CAC/D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACoD,GAAUpD,EAAiB,UAAW,CAC1C,CACE,OACA,CACE,EAAG,8EACH,IAAK,QACN,CACF,EACD,CAAC,OAAQ,CAAE,EAAG,2CAA4C,IAAK,QAAQ,CAAE,EACzE,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECnBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMqD,GAAarD,EAAiB,aAAc,CAChD,CAAC,OAAQ,CAAE,EAAG,qDAAsD,IAAK,QAAQ,CAAE,EACnF,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,sDAAuD,IAAK,QAAQ,CAAE,EACpF,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACsD,GAAYtD,EAAiB,YAAa,CAC9C,CAAC,OAAQ,CAAE,EAAG,qDAAsD,IAAK,QAAQ,CAAE,EACnF,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,EAC3C,CAAC,OAAQ,CAAE,EAAG,sDAAuD,IAAK,QAAQ,CAAE,EACpF,CAAC,OAAQ,CAAE,EAAG,YAAa,IAAK,QAAQ,CAAE,CAC5C,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMuD,GAAYvD,EAAiB,YAAa,CAC9C,CAAC,OAAQ,CAAE,EAAG,oDAAqD,IAAK,QAAQ,CAAE,EAClF,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMwD,GAAOxD,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,EAAG,kEAAmE,IAAK,QAAQ,CAAE,EAChG,CAAC,WAAY,CAAE,OAAQ,wBAAyB,IAAK,QAAQ,CAAE,EAC/D,CAAC,WAAY,CAAE,OAAQ,eAAgB,IAAK,QAAQ,CAAE,CACxD,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMyD,GAAazD,EAAiB,aAAc,CAChD,CACE,OACA,CAAE,EAAG,mEAAoE,IAAK,QAAU,CACzF,EACD,CAAC,OAAQ,CAAE,EAAG,2BAA4B,IAAK,QAAQ,CAAE,EACzD,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,YAAa,IAAK,QAAQ,CAAE,CAC5C,CAAC,ECjBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC0D,GAAS1D,EAAiB,SAAU,CACxC,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,EACxD,CAAC,OAAQ,CAAE,EAAG,iBAAkB,IAAK,QAAQ,CAAE,CACjD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC2D,GAAW3D,EAAiB,WAAY,CAC5C,CACE,OACA,CACE,EAAG,wjBACH,IAAK,QACN,CACF,EACD,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,CAC1D,CAAC,EClBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM4D,GAAQ5D,EAAiB,QAAS,CACtC,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CAAC,WAAY,CAAE,OAAQ,gBAAiB,IAAK,QAAQ,CAAE,EACvD,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,GAAI,KAAM,IAAK,QAAQ,CAAE,CACnE,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC6D,GAAS7D,EAAiB,SAAU,CACxC,CAAC,OAAQ,CAAE,EAAG,6CAA8C,IAAK,QAAQ,CAAE,CAC7E,CAAC,ECXD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC8D,GAAa9D,EAAiB,aAAc,CAChD,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACvF,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC+D,GAAW/D,EAAiB,WAAY,CAC5C,CACE,OACA,CACE,EAAG,wKACH,IAAK,QACN,CACF,EACD,CAAC,OAAQ,CAAE,EAAG,SAAU,IAAK,QAAQ,CAAE,EACvC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,SAAU,IAAK,QAAQ,CAAE,EACvC,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECrBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMgE,GAAMhE,EAAiB,MAAO,CAClC,CACE,OACA,CACE,EAAG,oFACH,IAAK,QACN,CACF,EACD,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,EClBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACiE,GAASjE,EAAiB,SAAU,CACxC,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,EACxD,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,CAC1D,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMkE,GAAalE,EAAiB,aAAc,CAChD,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACvF,CAAC,SAAU,CAAE,GAAI,IAAK,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,CACzD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMmE,GAAcnE,EAAiB,cAAe,CAClD,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACvF,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,IAAK,IAAK,SAAU,CAC1D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMoE,GAAepE,EAAiB,eAAgB,CACpD,CAAC,WAAY,CAAE,OAAQ,8BAA+B,IAAK,QAAQ,CAAE,EACrE,CAAC,WAAY,CAAE,OAAQ,oBAAqB,IAAK,QAAQ,CAAE,CAC7D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACqE,GAAarE,EAAiB,aAAc,CAChD,CAAC,WAAY,CAAE,OAAQ,+BAAgC,IAAK,QAAQ,CAAE,EACtE,CAAC,WAAY,CAAE,OAAQ,kBAAmB,IAAK,QAAQ,CAAE,CAC3D,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACsE,GAAStE,EAAiB,SAAU,CACxC,CAAC,OAAQ,CAAE,EAAG,+BAAgC,IAAK,QAAQ,CAAE,EAC7D,CAAC,OAAQ,CAAE,EAAG,iCAAkC,IAAK,QAAQ,CAAE,EAC/D,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,EACzC,CAAC,OAAQ,CAAE,EAAG,6DAA8D,IAAK,QAAQ,CAAE,EAC3F,CAAC,OAAQ,CAAE,EAAG,8DAA+D,IAAK,QAAQ,CAAE,EAC5F,CAAC,OAAQ,CAAE,EAAG,8BAA+B,IAAK,QAAQ,CAAE,CAC9D,CAAC,EChBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACuE,GAAOvE,EAAiB,OAAQ,CACpC,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,IAAK,EAAG,IAAK,IAAK,SAAU,CACzD,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACwE,GAAQxE,EAAiB,QAAS,CACtC,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CAAC,SAAU,CAAE,GAAI,IAAK,GAAI,IAAK,EAAG,IAAK,IAAK,QAAS,EACrD,CAAC,OAAQ,CAAE,EAAG,6BAA8B,IAAK,QAAQ,CAAE,EAC3D,CAAC,OAAQ,CAAE,EAAG,4BAA6B,IAAK,QAAQ,CAAE,CAC5D,CAAC,ECdD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACyE,GAASzE,EAAiB,SAAU,CACxC,CAAC,OAAQ,CAAE,EAAG,gCAAiC,IAAK,QAAQ,CAAE,EAC9D,CAAC,OAAQ,CAAE,EAAG,8BAA+B,IAAK,QAAQ,CAAE,EAC5D,CAAC,OAAQ,CAAE,EAAG,6BAA8B,IAAK,QAAQ,CAAE,CAC7D,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAM0E,GAAS1E,EAAiB,SAAU,CACxC,CACE,OACA,CACE,EAAG,2JACH,IAAK,QACN,CACF,CACH,CAAC,ECjBD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC2E,GAAU3E,EAAiB,UAAW,CAC1C,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,OAAQ,CAAE,EAAG,YAAa,IAAK,QAAQ,CAAE,EAC1C,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,CAAC,ECbD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC4E,GAAI5E,EAAiB,IAAK,CAC9B,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,EAC3C,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,CAAC,ECZD;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAAC6E,GAAM7E,EAAiB,MAAO,CAClC,CAAC,UAAW,CAAE,OAAQ,yCAA0C,IAAK,QAAQ,CAAE,CACjF,CAAC,ECDM,MAAM8E,EAAU,CAOrB,YAAYr0D,EAAsB,CAN1Bs0D,GAAA,gBACAA,GAAA,0BACAA,GAAA,6BAAiD,MACjDA,GAAA,4BAAgD,MAChDA,GAAA,6BAAwC,MAkDxCA,GAAA,qBAAiB1zD,GAAyB,CAChD,GAAIA,EAAM,MAAQ,MAId,IAFJ,KAAK,wBAAwB,EAEzB,KAAK,kBAAkB,SAAW,EAAG,CACvCA,EAAM,eAAe,EACrB,MACF,CAEI,QAAK,kBAAkB,SAAW,EAAG,CACvCA,EAAM,eAAe,EACrB,KAAK,uBAAuB,QAC5B,MACF,CAEIA,EAAM,SAEJ,SAAS,gBAAkB,KAAK,wBAClCA,EAAM,eAAe,EACrB,KAAK,sBAAsB,SAIzB,SAAS,gBAAkB,KAAK,uBAClCA,EAAM,eAAe,EACrB,KAAK,uBAAuB,SAEhC,GA3EA,KAAK,QAAUZ,EACf,KAAK,kBAAoB,GACzB,KAAK,wBAAwB,CAC/B,CAEQ,yBAA0B,CAChC,MAAMu0D,EAAoB,CACxB,yBACA,wBACA,yBACA,2BACA,UACA,kCACA,4BACA,KAAK,GAAG,EAEV,KAAK,kBAAoB,MAAM,KAC7B,KAAK,QAAQ,iBAAiBA,CAAiB,GAGjD,KAAK,sBAAwB,KAAK,kBAAkB,CAAC,GAAK,KAC1D,KAAK,qBAAuB,KAAK,kBAAkB,KAAK,kBAAkB,OAAS,CAAC,GAAK,IAC3F,CAEA,UAAW,CACT,KAAK,sBAAwB,SAAS,cACtC,KAAK,wBAAwB,EAG7B,WAAW,IAAM,CACX,KAAK,uBACP,KAAK,sBAAsB,SAE5B,EAAE,EAEI,0BAAiB,UAAW,KAAK,aAAa,CACzD,CAEA,YAAa,CACF,6BAAoB,UAAW,KAAK,aAAa,EAGtD,KAAK,uBAAyB,UAAW,KAAK,uBAC/C,KAAK,sBAAsC,OAEhD,CAgCF,CAKO,MAAMC,GAAqB,CAIhC,gBAAiB,CACf5zD,EACA6zD,EACAC,EACAC,EACAC,EAAyC,aACtC,CACH,MAAMC,EAAaD,IAAgB,WAC7BE,EAAQD,EAAa,UAAY,YACjCE,EAAUF,EAAa,YAAc,aAE3C,OAAQj0D,EAAM,IAAK,CACjB,KAAKk0D,EACHl0D,EAAM,eAAe,EACrB+zD,EAAcF,EAAe,EAAIA,EAAe,EAAIC,EAAa,CAAC,EAClE,MACF,KAAKK,EACHn0D,EAAM,eAAe,EACrB+zD,EAAcF,EAAeC,EAAa,EAAID,EAAe,EAAI,CAAC,EAClE,MACF,IAAK,OACH7zD,EAAM,eAAe,EACrB+zD,EAAc,CAAC,EACf,MACF,IAAK,MACH/zD,EAAM,eAAe,EACrB+zD,EAAcD,EAAa,CAAC,EAC5B,KACJ,CACF,EAKA,aAAc,CAAC9zD,EAAsBo0D,IAAyB,CACxDp0D,EAAM,MAAQ,WAChBA,EAAM,eAAe,EACZo0D,IAEb,EAKA,iBAAkB,CAACp0D,EAAsBq0D,IAA2B,EAC9Dr0D,EAAM,MAAQ,SAAWA,EAAM,MAAQ,OACzCA,EAAM,eAAe,EACVq0D,IAEf,CACF,EAKaC,GAAY,CAIvB,WAAY,CAAChzD,EAAiB,QACrB,GAAGA,CAAM,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAM7D,SAAU,CAACjS,EAAiBklE,EAAmC,WAAa,CACpE,MAAAC,EAAe,SAAS,cAAc,KAAK,EACpCA,EAAA,aAAa,YAAaD,CAAQ,EAClCC,EAAA,aAAa,cAAe,MAAM,EAC/CA,EAAa,UAAY,UACzBA,EAAa,YAAcnlE,EAElB,cAAK,YAAYmlE,CAAY,EAGtC,WAAW,IAAM,CACXA,EAAa,YACN,cAAK,YAAYA,CAAY,GAEvC,GAAI,CACT,EAKA,YAAa,CAACp1D,EAAsBq1D,IAAsB,CACxDr1D,EAAQ,aAAa,gBAAiBq1D,EAAS,SAAU,EAC3D,EAKA,YAAa,CAACr1D,EAAsBs1D,IAAsB,CACxDt1D,EAAQ,aAAa,gBAAiBs1D,EAAS,SAAU,EAC3D,EAKA,WAAY,CAACt1D,EAAsBu1D,IAAqB,CACtDv1D,EAAQ,aAAa,eAAgBu1D,EAAQ,SAAU,EACzD,CACF,EA4DaC,GAAuB,IAC3B,OAAO,WAAW,kCAAkC,EAAE,QCrQzDC,GAAuBhZ,gBAAoD,MAAS,EAE7EiZ,GAAmB,IAAM,CAC9B,MAAA9wD,EAAU+3C,aAAW8Y,EAAoB,EAC/C,GAAI7wD,IAAY,OACR,UAAI,MAAM,8DAA8D,EAEzE,OAAAA,CACT,EAMa+wD,GAA8D,CAAC,CAAE,SAAAv4D,KAAe,CAC3F,KAAM,CAACw4D,EAAUC,CAAW,EAAIla,WAAS,UAAU,MAAM,EACnD,CAACma,EAAkBC,CAAmB,EAAIpa,WAAS,EAAK,EAE9DC,YAAU,IAAM,CACd,MAAMoa,EAAe,IAAM,CACzBH,EAAY,EAAI,GAIZI,EAAgB,IAAM,CAC1BJ,EAAY,EAAK,GAKZ,+BAAiB,SAAUG,CAAY,EACvC,wBAAiB,UAAWC,CAAa,GAGnB,IAAM,CACjC,GAAI,eAAgB,UAAW,CAC7B,MAAMviB,EAAc,UAAkB,WACtC,GAAIA,EAAY,CACd,MAAMwiB,EAASxiB,EAAW,gBAAkB,WAAaA,EAAW,gBAAkB,KACtFqiB,EAAoBG,CAAM,CAK5B,CACF,MAMK,IAAM,CACJ,2BAAoB,SAAUF,CAAY,EAC1C,2BAAoB,UAAWC,CAAa,EAEvD,EAAG,CAAE,GAEL,MAAMjmE,EAAkC,CACtC,SAAA4lE,EACA,iBAAAE,CAAA,EAGF,OACGjZ,MAAA4Y,GAAqB,SAArB,CAA8B,MAAAzlE,EAC5B,SAAAoN,CACH,EAEJ,EC7DM+4D,GAAkD,CAAC,CACvD,OAAAC,EACA,QAAAx6C,EACA,SAAA3Q,EACA,MAAA8sC,EAAQ,2BACR,YAAAjU,EAAc,wCACd,YAAAuyB,EAAc,WAChB,IAAM,CACJ,KAAM,CAACnnC,EAAOonC,CAAQ,EAAI3a,WAAS,EAAE,EAC/B,CAAC4a,EAAcC,CAAe,EAAI7a,WAAS,EAAK,EAChD,CAAC7pD,EAAOsyC,CAAQ,EAAIuX,WAAS,EAAE,EAC/B,CAAC3D,EAAaye,CAAc,EAAI9a,WAAS,EAAK,EAC9C+a,EAAWjZ,SAAuB,IAAI,EACtCkZ,EAAgBlZ,SAAyB,IAAI,EAC7CmZ,EAAenZ,SAAyB,IAAI,EAC5C,CAACoZ,CAAO,EAAIlb,EAAA,SAAS,IAAMuZ,GAAU,WAAW,aAAa,CAAC,EAGpEtZ,YAAU,IAAM,CACV,GAAAwa,GAAUM,EAAS,QAErB,OAAAJ,EAAS,EAAE,EACXlyB,EAAS,EAAE,EACXoyB,EAAgB,EAAK,EACrBC,EAAe,EAAK,EAGpBG,EAAa,QAAU,IAAIvC,GAAUqC,EAAS,OAAO,EACrDE,EAAa,QAAQ,WAGX1B,GAAA,SAAS,GAAGnd,CAAK,gBAAgB,EAEpC,IAAM,CACP6e,EAAa,UACfA,EAAa,QAAQ,aACrBA,EAAa,QAAU,KACzB,CAEJ,EACC,CAACR,EAAQre,CAAK,CAAC,EAGlB6D,YAAU,IAAM,CACd,GAAI,CAACwa,EAAQ,OAEP,MAAAU,EAAiBl2D,GAAyB,CAC3B4zD,GAAA,aAAa5zD,EAAOgb,CAAO,GAGvC,iCAAiB,UAAWk7C,CAAa,EAC3C,IAAM,SAAS,oBAAoB,UAAWA,CAAa,GACjE,CAACV,EAAQx6C,CAAO,CAAC,EAEd,MAAAm7C,EAAiB7nC,GAChBA,EACA,eAAe,KAAKA,CAAK,EACvB,KADiC,sCADrB,qBAKf8nC,EAAe,MAAOh8C,GAAuB,CACjDA,EAAE,eAAe,EAEX,MAAAi8C,EAAkBF,EAAc7nC,CAAK,EAC3C,GAAI+nC,EAAiB,CACnB7yB,EAAS6yB,CAAe,EACxB,MACF,CAEAT,EAAgB,EAAI,EACpBpyB,EAAS,EAAE,EAEP,IACI,MAAAn5B,EAASikB,EAAM,MAAM,EAC3BunC,EAAe,EAAI,EAEnB,WAAW,IAAM,CACP76C,KACP,GAAI,QACA9pB,EAAO,CACdsyC,EAAStyC,aAAiB,MAAQA,EAAM,QAAU,sBAAsB,EACxE0kE,EAAgB,EAAK,CACvB,GAGF,OAAKJ,EAGHc,EAAA,KAAC,OACC,UAAU,0DACV,MAAO,CAAE,cAAed,EAAS,OAAS,MAAO,EAGjD,UAAAvZ,EAAA,IAAC,OACC,UAAU,gDACV,QAAS7E,EAAc,OAAYp8B,CAAA,CACrC,EAGAs7C,EAAA,KAAC,OACC,IAAKR,EACL,UAAU,2EACV,KAAK,SACL,aAAW,OACX,kBAAiB,GAAGG,CAAO,SAC3B,mBAAkB,GAAGA,CAAO,eAC5B,YAAU,SAGV,UAACK,OAAA,OAAI,UAAU,iEACb,UAAAA,OAAC,MACC,WAACra,MAAA,MAAG,GAAI,GAAGga,CAAO,SAAU,UAAU,sCACnC,SAAc7e,EAAA,oBAAsBD,CACvC,GACC8E,EAAA,SAAE,GAAI,GAAGga,CAAO,eAAgB,UAAU,6BACxC,SAAc7e,EAAA,6BAA6B9oB,CAAK,GAAK4U,EACxD,GACF,EACA+Y,EAAA,IAAC,UACC,QAASjhC,EACT,UAAU,uFACV,aAAW,cACX,SAAU26C,EAEV,SAAA1Z,MAACsX,GAAE,WAAU,SAAU,GACzB,GACF,EAGCnc,EAECkf,OAAC,MAAI,WAAU,kBACb,UAAAra,MAAC,OAAI,UAAU,sFACb,eAAC+T,GAAY,WAAU,2BAA2B,CACpD,GACC/T,EAAA,UAAG,UAAU,2CAA2C,SAEzD,uBACCA,EAAA,SAAE,UAAU,qCAAqC,SAElD,gGACC,MAAI,WAAU,iCACb,SAACqa,EAAA,UAAE,UAAU,wBACX,UAAAra,MAAC,UAAO,SAAQ,aAAS,IAAE3tB,CAAA,EAC7B,CACF,GACC2tB,EAAA,SAAE,UAAU,wBAAwB,SAErC,2EACF,EAGAA,MAAC,QAAK,SAAUma,EAAc,UAAU,MACtC,SAAAE,EAAA,KAAC,MAAI,WAAU,YAEb,UAAAA,OAAC,MACC,WAAAra,MAAC,QAAM,SAAQ,cAAc,UAAU,+CAA+C,SAEtF,kBACAqa,OAAC,MAAI,WAAU,WACb,UAAAra,MAAC,OAAI,UAAU,uEACb,eAACyV,GAAK,WAAU,wBAAwB,CAC1C,GACAzV,EAAA,IAAC,SACC,IAAK8Z,EACL,GAAG,cACH,KAAK,QACL,MAAOznC,EACP,SAAWlU,GAAMs7C,EAASt7C,EAAE,OAAO,KAAK,EACxC,UAAW,wGACTlpB,EAAQ,sCAAwC,0CAClD,GACA,YAAY,iBACZ,SAAUykE,EACV,aAAa,QACf,GACF,EACCzkE,GACE+qD,MAAA,KAAE,UAAU,4BAA4B,KAAK,QAC3C,SACH/qD,EAAA,GAEJ,EAGA+qD,EAAA,IAAC,UACC,KAAK,SACL,SAAU0Z,GAAgB,CAACrnC,EAAM,KAAK,EACtC,UAAU,+MAET,WAEGgoC,OAAAC,EAAA,oBAACta,MAAAuV,EAAA,CAAQ,UAAU,sBAAuB,GAAE,cAE9C,EAGE8E,OAAAC,EAAA,oBAACta,MAAAyV,GAAA,CAAK,UAAU,SAAU,GACzB+D,CAAA,EACH,EAEJ,GACF,CACF,GAID,CAACre,GACA6E,MAAC,MAAI,WAAU,YACb,SAAAA,EAAA,IAAC,IAAE,WAAU,oCAAoC,+EAEjD,GACF,GAEJ,KAjIgB,IAoItB,EAEAua,GAAejB,GC/NTkB,GAA0B,IAAM,CACpC,KAAM,CAAE,OAAAjB,EAAQ,cAAAla,EAAe,WAAAH,GAAeN,GAAY,EACpD,CAAE,iBAAA6b,EAAkB,oBAAAC,EAAqB,KAAAjqC,GAASyvB,GAAe,EACjE,CAAE,SAAA6Y,GAAaF,KACf,CAAC8B,EAAkBC,CAAmB,EAAI9b,WAAS,EAAK,EAExD+a,EAAWjZ,SAAuB,IAAI,EACtCia,EAAiBja,SAA0B,IAAI,EAC/CmZ,EAAenZ,SAAyB,IAAI,EAC5C,CAACoZ,CAAO,EAAIlb,EAAA,SAAS,IAAMuZ,GAAU,WAAW,YAAY,CAAC,EAG7DyC,EACJ5b,IACCG,EAAgBpB,GAAWoB,CAAa,EAAI,SAC7CnB,GAGFa,YAAU,IAAM,CACV,GAAAwa,GAAUM,EAAS,QAErB,OAAAE,EAAa,QAAU,IAAIvC,GAAUqC,EAAS,OAAO,EACrDE,EAAa,QAAQ,WAGrB1B,GAAU,SAAS,GAAGyC,EAAY,KAAK,gBAAgB,EAEhD,IAAM,CACPf,EAAa,UACfA,EAAa,QAAQ,aACrBA,EAAa,QAAU,KACzB,CAGH,GAACR,EAAQuB,EAAY,KAAK,CAAC,EAG9B/b,YAAU,IAAM,CACR,MAAAkb,EAAiB97C,GAAqB,CACrCo7C,GAEc5B,GAAA,aAAax5C,EAAG48C,CAAW,GAGhD,GAAIxB,EACO,iCAAiB,UAAWU,CAAa,EAC3C,IAAM,SAAS,oBAAoB,UAAWA,CAAa,CACpE,EACC,CAACV,CAAM,CAAC,EAGXxa,YAAU,IAAM,CACVtuB,GAAQ8oC,GAIMpa,GAAA,CAAE,OAAQ,UAAW,CACvC,EACC,CAAC1uB,EAAM8oC,CAAM,CAAC,EAGjB,MAAMwB,EAAc,IAAM,CAIR5b,GAAA,CAAE,OAAQ,SAAU,GAIhC6b,EAAqB,SAAY,CAKjC,IACF,KAAM,CAAE,MAAA/lE,CAAA,EAAU,MAAMwlE,IACpBxlE,GAEckqD,GAAA,CACd,OAAQ,QACR,OAAQlqD,EAAM,SAAW,wBAC1B,QAGIA,EAAO,CAEEkqD,GAAA,CACd,OAAQ,QACR,OAAQlqD,aAAiB,MAAQA,EAAM,QAAU,gBAClD,CACH,GAIIgmE,EAAwB,IAAM,CAIlCL,EAAoB,EAAI,GAGpBM,EAAoB,MAAO7oC,GAAkB,CAK7C,IACF,KAAM,CAAE,MAAAp9B,CAAU,QAAMylE,EAAoBroC,CAAK,EACjD,GAAIp9B,EAEF,MAAM,IAAI,MAAMA,EAAM,SAAW,sBAAsB,EAGvD2lE,EAAoB,EAAK,EACTzb,GAAA,CAAE,OAAQ,UAAW,QAEhClqD,EAAO,CAER,MAAAA,CACR,GAIF,GAAI,CAACskE,EAAe,YAEpB,MAAM4B,EAAY,CAACpC,EAGjB,OAAAsB,EAAA,KAAC,OACC,UAAU,0DACV,MAAO,CACL,cAAed,EAAS,OAAS,MACnC,EAGA,UAAAvZ,EAAA,IAAC,OACC,UAAU,gDACV,QAAS+a,CAAA,CACX,EAGAV,EAAA,KAAC,OACC,IAAKR,EACL,UAAU,2DACV,KAAK,SACL,aAAW,OACX,kBAAiB,GAAGG,CAAO,SAC3B,mBAAkB,GAAGA,CAAO,eAC5B,YAAU,SAGV,UAACK,OAAA,OAAI,UAAU,iEACb,UAAAA,OAAC,MACC,WAACra,MAAA,MAAG,GAAI,GAAGga,CAAO,SAAU,UAAU,sCACnC,WAAY,KACf,GACAha,MAAC,KAAE,GAAI,GAAGga,CAAO,eAAgB,UAAU,6BACxC,SAAAc,EAAY,WACf,IACF,EACA9a,EAAA,IAAC,UACC,QAAS+a,EACT,UAAU,uFACV,aAAW,cAEX,SAAA/a,MAACsX,GAAE,WAAU,SAAU,GACzB,GACF,QAGC,MAAI,WAAU,MACb,SAAC+C,EAAA,YAAI,UAAU,YAEb,UAAAA,EAAA,KAAC,UACC,IAAKQ,EACL,QAASG,EACT,SAAUG,EACV,UAAU,8NACV,UAAQ,mBACR,MAAM,yCAEN,UAACnb,MAAAsU,GAAA,CAAO,UAAU,SAAU,GAC3BwG,EAAY,YACf,EAGAT,OAAC,MAAI,WAAU,WACb,UAAAra,MAAC,OAAI,UAAU,qCACb,eAAC,MAAI,WAAU,kCAAkC,CACnD,GACAA,MAAC,OAAI,UAAU,uCACb,eAAC,OAAK,WAAU,8BAA8B,cAAE,CAClD,IACF,EAGAqa,EAAA,KAAC,UACC,QAASY,EACT,SAAUE,EACV,UAAU,sQACV,UAAQ,kBAER,UAACnb,MAAAyV,GAAA,CAAK,UAAU,SAAU,GACzBqF,EAAY,cACf,EAGCK,GACEnb,EAAA,WAAI,UAAU,mBACb,eAAC,IAAE,WAAU,4DAA4D,8DAEzE,CACF,IAEJ,CACF,GAGCA,MAAC,OAAI,UAAU,YACb,eAAC,IAAE,WAAU,oCAAoC,uFAEjD,CACF,IACF,EAGAA,EAAA,IAACsZ,GAAA,CACC,OAAQqB,EACR,QAAS,IAAMC,EAAoB,EAAK,EACxC,SAAUM,EACV,MAAM,sBACN,YAAY,qEACZ,YAAY,oBACd,IAGN,EAEAE,GAAeZ,GCvPb,IAACr8C,GAAE,CAAC,KAAK,EAAE,EAAEu8B,GAAEA,GAAG,CAAC,GAAa,OAAO,QAAjB,SAAwB,CAAC,IAAI,GAAGA,EAAEA,EAAE,cAAc,UAAU,EAAE,OAAO,UAAU,OAAO,OAAO,SAAS,cAAc,OAAO,EAAE,CAAC,UAAU,IAAI,GAAG,SAAS,CAAC,EAAE,OAAO,EAAE,MAAM,OAAO,UAAU,EAAE,aAAaA,GAAG,SAAS,MAAM,YAAY,CAAC,EAAE,EAAE,UAAU,CAAC,OAAOA,GAAGv8B,EAAC,EAAgD+mC,GAAE,oEAAoEptD,GAAE,qBAAqBxC,GAAE,OAAOk0D,GAAE,CAACrrC,EAAEu8B,IAAI,CAAC,IAAI18B,EAAE,GAAGknC,EAAE,GAAG,EAAE,GAAG,QAAQ5vD,KAAK6oB,EAAE,CAAC,IAAIzK,EAAEyK,EAAE7oB,CAAC,EAAOA,EAAE,CAAC,GAAR,IAAeA,EAAE,CAAC,GAAR,IAAU0oB,EAAE1oB,EAAE,IAAIoe,EAAE,IAAIwxC,GAAQ5vD,EAAE,CAAC,GAAR,IAAUk0D,GAAE91C,EAAEpe,CAAC,EAAEA,EAAE,IAAIk0D,GAAE91C,EAAOpe,EAAE,CAAC,GAAR,IAAU,GAAGolD,CAAC,EAAE,IAAc,OAAOhnC,GAAjB,SAAmBwxC,GAAGsE,GAAE91C,EAAEgnC,EAAEA,EAAE,QAAQ,WAAWv8B,GAAG7oB,EAAE,QAAQ,gCAAgColD,GAAG,IAAI,KAAKA,CAAC,EAAEA,EAAE,QAAQ,KAAKv8B,CAAC,EAAEA,EAAEA,EAAE,IAAIu8B,EAAEA,CAAC,CAAC,EAAEplD,CAAC,EAAQoe,GAAN,OAAUpe,EAAE,MAAM,KAAKA,CAAC,EAAEA,EAAEA,EAAE,QAAQ,SAAS,KAAK,EAAE,YAAW,EAAG,GAAGk0D,GAAE,EAAEA,GAAE,EAAEl0D,EAAEoe,CAAC,EAAEpe,EAAE,IAAIoe,EAAE,IAAI,CAAC,OAAOsK,GAAG08B,GAAG,EAAEA,EAAE,IAAI,EAAE,IAAI,GAAGwK,CAAC,EAAExxC,GAAE,GAAGjb,GAAE0lB,GAAG,CAAC,GAAa,OAAOA,GAAjB,SAAmB,CAAC,IAAIu8B,EAAE,GAAG,QAAQ18B,KAAKG,EAAEu8B,GAAG18B,EAAEvlB,GAAE0lB,EAAEH,CAAC,CAAC,EAAE,OAAO08B,CAAC,CAAC,OAAOv8B,CAAC,EAAE9nB,GAAE,CAAC8nB,EAAEu8B,EAAE18B,EAAE3nB,EAAE6pC,IAAI,CAAC,IAAIm7B,EAAE5iE,GAAE0lB,CAAC,EAAEm9C,EAAE5nD,GAAE2nD,CAAC,IAAI3nD,GAAE2nD,CAAC,GAAGl9C,GAAG,CAAC,IAAIu8B,EAAE,EAAE18B,EAAE,GAAG,KAAK08B,EAAEv8B,EAAE,QAAQH,EAAE,IAAIA,EAAEG,EAAE,WAAWu8B,GAAG,IAAI,EAAE,MAAM,KAAK18B,CAAC,GAAGq9C,CAAC,GAAG,GAAG,CAAC3nD,GAAE4nD,CAAC,EAAE,CAAC,IAAI5gB,EAAE2gB,IAAIl9C,EAAEA,GAAGA,GAAG,CAAC,IAAIu8B,EAAE18B,EAAEwrC,EAAE,CAAC,EAAE,EAAE,KAAK9O,EAAEwK,GAAE,KAAK/mC,EAAE,QAAQrmB,GAAE,EAAE,CAAC,GAAG4iD,EAAE,CAAC,EAAE8O,EAAE,MAAK,EAAG9O,EAAE,CAAC,GAAG18B,EAAE08B,EAAE,CAAC,EAAE,QAAQplD,GAAE,GAAG,EAAE,KAAI,EAAGk0D,EAAE,QAAQA,EAAE,CAAC,EAAExrC,CAAC,EAAEwrC,EAAE,CAAC,EAAExrC,CAAC,GAAG,CAAE,IAAGwrC,EAAE,CAAC,EAAE9O,EAAE,CAAC,CAAC,EAAEA,EAAE,CAAC,EAAE,QAAQplD,GAAE,GAAG,EAAE,KAAI,EAAG,OAAOk0D,EAAE,CAAC,CAAC,GAAGrrC,CAAC,EAAEzK,GAAE4nD,CAAC,EAAE9R,GAAEtpB,EAAE,CAAC,CAAC,cAAco7B,CAAC,EAAE5gB,CAAC,EAAEA,EAAE18B,EAAE,GAAG,IAAIs9C,CAAC,CAAC,CAAC,IAAIxjB,EAAE95B,GAAGtK,GAAE,EAAEA,GAAE,EAAE,KAAK,OAAOsK,IAAItK,GAAE,EAAEA,GAAE4nD,CAAC,IAAI,CAACn9C,EAAEu8B,EAAE18B,EAAEknC,IAAI,CAACA,EAAExK,EAAE,KAAKA,EAAE,KAAK,QAAQwK,EAAE/mC,CAAC,EAAOu8B,EAAE,KAAK,QAAQv8B,CAAC,IAArB,KAAyBu8B,EAAE,KAAK18B,EAAEG,EAAEu8B,EAAE,KAAKA,EAAE,KAAKv8B,EAAE,GAAGzK,GAAE4nD,CAAC,EAAE5gB,EAAErkD,EAAEyhD,CAAC,EAAEwjB,CAAC,EAAEp7B,GAAE,CAAC/hB,EAAEu8B,EAAE18B,IAAIG,EAAE,OAAO,CAACA,EAAE+mC,EAAEptD,IAAI,CAAC,IAAIxC,EAAEolD,EAAE5iD,CAAC,EAAE,GAAGxC,GAAGA,EAAE,KAAK,CAAC,IAAI6oB,EAAE7oB,EAAE0oB,CAAC,EAAE08B,EAAEv8B,GAAGA,EAAE,OAAOA,EAAE,MAAM,WAAW,MAAM,KAAKA,CAAC,GAAGA,EAAE7oB,EAAEolD,EAAE,IAAIA,EAAEv8B,GAAa,OAAOA,GAAjB,SAAmBA,EAAE,MAAM,GAAGqrC,GAAErrC,EAAE,EAAE,EAAOA,IAAL,GAAO,GAAGA,CAAC,CAAC,OAAOA,EAAE+mC,GAAS5vD,GAAE,GAAK,EAAE,EAAE,EAAE,SAAS+lE,GAAEl9C,EAAE,CAAC,IAAIH,EAAE,MAAM,GAAGknC,EAAE/mC,EAAE,KAAKA,EAAEH,EAAE,CAAC,EAAEG,EAAE,OAAO9nB,GAAE6uD,EAAE,QAAQA,EAAE,IAAIhlB,GAAEglB,EAAE,GAAG,MAAM,KAAK,UAAU,CAAC,EAAElnC,EAAE,CAAC,EAAEknC,EAAE,OAAO,CAAC/mC,EAAEu8B,IAAI,OAAO,OAAOv8B,EAAEu8B,GAAGA,EAAE,KAAKA,EAAE18B,EAAE,CAAC,EAAE08B,CAAC,EAAE,CAAE,GAAEwK,EAAExK,GAAE18B,EAAE,MAAM,EAAEA,EAAE,EAAEA,EAAE,EAAEA,EAAE,CAAC,CAAC,CAAI,IAACs9C,GAAExjB,GAAEyjB,GAAIF,GAAE,KAAK,CAAC,EAAE,CAAC,CAAC,EAAEx/C,OAAEw/C,GAAE,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,SAASppE,GAAEksB,EAAEu8B,EAAE18B,EAAEknC,EAAE,CAACsE,GAAE,EAAE9O,EAAE4gB,GAAEn9C,EAAE25B,GAAE95B,EAAEu9C,GAAErW,CAAC,CAAC,SAASsW,GAAEr9C,EAAEu8B,EAAE,CAAC,IAAI18B,EAAE,MAAM,GAAG,OAAO,UAAU,CAAC,IAAIknC,EAAE,UAAU,SAAS,EAAE5vD,EAAE,EAAE,CAAC,IAAIoe,EAAE,OAAO,OAAO,GAAGpe,CAAC,EAAEmD,EAAEib,EAAE,WAAW,EAAE,UAAUsK,EAAE,EAAE,OAAO,OAAO,CAAC,MAAM85B,IAAGA,IAAG,EAAEpkC,CAAC,EAAEsK,EAAE,EAAE,UAAU,KAAKvlB,CAAC,EAAEib,EAAE,UAAU2nD,GAAE,MAAMr9C,EAAEknC,CAAC,GAAGzsD,EAAE,IAAIA,EAAE,IAAIiiD,IAAIhnC,EAAE,IAAI,GAAG,IAAIrd,EAAE8nB,EAAE,OAAOA,EAAE,CAAC,IAAI9nB,EAAEqd,EAAE,IAAIyK,EAAE,OAAOzK,EAAE,IAAI6nD,IAAGllE,EAAE,CAAC,GAAGklE,GAAE7nD,CAAC,EAAE4nD,GAAEjlE,EAAEqd,CAAC,CAAC,CAAC,OAAOgnC,EAAEA,EAAE,CAAC,EAAE,CAAC,CAAC,CCC1uE,IAAI+gB,GAAEt9C,GAAG,OAAOA,GAAG,WAAWtC,GAAE,CAACsC,EAAEu8B,IAAI+gB,GAAEt9C,CAAC,EAAEA,EAAEu8B,CAAC,EAAEv8B,EAAMu9C,IAAG,IAAI,CAAC,IAAIv9C,EAAE,EAAE,MAAM,KAAK,EAAEA,GAAG,SAAQ,CAAE,GAAC,EAAIw9C,IAAG,IAAI,CAAC,IAAIx9C,EAAE,MAAM,IAAI,CAAC,GAAGA,IAAI,QAAQ,OAAO,OAAO,IAAI,CAAC,IAAIu8B,EAAE,WAAW,kCAAkC,EAAEv8B,EAAE,CAACu8B,GAAGA,EAAE,OAAO,CAAC,OAAOv8B,CAAC,CAAC,GAAI,EAAoEupC,GAAG,GAAGxnC,GAAE,UAAc07C,GAAE,CAACz9C,EAAEu8B,IAAI,CAAC,GAAG,CAAC,WAAW8O,CAAC,EAAErrC,EAAE,SAAS,OAAOu8B,EAAE,KAAM,KAAK,GAAE,MAAM,CAAC,GAAGv8B,EAAE,OAAO,CAACu8B,EAAE,MAAM,GAAGv8B,EAAE,MAAM,EAAE,MAAM,EAAEqrC,CAAC,CAAC,EAAE,IAAK,GAAE,MAAM,CAAC,GAAGrrC,EAAE,OAAOA,EAAE,OAAO,IAAIH,GAAGA,EAAE,KAAK08B,EAAE,MAAM,GAAG,CAAC,GAAG18B,EAAE,GAAG08B,EAAE,KAAK,EAAE18B,CAAC,CAAC,EAAE,IAAK,GAAE,GAAG,CAAC,MAAMvlB,CAAC,EAAEiiD,EAAE,OAAOkhB,GAAEz9C,EAAE,CAAC,KAAKA,EAAE,OAAO,KAAKH,GAAGA,EAAE,KAAKvlB,EAAE,EAAE,EAAE,EAAE,EAAE,MAAMA,CAAC,CAAC,EAAE,IAAK,GAAE,GAAG,CAAC,QAAQ,CAAC,EAAEiiD,EAAE,MAAM,CAAC,GAAGv8B,EAAE,OAAOA,EAAE,OAAO,IAAIH,GAAGA,EAAE,KAAK,GAAG,IAAI,OAAO,CAAC,GAAGA,EAAE,UAAU,GAAG,QAAQ,EAAE,EAAEA,CAAC,CAAC,EAAE,IAAK,GAAE,OAAO08B,EAAE,UAAU,OAAO,CAAC,GAAGv8B,EAAE,OAAO,EAAE,EAAE,CAAC,GAAGA,EAAE,OAAOA,EAAE,OAAO,OAAOH,GAAGA,EAAE,KAAK08B,EAAE,OAAO,CAAC,EAAE,IAAK,GAAE,MAAM,CAAC,GAAGv8B,EAAE,SAASu8B,EAAE,IAAI,EAAE,IAAK,GAAE,IAAI,EAAEA,EAAE,MAAMv8B,EAAE,UAAU,GAAG,MAAM,CAAC,GAAGA,EAAE,SAAS,OAAO,OAAOA,EAAE,OAAO,IAAIH,IAAI,CAAC,GAAGA,EAAE,cAAcA,EAAE,cAAc,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE/jB,GAAE,CAAE,EAAC2pD,GAAE,CAAC,OAAO,CAAE,EAAC,SAAS,OAAO,SAAS,CAAC,WAAW8D,EAAE,CAAC,EAAE5P,GAAE,CAAE,EAAC+jB,GAAE,CAAC19C,EAAEu8B,EAAEx6B,KAAI,CAAC43B,GAAE4C,CAAC,EAAEkhB,GAAE9jB,GAAE4C,CAAC,GAAGkJ,GAAEzlC,CAAC,EAAElkB,GAAE,QAAQ,CAAC,CAACuvD,EAAE/wD,CAAC,IAAI,CAAC+wD,IAAI9O,GAAGjiD,EAAEq/C,GAAE4C,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE1gD,GAAEmkB,GAAG,OAAO,KAAK25B,EAAC,EAAE,QAAQ4C,GAAGmhB,GAAE19C,EAAEu8B,CAAC,CAAC,EAAEohB,GAAE39C,GAAG,OAAO,KAAK25B,EAAC,EAAE,KAAK4C,GAAG5C,GAAE4C,CAAC,EAAE,OAAO,KAAK8O,GAAGA,EAAE,KAAKrrC,CAAC,CAAC,EAAE49C,GAAE,CAAC59C,EAAE+B,KAAIw6B,GAAG,CAACmhB,GAAEnhB,EAAEv8B,CAAC,CAAC,EAAE69C,GAAG,CAAC,MAAM,IAAI,MAAM,IAAI,QAAQ,IAAI,QAAQ,EAAE,EAAE,OAAO,GAAG,EAAEC,GAAE,CAAC99C,EAAE,GAAGu8B,EAAEx6B,KAAI,CAAC,GAAG,CAACspC,EAAE/wD,CAAC,EAAEyjE,EAAE,SAACpkB,GAAE4C,CAAC,GAAGkJ,EAAC,EAAE,EAAEuY,SAAGrkB,GAAE4C,CAAC,CAAC,EAAE0hB,EAAE,UAAC,KAAK,EAAE,UAAUtkB,GAAE4C,CAAC,GAAGjiD,EAAEq/C,GAAE4C,CAAC,CAAC,EAAEzgD,GAAE,KAAK,CAACygD,EAAEjiD,CAAC,CAAC,EAAE,IAAI,CAAC,IAAIulB,EAAE/jB,GAAE,UAAU,CAAC,CAAC,CAAC,IAAI,IAAIygD,CAAC,EAAE18B,EAAE,IAAI/jB,GAAE,OAAO+jB,EAAE,CAAC,CAAC,GAAG,CAAC08B,CAAC,CAAC,EAAE,IAAI,EAAE8O,EAAE,OAAO,IAAIxrC,GAAG,CAAC,IAAI,EAAEu9C,EAAEc,EAAE,MAAM,CAAC,GAAGl+C,EAAE,GAAGA,EAAEH,EAAE,IAAI,EAAE,GAAGA,EAAE,YAAYA,EAAE,eAAe,EAAEG,EAAEH,EAAE,IAAI,IAAI,KAAK,OAAO,EAAE,cAA8BG,GAAE,YAAa,SAASH,EAAE,YAAYu9C,EAAEp9C,EAAEH,EAAE,IAAI,IAAI,KAAK,OAAOu9C,EAAE,WAA2Bp9C,GAAE,UAAW69C,GAAGh+C,EAAE,IAAI,EAAE,MAAM,CAAC,GAAGG,EAAE,MAAM,IAAIk+C,EAAEl+C,EAAEH,EAAE,IAAI,IAAI,KAAK,OAAOq+C,EAAE,MAAM,GAAGr+C,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,GAAGwrC,EAAE,OAAO,CAAC,CAAC,EAAM8S,GAAG,CAACn+C,EAAEu8B,EAAE,QAAQ8O,KAAK,CAAC,UAAU,KAAK,IAAG,EAAG,QAAQ,GAAG,UAAU,GAAG,KAAK9O,EAAE,UAAU,CAAC,KAAK,SAAS,YAAY,QAAQ,EAAE,QAAQv8B,EAAE,cAAc,EAAE,GAAGqrC,EAAE,GAAmBA,GAAE,IAAKkS,GAAC,CAAE,GAAGa,GAAEp+C,GAAG,CAACu8B,EAAE8O,IAAI,CAAC,IAAI/wD,EAAE6jE,GAAG5hB,EAAEv8B,EAAEqrC,CAAC,EAAE,OAAOuS,GAAEtjE,EAAE,WAAWqjE,GAAErjE,EAAE,EAAE,CAAC,EAAE,CAAC,KAAK,EAAE,MAAMA,CAAC,CAAC,EAAEA,EAAE,EAAE,EAAEnD,GAAE,CAAC6oB,EAAEu8B,IAAI6hB,GAAE,OAAO,EAAEp+C,EAAEu8B,CAAC,EAAEplD,GAAE,MAAMinE,GAAE,OAAO,EAAEjnE,GAAE,QAAQinE,GAAE,SAAS,EAAEjnE,GAAE,QAAQinE,GAAE,SAAS,EAAEjnE,GAAE,OAAOinE,GAAE,QAAQ,EAAEjnE,GAAE,QAAQ,CAAC6oB,EAAEu8B,IAAI,CAAC,IAAI8O,EAAE,CAAC,KAAK,EAAE,QAAQrrC,CAAC,EAAEu8B,EAAEqhB,GAAErhB,CAAC,EAAE8O,CAAC,EAAExvD,GAAEwvD,CAAC,CAAC,EAAEl0D,GAAE,WAAW6oB,GAAG7oB,GAAE,QAAQ,OAAO6oB,CAAC,EAAE7oB,GAAE,OAAO,CAAC6oB,EAAEu8B,IAAI,CAAC,IAAI8O,EAAE,CAAC,KAAK,EAAE,QAAQrrC,CAAC,EAAEu8B,EAAEqhB,GAAErhB,CAAC,EAAE8O,CAAC,EAAExvD,GAAEwvD,CAAC,CAAC,EAAEl0D,GAAE,UAAU6oB,GAAG7oB,GAAE,OAAO,OAAO6oB,CAAC,EAAE7oB,GAAE,QAAQ,CAAC6oB,EAAEu8B,EAAE8O,IAAI,CAAC,IAAI/wD,EAAEnD,GAAE,QAAQolD,EAAE,QAAQ,CAAC,GAAG8O,EAAE,GAAkBA,GAAE,OAAO,CAAC,EAAE,OAAO,OAAOrrC,GAAG,aAAaA,EAAEA,EAAC,GAAIA,EAAE,KAAK,GAAG,CAAC,IAAI,EAAEu8B,EAAE,QAAQ7+B,GAAE6+B,EAAE,QAAQ,CAAC,EAAE,OAAO,OAAO,EAAEplD,GAAE,QAAQ,EAAE,CAAC,GAAGmD,EAAE,GAAG+wD,EAAE,GAAkBA,GAAE,OAAO,CAAC,EAAEl0D,GAAE,QAAQmD,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,GAAG,CAAC,IAAI,EAAEiiD,EAAE,MAAM7+B,GAAE6+B,EAAE,MAAM,CAAC,EAAE,OAAO,EAAEplD,GAAE,MAAM,EAAE,CAAC,GAAGmD,EAAE,GAAG+wD,EAAE,GAAkBA,GAAE,KAAK,CAAC,EAAEl0D,GAAE,QAAQmD,CAAC,CAAC,CAAC,EAAE0lB,CAAC,EAAkE,IAAIq+C,GAAG,IAAIhB,GAAE,CAACr9C,EAAEu8B,EAAE,YAAY,CAAC,GAAG,CAAC,OAAO8O,EAAE,SAAS/wD,CAAC,EAAEwjE,GAAE99C,EAAEu8B,CAAC,EAAE,EAAE+hB,SAAG,IAAI,GAAG,EAAE,QAAQ,EAAEC,cAAE,CAAChpD,EAAEzhB,EAAEuqE,KAAK,CAAC,GAAG,EAAE,IAAI9oD,CAAC,EAAE,OAAO,IAAI,EAAE,WAAW,IAAI,CAAC,EAAE,OAAOA,CAAC,EAAEsK,EAAE,CAAC,KAAK,EAAE,QAAQtK,CAAC,CAAC,CAAC,EAAEzhB,CAAC,EAAE,EAAE,IAAIyhB,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE4jD,EAAC,UAAC,IAAI,CAAC,GAAG7+D,EAAE,OAAO,IAAIib,EAAE,KAAK,IAAG,EAAGzhB,EAAEu3D,EAAE,IAAI,GAAG,CAAC,GAAG,EAAE,WAAW,EAAE,EAAE,OAAO,IAAImT,GAAG,EAAE,UAAU,GAAG,EAAE,eAAejpD,EAAE,EAAE,WAAW,GAAGipD,EAAE,EAAE,CAAC,EAAE,SAASrnE,GAAE,QAAQ,EAAE,EAAE,EAAE,MAAM,CAAC,OAAO,WAAW,IAAIA,GAAE,QAAQ,EAAE,GAAGolD,CAAC,EAAEiiB,CAAC,CAAC,CAAC,EAAE,MAAM,IAAI,CAAC1qE,EAAE,QAAQ,GAAG,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,EAAE,CAACu3D,EAAE/wD,EAAEiiD,CAAC,CAAC,EAAE,IAAI18B,EAAE0+C,cAAEX,GAAErhB,CAAC,EAAE,CAACA,CAAC,CAAC,EAAE,EAAEgiB,cAAE,IAAI,CAAC1+C,EAAE,CAAC,KAAK,EAAE,KAAK,KAAK,KAAK,CAAC,CAAC,EAAE,CAACA,CAAC,CAAC,EAAEu9C,EAAEmB,cAAE,CAAChpD,EAAEzhB,IAAI,CAAC+rB,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC,GAAGtK,EAAE,OAAOzhB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC+rB,CAAC,CAAC,EAAEq+C,EAAEK,cAAE,IAAI,CAACjkE,GAAGulB,EAAE,CAAC,KAAK,EAAE,KAAK,KAAK,IAAK,EAAC,CAAC,EAAE,CAACvlB,EAAEulB,CAAC,CAAC,EAAEs9C,EAAEoB,EAAC,YAAC,CAAChpD,EAAEzhB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,GAAG,OAAO0qE,EAAE,EAAE,gBAAgBC,CAAC,EAAE3qE,GAAG,CAAE,EAAC4qE,EAAErT,EAAE,OAAO6R,IAAIA,EAAE,UAAUuB,MAAMlpD,EAAE,UAAUkpD,IAAIvB,EAAE,MAAM,EAAEyB,EAAED,EAAE,UAAUxB,GAAGA,EAAE,KAAK3nD,EAAE,EAAE,EAAEqpD,EAAEF,EAAE,OAAO,CAACxB,EAAE2B,IAAIA,EAAEF,GAAGzB,EAAE,OAAO,EAAE,OAAO,OAAOwB,EAAE,OAAOxB,GAAGA,EAAE,OAAO,EAAE,MAAM,GAAG,EAAE,CAAC0B,EAAE,CAAC,EAAE,CAAC,EAAEA,CAAC,CAAC,EAAE,OAAO,CAAC1B,EAAE2B,IAAI3B,GAAG2B,EAAE,QAAQ,GAAGL,EAAE,CAAC,CAAC,EAAE,CAACnT,CAAC,CAAC,EAAE,OAAO8N,YAAE,IAAI,CAAC9N,EAAE,QAAQ91C,GAAG,CAAC,GAAGA,EAAE,UAAU,EAAEA,EAAE,GAAGA,EAAE,WAAW,MAAM,CAAC,IAAIzhB,EAAE,EAAE,IAAIyhB,EAAE,EAAE,EAAEzhB,IAAI,aAAaA,CAAC,EAAE,EAAE,OAAOyhB,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC81C,EAAE,CAAC,CAAC,EAAE,CAAC,OAAOA,EAAE,SAAS,CAAC,aAAa+R,EAAE,WAAW,EAAE,SAASc,EAAE,gBAAgBf,CAAC,CAAC,CAAC,EAAqM2B,GAAGC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAQ1jIC,GAAGD;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAQHE,GAAGF;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAQHG,GAAEC,GAAG,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKGn/C,GAAGA,EAAE,SAAS,SAAS;AAAA;AAAA;AAAA;AAAA,eAIxB8+C,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAOAE,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKDh/C,GAAGA,EAAE,WAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAQvBi/C,EAAE;AAAA;AAAA;AAAA;AAAA,EAIoCG,GAAGC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,EAOxDC,GAAEC,GAAG,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMMv/C,GAAGA,EAAE,WAAW,SAAS;AAAA,wBACnBA,GAAGA,EAAE,SAAS,SAAS;AAAA,eAChCo/C,EAAE;AAAA,EACqCI,GAAGC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAQtDC,GAAGD;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAcHE,GAAEC,GAAG,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKG5/C,GAAGA,EAAE,SAAS,SAAS;AAAA;AAAA;AAAA;AAAA,eAIxBw/C,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAMAE,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAMC1/C,GAAGA,EAAE,WAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpC6/C,GAAGC,GAAE,KAAK;AAAA;AAAA,EAEdC,GAAGD,GAAE,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOVE,GAAGC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAQFC,GAAGJ,GAAE,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,eAKEE,EAAE;AAAA;AAAA,EAEfG,GAAE,CAAC,CAAC,MAAMngD,CAAC,IAAI,CAAC,GAAG,CAAC,KAAKu8B,EAAE,KAAK8O,EAAE,UAAU/wD,CAAC,EAAE0lB,EAAE,OAAOu8B,IAAI,OAAO,OAAOA,GAAG,SAAS6jB,gBAAgBF,GAAG,KAAK3jB,CAAC,EAAEA,EAAE8O,IAAI,QAAQ,KAAK+U,gBAAgBL,GAAG,KAAKK,EAAe,cAACd,GAAE,CAAC,GAAGhlE,CAAC,CAAC,EAAE+wD,IAAI,WAAW+U,EAAe,cAACP,GAAG,KAAKxU,IAAI,QAAQ+U,gBAAgBlB,GAAE,CAAC,GAAG5kE,CAAC,CAAC,EAAE8lE,gBAAgBT,GAAE,CAAC,GAAGrlE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAM+lE,GAAGrgD,GAAG;AAAA,+BAC7QA,EAAE,IAAI;AAAA;AAAA,EAEnCsgD,GAAGtgD,GAAG;AAAA;AAAA,iCAEyBA,EAAE,IAAI;AAAA,EACrCugD,GAAG,kCAAkCC,GAAG,kCAAkCC,GAAGC,GAAE,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYpFC,GAAGD,GAAE,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOVE,GAAG,CAAC5gD,EAAEu8B,IAAI,CAAC,IAAIjiD,EAAE0lB,EAAE,SAAS,KAAK,EAAE,EAAE,GAAG,CAACrmB,EAAEzB,CAAC,EAAEslE,GAAG,EAAC,CAAC+C,GAAGC,EAAE,EAAE,CAACH,GAAG/lE,CAAC,EAAEgmE,GAAGhmE,CAAC,CAAC,EAAE,MAAM,CAAC,UAAUiiD,EAAE,GAAGskB,GAAElnE,CAAC,CAAC,+CAA+C,GAAGknE,GAAE3oE,CAAC,CAAC,4CAA4C,CAAC,EAAE4oE,GAAEC,OAAO,CAAC,CAAC,MAAM/gD,EAAE,SAASu8B,EAAE,MAAM8O,EAAE,SAAS/wD,CAAC,IAAI,CAAC,IAAI,EAAE0lB,EAAE,OAAO4gD,GAAG5gD,EAAE,UAAUu8B,GAAG,aAAav8B,EAAE,OAAO,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAEghD,gBAAgBb,GAAE,CAAC,MAAMngD,CAAC,CAAC,EAAEH,EAAEmhD,EAAe,cAACL,GAAG,CAAC,GAAG3gD,EAAE,SAAS,EAAEtC,GAAEsC,EAAE,QAAQA,CAAC,CAAC,EAAE,OAAOghD,EAAe,cAACP,GAAG,CAAC,UAAUzgD,EAAE,UAAU,MAAM,CAAC,GAAG,EAAE,GAAGqrC,EAAE,GAAGrrC,EAAE,KAAK,CAAC,EAAE,OAAO1lB,GAAG,WAAWA,EAAE,CAAC,KAAK,EAAE,QAAQulB,CAAC,CAAC,EAAEmhD,EAAe,cAACC,EAAU,SAAC,KAAK,EAAEphD,CAAC,CAAC,CAAC,CAAC,EAAoEqhD,GAAGC,EAAe,eAAE,IAAIC,GAAG,CAAC,CAAC,GAAGphD,EAAE,UAAUu8B,EAAE,MAAM8O,EAAE,eAAe/wD,EAAE,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE+mE,cAAcxhD,GAAG,CAAC,GAAGA,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,IAAIu9C,EAAEv9C,EAAE,sBAAuB,EAAC,OAAOvlB,EAAE0lB,EAAEo9C,CAAC,CAAC,EAAE,EAAG,EAAC,IAAI,iBAAiB,CAAC,EAAE,QAAQv9C,EAAE,CAAC,QAAQ,GAAG,UAAU,GAAG,cAAc,EAAE,CAAC,CAAC,CAAC,EAAE,CAACG,EAAE1lB,CAAC,CAAC,EAAE,OAAO6mE,gBAAgB,MAAM,CAAC,IAAI,EAAE,UAAU5kB,EAAE,MAAM8O,CAAC,EAAE,CAAC,CAAC,EAAEiW,GAAG,CAACthD,EAAEu8B,IAAI,CAAC,IAAI8O,EAAErrC,EAAE,SAAS,KAAK,EAAE1lB,EAAE+wD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAErrC,EAAE,SAAS,QAAQ,EAAE,CAAC,eAAe,QAAQ,EAAEA,EAAE,SAAS,OAAO,EAAE,CAAC,eAAe,UAAU,EAAE,GAAG,MAAM,CAAC,KAAK,EAAE,MAAM,EAAE,QAAQ,OAAO,SAAS,WAAW,WAAWw9C,GAAC,EAAG,OAAO,yCAAyC,UAAU,cAAcjhB,GAAG8O,EAAE,EAAE,GAAG,MAAM,GAAG/wD,EAAE,GAAG,CAAC,CAAC,EAAEinE,GAAG3sD;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,EAK7wC4sD,GAAE,GAAGC,GAAG,CAAC,CAAC,aAAazhD,EAAE,SAASu8B,EAAE,aAAa,aAAa8O,EAAE,OAAO/wD,EAAE,SAAS,EAAE,UAAU,EAAE,eAAeulB,EAAE,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC,OAAOu9C,EAAE,SAASc,CAAC,EAAEb,GAAEhS,EAAE,CAAC,EAAE,OAAO8V,gBAAgB,MAAM,CAAC,mBAAmB,GAAG,GAAG,MAAM,CAAC,SAAS,QAAQ,OAAO,KAAK,IAAIK,GAAE,KAAKA,GAAE,MAAMA,GAAE,OAAOA,GAAE,cAAc,OAAO,GAAG3hD,CAAC,EAAE,UAAU,EAAE,aAAaq+C,EAAE,WAAW,aAAaA,EAAE,QAAQ,EAAEd,EAAE,IAAID,GAAG,CAAC,IAAI5nD,EAAE4nD,EAAE,UAAU5gB,EAAEzoD,EAAEoqE,EAAE,gBAAgBf,EAAE,CAAC,aAAan9C,EAAE,OAAO1lB,EAAE,gBAAgBiiD,CAAC,CAAC,EAAE,EAAE+kB,GAAG/rD,EAAEzhB,CAAC,EAAE,OAAOqtE,gBAAgBC,GAAG,CAAC,GAAGjE,EAAE,GAAG,IAAIA,EAAE,GAAG,eAAee,EAAE,aAAa,UAAUf,EAAE,QAAQoE,GAAG,GAAG,MAAM,CAAC,EAAEpE,EAAE,OAAO,SAASz/C,GAAEy/C,EAAE,QAAQA,CAAC,EAAE,EAAE,EAAEA,CAAC,EAAEgE,gBAAgBL,GAAE,CAAC,MAAM3D,EAAE,SAAS5nD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAMmsD,EAAGvqE,GCxKnrB,MAAMwqE,GAAN,MAAMA,EAAc,CAUV,aAAc,CARdrI,GAAA,2BAAkD,KAClDA,GAAA,oBAAuB,IACvBA,GAAA,qBAA+B,MAC/BA,GAAA,oBAAwB,IACxBA,GAAA,sBAAgC,MAChCA,GAAA,yBAA8B,IAC9BA,GAAA,wBAA4B,IAI9B,OAAO,OAAW,MACf,kBAAe,OAAO,SAAS,SAE/B,uBAAoB,CAAC,KAAK,YAAY,EAC3C,KAAK,yBAAyB,EAElC,CAEA,OAAO,aAA6B,CAC9B,OAACqI,GAAc,WACHA,GAAA,SAAW,IAAIA,IAExBA,GAAc,QACvB,CAEQ,0BAAiC,CAKhC,wBAAiB,WAAY,IAAM,CAExC,KAAK,aAAe,GACpB,KAAK,iBAAmB,GAGlB,MAAA/vD,EAAc,OAAO,SAAS,SAChC,KAAK,kBAAkB,OAAS,GAE9B,KAAK,kBAAkB,KAAK,kBAAkB,OAAS,CAAC,IAAM,KAAK,cACrE,KAAK,kBAAkB,MAI3B,WAAW,IAAM,CACf,KAAK,sBAAsBA,CAAW,EACtC,KAAK,aAAeA,EACpB,KAAK,aAAe,GACpB,KAAK,iBAAmB,IACvB,GAAG,EACP,EAGM,wBAAiB,eAAgB,IAAM,CAC5C,KAAK,0BAA0B,EAChC,CACH,CAEQ,kBAAkBgwD,EAAmBC,EAAuB,CAElE,GAAID,IAAcC,EAAS,CACzB,KAAK,mBAAmBD,CAAS,EAG3B,MAAAE,EAAY,KAAK,kBAAkB,OAAS,GAChC,KAAK,kBAAkB,KAAK,kBAAkB,OAAS,CAAC,IAAMD,EAG3EC,EASH,KAAK,kBAAkB,OAPlB,uBAAkB,KAAKD,CAAO,EAE/B,KAAK,kBAAkB,OAAS,IAClC,KAAK,kBAAkB,SAO3B,KAAK,aAAeA,EACpB,KAAK,iBAAmBC,EAEpBA,EAEF,KAAK,sBAAsBD,CAAO,EAGlC,KAAK,YAAY,CAAE,SAAU,UAAW,MAAO,GAAI,CAEvD,CACF,CAEQ,sBAAsBnpE,EAAqB,CAC7C,KAAK,gBACP,aAAa,KAAK,cAAc,EAI7B,oBAAiB,OAAO,WAAW,IAAM,CACxC,CAAC,KAAK,cAAgB,KAAK,kBAC7B,KAAK,sBAAsBA,CAAK,GAEjC,GAAG,CACR,CAEA,mBAAmBA,EAAsB,CACjC,MAAAqpE,EAAWrpE,GAAS,KAAK,aACzBspE,EAAU,KAAK,2BAEjBA,EAAU,IACP,qBAAgB,IAAID,EAAU,CACjC,QAAAC,EACA,UAAW,KAAK,IAAI,EACpB,MAAOD,CAAA,CACR,CAGL,CAEA,2BAAkC,CAC3B,wBAAmB,KAAK,YAAY,CAC3C,CAEA,sBAAsBrpE,EAAwB,CAC5C,MAAMkR,EAAU,KAAK,gBAAgB,IAAIlR,CAAK,EAE9C,OAAKkR,EAMY,KAAK,MAAQA,EAAQ,UAAY,GAAK,GAAK,KAUvD,sBAAiBA,EAAQ,QAAS,QAAQ,EACxC,KARA,qBAAgB,OAAOlR,CAAK,EAC1B,IARA,EAgBX,CAEQ,0BAAmC,CACzC,OAAO,OAAO,aACP,SAAS,gBAAgB,WACzB,SAAS,KAAK,WACd,CACT,CAEQ,iBAAiBspE,EAAiBC,EAAiC,SAAgB,CAEzF,MAAMC,EAAc,IAAM,CAEpB,SAAS,mBACX,SAAS,iBAAiB,UAAYF,GAExC,SAAS,gBAAgB,UAAYA,EACrC,SAAS,KAAK,UAAYA,EAGtB,IACF,OAAO,SAAS,CACd,IAAKA,EACL,KAAM,EACN,SAAUC,IAAa,UAAY,UAAY,SAChD,OACK,CACC,gBAAS,EAAGD,CAAO,CAC5B,GAIF,GAAIC,IAAa,UAAW,CACdC,IAEZ,sBAAsB,IAAM,CACdA,GAAA,CACb,EACD,MACF,CAGI,IACF,OAAO,SAAS,CACd,IAAKF,EACL,KAAM,EACN,SAAU,SACX,EAGD,WAAW,IAAM,CACT,MAAAG,EAAa,KAAK,2BACpB,KAAK,IAAIA,EAAaH,CAAO,EAAI,KACvBE,KAEb,GAAG,OACA,CACMA,GACd,CACF,CAGA,YAAY/tE,EAA+D,GAAU,CACnF,KAAM,CAAE,SAAA8tE,EAAW,SAAU,MAAA3X,EAAQ,GAAMn2D,EAQ3C,GALI,KAAK,eACA,oBAAa,KAAK,aAAa,EAIpC8tE,IAAa,UAAW,CAErB,sBAAiB,EAAG,SAAS,EAG9B3X,EAAQ,IACL,mBAAgB,OAAO,WAAW,IAAM,CACtC,sBAAiB,EAAG,SAAS,EAClC,KAAK,cAAgB,MACpBA,CAAK,GAIV,OAAO,WAAW,IAAM,CACjB,sBAAiB,EAAG,SAAS,GACjC,GAAG,EAEN,MACF,CAEK,mBAAgB,OAAO,WAAW,IAAM,CACtC,sBAAiB,EAAG2X,CAAQ,EACjC,KAAK,cAAgB,MACpB3X,CAAK,CACV,CAEA,gBAAgB8X,EAAmBjuE,EAAgE,GAAU,CAC3G,KAAM,CAAE,SAAA8tE,EAAW,SAAU,OAAAjnD,EAAS,GAAM7mB,EAGxC,KAAK,eACA,oBAAa,KAAK,aAAa,EAGnC,mBAAgB,OAAO,WAAW,IAAM,CACrC,MAAA6Q,EAAU,SAAS,eAAeo9D,CAAS,EACjD,GAAIp9D,EAAS,CACL,MAAAq9D,EAAkBr9D,EAAQ,UAAYgW,EACvC,sBAAiBqnD,EAAiBJ,CAAQ,CACjD,CACA,KAAK,cAAgB,MACpB,EAAE,CACP,CAGA,mBAA0B,CAClB,MAAA/jC,EAAM,KAAK,MACXokC,EAAa,GAAK,GAAK,IAE7B,SAAW,CAAC5pE,EAAOkR,CAAO,IAAK,KAAK,gBAAgB,UAC9Cs0B,EAAMt0B,EAAQ,UAAY04D,GACvB,qBAAgB,OAAO5pE,CAAK,CAIvC,CAGA,6BAAoC,CAClC,KAAK,aAAe,GACpB,KAAK,iBAAmB,GACxB,WAAW,IAAM,CACf,KAAK,aAAe,IACnB,GAAG,CACR,CAGA,sBAA6B,CAC3B,KAAK,iBAAmB,EAC1B,CAGA,uBAAuBkpE,EAAmBC,EAAuB,CAE/D,KAAK,mBAAmBD,CAAS,EAG3B,MAAAE,EAAY,KAAK,kBAAkB,OAAS,GAChC,KAAK,kBAAkB,KAAK,kBAAkB,OAAS,CAAC,IAAMD,EAG3EC,EASH,KAAK,kBAAkB,OAPlB,uBAAkB,KAAKD,CAAO,EAE/B,KAAK,kBAAkB,OAAS,IAClC,KAAK,kBAAkB,SAO3B,KAAK,aAAeA,EACpB,KAAK,iBAAmBC,EAEpBA,EAEF,WAAW,IAAM,CACf,KAAK,sBAAsBD,CAAO,GACjC,GAAG,GAID,sBAAiB,EAAG,SAAS,EAElC,KAAK,YAAY,CAAE,SAAU,UAAW,MAAO,GAAI,EAEvD,CAGA,cAAuB,CACd,OACL,aAAc,KAAK,aACnB,eAAgB,MAAM,KAAK,KAAK,gBAAgB,SAAS,EAAE,IAAI,CAAC,CAACnpE,EAAOkR,CAAO,KAAO,CACpF,MAAAlR,EACA,QAASkR,EAAQ,QACjB,IAAK,KAAK,IAAI,EAAIA,EAAQ,WAC1B,EACF,aAAc,KAAK,aAEvB,CAEA,SAAgB,CACV,KAAK,eACA,oBAAa,KAAK,aAAa,EAEpC,KAAK,gBACA,oBAAa,KAAK,cAAc,EAEzC,KAAK,gBAAgB,OACvB,CACF,EA7VE0vD,GADIqI,GACW,YADjB,IAAMY,GAANZ,GAiWA,MAAMa,GAAgBD,GAAc,cAGvBE,GAAetuE,GAAkE,CAC5FquE,GAAc,YAAYruE,CAAO,CACnC,EAMauuE,GAAsBhqE,GAAmB,CACpD8pE,GAAc,mBAAmB9pE,CAAK,CACxC,EAMaiqE,GAA8B,IAAM,CAC/CH,GAAc,4BAA4B,CAC5C,EAEaI,GAAyB,CAAChB,EAAmBC,IAAoB,CAC9DW,GAAA,uBAAuBZ,EAAWC,CAAO,CACzD,EAkBA,YAAY,IAAM,CAChBW,GAAc,kBAAkB,CAClC,EAAG,EAAI,GAAK,GAAI,EC7YhB,MAAMK,GAA4C,CAAC,CACjD,KAAA57D,EACA,QAAAhS,EACA,SAAA6tE,EAAW,IACX,QAAAliD,EACA,KAAAmiD,EAAO,EACT,IAAM,CACJ,KAAM,CAACC,EAAWC,CAAY,EAAItiB,WAASoiB,CAAI,EAiB/C,GAfAniB,YAAU,IAAM,CACdqiB,EAAaF,CAAI,GAChB,CAACA,CAAI,CAAC,EAETniB,YAAU,IAAM,CACV,GAAAoiB,GAAaF,EAAW,EAAG,CACvB,MAAA5/C,EAAQ,WAAW,IAAM,CAC7B+/C,EAAa,EAAK,EACRriD,OACTkiD,CAAQ,EAEJ,UAAM,aAAa5/C,CAAK,CACjC,CACC,GAAC8/C,EAAWF,EAAUliD,CAAO,CAAC,EAE7B,CAACoiD,EAAkB,YAEvB,MAAME,EAAU,IAAM,CACpB,OAAQj8D,EAAM,CACZ,IAAK,UAED,OAAA46C,EAAA,IAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,QAAQ,YACpE,SAACA,MAAA,QAAK,cAAc,QAAQ,eAAe,QAAQ,YAAa,EAAG,EAAE,gBAAiB,EACxF,GAEJ,IAAK,QAED,OAAAA,EAAA,IAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,QAAQ,YACpE,SAACA,MAAA,QAAK,cAAc,QAAQ,eAAe,QAAQ,YAAa,EAAG,EAAE,sBAAuB,EAC9F,GAEJ,IAAK,UAED,OAAAA,EAAA,IAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,QAAQ,YACpE,SAACA,MAAA,QAAK,cAAc,QAAQ,eAAe,QAAQ,YAAa,EAAG,EAAE,2IAA4I,EACnN,GAEJ,IAAK,OAED,OAAAA,EAAA,IAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,QAAQ,YACpE,SAACA,MAAA,QAAK,cAAc,QAAQ,eAAe,QAAQ,YAAa,EAAG,EAAE,2DAA4D,EACnI,EAEN,GAGIshB,EAAY,IAAM,CACtB,MAAMC,EAAa,CACjB,SAAU,QACV,IAAK,OACL,MAAO,OACP,OAAQ,KACR,QAAS,YACT,aAAc,OACd,UAAW,kCACX,QAAS,OACT,WAAY,SACZ,IAAK,OACL,SAAU,QACV,SAAU,QACV,UAAW,wBACX,OAAQ,YACR,eAAgB,aAChB,SAAU,OACV,WAAY,MACZ,WAAY,qEAGd,OAAQn8D,EAAM,CACZ,IAAK,UACI,OACL,GAAGm8D,EACH,gBAAiB,2BACjB,MAAO,QACP,YAAa,2BAEjB,IAAK,QACI,OACL,GAAGA,EACH,gBAAiB,0BACjB,MAAO,QACP,YAAa,0BAEjB,IAAK,UACI,OACL,GAAGA,EACH,gBAAiB,2BACjB,MAAO,QACP,YAAa,2BAEjB,IAAK,OACI,OACL,GAAGA,EACH,gBAAiB,2BACjB,MAAO,QACP,YAAa,0BAEnB,GAGF,OAEIlH,EAAA,KAAAC,WAAA,WAAAta,MAAC,QACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAuBH,EACCqa,OAAA,OAAI,MAAOiH,EAAA,EACV,UAAAthB,MAAC,OAAI,MAAO,CAAE,WAAY,GACvB,aACH,QACC,MAAI,OAAO,CAAE,KAAM,GACjB,SACH5sD,EAAA,GAEF,CACF,GAEJ,EAEAouE,GAAeR,GC3JTS,GAAoE,CACxE,QAAS,UACT,MAAO,QACP,QAAS,UACT,KAAM,OACN,mBAAoB,UACpB,OAAQ,UACR,QAAS,OACT,aAAc,UACd,KAAM,OACN,OAAQ,OACR,iBAAkB,UAClB,qBAAsB,SACxB,EAEMC,GAAkC,IAAM,CAC5C,KAAM,CAAE,OAAAC,EAAQ,YAAAC,CAAY,EAAIznB,GAAqB,EAErD,OAEK6F,MAAAsa,WAAA,UAAAqH,EAAO,IAAKlnB,GACXuF,EAAA,IAACghB,GAAA,CAEC,KAAMS,GAAQhnB,EAAM,IAAI,GAAK,OAC7B,QAASA,EAAM,QACf,SAAUA,EAAM,SAChB,QAAS,IAAMmnB,EAAYnnB,EAAM,EAAE,EACnC,KAAM,IALDA,EAAM,EAOd,EACH,EAEJ,EAEAonB,GAAeH,GC7BFI,GAAN,MAAMA,EAAW,CAKd,aAAc,CAHdrK,GAAA,sBAAkD,MAClDA,GAAA,mBAAc,IAGpB,KAAK,KAAK,CACZ,CAEA,OAAc,aAA0B,CAClC,OAACqK,GAAW,WACHA,GAAA,SAAW,IAAIA,IAErBA,GAAW,QACpB,CAEQ,MAAO,CAIb,GADiBlhC,GAAU,mBACb,CAER,kBAAmB,WAErB,UAAU,cAAc,iBAAmB,OAAMmhC,GAAkB,CACnDA,EAAA,QAASC,GAAiB,CAEtCA,EAAa,WAAW,EACzB,EACF,EAAE,MAAO9+C,GAAQ,EAEjB,EAEH,MACF,CAqBA,KAAK,sBAAsB,EAG3B,KAAK,mBAAmB,EAGxB,KAAK,mBAAmB,CAC1B,CAEA,MAAc,uBAAwB,CACpC,GAAI,kBAAmB,UACjB,IACF,MAAM8+C,EAAe,MAAM,UAAU,cAAc,SAAS,QAAQ,EAIvDA,EAAA,iBAAiB,cAAe,IAAM,CACjD,MAAMC,EAAYD,EAAa,WAC3BC,GACQA,EAAA,iBAAiB,cAAe,IAAM,CAC1CA,EAAU,QAAU,aAAe,UAAU,cAAc,YAE7D,KAAK,oBAAoB,CAC3B,CACD,CACH,CACD,OACa,CAEhB,CAEJ,CAEQ,oBAAqB,CAEtB,iBAAc,OAAO,WAAW,4BAA4B,EAAE,SACjD,OAAO,UAAkB,aAAe,EAC5D,CAEQ,oBAAqB,CACpB,wBAAiB,sBAAwB,GAAM,CACpD,EAAE,eAAe,EACjB,KAAK,eAAiB,EAGf,qBAAc,IAAI,YAAY,kBAAmB,CACtD,OAAQ,CAAE,WAAY,EAAK,CAC5B,EAAC,EACH,EAEM,wBAAiB,eAAgB,IAAM,CAC5C,KAAK,YAAc,GACnB,KAAK,eAAiB,KAGtB,KAAK,kBAAkB,EAGvB,OAAO,cAAc,IAAI,YAAY,eAAe,CAAC,EACtD,CACH,CAEA,MAAa,eAAkC,CACzC,IAAC,KAAK,eACD,SAGL,IACI,WAAK,eAAe,SACpB,MAAAC,EAAe,MAAM,KAAK,eAAe,WAE/C,YAAK,eAAiB,KAEfA,EAAa,UAAY,gBAClB,CAEP,QACT,CACF,CAEO,YAAsB,CAC3B,MAAO,CAAC,CAAC,KAAK,gBAAkB,CAAC,KAAK,WACxC,CAEO,gBAA0B,CAC/B,OAAO,KAAK,WACd,CAEO,aAAuB,CACrB,yBAAmB,KAAK,UAAU,SAAS,CACpD,CAEO,iBAA2B,CACzB,gBAAU,KAAK,UAAU,SAAS,CAC3C,CAEQ,qBAAsB,CAEtB,MAAAC,EAAc,IAAI,YAAY,uBAAwB,CAC1D,OAAQ,CACN,QAAS,+DACT,OAAQ,IAAM,OAAO,SAAS,OAAO,CACvC,EACD,EACD,OAAO,cAAcA,CAAW,CAClC,CAEQ,mBAAoB,CAEtB,OAAO,OAAW,KAAe,OAAO,MACnC,YAAK,QAAS,cAAe,CAClC,eAAgB,aAChB,YAAa,cACd,CAEL,CAGA,MAAa,+BAAkD,CACzD,MAAE,iBAAkB,OAIpB,aAAa,aAAe,UACvB,GAGL,aAAa,aAAe,SACvB,GAGU,MAAM,aAAa,sBAChB,UAZb,EAaX,CAGA,MAAa,8BAAiE,CACxE,IACI,MAAAH,EAAe,MAAM,UAAU,cAAc,MAG7CI,EAAuB,MAAMJ,EAAa,YAAY,gBAAgB,EAC5E,GAAII,EACK,OAAAA,EAIT,MAAM/mC,EAAe,MAAM2mC,EAAa,YAAY,UAAU,CAC5D,gBAAiB,GACjB,qBAAsB,KAAK,sBACzBxvB,IAAoB,EACtB,EACD,EAGK,kBAAK,yBAAyBnX,CAAY,EAEzCA,OACO,CAEP,WACT,CACF,CAEQ,sBAAsB6G,EAAkC,CAC9D,MAAMmgC,EAAU,IAAI,QAAQ,EAAIngC,EAAa,OAAS,GAAK,CAAC,EACtDsI,GAAUtI,EAAemgC,GAC5B,QAAQ,KAAM,GAAG,EACjB,QAAQ,KAAM,GAAG,EAEdC,EAAU,OAAO,KAAK93B,CAAM,EAC5B+3B,EAAc,IAAI,WAAWD,EAAQ,MAAM,EAEjD,QAASjsE,EAAI,EAAGA,EAAIisE,EAAQ,OAAQ,EAAEjsE,EAAG,CACjC,MAAAu1B,EAAW02C,EAAQ,WAAWjsE,CAAC,EACrCksE,EAAYlsE,CAAC,EAAIu1B,CACnB,CACO,OAAA22C,CACT,CAEA,MAAc,yBAAyBlnC,EAA+C,CAChF,IACF,MAAMmnC,EAAUvvB,KACV,YAAM,GAAGuvB,CAAO,+BAAgC,CACpD,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAUnnC,CAAY,EAClC,OACa,CAEhB,CACF,CACF,EAxPEo8B,GADWqK,GACI,YADV,IAAMW,GAANX,GA4PM,MAAAY,GAAaD,GAAW,YAAY,ECjQ3CE,GAA6B,IAAM,CACvC,KAAM,CAACC,EAAYC,CAAa,EAAI/jB,WAAS,EAAK,EAC5C,CAACgkB,EAAYC,CAAa,EAAIjkB,WAAS,EAAK,EAElDC,YAAU,IAAM,CAEd,MAAMikB,EAAqB,IAAM,CAC3B,GAAAN,GAAW,iBAAkB,CAC/BG,EAAc,EAAK,EACnB,MACF,CAEMI,QAAQP,GAAW,cACnBQ,EAAY,aAAa,QAAQD,EAAQ,wBAA0B,sBAAsB,EACzFE,EAAgBD,EAAY,SAASA,CAAS,EAAI,EAClDE,GAAuB,KAAK,MAAQD,IAAkB,GAAK,GAAK,GAAK,KAIrEE,EAAa,CAACH,GAAaE,GADXH,EAAQ,EAAI,GAI5BK,EAAmB,eAAe,QAAQ,8BAA8B,EAE1ED,GAAc,CAACC,IACbL,EAEF,WAAW,IAAMJ,EAAc,EAAI,EAAG,GAAI,EAG5BE,EAAAL,GAAW,YAAY,EAEzC,EAIIa,EAAoB,IAAM,CAC9BR,EAAc,EAAI,EACb,aAAa,QAAQ,sBAAsB,GAC9CF,EAAc,EAAI,CACpB,EAGIW,EAAkB,IAAM,CAC5BX,EAAc,EAAK,EACnBE,EAAc,EAAK,GAGd,+BAAiB,kBAAmBQ,CAAiB,EACrD,wBAAiB,gBAAiBC,CAAe,EAErCR,IAEZ,IAAM,CACJ,2BAAoB,kBAAmBO,CAAiB,EACxD,2BAAoB,gBAAiBC,CAAe,EAE/D,EAAG,CAAE,GAEL,MAAMC,EAAqB,SAAY,CACvBf,GAAW,eAIvB,OAAO,cAAc,IAAI,YAAY,kBAAkB,CAAC,EACxDG,EAAc,EAAK,IAGD,MAAMH,GAAW,iBAGjC,aAAa,QAAQ,uBAAwB,KAAK,IAAI,EAAE,UAAU,EAEpEG,EAAc,EAAK,EACrB,EAGIa,EAAgB,IAAM,CAC1Bb,EAAc,EAAK,EACnB,MAAMzzC,EAAaszC,GAAW,YAAY,EAAI,wBAA0B,uBACxE,aAAa,QAAQtzC,EAAY,KAAK,IAAI,EAAE,UAAU,EAEvC,uBAAQ,+BAAgC,MAAM,GAG/D,GAAI,CAACwzC,EACI,YAGH,MAAAK,EAAQP,GAAW,cAEzB,aACG,MAAI,WAAU,8IACb,SAACrI,EAAA,YAAI,UAAU,+DACb,UAACA,OAAA,OAAI,UAAU,8BACb,UAAAra,MAAC,OAAI,UAAU,8CACb,eAACwW,GAAW,WAAU,UAAU,CAClC,GACA6D,OAAC,MAAI,WAAU,SACb,UAAAra,MAAC,IAAE,WAAU,wBACV,SAAAijB,EAAQ,qBAAuB,qBAClC,QACC,IAAE,WAAU,yBACV,SAAAA,EACG,wCACA,kDAEN,GACF,GACF,EAEA5I,OAAC,MAAI,WAAU,8BACb,UAAAA,EAAA,KAAC,UACC,QAASoJ,EACT,UAAU,gKAEV,UAACzjB,MAAA4U,GAAA,CAAS,UAAU,SAAU,GAC7B5U,EAAA,YAAM,SAAQijB,EAAA,SAAW,UAAU,GACtC,EAEAjjB,EAAA,IAAC,UACC,QAAS0jB,EACT,UAAU,gEACV,aAAW,yBAEX,SAAA1jB,MAACsX,GAAE,WAAU,SAAU,GACzB,GACF,EACF,EACF,EAEJ,EAEAqM,GAAehB,GCjITiB,GAAkD,CAAC,CAAE,OAAArK,EAAQ,QAAAx6C,KAC5Dw6C,EAGHvZ,EAAA,IAAC,OACC,UAAU,6EACV,QAASjhC,EACT,MAAO,CAAE,OAAQ,GAAM,EAGvB,SAAAihC,EAAA,IAAC,MAAI,WAAU,oDACb,SAAAqa,EAAA,KAAC,OACC,UAAU,4HACV,QAAUl8C,GAAMA,EAAE,gBAAgB,EAClC,MAAO,CAAE,OAAQ,KAAM,EAGvB,UAACk8C,OAAA,OAAI,UAAU,kHACb,UAAAra,EAAA,IAAC,UACC,QAASjhC,EACT,UAAU,6GACV,aAAW,cAEX,SAAAihC,MAACsX,GAAE,WAAU,SAAU,GACzB,EAEAtX,MAAC,OAAI,UAAU,kFACb,eAACwW,GAAW,WAAU,UAAU,CAClC,GACCxW,EAAA,UAAG,UAAU,yBAAyB,SAAkB,uBACxDA,EAAA,SAAE,UAAU,yBAAyB,SAEtC,uEACF,QAGC,MAAI,WAAU,4CACb,SAACqa,EAAA,YAAI,UAAU,gBACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,6BACb,UAACra,MAAA,OAAI,UAAU,kFACb,SAAAA,EAAA,IAAC,QAAK,UAAU,kCAAkC,aAAC,CACrD,GACAqa,OAAC,MAAI,WAAU,SACb,UAACra,EAAA,SAAE,UAAU,2CAA2C,SAExD,yBACAqa,OAAC,MAAI,WAAU,oDACb,UAACra,MAAAsW,GAAA,CAAM,UAAU,SAAU,GAC3BtW,MAAC,QAAK,SAAqC,2CAC7C,GACF,GACF,EAEAqa,OAAC,MAAI,WAAU,6BACb,UAACra,MAAA,OAAI,UAAU,kFACb,SAAAA,EAAA,IAAC,QAAK,UAAU,kCAAkC,aAAC,CACrD,GACAqa,OAAC,MAAI,WAAU,SACb,UAACra,EAAA,SAAE,UAAU,2CAA2C,SAExD,gCACAqa,OAAC,MAAI,WAAU,oDACb,UAACra,MAAA4V,GAAA,CAAK,UAAU,SAAU,GAC1B5V,MAAC,QAAK,SAAiD,uDACzD,GACF,GACF,EAEAqa,OAAC,MAAI,WAAU,6BACb,UAACra,MAAA,OAAI,UAAU,kFACb,SAAAA,EAAA,IAAC,QAAK,UAAU,kCAAkC,aAAC,CACrD,GACAqa,OAAC,MAAI,WAAU,SACb,UAACra,EAAA,SAAE,UAAU,2CAA2C,SAExD,yBACCA,EAAA,SAAE,UAAU,wBAAwB,SAErC,kEACF,GACF,GACF,EAGAqa,OAAC,MAAI,WAAU,4BACb,UAACra,EAAA,UAAG,UAAU,2CAA2C,SAAY,iBACrEqa,OAAC,KAAG,WAAU,kCACZ,UAAAra,MAAC,MAAG,SAAwC,6CAC5CA,MAAC,MAAG,SAA4C,iDAChDA,MAAC,MAAG,SAA0C,+CAC9CA,MAAC,MAAG,SAAmC,yCACzC,GACF,EAGAA,MAAC,MAAI,WAAU,KAAM,IACvB,CACF,SAGC,MAAI,WAAU,2DACb,SAACqa,EAAA,YAAI,UAAU,iBACb,UAAAra,EAAA,IAAC,UACC,QAASjhC,EACT,UAAU,kHACX,uBAED,EACAihC,EAAA,IAAC,UACC,QAAS,IAAM,CACLjhC,IAER,aAAa,QAAQ,wBAAyB,KAAK,IAAI,EAAE,UAAU,CACrE,EACA,UAAU,mHACX,mBAED,GACF,CACF,MAEJ,IAzHgB,KA8HtB8kD,GAAeD,GC9HTE,GAAsD,CAAC,CAAE,UAAAC,EAAW,UAAAC,KAAgB,CACxF,KAAM,CAAC7C,EAAWC,CAAY,EAAItiB,WAAS,EAAK,EAEhDC,YAAU,IAAM,CAEd,MAAM19B,EAAQ,WAAW,IAAM+/C,EAAa,EAAI,EAAG,GAAG,EAC/C,UAAM,aAAa//C,CAAK,CACjC,EAAG,CAAE,GAEL,MAAM4iD,EAAgB,IAAM,CAC1B7C,EAAa,EAAK,EAClB,WAAW2C,EAAW,GAAG,GAGrBL,EAAgB,IAAM,CAC1BtC,EAAa,EAAK,EAClB,WAAW4C,EAAW,GAAG,GAIzB,OAAAhkB,MAAC,OAAI,UAAW;AAAA;AAAA,QAEZmhB,EAAY,sCAAwC,oCAAoC;AAAA,MACzF,MAAO,CAAE,OAAQ,KAClB,SAAC9G,EAAA,YAAI,UAAU,wEAEb,UAAAra,MAAC,OAAI,UAAU,8DACb,SAACqa,EAAA,YAAI,UAAU,oCACb,UAACA,OAAA,OAAI,UAAU,8BACb,UAAAra,MAAC,OAAI,UAAU,kEACb,eAAC4U,GAAS,WAAU,UAAU,CAChC,UACC,MACC,WAAC5U,EAAA,UAAG,UAAU,wBAAwB,SAAkB,uBACvDA,EAAA,SAAE,UAAU,yBAAyB,SAA2B,iCACnE,GACF,EACAA,EAAA,IAAC,UACC,QAAS0jB,EACT,UAAU,gEAEV,SAAA1jB,MAACsX,GAAE,WAAU,SAAU,GACzB,GACF,CACF,GAGA+C,OAAC,MAAI,WAAU,gBACb,UAACA,OAAA,OAAI,UAAU,8BACG,UAAAra,MAAC,OAAI,UAAU,mGAC7B,eAACuX,GAAI,WAAU,wBAAwB,CACzC,UACC,MACC,WAACvX,EAAA,SAAE,UAAU,oCAAoC,SAAkB,uBAClEA,EAAA,SAAE,UAAU,wBAAwB,SAA4C,kDACnF,GACF,EAEAqa,OAAC,MAAI,WAAU,8BACb,UAAAra,MAAC,OAAI,UAAU,kEACb,eAAC6T,GAAK,WAAU,wBAAwB,CAC1C,UACC,MACC,WAAC7T,EAAA,SAAE,UAAU,oCAAoC,SAAkB,uBAClEA,EAAA,SAAE,UAAU,wBAAwB,SAAiD,uDACxF,GACF,EAEAqa,OAAC,MAAI,WAAU,8BACb,UAAAra,MAAC,OAAI,UAAU,oEACb,eAACyW,GAAS,WAAU,0BAA0B,CAChD,UACC,MACC,WAACzW,EAAA,SAAE,UAAU,oCAAoC,SAAc,mBAC9DA,EAAA,SAAE,UAAU,wBAAwB,SAA2C,iDAClF,GACF,GACF,EAGAqa,OAAC,MAAI,WAAU,0BACb,UAAAra,EAAA,IAAC,UACC,QAAS0jB,EACT,UAAU,kHACX,uBAED,EACArJ,EAAA,KAAC,UACC,QAAS4J,EACT,UAAU,2JAEV,UAACjkB,MAAA4U,GAAA,CAAS,UAAU,SAAU,GAC9B5U,MAAC,QAAK,SAAO,aACf,GACF,EACF,EACF,EAEJ,EAGMkkB,GAA+B,IAAM,CACzC,KAAM,CAACC,EAAYC,CAAa,EAAItlB,WAAS,EAAK,EAC5C,CAACulB,EAAgBC,CAAiB,EAAIxlB,WAAS,CAAC,EAEtDC,YAAU,IAAM,CAEd,IAAIwlB,EAAkB,EACtB,MAAMC,EAAmB,CAAC,QAAS,SAAU,aAAc,SAAS,EAE9DC,EAAkB,IAAM,CAC5BF,IACAD,EAAkBC,CAAe,EAG7BA,GAAmB,GAAK,CAAC,aAAa,QAAQ,sBAAsB,GACnDG,GACrB,EAGF,OAAAF,EAAiB,QAAiBzgE,GAAA,CAChC,SAAS,iBAAiBA,EAAO0gE,EAAiB,CAAE,QAAS,GAAM,EACpE,EAEM,IAAM,CACXD,EAAiB,QAAiBzgE,GAAA,CACvB,6BAAoBA,EAAO0gE,CAAe,EACpD,EAEL,EAAG,CAAE,GAEL,MAAMC,EAAqB,IAAM,CAE/B,GAAIhC,GAAW,eAAe,EAAG,OAE3B,MAAAQ,EAAY,aAAa,QAAQ,0BAA0B,EAC3DC,EAAgBD,EAAY,SAASA,CAAS,EAAI,EAClDyB,EAAa,GAAK,GAAK,GAAK,IAElC,GAAI,CAACzB,GAAa,KAAK,IAAI,EAAIC,EAAgBwB,EAAY,CAEnD,MAAAC,EAAa,KAAK,MAAS,SAAS,aAAa,QAAQ,eAAe,GAAK,GAAG,EAChFC,EAAuB,aAAa,QAAQ,wBAAwB,EACpEC,EAAsB,aAAa,QAAQ,uBAAuB,EAGpEF,EAAa,MAAUC,GAAwBC,KACjDV,EAAc,EAAI,EACL,qBAAQ,uBAAwB,MAAM,EAEvD,GAGIH,EAAgB,SAAY,CAClBvB,GAAW,cAIvB,OAAO,cAAc,IAAI,YAAY,kBAAkB,CAAC,EAGtC,MAAMA,GAAW,iBAEjC,aAAa,QAAQ,2BAA4B,KAAK,IAAI,EAAE,UAAU,EAI1E0B,EAAc,EAAK,GAGfV,EAAgB,IAAM,CAC1BU,EAAc,EAAK,EACnB,aAAa,QAAQ,2BAA4B,KAAK,IAAI,EAAE,UAAU,GAGxE,OAAKD,EAGHnkB,EAAA,IAAC8jB,GAAA,CACC,UAAWG,EACX,UAAWP,CAAA,GALS,IAQ1B,EAEAqB,GAAeb,GCzLTc,GAAgD,CAAC,CACrD,UAAA7D,EACA,SAAA8D,EACA,UAAAjB,CACF,IAAM,CACJ,KAAM,CAACkB,EAAgBC,CAAiB,EAAIrmB,WAAS,EAAK,EAEpD4kB,EAAgB,IAAM,CAC1ByB,EAAkB,EAAI,EACtB,WAAWnB,EAAW,GAAG,GAGrBoB,EAAe,IAAM,CACzBD,EAAkB,EAAI,EACtB,WAAWF,EAAU,GAAG,GAGtB,OAAC9D,GAAa,CAAC+D,EAAuB,KAKtC7K,EAAA,KAAAC,WAAA,WAAAta,MAAC,OAAI,UAAW;AAAA;AAAA,UAEZmhB,GAAa,CAAC+D,EAAiB,cAAgB,WAAW;AAAA,QAC3D,MAAO,CAAE,OAAQ,GAAS,IAG7BllB,MAAC,OAAI,UAAW;AAAA;AAAA;AAAA;AAAA,UAIZmhB,GAAa,CAAC+D,EACZ,wBACA,oBACJ;AAAA,QACC,MAAO,CAAE,OAAQ,OAClB,SAAC7K,EAAA,YAAI,UAAU,yEAEb,UAACA,OAAA,OAAI,UAAU,uEACb,UAACA,OAAA,OAAI,UAAU,8BACb,UAAAra,MAAC,OAAI,UAAU,uFACb,eAACgW,GAAU,WAAU,UAAU,CACjC,GACAqE,OAAC,MAAI,WAAU,SACb,UAACA,OAAA,MAAG,UAAU,kDACZ,UAAAra,MAAC,QAAK,SAAiB,sBACvBA,MAACyW,GAAS,WAAU,SAAU,IAChC,EACCzW,EAAA,SAAE,UAAU,yBAAyB,SAEtC,yCACF,GACF,EAEAA,EAAA,IAAC,UACC,QAAS0jB,EACT,UAAU,8GACV,aAAW,8BAEX,SAAA1jB,MAACsX,GAAE,WAAU,SAAU,GACzB,GACF,EAGA+C,OAAC,MAAI,WAAU,MACb,UAACA,OAAA,OAAI,UAAU,OACb,UAACA,OAAA,KAAE,UAAU,6BAA6B,gBACrCra,MAAC,UAAO,SAAW,iBACxB,EACAqa,OAAC,KAAG,WAAU,uCACZ,UAAAra,MAAC,MAAG,SAAoC,yCACxCA,MAAC,MAAG,SAAyB,8BAC7BA,MAAC,MAAG,SAA6B,mCACnC,GACF,EAEAqa,OAAC,MAAI,WAAU,iBACb,UAAAA,EAAA,KAAC,UACC,QAAS+K,EACT,UAAU,2LAEV,UAACplB,MAAAgW,GAAA,CAAU,UAAU,SAAU,GAC/BhW,MAAC,QAAK,SAAU,gBAClB,EACAA,EAAA,IAAC,UACC,QAAS0jB,EACT,UAAU,8IACX,iBAED,GACF,GACF,GACF,CACF,EACF,GAEJ,EAEA2B,GAAeL,GCnGTM,GAA8B,IAAM,CACxC,KAAM,CAACC,EAAcC,CAAe,EAAI1mB,WAAS,EAAK,EAChD,CAAC2mB,EAAwBC,CAAyB,EAAI5mB,WAAS,EAAK,EAGtE,GAAAle,GAAU,mBACL,YAGTme,YAAU,IAAM,CAET,aAAa,QAAQ,eAAe,GACvC,aAAa,QAAQ,gBAAiB,KAAK,IAAI,EAAE,UAAU,EAI7D,MAAM4mB,EAAyB,IAAM,CACnCH,EAAgB,EAAI,GAIhBI,EAAyB7hE,GAAe,CAC5C2hE,EAA0B,EAAI,GAI1BG,EAAuC,IAAM,CACjD,WAAW,SAAY,CAEf,MAAAC,EAAgB,aAAa,QAAQ,qBAAqB,EAC1DC,EAAmB,aAAa,QAAQ,mCAAmC,EAE7E,GAAAD,GAAiB,CAACC,EAAkB,CAChC,MAAAC,EAAU,MAAMtD,GAAW,gCACpB,qBAAQ,oCAAqC,MAAM,EAE5DsD,GAEF,MAAMtD,GAAW,8BAErB,GACC,IAAK,GAGH,wBAAiB,mBAAoBiD,CAAsB,EAC3D,wBAAiB,uBAAwBC,CAAqB,EAGrE,MAAMK,EAAmB,IAAM,CAChB,qBAAQ,sBAAuB,MAAM,EACbJ,GAAA,EAIjCK,EAAoB,CAAC,QAAS,SAAU,YAAY,EAC1D,OAAAA,EAAkB,QAAiBniE,GAAA,CACxB,0BAAiBA,EAAOkiE,EAAkB,CAAE,KAAM,GAAM,QAAS,GAAM,EACjF,GAG0B,IAAM,CAC/B,MAAME,EAAa,SAAS,aAAa,QAAQ,aAAa,GAAK,GAAG,EAAI,EAC1E,aAAa,QAAQ,cAAeA,EAAW,SAAU,GACzD,aAAa,QAAQ,aAAc,KAAK,IAAI,EAAE,UAAU,EAGpDA,EAAa,GACF,qBAAQ,oBAAqB,MAAM,CAClD,KAKK,IAAM,CACJ,2BAAoB,mBAAoBR,CAAsB,EAC9D,2BAAoB,uBAAwBC,CAAqB,EAExEM,EAAkB,QAAiBniE,GAAA,CACxB,6BAAoBA,EAAOkiE,CAAgB,EACrD,EAEL,EAAG,CAAE,GAEL,MAAMG,EAAkB,SAAY,CAC9B,IACF,KAAM,CAAE,KAAAx0D,CAAK,EAAI,MAAMuiC,EAAS,KAAK,WAAW,EAC5CviC,GAAM,SAAS,cAAgBA,EAAK,QAAQ,eAC/B,uBACb,qBACA,KAAK,UAAU,CACb,aAAcA,EAAK,QAAQ,aAC3B,cAAeA,EAAK,QAAQ,cAC7B,QAGS,CAEhB,CAGI,OAAO,OAAW,KAAe,SAAU,QAAU,OAAO,OAAO,MAAS,YACvE,YAAK,QAAS,sBAAuB,CAC1C,eAAgB,aAChB,YAAa,aACd,EAGH,OAAO,SAAS,QAAO,EAGnBy0D,EAAgB,IAAM,CAC1BX,EAA0B,EAAK,EAG3B,OAAO,OAAW,KAAe,SAAU,QAAU,OAAO,OAAO,MAAS,YACvE,YAAK,QAAS,uBAAwB,CAC3C,eAAgB,aAChB,YAAa,aACd,CACH,EAGF,OAGIrL,EAAA,KAAAC,WAAA,WAAAta,EAAA,IAAC2iB,GAAiB,UAGjBuB,GAAmB,IAGpBlkB,EAAA,IAAC4jB,GAAA,CACC,OAAQ2B,EACR,QAAS,IAAMC,EAAgB,EAAK,EACtC,EAOAxlB,EAAA,IAACglB,GAAA,CACC,UAAWS,EACX,SAAUW,EACV,UAAWC,CAAA,CACb,CACF,GAEJ,EAEAC,GAAehB,UCjJf,cAA4BzS,WAA4E,CACtG,YAAY1yD,EAAqD,CAC/D,MAAMA,CAAK,EACN,WAAQ,CAAE,SAAU,EAAM,CACjC,CAEA,OAAO,yBAAyBlL,EAAkC,CACzD,OAAE,SAAU,GAAM,MAAAA,EAC3B,CAEA,kBAAkBA,EAAcmL,EAA4B,CAE5D,CAEA,QAAS,CACH,YAAK,MAAM,eAEV,MAAI,WAAU,+DACb,SAACi6D,EAAA,YAAI,UAAU,uBACb,UAACra,MAAA,OAAI,UAAU,kFACb,SAACA,EAAA,WAAI,UAAU,uBAAuB,KAAK,OAAO,OAAO,eAAe,QAAQ,YAC9E,SAACA,MAAA,QAAK,cAAc,QAAQ,eAAe,QAAQ,YAAa,EAAG,EAAE,2IAA4I,GACnN,CACF,GACCA,EAAA,UAAG,UAAU,2CAA2C,SAAoB,yBAC7EA,MAAC,KAAE,UAAU,qBACV,cAAK,MAAM,OAAO,SAAW,uDAChC,GACAA,EAAA,IAAC,UACC,QAAS,IAAM,CACb,KAAK,SAAS,CAAE,SAAU,GAAO,MAAO,OAAW,EACnD,KAAK,MAAM,SACb,EACA,UAAU,+FACX,qBAED,EACF,EACF,GAIG,KAAK,MAAM,QACpB,CACF,EAGA,MAAMumB,GAA+C,CAAC,CAAE,MAAArrB,EAAQ,YAAa,IAC1E8E,MAAA,OAAI,UAAU,2DACb,SAACqa,OAAA,OAAI,UAAU,cACb,UAACra,MAAA,OAAI,UAAU,2EAA4E,GAC1FA,EAAA,SAAE,UAAU,gBAAiB,SAAM9E,EAAA,EACtC,EACF,GAIIsrB,GAA0C,CAAC,CAC/C,SAAAjmE,EACA,MAAA26C,EAAQ,aACR,SAAAvH,CACF,IAAM,CACJ,KAAM,CAAC8yB,EAAUC,CAAW,EAAIC,GAAM,SAAS,CAAC,EAE1CC,EAAc,IAAM,CACZF,EAAAG,GAAQA,EAAO,CAAC,GAG9B,aACGC,GAAc,SAASF,EACtB,SAAA5mB,MAAC+mB,YAAS,SAAUpzB,GAAaqM,EAAA,IAAAumB,GAAA,CAAe,MAAArrB,CAAc,GAC5D,SAAA8E,MAAC,OACE,SAAAz/C,GADOkmE,CAEV,CACF,EACF,EAEJ,EAEAO,GAAeR,GCzFR,SAAStuB,GAAMvvB,EAAOs+C,EAAO,CACnC,GAAIt+C,aAAiB,OAAQ,MAAO,CAAE,KAAK,GAAO,QAAQA,GAC1D,IAAIjV,EAAG81C,EAAG0d,EAAK3pB,EAAKh2C,EAAK,GAAInO,EAAQ,GAAIiiB,EAAMsN,EAAM,MAAM,GAAG,EAG9D,IAFAtN,EAAI,CAAC,GAAKA,EAAI,MAAK,EAEZ6rD,EAAM7rD,EAAI,SAChB3H,EAAIwzD,EAAI,CAAC,EACLxzD,IAAM,KACTnM,EAAK,KAAKmM,CAAC,EACXta,GAAW8tE,EAAI,CAAC,IAAM,IAAM,aAAe,SACjCxzD,IAAM,KAChB81C,EAAI0d,EAAI,QAAQ,IAAK,CAAC,EACtB3pB,EAAM2pB,EAAI,QAAQ,IAAK,CAAC,EACxB3/D,EAAK,KAAM2/D,EAAI,UAAU,EAAK,CAAC1d,EAAIA,EAAM,CAACjM,EAAMA,EAAM2pB,EAAI,MAAM,GAChE9tE,GAAa,CAACowD,GAAK,CAAC,CAACjM,EAAM,iBAAmB,YACxC,CAACA,IAAKnkD,IAAc,CAACowD,EAAI,IAAM,IAAM,KAAO0d,EAAI,UAAU3pB,CAAG,IAEnEnkD,GAAW,IAAM8tE,EAInB,MAAO,CACN,KAAM3/D,EACN,QAAS,IAAI,OAAO,IAAMnO,GAAW6tE,EAAQ,UAAa,OAAS,GAAG,CACxE,CACA,CCzBA,MAAME,GAA4BR,GAAM,oBAAyB,EAwB3DS,GACJ,OAAO,OAAW,KAClB,OAAO,OAAO,SAAa,KAC3B,OAAO,OAAO,SAAS,cAAkB,IAQ9B7pE,GAA4B6pE,GACrCC,EAAqB,gBACrBC,YAISC,GACXJ,IAA6B5pE,GAQlBiqE,GAAYnyE,GAAO,CAC9B,MAAM8T,EAAMs+D,EAAY,OAAC,CAACpyE,EAAI,IAAI8a,IAAShH,EAAI,CAAC,EAAE,GAAGgH,CAAI,CAAC,CAAC,EAAE,QAI7D,OAAAo3D,GAAmB,IAAM,CACvBp+D,EAAI,CAAC,EAAI9T,CACb,CAAG,EACM8T,EAAI,CAAC,CACd,EC1DMu+D,GAAgB,WAChBC,GAAiB,YACjBC,GAAoB,eACpBC,GAAkB,aAClB5rD,GAAS,CACbyrD,GACAC,GACAC,GACAC,EACF,EAEMC,GAA8Bx+D,GAAa,CAC/C,UAAWvF,KAASkY,GAClB,iBAAiBlY,EAAOuF,CAAQ,EAElC,MAAO,IAAM,CACX,UAAWvF,KAASkY,GAClB,oBAAoBlY,EAAOuF,CAAQ,CAEzC,CACA,EAEay+D,GAAsB,CAAC1yE,EAAI2yE,IACtCC,wBAAqBH,GAA4BzyE,EAAI2yE,CAAK,EAEtDE,GAAgB,IAAM,SAAS,OAExBC,GAAY,CAAC,CAAE,UAAAC,CAAS,EAAK,CAAE,IAC1CL,GACEG,GACAE,GAAa,KAAO,IAAMA,EAAYF,EAC1C,EAEMG,GAAkB,IAAM,SAAS,SAE1BC,GAAc,CAAC,CAAE,QAAAC,CAAO,EAAK,CAAE,IAC1CR,GACEM,GACAE,GAAW,KAAO,IAAMA,EAAUF,EACtC,EAMal6D,GAAW,CAACpb,EAAI,CAAE,QAAAikD,EAAU,GAAO,MAAApjD,EAAQ,IAAI,EAAK,CAAE,IACjE,QAAQojD,EAAU4wB,GAAoBD,EAAc,EAAE/zE,EAAO,GAAIb,CAAE,EAIxDy1E,GAAqB,CAACxsD,EAAO,CAAE,IAAK,CAACssD,GAAYtsD,CAAI,EAAG7N,EAAQ,EAEvEs6D,GAAW,OAAO,IAAI,WAAW,EAOvC,GAAI,OAAO,QAAY,KAAe,OAAO,OAAOA,EAAQ,EAAM,IAAa,CAC7E,UAAWrjE,IAAQ,CAACuiE,GAAgBC,EAAiB,EAAG,CACtD,MAAMc,EAAW,QAAQtjE,CAAI,EAI7B,QAAQA,CAAI,EAAI,UAAY,CAC1B,MAAMxN,EAAS8wE,EAAS,MAAM,KAAM,SAAS,EACvC3kE,EAAQ,IAAI,MAAMqB,CAAI,EAC5B,OAAArB,EAAM,UAAY,UAElB,cAAcA,CAAK,EACZnM,CACb,CACG,CAID,OAAO,eAAe,OAAQ6wE,GAAU,CAAE,MAAO,EAAI,CAAE,CACzD,CC/EA,MAAME,GAAgB,CAACnzE,EAAMzB,IAC1BA,EAAK,YAAa,EAAC,QAAQyB,EAAK,YAAW,CAAE,EAE1C,IAAMzB,EADNA,EAAK,MAAMyB,EAAK,MAAM,GAAK,IAM3BozE,GAAe,CAACpzE,EAAO,KAAQA,IAAS,IAAM,GAAKA,EAE5CqzE,GAAe,CAAC91E,EAAIyC,IAC/BzC,EAAG,CAAC,IAAM,IAAMA,EAAG,MAAM,CAAC,EAAI61E,GAAapzE,CAAI,EAAIzC,EAExCgE,GAAe,CAACvB,EAAO,GAAIzB,IACtC40E,GAAcG,GAASF,GAAapzE,CAAI,CAAC,EAAGszE,GAAS/0E,CAAI,CAAC,EAUtD+0E,GAAY/8C,GAAQ,CACxB,GAAI,CACF,OAAO,UAAUA,CAAG,CACrB,MAAY,CAEX,OAAOA,CACR,CACH,ECLMg9C,GAAgB,CACpB,KAAMP,GACN,WAAYQ,GACZ,OAAQC,GACR,KAAM,GAEN,QAAS,OACT,UAAW,OAEX,WAAY,OAEZ,MAAQnzD,GAAMA,CAChB,EAEMozD,GAAYtpB,gBAAcmpB,EAAa,EAGhCI,GAAY,IAAMrpB,aAAWopB,EAAS,EAO7CE,GAAU,GACFxpB,gBAAcwpB,EAAO,EAUnC,MAAMC,GAAyBrnE,GAAW,CACxC,KAAM,CAACvO,EAAU0a,CAAQ,EAAInM,EAAO,KAAKA,CAAM,EAK/C,MAAO,CACLjL,GAAaiL,EAAO,KAAMvO,CAAQ,EAClC+zE,GAAS,CAACz0E,EAAIu2E,IAAYn7D,EAAS06D,GAAa91E,EAAIiP,EAAO,IAAI,EAAGsnE,CAAO,CAAC,CAC9E,CACA,EAEajsE,GAAc,IAAMgsE,GAAsBF,IAAW,EAiL9CrW,aAAW,CAAC3yD,EAAOgJ,IAAQ,CAC7C,MAAMnH,EAASmnE,KACT,CAACp5D,EAAa5B,CAAQ,EAAIk7D,GAAsBrnE,CAAM,EAEtD,CACJ,GAAAjP,EAAK,GACL,KAAMw2E,EAAax2E,EACnB,QAASy2E,EACT,QAAAC,EACA,SAAAlpE,EACA,UAAWmpE,EAEX,QAAA1yB,EACA,MAAApjD,EAGA,GAAG+1E,CACJ,EAAGxpE,EAEE8L,EAAUu7D,GAAUzjE,GAAU,CAIhCA,EAAM,SACNA,EAAM,SACNA,EAAM,QACNA,EAAM,UACNA,EAAM,SAAW,IAInBylE,IAAWzlE,CAAK,EACXA,EAAM,mBACTA,EAAM,eAAc,EACpBoK,EAASo7D,EAAYppE,CAAK,GAEhC,CAAG,EAGK1K,EAAOuM,EAAO,MAClBunE,EAAW,CAAC,IAAM,IAAMA,EAAW,MAAM,CAAC,EAAIvnE,EAAO,KAAOunE,EAC5DvnE,CACJ,EAEE,OAAOynE,GAAWG,EAAc,eAACrpE,CAAQ,EACrCspE,eAAatpE,EAAU,CAAE,QAAA0L,EAAS,KAAAxW,CAAI,CAAE,EACxComB,gBAAE,IAAK,CACL,GAAG8tD,EACH,QAAA19D,EACA,KAAAxW,EAEA,UAAWi0E,GAAK,KAAOA,EAAI35D,IAAgBw5D,CAAU,EAAIG,EACzD,SAAAnpE,EACA,IAAA4I,CACR,CAAO,CACP,CAAC,ECxPM,MAAM2gE,GAAgB,IAAM,CACjC,KAAM,CAACl2E,EAAO4X,CAAQ,EAAIszC,WAA6B,IAAM,CACvD,IACI,MAAAirB,EAAQ,aAAa,QAAQ,yBAAyB,EAC5D,OAAOA,EAAQ,KAAK,MAAMA,CAAK,EAAI,CACjC,SAAU,GACV,YAAa,EACb,UAAW,GACX,QAAS,GACT,gBAAiB,CACf,kBAAmB,GACnB,mBAAoB,OACpB,eAAgB,CAAC,CACnB,EACF,MACM,CACC,OACL,SAAU,GACV,YAAa,EACb,UAAW,GACX,QAAS,GACT,gBAAiB,CACf,kBAAmB,GACnB,mBAAoB,OACpB,eAAgB,CAAC,CACnB,EAEJ,EACD,EAEK,CAAC70D,EAAQ80D,CAAS,EAAIlrB,WAAkC,IAAI,EAG5DmrB,EAAYC,cAAaC,GAAsG,CACnI3+D,EAAiBq7D,GAAA,CACf,MAAMuD,EAAQ,OAAOD,GAAW,WAAaA,EAAOtD,CAAI,EAAIsD,EACtDE,EAAe,CAAE,GAAGxD,EAAM,GAAGuD,CAAM,EACrC,IACF,aAAa,QAAQ,0BAA2B,KAAK,UAAUC,CAAY,CAAC,OAC9D,CAEhB,CACO,OAAAA,CAAA,CACR,CACH,EAAG,CAAE,GAECC,EAAkBJ,cAAaK,GAAgC,CACnEP,EAAUO,CAAS,EACTN,EAAA,CACR,SAAU,GACV,YAAa,EACb,UAAW,GACX,QAAS,GACV,GACA,CAACA,CAAS,CAAC,EAERO,EAAWN,cAAY,SAAY,CACvC,GAAI,CAACh1D,EAAQ,OACb,MAAMu1D,EAAkBv1D,EAAO,MAAMthB,EAAM,WAAW,EACtD,GAAI62E,GAAiB,OACf,IACF,MAAMA,EAAgB,cACR,CAEhB,CAGFR,EAAkBpD,GAAA,CAChB,MAAM6D,EAAS7D,EAAK,cAAgB3xD,GAAQ,MAAM,QAAU,GAAK,EAC3Dy1D,EAAiBF,GAAiB,GACpC,CAAC,GAAG5D,EAAK,gBAAgB,eAAgB4D,EAAgB,EAAE,EAC3D5D,EAAK,gBAAgB,eACzB,OAAI6D,EACK,CACL,SAAU,GACV,UAAW,GACX,gBAAiB,CACf,GAAG7D,EAAK,gBACR,kBAAmB,GACnB,eAAA8D,CACF,GAGG,CACL,YAAa9D,EAAK,YAAc,EAChC,gBAAiB,CACf,GAAGA,EAAK,gBACR,eAAA8D,CACF,EACF,CACD,GACA,CAACz1D,EAAQthB,EAAM,YAAaq2E,CAAS,CAAC,EAEnCW,EAAWV,cAAY,SAAY,CACvC,MAAMO,EAAkBv1D,GAAQ,MAAMthB,EAAM,WAAW,EACvD,GAAI62E,GAAiB,OACf,IACF,MAAMA,EAAgB,cACR,CAEhB,CAEE72E,EAAM,YAAc,GACZq2E,EAAApD,IAAS,CAAE,YAAa,KAAK,IAAI,EAAGA,EAAK,YAAc,CAAC,GAAI,GAEvE,CAAC3xD,EAAQthB,EAAM,YAAaq2E,CAAS,CAAC,EAEnCY,EAAiBX,cAAY,IAAM,CACvCD,EAAmBpD,IAAA,CACjB,SAAU,GACV,QAAS,GACT,gBAAiB,CACf,GAAGA,EAAK,gBACR,kBAAmB,GACnB,mBAAoB,SACtB,CACA,KACD,CAACoD,CAAS,CAAC,EAERa,EAAkBZ,cAAY,IAAM,CACpC,IACF,aAAa,WAAW,yBAAyB,EACxC1+D,EAAA,CACP,SAAU,GACV,YAAa,EACb,UAAW,GACX,QAAS,GACT,gBAAiB,CACf,kBAAmB,GACnB,mBAAoB,OACpB,eAAgB,CAAC,CACnB,EACD,OACa,CAEhB,CACF,EAAG,CAAE,GAEE,OACL,MAAA5X,EACA,OAAAshB,EACA,gBAAAo1D,EACA,SAAAE,EACA,SAAAI,EACA,eAAAC,EACA,gBAAAC,CAAA,CAEJ,EAGMC,GAA2B,CAC/BC,EACAC,EACAC,EAAoB,SACjB,CACH,MAAMC,EAAW,CACf,MAAO,OAAO,WACd,OAAQ,OAAO,aAIXC,EAAW,CACf,IAAK,GACL,OAAQ,IACR,KAAM,GACN,MAAO,IAGHC,EAAU,GACVC,EAAY,CAChB,IAAK,CACH,EAAG,KAAK,IAAIF,EAAS,KAAM,KAAK,IAC9BJ,EAAW,MAAQA,EAAW,MAAQC,EAAY,OAAS,EAC3DE,EAAS,MAAQF,EAAY,MAAQG,EAAS,MAC/C,EACD,EAAG,KAAK,IAAIA,EAAS,IAAKJ,EAAW,IAAMC,EAAY,OAASI,CAAO,CACzE,EACA,OAAQ,CACN,EAAG,KAAK,IAAID,EAAS,KAAM,KAAK,IAC9BJ,EAAW,MAAQA,EAAW,MAAQC,EAAY,OAAS,EAC3DE,EAAS,MAAQF,EAAY,MAAQG,EAAS,MAC/C,EACD,EAAG,KAAK,IACND,EAAS,OAASF,EAAY,OAASG,EAAS,OAChDJ,EAAW,OAASK,CACtB,CACF,EACA,KAAM,CACJ,EAAG,KAAK,IAAID,EAAS,KAAMJ,EAAW,KAAOC,EAAY,MAAQI,CAAO,EACxE,EAAG,KAAK,IAAID,EAAS,IAAK,KAAK,IAC7BJ,EAAW,KAAOA,EAAW,OAASC,EAAY,QAAU,EAC5DE,EAAS,OAASF,EAAY,OAASG,EAAS,OACjD,CACH,EACA,MAAO,CACL,EAAG,KAAK,IACND,EAAS,MAAQF,EAAY,MAAQG,EAAS,MAC9CJ,EAAW,MAAQK,CACrB,EACA,EAAG,KAAK,IAAID,EAAS,IAAK,KAAK,IAC7BJ,EAAW,KAAOA,EAAW,OAASC,EAAY,QAAU,EAC5DE,EAAS,OAASF,EAAY,OAASG,EAAS,OACjD,CACH,EACA,OAAQ,CACN,GAAID,EAAS,MAAQF,EAAY,OAAS,EAC1C,GAAIE,EAAS,OAASF,EAAY,QAAU,CAC9C,GAGF,GAAIC,IAAc,OACT,OAAAI,EAAUJ,CAAmC,GAAKI,EAAU,OAIrE,MAAMC,EAAiB,CACrB,IAAKP,EAAW,IAAMI,EAAS,IAC/B,OAAQD,EAAS,OAASH,EAAW,OAASI,EAAS,OACvD,KAAMJ,EAAW,KAAOI,EAAS,KACjC,MAAOD,EAAS,MAAQH,EAAW,MAAQI,EAAS,OAGhDI,EAAO,CACX,IAAKD,EAAe,KAAON,EAAY,OAASI,EAChD,OAAQE,EAAe,QAAUN,EAAY,OAASI,EACtD,KAAME,EAAe,MAAQN,EAAY,MAAQI,EACjD,MAAOE,EAAe,OAASN,EAAY,MAAQI,CAAA,EAIrD,OAAIG,EAAK,OAAeF,EAAU,OAC9BE,EAAK,IAAYF,EAAU,IAC3BE,EAAK,OAASP,EAAY,MAAQ,IAAYK,EAAU,MACxDE,EAAK,MAAQP,EAAY,MAAQ,IAAYK,EAAU,KAEpDA,EAAU,MACnB,EAgBMG,GAA4C,CAAC,CACjD,KAAApgC,EACA,SAAAqgC,EACA,OAAAC,EACA,OAAAC,EACA,OAAAC,EACA,QAAAC,EACA,OAAApB,EACA,WAAAqB,EACA,WAAAC,EACA,QAAAC,CACF,IAAM,CACE,MAAAC,EAAahC,cAAY,IAAM,CAE5ByB,GAAA,EACN,CAACA,CAAM,CAAC,EAELQ,EAAajC,cAAY,IAAM,CAE5B0B,GAAA,EACN,CAACA,CAAM,CAAC,EAELQ,EAAalC,cAAY,IAAM,CAE5B2B,GAAA,EACN,CAACA,CAAM,CAAC,EAGT,OAAAxR,EAAA,KAACgS,GAAO,IAAP,CACC,UAAU,kGACV,MAAO,CACL,KAAMX,EAAS,EACf,IAAKA,EAAS,EACd,MAAO,gCACT,EACA,QAAS,CAAE,MAAO,GAAK,QAAS,EAAG,EAAG,EAAG,EACzC,QAAS,CAAE,MAAO,EAAG,QAAS,EAAG,EAAG,CAAE,EACtC,KAAM,CAAE,MAAO,GAAK,QAAS,EAAG,EAAG,EAAG,EACtC,WAAY,CAAE,SAAU,GAAK,KAAM,SAAU,EAG7C,UAACrR,OAAA,OAAI,UAAU,8DACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAACA,OAAA,OAAI,UAAU,0BACZ,UAAAhvB,EAAK,MACH2U,EAAA,WAAI,UAAU,2CACZ,WAAK,KACR,EAEDA,EAAA,UAAG,UAAU,wBAAyB,WAAK,MAAM,GACpD,EACCisB,GACCjsB,EAAA,IAAC,UACC,QAASosB,EACT,UAAU,qDACV,aAAW,YAEX,SAAApsB,MAACsX,GAAE,WAAU,SAAU,GACzB,GAEJ,EAGA+C,OAAC,MAAI,WAAU,+BACb,UAACra,MAAA,OAAI,UAAU,sCACb,SAAAA,EAAA,IAAC,OACC,UAAU,wDACV,MAAO,CAAE,MAAO,IAAK+rB,EAAa,GAAKC,EAAc,GAAG,GAAI,IAEhE,EACA3R,OAAC,OAAK,WAAU,sBACb,UAAa0R,EAAA,EAAE,OAAKC,CAAA,EACvB,GACF,GACF,EAGA3R,OAAC,MAAI,WAAU,MACb,UAAAra,EAAA,IAAC,IAAE,WAAU,6CACV,SAAA3U,EAAK,YACR,EAGAgvB,OAAC,MAAI,WAAU,0CACb,UAAAA,EAAA,KAAC,UACC,QAAS8R,EACT,SAAUL,EACV,UAAU,6MAEV,UAAC9rB,MAAAkU,GAAA,CAAY,UAAU,SAAU,GAAE,YAErC,EAEClU,MAAA,OAAI,UAAU,0BACZ,SAAM,WAAK,CAAE,OAAQgsB,CAAW,EAAG,CAAChyE,EAAG3D,IACtC2pD,EAAA,IAAC,OAEC,UAAW,0CACT3pD,IAAM01E,EAAa,cAAgB,aACrC,IAHK11E,CAKR,GACH,EAEA2pD,EAAA,IAAC,UACC,QAASksB,EACT,UAAU,0JAET,WAEG7R,OAAAC,EAAA,oBAACta,MAAA+T,GAAA,CAAY,UAAU,SAAU,GAAE,UAErC,EAEEsG,OAAAC,EAAA,2BAEAta,MAACmU,GAAa,WAAU,SAAU,IACpC,EAEJ,GACF,GACF,IAGN,EAGMmY,GAA6D,CAAC,CAAE,WAAAtB,KAAiB,CACrF,MAAMuB,EAASC,UAAQ,IAAM,aAAa,KAAK,SAAS,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GAAI,EAAE,EAEvF,GAAI,CAACxB,EAAmB,YAElB,MAAAyB,EAAS,KAAK,IAAIzB,EAAW,MAAOA,EAAW,MAAM,EAAI,EAAI,GAC7D0B,EAAU1B,EAAW,KAAOA,EAAW,MAAQ,EAC/C2B,EAAU3B,EAAW,IAAMA,EAAW,OAAS,EAGnD,OAAAhrB,MAAC,MAAI,WAAU,8CACb,SAAAqa,OAAC,MAAI,OAAM,OAAO,OAAO,OAAO,UAAU,mBACxC,UAAAra,MAAC,OACC,UAAAqa,OAAC,OAAK,IAAIkS,EACR,UAAAvsB,MAAC,QAAK,MAAM,OAAO,OAAO,OAAO,KAAK,QAAQ,EAC9CA,EAAA,IAAC,UACC,GAAI0sB,EACJ,GAAIC,EACJ,EAAGF,EACH,KAAK,QACP,GACF,CACF,GACAzsB,EAAA,IAAC,QACC,MAAM,OACN,OAAO,OACP,KAAK,kBACL,KAAM,QAAQusB,CAAM,IACtB,EACF,EACF,EAEJ,EAYaK,GAAoD,CAAC,CAChE,SAAAj/D,EACA,OAAAuH,EACA,YAAA23D,EACA,OAAAlB,EACA,OAAAC,EACA,OAAAC,CACF,IAAM,CACJ,KAAM,CAACiB,EAAeC,CAAgB,EAAIjuB,WAAyB,IAAI,EACjE,CAACksB,EAAYgC,CAAa,EAAIluB,WAAyB,IAAI,EAC3D,CAACmuB,EAAiBC,CAAkB,EAAIpuB,EAAA,SAAS,CAAE,EAAG,EAAG,EAAG,EAAG,EAC/DquB,EAAavsB,SAAuB,IAAI,EACxCwsB,EAAoBxsB,SAA8B,IAAI,EACtDysB,EAAazsB,SAA8B,IAAI,EAE/CvV,EAAOn2B,GAAQ,MAAM23D,CAAW,EA+HtC,GA5HA9tB,YAAU,IAAM,CACd,GAAI,CAACpxC,GAAY,CAAC09B,GAAM,OAAQ,CAC9B0hC,EAAiB,IAAI,EACrBC,EAAc,IAAI,EAClB,MACF,CAEM,MAAAM,EAAqBrpE,GAAmC,CAC5D,GAAI,CAACA,EAAe,YAGpB,GAAI,UAAU,KAAKA,CAAM,GAAKA,EAAO,SAAS,GAAG,EAC3C,IACK,gBAAS,cAAcA,CAAM,OACtB,CAEP,WACT,CAIA,gBAAS,cAAc,kBAAkBA,CAAM,IAAI,GACnD,SAAS,cAAc,eAAeA,CAAM,IAAI,GAI9CspE,EAAuB,IAAM,CAC7B,IAACliC,GAAM,OAAQ,CACjB0hC,EAAiB,IAAI,EACrBC,EAAc,IAAI,EAClB,MACF,CAEI,IACI,MAAA7pE,EAAUmqE,EAAkBjiC,EAAK,MAAM,EAC7C,GAAIloC,EAAS,CACL,MAAAqqE,EAAOrqE,EAAQ,wBACrB4pE,EAAiB5pE,CAAO,EACxB6pE,EAAcQ,CAAI,EAGlBrqE,EAAQ,eAAe,CACrB,SAAU,SACV,MAAO,SACP,OAAQ,SACT,OAGD4pE,EAAiB,IAAI,EACrBC,EAAc,IAAI,OAEN,CAEhB,GAIEK,EAAW,SACb,aAAaA,EAAW,OAAO,EAGjCA,EAAW,QAAU,WAAWE,EAAsBliC,EAAK,OAAS,GAAG,EAGjE,MAAAoiC,EAAe,IAAMF,IACrBG,EAAe,IAAMH,IAEpB,+BAAiB,SAAUE,CAAY,EACvC,wBAAiB,SAAUC,EAAc,EAAI,EAC7C,wBAAiB,oBAAqBD,CAAY,EAGrDL,EAAkB,SACpBA,EAAkB,QAAQ,aAGVA,EAAA,QAAU,IAAI,eAAeG,CAAoB,EAE5D,IAAM,CACPF,EAAW,SACb,aAAaA,EAAW,OAAO,EAE1B,2BAAoB,SAAUI,CAAY,EAC1C,2BAAoB,SAAUC,EAAc,EAAI,EAChD,2BAAoB,oBAAqBD,CAAY,EACxDL,EAAkB,SACpBA,EAAkB,QAAQ,YAC5B,CAED,GAACz/D,EAAU09B,EAAMwhC,CAAW,CAAC,EAGhC9tB,YAAU,IAAM,CACV,GAAAisB,GAAcmC,EAAW,QAAS,CAEpC,MAAMlC,EAAc,IAAI,QAAQ,EAAG,EAAG,IAAK,GAAG,EAC9C,IAAIS,EAAWX,GACbC,EACAC,EACA5/B,GAAM,WAAa,QAEjBA,GAAM,SACGqgC,EAAA,CACT,EAAGA,EAAS,GAAKrgC,EAAK,OAAO,GAAK,GAClC,EAAGqgC,EAAS,GAAKrgC,EAAK,OAAO,GAAK,KAGtC6hC,EAAmBxB,CAAQ,CAC7B,CACC,GAACV,EAAY3/B,GAAM,SAAS,CAAC,EAGhC0T,YAAU,IAAM,CACd,GAAIpxC,EAAU,CACN,MAAA0T,EAAQ,WAAW,IAAM,CACvB,MAAAssD,EAAU,SAAS,cAAc,2BAA2B,EAC9DA,GACDA,EAAwB,MAAM,GAEhC,GAAG,EACC,UAAM,aAAatsD,CAAK,CACjC,GACC,CAAC1T,EAAUk/D,CAAW,CAAC,EAEtB,CAACl/D,GAAY,CAACuH,GAAU,CAACm2B,EACpB,YAGT,MAAMxW,EACJmrB,MAAC4tB,GAAgB,MAAK,OACpB,SAAAvT,EAAA,KAACgS,GAAO,IAAP,CAEC,UAAU,0BACV,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACnB,WAAY,CAAE,SAAU,EAAI,EAG3B,UAAKhhC,EAAA,SAAW,aAAe2/B,EAC7BhrB,MAAAssB,GAAA,CAAiB,WAAAtB,CAAwB,GAE1ChrB,MAAC,MAAI,WAAU,8BAA+B,GAI/CgrB,GAAc3/B,EAAK,QAClB2U,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAU,6EACV,MAAO,CACL,KAAM,KAAK,IAAI,EAAGrB,EAAW,KAAO,CAAC,EACrC,IAAK,KAAK,IAAI,EAAGA,EAAW,IAAM,CAAC,EACnC,MAAO,KAAK,IAAI,OAAO,WAAYA,EAAW,MAAQ,CAAC,EACvD,OAAQA,EAAW,OAAS,CAC9B,EACA,QAAS,CAAE,MAAO,GAAK,QAAS,CAAE,EAClC,QAAS,CAAE,MAAO,EAAG,QAAS,CAAE,EAChC,WAAY,CAAE,SAAU,GAAK,MAAO,EAAI,EAC1C,QAID,MAAI,KAAKmC,EAAY,0BAAuB,GAAC,SAAU,GACtD,SAAAntB,EAAA,IAACyrB,GAAA,CACC,KAAApgC,EACA,SAAU4hC,EACV,OAAAtB,EACA,OAAAC,EACA,OAAAC,EACA,QAASgB,IAAgB,EACzB,OAAQA,IAAgB33D,EAAO,MAAM,OAAS,EAC9C,WAAY23D,EACZ,WAAY33D,EAAO,MAAM,OACzB,QAASA,EAAO,YAAc,KAElC,IA5CK,cAAc23D,CAAW,EA8ClC,IAGK,OAAAgB,gBAAah5C,EAAS,SAAS,IAAI,CAC5C,EAUai5C,GAA4C,CAAC,CACxD,OAAAvU,EACA,YAAAwU,EACA,OAAAlC,EACA,cAAAmC,CACF,IAAM,CACE,MAAAC,EAAkB/D,cAAY,IAAM,CAE5B6D,GAAA,EACX,CAACA,CAAW,CAAC,EAEVG,EAAoBhE,cAAY,IAAM,CAE5B8D,GAAA,EACb,CAACA,CAAa,CAAC,EAEZ5B,EAAalC,cAAY,IAAM,CAE5B2B,GAAA,EACN,CAACA,CAAM,CAAC,EAEX,aACG+B,GACE,UAAArU,GACEc,OAAA,OAAI,UAAU,+DACb,UAAAra,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAU,+BACV,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACrB,EAEAhS,EAAA,KAACgS,GAAO,IAAP,CACC,UAAU,2EACV,QAAS,CAAE,MAAO,GAAK,QAAS,EAAG,EAAG,EAAG,EACzC,QAAS,CAAE,MAAO,EAAG,QAAS,EAAG,EAAG,CAAE,EACtC,KAAM,CAAE,MAAO,GAAK,QAAS,EAAG,EAAG,EAAG,EACtC,WAAY,CAAE,SAAU,GAAK,KAAM,SAAU,EAG7C,UAAChS,OAAA,OAAI,UAAU,iHACb,UAAAra,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAU,+BACV,QAAS,CACP,WAAY,CACV,gFACA,gFACA,+EACF,CACF,EACA,WAAY,CAAE,SAAU,EAAG,OAAQ,IAAU,KAAM,QAAS,EAC9D,EACAhS,OAAC,MAAI,WAAU,gBACb,UAAAra,EAAA,IAACqsB,GAAO,IAAP,CACC,QAAS,CAAE,MAAO,CAAE,EACpB,QAAS,CAAE,MAAO,CAAE,EACpB,WAAY,CAAE,MAAO,GAAK,SAAU,EAAI,EACxC,UAAU,kFAEV,SAAArsB,MAACyW,GAAS,WAAU,SAAU,GAChC,EACCzW,EAAA,UAAG,UAAU,0BAA0B,SAAsB,2BAC7DA,EAAA,SAAE,UAAU,wBAAwB,SAErC,yDACF,GACF,EAGAqa,OAAC,MAAI,WAAU,MACb,UAACA,OAAA,OAAI,UAAU,iBACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAAra,MAAC,OAAI,UAAU,mHACb,eAACyU,GAAQ,WAAU,wBAAwB,CAC7C,UACC,MACC,WAACzU,EAAA,UAAG,UAAU,8BAA8B,SAAoB,yBAC/DA,EAAA,SAAE,UAAU,wBAAwB,SAA+C,qDACtF,GACF,EAEAqa,OAAC,MAAI,WAAU,yBACb,UAAAra,MAAC,OAAI,UAAU,kFACb,eAAC2W,GAAO,WAAU,wBAAwB,CAC5C,UACC,MACC,WAAC3W,EAAA,UAAG,UAAU,8BAA8B,SAAqB,0BAChEA,EAAA,SAAE,UAAU,wBAAwB,SAA+C,qDACtF,GACF,EAEAqa,OAAC,MAAI,WAAU,yBACb,UAAAra,MAAC,OAAI,UAAU,oFACb,eAACmX,GAAO,WAAU,0BAA0B,CAC9C,UACC,MACC,WAACnX,EAAA,UAAG,UAAU,8BAA8B,SAAiB,sBAC5DA,EAAA,SAAE,UAAU,wBAAwB,SAA6C,mDACpF,GACF,GACF,EAGAqa,OAAC,MAAI,WAAU,YACb,UAAAA,EAAA,KAAC,UACC,QAAS4T,EACT,UAAU,8IAEV,UAACjuB,MAAA2V,GAAA,CAAK,UAAU,SAAU,GAAE,iBAE9B,EAEA3V,EAAA,IAAC,UACC,QAASkuB,EACT,UAAU,wGACX,0BAED,EAEA7T,EAAA,KAAC,UACC,QAAS+R,EACT,UAAU,qIAEV,UAACpsB,MAAAqU,GAAA,CAAc,UAAU,SAAU,GAAE,gBAEvC,GACF,GACF,GACF,EACF,EAEJ,EAEJ,EC5yBM8Z,GAAgB,CACpB,IAAK,QACL,KAAM,SACN,QAAS,aACT,OAAQ,SACR,QAAS,oBACT,MAAO,eACP,SAAU,SACV,QAAS,WACT,KAAM,eACN,QAAS,YACX,EAEO,SAASrQ,IAAa,CACpB,OAAAqQ,EACT,CAEO,SAASzzB,GAAoBx6B,EAAc,CACzC,OAAA49C,GAAA,EAAI59C,CAAC,CACd,CCTO,MAAMkuD,GAAyC,CAEpD,CACE,GAAI,UACJ,MAAO,uBACP,YAAa,yHAAyH1zB,GAAE,MAAM,CAAC,4BAC/I,UAAW,SACX,KAAMsF,MAACyW,GAAS,WAAU,SAAU,GACpC,OAAQ,QACR,MAAO,GACT,EAGA,CACE,GAAI,gBACJ,MAAO,uBACP,YAAa,qHAAqH/b,GAAE,SAAS,EAAE,YAAa,KAC5J,OAAQ,gBACR,UAAW,MACX,OAAQ,CAAE,EAAG,GAAI,EACjB,KAAMsF,MAAC4T,GAAU,WAAU,SAAU,GACrC,OAAQ,WACV,EAGA,CACE,GAAI,wBACJ,MAAO,kBACP,YAAa,mGACb,OAAQ,aACR,UAAW,OACX,OAAQ,CAAE,EAAG,IAAK,EAAG,GAAI,EACzB,KAAM5T,MAAC4V,GAAK,WAAU,SAAU,GAChC,OAAQ,WACV,EAGA,CACE,GAAI,mBACJ,MAAO,oBACP,YAAa,aAAalb,GAAE,QAAQ,CAAC,mGAAmGA,GAAE,MAAM,CAAC,IACjJ,OAAQ,WACR,UAAW,MACX,OAAQ,CAAE,EAAG,GAAI,EACjB,KAAMsF,MAAC+W,GAAW,WAAU,SAAU,GACtC,OAAQ,YACR,OAAQ,SAAY,CAClB,MAAM5oD,EAAY,OAAe,kBAC7BA,IACFA,EAAS,OAAO,EAEhB,MAAM,IAAI,QAAQ2Q,GAAW,WAAWA,EAAS,GAAG,CAAC,EAEzD,CACF,EAGA,CACE,GAAI,qBACJ,MAAO,qBACP,YAAa,gDAAgD47B,GAAE,UAAU,EAAE,YAAa,qDACxF,OAAQ,aACR,UAAW,MACX,OAAQ,CAAE,EAAG,GAAI,EACjB,KAAMsF,MAACquB,GAAW,WAAU,SAAU,GACtC,OAAQ,YACR,OAAQ,SAAY,CAClB,MAAMlgE,EAAY,OAAe,kBAC7BA,IACFA,EAAS,SAAS,EAClB,MAAM,IAAI,QAAQ2Q,GAAW,WAAWA,EAAS,GAAG,CAAC,EAGrD,WAAW,IAAM,CACf3Q,EAAS,GAAG,GACX,GAAI,EAEX,CACF,CACF,EAGamgE,GAAwC,CACnD,CACE,GAAI,gBACJ,MAAO,WACP,YAAa,oDACb,UAAW,SACX,KAAMtuB,MAACyW,GAAS,WAAU,SAAU,GACpC,OAAQ,OACV,EACA,CACE,GAAI,iBACJ,MAAO,qBACP,YAAa,sFACb,OAAQ,gBACR,UAAW,MACX,OAAQ,CAAE,EAAG,GAAI,EACjB,KAAMzW,MAAC4T,GAAU,WAAU,SAAU,GACrC,OAAQ,WACV,EACA,CACE,GAAI,eACJ,MAAO,qBACP,YAAa,kFACb,OAAQ,aACR,UAAW,OACX,OAAQ,CAAE,EAAG,IAAK,EAAG,GAAI,EACzB,KAAM5T,MAAC4V,GAAK,WAAU,SAAU,GAChC,OAAQ,WACV,CACF,EC3GM2Y,GAAoB3uB,gBAAkD,MAAS,EAG/E4uB,GAAoCJ,GACpCK,GAAqCH,GAGrCI,GAAuB,IAAM,CAC7B,IACI,MAAA/vB,EAAS,aAAa,QAAQ,yBAAyB,EAC7D,OAAKA,EAGE,CADO,KAAK,MAAMA,CAAM,EACjB,iBAAiB,kBAHX,EAGW,MACzB,CACC,QACT,CACF,EAEMgwB,GAAyB,IAEX,IAAI,gBAAgB,OAAO,SAAS,MAAM,EAC7B,IAAI,SAAS,IAAM,KAE3BD,KAIZE,GAA8D,CAAC,CAC1E,SAAAruE,CACF,IAAM,CACJ,KAAM,CAAC9M,EAAU0a,CAAQ,EAAI9Q,GAAY,EACnC,CACJ,MAAAzJ,EACA,OAAAshB,EACA,gBAAAo1D,EACA,SAAAE,EACA,SAAAI,EACA,eAAAC,EACA,gBAAAC,GACEhB,GAAc,EAEZ,CAAC+E,EAAaC,CAAc,EAAIhwB,WAAS,EAAK,EAC9C,CAAE,KAAAruB,EAAM,QAASs+C,GAAgBryB,EAAa,EAI9CsyB,EAAe,IAAM,CACnB,MAAAj7E,EAAON,EAAS,cAClB,OAAAM,IAAS,KAAOA,IAAS,YACpB,CAAC,CAAC,SAAS,cAAc,+BAA+B,EAG1D,IAGHk7E,EACJx+C,GACA,CAACs+C,GACDC,IAGFjwB,YAAU,KACP,OAAe,kBAAoB5wC,EAC7B,IAAM,CACX,OAAQ,OAAe,oBAExB,CAACA,CAAQ,CAAC,EAIb4wC,YAAU,IAAM,CACd,GAAI,CAACtuB,GAAQs+C,EAAa,OAE1B,MAAMG,EAAe,IAAM,EAEpBz7E,IAAa,KAAOA,IAAa,cAAgBk7E,OAEhDK,IACFF,EAAe,EAAI,EAGnB,WAAWI,EAAc,GAAG,EAEhC,EAII7tD,EAAQ,WAAW6tD,EAAc,GAAG,EAEnC,UAAM,aAAa7tD,CAAK,CAC9B,GAACoP,EAAMs+C,EAAat7E,CAAQ,CAAC,EAGhCsrD,YAAU,IAAM,CAER,MAAAowB,EADY,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACjC,IAAI,MAAM,EAEjCA,IAAa,OACKC,IACXD,IAAa,SACDE,GACvB,EACC,CAAC57E,CAAQ,CAAC,EAEP,MAAA27E,EAAsBlF,cAAY,IAAM,CAIxC,GAHJ4E,EAAe,EAAK,EAGhBr7E,IAAa,KAAOA,IAAa,YAAa,CAChD0a,EAAS,GAAG,EAEZ,MAAMmhE,EAAgB,IAAM,CACX,SAAS,cAAc,+BAA+B,EAEnDhF,EAAA,CACd,MAAOkE,GACP,UAAW,GACX,aAAc,GACd,WAAY,GACb,EAGD,WAAWc,EAAe,GAAG,CAC/B,EAEF,WAAWA,EAAe,GAAG,OAGbhF,EAAA,CACd,MAAOkE,GACP,UAAW,GACX,aAAc,GACd,WAAY,GACb,CAEF,GAAC/6E,EAAU0a,EAAUm8D,CAAe,CAAC,EAElC+E,EAAuBnF,cAAY,IAAM,CAC7C4E,EAAe,EAAK,EACJxE,EAAA,CACd,MAAOmE,GACP,UAAW,GACX,aAAc,GACd,WAAY,GACb,GACA,CAACnE,CAAe,CAAC,EAEdiF,EAAuBrF,cAAY,IAAM,CAC7C4E,EAAe,EAAK,EACLjE,GAAA,EACd,CAACA,CAAc,CAAC,EAEb2E,EAAwBtF,cAAY,IAAM,CAC9BY,IAChBgE,EAAe,EAAI,GAClB,CAAChE,CAAe,CAAC,EAGd2E,EAAuC,CAC3C,SAAU,CAAC,EAAE77E,EAAM,UAAYq7E,GAC/B,YAAAJ,EACA,cAAeO,EACf,eAAgBC,EAChB,eAAgBE,EAChB,gBAAiBC,EACjB,kBAAmB57E,EAAM,gBAAgB,kBACzC,YAAaA,EAAM,YACnB,WAAYshB,GAAQ,MAAM,QAAU,GAIlC,OAAC+5D,GAAcr7E,EAAM,eACf26E,GAAkB,SAAlB,CAA2B,MAAOkB,EAAe,SAAAlvE,CAAS,GAIjE85D,OAAAkU,GAAkB,SAAlB,CAA2B,MAAOkB,EAChC,UAAAlvE,EAGA0uE,GACCjvB,EAAA,IAAC8tB,GAAA,CACC,OAAQe,EACR,YAAaO,EACb,cAAeC,EACf,OAAQE,CAAA,CACV,EAIDN,GACCjvB,EAAA,IAAC4sB,GAAA,CACC,SAAUh5E,EAAM,SAChB,OAAAshB,EACA,YAAathB,EAAM,YACnB,OAAQ42E,EACR,OAAQI,EACR,OAAQC,CAAA,CACV,CAEJ,GAEJ,EClOa6E,GAAQ,IAAIv/D,IAAoB,CAI7C,ECoBMw/D,GAA0C,CAAC,CAC/C,SAAApvE,EACA,eAAAqvE,EACA,UAAA7hE,EAAY,EACd,IAAM,CACJ,MAAMta,EAAW4J,KACX8Q,EAAWzQ,KAsFI,OAnFG,IAAM,CAC5B,GAAIkyE,EACK,OAAAA,EAGT,MAAM77E,EAAON,EAAS,SAGtB,OAAQ,GAAM,CACZ,KAAKM,IAAS,IACd,KAAKA,IAAS,YACL,OACL,MAAO,WACP,WAAY,CAAE,KAAM,MAAgB,EACpC,YAAa,CAAE,KAAM,MAAgB,GAGzC,KAAKA,IAAS,WACL,OACL,MAAO2mD,GAAE,QAAQ,EACjB,WAAY,CAAE,KAAM,MAAgB,EACpC,YAAa,CAAE,KAAM,MAAgB,GAGzC,KAAK3mD,IAAS,UACL,OACL,MAAO,SACP,WAAY,CAAE,KAAM,MAAgB,EACpC,YAAa,CAAE,KAAM,MAAgB,GAGzC,KAAKA,IAAS,eACL,OACL,MAAO,cACP,WAAY,CAAE,KAAM,MAAgB,EACpC,YAAa,CAAE,KAAM,MAAgB,GAGzC,KAAKA,IAAS,WACd,KAAKA,EAAK,WAAW,WAAW,EACvB,OACL,MAAO,UACP,WAAYA,IAAS,WACjB,CAAE,KAAM,QACR,CACE,KAAM,OACN,QAAS,IAAMoa,EAAS,EAAE,EAC1B,aAAc,SAChB,EACJ,YAAa,CAAE,KAAM,MAAgB,GAGzC,KAAKpa,EAAK,WAAW,cAAc,EAC1B,OACL,MAAO,qBACP,WAAY,CACV,KAAM,OACN,QAAS,IAAMoa,EAAS,EAAE,EAC1B,aAAc,SAChB,EACA,YAAa,CAAE,KAAM,MAAgB,GAGzC,KAAKpa,IAAS,UACL,OACL,MAAO,oBACP,WAAY,CACV,KAAM,QACN,QAAS,IAAMoa,EAAS,GAAG,EAC3B,aAAc,0BAChB,EACA,YAAa,CAAE,KAAM,MAAgB,GAGzC,QACS,OACL,MAAO,aACP,WAAY,CAAE,KAAM,MAAgB,EACpC,YAAa,CAAE,KAAM,MAAgB,EAE3C,IAGmC,EAGlCksD,EAAA,YAAI,UAAW,2BAA2BtsD,CAAS,GAEjD,UAEG,KAGJiyC,EAAA,IAAC,QACC,UAAU,SACV,MAAO,CACL,WAAYjO,GAAqB,IAAM,MACzC,EAEC,SAAAxxC,CAAA,CACH,CACF,GAEJ,EAEAsvE,GAAeF,GC5ITG,GAA+B,UAEhC,MAAI,WAAU,2DACb,SAACzV,EAAA,YAAI,UAAU,cACb,UAAAra,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAU,qFACV,QAAS,CAAE,OAAQ,GAAI,EACvB,WAAY,CAAE,SAAU,EAAG,OAAQ,IAAU,KAAM,QAAS,EAC9D,EACCrsB,EAAA,SAAE,UAAU,6BAA6B,SAAU,eACtD,EACF,GAIJ+vB,GAAeD,GCVR,SAASE,IAAkB,CAChCjxB,mBAAU,IAAM,CAyBhB,EAAG,CAAE,GAEE,IACT,CCzBO,MAAMkxB,GAA8D,CAAC,CAC1E,UAAA9O,EACA,QAAA+O,EACA,SAAAC,CACF,IACOhP,EAGHnhB,MAAC,MAAI,WAAU,mFACb,SAAAA,MAAC,MAAI,WAAU,0EACb,SAAAqa,EAAA,KAAC,MAAI,WAAU,cACb,UAAAra,MAAC,OAAI,UAAU,OACb,eAAC,MAAI,WAAU,+FAA+F,CAChH,GACCA,EAAA,UAAG,UAAU,2DAA2D,SAEzE,kBACCA,EAAA,SAAE,UAAU,gDAAgD,SAE7D,+DACAqa,OAAC,MAAI,WAAU,4BACZ,UACC6V,GAAAlwB,EAAA,IAAC,UACC,QAASkwB,EACT,UAAU,wGACX,iBAED,EAEDC,GACCnwB,EAAA,IAAC,UACC,QAASmwB,EACT,UAAU,oKACX,kBAED,GAEJ,GACF,EACF,CACF,GAnCqB,KCVlB,SAASC,MAAMC,EAAsB,CACnC,OAAAC,GAAQC,GAAKF,CAAM,CAAC,CAC7B,CCaA,MAAMG,GAAgE,CAAC,CACrE,UAAAC,EAAY,WACZ,YAAAC,EACA,QAAAC,EAAU,GACV,WAAAC,EACA,UAAA7iE,CACF,IAAM,CACJ,MAAM8iE,EAAwB,CAC5B,CAAE,GAAI,WAAY,MAAO,WAAY,KAAMxb,GAAM,KAAM,GAAI,EAC3D,CAAE,GAAI,OAAQ,MAAO3a,GAAE,QAAQ,EAAG,KAAMqc,GAAY,KAAM,QAAS,MAAO,CAAE,EAC5E,CAAE,GAAI,cAAe,MAAO,WAAY,KAAMC,GAAQ,KAAM,cAAe,EAC3E,CAAE,GAAI,SAAU,MAAO,SAAU,KAAMG,GAAQ,KAAM,SAAU,EAC/D,CAAE,GAAI,UAAW,MAAO,UAAW,KAAMF,GAAM,KAAM,UAAW,GAG5D6Z,EAAiB5G,cAAa6G,GAAkB,CAEhD,OAAO,OAAW,KACpB,OAAO,SAAS,CAAE,IAAK,EAAG,SAAU,SAAU,EAG5CL,GACFA,EAAYK,CAAK,CACnB,EACC,CAACL,CAAW,CAAC,EAEVM,EAAoBt+D,GACpBA,EAAQ,GAAW,MAChBA,EAAM,WAGf,OAGI2nD,EAAA,KAAAC,WAAA,WAAAta,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAW+D,GACT,yCACA,wDACA,wCACAriE,CACF,EACA,MAAO,CACL,cAAe,4CACf,WAAY,UAEZ,UAAW,0CACb,EACA,QAAS,CAAE,EAAG,GAAI,EAClB,QAAS,CAAE,EAAG,CAAE,EAChB,WAAY,CAAE,KAAM,SAAU,UAAW,IAAK,QAAS,EAAG,EAE1D,SAAAiyC,EAAA,IAAC,MAAI,WAAU,OACb,SAAAA,EAAA,IAAC,MAAI,WAAU,oDACZ,SAAA6wB,EAAK,IAAKI,GAAQ,CACjB,MAAMC,EAAOD,EAAI,KACXtjE,EAAW8iE,IAAcQ,EAAI,GAC7BE,EAAWF,EAAI,QAAU,QAAaA,EAAI,MAAQ,EAGtD,OAAA5W,EAAA,KAACgS,GAAO,OAAP,CAEC,QAAS,IAAMyE,EAAeG,EAAI,EAAE,EACpC,UAAWb,GACT,qDACA,4DACA,4DACA,iBACF,EACA,WAAY,CAAE,MAAO,IAAK,EAC1B,SAAU,CAAE,MAAO,GAAK,EACxB,cAAa,WAAWa,EAAI,EAAE,GAC9B,YAAW,OAAOA,EAAI,EAAE,GACxB,eAAc,OAAOA,EAAI,EAAE,GAC3B,aAAY,eAAeA,EAAI,KAAK,GACpC,KAAK,MACL,gBAAetjE,EAGf,UAAC0sD,OAAA,OAAI,UAAU,gBACb,UAAAra,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAW+D,GACT,2CACA,gCACF,EACA,QAAS,CACP,MAAOziE,EAAW,IAAM,EACxB,MAAOA,EAAW,UAAY,SAChC,EACA,WAAY,CAAE,KAAM,SAAU,UAAW,IAAK,QAAS,EAAG,EAE1D,SAAAqyC,EAAA,IAACkxB,EAAA,CACC,KAAM,GACN,YAAavjE,EAAW,IAAM,EAC9B,UAAU,iBACZ,EACF,EAGAqyC,MAAC4tB,IACE,SACCuD,GAAAnxB,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAW+D,GACT,2BACA,8CACA,qCACA,mCACA,iCACF,EACA,QAAS,CAAE,MAAO,EAAG,QAAS,CAAE,EAChC,QAAS,CAAE,MAAO,EAAG,QAAS,CAAE,EAChC,KAAM,CAAE,MAAO,EAAG,QAAS,CAAE,EAC7B,WAAY,CAAE,KAAM,SAAU,UAAW,IAAK,QAAS,EAAG,EAEzD,SAAAY,EAAiBC,EAAI,KAAM,IAGlC,EAGAjxB,MAAC4tB,IACE,SACCjgE,GAAAqyC,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAU,yEACV,SAAS,qBACT,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,EAChC,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,EAChC,KAAM,CAAE,QAAS,EAAG,MAAO,CAAE,EAC7B,WAAY,CAAE,KAAM,SAAU,UAAW,IAAK,QAAS,EAAG,EAC1D,MAAO,CAAE,UAAW,kBAAmB,IAG7C,GACF,EAGArsB,EAAA,IAACqsB,GAAO,KAAP,CACC,UAAW+D,GACT,gDACA,gCACF,EACA,QAAS,CACP,MAAOziE,EAAW,UAAY,UAC9B,WAAYA,EAAW,IAAM,GAC/B,EAEC,SAAIsjE,EAAA,MACP,IAtFKA,EAAI,GAuFX,CAEH,EACH,CACF,GACF,EAGAjxB,MAAC4tB,IACE,SACC+C,GAAAtW,EAAA,KAACgS,GAAO,OAAP,CACC,UAAW+D,GACT,yCACA,oDACA,kCACA,mCACA,4DACA,8DACA,gCACF,EACA,MAAO,CACL,OAAQ,2CACR,MAAO,MACT,EACA,QAAS,CAAE,MAAO,EAAG,QAAS,EAAG,OAAQ,IAAK,EAC9C,QAAS,CAAE,MAAO,EAAG,QAAS,EAAG,OAAQ,CAAE,EAC3C,KAAM,CAAE,MAAO,EAAG,QAAS,EAAG,OAAQ,GAAI,EAC1C,WAAY,CAAE,MAAO,IAAK,EAC1B,SAAU,CAAE,MAAO,GAAK,EACxB,QAASQ,EACT,cAAY,aACZ,YAAU,aACV,eAAa,aACb,aAAW,wBACX,WAAY,CAAE,KAAM,SAAU,UAAW,IAAK,QAAS,EAAG,EAE1D,UAAA5wB,MAAC4V,IAAK,KAAM,GAAI,UAAU,4BAA4B,YAAa,IAAK,EAGxE5V,EAAA,IAACqsB,GAAO,IAAP,CACC,UAAU,yDACV,QAAS,CACP,MAAO,CAAC,EAAG,IAAK,CAAC,EACjB,QAAS,CAAC,EAAG,GAAK,CAAC,CACrB,EACA,WAAY,CACV,SAAU,EACV,OAAQ,IACR,WAAY,SACd,EACF,KAGN,CACF,GAEJ,EAEA+E,GAAeZ,GC9Nf,SAASa,GAAWC,EAAW,CAC7B,MAAMC,EAA4BC,GAAgBF,CAAS,EACrDG,EAAQC,aAAiB,CAACvxE,EAAOmM,IAAiB,CACtD,KAAM,CAAE,SAAA/L,EAAU,GAAGoxE,CAAS,EAAKxxE,EAC7ByxE,EAAgBC,WAAe,QAAQtxE,CAAQ,EAC/CuxE,EAAYF,EAAc,KAAKG,EAAW,EAChD,GAAID,EAAW,CACb,MAAME,EAAaF,EAAU,MAAM,SAC7BG,EAAcL,EAAc,IAAKM,GACjCA,IAAUJ,EACRD,EAAc,SAAC,MAAMG,CAAU,EAAI,EAAUH,EAAc,SAAC,KAAK,IAAI,EAClEM,iBAAqBH,CAAU,EAAIA,EAAW,MAAM,SAAW,KAE/DE,CAEV,EACD,OAAuBlyB,MAAIuxB,EAAW,CAAE,GAAGI,EAAW,IAAKrlE,EAAc,SAAU6lE,iBAAqBH,CAAU,EAAII,EAAkB,aAACJ,EAAY,OAAQC,CAAW,EAAI,IAAI,CAAE,CACnL,CACD,OAAuBjyB,EAAG,IAACuxB,EAAW,CAAE,GAAGI,EAAW,IAAKrlE,EAAc,SAAA/L,CAAQ,CAAE,CACvF,CAAG,EACD,OAAAkxE,EAAM,YAAc,GAAGH,CAAS,QACzBG,CACT,CAGA,SAASD,GAAgBF,EAAW,CAClC,MAAMC,EAAYG,aAAiB,CAACvxE,EAAOmM,IAAiB,CAC1D,KAAM,CAAE,SAAA/L,EAAU,GAAGoxE,CAAS,EAAKxxE,EACnC,GAAIgyE,iBAAqB5xE,CAAQ,EAAG,CAClC,MAAM8xE,EAAcC,GAAc/xE,CAAQ,EACpCgyE,EAASC,GAAWb,EAAWpxE,EAAS,KAAK,EACnD,OAAIA,EAAS,OAASkyE,aACpBF,EAAO,IAAMjmE,EAAeomE,GAAYpmE,EAAc+lE,CAAW,EAAIA,GAEhED,EAAkB,aAAC7xE,EAAUgyE,CAAM,CAC3C,CACD,OAAOV,EAAc,SAAC,MAAMtxE,CAAQ,EAAI,EAAIsxE,WAAe,KAAK,IAAI,EAAI,IAC5E,CAAG,EACD,OAAAN,EAAU,YAAc,GAAGD,CAAS,aAC7BC,CACT,CACA,IAAIoB,GAAuB,OAAO,iBAAiB,EAWnD,SAASZ,GAAYG,EAAO,CAC1B,OAAOC,EAAoB,eAACD,CAAK,GAAK,OAAOA,EAAM,MAAS,YAAc,cAAeA,EAAM,MAAQA,EAAM,KAAK,YAAcS,EAClI,CACA,SAASH,GAAWb,EAAWiB,EAAY,CACzC,MAAMC,EAAgB,CAAE,GAAGD,GAC3B,UAAWE,KAAYF,EAAY,CACjC,MAAMG,EAAgBpB,EAAUmB,CAAQ,EAClCE,EAAiBJ,EAAWE,CAAQ,EACxB,WAAW,KAAKA,CAAQ,EAEpCC,GAAiBC,EACnBH,EAAcC,CAAQ,EAAI,IAAI3iE,IAAS,CACrC,MAAMvY,EAASo7E,EAAe,GAAG7iE,CAAI,EACrC,OAAA4iE,EAAc,GAAG5iE,CAAI,EACdvY,CACjB,EACiBm7E,IACTF,EAAcC,CAAQ,EAAIC,GAEnBD,IAAa,QACtBD,EAAcC,CAAQ,EAAI,CAAE,GAAGC,EAAe,GAAGC,CAAc,EACtDF,IAAa,cACtBD,EAAcC,CAAQ,EAAI,CAACC,EAAeC,CAAc,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,EAErF,CACD,MAAO,CAAE,GAAGrB,EAAW,GAAGkB,EAC5B,CACA,SAASP,GAAcnvE,EAAS,CAC9B,IAAI0sC,EAAS,OAAO,yBAAyB1sC,EAAQ,MAAO,KAAK,GAAG,IAChE8vE,EAAUpjC,GAAU,mBAAoBA,GAAUA,EAAO,eAC7D,OAAIojC,EACK9vE,EAAQ,KAEjB0sC,EAAS,OAAO,yBAAyB1sC,EAAS,KAAK,GAAG,IAC1D8vE,EAAUpjC,GAAU,mBAAoBA,GAAUA,EAAO,eACrDojC,EACK9vE,EAAQ,MAAM,IAEhBA,EAAQ,MAAM,KAAOA,EAAQ,IACtC,CC3FA,IAAI+vE,GAAQ,CACV,IACA,SACA,MACA,OACA,KACA,KACA,MACA,QACA,QACA,KACA,MACA,KACA,IACA,SACA,OACA,MACA,IACF,EACIC,GAAYD,GAAM,OAAO,CAACE,EAAWC,IAAS,CAChD,MAAMC,EAAOjC,GAAW,aAAagC,CAAI,EAAE,EACrCE,EAAO7B,aAAiB,CAACvxE,EAAOmM,IAAiB,CACrD,KAAM,CAAE,QAAAm9D,EAAS,GAAG+J,CAAc,EAAKrzE,EACjCszE,EAAOhK,EAAU6J,EAAOD,EAC9B,OAAI,OAAO,OAAW,MACpB,OAAO,OAAO,IAAI,UAAU,CAAC,EAAI,IAEZrzB,MAAIyzB,EAAM,CAAE,GAAGD,EAAgB,IAAKlnE,CAAY,CAAE,CAC7E,CAAG,EACD,OAAAinE,EAAK,YAAc,aAAaF,CAAI,GAC7B,CAAE,GAAGD,EAAW,CAACC,CAAI,EAAGE,CAAI,CACrC,EAAG,EAAE,EChCDG,GAAyB,OAAO,OAAO,CAEzC,SAAU,WACV,OAAQ,EACR,MAAO,EACP,OAAQ,EACR,QAAS,EACT,OAAQ,GACR,SAAU,SACV,KAAM,mBACN,WAAY,SACZ,SAAU,QACZ,CAAC,EACGC,GAAO,iBACPC,GAAiBlC,EAAgB,WACnC,CAACvxE,EAAOmM,IACiB0zC,EAAG,IACxBmzB,GAAU,KACV,CACE,GAAGhzE,EACH,IAAKmM,EACL,MAAO,CAAE,GAAGonE,GAAwB,GAAGvzE,EAAM,KAAO,CACrD,CACP,CAEA,EACAyzE,GAAe,YAAcD,GCxB7B,MAAME,GAAQ,GAAgB,oBAAsB,mCAC9CC,GAAYD,GAAM,QAAU,EAG5BE,GAAiB,IACd,4BAA4B,KAAK,UAAU,SAAS,GACnD,OAAO,YAAc,KAAO,iBAAkB,OAQxD,SAAwBC,GAAmB,CAAE,OAAAza,EAAQ,QAAAx6C,GAAoC,CACvF,KAAM,CAAE,QAAAk1D,EAAS,WAAAC,EAAY,OAAAvhE,EAAQ,MAAA1d,CAAA,EAAUk/E,KACzC,CAACC,EAAMC,CAAO,EAAIv1B,EAAkB,WAAQya,CAAO,EACnD,CAAC+a,EAAcC,CAAe,EAAIz1B,WAAwB,IAAI,EAC9D01B,EAAWT,KACXU,EAAcX,GAAYI,EAAW,QAAUxgE,EAAE,KAAO,eAAe,EAAI,KAG3EghE,EAAe9zB,SAAO,EAAK,EAC3B+zB,EAAiB/zB,SAAe,CAAC,EAGvC7B,YAAU,IAAM,CACVq1B,IACFM,EAAa,QAAU,GACvBH,EAAgB,IAAI,EACtB,EACC,CAACH,CAAI,CAAC,EAEH,MAAAQ,EAAgB1K,cAAY,MAAO2K,GAAmB,CAEpD,MAAAx4C,EAAM,KAAK,MACjB,GAAI,EAAAq4C,EAAa,SAAYr4C,EAAMs4C,EAAe,QAAW,KAI7D,CAAAD,EAAa,QAAU,GACvBC,EAAe,QAAUt4C,EACzBk4C,EAAgB,IAAI,EAEhB,IACI,MAAAN,EAAQ,CAAE,UAAAY,CAAA,CAAW,EACvB91D,EAAiBA,IAChBs1D,EAAQ,EAAK,QACXnxD,EAAU,CACX,MAAA9L,EAAe8L,GAAK,SAAW,2BACrCqxD,EAAgBn9D,CAAY,EAGxBA,EAAa,SAAS,KAAK,GAAKA,EAAa,SAAS,WAAW,EACnEqjC,EAAM,MAAM,4DAA4D,EAE/DrjC,EAAa,SAAS,eAAe,EAC9CqjC,EAAM,MAAM,sBAAsB,EAElCA,EAAM,MAAMrjC,CAAY,EAI1Bs9D,EAAa,QAAU,EACzB,IACC,CAACT,EAASl1D,CAAO,CAAC,EAErBggC,YAAU,IAAM,CAEV,OAAOwa,GAAW,WACpB8a,EAAQ9a,CAAM,CAChB,EACC,CAACA,CAAM,CAAC,EAEXxa,YAAU,IAAM,CAEd,GAAI,OAAOwa,GAAW,UAAW,OACjC,MAAMub,EAAU,IAAM,CAEpBT,EAAQ,EAAI,GAEP,+BAAiB,qBAAsBS,CAAwB,EAC/D,IAAM,OAAO,oBAAoB,qBAAsBA,CAAwB,GACrF,CAACvb,CAAM,CAAC,EAEX,MAAMwb,EAAmBb,EAAW,KAAUxgE,KAAE,KAAO,UAAU,EAG/D,OAAAssC,EAAA,IAACg1B,GAAA,CACC,KAAAZ,EACA,aAAe3gC,GAAS,CAClB,OAAO8lB,GAAW,UAChB,CAAC9lB,GAAQ10B,GAAiBA,IAE9Bs1D,EAAQ5gC,CAAI,CAEhB,EAEA,SAAA4mB,EAAA,KAAC4a,GAAA,CACC,UAAAj1B,MAACk1B,GAAA,CAAe,UAAU,mCAAoC,GAC9D7a,EAAA,KAAC8a,GAAA,CACC,UAAU,wNAEV,UAACn1B,MAAAo1B,GAAA,CAAa,QAAO,GACnB,SAACp1B,MAAA4zB,GAAA,CAAe,0BAAc,CAChC,GACA5zB,MAACq1B,GAAA,CAAmB,QAAO,GACzB,SAAAr1B,MAAC4zB,GAAe,qCAAwB,CAC1C,GAEA5zB,MAAC,MAAI,WAAU,uDAAwD,GACvEqa,OAAC,MAAI,WAAU,YACb,UAACra,EAAA,UAAG,UAAU,wBAAwB,SAAc,mBACnDA,EAAA,SAAE,UAAU,wBAAwB,SAAqC,2CAC5E,EAEAqa,OAAC,MAAI,WAAU,oCACZ,UAAAma,EAECx0B,MAAC,MAAI,WAAU,oDACb,SAAAqa,EAAA,KAAC,UACC,KAAK,SACL,SAAU,CAACoa,GAAe,CAACX,GAC3B,QAAS,IAAMW,GAAeG,EAAcH,CAAW,EACvD,UAAU,0FAEV,UAACpa,OAAA,OAAI,UAAU,0BACb,UAACra,EAAA,YAAK,UAAU,WAAW,SAAE,cAC5B,MACC,WAACA,EAAA,WAAI,UAAU,cAAc,SAAa,kBAC1Cqa,OAAC,MAAI,WAAU,wBAAwB,uCAEpC,CAACyZ,IACA9zB,EAAA,IAAC,OAAK,WAAU,6BAA6B,SAAwB,8BAEzE,GACF,GACF,EACCA,EAAA,YAAK,UAAU,gBAAgB,SAAC,SAErC,EAGAqa,OAAC,KAAG,WAAU,6EACZ,UAAAra,MAAC,KACC,UAAAqa,EAAA,KAAC,UACC,KAAK,SACL,SAAU,CAAC0a,EACX,QAAS,IAAMA,GAAoBH,EAAcG,CAAgB,EACjE,UAAU,0FAEV,UAAC1a,OAAA,OAAI,UAAU,0BACb,UAACra,EAAA,YAAK,UAAU,WAAW,SAAE,cAC5B,MACC,WAACA,EAAA,WAAI,UAAU,cAAc,SAAc,mBAC1CA,EAAA,WAAI,UAAU,wBAAwB,SAAsB,4BAC/D,GACF,EACCA,EAAA,YAAK,UAAU,gBAAgB,SAAC,SAErC,QACC,KACC,UAAAqa,EAAA,KAAC,UACC,KAAK,SACL,SAAU,CAACoa,GAAe,CAACX,GAC3B,QAAS,IAAMW,GAAeG,EAAcH,CAAW,EACvD,UAAU,0FAEV,UAACpa,OAAA,OAAI,UAAU,0BACb,UAACra,EAAA,YAAK,UAAU,WAAW,SAAE,cAC5B,MACC,WAACA,EAAA,WAAI,UAAU,cAAc,SAAa,kBAC1Cqa,OAAC,MAAI,WAAU,wBAAwB,4CAEpC,CAACyZ,IACA9zB,EAAA,IAAC,OAAK,WAAU,6BAA6B,SAAwB,8BAEzE,GACF,GACF,EACCA,EAAA,YAAK,UAAU,gBAAgB,SAAC,SAErC,GACF,GAGArtC,IAAW,SAAW2hE,IACrBja,OAAA,OAAI,UAAU,sBACb,UAACra,MAAA,KAAE,UAAU,uBACV,SAAAs0B,GAAgB,OAAOr/E,GAAO,SAAW,mBAAmB,CAC/D,GACCq/E,GACCt0B,EAAA,IAAC,UACC,KAAK,SACL,QAAS,IAAM,CACb00B,EAAa,QAAU,GACvBH,EAAgB,IAAI,CACtB,EACA,UAAU,8DACX,qBAED,GAEJ,EAGFv0B,MAAC,MAAI,WAAU,KAAM,IACvB,EAEAA,MAACs1B,GAAA,CAAa,UAAU,0EAA0E,aAAW,QAAQ,SAErH,OACF,GACF,GAGN,CClNO,SAASC,GAAW,CACzB,KAAAC,EACA,MAAAt6B,EACA,YAAAjU,EACA,cAAAwuC,EACA,gBAAAC,EACA,UAAA3nE,CACF,EAAoB,CAEhB,OAAAssD,EAAA,KAAC,OACC,UAAW+V,GACT,mEACAriE,CACF,EAGC,UAAAynE,SACE,MAAI,WAAU,qBACZ,SAAA7O,GAAM,aAAa6O,EAA4B,CAC9C,UAAWpF,GACT,wBACCoF,EAA4B,MAAM,SACrC,CACD,GACH,EAIDx1B,EAAA,UAAG,UAAU,wDACX,SACH9E,EAAA,EAGCjU,GACC+Y,EAAA,IAAC,IAAE,WAAU,mEACV,SACH/Y,EAAA,GAIAwuC,GAAiBC,IAChBrb,EAAA,YAAI,UAAU,6EACZ,UAAAob,EACAC,CAAA,EACH,IAIR,CC1CO,SAASC,GAAkB,CAChC,KAAAH,EACA,MAAAt6B,EACA,YAAAjU,EACA,OAAAwX,EAAS,eACT,QAAAlmC,EACA,UAAAxK,CACF,EAA2B,CACzB,MAAM6nE,EAAe,SAAY,CAC3B,IACF,MAAM52B,GAAa,CAAE,OAAAP,EAAQ,QAAAlmC,CAAS,QACxB,CAEhB,GAIA,OAAAynC,EAAA,IAACu1B,GAAA,CACC,KAAAC,EACA,MAAAt6B,EACA,YAAAjU,EACA,cACE+Y,EAAA,IAAC,UACC,QAAS41B,EACT,UAAU,oGACX,mBAED,EAEF,UAAA7nE,CAAA,EAGN,CCzCA,MAAM8nE,GAAuB,WACvBC,GAAuB,oBACvBC,GAA8B,GAKvBC,GAAoB,IACxB,GAMIC,GAAa,IAAqB,CAI7C,MAAMx5C,EAAY,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACtDy5C,EAAaz5C,EAAU,IAAI,KAAK,GAAKA,EAAU,IAAI,UAAU,EACnE,GAAIy5C,EAEF,OAAAC,GAAWD,CAAU,EACdA,EAIH,MAAAE,EAAgBC,GAAUR,EAAoB,EAChD,GAAAO,EAAsB,OAAAA,EAGtB,IACK,oBAAa,QAAQN,EAAoB,OAC1C,CACC,WACT,CACF,EAKaK,GAAcx1D,GAAuB,CAC5C,IAACq1D,GAAkB,GAAK,CAACr1D,EAAM,OAG7B,MAAA21D,MAAiB,KACvBA,EAAW,QAAQA,EAAW,QAAQ,EAAIP,EAA2B,EAC5D,gBAAS,GAAGF,EAAoB,IAAIl1D,CAAI,aAAa21D,EAAW,YAAa,0BAGlF,IACW,qBAAQR,GAAsBn1D,CAAI,OACzC,CAER,CACF,EAKa41D,GAAe,IAAY,CAE7B,gBAAS,GAAGV,EAAoB,mDAGrC,IACF,aAAa,WAAWC,EAAoB,OACtC,CAER,CACF,EAKMO,GAAalxE,GAAgC,CAEjD,MAAM6oB,EADQ,KAAK,SAAS,MAAM,GACd,MAAM,KAAK7oB,CAAI,GAAG,EAClC,OAAA6oB,EAAM,SAAW,GACZA,EAAM,OAAO,MAAM,GAAG,EAAE,MAAW,OAG9C,EAKawoD,GAAqBC,GACHA,EAGtB,2BAAgBA,CAAY,GAHe,KASvCC,GAAmB,MAAOD,GAA2C,CAC1E,MAAAnwE,EAAOkwE,GAAkBC,CAAY,EAC3C,GAAI,CAACnwE,EAAa,SAEd,IACI,uBAAU,UAAU,UAAUA,CAAI,EACjC,QACD,CAEA,MAAAqwE,EAAW,SAAS,cAAc,UAAU,EAClDA,EAAS,MAAQrwE,EACjBqwE,EAAS,MAAM,SAAW,QAC1BA,EAAS,MAAM,KAAO,YACb,cAAK,YAAYA,CAAQ,EAClCA,EAAS,MAAM,EACfA,EAAS,OAAO,EACZ,IACF,gBAAS,YAAY,MAAM,EACpB,QACD,CACC,gBACP,CACS,cAAK,YAAYA,CAAQ,CACpC,CACF,CACF,EAKaC,GAAoB,MAAO9hC,GAAsE,CAG5G,MAAM+hC,EAAUZ,KAChB,GAAI,CAACY,EAAS,MAAO,CAAE,WAAY,GAAO,OAAQ,SAAU,EAExD,IACF,MAAM15B,EAASlK,KACTzhC,EAAW,MAAM,MAAM,GAAG2rC,CAAM,2BAA4B,CAChE,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,OAAArI,EACA,QAAA+hC,CAAA,CACD,EACF,EAEG,IAACrlE,EAAS,GAEZ,MAAO,CAAE,WAAY,GAAO,OAAQ,gBAAiB,EAGjD,MAAA5Z,EAAS,MAAM4Z,EAAS,OAE1B,OAAA5Z,EAAO,MAAM,YAEF2+E,KACN,CAAE,WAAY,KAGhB,CAAE,WAAY,GAAO,OAAQ3+E,EAAO,MAAM,QAAU,gBAC7C,CAEd,MAAO,CAAE,WAAY,GAAO,OAAQ,OAAQ,CAC9C,CACF,EAKak/E,GAAmB,MAAOhiC,GAAkC,CAGnE,IACF,MAAMqI,EAASlK,KACT,YAAM,GAAGkK,CAAM,2BAA4B,CAC/C,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,OAAArI,EACA,OAAQ,MACT,EACF,OACa,CAGhB,CACF,EAiBaiiC,GAAuB,MAAOjiC,GAAkD,CAGvF,IACF,MAAMqI,EAASlK,KACTzhC,EAAW,MAAM,MAAM,GAAG2rC,CAAM,kCAAkCrI,CAAM,GAAI,CAChF,OAAQ,MACR,QAAS,CACP,eAAgB,kBAClB,EACD,EAEG,OAACtjC,EAAS,KAKC,MAAMA,EAAS,QAChB,MAAQ,UACR,CAEP,WACT,CACF,EAsBawlE,GAA2B,MACtC/hC,EAAgB,GAChBgiC,EAA+B,QACS,CAGpC,IACF,MAAM95B,EAASlK,KACTzhC,EAAW,MAAM,MACrB,GAAG2rC,CAAM,oCAAoClI,CAAK,WAAWgiC,CAAM,GACnE,CACE,OAAQ,MACR,QAAS,CACP,eAAgB,kBAClB,CACF,GAGE,OAACzlE,EAAS,IAKC,MAAMA,EAAS,QAChB,MAAM,OAAS,GAJpB,QAKK,CAEd,MAAO,EACT,CACF,ECpPa0lE,GAAc,IAAyB,CAC5C,MAAE,KAAAzmD,GAASyvB,KACX,CAACi3B,EAAOC,CAAQ,EAAIt4B,WAA+B,IAAI,EACvD,CAACu4B,EAAcC,CAAe,EAAIx4B,WAAS,EAAK,EAEhDy4B,EAAY/K,EAAQ,YAAMwJ,GAAkB,EAAG,CAAE,GAGjDS,EAAejK,UAAQ,IAEvB2K,GAAO,aAAqBA,EAAM,cAGpB1mD,GAAc,eAAiB,IACjC,eAAiB,KAChC,CAAC0mD,EAAO1mD,CAAI,CAAC,EAEV+mD,EAAehL,UAAQ,IACpBgK,GAAkBC,CAAY,EACpC,CAACA,CAAY,CAAC,EAEXgB,EAAevN,cAAY,SAAY,CACvC,MAACqN,GAAa,CAAC9mD,GAAM,IAEzB,CAAA6mD,EAAgB,EAAI,EAChB,IACF,MAAM1lE,EAAO,MAAMmlE,GAAqBtmD,EAAK,EAAE,EAC/C2mD,EAASxlE,CAAI,SACb,CACA0lE,EAAgB,EAAK,CACvB,EACC,GAACC,EAAW9mD,GAAM,EAAE,CAAC,EAGxBsuB,YAAU,IAAM,CACVw4B,GAAa9mD,GAAM,IACRgnD,KAEd,CAACF,EAAW9mD,GAAM,GAAIgnD,CAAY,CAAC,EAEhC,MAAAC,EAAWxN,cAAY,SACtBuM,EACEC,GAAiBD,CAAY,EADV,GAEzB,CAACA,CAAY,CAAC,EAEV,OACL,UAAAc,EACA,aAAAd,EACA,aAAAe,EACA,MAAAL,EACA,aAAAE,EACA,SAAAK,EACA,aAAAD,CAAA,CAEJ,EAiEaE,GAAqB,IAAY,CAC5C54B,YAAU,IAAM,CAId,MAAM64B,EAAY,OAAO,SAAS,SAAS,MAAM,sBAAsB,EACnE,GAAAA,IAAY,CAAC,EAAG,CACPzB,GAAAyB,EAAU,CAAC,CAAC,EACvB,MACF,CAGA,MAAMn7C,EAAY,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACtDo7C,EAAWp7C,EAAU,IAAI,KAAK,GAAKA,EAAU,IAAI,UAAU,EAC7Do7C,GACF1B,GAAW0B,CAAQ,CAEvB,EAAG,CAAE,EACP,EAKaC,GAAyB,IAAY,CAChD,KAAM,CAAE,KAAArnD,EAAM,YAAAgwB,CAAY,EAAIP,GAAe,EACvC,CAAC63B,EAAYC,CAAa,EAAIl5B,WAAS,EAAK,EAElDC,YAAU,IAAM,CACd,GAA4B,CAAC0B,GAAe,CAAChwB,GAAM,IAAMsnD,EAAY,QAE3C,SAAY,CAEpC,GAAI,CADY9B,KACF,QAEC,MAAMW,GAAkBnmD,EAAK,EAAE,GACnC,YAETunD,EAAc,EAAI,CACpB,KAMFlB,GAAiBrmD,EAAK,EAAE,GACvB,CAACA,GAAM,GAAIgwB,EAAas3B,CAAU,CAAC,CACxC,ECnMaE,GAAwC,CAAC,CAAE,SAAA13E,KAAe,CACrE,KAAM,CAAE,KAAAkwB,EAAM,QAASs+C,EAAa,YAAAtuB,CAAA,EAAgBP,KAC9C/xC,EAAWzQ,KACX,CAACw6E,EAASC,CAAU,EAAIr5B,WAAyB,IAAI,EACrD,CAACs5B,EAAUC,CAAW,EAAIv5B,WAAS,EAAI,EAuCzC,OArCJC,YAAU,IAAM,EACK,SAAY,CAC7B,GAAK0B,EAEL,IAAI,CAAChwB,EAAM,CACT0nD,EAAW,EAAK,EAChBE,EAAY,EAAK,EACjB,MACF,CAEI,IAEI,MAAA9lE,EAAM,MAAM,MAAM,GAAG0gC,GAAW,wCAAuCxiB,EAAK,EAAE,GAAI,CACtF,QAAS,CACP,eAAgB,kBAClB,EACD,EAEGle,EAAI,GACN4lE,EAAW,EAAI,GACN5lE,EAAI,SAAW,KAAOA,EAAI,OACnC4lE,EAAW,EAAK,QAKR,CAEVA,EAAW,EAAK,SAChB,CACAE,EAAY,EAAK,CACnB,MAGS,EACV,CAAC5nD,EAAMgwB,CAAW,CAAC,EAElBsuB,GAAe,CAACtuB,GAAe23B,QAE9B,MAAI,WAAU,6DACb,SAAC/d,EAAA,YAAI,UAAU,cACb,UAACra,MAAAuV,EAAA,CAAQ,UAAU,oDAAqD,GACvEvV,EAAA,SAAE,UAAU,iBAAiB,SAAkB,uBAClD,EACF,GAICvvB,EAkBAynD,oBAqBK,SAAA33E,CAAS,SAnBd,MAAI,WAAU,6DACb,SAAC85D,EAAA,YAAI,UAAU,4BACb,UAACra,MAAAuW,GAAA,CAAO,UAAU,qCAAsC,GACvDvW,EAAA,UAAG,UAAU,qCAAqC,SAAa,kBAC/DA,EAAA,SAAE,UAAU,sBAAsB,SAGnC,8GACAA,EAAA,IAAC,UACC,QAAS,IAAM7xC,EAAS,GAAG,EAC3B,UAAU,oFACX,yBAED,EACF,EACF,SAjCC,MAAI,WAAU,6DACb,SAACksD,EAAA,YAAI,UAAU,4BACb,UAACra,MAAAuW,GAAA,CAAO,UAAU,uCAAwC,GACzDvW,EAAA,UAAG,UAAU,qCAAqC,SAAuB,4BACzEA,EAAA,SAAE,UAAU,sBAAsB,SAA6C,kDAChFA,EAAA,IAAC,UACC,QAAS,IAAM7xC,EAAS,GAAG,EAC3B,UAAU,wFACX,qBAED,EACF,EACF,EA0BN,ECvFMmqE,GAAW,CACf,CAAE,KAAM,SAAU,MAAO,WAAY,KAAMhjB,GAAiB,MAAO,EAAK,EACxE,CAAE,KAAM,eAAgB,MAAO,QAAS,KAAM4B,EAAM,EACpD,CAAE,KAAM,iBAAkB,MAAO,UAAW,KAAMC,EAAO,EACzD,CAAE,KAAM,qBAAsB,MAAO,cAAe,KAAMR,EAAO,EACjE,CAAE,KAAM,qBAAsB,MAAO,cAAe,KAAMzB,EAAM,EAChE,CAAE,KAAM,oBAAqB,MAAO,aAAc,KAAMF,EAAK,EAC7D,CAAE,KAAM,eAAgB,MAAO,YAAa,KAAMmB,EAAW,EAC7D,CAAE,KAAM,gBAAiB,MAAO,SAAU,KAAME,EAAS,CAC3D,EAEakiB,GAA0C,CAAC,CAAE,SAAAh4E,KAAe,CACjE,MAAE,KAAAkwB,GAASyvB,KACAxiD,GAAY,EAC7B,MAAM86E,EAAS1mC,GAGb,OAAAuoB,EAAA,KAAC,MAAI,WAAU,iCAEb,UAACA,OAAA,SAAM,UAAU,4DAEf,UAAAra,MAAC,OAAI,UAAU,gCACb,SAACqa,EAAA,YAAI,UAAU,0BACb,UAACra,MAAA,OAAI,UAAU,uEACb,SAAAA,EAAA,IAAC,QAAK,UAAU,+BAA+B,aAAC,CAClD,UACC,MACC,WAACA,EAAA,UAAG,UAAU,2BAA2B,SAAU,eAClDA,EAAA,SAAE,UAAU,yBAAyB,SAAe,qBACvD,GACF,CACF,SAGC,MAAI,WAAU,uCACZ,SAASs4B,GAAA,IAAK51D,GACb23C,EAAA,KAACntD,GAAA,CAEC,GAAIwV,EAAK,KACT,IAAKA,EAAK,MACV,UAAW,CAAC,CAAE,SAAA/U,KACZ,wFACEA,EACI,qCACA,uDACN,GAGF,UAAAqyC,MAACt9B,EAAK,KAAL,CAAU,UAAU,SAAU,GAC9BA,EAAK,QAZDA,EAAK,IAcb,GACH,EAGA23C,OAAC,MAAI,WAAU,0CAEb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAAra,MAAC,MAAI,WAAU,qEACb,SAAAA,EAAA,IAAC,QAAK,UAAU,iCACb,SAAMvvB,GAAA,QAAQ,CAAC,GAAG,eAAiB,GACtC,GACF,EACA4pC,OAAC,MAAI,WAAU,iBACb,UAAAra,MAAC,IAAE,WAAU,8BAA+B,SAAAvvB,GAAM,OAAS,QAAQ,EAClEuvB,EAAA,SAAE,UAAU,yBAAyB,SAAa,mBACrD,GACF,EAGAqa,EAAA,KAAC,UACC,QAAS,IAAM,OAAO,KAAKme,EAAQ,OAAO,EAC1C,UAAU,oJAEV,UAACx4B,MAAAkU,GAAA,CAAY,UAAU,SAAU,GAAE,eAErC,GACF,GACF,EAGAlU,MAAC,QAAK,UAAU,uBACd,eAAC,MAAI,WAAU,MACZ,SAAAz/C,CAAA,CACH,CACF,EACF,GAEJ,EAEAk4E,GAAeF,GCtGFG,GAAsBrjC,GAA0B3tC,IAAS,CACpE,OAAQ,GACR,QAAS,uEACT,eAAiBtU,GACfsU,EAAI,CACF,OAAQ,GACR,QAAStU,GAAW,uEACrB,EACH,MAAO,IAAMsU,EAAI,CAAE,OAAQ,GAAO,CACpC,EAAE,ECdK,SAASixE,IAAqB,CACnC,KAAM,CAAE,OAAAC,EAAQ,QAAAxlF,CAAQ,EAAIslF,GAAoB,EAEhD,OAAKE,EAGH54B,MAAC,MAAI,WAAU,wCACb,SAAAA,MAAC,MAAI,WAAU,oDACb,SAAAqa,EAAA,KAAC,MAAI,WAAU,8BACb,UAAAra,MAAC,OAAI,UAAU,mGACb,eAACoX,GAAO,WAAU,UAAU,CAC9B,GACCpX,EAAA,UAAG,UAAU,sCAAsC,SAAgB,qBACnEA,EAAA,SAAE,UAAU,6BAA8B,SAAQ5sD,EAAA,EAEnDinE,EAAA,KAAC,UACC,KAAK,SACL,QAAS,IAAM,OAAO,SAAS,OAAO,EACtC,UAAU,sJAEV,UAACra,MAAA+V,GAAA,CAAW,UAAU,SAAU,GAAE,SAEpC,GACF,EACF,CACF,GAtBkB,IAwBtB,CCNA,MAAM8iB,GAAmBC,EAAA,KAAK,UAAM,OAAO,4BAAsB,EAAC,8oBAC5DC,GAAsBD,EAAA,KAAK,UAAM,OAAO,+BAAyB,EAAC,shBAClEE,GAA2BF,EAAA,KAAK,UAAM,OAAO,oCAA8B,EAAC,2LAC1DA,OAAK,IAAMjzE,EAAA,WAAO,2BAA4B,EAAC,oWAChDizE,OAAK,IAAMjzE,EAAA,WAAO,0BAA2B,EAAC,kdACrE,MAAMozE,GAA8BH,EAAA,KAAK,UAAM,OAAO,uCAAiC,EAAC,imBAClFI,GAAoBJ,EAAA,KAAK,UAAM,OAAO,6BAAuB,EAAC,iiBAC9DK,GAAmBL,EAAA,KAAK,IAAMjzE,EAAA,WAAO,4BAA6B,EAAC,qNAChDizE,OAAK,UAAM,OAAO,4BAAsB,EAAC,8qBAClE,MAAMM,GAAwBN,EAAA,KAAK,UAAM,OAAO,iCAA2B,EAAC,onBACtEO,GAA6BP,EAAA,KAAK,UAAM,OAAO,sCAAgC,EAAC,wYAChFQ,GAAmBR,EAAA,KAAK,IAAMjzE,EAAA,WAAO,4BAA2B,EAAC,gJACjE0zE,GAA2BT,EAAA,KAAK,UAAM,OAAO,oCAA8B,EAAC,kLAC5EU,GAAwBV,EAAA,KAAK,UAAM,OAAO,iCAA2B,EAAC,yPAGtEW,GAAoBX,OAAK,IAAMjzE,EAAA,+BAAA6zE,EAAA,EAAqC,SACpEC,GAAmBb,OAAK,IAAMjzE,EAAA,+BAAA+zE,EAAA,EAAoC,SAClEC,GAAgBf,OAAK,IAAMjzE,EAAA,+BAAAi0E,EAAA,EAAiC,SAC5DC,GAAqBjB,OAAK,IAAMjzE,EAAA,+BAAAm0E,EAAA,EAAsC,SACtEC,GAAkBnB,OAAK,IAAMjzE,EAAA,+BAAAq0E,EAAA,EAAmC,SAChEC,GAAqBrB,OAAK,IAAMjzE,EAAA,+BAAAu0E,EAAA,EAAsC,SACtEC,GAA2BvB,OAAK,IAAMjzE,EAAA,+BAAAy0E,EAAA,EAAuC,SAC7EC,GAA2BzB,OAAK,IAAMjzE,EAAA,+BAAA20E,EAAA,EAA4C,SAClFC,GAAqB3B,OAAK,IAAMjzE,EAAA,+BAAA60E,EAAA,EAAsC,SACtEC,GAAiB7B,OAAK,IAAMjzE,EAAA,+BAAA+0E,EAAA,EAAkC,SAC9DC,GAAsB/B,OAAK,IAAMjzE,EAAA,+BAAAi1E,EAAA,EAAuC,SACxEC,GAA2BjC,OAAK,IAAMjzE,EAAA,+BAAAm1E,EAAA,EAA4C,SAClFC,GAAkBnC,OAAK,IAAMjzE,EAAA,+BAAAq1E,EAAA,EAAmC,SAiBhE3U,GAAiD,CAAC,CAAE,QAAAnzE,EAAU,YAAa,IAC9E4sD,MAAA,OAAI,UAAU,2DACb,SAACqa,OAAA,OAAI,UAAU,cACb,UAACra,MAAA,OAAI,UAAU,wEAAyE,GACvFA,EAAA,SAAE,UAAU,qBAAsB,SAAQ5sD,EAAA,EAC7C,EACF,GAKI+nF,GAAsDC,EAAA,KAAK,CAAC,CAAE,SAAA76E,KAAe,CACjF,MAAM9M,EAAW4J,KACX8Q,EAAWzQ,KACX,CAAE,KAAM29E,CAAY,EAAIn7B,GAAe,EACvCo7B,EAAkB,CAAC,CAACD,EACpBE,EAAkB36B,SAAentD,EAAS,QAAQ,EAGxDsrD,YAAU,IAAM,CACdw8B,EAAgB,QAAU9nF,EAAS,QACrC,EAAG,CAAE,GAGLsrD,YAAU,IAAM,CACd,MAAMhvC,EAActc,EAAS,SACvB+nF,EAAWD,EAAgB,QAE7BxrE,IAAgByrE,IAElBza,GAAuBya,EAAUzrE,CAAW,EAC5CwrE,EAAgB,QAAUxrE,EAC5B,EACC,CAACtc,EAAS,QAAQ,CAAC,EAGhB,MAAAgoF,EAAgBvR,cAAax3E,GAAqB,CAChD,QAAIA,EAAS,cACnB,OAAO,IAAM,IAAM,EAAI,EAAE,QAAQ,OAAQ,EAAE,CAC7C,EAAG,CAAE,GAECgpF,EAAgBxR,cAAY,IAAM,CAChC,MAAAn2E,EAAO0nF,EAAchoF,EAAS,QAAQ,EACxC,OAAAM,IAAS,KAAOA,IAAS,YAAoB,WAC7CA,IAAS,SAAWA,IAAS,eAAuB,OACpDA,IAAS,eAAuB,cAChCA,IAAS,WAAmB,UAC5BA,IAAS,UAAkB,SAGxB,UACN,GAACN,EAAS,SAAUgoF,CAAa,CAAC,EAE/BE,EAAkBzR,cAAa+G,GAAgB,CAC7C,MAAAl9E,EAAO0nF,EAAchoF,EAAS,QAAQ,EAa5C,GAAI,GAXFM,IAAS,KACTA,IAAS,aACTA,IAAS,SACTA,IAAS,gBACTA,IAAS,gBACTA,IAAS,YACTA,IAAS,aAMLk9E,IAAQ,aAAel9E,IAAS,KAAOA,IAAS,cAChDk9E,IAAQ,SAAWl9E,IAAS,SAAWA,IAAS,iBAChDk9E,IAAQ,eAAiBl9E,IAAS,gBAClCk9E,IAAQ,WAAal9E,IAAS,YAC9Bk9E,IAAQ,UAAYl9E,IAAS,YAenC,QAXA8sE,GAAmBptE,EAAS,QAAQ,EAGRqtE,KAGrB,gBAAS,EAAG,CAAC,EACpB,SAAS,gBAAgB,UAAY,EACrC,SAAS,KAAK,UAAY,EAGlBmQ,EAAK,CACX,IAAK,WACH9iE,EAAS,GAAG,EACZ,MACF,IAAK,OACHA,EAAS,cAAc,EACvB,MACF,IAAK,cACHA,EAAS,cAAc,EACvB,MACF,IAAK,UACHA,EAAS,UAAU,EACnB,MACF,IAAK,SACHA,EAAS,SAAS,EAClB,MACF,QACEA,EAAS,GAAG,CAChB,CAGA,sBAAsB,IAAM,CACnB,gBAAS,EAAG,CAAC,EACpB,SAAS,gBAAgB,UAAY,EACrC,SAAS,KAAK,UAAY,EAE1B,WAAW,IAAM,CACHyyD,GAAA,CAAE,SAAU,UAAW,GAClC,EAAE,EACN,IACA,CAACzyD,EAAU1a,CAAQ,CAAC,EAEjBmoF,EAAsB1R,cAAY,SACjCoR,EAKE,IAJLhgC,GAAgB,SAAS,GACV,MAAM0D,GAAa,CAAE,OAAQ,mBAAqB,IACnD,SAAW,WAG1B,CAACs8B,CAAe,CAAC,EAEdO,EAAiB3R,cAAY,IAAM,EAC3B,SAAY,CACN,MAAM0R,MAEtB/a,GAAmBptE,EAAS,QAAQ,EACRqtE,KAC5B3yD,EAAS,SAAS,KAEX,GACR,CAACA,EAAU1a,EAAS,SAAUmoF,CAAmB,CAAC,EAI/CjL,GAAW,IAAM,CACf,MAAAzwC,EAAIu7C,EAAchoF,EAAS,QAAQ,EAClC,OAAAysC,IAAM,KAAOA,IAAM,gBAG5B,OACGm6B,OAAA,OAAI,UAAU,wCAAwC,wBAAqB,GAC1E,UAAAra,EAAA,IAAC24B,GAAmB,IAGnB34B,EAAA,YAAK,UAAU,qDACd,SAACA,EAAA,IAAA+mB,WAAA,CAAS,SAAU/mB,EAAA,IAACumB,GAAe,SAAQ,iBAAkB,GAC3D,SAAAhmE,CACH,GACF,EAGAy/C,EAAA,IAACwwB,GAAA,CACC,UAAWkL,EAAc,EACzB,YAAaC,EACb,QAAAhL,EACA,WAAYkL,CAAA,CACd,QAGCna,GAAsB,UAGtB4D,GAAkB,IAGnBtlB,EAAA,IAAC87B,GAAA,CACC,SAAS,aACT,eAAgB,CAAE,OAAQ,UAAW,EACrC,aAAc,CACZ,SAAU,IACV,MAAO,CACL,WAAY,UACZ,MAAO,OACP,OAAQ,UACV,CACF,EACF,CACF,GAEJ,CAAC,EAEDX,GAAW,YAAc,aAGzB,MAAMY,GAA6B,IAAM,CACvC,KAAM,CAAE,KAAMV,EAAa,QAAAlqD,EAAS,YAAa6qD,CAAA,EAAuB97B,KAClE,CAAE,eAAA+7B,EAAgB,gBAAiBC,EAAoB,YAAaC,EAAkB,KAAMC,GAAc1/B,IAG7F,OAAAi7B,KACIG,KAGvB/4B,YAAU,IAAM,CACd,GAAIi9B,EAEF,GAAIX,GAAelqD,EAAS,CACpB,MAAAkrD,EAAmB3/B,EAAa,WAAW,KAIjD,GAAI,CAHqBA,EAAa,WAAW,iBAGxB,CAAC2/B,GAAoBA,EAAiB,KAAOhB,EAAY,GAAI,CAEpF,MAAM1+B,EAAgB,CACpB,GAAI0+B,EAAY,GAChB,UAAWA,EAAY,eAAe,WAAaA,EAAY,eAAe,YAAcA,EAAY,eAAe,WAAW,MAAM,GAAG,EAAE,CAAC,GAAK,OACnJ,SAAUA,EAAY,eAAe,UAAYA,EAAY,eAAe,WAAaA,EAAY,eAAe,WAAW,MAAM,GAAG,EAAE,MAAM,CAAC,EAAE,KAAK,GAAG,GAAK,GAChK,MAAOA,EAAY,OAAS,GAC5B,MAAOA,EAAY,MACnB,OAAQA,EAAY,eAAe,YAAcA,EAAY,eAAe,QAC5E,SAAUA,EAAY,cAAc,UAAY,QAChD,UAAWA,EAAY,YAIzB3+B,EAAa,SAAS,CACpB,gBAAiB,GACjB,KAAMC,EACN,MAAOxrB,EAAQ,aACf,QAAS,GACT,YAAa,GACb,cAAe,KAAK,IAAI,EACzB,CACH,MAGO,CAACkqD,GAAea,GAEvBx/B,EAAa,SAAS,CACpB,gBAAiB,GACjB,KAAM,KACN,MAAO,KACP,cAAe,EAChB,GAGJ,CAAC2+B,EAAalqD,EAAS6qD,EAAoBE,CAAkB,CAAC,EAEjEn9B,YAAU,IAAM,CAEKU,IACrB,EAAG,CAAE,GAEE,IACT,EAGM68B,GAAgC,IAAM,CAC1C,MAAM7oF,EAAW4J,KACX8Q,EAAWzQ,KAEX6+E,EAA0BrS,cAAY,IAAM,CAChDrJ,GAAmBptE,EAAS,QAAQ,EACpC0a,EAAS,UAAU,CAClB,GAACA,EAAU1a,EAAS,QAAQ,CAAC,EAE1B+oF,EAA6BtS,cAAah1B,GAAyB,CAEvE2rB,GAAmBptE,EAAS,QAAQ,EAC9B,MAAAkxB,EAAW,GAAGlxB,EAAS,QAAQ,GAAGA,EAAS,MAAM,GAAGA,EAAS,IAAI,GAC9D0a,EAAA,eAAe+mC,CAAY,GAAI,CACtC,MAAO,CAAE,KAAMvwB,CAAS,EACzB,GACA,CAACxW,EAAU1a,EAAS,SAAUA,EAAS,OAAQA,EAAS,IAAI,CAAC,EAG5D,OAAAusD,EAAA,IAAC64B,GAAA,CACC,oBAAqB0D,EACrB,uBAAwBC,CAAA,EAGhC,EAEMC,GAAmC,IAAM,CAC7C,MAAMhpF,EAAW4J,KACX8Q,EAAWzQ,KAEXg/E,EAA2BxS,cAAY,IAAM,CACjDrJ,GAAmBptE,EAAS,QAAQ,EACpC0a,EAAS,GAAG,CACX,GAACA,EAAU1a,EAAS,QAAQ,CAAC,EAG5B,OAAAusD,EAAA,IAAC+4B,GAAoB,sBAAsB2D,CAA0B,EAE3E,EAEMC,GAAwC,IAAM,CACjCt/E,GAAY,EAC7B,MAAM8Q,EAAWzQ,KACX,CAAE,KAAM29E,EAAa,QAASuB,CAAA,EAAmB18B,KACjDo7B,EAAkB,CAAC,CAACD,EACpBwB,EAAkBj8B,SAAO,EAAK,EAE9Bk8B,EAAqB5S,cAAY,IAAM,CAEfpJ,KAC5B3yD,EAAS,GAAG,GACX,CAACA,CAAQ,CAAC,EAUb,OARA4wC,YAAU,IAAM,CACV,CAACu8B,GAAmB,CAACsB,GAAkB,CAACC,EAAgB,UAC1DA,EAAgB,QAAU,GAC1BvhC,GAAgB,SAAS,EACpB0D,GAAa,CAAE,OAAQ,mBAAqB,GACnD,EACC,CAACs8B,EAAiBsB,CAAc,CAAC,EAE/BtB,EAgBHt7B,MAACwmB,GAAY,OAAM,oBACjB,SAAAxmB,EAAA,IAACg5B,GAAA,CACC,eAAgB8D,CAAA,CAEpB,UAlBGtW,GAAY,OAAM,oBACjB,SAACxmB,EAAA,WAAI,UAAU,aACb,SAAAA,EAAA,IAAC21B,GAAA,CACC,KAAM31B,MAACyW,GAAS,WAAU,4BAA6B,GACvD,MAAM,gCACN,YAAY,yGACZ,OAAO,qBAEX,EACF,EAWN,EA0GMsmB,GAAmC,UAC/BvW,GAAY,OAAM,cAAc,SAAAxmB,MAACq5B,KAA2B,CAAE,GAGlE2D,GAA0C,IAAM,CAC9C,MAAE,GAAA/6E,GAAO7D,KACT+P,EAAWzQ,KACX,CAACu/E,EAAYC,CAAa,EAAIvW,GAAM,SAAwB,IAAI,EAChE,CAACyR,EAAUC,CAAW,EAAI1R,GAAM,SAAkB,EAAI,EAEtDmW,EAAqB5S,cAAY,IAAM,CAIvC,OAAO,QAAQ,OAAS,EAE1B,OAAO,QAAQ,QAGapJ,KAC5B3yD,EAAS,GAAG,EACd,EACC,CAACA,CAAQ,CAAC,EAkCb,OAhCAw4D,GAAM,UAAU,IAAM,EACR,SAAY,CACtB,GAAI,CAAC1kE,EAAI,CACPo2E,EAAY,EAAK,EACjB,MACF,CAEI,GADc,kEACJ,KAAKp2E,CAAE,EAAG,CACtBi7E,EAAcj7E,CAAE,EAChBo2E,EAAY,EAAK,EACjB,MACF,CAEI,IACF,MAAM7V,GAAW,MAAA38D,EAAA,IAAM,QAAiB,mBAAAs3E,EAAA,WAAG,YACrCn/D,EAAI,MAAM,MAAM,GAAGwkD,CAAO,oCAAoC,mBAAmBvgE,CAAE,CAAC,GAAI,CAAE,OAAQ,KAAO,GAC/G,GAAI,CAAC+b,EAAE,GAAI,MAAM,IAAI,MAAM,kBAAkBA,EAAE,MAAM,EAAE,EACjD,MAAA4lC,EAAI,MAAM5lC,EAAE,OACd4lC,GAAG,IACLs5B,EAAct5B,EAAE,EAAE,OAIV,SAEV,CACAy0B,EAAY,EAAK,CACnB,KAEE,EACH,CAACp2E,CAAE,CAAC,EAEFA,EAiBDm2E,EACKp4B,EAAA,IAACumB,GAAe,SAAQ,uBAAwB,GAIpD0W,EAiBEj9B,EAAA,IAACi5B,GAA4B,cAAcgE,CAAY,SAfzD,MAAI,WAAU,2DACb,SAAC5iB,EAAA,YAAI,UAAU,cACb,UAACra,EAAA,UAAG,UAAU,2CAA2C,SAAoB,yBAC5EA,EAAA,SAAE,UAAU,qBAAqB,SAAgD,qDAClFA,EAAA,IAAC,UACC,QAAS88B,EACT,UAAU,sEACX,mBAED,EACF,EACF,SAjCG,MAAI,WAAU,2DACb,SAACziB,EAAA,YAAI,UAAU,cACb,UAACra,EAAA,UAAG,UAAU,2CAA2C,SAAoB,yBAC5EA,EAAA,SAAE,UAAU,qBAAqB,SAAgD,qDAClFA,EAAA,IAAC,UACC,QAAS88B,EACT,UAAU,sEACX,mBAED,EACF,EACF,EA2BR,EAIMM,GAAuB,IAAM,CAC3B,MAAE,iBAAAC,GAAqBjoC,KACvB,CAAE,eAAA6mC,EAAgB,QAASqB,EAAc,YAAanB,CAAA,EAAqBz/B,IAC3E,CAAE,gBAAA6gC,GAAoBv/B,KAGtB,CAAE,KAAMq9B,EAAa,QAASuB,EAAgB,YAAaZ,GAAuB97B,KAGlFK,EAAUq8B,GAAkBU,EAC5BhC,EAAkB,CAAC,CAACD,EAI1Bt8B,mBAAU,IAAM,CACd,GAAI,CAACo9B,GAAoB,CAACmB,GAAgBtB,EACpC,IAGEX,GAIWY,SAED,CAEhB,CACF,EACC,CAACA,EAAgBE,EAAkBmB,EAActB,EAAoBX,CAAW,CAAC,EAGpFt8B,YAAU,IAAM,CACV,GAAAu8B,GAAmB,CAAC/6B,GAAWy7B,EAC7B,IAIeqB,IAGDE,SAGF,CAEhB,CACF,EACC,CAACjC,EAAiB/6B,EAASy7B,EAAoBqB,EAAkBE,CAAe,CAAC,EAGpFx+B,YAAU,IAAM,CACVi9B,GAAsB,CAACt/B,EAAa,WAAW,aAEjDA,EAAa,SAAS,CAAE,YAAa,GAAM,QAAS,GAAO,CAC7D,EACC,CAACs/B,CAAkB,CAAC,SAGdpN,GACD,WAAC5uB,EAAA,IAAA2vB,GAAA,CACD,eAAC5I,WAAS,gBAAW+I,GAAmB,IACtC,gBAAC9sE,GAEC,WAAAg9C,EAAA,IAAC39C,EAAA,CACC,KAAK,SACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAy5B,GAAA,EAAkB,EACrB,CACF,GAEJ,EACAz5B,EAAA,IAAC39C,EAAA,CACC,KAAK,eACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAA25B,GAAA,EAAiB,EACpB,CACF,GAEJ,EACA35B,EAAA,IAAC39C,EAAA,CACC,KAAK,eACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAA65B,GAAA,EAAc,EACjB,CACF,GAEJ,EACA75B,EAAA,IAAC39C,EAAA,CACC,KAAK,uBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAA+5B,GAAA,EAAmB,EACtB,CACF,GAEJ,EACA/5B,EAAA,IAAC39C,EAAA,CACC,KAAK,iBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAi6B,GAAA,EAAgB,EACnB,CACF,GAEJ,EACAj6B,EAAA,IAAC39C,EAAA,CACC,KAAK,yBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAm6B,GAAA,EAAmB,EACtB,CACF,GAEJ,EACAn6B,EAAA,IAAC39C,EAAA,CACC,KAAK,qBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAq6B,GAAA,EAAyB,EAC5B,CACF,GAEJ,EACAr6B,EAAA,IAAC39C,EAAA,CACC,KAAK,mCACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAu6B,GAAA,EAAyB,EAC5B,CACF,GAEJ,EACAv6B,EAAA,IAAC39C,EAAA,CACC,KAAK,oBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAy6B,GAAA,EAAmB,EACtB,CACF,GAEJ,EACAz6B,EAAA,IAAC39C,EAAA,CACC,KAAK,gBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAA26B,GAAA,EAAe,EAClB,CACF,GAEJ,EACA36B,EAAA,IAAC39C,EAAA,CACC,KAAK,qBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAA66B,GAAA,EAAoB,EACvB,CACF,GAEJ,EACA76B,EAAA,IAAC39C,EAAA,CACC,KAAK,mCACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAA+6B,GAAA,EAAyB,EAC5B,CACF,GAEJ,EACA/6B,EAAA,IAAC39C,EAAA,CACC,KAAK,iBACL,cACG41E,GACC,UAAAj4B,MAACu4B,IACC,SAACv4B,MAAAi7B,GAAA,EAAgB,EACnB,CACF,GAEJ,EACAj7B,EAAA,IAAC39C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","names":["m","require$$0","client","PopStateEventType","createBrowserHistory","options","createBrowserLocation","window2","globalHistory","pathname","search","hash","createLocation","createBrowserHref","to","createPath","getUrlBasedHistory","invariant","value","message","warning","cond","createKey","getHistoryState","location","index","current","state","key","parsePath","path","parsedPath","hashIndex","searchIndex","getLocation","createHref2","validateLocation","v5Compat","action","listener","getIndex","handlePop","nextIndex","delta","history","push","historyState","url","error","replace2","createURL","createBrowserURLImpl","fn","n","isAbsolute","base","href","matchRoutes","routes","locationArg","basename","matchRoutesImpl","allowPartial","stripBasename","branches","flattenRoutes","rankRouteBranches","matches","i","decoded","decodePath","matchRouteBranch","parentsMeta","parentPath","_hasParentOptionalSegments","flattenRoute","route","hasParentOptionalSegments","relativePath","meta","joinPaths","routesMeta","computeScore","exploded","explodeOptionalSegments","segments","first","rest","isOptional","required","restExploded","result","subpath","a","b","compareIndexes","paramRe","dynamicSegmentValue","indexRouteValue","emptySegmentValue","staticSegmentValue","splatPenalty","isSplat","initialScore","s","score","segment","branch","matchedParams","matchedPathname","end","remainingPathname","match","matchPath","normalizePathname","pattern","matcher","compiledParams","compilePath","pathnameBase","captureGroups","memo2","paramName","splatValue","caseSensitive","params","regexpSource","_","v","startIndex","nextChar","ABSOLUTE_URL_REGEX","isAbsoluteUrl","resolvePath","fromPathname","toPathname","oldPathname","resolvePathname","normalizeSearch","normalizeHash","getInvalidPathError","char","field","dest","getPathContributingMatches","getResolveToMatches","pathMatches","idx","resolveTo","toArg","routePathnames","locationPathname","isPathRelative","isEmptyPath","from","routePathnameIndex","toSegments","hasExplicitTrailingSlash","hasCurrentTrailingSlash","paths","isRouteErrorResponse","validMutationMethodsArr","validRequestMethodsArr","DataRouterContext","React.createContext","DataRouterStateContext","ViewTransitionContext","FetchersContext","AwaitContext","NavigationContext","LocationContext","RouteContext","RouteErrorContext","useHref","relative","useInRouterContext","navigator","React2.useContext","useResolvedPath","joinedPathname","useLocation","navigateEffectWarning","useIsomorphicLayoutEffect","cb","React2.useLayoutEffect","useNavigate","isDataRoute","useNavigateStable","useNavigateUnstable","dataRouterContext","routePathnamesJson","activeRef","React2.useRef","React2.useCallback","React2.createContext","useParams","routeMatch","React2.useMemo","useRoutes","useRoutesImpl","dataRouterState","unstable_onError","future","parentMatches","parentParams","parentPathname","parentPathnameBase","parentRoute","warningOnce","locationFromContext","parsedLocationArg","parentSegments","renderedMatches","_renderMatches","React2.createElement","DefaultErrorComponent","useRouteError","stack","lightgrey","preStyles","codeStyles","devInfo","React2.Fragment","defaultErrorElement","RenderErrorBoundary","React2.Component","props","errorInfo","RenderedRoute","routeContext","children","errors","errorIndex","renderFallback","fallbackIndex","loaderData","errors2","needsToRunLoader","onError","outlet","shouldRenderHydrateFallback","errorElement","hydrateFallbackElement","matches2","getChildren","getDataRouterConsoleError","hookName","useDataRouterContext","ctx","useDataRouterState","useRouteContext","useCurrentRouteId","thisRoute","useRouteId","routeId","router","id","alreadyWarned","React3.memo","DataRoutes","Route","Router","basenameProp","locationProp","navigationType","staticProp","navigationContext","React3.useMemo","locationContext","trailingPathname","React3.createElement","Routes","createRoutesFromChildren","React3.Children","element","React3.isValidElement","treePath","React3.Fragment","defaultMethod","defaultEncType","isHtmlElement","object","isButtonElement","isFormElement","isInputElement","isModifiedEvent","event","shouldProcessLinkClick","target","createSearchParams","init","getSearchParamsForLocation","locationSearch","defaultSearchParams","searchParams","_formDataSupportsSubmitter","isFormDataSubmitterSupported","supportedFormEncTypes","getFormEncType","encType","getFormSubmissionInfo","method","formData","body","attr","form","name","type","prefix","invariant2","singleFetchUrl","reqUrl","extension","loadRouteModule","routeModulesCache","routeModule","__vitePreload","isPageLinkDescriptor","isHtmlLinkDescriptor","getKeyedPrefetchLinks","manifest","routeModules","links","mod","dedupeLinkDescriptors","link","getNewMatchesForLinks","page","nextMatches","currentMatches","mode","isNew","matchPathChanged","manifestRoute","routeChoice","getModuleLinkHrefs","includeHydrateFallback","dedupeHrefs","hrefs","sortKeys","obj","sorted","keys","descriptors","preloads","set","preloadsSet","deduped","descriptor","useDataRouterContext2","context","React8.useContext","useDataRouterStateContext","FrameworkContext","React8.createContext","useFrameworkContext","usePrefetchBehavior","prefetch","theirElementProps","frameworkContext","maybePrefetch","setMaybePrefetch","React8.useState","shouldPrefetch","setShouldPrefetch","onFocus","onBlur","onMouseEnter","onMouseLeave","onTouchStart","ref","React8.useRef","React8.useEffect","callback","entries","entry","observer","setIntent","cancelIntent","composeEventHandlers","theirHandler","ourHandler","PrefetchPageLinks","linkProps","React8.useMemo","React8.createElement","PrefetchPageLinksImpl","useKeyedPrefetchLinks","keyedPrefetchLinks","setKeyedPrefetchLinks","interrupted","newMatchesForData","newMatchesForAssets","dataHrefs","routesParams","foundOptOutRoute","m2","moduleHrefs","React8.Fragment","mergeRefs","refs","isBrowser","BrowserRouter","historyRef","React10.useRef","setStateImpl","React10.useState","setState","React10.useCallback","newState","React10.startTransition","React10.useLayoutEffect","React10.createElement","ABSOLUTE_URL_REGEX2","Link","React10.forwardRef","onClick","discover","reloadDocument","preventScrollReset","viewTransition","forwardedRef","React10.useContext","absoluteHref","isExternal","currentUrl","targetUrl","prefetchRef","prefetchHandlers","internalOnClick","useLinkClickHandler","handleClick","React10.Fragment","NavLink","ariaCurrentProp","classNameProp","styleProp","routerState","isTransitioning","useViewTransitionState","nextLocationPathname","endSlashPosition","isActive","isPending","renderProps","ariaCurrent","className","style","Form","fetcherKey","navigate","onSubmit","submit","useSubmit","formAction","useFormAction","formMethod","submitHandler","submitter","submitMethod","getDataRouterConsoleError2","useDataRouterContext3","replaceProp","useSearchParams","defaultInit","defaultSearchParamsRef","hasSetSearchParamsRef","React10.useMemo","setSearchParams","nextInit","navigateOptions","newSearchParams","fetcherId","getUniqueFetcherId","currentRouteId","indexValues","qs","vtContext","currentPath","nextPath","resolveFetch","customFetch","args","FunctionsError","FunctionsFetchError","FunctionsRelayError","FunctionsHttpError","FunctionRegion","FunctionsClient","headers","region","token","functionName_1","__awaiter","functionName","_a","timeoutId","timeoutController","functionArgs","signal","timeout","_headers","effectiveSignal","response","fetchError","isRelayError","responseType","data","PostgrestError_1","PostgrestError","PostgrestBuilder_1","require$$1","PostgrestBuilder","builder","_b","onfulfilled","onrejected","_fetch","res","_c","_d","count","status","statusText","countHeader","contentRange","_e","_f","errorDetails","cause","causeMessage","causeCode","PostgrestTransformBuilder_1","PostgrestTransformBuilder","columns","quoted","cleanedColumns","c","column","ascending","nullsFirst","foreignTable","referencedTable","existingOrder","keyOffset","keyLimit","analyze","verbose","settings","buffers","wal","format","forMediatype","PostgrestFilterBuilder_1","PostgrestReservedCharsRegexp","PostgrestFilterBuilder","patterns","values","cleanedValues","range","query","config","typePart","configPart","operator","filters","PostgrestQueryBuilder_1","PostgrestQueryBuilder","schema","fetch","head","defaultToNull","acc","x","uniqueColumns","onConflict","ignoreDuplicates","PostgrestClient_1","tslib_1","require$$2","PostgrestClient","relation","get","cjs","require$$3","require$$4","require$$5","require$$6","_default","index.default","WebSocketFactory","processVersions","versionString","nodeVersion","env","errorMessage","protocols","WS","version","DEFAULT_VERSION","VSN_1_0_0","VSN_2_0_0","DEFAULT_VSN","DEFAULT_TIMEOUT","WS_CLOSE_NORMAL","MAX_PUSH_BUFFER_SIZE","SOCKET_STATES","CHANNEL_STATES","CHANNEL_EVENTS","TRANSPORTS","CONNECTION_STATE","Serializer","allowedMetadataKeys","msg","payload","userPayload","encodedUserPayload","encodingType","encodedPayload","topic","joinRef","userEvent","metadata","metaLength","header","view","offset","combined","rawPayload","jsonPayload","join_ref","buffer","kind","decoder","topicSize","userEventSize","metadataSize","payloadEncoding","parsedPayload","Timer","timerCalc","PostgresTypes","convertChangeData","record","skipTypes","rec_key","convertColumn","columnName","colType","convertCell","noop","dataType","toArray","toBoolean","toNumber","toJson","toTimestampString","parsedValue","lastIdx","closeBrace","arr","valTrim","val","httpEndpointURL","socketUrl","wsUrl","Push","channel","h","REALTIME_PRESENCE_LISTEN_EVENTS","RealtimePresence","opts","events","onJoin","onLeave","onSync","diff","currentPresences","newPresences","leftPresences","currentState","transformedState","joins","leaves","presences","newPresenceRefs","curPresenceRefs","joinedPresences","joinedPresenceRefs","curPresences","presenceRefsToRemove","func","presence","REALTIME_POSTGRES_CHANGES_LISTEN_EVENT","REALTIME_LISTEN_TYPES","REALTIME_SUBSCRIBE_STATES","RealtimeChannel","socket","pushEvent","reason","broadcast","isPrivate","postgres_changes","r","presence_enabled","accessTokenPayload","e","clientPostgresBindings","bindingsLen","newPostgresBindings","clientPostgresBinding","table","filter","serverPostgresFilter","authorization","errorBody","endpoint_payload","resolve","onClose","leavePush","controller","removedPush","_event","_ref","typeLower","close","leave","join","handledPayload","bind","bindId","bindEvent","postgresChanges","commit_timestamp","binding","obj1","obj2","k","records","Transformers.convertChangeData","CONNECTION_TIMEOUTS","RECONNECT_INTERVALS","DEFAULT_RECONNECT_FALLBACK","WORKER_SCRIPT","RealtimeClient","endPoint","code","fallbackTimer","values_1","realtimeTopic","exists","chan","newRef","dupChannel","rawMessage","refString","timer","objectUrl","result_url","blob","manual","tokenToSend","_g","_h","_j","_k","_l","_m","tries","StorageError","isStorageError","StorageApiError","statusCode","StorageUnknownError","originalError","resolveResponse","recursiveToCamel","item","el","newKey","isPlainObject","prototype","isValidBucketName","bucketName","_getErrorMessage","err","handleError","reject","Res","_getRequestParams","parameters","_handleRequest","fetcher","post","put","remove","StreamDownloadBuilder","downloadFn","shouldThrowOnError","BlobDownloadBuilder","onfinally","BlobDownloadBuilder$1","DEFAULT_SEARCH_OPTIONS","DEFAULT_FILE_OPTIONS","StorageFileApi","bucketId","fileBody","fileOptions","cleanPath","_path","fromPath","toPath","expiresIn","downloadQueryParam","datum","renderPath","transformationQuery","queryString","_queryString","transform","DEFAULT_HEADERS","StorageBucketApi","baseUrl","id_1","IcebergError","buildUrl","buildAuthHeaders","auth","createFetchClient","fetchFn","authHeaders","text","isJson","errBody","errorDetail","namespaceToPath","namespace","NamespaceOperations","parent","ns","request","namespaceToPath2","TableOperations","accessDelegation","IcebergRestCatalog","StorageAnalyticsClient","queryParams","StorageVectorsError","isStorageVectorsError","StorageVectorsApiError","StorageVectorsUnknownError","StorageVectorsErrorCode","responseError","contentType","VectorIndexApi","vectorBucketName","indexName","VectorDataApi","VectorBucketApi","StorageVectorsClient","VectorBucketScope","_super","VectorIndexScope","StorageClient","JS_ENV","DEFAULT_GLOBAL_OPTIONS","DEFAULT_DB_OPTIONS","DEFAULT_AUTH_OPTIONS","DEFAULT_REALTIME_OPTIONS","resolveHeadersConstructor","fetchWithAuth","supabaseKey","getAccessToken","HeadersConstructor","input","accessToken","ensureTrailingSlash","applySettingDefaults","defaults","dbOptions","authOptions","realtimeOptions","globalOptions","validateSupabaseUrl","supabaseUrl","trimmedUrl","AUTO_REFRESH_TICK_DURATION_MS","AUTO_REFRESH_TICK_THRESHOLD","EXPIRY_MARGIN_MS","GOTRUE_URL","STORAGE_KEY","API_VERSION_HEADER_NAME","API_VERSIONS","BASE64URL_REGEX","JWKS_TTL","AuthError","isAuthError","AuthApiError","isAuthApiError","AuthUnknownError","CustomAuthError","AuthSessionMissingError","isAuthSessionMissingError","AuthInvalidTokenResponseError","AuthInvalidCredentialsError","AuthImplicitGrantRedirectError","details","isAuthImplicitGrantRedirectError","AuthPKCEGrantCodeExchangeError","AuthRetryableFetchError","isAuthRetryableFetchError","AuthWeakPasswordError","reasons","AuthInvalidJwtError","TO_BASE64URL","IGNORE_BASE64URL","FROM_BASE64URL","charMap","byteToBase64URL","byte","emit","pos","byteFromBase64URL","charCode","bits","stringFromBase64URL","str","conv","utf8Emit","codepoint","utf8State","b64State","byteEmit","stringFromUTF8","codepointToUTF8","stringToUTF8","highSurrogate","leadingBit","base64UrlToUint8Array","onByte","stringToUint8Array","bytesToBase64URL","bytes","onChar","expiresAt","generateCallbackId","localStorageWriteTests","supportsLocalStorage","randomKey","parseParametersFromURL","looksLikeFetchResponse","maybeResponse","setItemAsync","storage","getItemAsync","removeItemAsync","Deferred","rej","decodeJWT","parts","sleep","time","accept","retryable","isRetryable","attempt","dec2hex","dec","generatePKCEVerifier","array","charSet","charSetLen","verifier","sha256","randomString","encodedData","generatePKCEChallenge","hashed","getCodeChallengeAndMethod","storageKey","isPasswordRecovery","codeVerifier","storedCodeVerifier","codeChallenge","API_VERSION_REGEX","parseResponseAPIVersion","apiVersion","validateExp","exp","timeNow","getAlgorithm","alg","UUID_REGEX","validateUUID","userNotAvailableProxy","proxyTarget","prop","sProp","_target","insecureUserWarningProxy","user","suppressWarningRef","receiver","deepClone","NETWORK_ERROR_CODES","errorCode","responseAPIVersion","_request","requestParams","_sessionResponse","session","hasSession","_sessionResponsePassword","_userResponse","_ssoResponse","_generateLinkResponse","action_link","email_otp","hashed_token","redirect_to","verification_type","__rest","properties","_noResolveJsonResponse","SIGN_OUT_SCOPES","GoTrueAdminApi","jwt","scope","email","attributes","pagination","users","total","rel","uid","shouldSoftDelete","factors","clients","clientId","memoryLocalStorageAdapter","store","internals","LockAcquireTimeoutError","NavigatorLockAcquireTimeoutError","navigatorLock","acquireTimeout","abortController","lock","polyfillGlobalThis","getAddress","address","fromHex","hex","toHex","createSiweMessage","chainId","domain","expirationTime","issuedAt","nonce","notBefore","requestId","resources","scheme","uri","origin","statement","suffix","content","resource","WebAuthnError","WebAuthnUnknownError","identifyRegistrationError","publicKey","param","effectiveDomain","isValidDomain","identifyAuthenticationError","WebAuthnAbortService","abortError","newController","webAuthnAbortService","deserializeCredentialCreationOptions","challengeStr","userOpts","excludeCredentials","restOptions","challenge","cred","deserializeCredentialRequestOptions","allowCredentials","serializeCredentialCreationResponse","credential","credentialWithAttachment","serializeCredentialRequestResponse","clientExtensionResults","assertionResponse","hostname","browserSupportsWebAuthn","createCredential","getCredential","DEFAULT_CREATION_OPTIONS","DEFAULT_REQUEST_OPTIONS","deepMerge","sources","isObject","isArrayBufferLike","source","existing","mergeCredentialCreationOptions","baseOptions","overrides","mergeCredentialRequestOptions","WebAuthnApi","factorId","webauthn","friendlyName","challengeResponse","challengeError","abortSignal","challengeId","rpId","rpOrigins","factor","enrollError","DEFAULT_OPTIONS","lockNoOp","GLOBAL_JWKS","GoTrueClient","callbackUrlType","redirectType","credentials","password","codeChallengeMethod","phone","invalidTokenError","authCode","chain","signature","wallet","resolvedWallet","windowAny","accounts","accs","chainIdHex","siweMessage","output","outputToProcess","maybeSignature","storageItem","provider","access_token","redirectTo","captchaToken","sessionError","endpoint","last","waitOn","currentSession","maybeSession","hasExpired","maybeUser","sessionData","userError","refreshedSession","provider_token","provider_refresh_token","refresh_token","expires_in","expires_at","token_type","currentStorageContent","subscription","identity","refreshToken","debugName","startedAt","nextBackOffInterval","separateUser","expiresWithMargin","getUserError","promises","sessionToProcess","userIsProxy","mainSessionData","clonedMainSessionData","clonedSession","ticker","now","expiresInTicks","calledFromInitialize","methodName","urlParams","flowParams","challengeData","currentLevel","nextLevel","currentAuthenticationMethods","authorizationId","kid","jwks","jwk","rawHeader","signingKey","algorithm","AuthClient","SupabaseAuthClient","SupabaseClient","defaultStorageKey","DEFAULTS","SupabaseStorageClient","autoRefreshToken","persistSession","detectSessionInUrl","userStorage","flowType","debug","throwOnError","createClient","shouldShowDeprecationWarning","processVersion","versionMatch","ExceptionCode","CapacitorException","getPlatformId","win","createCapacitor","capCustomPlatform","cap","Plugins","getPlatform","isNativePlatform","isPluginAvailable","pluginName","plugin","registeredPlugins","getPluginHeader","registerPlugin","jsImplementations","registeredPlugin","platform","pluginHeader","jsImplementation","loadPluginImplementation","createPluginMethod","impl","methodHeader","createPluginMethodWrapper","wrapper","p","addListener","removeListener","addListenerNative","eventName","call","callbackId","proxy","filePath","initCapacitorGlobal","Capacitor","WebPlugin","listenerFunc","firstListener","windowListener","retainUntilConsumed","listeners","windowEventName","pluginEventName","handle","arg","encode","decode","CapacitorCookiesPluginWeb","cookies","cookieMap","cookie","encodedKey","encodedValue","expires","readBlobAsBase64","reader","base64String","normalizeHttpHeaders","originalKeys","buildUrlParams","shouldEncode","accumulator","buildRequestInit","extra","CapacitorHttpPluginWeb","requestInit","CapacitorHttp","SystemBarsStyle","SystemBarType","SystemBarsPluginWeb","App","Browser","util","assertIs","_arg","assertNever","_x","items","validKeys","filtered","checker","joinValues","separator","objectUtil","second","ZodParsedType","getParsedType","ZodIssueCode","ZodError","issues","sub","subs","actualProto","_mapper","mapper","issue","fieldErrors","processError","curr","formErrors","firstEl","errorMap","_ctx","defaultErrorMap","overrideErrorMap","getErrorMap","makeIssue","errorMaps","issueData","fullPath","fullIssue","maps","map","addIssueToContext","overrideMap","ParseStatus","results","arrayValue","INVALID","pairs","syncPairs","pair","finalObject","DIRTY","OK","isAborted","isDirty","isValid","isAsync","errorUtil","ParseInputLazyPath","handleResult","processCreateParams","invalid_type_error","required_error","description","iss","ZodType","maybeAsyncResult","check","getIssueProperties","setError","refinementData","refinement","ZodEffects","ZodFirstPartyTypeKind","def","ZodOptional","ZodNullable","ZodArray","ZodPromise","option","ZodUnion","incoming","ZodIntersection","defaultValueFunc","ZodDefault","ZodBranded","catchValueFunc","ZodCatch","This","ZodPipeline","ZodReadonly","cuidRegex","cuid2Regex","ulidRegex","uuidRegex","nanoidRegex","jwtRegex","durationRegex","emailRegex","_emojiRegex","emojiRegex","ipv4Regex","ipv4CidrRegex","ipv6Regex","ipv6CidrRegex","base64Regex","base64urlRegex","dateRegexSource","dateRegex","timeRegexSource","secondsRegexSource","secondsQuantifier","timeRegex","datetimeRegex","regex","isValidIP","ip","isValidJWT","base64","isValidCidr","ZodString","tooBig","tooSmall","validation","minLength","maxLength","len","ch","min","max","floatSafeRemainder","step","valDecCount","stepDecCount","decCount","valInt","stepInt","ZodNumber","inclusive","ZodBigInt","ZodBoolean","ZodDate","minDate","maxDate","ZodSymbol","ZodUndefined","ZodNull","ZodAny","ZodUnknown","ZodNever","ZodVoid","deepPartialify","ZodObject","newShape","fieldSchema","ZodTuple","shape","shapeKeys","extraKeys","keyValidator","unknownKeys","catchall","defaultError","augmentation","merging","mask","newField","createZodEnum","handleResults","unionErrors","childCtx","dirty","types","mergeValues","aType","bType","bKeys","sharedKeys","newObj","sharedValue","newArray","itemA","itemB","handleParsed","parsedLeft","parsedRight","merged","left","right","itemIndex","schemas","ZodMap","keyType","valueType","finalMap","ZodSet","finalizeSet","elements","parsedSet","minSize","maxSize","size","ZodLazy","getter","ZodLiteral","ZodEnum","expectedValues","enumValues","newDef","opt","ZodNativeEnum","nativeEnumValues","promisified","effect","checkCtx","processed","executeRefinement","inner","preprocess","newCtx","ZodNaN","inResult","freeze","stringType","objectType","enumType","EnvSchema","z.object","z.enum","z.string","envClient","isDev","isProd","API_BASE","SUPABASE_URL","SUPABASE_ANON_KEY","FRONTEND_URL","FCZ_UNIFIED_HEADER","FCZ_DISCOVER_V2","FCZ_PREDICTION_DETAILS_V2","FCZ_SHARED_CARDS","FCZ_AUTH_GATE","FCZ_COMMENTS_V2","FCZ_UNIFIED_CARDS","FCZ_COMMENTS_SORT","DEBUG_ENABLED","VAPID_PUBLIC_KEY","ESCROW_CONTRACT_ADDRESS","GOOGLE_ANALYTICS_ID","getEnvironmentConfig","protocol","runningInNativeApp","productionApi","apiHost","devApiUrl","getApiUrl","getSocketUrl","isDevelopment","isProduction","supabaseAnonKey","capacitorNative","platformCheck","getRedirectUrl","next","appendNext","fallback","buildAuthRedirectUrl","nativeAuthListener","ensureNativeAuthListener","CapacitorApp","isDeepLinkCallback","isHttpsCallback","urlObj","supabase","callbackPath","getAuthStorage","supabaseOptions","authStorage","globalWithSupabase","userData","native","redirectUrl","clientDb","predictionData","userId","updates","currency","limit","predictionId","commentData","useWalletStore","create","amount","currentBalance","newAvailable","newReserved","transaction","balance","newTotal","destination","toUser","transactions","tx","trackedConnections","getTrackedConnectionState","api","api2","extractConnectionInformation","extensionConnector","existingConnection","newConnection","devtoolsImpl","devtoolsOptions","enabled","anonymousActionType","connection","connectionInformation","isRecording","replace","nameOrAction","setStateFromDevtools","originalIsRecording","initialState","store2","didWarnAboutReservedActionType","originalDispatch","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","devtools","stringified","f","parsed","createJSONStorage","getStorage","parse","str2","newValue","toThenable","onFulfilled","_onRejected","_onFulfilled","onRejected","oldImpl","persistedState","hasHydrated","hydrationListeners","finishHydrationListeners","thenableSerialize","setItem","errorInSync","thenable","serializedValue","savedSetState","configResult","stateFromStorage","hydrate","postRehydrationCallback","storageValue","deserializedStorageValue","migratedState","_a2","newOptions","newImpl","migrationResult","migrated","persistImpl","persist","useNotificationStore","notificationData","notification","wasUnread","newSettings","toastData","toast","t","pushOptions","pushNotification","predictionTitle","addNotification","addToast","outcome","payout","title","showSuccess","showError","KEY","captureReturnTo","consumeReturnTo","sanitizeInternalPath","fetchExtendedProfile","convertSupabaseUser","supabaseUser","extendedProfile","appMetadata","firstName","lastName","avatar","nameParts","username","fullName","authStateChangeListenerSet","initializationInProgress","lastProcessedEvent","lastProcessedUserId","lastEventTime","AUTH_EVENT_DEBOUNCE_MS","useAuthStore","convertedUser","userMessage","authUser","providerId","providerName","profileData","currentUser","updatedUser","apiUrl","errData","isNetworkError","file","ext","uploadData","uploadError","lower","publicUrlData","publicUrl","authUpdate","authErr","emptyArray","useLikeStore","INTENT_MAP","FALLBACK_INTENT","RETURN_URL_KEY","authGateState","subscribers","notifySubscribers","updateAuthGateState","persistPendingAuth","intent","getPersistedAuth","stored","useAuthGate","forceUpdate","useState","useEffect","openAuthGate","baseIntentMeta","intentMeta","resolveAuthGate","resolver","pendingIntent","handleResumeAfterAuth","textarea","betInput","restorePendingAuth","persisted","SupabaseContext","createContext","useSupabase","useContext","SupabaseProvider","jsx","AuthSessionContext","useAuthSession","AUTH_DEBOUNCE_MS","AuthSessionProvider","setUser","setSession","loading","setLoading","initialized","setInitialized","lastEventRef","useRef","mounted","restorePendingSession","cached","lastEvent","authHelpers","emailRedirectTo","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","isView","encodePacket","supportsBinary","encodeBlobAsBase64","fileReader","TEXT_ENCODER","encodePacketToBinary","packet","encoded","chars","lookup","bufferLength","encoded1","encoded2","encoded3","encoded4","arraybuffer","decodePacket","encodedPacket","binaryType","mapBinary","decodeBase64Packet","SEPARATOR","encodePayload","packets","length","encodedPackets","decodePayload","decodedPacket","createPacketEncoderStream","payloadLength","TEXT_DECODER","totalLength","chunks","chunk","concatChunks","j","createPacketDecoderStream","maxPayload","expectedLength","isBinary","headerArray","Emitter","mixin","on","callbacks","nextTick","setTimeoutFn","globalThisShim","defaultBinaryType","pick","NATIVE_SET_TIMEOUT","globalThis","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","BASE64_OVERHEAD","byteLength","utf8Length","l","qry","TransportError","Transport","onPause","encodedQuery","Polling","pause","hasCORS","empty","BaseXHR","isSSL","port","req","xhrStatus","Request","createRequest","xhr","fromError","unloadHandler","terminationEvent","hasXHR2","newRequest","XHR","forceBase64","xdomain","isReactNative","BaseWS","closeEvent","ev","lastPacket","WebSocketCtor","_packet","WT","stream","decoderStream","encoderStream","read","done","transports","re","src","pathNames","queryKey","regx","names","$0","$1","$2","withEventListeners","OFFLINE_EVENT_LISTENERS","SocketWithoutUpgrade","parsedUri","transportName","transport","delay","payloadSize","cleanupAndClose","waitForUpgrade","SocketWithUpgrade","failed","onTransportOpen","cleanup","freezeTransport","onerror","onTransportClose","onclose","onupgrade","upgrades","filteredUpgrades","o","DEFAULT_TRANSPORTS","loc","host","toString","withNativeFile","hasBinary","toJSON","deconstructPacket","packetData","pack","_deconstructPacket","placeholder","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","Encoder","replacer","deconstruction","Decoder","reviver","isBinaryEvent","BinaryReconstructor","start","buf","binData","Socket","io","nsp","ack","isTransportWritable","isConnected","arg1","arg2","responseArgs","force","self","sent","pid","subDestroy","compress","Backoff","ms","rand","deviation","jitter","Manager","_parser","parser","Engine","openSubDestroy","errorSub","nsps","cache","sameNamespace","QK","walletAddress","seed","VERSION","pkg","APP_CONFIG","getFrontendUrl","getVersion","getFullVersion","isFeatureEnabled","feature","DEFAULT_RETRY_OPTIONS","shouldRetry","attemptNumber","maxRetries","calculateDelay","fetchWithRetry","retryOptions","fetchOptions","retryConfig","lastError","isGetLike","hasBody","apiClient","DEMO_ENABLED","useFundingModeStore","computeBetKey","optionId","getOrCreateRequestId","compositeKey","ttlMs","raw","normalizePredictionOption","totalStaked","currentOdds","normalizePrediction","prediction","poolTotal","stakeMin","entryDeadline","settlementMethod","participantCount","likeCount","commentCount","normalizePredictions","usePredictionStore","category","append","currentTime","lastFetchTime","currentPredictions","isLoadingMore","newPredictions","loadingMore","newFilters","updatedFilters","trendingPredictions","userPredictions","createdPredictions","predictions","freshPrediction","merge","pred","list","newPrediction","funding","selectedMode","isCryptoMode","errorData","updatedPrediction","newEntry","mergePrediction","amountNgn","fallbackStats","sum","userPredictionEntries","userCreatedPredictions","refreshActivePredictions","refreshPredictions","RealtimeProvider","queryClient","useQueryClient","socketRef","onWalletUpdate","onPredictionUpdate","onSettlementComplete","defaultAttributes","toKebabCase","string","createLucideIcon","iconName","iconNode","Component","forwardRef","color","strokeWidth","absoluteStrokeWidth","createElement","tag","attrs","Activity","AlertCircle","AlertTriangle","ArrowLeft","ArrowRight","BadgeCheck","Ban","BarChart3","Bell","Calendar","CheckCircle","Check","ChevronDown","ChevronLeft","ChevronRight","ChevronUp","ChevronsRight","Chrome","Clock","Coins","Compass","Copy","DollarSign","Download","ExternalLink","Eye","Filter","Flag","Fuel","Gavel","Headphones","HelpCircle","Home","LayoutDashboard","Loader2","Lock","Mail","Percent","Play","Plus","Power","Receipt","RefreshCcw","RefreshCw","RotateCcw","Save","ScrollText","Search","Settings","Share","Shield","Smartphone","Sparkles","Tag","Target","ToggleLeft","ToggleRight","TrendingDown","TrendingUp","Trophy","User","Users","Wallet","Wrench","XCircle","X","Zap","FocusTrap","__publicField","focusableSelector","KeyboardNavigation","currentIndex","totalItems","onIndexChange","orientation","isVertical","upKey","downKey","onEscape","onActivate","AriaUtils","priority","announcement","expanded","selected","pressed","prefersReducedMotion","NetworkStatusContext","useNetworkStatus","NetworkStatusProvider","isOnline","setIsOnline","isSlowConnection","setIsSlowConnection","handleOnline","handleOffline","isSlow","EmailInputModal","isOpen","submitLabel","setEmail","isSubmitting","setIsSubmitting","setShowSuccess","modalRef","emailInputRef","focusTrapRef","modalId","handleKeyDown","validateEmail","handleSubmit","validationError","jsxs","Fragment","EmailInputModal$1","AuthGateModal","signInWithGoogle","signInWithEmailLink","isEmailModalOpen","setIsEmailModalOpen","firstButtonRef","displayMeta","handleClose","handleGoogleSignIn","handleEmailLinkSignIn","handleEmailSubmit","isOffline","AuthGateModal$1","u","d","g","w","Z","W","E","H","Y","Q","S","se","V","te","oe","ee","T","ie","P","ce","ne","A","R","z","O","K","B","I","de","M","me","le","C","pe","Te","fe","F","ue","ge","q","he","L","ye","be","U","Se","Ae","xe","Pe","$","b.createElement","Re","Ee","ve","De","Oe","J","Ie","ke","G","N","y.memo","y.createElement","y.Fragment","Ve","x.createElement","we","x.useCallback","Me","Ce","D","Fe","zt","_ScrollManager","fromRoute","toRoute","isBackNav","routeKey","scrollY","behavior","forceScroll","currentPos","elementId","elementPosition","tenMinutes","ScrollManager","scrollManager","scrollToTop","saveScrollPosition","markNavigationAsIntentional","handleRouterNavigation","Notification","duration","show","isVisible","setIsVisible","getIcon","getStyles","baseStyles","Notification$2","typeMap","NotificationContainer","toasts","removeToast","NotificationContainer$1","_PWAManager","registrations","registration","newWorker","choiceResult","updateEvent","existingSubscription","padding","rawData","outputArray","apiBase","PWAManager","pwaManager","PWAInstallBanner","showBanner","setShowBanner","canInstall","setCanInstall","checkInstallStatus","isIOS","dismissed","dismissedTime","daysSinceDissmissal","shouldShow","sessionDismissed","handleInstallable","handleInstalled","handleInstallClick","handleDismiss","PWAInstallBanner$1","IOSInstallModal","IOSInstallModal$1","InstallPromptCard","onInstall","onDismiss","handleInstall","SmartInstallPrompt","showPrompt","setShowPrompt","userEngagement","setUserEngagement","engagementScore","engagementEvents","trackEngagement","checkAndShowPrompt","oneDayInMs","timeOnSite","hasCreatedPrediction","hasPlacedPrediction","SmartInstallPrompt$1","TopUpdateToast","onUpdate","isAnimatingOut","setIsAnimatingOut","handleUpdate","TopUpdateToast$1","PWAInstallManager","showIOSModal","setShowIOSModal","showUpdateNotification","setShowUpdateNotification","handleIOSInstallPrompt","handleUpdateAvailable","requestNotificationPermissionDelayed","hasInteracted","alreadyRequested","granted","trackInteraction","interactionEvents","visitCount","handleUpdateApp","dismissUpdate","PWAInstallManager$1","LoadingSpinner","PageWrapper","retryKey","setRetryKey","React","handleRetry","prev","ErrorBoundary","Suspense","PageWrapper$1","loose","tmp","useBuiltinInsertionEffect","canUseDOM","React.useLayoutEffect","React.useEffect","useInsertionEffect","useEvent","React.useRef","eventPopstate","eventPushState","eventReplaceState","eventHashchange","subscribeToLocationUpdates","useLocationProperty","ssrFn","useSyncExternalStore","currentSearch","useSearch","ssrSearch","currentPathname","usePathname","ssrPath","useBrowserLocation","patchKey","original","_relativePath","baseDefaults","absolutePath","unescape","defaultRouter","useBrowserSearch","parsePattern","RouterCtx","useRouter","Params0","useLocationFromRouter","navOpts","targetPath","_onClick","asChild","cls","restProps","isValidElement","cloneElement","useOnboarding","saved","setConfig","saveState","useCallback","update","patch","updatedState","startOnboarding","newConfig","nextStep","currentStepData","isLast","completedSteps","prevStep","skipOnboarding","resetOnboarding","calculateOptimalPosition","targetRect","tooltipRect","placement","viewport","safeArea","spacing","positions","availableSpace","fits","OnboardingTooltip","position","onNext","onPrev","onSkip","isFirst","stepNumber","totalSteps","canSkip","handleNext","handlePrev","handleSkip","motion","SpotlightOverlay","maskId","useMemo","radius","centerX","centerY","OnboardingSystem","currentStep","targetElement","setTargetElement","setTargetRect","tooltipPosition","setTooltipPosition","tooltipRef","resizeObserverRef","timeoutRef","selectTourElement","updateTargetPosition","rect","handleResize","handleScroll","tooltip","AnimatePresence","createPortal","WelcomeModal","onStartTour","onMinimalTour","handleStartTour","handleMinimalTour","SAFE","FULL_CONTEXTUAL_TOUR","WalletIcon","QUICK_DISCOVER_TOUR","OnboardingContext","FULL_TOUR_STEPS","QUICK_TOUR_STEPS","shouldShowOnboarding","shouldShowWelcomeModal","OnboardingProvider","showWelcome","setShowWelcome","authLoading","checkUIReady","canRunTour","checkAndShow","tourType","handleStartFullTour","handleStartQuickTour","checkAndStart","handleSkipOnboarding","handleResetOnboarding","contextValue","qaLog","MobileShell","overrideHeader","MobileShell$1","PageLoadingSpinner","PageLoadingSpinner$1","OAuthDiagnostic","AuthInProgressOverlay","onRetry","onCancel","cn","inputs","twMerge","clsx","StableBottomNavigation","activeTab","onTabChange","showFAB","onFABClick","tabs","handleTabClick","tabId","formatBadgeCount","tab","Icon","hasBadge","StableBottomNavigation$1","createSlot","ownerName","SlotClone","createSlotClone","Slot2","React.forwardRef","slotProps","childrenArray","React.Children","slottable","isSlottable","newElement","newChildren","child","React.isValidElement","React.cloneElement","childrenRef","getElementRef","props2","mergeProps","React.Fragment","composeRefs","SLOTTABLE_IDENTIFIER","childProps","overrideProps","propName","slotPropValue","childPropValue","mayWarn","NODES","Primitive","primitive","node","Slot","Node","primitiveProps","Comp","VISUALLY_HIDDEN_STYLES","NAME","VisuallyHidden","WC_ID","wcEnabled","isMobileDevice","ConnectWalletSheet","connect","connectors","useConnect","open","setOpen","connectError","setConnectError","isMobile","wcConnector","attemptedRef","lastAttemptRef","handleConnect","connector","handler","browserConnector","Dialog.Root","Dialog.Portal","Dialog.Overlay","Dialog.Content","Dialog.Title","Dialog.Description","Dialog.Close","EmptyState","icon","primaryAction","secondaryAction","AuthRequiredState","handleSignIn","REFERRAL_COOKIE_NAME","REFERRAL_STORAGE_KEY","REFERRAL_COOKIE_EXPIRY_DAYS","isReferralEnabled","getRefCode","urlRefCode","setRefCode","cookieRefCode","getCookie","expiryDate","clearRefCode","getMyReferralLink","referralCode","copyReferralLink","textArea","attributeReferral","refCode","logReferralLogin","fetchMyReferralStats","fetchReferralLeaderboard","period","useReferral","stats","setStats","statsLoading","setStatsLoading","isEnabled","referralLink","refreshStats","copyLink","useReferralCapture","pathMatch","refParam","useReferralAttribution","attributed","setAttributed","AdminGuard","isAdmin","setIsAdmin","checking","setChecking","navItems","AdminLayout","appUrl","AdminLayout$1","useMaintenanceStore","MaintenanceOverlay","active","LazyDiscoverPage","lazy","LazyPredictionsPage","LazyCreatePredictionPage","LazyPredictionDetailsPageV2","LazyProfilePageV2","LazyDownloadPage","LazyUnifiedWalletPage","LazyUnifiedLeaderboardPage","LazyAuthCallback","LazyReferralRedirectPage","LazyNotificationsPage","LazyAdminHomePage","AdminHomePage$1","LazyAuditLogPage","AuditLogPage$1","LazyUsersPage","UsersPage$1","LazyUserDetailPage","UserDetailPage$1","LazyWalletsPage","WalletsPage$1","LazyUserWalletPage","UserWalletPage$1","LazyAdminPredictionsPage","PredictionsPage$1","LazyPredictionDetailPage","PredictionDetailPage$1","LazyModerationPage","ModerationPage$1","LazyConfigPage","ConfigPage$1","LazySettlementsPage","SettlementsPage$1","LazySettlementDetailPage","SettlementDetailPage$1","LazySupportPage","SupportPage$1","MainLayout","memo","sessionUser","isAuthenticated","prevLocationRef","prevPath","normalizePath","getCurrentTab","handleTabChange","requestCreateAccess","handleFABClick","Toaster","BootstrapEffects","sessionInitialized","initializeAuth","storeAuthenticated","storeInitialized","storeUser","currentStoreUser","DiscoverPageWrapper","handleNavigateToProfile","handleNavigateToPrediction","PredictionsPageWrapper","handleNavigateToDiscover","CreatePredictionPageWrapper","sessionLoading","authPromptedRef","handleNavigateBack","LeaderboardPageWrapper","PredictionDetailsRouteWrapper","resolvedId","setResolvedId","index$1","AppContent","initializeWallet","storeLoading","initializeLikes","authInProgress","setAuthInProgress","authError","setAuthError","handleAuthProgress","started","completed","handleCancel","CURRENT_YEAR","LandingPage","PROD_APP_URL","handleGetStarted","LandingPage$1","USDC_CONTRACT_ADDRESS","FundingGuidePage","copiedAddress","setCopiedAddress","handleCopyAddress","handleBackToHome","handleGoToApp","faucet","FundingGuidePage$1","ADMIN_KEY_STORAGE","AdminGate","adminKey","setAdminKey","inputKey","setInputKey","getAdminKey","buildAdminUrl","actorId","parseJsonOrText","adminGet","adminPost","adminPut","adminPatch","AdminHomePage","recentActions","setRecentActions","overview","audit","quickActions","UsersPage","setQuery","setResults","searched","setSearched","handleSearch","UserDetailPage","setWallet","addresses","setAddresses","timeline","setTimeline","timelineLoading","setTimelineLoading","expandedId","setExpandedId","timelineFilter","setTimelineFilter","fetchUser","fetchTimeline","getTypeIcon","getTypeColor","addr","UserViewPage","setTab","summary","setSummary","setPredictions","activity","setActivity","fetchAll","userLabel","tabItems","listForTab","WalletsPage","UserWalletPage","wallets","setWallets","cryptoTx","setCryptoTx","demoTx","setDemoTx","escrowLocks","setEscrowLocks","providerFilter","setProviderFilter","exporting","setExporting","fetchData","handleExport","downloadUrl","filteredTx","usdWallet","getPredictionStatusUi","disputeStatus","settledDate","hasClosedAt","closesAtTime","isPastDeadline","statusConfig","PredictionsPage","statusFilter","setStatusFilter","railFilter","setRailFilter","setTotal","fetchPredictions","rails","railLabel","statusUi","statusTone","getCategoryLabel","word","PredictionDetailPage","setData","actionLoading","setActionLoading","showVoidModal","setShowVoidModal","showCancelModal","setShowCancelModal","setReason","settingOutcome","setSettingOutcome","json","handleSetOutcome","totalEntries","handleVoid","handleReset","creator","isSettled","isTerminal","categoryLabel","SettlementsPage","queue","setQueue","queueData","statsData","handleSync","handleFinalize","getNeedsChips","chips","getJobStatusBadge","job","SettlementDetailPage","showTriggerModal","setShowTriggerModal","selectedWinningOption","setSelectedWinningOption","handleTrigger","copyToClipboard","entryStats","payouts","canTrigger","canRetry","isWinner","SupportPage","totalResults","HeadphonesIcon","ModerationPage","setActiveTab","creators","setCreators","searchQuery","setSearchQuery","showBanModal","setShowBanModal","banTarget","setBanTarget","banReason","setBanReason","fetchCreators","handleBan","handleUnban","handleVerify","handleUnverify","filteredCreators","defaultConfig","ConfigPage","saving","setSaving","maintenanceMessage","setMaintenanceMessage","fetchConfig","handleToggleMaintenance","handleToggleFeature","newFlags","handleSaveConfig","AuditLogPage","setItems","setOffset","actionFilter","setActionFilter","actions","setActions","fetchAuditLog","fetchActions","handleRefresh","totalPages","currentPage","CategoriesPage","categories","setCategories","showAddModal","setShowAddModal","newCategory","setNewCategory","fetchCategories","handleToggleEnabled","categoryId","currentValue","cat","handleMoveUp","prevCategory","handleMoveDown","nextCategory","handleCreate","handleLabelChange","label","LandingAdminRouter","LandingAdminRouter$1","RedirectToApp","RedirectToApp$1","LandingRouter","LandingRouter$1","FallbackComponent","DefaultErrorFallback","resetError","handleGoHome","ErrorBoundary$1","toastThrottle","THROTTLE_DURATION","MAX_DUPLICATES","ALLOWED_CATEGORIES","showToast","throttle","dedupe","throttleInfo","existingToasts","existingToast","showErrorToast","AppError","classifyError","ErrorHandlingContext","ErrorHandlingProvider","maxErrors","showToasts","setErrors","reportError","appError","classification","clearErrors","handleUnhandledError","handleUnhandledRejection","coinbaseWallet","version3","version4","walletProvider","accountsChanged","chainChanged","disconnect","createConnector","withCapabilities","currentChainId","UserRejectedRequestError","preference","createCoinbaseWalletSDK","addEthereumChainParameter","SwitchChainError","ChainNotConfiguredError","numberToHex","blockExplorerUrls","rpcUrls","addEthereumChain","_error","sdk","CoinbaseWalletSDK","SDK","walletExtensionChainId","jsonRpcUrl","walletConnect","isNewChainsStale","provider_","providerPromise","NAMESPACE","displayUri","sessionDelete","ProviderNotFoundError","targetChainId","isChainsStale","optionalChains","optionalChain","initProvider","EthereumProvider","extractRpcUrls","requestedChains","connectInfo","account","connectorChains","namespaceChains","chains","projectId","injected","metadataUrl","coinbaseConnector","RPC_ENDPOINTS","createStorage","createConfig","baseSepolia","http","WalletStateError","AllowanceError","actual","SessionError","TransactionTimeoutError","txHash","TRANSIENT_ERRORS","USER_ACTION_ERRORS","SESSION_ERRORS","ensureWalletReady","expectedChainId","sessionHealthy","targetChain","isTransientError","isUserRejection","isSessionError","parseOnchainError","errorStr","requiredUSD","actualUSD","FAILED_LOGS_STORAGE_KEY","MAX_STORED_LOGS","logTransaction","retries","errorText","storeFailedLog","failedLogs","existingLog","retryFailedTransactionLogs","successCount","remaining","log","cleanupWalletConnectStorage","removedCount","localKeysToRemove","sessionKeysToRemove","broadcastBalanceRefresh","broadcastReconnectRequired","globalErrorHandlerInstalled","setupGlobalWalletConnectErrorHandler","hasPersistedWagmiConnection","BALANCE_QUERY_KEYS","serviceInitialized","connections","currentEntry","initializeOnchainService","setupBalanceRefreshListener","hardDelay","WALLET_QUERY_KEYS","ACTIVITY_QUERY_KEYS","PREDICTION_QUERY_KEYS","USER_QUERY_KEYS","CLAIM_QUERY_KEYS","invalidateWalletQueries","includeEscrow","includeActivity","invalidateAfterDeposit","invalidateAfterWithdraw","invalidateAfterBet","claimInvalidationTimeout","invalidateAfterClaim","refreshTimeout","forceRefreshAllWalletData","SESSION_ERROR_PATTERNS","wagmiStore","Web3Context","useWeb3Recovery","QueryClient","failureCount","Web3ProviderInner","isConnecting","isReconnecting","useAccount","useDisconnect","reconnect","isReconnectPending","useReconnect","useConnectors","isRecovering","setIsRecovering","lastRecoveryTime","setLastRecoveryTime","setSessionHealthy","setLastError","recoveryLockRef","mountedRef","initializedRef","reconnectAttemptedRef","connectionStateRef","clearLastError","errorMsg","cleanupSessions","keysToRemove","triggerRecovery","hasPersisted","wrapWithRecovery","operation","retryDelay","operationTimeoutMs","opPromise","timeoutPromise","isTimeoutError","handleBalanceRefresh","Web3Provider","WagmiProvider","QueryClientProvider","THRESHOLDS","getRating","threshold","shouldSample","sampleRate","reportToSentry","metric","Sentry","handleMetric","rating","webVitalMetric","initWebVitals","onFCP","onLCP","onCLS","onINP","onTTFB","originalFetch","isLandingBuild","RootComponent","ReactDOM"],"sources":["../../node_modules/react-dom/client.js","../../node_modules/react-router/dist/development/chunk-4WY6JWTD.mjs","../../node_modules/@supabase/functions-js/dist/module/helper.js","../../node_modules/@supabase/functions-js/dist/module/types.js","../../node_modules/@supabase/functions-js/dist/module/FunctionsClient.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestError.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestTransformBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestFilterBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestQueryBuilder.js","../../node_modules/@supabase/postgrest-js/dist/cjs/PostgrestClient.js","../../node_modules/@supabase/postgrest-js/dist/cjs/index.js","../../node_modules/@supabase/postgrest-js/dist/esm/wrapper.mjs","../../node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.js","../../node_modules/@supabase/realtime-js/dist/module/lib/version.js","../../node_modules/@supabase/realtime-js/dist/module/lib/constants.js","../../node_modules/@supabase/realtime-js/dist/module/lib/serializer.js","../../node_modules/@supabase/realtime-js/dist/module/lib/timer.js","../../node_modules/@supabase/realtime-js/dist/module/lib/transformers.js","../../node_modules/@supabase/realtime-js/dist/module/lib/push.js","../../node_modules/@supabase/realtime-js/dist/module/RealtimePresence.js","../../node_modules/@supabase/realtime-js/dist/module/RealtimeChannel.js","../../node_modules/@supabase/realtime-js/dist/module/RealtimeClient.js","../../node_modules/@supabase/storage-js/dist/module/lib/errors.js","../../node_modules/@supabase/storage-js/dist/module/lib/helpers.js","../../node_modules/@supabase/storage-js/dist/module/lib/fetch.js","../../node_modules/@supabase/storage-js/dist/module/packages/StreamDownloadBuilder.js","../../node_modules/@supabase/storage-js/dist/module/packages/BlobDownloadBuilder.js","../../node_modules/@supabase/storage-js/dist/module/packages/StorageFileApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/version.js","../../node_modules/@supabase/storage-js/dist/module/lib/constants.js","../../node_modules/@supabase/storage-js/dist/module/packages/StorageBucketApi.js","../../node_modules/iceberg-js/dist/index.mjs","../../node_modules/@supabase/storage-js/dist/module/packages/StorageAnalyticsClient.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/constants.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/errors.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/helpers.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/fetch.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/VectorIndexApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/VectorDataApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/VectorBucketApi.js","../../node_modules/@supabase/storage-js/dist/module/lib/vectors/StorageVectorsClient.js","../../node_modules/@supabase/storage-js/dist/module/StorageClient.js","../../node_modules/@supabase/supabase-js/dist/module/lib/version.js","../../node_modules/@supabase/supabase-js/dist/module/lib/constants.js","../../node_modules/@supabase/supabase-js/dist/module/lib/fetch.js","../../node_modules/@supabase/supabase-js/dist/module/lib/helpers.js","../../node_modules/@supabase/auth-js/dist/module/lib/version.js","../../node_modules/@supabase/auth-js/dist/module/lib/constants.js","../../node_modules/@supabase/auth-js/dist/module/lib/errors.js","../../node_modules/@supabase/auth-js/dist/module/lib/base64url.js","../../node_modules/@supabase/auth-js/dist/module/lib/helpers.js","../../node_modules/@supabase/auth-js/dist/module/lib/fetch.js","../../node_modules/@supabase/auth-js/dist/module/lib/types.js","../../node_modules/@supabase/auth-js/dist/module/GoTrueAdminApi.js","../../node_modules/@supabase/auth-js/dist/module/lib/local-storage.js","../../node_modules/@supabase/auth-js/dist/module/lib/locks.js","../../node_modules/@supabase/auth-js/dist/module/lib/polyfills.js","../../node_modules/@supabase/auth-js/dist/module/lib/web3/ethereum.js","../../node_modules/@supabase/auth-js/dist/module/lib/webauthn.errors.js","../../node_modules/@supabase/auth-js/dist/module/lib/webauthn.js","../../node_modules/@supabase/auth-js/dist/module/GoTrueClient.js","../../node_modules/@supabase/auth-js/dist/module/AuthClient.js","../../node_modules/@supabase/supabase-js/dist/module/lib/SupabaseAuthClient.js","../../node_modules/@supabase/supabase-js/dist/module/SupabaseClient.js","../../node_modules/@supabase/supabase-js/dist/module/index.js","../../node_modules/@capacitor/core/dist/index.js","../../node_modules/@capacitor/app/dist/esm/index.js","../../node_modules/@capacitor/browser/dist/esm/index.js","../../node_modules/zod/v3/helpers/util.js","../../node_modules/zod/v3/ZodError.js","../../node_modules/zod/v3/locales/en.js","../../node_modules/zod/v3/errors.js","../../node_modules/zod/v3/helpers/parseUtil.js","../../node_modules/zod/v3/helpers/errorUtil.js","../../node_modules/zod/v3/types.js","../../src/config/env.schema.ts","../../src/config/env.ts","../../src/config/env.client.ts","../../src/utils/environment.ts","../../src/lib/supabase.ts","../../src/store/walletStore.ts","../../node_modules/zustand/esm/middleware.mjs","../../src/store/notificationStore.ts","../../src/lib/returnTo.ts","../../src/store/authStore.ts","../../src/lib/void.ts","../../src/store/likeStore.ts","../../src/auth/authIntents.ts","../../src/auth/authGateAdapter.ts","../../src/providers/SupabaseProvider.tsx","../../src/providers/AuthSessionProvider.tsx","../../node_modules/engine.io-parser/build/esm/commons.js","../../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../../node_modules/engine.io-parser/build/esm/index.js","../../node_modules/@socket.io/component-emitter/lib/esm/index.js","../../node_modules/engine.io-client/build/esm/globals.js","../../node_modules/engine.io-client/build/esm/util.js","../../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../../node_modules/engine.io-client/build/esm/transport.js","../../node_modules/engine.io-client/build/esm/transports/polling.js","../../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../../node_modules/engine.io-client/build/esm/transports/polling-xhr.js","../../node_modules/engine.io-client/build/esm/transports/websocket.js","../../node_modules/engine.io-client/build/esm/transports/webtransport.js","../../node_modules/engine.io-client/build/esm/transports/index.js","../../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../../node_modules/engine.io-client/build/esm/socket.js","../../node_modules/socket.io-client/build/esm/url.js","../../node_modules/socket.io-parser/build/esm/is-binary.js","../../node_modules/socket.io-parser/build/esm/binary.js","../../node_modules/socket.io-parser/build/esm/index.js","../../node_modules/socket.io-client/build/esm/on.js","../../node_modules/socket.io-client/build/esm/socket.js","../../node_modules/socket.io-client/build/esm/contrib/backo2.js","../../node_modules/socket.io-client/build/esm/manager.js","../../node_modules/socket.io-client/build/esm/index.js","../../src/lib/queryKeys.ts","../../src/config/index.ts","../../src/lib/apiUtils.ts","../../src/store/fundingModeStore.ts","../../src/store/predictionStore.ts","../../src/providers/RealtimeProvider.tsx","../../node_modules/lucide-react/dist/esm/defaultAttributes.js","../../node_modules/lucide-react/dist/esm/createLucideIcon.js","../../node_modules/lucide-react/dist/esm/icons/activity.js","../../node_modules/lucide-react/dist/esm/icons/alert-circle.js","../../node_modules/lucide-react/dist/esm/icons/alert-triangle.js","../../node_modules/lucide-react/dist/esm/icons/arrow-left.js","../../node_modules/lucide-react/dist/esm/icons/arrow-right.js","../../node_modules/lucide-react/dist/esm/icons/badge-check.js","../../node_modules/lucide-react/dist/esm/icons/ban.js","../../node_modules/lucide-react/dist/esm/icons/bar-chart-3.js","../../node_modules/lucide-react/dist/esm/icons/bell.js","../../node_modules/lucide-react/dist/esm/icons/calendar.js","../../node_modules/lucide-react/dist/esm/icons/check-circle.js","../../node_modules/lucide-react/dist/esm/icons/check.js","../../node_modules/lucide-react/dist/esm/icons/chevron-down.js","../../node_modules/lucide-react/dist/esm/icons/chevron-left.js","../../node_modules/lucide-react/dist/esm/icons/chevron-right.js","../../node_modules/lucide-react/dist/esm/icons/chevron-up.js","../../node_modules/lucide-react/dist/esm/icons/chevrons-right.js","../../node_modules/lucide-react/dist/esm/icons/chrome.js","../../node_modules/lucide-react/dist/esm/icons/clock.js","../../node_modules/lucide-react/dist/esm/icons/coins.js","../../node_modules/lucide-react/dist/esm/icons/compass.js","../../node_modules/lucide-react/dist/esm/icons/copy.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/download.js","../../node_modules/lucide-react/dist/esm/icons/external-link.js","../../node_modules/lucide-react/dist/esm/icons/eye.js","../../node_modules/lucide-react/dist/esm/icons/filter.js","../../node_modules/lucide-react/dist/esm/icons/flag.js","../../node_modules/lucide-react/dist/esm/icons/fuel.js","../../node_modules/lucide-react/dist/esm/icons/gavel.js","../../node_modules/lucide-react/dist/esm/icons/headphones.js","../../node_modules/lucide-react/dist/esm/icons/help-circle.js","../../node_modules/lucide-react/dist/esm/icons/home.js","../../node_modules/lucide-react/dist/esm/icons/layout-dashboard.js","../../node_modules/lucide-react/dist/esm/icons/loader-2.js","../../node_modules/lucide-react/dist/esm/icons/lock.js","../../node_modules/lucide-react/dist/esm/icons/mail.js","../../node_modules/lucide-react/dist/esm/icons/percent.js","../../node_modules/lucide-react/dist/esm/icons/play.js","../../node_modules/lucide-react/dist/esm/icons/plus.js","../../node_modules/lucide-react/dist/esm/icons/power.js","../../node_modules/lucide-react/dist/esm/icons/receipt.js","../../node_modules/lucide-react/dist/esm/icons/refresh-ccw.js","../../node_modules/lucide-react/dist/esm/icons/refresh-cw.js","../../node_modules/lucide-react/dist/esm/icons/rotate-ccw.js","../../node_modules/lucide-react/dist/esm/icons/save.js","../../node_modules/lucide-react/dist/esm/icons/scroll-text.js","../../node_modules/lucide-react/dist/esm/icons/search.js","../../node_modules/lucide-react/dist/esm/icons/settings.js","../../node_modules/lucide-react/dist/esm/icons/share.js","../../node_modules/lucide-react/dist/esm/icons/shield.js","../../node_modules/lucide-react/dist/esm/icons/smartphone.js","../../node_modules/lucide-react/dist/esm/icons/sparkles.js","../../node_modules/lucide-react/dist/esm/icons/tag.js","../../node_modules/lucide-react/dist/esm/icons/target.js","../../node_modules/lucide-react/dist/esm/icons/toggle-left.js","../../node_modules/lucide-react/dist/esm/icons/toggle-right.js","../../node_modules/lucide-react/dist/esm/icons/trending-down.js","../../node_modules/lucide-react/dist/esm/icons/trending-up.js","../../node_modules/lucide-react/dist/esm/icons/trophy.js","../../node_modules/lucide-react/dist/esm/icons/user.js","../../node_modules/lucide-react/dist/esm/icons/users.js","../../node_modules/lucide-react/dist/esm/icons/wallet.js","../../node_modules/lucide-react/dist/esm/icons/wrench.js","../../node_modules/lucide-react/dist/esm/icons/x-circle.js","../../node_modules/lucide-react/dist/esm/icons/x.js","../../node_modules/lucide-react/dist/esm/icons/zap.js","../../src/utils/accessibility.ts","../../src/providers/NetworkStatusProvider.tsx","../../src/components/auth/EmailInputModal.tsx","../../src/components/auth/AuthGateModal.tsx","../../node_modules/goober/dist/goober.modern.js","../../node_modules/react-hot-toast/dist/index.mjs","../../src/utils/scroll.ts","../../src/components/ui/Notification.tsx","../../src/components/ui/NotificationContainer.tsx","../../src/utils/pwa.ts","../../src/components/PWAInstallBanner.tsx","../../src/components/IOSInstallModal.tsx","../../src/components/SmartInstallPrompt.tsx","../../src/components/TopUpdateToast.tsx","../../src/components/PWAInstallManager.tsx","../../src/components/PageWrapper.tsx","../../node_modules/regexparam/dist/index.mjs","../../node_modules/wouter/src/react-deps.js","../../node_modules/wouter/src/use-browser-location.js","../../node_modules/wouter/src/paths.js","../../node_modules/wouter/src/index.js","../../src/components/onboarding/OnboardingSystem.tsx","../../src/lib/lexicon.ts","../../src/config/contextualOnboardingTours.tsx","../../src/components/onboarding/OnboardingProvider.tsx","../../src/utils/devQa.ts","../../src/components/layout/MobileShell.tsx","../../src/components/ui/PageLoadingSpinner.tsx","../../src/components/diagnostics/OAuthDiagnostic.tsx","../../src/components/AuthInProgressOverlay.tsx","../../src/utils/cn.ts","../../src/components/navigation/StableBottomNavigation.tsx","../../node_modules/@radix-ui/react-visually-hidden/node_modules/@radix-ui/react-slot/dist/index.mjs","../../node_modules/@radix-ui/react-visually-hidden/node_modules/@radix-ui/react-primitive/dist/index.mjs","../../node_modules/@radix-ui/react-visually-hidden/dist/index.mjs","../../src/components/wallet/ConnectWalletSheet.tsx","../../src/components/ui/empty/EmptyState.tsx","../../src/components/ui/empty/AuthRequiredState.tsx","../../src/lib/referral.ts","../../src/hooks/useReferral.ts","../../src/components/admin/AdminGuard.tsx","../../src/components/admin/AdminLayout.tsx","../../src/store/maintenanceStore.ts","../../src/components/MaintenanceOverlay.tsx","../../src/App.tsx","../../src/landing/LandingPage.tsx","../../src/landing/FundingGuidePage.tsx","../../src/components/admin/AdminGate.tsx","../../src/lib/adminApi.ts","../../src/pages/admin/AdminHomePage.tsx","../../src/pages/admin/UsersPage.tsx","../../src/pages/admin/UserDetailPage.tsx","../../src/pages/admin/UserViewPage.tsx","../../src/pages/admin/WalletsPage.tsx","../../src/pages/admin/UserWalletPage.tsx","../../src/lib/predictionStatusUi.ts","../../src/pages/admin/PredictionsPage.tsx","../../src/lib/categoryUi.ts","../../src/pages/admin/PredictionDetailPage.tsx","../../src/pages/admin/SettlementsPage.tsx","../../src/pages/admin/SettlementDetailPage.tsx","../../src/pages/admin/SupportPage.tsx","../../src/pages/admin/ModerationPage.tsx","../../src/pages/admin/ConfigPage.tsx","../../src/pages/admin/AuditLogPage.tsx","../../src/pages/admin/CategoriesPage.tsx","../../src/landing/LandingAdminRouter.tsx","../../src/landing/RedirectToApp.tsx","../../src/landing/LandingRouter.tsx","../../src/components/ErrorBoundary.tsx","../../src/utils/toasts.ts","../../src/utils/errorHandling.ts","../../src/components/ErrorHandlingProvider.tsx","../../node_modules/wagmi/node_modules/@wagmi/connectors/dist/esm/coinbaseWallet.js","../../node_modules/wagmi/node_modules/@wagmi/connectors/dist/esm/walletConnect.js","../../src/lib/wagmi.ts","../../src/services/onchainTransactionService.ts","../../src/utils/queryInvalidation.ts","../../src/providers/Web3Provider.tsx","../../src/lib/vitals.ts","../../src/main.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","/**\n * react-router v7.9.6\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n\n// lib/router/history.ts\nvar Action = /* @__PURE__ */ ((Action2) => {\n  Action2[\"Pop\"] = \"POP\";\n  Action2[\"Push\"] = \"PUSH\";\n  Action2[\"Replace\"] = \"REPLACE\";\n  return Action2;\n})(Action || {});\nvar PopStateEventType = \"popstate\";\nfunction createMemoryHistory(options = {}) {\n  let { initialEntries = [\"/\"], initialIndex, v5Compat = false } = options;\n  let entries;\n  entries = initialEntries.map(\n    (entry, index2) => createMemoryLocation(\n      entry,\n      typeof entry === \"string\" ? null : entry.state,\n      index2 === 0 ? \"default\" : void 0\n    )\n  );\n  let index = clampIndex(\n    initialIndex == null ? entries.length - 1 : initialIndex\n  );\n  let action = \"POP\" /* Pop */;\n  let listener = null;\n  function clampIndex(n) {\n    return Math.min(Math.max(n, 0), entries.length - 1);\n  }\n  function getCurrentLocation() {\n    return entries[index];\n  }\n  function createMemoryLocation(to, state = null, key) {\n    let location = createLocation(\n      entries ? getCurrentLocation().pathname : \"/\",\n      to,\n      state,\n      key\n    );\n    warning(\n      location.pathname.charAt(0) === \"/\",\n      `relative pathnames are not supported in memory history: ${JSON.stringify(\n        to\n      )}`\n    );\n    return location;\n  }\n  function createHref2(to) {\n    return typeof to === \"string\" ? to : createPath(to);\n  }\n  let history = {\n    get index() {\n      return index;\n    },\n    get action() {\n      return action;\n    },\n    get location() {\n      return getCurrentLocation();\n    },\n    createHref: createHref2,\n    createURL(to) {\n      return new URL(createHref2(to), \"http://localhost\");\n    },\n    encodeLocation(to) {\n      let path = typeof to === \"string\" ? parsePath(to) : to;\n      return {\n        pathname: path.pathname || \"\",\n        search: path.search || \"\",\n        hash: path.hash || \"\"\n      };\n    },\n    push(to, state) {\n      action = \"PUSH\" /* Push */;\n      let nextLocation = createMemoryLocation(to, state);\n      index += 1;\n      entries.splice(index, entries.length, nextLocation);\n      if (v5Compat && listener) {\n        listener({ action, location: nextLocation, delta: 1 });\n      }\n    },\n    replace(to, state) {\n      action = \"REPLACE\" /* Replace */;\n      let nextLocation = createMemoryLocation(to, state);\n      entries[index] = nextLocation;\n      if (v5Compat && listener) {\n        listener({ action, location: nextLocation, delta: 0 });\n      }\n    },\n    go(delta) {\n      action = \"POP\" /* Pop */;\n      let nextIndex = clampIndex(index + delta);\n      let nextLocation = entries[nextIndex];\n      index = nextIndex;\n      if (listener) {\n        listener({ action, location: nextLocation, delta });\n      }\n    },\n    listen(fn) {\n      listener = fn;\n      return () => {\n        listener = null;\n      };\n    }\n  };\n  return history;\n}\nfunction createBrowserHistory(options = {}) {\n  function createBrowserLocation(window2, globalHistory) {\n    let { pathname, search, hash } = window2.location;\n    return createLocation(\n      \"\",\n      { pathname, search, hash },\n      // state defaults to `null` because `window.history.state` does\n      globalHistory.state && globalHistory.state.usr || null,\n      globalHistory.state && globalHistory.state.key || \"default\"\n    );\n  }\n  function createBrowserHref(window2, to) {\n    return typeof to === \"string\" ? to : createPath(to);\n  }\n  return getUrlBasedHistory(\n    createBrowserLocation,\n    createBrowserHref,\n    null,\n    options\n  );\n}\nfunction createHashHistory(options = {}) {\n  function createHashLocation(window2, globalHistory) {\n    let {\n      pathname = \"/\",\n      search = \"\",\n      hash = \"\"\n    } = parsePath(window2.location.hash.substring(1));\n    if (!pathname.startsWith(\"/\") && !pathname.startsWith(\".\")) {\n      pathname = \"/\" + pathname;\n    }\n    return createLocation(\n      \"\",\n      { pathname, search, hash },\n      // state defaults to `null` because `window.history.state` does\n      globalHistory.state && globalHistory.state.usr || null,\n      globalHistory.state && globalHistory.state.key || \"default\"\n    );\n  }\n  function createHashHref(window2, to) {\n    let base = window2.document.querySelector(\"base\");\n    let href = \"\";\n    if (base && base.getAttribute(\"href\")) {\n      let url = window2.location.href;\n      let hashIndex = url.indexOf(\"#\");\n      href = hashIndex === -1 ? url : url.slice(0, hashIndex);\n    }\n    return href + \"#\" + (typeof to === \"string\" ? to : createPath(to));\n  }\n  function validateHashLocation(location, to) {\n    warning(\n      location.pathname.charAt(0) === \"/\",\n      `relative pathnames are not supported in hash history.push(${JSON.stringify(\n        to\n      )})`\n    );\n  }\n  return getUrlBasedHistory(\n    createHashLocation,\n    createHashHref,\n    validateHashLocation,\n    options\n  );\n}\nfunction invariant(value, message) {\n  if (value === false || value === null || typeof value === \"undefined\") {\n    throw new Error(message);\n  }\n}\nfunction warning(cond, message) {\n  if (!cond) {\n    if (typeof console !== \"undefined\") console.warn(message);\n    try {\n      throw new Error(message);\n    } catch (e) {\n    }\n  }\n}\nfunction createKey() {\n  return Math.random().toString(36).substring(2, 10);\n}\nfunction getHistoryState(location, index) {\n  return {\n    usr: location.state,\n    key: location.key,\n    idx: index\n  };\n}\nfunction createLocation(current, to, state = null, key) {\n  let location = {\n    pathname: typeof current === \"string\" ? current : current.pathname,\n    search: \"\",\n    hash: \"\",\n    ...typeof to === \"string\" ? parsePath(to) : to,\n    state,\n    // TODO: This could be cleaned up.  push/replace should probably just take\n    // full Locations now and avoid the need to run through this flow at all\n    // But that's a pretty big refactor to the current test suite so going to\n    // keep as is for the time being and just let any incoming keys take precedence\n    key: to && to.key || key || createKey()\n  };\n  return location;\n}\nfunction createPath({\n  pathname = \"/\",\n  search = \"\",\n  hash = \"\"\n}) {\n  if (search && search !== \"?\")\n    pathname += search.charAt(0) === \"?\" ? search : \"?\" + search;\n  if (hash && hash !== \"#\")\n    pathname += hash.charAt(0) === \"#\" ? hash : \"#\" + hash;\n  return pathname;\n}\nfunction parsePath(path) {\n  let parsedPath = {};\n  if (path) {\n    let hashIndex = path.indexOf(\"#\");\n    if (hashIndex >= 0) {\n      parsedPath.hash = path.substring(hashIndex);\n      path = path.substring(0, hashIndex);\n    }\n    let searchIndex = path.indexOf(\"?\");\n    if (searchIndex >= 0) {\n      parsedPath.search = path.substring(searchIndex);\n      path = path.substring(0, searchIndex);\n    }\n    if (path) {\n      parsedPath.pathname = path;\n    }\n  }\n  return parsedPath;\n}\nfunction getUrlBasedHistory(getLocation, createHref2, validateLocation, options = {}) {\n  let { window: window2 = document.defaultView, v5Compat = false } = options;\n  let globalHistory = window2.history;\n  let action = \"POP\" /* Pop */;\n  let listener = null;\n  let index = getIndex();\n  if (index == null) {\n    index = 0;\n    globalHistory.replaceState({ ...globalHistory.state, idx: index }, \"\");\n  }\n  function getIndex() {\n    let state = globalHistory.state || { idx: null };\n    return state.idx;\n  }\n  function handlePop() {\n    action = \"POP\" /* Pop */;\n    let nextIndex = getIndex();\n    let delta = nextIndex == null ? null : nextIndex - index;\n    index = nextIndex;\n    if (listener) {\n      listener({ action, location: history.location, delta });\n    }\n  }\n  function push(to, state) {\n    action = \"PUSH\" /* Push */;\n    let location = createLocation(history.location, to, state);\n    if (validateLocation) validateLocation(location, to);\n    index = getIndex() + 1;\n    let historyState = getHistoryState(location, index);\n    let url = history.createHref(location);\n    try {\n      globalHistory.pushState(historyState, \"\", url);\n    } catch (error) {\n      if (error instanceof DOMException && error.name === \"DataCloneError\") {\n        throw error;\n      }\n      window2.location.assign(url);\n    }\n    if (v5Compat && listener) {\n      listener({ action, location: history.location, delta: 1 });\n    }\n  }\n  function replace2(to, state) {\n    action = \"REPLACE\" /* Replace */;\n    let location = createLocation(history.location, to, state);\n    if (validateLocation) validateLocation(location, to);\n    index = getIndex();\n    let historyState = getHistoryState(location, index);\n    let url = history.createHref(location);\n    globalHistory.replaceState(historyState, \"\", url);\n    if (v5Compat && listener) {\n      listener({ action, location: history.location, delta: 0 });\n    }\n  }\n  function createURL(to) {\n    return createBrowserURLImpl(to);\n  }\n  let history = {\n    get action() {\n      return action;\n    },\n    get location() {\n      return getLocation(window2, globalHistory);\n    },\n    listen(fn) {\n      if (listener) {\n        throw new Error(\"A history only accepts one active listener\");\n      }\n      window2.addEventListener(PopStateEventType, handlePop);\n      listener = fn;\n      return () => {\n        window2.removeEventListener(PopStateEventType, handlePop);\n        listener = null;\n      };\n    },\n    createHref(to) {\n      return createHref2(window2, to);\n    },\n    createURL,\n    encodeLocation(to) {\n      let url = createURL(to);\n      return {\n        pathname: url.pathname,\n        search: url.search,\n        hash: url.hash\n      };\n    },\n    push,\n    replace: replace2,\n    go(n) {\n      return globalHistory.go(n);\n    }\n  };\n  return history;\n}\nfunction createBrowserURLImpl(to, isAbsolute = false) {\n  let base = \"http://localhost\";\n  if (typeof window !== \"undefined\") {\n    base = window.location.origin !== \"null\" ? window.location.origin : window.location.href;\n  }\n  invariant(base, \"No window.location.(origin|href) available to create URL\");\n  let href = typeof to === \"string\" ? to : createPath(to);\n  href = href.replace(/ $/, \"%20\");\n  if (!isAbsolute && href.startsWith(\"//\")) {\n    href = base + href;\n  }\n  return new URL(href, base);\n}\n\n// lib/router/utils.ts\nfunction createContext(defaultValue) {\n  return { defaultValue };\n}\nvar _map;\nvar RouterContextProvider = class {\n  /**\n   * Create a new `RouterContextProvider` instance\n   * @param init An optional initial context map to populate the provider with\n   */\n  constructor(init) {\n    __privateAdd(this, _map, /* @__PURE__ */ new Map());\n    if (init) {\n      for (let [context, value] of init) {\n        this.set(context, value);\n      }\n    }\n  }\n  /**\n   * Access a value from the context. If no value has been set for the context,\n   * it will return the context's `defaultValue` if provided, or throw an error\n   * if no `defaultValue` was set.\n   * @param context The context to get the value for\n   * @returns The value for the context, or the context's `defaultValue` if no\n   * value was set\n   */\n  get(context) {\n    if (__privateGet(this, _map).has(context)) {\n      return __privateGet(this, _map).get(context);\n    }\n    if (context.defaultValue !== void 0) {\n      return context.defaultValue;\n    }\n    throw new Error(\"No value found for context\");\n  }\n  /**\n   * Set a value for the context. If the context already has a value set, this\n   * will overwrite it.\n   *\n   * @param context The context to set the value for\n   * @param value The value to set for the context\n   * @returns {void}\n   */\n  set(context, value) {\n    __privateGet(this, _map).set(context, value);\n  }\n};\n_map = new WeakMap();\nvar unsupportedLazyRouteObjectKeys = /* @__PURE__ */ new Set([\n  \"lazy\",\n  \"caseSensitive\",\n  \"path\",\n  \"id\",\n  \"index\",\n  \"children\"\n]);\nfunction isUnsupportedLazyRouteObjectKey(key) {\n  return unsupportedLazyRouteObjectKeys.has(\n    key\n  );\n}\nvar unsupportedLazyRouteFunctionKeys = /* @__PURE__ */ new Set([\n  \"lazy\",\n  \"caseSensitive\",\n  \"path\",\n  \"id\",\n  \"index\",\n  \"middleware\",\n  \"children\"\n]);\nfunction isUnsupportedLazyRouteFunctionKey(key) {\n  return unsupportedLazyRouteFunctionKeys.has(\n    key\n  );\n}\nfunction isIndexRoute(route) {\n  return route.index === true;\n}\nfunction convertRoutesToDataRoutes(routes, mapRouteProperties2, parentPath = [], manifest = {}, allowInPlaceMutations = false) {\n  return routes.map((route, index) => {\n    let treePath = [...parentPath, String(index)];\n    let id = typeof route.id === \"string\" ? route.id : treePath.join(\"-\");\n    invariant(\n      route.index !== true || !route.children,\n      `Cannot specify children on an index route`\n    );\n    invariant(\n      allowInPlaceMutations || !manifest[id],\n      `Found a route id collision on id \"${id}\".  Route id's must be globally unique within Data Router usages`\n    );\n    if (isIndexRoute(route)) {\n      let indexRoute = {\n        ...route,\n        id\n      };\n      manifest[id] = mergeRouteUpdates(\n        indexRoute,\n        mapRouteProperties2(indexRoute)\n      );\n      return indexRoute;\n    } else {\n      let pathOrLayoutRoute = {\n        ...route,\n        id,\n        children: void 0\n      };\n      manifest[id] = mergeRouteUpdates(\n        pathOrLayoutRoute,\n        mapRouteProperties2(pathOrLayoutRoute)\n      );\n      if (route.children) {\n        pathOrLayoutRoute.children = convertRoutesToDataRoutes(\n          route.children,\n          mapRouteProperties2,\n          treePath,\n          manifest,\n          allowInPlaceMutations\n        );\n      }\n      return pathOrLayoutRoute;\n    }\n  });\n}\nfunction mergeRouteUpdates(route, updates) {\n  return Object.assign(route, {\n    ...updates,\n    ...typeof updates.lazy === \"object\" && updates.lazy != null ? {\n      lazy: {\n        ...route.lazy,\n        ...updates.lazy\n      }\n    } : {}\n  });\n}\nfunction matchRoutes(routes, locationArg, basename = \"/\") {\n  return matchRoutesImpl(routes, locationArg, basename, false);\n}\nfunction matchRoutesImpl(routes, locationArg, basename, allowPartial) {\n  let location = typeof locationArg === \"string\" ? parsePath(locationArg) : locationArg;\n  let pathname = stripBasename(location.pathname || \"/\", basename);\n  if (pathname == null) {\n    return null;\n  }\n  let branches = flattenRoutes(routes);\n  rankRouteBranches(branches);\n  let matches = null;\n  for (let i = 0; matches == null && i < branches.length; ++i) {\n    let decoded = decodePath(pathname);\n    matches = matchRouteBranch(\n      branches[i],\n      decoded,\n      allowPartial\n    );\n  }\n  return matches;\n}\nfunction convertRouteMatchToUiMatch(match, loaderData) {\n  let { route, pathname, params } = match;\n  return {\n    id: route.id,\n    pathname,\n    params,\n    data: loaderData[route.id],\n    loaderData: loaderData[route.id],\n    handle: route.handle\n  };\n}\nfunction flattenRoutes(routes, branches = [], parentsMeta = [], parentPath = \"\", _hasParentOptionalSegments = false) {\n  let flattenRoute = (route, index, hasParentOptionalSegments = _hasParentOptionalSegments, relativePath) => {\n    let meta = {\n      relativePath: relativePath === void 0 ? route.path || \"\" : relativePath,\n      caseSensitive: route.caseSensitive === true,\n      childrenIndex: index,\n      route\n    };\n    if (meta.relativePath.startsWith(\"/\")) {\n      if (!meta.relativePath.startsWith(parentPath) && hasParentOptionalSegments) {\n        return;\n      }\n      invariant(\n        meta.relativePath.startsWith(parentPath),\n        `Absolute route path \"${meta.relativePath}\" nested under path \"${parentPath}\" is not valid. An absolute child route path must start with the combined path of all its parent routes.`\n      );\n      meta.relativePath = meta.relativePath.slice(parentPath.length);\n    }\n    let path = joinPaths([parentPath, meta.relativePath]);\n    let routesMeta = parentsMeta.concat(meta);\n    if (route.children && route.children.length > 0) {\n      invariant(\n        // Our types know better, but runtime JS may not!\n        // @ts-expect-error\n        route.index !== true,\n        `Index routes must not have child routes. Please remove all child routes from route path \"${path}\".`\n      );\n      flattenRoutes(\n        route.children,\n        branches,\n        routesMeta,\n        path,\n        hasParentOptionalSegments\n      );\n    }\n    if (route.path == null && !route.index) {\n      return;\n    }\n    branches.push({\n      path,\n      score: computeScore(path, route.index),\n      routesMeta\n    });\n  };\n  routes.forEach((route, index) => {\n    if (route.path === \"\" || !route.path?.includes(\"?\")) {\n      flattenRoute(route, index);\n    } else {\n      for (let exploded of explodeOptionalSegments(route.path)) {\n        flattenRoute(route, index, true, exploded);\n      }\n    }\n  });\n  return branches;\n}\nfunction explodeOptionalSegments(path) {\n  let segments = path.split(\"/\");\n  if (segments.length === 0) return [];\n  let [first, ...rest] = segments;\n  let isOptional = first.endsWith(\"?\");\n  let required = first.replace(/\\?$/, \"\");\n  if (rest.length === 0) {\n    return isOptional ? [required, \"\"] : [required];\n  }\n  let restExploded = explodeOptionalSegments(rest.join(\"/\"));\n  let result = [];\n  result.push(\n    ...restExploded.map(\n      (subpath) => subpath === \"\" ? required : [required, subpath].join(\"/\")\n    )\n  );\n  if (isOptional) {\n    result.push(...restExploded);\n  }\n  return result.map(\n    (exploded) => path.startsWith(\"/\") && exploded === \"\" ? \"/\" : exploded\n  );\n}\nfunction rankRouteBranches(branches) {\n  branches.sort(\n    (a, b) => a.score !== b.score ? b.score - a.score : compareIndexes(\n      a.routesMeta.map((meta) => meta.childrenIndex),\n      b.routesMeta.map((meta) => meta.childrenIndex)\n    )\n  );\n}\nvar paramRe = /^:[\\w-]+$/;\nvar dynamicSegmentValue = 3;\nvar indexRouteValue = 2;\nvar emptySegmentValue = 1;\nvar staticSegmentValue = 10;\nvar splatPenalty = -2;\nvar isSplat = (s) => s === \"*\";\nfunction computeScore(path, index) {\n  let segments = path.split(\"/\");\n  let initialScore = segments.length;\n  if (segments.some(isSplat)) {\n    initialScore += splatPenalty;\n  }\n  if (index) {\n    initialScore += indexRouteValue;\n  }\n  return segments.filter((s) => !isSplat(s)).reduce(\n    (score, segment) => score + (paramRe.test(segment) ? dynamicSegmentValue : segment === \"\" ? emptySegmentValue : staticSegmentValue),\n    initialScore\n  );\n}\nfunction compareIndexes(a, b) {\n  let siblings = a.length === b.length && a.slice(0, -1).every((n, i) => n === b[i]);\n  return siblings ? (\n    // If two routes are siblings, we should try to match the earlier sibling\n    // first. This allows people to have fine-grained control over the matching\n    // behavior by simply putting routes with identical paths in the order they\n    // want them tried.\n    a[a.length - 1] - b[b.length - 1]\n  ) : (\n    // Otherwise, it doesn't really make sense to rank non-siblings by index,\n    // so they sort equally.\n    0\n  );\n}\nfunction matchRouteBranch(branch, pathname, allowPartial = false) {\n  let { routesMeta } = branch;\n  let matchedParams = {};\n  let matchedPathname = \"/\";\n  let matches = [];\n  for (let i = 0; i < routesMeta.length; ++i) {\n    let meta = routesMeta[i];\n    let end = i === routesMeta.length - 1;\n    let remainingPathname = matchedPathname === \"/\" ? pathname : pathname.slice(matchedPathname.length) || \"/\";\n    let match = matchPath(\n      { path: meta.relativePath, caseSensitive: meta.caseSensitive, end },\n      remainingPathname\n    );\n    let route = meta.route;\n    if (!match && end && allowPartial && !routesMeta[routesMeta.length - 1].route.index) {\n      match = matchPath(\n        {\n          path: meta.relativePath,\n          caseSensitive: meta.caseSensitive,\n          end: false\n        },\n        remainingPathname\n      );\n    }\n    if (!match) {\n      return null;\n    }\n    Object.assign(matchedParams, match.params);\n    matches.push({\n      // TODO: Can this as be avoided?\n      params: matchedParams,\n      pathname: joinPaths([matchedPathname, match.pathname]),\n      pathnameBase: normalizePathname(\n        joinPaths([matchedPathname, match.pathnameBase])\n      ),\n      route\n    });\n    if (match.pathnameBase !== \"/\") {\n      matchedPathname = joinPaths([matchedPathname, match.pathnameBase]);\n    }\n  }\n  return matches;\n}\nfunction generatePath(originalPath, params = {}) {\n  let path = originalPath;\n  if (path.endsWith(\"*\") && path !== \"*\" && !path.endsWith(\"/*\")) {\n    warning(\n      false,\n      `Route path \"${path}\" will be treated as if it were \"${path.replace(/\\*$/, \"/*\")}\" because the \\`*\\` character must always follow a \\`/\\` in the pattern. To get rid of this warning, please change the route path to \"${path.replace(/\\*$/, \"/*\")}\".`\n    );\n    path = path.replace(/\\*$/, \"/*\");\n  }\n  const prefix = path.startsWith(\"/\") ? \"/\" : \"\";\n  const stringify2 = (p) => p == null ? \"\" : typeof p === \"string\" ? p : String(p);\n  const segments = path.split(/\\/+/).map((segment, index, array) => {\n    const isLastSegment = index === array.length - 1;\n    if (isLastSegment && segment === \"*\") {\n      const star = \"*\";\n      return stringify2(params[star]);\n    }\n    const keyMatch = segment.match(/^:([\\w-]+)(\\??)$/);\n    if (keyMatch) {\n      const [, key, optional] = keyMatch;\n      let param = params[key];\n      invariant(optional === \"?\" || param != null, `Missing \":${key}\" param`);\n      return encodeURIComponent(stringify2(param));\n    }\n    return segment.replace(/\\?$/g, \"\");\n  }).filter((segment) => !!segment);\n  return prefix + segments.join(\"/\");\n}\nfunction matchPath(pattern, pathname) {\n  if (typeof pattern === \"string\") {\n    pattern = { path: pattern, caseSensitive: false, end: true };\n  }\n  let [matcher, compiledParams] = compilePath(\n    pattern.path,\n    pattern.caseSensitive,\n    pattern.end\n  );\n  let match = pathname.match(matcher);\n  if (!match) return null;\n  let matchedPathname = match[0];\n  let pathnameBase = matchedPathname.replace(/(.)\\/+$/, \"$1\");\n  let captureGroups = match.slice(1);\n  let params = compiledParams.reduce(\n    (memo2, { paramName, isOptional }, index) => {\n      if (paramName === \"*\") {\n        let splatValue = captureGroups[index] || \"\";\n        pathnameBase = matchedPathname.slice(0, matchedPathname.length - splatValue.length).replace(/(.)\\/+$/, \"$1\");\n      }\n      const value = captureGroups[index];\n      if (isOptional && !value) {\n        memo2[paramName] = void 0;\n      } else {\n        memo2[paramName] = (value || \"\").replace(/%2F/g, \"/\");\n      }\n      return memo2;\n    },\n    {}\n  );\n  return {\n    params,\n    pathname: matchedPathname,\n    pathnameBase,\n    pattern\n  };\n}\nfunction compilePath(path, caseSensitive = false, end = true) {\n  warning(\n    path === \"*\" || !path.endsWith(\"*\") || path.endsWith(\"/*\"),\n    `Route path \"${path}\" will be treated as if it were \"${path.replace(/\\*$/, \"/*\")}\" because the \\`*\\` character must always follow a \\`/\\` in the pattern. To get rid of this warning, please change the route path to \"${path.replace(/\\*$/, \"/*\")}\".`\n  );\n  let params = [];\n  let regexpSource = \"^\" + path.replace(/\\/*\\*?$/, \"\").replace(/^\\/*/, \"/\").replace(/[\\\\.*+^${}|()[\\]]/g, \"\\\\$&\").replace(\n    /\\/:([\\w-]+)(\\?)?/g,\n    (_, paramName, isOptional) => {\n      params.push({ paramName, isOptional: isOptional != null });\n      return isOptional ? \"/?([^\\\\/]+)?\" : \"/([^\\\\/]+)\";\n    }\n  ).replace(/\\/([\\w-]+)\\?(\\/|$)/g, \"(/$1)?$2\");\n  if (path.endsWith(\"*\")) {\n    params.push({ paramName: \"*\" });\n    regexpSource += path === \"*\" || path === \"/*\" ? \"(.*)$\" : \"(?:\\\\/(.+)|\\\\/*)$\";\n  } else if (end) {\n    regexpSource += \"\\\\/*$\";\n  } else if (path !== \"\" && path !== \"/\") {\n    regexpSource += \"(?:(?=\\\\/|$))\";\n  } else {\n  }\n  let matcher = new RegExp(regexpSource, caseSensitive ? void 0 : \"i\");\n  return [matcher, params];\n}\nfunction decodePath(value) {\n  try {\n    return value.split(\"/\").map((v) => decodeURIComponent(v).replace(/\\//g, \"%2F\")).join(\"/\");\n  } catch (error) {\n    warning(\n      false,\n      `The URL path \"${value}\" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${error}).`\n    );\n    return value;\n  }\n}\nfunction stripBasename(pathname, basename) {\n  if (basename === \"/\") return pathname;\n  if (!pathname.toLowerCase().startsWith(basename.toLowerCase())) {\n    return null;\n  }\n  let startIndex = basename.endsWith(\"/\") ? basename.length - 1 : basename.length;\n  let nextChar = pathname.charAt(startIndex);\n  if (nextChar && nextChar !== \"/\") {\n    return null;\n  }\n  return pathname.slice(startIndex) || \"/\";\n}\nfunction prependBasename({\n  basename,\n  pathname\n}) {\n  return pathname === \"/\" ? basename : joinPaths([basename, pathname]);\n}\nvar ABSOLUTE_URL_REGEX = /^(?:[a-z][a-z0-9+.-]*:|\\/\\/)/i;\nvar isAbsoluteUrl = (url) => ABSOLUTE_URL_REGEX.test(url);\nfunction resolvePath(to, fromPathname = \"/\") {\n  let {\n    pathname: toPathname,\n    search = \"\",\n    hash = \"\"\n  } = typeof to === \"string\" ? parsePath(to) : to;\n  let pathname;\n  if (toPathname) {\n    if (isAbsoluteUrl(toPathname)) {\n      pathname = toPathname;\n    } else {\n      if (toPathname.includes(\"//\")) {\n        let oldPathname = toPathname;\n        toPathname = toPathname.replace(/\\/\\/+/g, \"/\");\n        warning(\n          false,\n          `Pathnames cannot have embedded double slashes - normalizing ${oldPathname} -> ${toPathname}`\n        );\n      }\n      if (toPathname.startsWith(\"/\")) {\n        pathname = resolvePathname(toPathname.substring(1), \"/\");\n      } else {\n        pathname = resolvePathname(toPathname, fromPathname);\n      }\n    }\n  } else {\n    pathname = fromPathname;\n  }\n  return {\n    pathname,\n    search: normalizeSearch(search),\n    hash: normalizeHash(hash)\n  };\n}\nfunction resolvePathname(relativePath, fromPathname) {\n  let segments = fromPathname.replace(/\\/+$/, \"\").split(\"/\");\n  let relativeSegments = relativePath.split(\"/\");\n  relativeSegments.forEach((segment) => {\n    if (segment === \"..\") {\n      if (segments.length > 1) segments.pop();\n    } else if (segment !== \".\") {\n      segments.push(segment);\n    }\n  });\n  return segments.length > 1 ? segments.join(\"/\") : \"/\";\n}\nfunction getInvalidPathError(char, field, dest, path) {\n  return `Cannot include a '${char}' character in a manually specified \\`to.${field}\\` field [${JSON.stringify(\n    path\n  )}].  Please separate it out to the \\`to.${dest}\\` field. Alternatively you may provide the full path as a string in <Link to=\"...\"> and the router will parse it for you.`;\n}\nfunction getPathContributingMatches(matches) {\n  return matches.filter(\n    (match, index) => index === 0 || match.route.path && match.route.path.length > 0\n  );\n}\nfunction getResolveToMatches(matches) {\n  let pathMatches = getPathContributingMatches(matches);\n  return pathMatches.map(\n    (match, idx) => idx === pathMatches.length - 1 ? match.pathname : match.pathnameBase\n  );\n}\nfunction resolveTo(toArg, routePathnames, locationPathname, isPathRelative = false) {\n  let to;\n  if (typeof toArg === \"string\") {\n    to = parsePath(toArg);\n  } else {\n    to = { ...toArg };\n    invariant(\n      !to.pathname || !to.pathname.includes(\"?\"),\n      getInvalidPathError(\"?\", \"pathname\", \"search\", to)\n    );\n    invariant(\n      !to.pathname || !to.pathname.includes(\"#\"),\n      getInvalidPathError(\"#\", \"pathname\", \"hash\", to)\n    );\n    invariant(\n      !to.search || !to.search.includes(\"#\"),\n      getInvalidPathError(\"#\", \"search\", \"hash\", to)\n    );\n  }\n  let isEmptyPath = toArg === \"\" || to.pathname === \"\";\n  let toPathname = isEmptyPath ? \"/\" : to.pathname;\n  let from;\n  if (toPathname == null) {\n    from = locationPathname;\n  } else {\n    let routePathnameIndex = routePathnames.length - 1;\n    if (!isPathRelative && toPathname.startsWith(\"..\")) {\n      let toSegments = toPathname.split(\"/\");\n      while (toSegments[0] === \"..\") {\n        toSegments.shift();\n        routePathnameIndex -= 1;\n      }\n      to.pathname = toSegments.join(\"/\");\n    }\n    from = routePathnameIndex >= 0 ? routePathnames[routePathnameIndex] : \"/\";\n  }\n  let path = resolvePath(to, from);\n  let hasExplicitTrailingSlash = toPathname && toPathname !== \"/\" && toPathname.endsWith(\"/\");\n  let hasCurrentTrailingSlash = (isEmptyPath || toPathname === \".\") && locationPathname.endsWith(\"/\");\n  if (!path.pathname.endsWith(\"/\") && (hasExplicitTrailingSlash || hasCurrentTrailingSlash)) {\n    path.pathname += \"/\";\n  }\n  return path;\n}\nvar joinPaths = (paths) => paths.join(\"/\").replace(/\\/\\/+/g, \"/\");\nvar normalizePathname = (pathname) => pathname.replace(/\\/+$/, \"\").replace(/^\\/*/, \"/\");\nvar normalizeSearch = (search) => !search || search === \"?\" ? \"\" : search.startsWith(\"?\") ? search : \"?\" + search;\nvar normalizeHash = (hash) => !hash || hash === \"#\" ? \"\" : hash.startsWith(\"#\") ? hash : \"#\" + hash;\nvar DataWithResponseInit = class {\n  constructor(data2, init) {\n    this.type = \"DataWithResponseInit\";\n    this.data = data2;\n    this.init = init || null;\n  }\n};\nfunction data(data2, init) {\n  return new DataWithResponseInit(\n    data2,\n    typeof init === \"number\" ? { status: init } : init\n  );\n}\nvar redirect = (url, init = 302) => {\n  let responseInit = init;\n  if (typeof responseInit === \"number\") {\n    responseInit = { status: responseInit };\n  } else if (typeof responseInit.status === \"undefined\") {\n    responseInit.status = 302;\n  }\n  let headers = new Headers(responseInit.headers);\n  headers.set(\"Location\", url);\n  return new Response(null, { ...responseInit, headers });\n};\nvar redirectDocument = (url, init) => {\n  let response = redirect(url, init);\n  response.headers.set(\"X-Remix-Reload-Document\", \"true\");\n  return response;\n};\nvar replace = (url, init) => {\n  let response = redirect(url, init);\n  response.headers.set(\"X-Remix-Replace\", \"true\");\n  return response;\n};\nvar ErrorResponseImpl = class {\n  constructor(status, statusText, data2, internal = false) {\n    this.status = status;\n    this.statusText = statusText || \"\";\n    this.internal = internal;\n    if (data2 instanceof Error) {\n      this.data = data2.toString();\n      this.error = data2;\n    } else {\n      this.data = data2;\n    }\n  }\n};\nfunction isRouteErrorResponse(error) {\n  return error != null && typeof error.status === \"number\" && typeof error.statusText === \"string\" && typeof error.internal === \"boolean\" && \"data\" in error;\n}\nfunction getRoutePattern(paths) {\n  return paths.filter(Boolean).join(\"/\").replace(/\\/\\/*/g, \"/\") || \"/\";\n}\n\n// lib/router/instrumentation.ts\nvar UninstrumentedSymbol = Symbol(\"Uninstrumented\");\nfunction getRouteInstrumentationUpdates(fns, route) {\n  let aggregated = {\n    lazy: [],\n    \"lazy.loader\": [],\n    \"lazy.action\": [],\n    \"lazy.middleware\": [],\n    middleware: [],\n    loader: [],\n    action: []\n  };\n  fns.forEach(\n    (fn) => fn({\n      id: route.id,\n      index: route.index,\n      path: route.path,\n      instrument(i) {\n        let keys = Object.keys(aggregated);\n        for (let key of keys) {\n          if (i[key]) {\n            aggregated[key].push(i[key]);\n          }\n        }\n      }\n    })\n  );\n  let updates = {};\n  if (typeof route.lazy === \"function\" && aggregated.lazy.length > 0) {\n    let instrumented = wrapImpl(aggregated.lazy, route.lazy, () => void 0);\n    if (instrumented) {\n      updates.lazy = instrumented;\n    }\n  }\n  if (typeof route.lazy === \"object\") {\n    let lazyObject = route.lazy;\n    [\"middleware\", \"loader\", \"action\"].forEach((key) => {\n      let lazyFn = lazyObject[key];\n      let instrumentations = aggregated[`lazy.${key}`];\n      if (typeof lazyFn === \"function\" && instrumentations.length > 0) {\n        let instrumented = wrapImpl(instrumentations, lazyFn, () => void 0);\n        if (instrumented) {\n          updates.lazy = Object.assign(updates.lazy || {}, {\n            [key]: instrumented\n          });\n        }\n      }\n    });\n  }\n  [\"loader\", \"action\"].forEach((key) => {\n    let handler = route[key];\n    if (typeof handler === \"function\" && aggregated[key].length > 0) {\n      let original = handler[UninstrumentedSymbol] ?? handler;\n      let instrumented = wrapImpl(\n        aggregated[key],\n        original,\n        (...args) => getHandlerInfo(args[0])\n      );\n      if (instrumented) {\n        instrumented[UninstrumentedSymbol] = original;\n        updates[key] = instrumented;\n      }\n    }\n  });\n  if (route.middleware && route.middleware.length > 0 && aggregated.middleware.length > 0) {\n    updates.middleware = route.middleware.map((middleware) => {\n      let original = middleware[UninstrumentedSymbol] ?? middleware;\n      let instrumented = wrapImpl(\n        aggregated.middleware,\n        original,\n        (...args) => getHandlerInfo(args[0])\n      );\n      if (instrumented) {\n        instrumented[UninstrumentedSymbol] = original;\n        return instrumented;\n      }\n      return middleware;\n    });\n  }\n  return updates;\n}\nfunction instrumentClientSideRouter(router, fns) {\n  let aggregated = {\n    navigate: [],\n    fetch: []\n  };\n  fns.forEach(\n    (fn) => fn({\n      instrument(i) {\n        let keys = Object.keys(i);\n        for (let key of keys) {\n          if (i[key]) {\n            aggregated[key].push(i[key]);\n          }\n        }\n      }\n    })\n  );\n  if (aggregated.navigate.length > 0) {\n    let navigate = router.navigate[UninstrumentedSymbol] ?? router.navigate;\n    let instrumentedNavigate = wrapImpl(\n      aggregated.navigate,\n      navigate,\n      (...args) => {\n        let [to, opts] = args;\n        return {\n          to: typeof to === \"number\" || typeof to === \"string\" ? to : to ? createPath(to) : \".\",\n          ...getRouterInfo(router, opts ?? {})\n        };\n      }\n    );\n    if (instrumentedNavigate) {\n      instrumentedNavigate[UninstrumentedSymbol] = navigate;\n      router.navigate = instrumentedNavigate;\n    }\n  }\n  if (aggregated.fetch.length > 0) {\n    let fetch2 = router.fetch[UninstrumentedSymbol] ?? router.fetch;\n    let instrumentedFetch = wrapImpl(aggregated.fetch, fetch2, (...args) => {\n      let [key, , href, opts] = args;\n      return {\n        href: href ?? \".\",\n        fetcherKey: key,\n        ...getRouterInfo(router, opts ?? {})\n      };\n    });\n    if (instrumentedFetch) {\n      instrumentedFetch[UninstrumentedSymbol] = fetch2;\n      router.fetch = instrumentedFetch;\n    }\n  }\n  return router;\n}\nfunction instrumentHandler(handler, fns) {\n  let aggregated = {\n    request: []\n  };\n  fns.forEach(\n    (fn) => fn({\n      instrument(i) {\n        let keys = Object.keys(i);\n        for (let key of keys) {\n          if (i[key]) {\n            aggregated[key].push(i[key]);\n          }\n        }\n      }\n    })\n  );\n  let instrumentedHandler = handler;\n  if (aggregated.request.length > 0) {\n    instrumentedHandler = wrapImpl(aggregated.request, handler, (...args) => {\n      let [request, context] = args;\n      return {\n        request: getReadonlyRequest(request),\n        context: context != null ? getReadonlyContext(context) : context\n      };\n    });\n  }\n  return instrumentedHandler;\n}\nfunction wrapImpl(impls, handler, getInfo) {\n  if (impls.length === 0) {\n    return null;\n  }\n  return async (...args) => {\n    let result = await recurseRight(\n      impls,\n      getInfo(...args),\n      () => handler(...args),\n      impls.length - 1\n    );\n    if (result.type === \"error\") {\n      throw result.value;\n    }\n    return result.value;\n  };\n}\nasync function recurseRight(impls, info, handler, index) {\n  let impl = impls[index];\n  let result;\n  if (!impl) {\n    try {\n      let value = await handler();\n      result = { type: \"success\", value };\n    } catch (e) {\n      result = { type: \"error\", value: e };\n    }\n  } else {\n    let handlerPromise = void 0;\n    let callHandler = async () => {\n      if (handlerPromise) {\n        console.error(\"You cannot call instrumented handlers more than once\");\n      } else {\n        handlerPromise = recurseRight(impls, info, handler, index - 1);\n      }\n      result = await handlerPromise;\n      invariant(result, \"Expected a result\");\n      if (result.type === \"error\" && result.value instanceof Error) {\n        return { status: \"error\", error: result.value };\n      }\n      return { status: \"success\", error: void 0 };\n    };\n    try {\n      await impl(callHandler, info);\n    } catch (e) {\n      console.error(\"An instrumentation function threw an error:\", e);\n    }\n    if (!handlerPromise) {\n      await callHandler();\n    }\n    await handlerPromise;\n  }\n  if (result) {\n    return result;\n  }\n  return {\n    type: \"error\",\n    value: new Error(\"No result assigned in instrumentation chain.\")\n  };\n}\nfunction getHandlerInfo(args) {\n  let { request, context, params, unstable_pattern } = args;\n  return {\n    request: getReadonlyRequest(request),\n    params: { ...params },\n    unstable_pattern,\n    context: getReadonlyContext(context)\n  };\n}\nfunction getRouterInfo(router, opts) {\n  return {\n    currentUrl: createPath(router.state.location),\n    ...\"formMethod\" in opts ? { formMethod: opts.formMethod } : {},\n    ...\"formEncType\" in opts ? { formEncType: opts.formEncType } : {},\n    ...\"formData\" in opts ? { formData: opts.formData } : {},\n    ...\"body\" in opts ? { body: opts.body } : {}\n  };\n}\nfunction getReadonlyRequest(request) {\n  return {\n    method: request.method,\n    url: request.url,\n    headers: {\n      get: (...args) => request.headers.get(...args)\n    }\n  };\n}\nfunction getReadonlyContext(context) {\n  if (isPlainObject(context)) {\n    let frozen = { ...context };\n    Object.freeze(frozen);\n    return frozen;\n  } else {\n    return {\n      get: (ctx) => context.get(ctx)\n    };\n  }\n}\nvar objectProtoNames = Object.getOwnPropertyNames(Object.prototype).sort().join(\"\\0\");\nfunction isPlainObject(thing) {\n  if (thing === null || typeof thing !== \"object\") {\n    return false;\n  }\n  const proto = Object.getPrototypeOf(thing);\n  return proto === Object.prototype || proto === null || Object.getOwnPropertyNames(proto).sort().join(\"\\0\") === objectProtoNames;\n}\n\n// lib/router/router.ts\nvar validMutationMethodsArr = [\n  \"POST\",\n  \"PUT\",\n  \"PATCH\",\n  \"DELETE\"\n];\nvar validMutationMethods = new Set(\n  validMutationMethodsArr\n);\nvar validRequestMethodsArr = [\n  \"GET\",\n  ...validMutationMethodsArr\n];\nvar validRequestMethods = new Set(validRequestMethodsArr);\nvar redirectStatusCodes = /* @__PURE__ */ new Set([301, 302, 303, 307, 308]);\nvar redirectPreserveMethodStatusCodes = /* @__PURE__ */ new Set([307, 308]);\nvar IDLE_NAVIGATION = {\n  state: \"idle\",\n  location: void 0,\n  formMethod: void 0,\n  formAction: void 0,\n  formEncType: void 0,\n  formData: void 0,\n  json: void 0,\n  text: void 0\n};\nvar IDLE_FETCHER = {\n  state: \"idle\",\n  data: void 0,\n  formMethod: void 0,\n  formAction: void 0,\n  formEncType: void 0,\n  formData: void 0,\n  json: void 0,\n  text: void 0\n};\nvar IDLE_BLOCKER = {\n  state: \"unblocked\",\n  proceed: void 0,\n  reset: void 0,\n  location: void 0\n};\nvar defaultMapRouteProperties = (route) => ({\n  hasErrorBoundary: Boolean(route.hasErrorBoundary)\n});\nvar TRANSITIONS_STORAGE_KEY = \"remix-router-transitions\";\nvar ResetLoaderDataSymbol = Symbol(\"ResetLoaderData\");\nfunction createRouter(init) {\n  const routerWindow = init.window ? init.window : typeof window !== \"undefined\" ? window : void 0;\n  const isBrowser2 = typeof routerWindow !== \"undefined\" && typeof routerWindow.document !== \"undefined\" && typeof routerWindow.document.createElement !== \"undefined\";\n  invariant(\n    init.routes.length > 0,\n    \"You must provide a non-empty routes array to createRouter\"\n  );\n  let hydrationRouteProperties2 = init.hydrationRouteProperties || [];\n  let _mapRouteProperties = init.mapRouteProperties || defaultMapRouteProperties;\n  let mapRouteProperties2 = _mapRouteProperties;\n  if (init.unstable_instrumentations) {\n    let instrumentations = init.unstable_instrumentations;\n    mapRouteProperties2 = (route) => {\n      return {\n        ..._mapRouteProperties(route),\n        ...getRouteInstrumentationUpdates(\n          instrumentations.map((i) => i.route).filter(Boolean),\n          route\n        )\n      };\n    };\n  }\n  let manifest = {};\n  let dataRoutes = convertRoutesToDataRoutes(\n    init.routes,\n    mapRouteProperties2,\n    void 0,\n    manifest\n  );\n  let inFlightDataRoutes;\n  let basename = init.basename || \"/\";\n  if (!basename.startsWith(\"/\")) {\n    basename = `/${basename}`;\n  }\n  let dataStrategyImpl = init.dataStrategy || defaultDataStrategyWithMiddleware;\n  let future = {\n    ...init.future\n  };\n  let unlistenHistory = null;\n  let subscribers = /* @__PURE__ */ new Set();\n  let savedScrollPositions2 = null;\n  let getScrollRestorationKey2 = null;\n  let getScrollPosition = null;\n  let initialScrollRestored = init.hydrationData != null;\n  let initialMatches = matchRoutes(dataRoutes, init.history.location, basename);\n  let initialMatchesIsFOW = false;\n  let initialErrors = null;\n  let initialized;\n  if (initialMatches == null && !init.patchRoutesOnNavigation) {\n    let error = getInternalRouterError(404, {\n      pathname: init.history.location.pathname\n    });\n    let { matches, route } = getShortCircuitMatches(dataRoutes);\n    initialized = true;\n    initialMatches = matches;\n    initialErrors = { [route.id]: error };\n  } else {\n    if (initialMatches && !init.hydrationData) {\n      let fogOfWar = checkFogOfWar(\n        initialMatches,\n        dataRoutes,\n        init.history.location.pathname\n      );\n      if (fogOfWar.active) {\n        initialMatches = null;\n      }\n    }\n    if (!initialMatches) {\n      initialized = false;\n      initialMatches = [];\n      let fogOfWar = checkFogOfWar(\n        null,\n        dataRoutes,\n        init.history.location.pathname\n      );\n      if (fogOfWar.active && fogOfWar.matches) {\n        initialMatchesIsFOW = true;\n        initialMatches = fogOfWar.matches;\n      }\n    } else if (initialMatches.some((m) => m.route.lazy)) {\n      initialized = false;\n    } else if (!initialMatches.some((m) => routeHasLoaderOrMiddleware(m.route))) {\n      initialized = true;\n    } else {\n      let loaderData = init.hydrationData ? init.hydrationData.loaderData : null;\n      let errors = init.hydrationData ? init.hydrationData.errors : null;\n      if (errors) {\n        let idx = initialMatches.findIndex(\n          (m) => errors[m.route.id] !== void 0\n        );\n        initialized = initialMatches.slice(0, idx + 1).every(\n          (m) => !shouldLoadRouteOnHydration(m.route, loaderData, errors)\n        );\n      } else {\n        initialized = initialMatches.every(\n          (m) => !shouldLoadRouteOnHydration(m.route, loaderData, errors)\n        );\n      }\n    }\n  }\n  let router;\n  let state = {\n    historyAction: init.history.action,\n    location: init.history.location,\n    matches: initialMatches,\n    initialized,\n    navigation: IDLE_NAVIGATION,\n    // Don't restore on initial updateState() if we were SSR'd\n    restoreScrollPosition: init.hydrationData != null ? false : null,\n    preventScrollReset: false,\n    revalidation: \"idle\",\n    loaderData: init.hydrationData && init.hydrationData.loaderData || {},\n    actionData: init.hydrationData && init.hydrationData.actionData || null,\n    errors: init.hydrationData && init.hydrationData.errors || initialErrors,\n    fetchers: /* @__PURE__ */ new Map(),\n    blockers: /* @__PURE__ */ new Map()\n  };\n  let pendingAction = \"POP\" /* Pop */;\n  let pendingPreventScrollReset = false;\n  let pendingNavigationController;\n  let pendingViewTransitionEnabled = false;\n  let appliedViewTransitions = /* @__PURE__ */ new Map();\n  let removePageHideEventListener = null;\n  let isUninterruptedRevalidation = false;\n  let isRevalidationRequired = false;\n  let cancelledFetcherLoads = /* @__PURE__ */ new Set();\n  let fetchControllers = /* @__PURE__ */ new Map();\n  let incrementingLoadId = 0;\n  let pendingNavigationLoadId = -1;\n  let fetchReloadIds = /* @__PURE__ */ new Map();\n  let fetchRedirectIds = /* @__PURE__ */ new Set();\n  let fetchLoadMatches = /* @__PURE__ */ new Map();\n  let activeFetchers = /* @__PURE__ */ new Map();\n  let fetchersQueuedForDeletion = /* @__PURE__ */ new Set();\n  let blockerFunctions = /* @__PURE__ */ new Map();\n  let unblockBlockerHistoryUpdate = void 0;\n  let pendingRevalidationDfd = null;\n  function initialize() {\n    unlistenHistory = init.history.listen(\n      ({ action: historyAction, location, delta }) => {\n        if (unblockBlockerHistoryUpdate) {\n          unblockBlockerHistoryUpdate();\n          unblockBlockerHistoryUpdate = void 0;\n          return;\n        }\n        warning(\n          blockerFunctions.size === 0 || delta != null,\n          \"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.\"\n        );\n        let blockerKey = shouldBlockNavigation({\n          currentLocation: state.location,\n          nextLocation: location,\n          historyAction\n        });\n        if (blockerKey && delta != null) {\n          let nextHistoryUpdatePromise = new Promise((resolve) => {\n            unblockBlockerHistoryUpdate = resolve;\n          });\n          init.history.go(delta * -1);\n          updateBlocker(blockerKey, {\n            state: \"blocked\",\n            location,\n            proceed() {\n              updateBlocker(blockerKey, {\n                state: \"proceeding\",\n                proceed: void 0,\n                reset: void 0,\n                location\n              });\n              nextHistoryUpdatePromise.then(() => init.history.go(delta));\n            },\n            reset() {\n              let blockers = new Map(state.blockers);\n              blockers.set(blockerKey, IDLE_BLOCKER);\n              updateState({ blockers });\n            }\n          });\n          return;\n        }\n        return startNavigation(historyAction, location);\n      }\n    );\n    if (isBrowser2) {\n      restoreAppliedTransitions(routerWindow, appliedViewTransitions);\n      let _saveAppliedTransitions = () => persistAppliedTransitions(routerWindow, appliedViewTransitions);\n      routerWindow.addEventListener(\"pagehide\", _saveAppliedTransitions);\n      removePageHideEventListener = () => routerWindow.removeEventListener(\"pagehide\", _saveAppliedTransitions);\n    }\n    if (!state.initialized) {\n      startNavigation(\"POP\" /* Pop */, state.location, {\n        initialHydration: true\n      });\n    }\n    return router;\n  }\n  function dispose() {\n    if (unlistenHistory) {\n      unlistenHistory();\n    }\n    if (removePageHideEventListener) {\n      removePageHideEventListener();\n    }\n    subscribers.clear();\n    pendingNavigationController && pendingNavigationController.abort();\n    state.fetchers.forEach((_, key) => deleteFetcher(key));\n    state.blockers.forEach((_, key) => deleteBlocker(key));\n  }\n  function subscribe(fn) {\n    subscribers.add(fn);\n    return () => subscribers.delete(fn);\n  }\n  function updateState(newState, opts = {}) {\n    if (newState.matches) {\n      newState.matches = newState.matches.map((m) => {\n        let route = manifest[m.route.id];\n        let matchRoute = m.route;\n        if (matchRoute.element !== route.element || matchRoute.errorElement !== route.errorElement || matchRoute.hydrateFallbackElement !== route.hydrateFallbackElement) {\n          return {\n            ...m,\n            route\n          };\n        }\n        return m;\n      });\n    }\n    state = {\n      ...state,\n      ...newState\n    };\n    let unmountedFetchers = [];\n    let mountedFetchers = [];\n    state.fetchers.forEach((fetcher, key) => {\n      if (fetcher.state === \"idle\") {\n        if (fetchersQueuedForDeletion.has(key)) {\n          unmountedFetchers.push(key);\n        } else {\n          mountedFetchers.push(key);\n        }\n      }\n    });\n    fetchersQueuedForDeletion.forEach((key) => {\n      if (!state.fetchers.has(key) && !fetchControllers.has(key)) {\n        unmountedFetchers.push(key);\n      }\n    });\n    [...subscribers].forEach(\n      (subscriber) => subscriber(state, {\n        deletedFetchers: unmountedFetchers,\n        viewTransitionOpts: opts.viewTransitionOpts,\n        flushSync: opts.flushSync === true\n      })\n    );\n    unmountedFetchers.forEach((key) => deleteFetcher(key));\n    mountedFetchers.forEach((key) => state.fetchers.delete(key));\n  }\n  function completeNavigation(location, newState, { flushSync } = {}) {\n    let isActionReload = state.actionData != null && state.navigation.formMethod != null && isMutationMethod(state.navigation.formMethod) && state.navigation.state === \"loading\" && location.state?._isRedirect !== true;\n    let actionData;\n    if (newState.actionData) {\n      if (Object.keys(newState.actionData).length > 0) {\n        actionData = newState.actionData;\n      } else {\n        actionData = null;\n      }\n    } else if (isActionReload) {\n      actionData = state.actionData;\n    } else {\n      actionData = null;\n    }\n    let loaderData = newState.loaderData ? mergeLoaderData(\n      state.loaderData,\n      newState.loaderData,\n      newState.matches || [],\n      newState.errors\n    ) : state.loaderData;\n    let blockers = state.blockers;\n    if (blockers.size > 0) {\n      blockers = new Map(blockers);\n      blockers.forEach((_, k) => blockers.set(k, IDLE_BLOCKER));\n    }\n    let restoreScrollPosition = isUninterruptedRevalidation ? false : getSavedScrollPosition(location, newState.matches || state.matches);\n    let preventScrollReset = pendingPreventScrollReset === true || state.navigation.formMethod != null && isMutationMethod(state.navigation.formMethod) && location.state?._isRedirect !== true;\n    if (inFlightDataRoutes) {\n      dataRoutes = inFlightDataRoutes;\n      inFlightDataRoutes = void 0;\n    }\n    if (isUninterruptedRevalidation) {\n    } else if (pendingAction === \"POP\" /* Pop */) {\n    } else if (pendingAction === \"PUSH\" /* Push */) {\n      init.history.push(location, location.state);\n    } else if (pendingAction === \"REPLACE\" /* Replace */) {\n      init.history.replace(location, location.state);\n    }\n    let viewTransitionOpts;\n    if (pendingAction === \"POP\" /* Pop */) {\n      let priorPaths = appliedViewTransitions.get(state.location.pathname);\n      if (priorPaths && priorPaths.has(location.pathname)) {\n        viewTransitionOpts = {\n          currentLocation: state.location,\n          nextLocation: location\n        };\n      } else if (appliedViewTransitions.has(location.pathname)) {\n        viewTransitionOpts = {\n          currentLocation: location,\n          nextLocation: state.location\n        };\n      }\n    } else if (pendingViewTransitionEnabled) {\n      let toPaths = appliedViewTransitions.get(state.location.pathname);\n      if (toPaths) {\n        toPaths.add(location.pathname);\n      } else {\n        toPaths = /* @__PURE__ */ new Set([location.pathname]);\n        appliedViewTransitions.set(state.location.pathname, toPaths);\n      }\n      viewTransitionOpts = {\n        currentLocation: state.location,\n        nextLocation: location\n      };\n    }\n    updateState(\n      {\n        ...newState,\n        // matches, errors, fetchers go through as-is\n        actionData,\n        loaderData,\n        historyAction: pendingAction,\n        location,\n        initialized: true,\n        navigation: IDLE_NAVIGATION,\n        revalidation: \"idle\",\n        restoreScrollPosition,\n        preventScrollReset,\n        blockers\n      },\n      {\n        viewTransitionOpts,\n        flushSync: flushSync === true\n      }\n    );\n    pendingAction = \"POP\" /* Pop */;\n    pendingPreventScrollReset = false;\n    pendingViewTransitionEnabled = false;\n    isUninterruptedRevalidation = false;\n    isRevalidationRequired = false;\n    pendingRevalidationDfd?.resolve();\n    pendingRevalidationDfd = null;\n  }\n  async function navigate(to, opts) {\n    if (typeof to === \"number\") {\n      init.history.go(to);\n      return;\n    }\n    let normalizedPath = normalizeTo(\n      state.location,\n      state.matches,\n      basename,\n      to,\n      opts?.fromRouteId,\n      opts?.relative\n    );\n    let { path, submission, error } = normalizeNavigateOptions(\n      false,\n      normalizedPath,\n      opts\n    );\n    let currentLocation = state.location;\n    let nextLocation = createLocation(state.location, path, opts && opts.state);\n    nextLocation = {\n      ...nextLocation,\n      ...init.history.encodeLocation(nextLocation)\n    };\n    let userReplace = opts && opts.replace != null ? opts.replace : void 0;\n    let historyAction = \"PUSH\" /* Push */;\n    if (userReplace === true) {\n      historyAction = \"REPLACE\" /* Replace */;\n    } else if (userReplace === false) {\n    } else if (submission != null && isMutationMethod(submission.formMethod) && submission.formAction === state.location.pathname + state.location.search) {\n      historyAction = \"REPLACE\" /* Replace */;\n    }\n    let preventScrollReset = opts && \"preventScrollReset\" in opts ? opts.preventScrollReset === true : void 0;\n    let flushSync = (opts && opts.flushSync) === true;\n    let blockerKey = shouldBlockNavigation({\n      currentLocation,\n      nextLocation,\n      historyAction\n    });\n    if (blockerKey) {\n      updateBlocker(blockerKey, {\n        state: \"blocked\",\n        location: nextLocation,\n        proceed() {\n          updateBlocker(blockerKey, {\n            state: \"proceeding\",\n            proceed: void 0,\n            reset: void 0,\n            location: nextLocation\n          });\n          navigate(to, opts);\n        },\n        reset() {\n          let blockers = new Map(state.blockers);\n          blockers.set(blockerKey, IDLE_BLOCKER);\n          updateState({ blockers });\n        }\n      });\n      return;\n    }\n    await startNavigation(historyAction, nextLocation, {\n      submission,\n      // Send through the formData serialization error if we have one so we can\n      // render at the right error boundary after we match routes\n      pendingError: error,\n      preventScrollReset,\n      replace: opts && opts.replace,\n      enableViewTransition: opts && opts.viewTransition,\n      flushSync\n    });\n  }\n  function revalidate() {\n    if (!pendingRevalidationDfd) {\n      pendingRevalidationDfd = createDeferred();\n    }\n    interruptActiveLoads();\n    updateState({ revalidation: \"loading\" });\n    let promise = pendingRevalidationDfd.promise;\n    if (state.navigation.state === \"submitting\") {\n      return promise;\n    }\n    if (state.navigation.state === \"idle\") {\n      startNavigation(state.historyAction, state.location, {\n        startUninterruptedRevalidation: true\n      });\n      return promise;\n    }\n    startNavigation(\n      pendingAction || state.historyAction,\n      state.navigation.location,\n      {\n        overrideNavigation: state.navigation,\n        // Proxy through any rending view transition\n        enableViewTransition: pendingViewTransitionEnabled === true\n      }\n    );\n    return promise;\n  }\n  async function startNavigation(historyAction, location, opts) {\n    pendingNavigationController && pendingNavigationController.abort();\n    pendingNavigationController = null;\n    pendingAction = historyAction;\n    isUninterruptedRevalidation = (opts && opts.startUninterruptedRevalidation) === true;\n    saveScrollPosition(state.location, state.matches);\n    pendingPreventScrollReset = (opts && opts.preventScrollReset) === true;\n    pendingViewTransitionEnabled = (opts && opts.enableViewTransition) === true;\n    let routesToUse = inFlightDataRoutes || dataRoutes;\n    let loadingNavigation = opts && opts.overrideNavigation;\n    let matches = opts?.initialHydration && state.matches && state.matches.length > 0 && !initialMatchesIsFOW ? (\n      // `matchRoutes()` has already been called if we're in here via `router.initialize()`\n      state.matches\n    ) : matchRoutes(routesToUse, location, basename);\n    let flushSync = (opts && opts.flushSync) === true;\n    if (matches && state.initialized && !isRevalidationRequired && isHashChangeOnly(state.location, location) && !(opts && opts.submission && isMutationMethod(opts.submission.formMethod))) {\n      completeNavigation(location, { matches }, { flushSync });\n      return;\n    }\n    let fogOfWar = checkFogOfWar(matches, routesToUse, location.pathname);\n    if (fogOfWar.active && fogOfWar.matches) {\n      matches = fogOfWar.matches;\n    }\n    if (!matches) {\n      let { error, notFoundMatches, route } = handleNavigational404(\n        location.pathname\n      );\n      completeNavigation(\n        location,\n        {\n          matches: notFoundMatches,\n          loaderData: {},\n          errors: {\n            [route.id]: error\n          }\n        },\n        { flushSync }\n      );\n      return;\n    }\n    pendingNavigationController = new AbortController();\n    let request = createClientSideRequest(\n      init.history,\n      location,\n      pendingNavigationController.signal,\n      opts && opts.submission\n    );\n    let scopedContext = init.getContext ? await init.getContext() : new RouterContextProvider();\n    let pendingActionResult;\n    if (opts && opts.pendingError) {\n      pendingActionResult = [\n        findNearestBoundary(matches).route.id,\n        { type: \"error\" /* error */, error: opts.pendingError }\n      ];\n    } else if (opts && opts.submission && isMutationMethod(opts.submission.formMethod)) {\n      let actionResult = await handleAction(\n        request,\n        location,\n        opts.submission,\n        matches,\n        scopedContext,\n        fogOfWar.active,\n        opts && opts.initialHydration === true,\n        { replace: opts.replace, flushSync }\n      );\n      if (actionResult.shortCircuited) {\n        return;\n      }\n      if (actionResult.pendingActionResult) {\n        let [routeId, result] = actionResult.pendingActionResult;\n        if (isErrorResult(result) && isRouteErrorResponse(result.error) && result.error.status === 404) {\n          pendingNavigationController = null;\n          completeNavigation(location, {\n            matches: actionResult.matches,\n            loaderData: {},\n            errors: {\n              [routeId]: result.error\n            }\n          });\n          return;\n        }\n      }\n      matches = actionResult.matches || matches;\n      pendingActionResult = actionResult.pendingActionResult;\n      loadingNavigation = getLoadingNavigation(location, opts.submission);\n      flushSync = false;\n      fogOfWar.active = false;\n      request = createClientSideRequest(\n        init.history,\n        request.url,\n        request.signal\n      );\n    }\n    let {\n      shortCircuited,\n      matches: updatedMatches,\n      loaderData,\n      errors\n    } = await handleLoaders(\n      request,\n      location,\n      matches,\n      scopedContext,\n      fogOfWar.active,\n      loadingNavigation,\n      opts && opts.submission,\n      opts && opts.fetcherSubmission,\n      opts && opts.replace,\n      opts && opts.initialHydration === true,\n      flushSync,\n      pendingActionResult\n    );\n    if (shortCircuited) {\n      return;\n    }\n    pendingNavigationController = null;\n    completeNavigation(location, {\n      matches: updatedMatches || matches,\n      ...getActionDataForCommit(pendingActionResult),\n      loaderData,\n      errors\n    });\n  }\n  async function handleAction(request, location, submission, matches, scopedContext, isFogOfWar, initialHydration, opts = {}) {\n    interruptActiveLoads();\n    let navigation = getSubmittingNavigation(location, submission);\n    updateState({ navigation }, { flushSync: opts.flushSync === true });\n    if (isFogOfWar) {\n      let discoverResult = await discoverRoutes(\n        matches,\n        location.pathname,\n        request.signal\n      );\n      if (discoverResult.type === \"aborted\") {\n        return { shortCircuited: true };\n      } else if (discoverResult.type === \"error\") {\n        if (discoverResult.partialMatches.length === 0) {\n          let { matches: matches2, route } = getShortCircuitMatches(dataRoutes);\n          return {\n            matches: matches2,\n            pendingActionResult: [\n              route.id,\n              {\n                type: \"error\" /* error */,\n                error: discoverResult.error\n              }\n            ]\n          };\n        }\n        let boundaryId = findNearestBoundary(discoverResult.partialMatches).route.id;\n        return {\n          matches: discoverResult.partialMatches,\n          pendingActionResult: [\n            boundaryId,\n            {\n              type: \"error\" /* error */,\n              error: discoverResult.error\n            }\n          ]\n        };\n      } else if (!discoverResult.matches) {\n        let { notFoundMatches, error, route } = handleNavigational404(\n          location.pathname\n        );\n        return {\n          matches: notFoundMatches,\n          pendingActionResult: [\n            route.id,\n            {\n              type: \"error\" /* error */,\n              error\n            }\n          ]\n        };\n      } else {\n        matches = discoverResult.matches;\n      }\n    }\n    let result;\n    let actionMatch = getTargetMatch(matches, location);\n    if (!actionMatch.route.action && !actionMatch.route.lazy) {\n      result = {\n        type: \"error\" /* error */,\n        error: getInternalRouterError(405, {\n          method: request.method,\n          pathname: location.pathname,\n          routeId: actionMatch.route.id\n        })\n      };\n    } else {\n      let dsMatches = getTargetedDataStrategyMatches(\n        mapRouteProperties2,\n        manifest,\n        request,\n        matches,\n        actionMatch,\n        initialHydration ? [] : hydrationRouteProperties2,\n        scopedContext\n      );\n      let results = await callDataStrategy(\n        request,\n        dsMatches,\n        scopedContext,\n        null\n      );\n      result = results[actionMatch.route.id];\n      if (!result) {\n        for (let match of matches) {\n          if (results[match.route.id]) {\n            result = results[match.route.id];\n            break;\n          }\n        }\n      }\n      if (request.signal.aborted) {\n        return { shortCircuited: true };\n      }\n    }\n    if (isRedirectResult(result)) {\n      let replace2;\n      if (opts && opts.replace != null) {\n        replace2 = opts.replace;\n      } else {\n        let location2 = normalizeRedirectLocation(\n          result.response.headers.get(\"Location\"),\n          new URL(request.url),\n          basename\n        );\n        replace2 = location2 === state.location.pathname + state.location.search;\n      }\n      await startRedirectNavigation(request, result, true, {\n        submission,\n        replace: replace2\n      });\n      return { shortCircuited: true };\n    }\n    if (isErrorResult(result)) {\n      let boundaryMatch = findNearestBoundary(matches, actionMatch.route.id);\n      if ((opts && opts.replace) !== true) {\n        pendingAction = \"PUSH\" /* Push */;\n      }\n      return {\n        matches,\n        pendingActionResult: [\n          boundaryMatch.route.id,\n          result,\n          actionMatch.route.id\n        ]\n      };\n    }\n    return {\n      matches,\n      pendingActionResult: [actionMatch.route.id, result]\n    };\n  }\n  async function handleLoaders(request, location, matches, scopedContext, isFogOfWar, overrideNavigation, submission, fetcherSubmission, replace2, initialHydration, flushSync, pendingActionResult) {\n    let loadingNavigation = overrideNavigation || getLoadingNavigation(location, submission);\n    let activeSubmission = submission || fetcherSubmission || getSubmissionFromNavigation(loadingNavigation);\n    let shouldUpdateNavigationState = !isUninterruptedRevalidation && !initialHydration;\n    if (isFogOfWar) {\n      if (shouldUpdateNavigationState) {\n        let actionData = getUpdatedActionData(pendingActionResult);\n        updateState(\n          {\n            navigation: loadingNavigation,\n            ...actionData !== void 0 ? { actionData } : {}\n          },\n          {\n            flushSync\n          }\n        );\n      }\n      let discoverResult = await discoverRoutes(\n        matches,\n        location.pathname,\n        request.signal\n      );\n      if (discoverResult.type === \"aborted\") {\n        return { shortCircuited: true };\n      } else if (discoverResult.type === \"error\") {\n        if (discoverResult.partialMatches.length === 0) {\n          let { matches: matches2, route } = getShortCircuitMatches(dataRoutes);\n          return {\n            matches: matches2,\n            loaderData: {},\n            errors: {\n              [route.id]: discoverResult.error\n            }\n          };\n        }\n        let boundaryId = findNearestBoundary(discoverResult.partialMatches).route.id;\n        return {\n          matches: discoverResult.partialMatches,\n          loaderData: {},\n          errors: {\n            [boundaryId]: discoverResult.error\n          }\n        };\n      } else if (!discoverResult.matches) {\n        let { error, notFoundMatches, route } = handleNavigational404(\n          location.pathname\n        );\n        return {\n          matches: notFoundMatches,\n          loaderData: {},\n          errors: {\n            [route.id]: error\n          }\n        };\n      } else {\n        matches = discoverResult.matches;\n      }\n    }\n    let routesToUse = inFlightDataRoutes || dataRoutes;\n    let { dsMatches, revalidatingFetchers } = getMatchesToLoad(\n      request,\n      scopedContext,\n      mapRouteProperties2,\n      manifest,\n      init.history,\n      state,\n      matches,\n      activeSubmission,\n      location,\n      initialHydration ? [] : hydrationRouteProperties2,\n      initialHydration === true,\n      isRevalidationRequired,\n      cancelledFetcherLoads,\n      fetchersQueuedForDeletion,\n      fetchLoadMatches,\n      fetchRedirectIds,\n      routesToUse,\n      basename,\n      init.patchRoutesOnNavigation != null,\n      pendingActionResult\n    );\n    pendingNavigationLoadId = ++incrementingLoadId;\n    if (!init.dataStrategy && !dsMatches.some((m) => m.shouldLoad) && !dsMatches.some(\n      (m) => m.route.middleware && m.route.middleware.length > 0\n    ) && revalidatingFetchers.length === 0) {\n      let updatedFetchers2 = markFetchRedirectsDone();\n      completeNavigation(\n        location,\n        {\n          matches,\n          loaderData: {},\n          // Commit pending error if we're short circuiting\n          errors: pendingActionResult && isErrorResult(pendingActionResult[1]) ? { [pendingActionResult[0]]: pendingActionResult[1].error } : null,\n          ...getActionDataForCommit(pendingActionResult),\n          ...updatedFetchers2 ? { fetchers: new Map(state.fetchers) } : {}\n        },\n        { flushSync }\n      );\n      return { shortCircuited: true };\n    }\n    if (shouldUpdateNavigationState) {\n      let updates = {};\n      if (!isFogOfWar) {\n        updates.navigation = loadingNavigation;\n        let actionData = getUpdatedActionData(pendingActionResult);\n        if (actionData !== void 0) {\n          updates.actionData = actionData;\n        }\n      }\n      if (revalidatingFetchers.length > 0) {\n        updates.fetchers = getUpdatedRevalidatingFetchers(revalidatingFetchers);\n      }\n      updateState(updates, { flushSync });\n    }\n    revalidatingFetchers.forEach((rf) => {\n      abortFetcher(rf.key);\n      if (rf.controller) {\n        fetchControllers.set(rf.key, rf.controller);\n      }\n    });\n    let abortPendingFetchRevalidations = () => revalidatingFetchers.forEach((f) => abortFetcher(f.key));\n    if (pendingNavigationController) {\n      pendingNavigationController.signal.addEventListener(\n        \"abort\",\n        abortPendingFetchRevalidations\n      );\n    }\n    let { loaderResults, fetcherResults } = await callLoadersAndMaybeResolveData(\n      dsMatches,\n      revalidatingFetchers,\n      request,\n      scopedContext\n    );\n    if (request.signal.aborted) {\n      return { shortCircuited: true };\n    }\n    if (pendingNavigationController) {\n      pendingNavigationController.signal.removeEventListener(\n        \"abort\",\n        abortPendingFetchRevalidations\n      );\n    }\n    revalidatingFetchers.forEach((rf) => fetchControllers.delete(rf.key));\n    let redirect2 = findRedirect(loaderResults);\n    if (redirect2) {\n      await startRedirectNavigation(request, redirect2.result, true, {\n        replace: replace2\n      });\n      return { shortCircuited: true };\n    }\n    redirect2 = findRedirect(fetcherResults);\n    if (redirect2) {\n      fetchRedirectIds.add(redirect2.key);\n      await startRedirectNavigation(request, redirect2.result, true, {\n        replace: replace2\n      });\n      return { shortCircuited: true };\n    }\n    let { loaderData, errors } = processLoaderData(\n      state,\n      matches,\n      loaderResults,\n      pendingActionResult,\n      revalidatingFetchers,\n      fetcherResults\n    );\n    if (initialHydration && state.errors) {\n      errors = { ...state.errors, ...errors };\n    }\n    let updatedFetchers = markFetchRedirectsDone();\n    let didAbortFetchLoads = abortStaleFetchLoads(pendingNavigationLoadId);\n    let shouldUpdateFetchers = updatedFetchers || didAbortFetchLoads || revalidatingFetchers.length > 0;\n    return {\n      matches,\n      loaderData,\n      errors,\n      ...shouldUpdateFetchers ? { fetchers: new Map(state.fetchers) } : {}\n    };\n  }\n  function getUpdatedActionData(pendingActionResult) {\n    if (pendingActionResult && !isErrorResult(pendingActionResult[1])) {\n      return {\n        [pendingActionResult[0]]: pendingActionResult[1].data\n      };\n    } else if (state.actionData) {\n      if (Object.keys(state.actionData).length === 0) {\n        return null;\n      } else {\n        return state.actionData;\n      }\n    }\n  }\n  function getUpdatedRevalidatingFetchers(revalidatingFetchers) {\n    revalidatingFetchers.forEach((rf) => {\n      let fetcher = state.fetchers.get(rf.key);\n      let revalidatingFetcher = getLoadingFetcher(\n        void 0,\n        fetcher ? fetcher.data : void 0\n      );\n      state.fetchers.set(rf.key, revalidatingFetcher);\n    });\n    return new Map(state.fetchers);\n  }\n  async function fetch2(key, routeId, href, opts) {\n    abortFetcher(key);\n    let flushSync = (opts && opts.flushSync) === true;\n    let routesToUse = inFlightDataRoutes || dataRoutes;\n    let normalizedPath = normalizeTo(\n      state.location,\n      state.matches,\n      basename,\n      href,\n      routeId,\n      opts?.relative\n    );\n    let matches = matchRoutes(routesToUse, normalizedPath, basename);\n    let fogOfWar = checkFogOfWar(matches, routesToUse, normalizedPath);\n    if (fogOfWar.active && fogOfWar.matches) {\n      matches = fogOfWar.matches;\n    }\n    if (!matches) {\n      setFetcherError(\n        key,\n        routeId,\n        getInternalRouterError(404, { pathname: normalizedPath }),\n        { flushSync }\n      );\n      return;\n    }\n    let { path, submission, error } = normalizeNavigateOptions(\n      true,\n      normalizedPath,\n      opts\n    );\n    if (error) {\n      setFetcherError(key, routeId, error, { flushSync });\n      return;\n    }\n    let scopedContext = init.getContext ? await init.getContext() : new RouterContextProvider();\n    let preventScrollReset = (opts && opts.preventScrollReset) === true;\n    if (submission && isMutationMethod(submission.formMethod)) {\n      await handleFetcherAction(\n        key,\n        routeId,\n        path,\n        matches,\n        scopedContext,\n        fogOfWar.active,\n        flushSync,\n        preventScrollReset,\n        submission\n      );\n      return;\n    }\n    fetchLoadMatches.set(key, { routeId, path });\n    await handleFetcherLoader(\n      key,\n      routeId,\n      path,\n      matches,\n      scopedContext,\n      fogOfWar.active,\n      flushSync,\n      preventScrollReset,\n      submission\n    );\n  }\n  async function handleFetcherAction(key, routeId, path, requestMatches, scopedContext, isFogOfWar, flushSync, preventScrollReset, submission) {\n    interruptActiveLoads();\n    fetchLoadMatches.delete(key);\n    let existingFetcher = state.fetchers.get(key);\n    updateFetcherState(key, getSubmittingFetcher(submission, existingFetcher), {\n      flushSync\n    });\n    let abortController = new AbortController();\n    let fetchRequest = createClientSideRequest(\n      init.history,\n      path,\n      abortController.signal,\n      submission\n    );\n    if (isFogOfWar) {\n      let discoverResult = await discoverRoutes(\n        requestMatches,\n        new URL(fetchRequest.url).pathname,\n        fetchRequest.signal,\n        key\n      );\n      if (discoverResult.type === \"aborted\") {\n        return;\n      } else if (discoverResult.type === \"error\") {\n        setFetcherError(key, routeId, discoverResult.error, { flushSync });\n        return;\n      } else if (!discoverResult.matches) {\n        setFetcherError(\n          key,\n          routeId,\n          getInternalRouterError(404, { pathname: path }),\n          { flushSync }\n        );\n        return;\n      } else {\n        requestMatches = discoverResult.matches;\n      }\n    }\n    let match = getTargetMatch(requestMatches, path);\n    if (!match.route.action && !match.route.lazy) {\n      let error = getInternalRouterError(405, {\n        method: submission.formMethod,\n        pathname: path,\n        routeId\n      });\n      setFetcherError(key, routeId, error, { flushSync });\n      return;\n    }\n    fetchControllers.set(key, abortController);\n    let originatingLoadId = incrementingLoadId;\n    let fetchMatches = getTargetedDataStrategyMatches(\n      mapRouteProperties2,\n      manifest,\n      fetchRequest,\n      requestMatches,\n      match,\n      hydrationRouteProperties2,\n      scopedContext\n    );\n    let actionResults = await callDataStrategy(\n      fetchRequest,\n      fetchMatches,\n      scopedContext,\n      key\n    );\n    let actionResult = actionResults[match.route.id];\n    if (!actionResult) {\n      for (let match2 of fetchMatches) {\n        if (actionResults[match2.route.id]) {\n          actionResult = actionResults[match2.route.id];\n          break;\n        }\n      }\n    }\n    if (fetchRequest.signal.aborted) {\n      if (fetchControllers.get(key) === abortController) {\n        fetchControllers.delete(key);\n      }\n      return;\n    }\n    if (fetchersQueuedForDeletion.has(key)) {\n      if (isRedirectResult(actionResult) || isErrorResult(actionResult)) {\n        updateFetcherState(key, getDoneFetcher(void 0));\n        return;\n      }\n    } else {\n      if (isRedirectResult(actionResult)) {\n        fetchControllers.delete(key);\n        if (pendingNavigationLoadId > originatingLoadId) {\n          updateFetcherState(key, getDoneFetcher(void 0));\n          return;\n        } else {\n          fetchRedirectIds.add(key);\n          updateFetcherState(key, getLoadingFetcher(submission));\n          return startRedirectNavigation(fetchRequest, actionResult, false, {\n            fetcherSubmission: submission,\n            preventScrollReset\n          });\n        }\n      }\n      if (isErrorResult(actionResult)) {\n        setFetcherError(key, routeId, actionResult.error);\n        return;\n      }\n    }\n    let nextLocation = state.navigation.location || state.location;\n    let revalidationRequest = createClientSideRequest(\n      init.history,\n      nextLocation,\n      abortController.signal\n    );\n    let routesToUse = inFlightDataRoutes || dataRoutes;\n    let matches = state.navigation.state !== \"idle\" ? matchRoutes(routesToUse, state.navigation.location, basename) : state.matches;\n    invariant(matches, \"Didn't find any matches after fetcher action\");\n    let loadId = ++incrementingLoadId;\n    fetchReloadIds.set(key, loadId);\n    let loadFetcher = getLoadingFetcher(submission, actionResult.data);\n    state.fetchers.set(key, loadFetcher);\n    let { dsMatches, revalidatingFetchers } = getMatchesToLoad(\n      revalidationRequest,\n      scopedContext,\n      mapRouteProperties2,\n      manifest,\n      init.history,\n      state,\n      matches,\n      submission,\n      nextLocation,\n      hydrationRouteProperties2,\n      false,\n      isRevalidationRequired,\n      cancelledFetcherLoads,\n      fetchersQueuedForDeletion,\n      fetchLoadMatches,\n      fetchRedirectIds,\n      routesToUse,\n      basename,\n      init.patchRoutesOnNavigation != null,\n      [match.route.id, actionResult]\n    );\n    revalidatingFetchers.filter((rf) => rf.key !== key).forEach((rf) => {\n      let staleKey = rf.key;\n      let existingFetcher2 = state.fetchers.get(staleKey);\n      let revalidatingFetcher = getLoadingFetcher(\n        void 0,\n        existingFetcher2 ? existingFetcher2.data : void 0\n      );\n      state.fetchers.set(staleKey, revalidatingFetcher);\n      abortFetcher(staleKey);\n      if (rf.controller) {\n        fetchControllers.set(staleKey, rf.controller);\n      }\n    });\n    updateState({ fetchers: new Map(state.fetchers) });\n    let abortPendingFetchRevalidations = () => revalidatingFetchers.forEach((rf) => abortFetcher(rf.key));\n    abortController.signal.addEventListener(\n      \"abort\",\n      abortPendingFetchRevalidations\n    );\n    let { loaderResults, fetcherResults } = await callLoadersAndMaybeResolveData(\n      dsMatches,\n      revalidatingFetchers,\n      revalidationRequest,\n      scopedContext\n    );\n    if (abortController.signal.aborted) {\n      return;\n    }\n    abortController.signal.removeEventListener(\n      \"abort\",\n      abortPendingFetchRevalidations\n    );\n    fetchReloadIds.delete(key);\n    fetchControllers.delete(key);\n    revalidatingFetchers.forEach((r) => fetchControllers.delete(r.key));\n    if (state.fetchers.has(key)) {\n      let doneFetcher = getDoneFetcher(actionResult.data);\n      state.fetchers.set(key, doneFetcher);\n    }\n    let redirect2 = findRedirect(loaderResults);\n    if (redirect2) {\n      return startRedirectNavigation(\n        revalidationRequest,\n        redirect2.result,\n        false,\n        { preventScrollReset }\n      );\n    }\n    redirect2 = findRedirect(fetcherResults);\n    if (redirect2) {\n      fetchRedirectIds.add(redirect2.key);\n      return startRedirectNavigation(\n        revalidationRequest,\n        redirect2.result,\n        false,\n        { preventScrollReset }\n      );\n    }\n    let { loaderData, errors } = processLoaderData(\n      state,\n      matches,\n      loaderResults,\n      void 0,\n      revalidatingFetchers,\n      fetcherResults\n    );\n    abortStaleFetchLoads(loadId);\n    if (state.navigation.state === \"loading\" && loadId > pendingNavigationLoadId) {\n      invariant(pendingAction, \"Expected pending action\");\n      pendingNavigationController && pendingNavigationController.abort();\n      completeNavigation(state.navigation.location, {\n        matches,\n        loaderData,\n        errors,\n        fetchers: new Map(state.fetchers)\n      });\n    } else {\n      updateState({\n        errors,\n        loaderData: mergeLoaderData(\n          state.loaderData,\n          loaderData,\n          matches,\n          errors\n        ),\n        fetchers: new Map(state.fetchers)\n      });\n      isRevalidationRequired = false;\n    }\n  }\n  async function handleFetcherLoader(key, routeId, path, matches, scopedContext, isFogOfWar, flushSync, preventScrollReset, submission) {\n    let existingFetcher = state.fetchers.get(key);\n    updateFetcherState(\n      key,\n      getLoadingFetcher(\n        submission,\n        existingFetcher ? existingFetcher.data : void 0\n      ),\n      { flushSync }\n    );\n    let abortController = new AbortController();\n    let fetchRequest = createClientSideRequest(\n      init.history,\n      path,\n      abortController.signal\n    );\n    if (isFogOfWar) {\n      let discoverResult = await discoverRoutes(\n        matches,\n        new URL(fetchRequest.url).pathname,\n        fetchRequest.signal,\n        key\n      );\n      if (discoverResult.type === \"aborted\") {\n        return;\n      } else if (discoverResult.type === \"error\") {\n        setFetcherError(key, routeId, discoverResult.error, { flushSync });\n        return;\n      } else if (!discoverResult.matches) {\n        setFetcherError(\n          key,\n          routeId,\n          getInternalRouterError(404, { pathname: path }),\n          { flushSync }\n        );\n        return;\n      } else {\n        matches = discoverResult.matches;\n      }\n    }\n    let match = getTargetMatch(matches, path);\n    fetchControllers.set(key, abortController);\n    let originatingLoadId = incrementingLoadId;\n    let dsMatches = getTargetedDataStrategyMatches(\n      mapRouteProperties2,\n      manifest,\n      fetchRequest,\n      matches,\n      match,\n      hydrationRouteProperties2,\n      scopedContext\n    );\n    let results = await callDataStrategy(\n      fetchRequest,\n      dsMatches,\n      scopedContext,\n      key\n    );\n    let result = results[match.route.id];\n    if (fetchControllers.get(key) === abortController) {\n      fetchControllers.delete(key);\n    }\n    if (fetchRequest.signal.aborted) {\n      return;\n    }\n    if (fetchersQueuedForDeletion.has(key)) {\n      updateFetcherState(key, getDoneFetcher(void 0));\n      return;\n    }\n    if (isRedirectResult(result)) {\n      if (pendingNavigationLoadId > originatingLoadId) {\n        updateFetcherState(key, getDoneFetcher(void 0));\n        return;\n      } else {\n        fetchRedirectIds.add(key);\n        await startRedirectNavigation(fetchRequest, result, false, {\n          preventScrollReset\n        });\n        return;\n      }\n    }\n    if (isErrorResult(result)) {\n      setFetcherError(key, routeId, result.error);\n      return;\n    }\n    updateFetcherState(key, getDoneFetcher(result.data));\n  }\n  async function startRedirectNavigation(request, redirect2, isNavigation, {\n    submission,\n    fetcherSubmission,\n    preventScrollReset,\n    replace: replace2\n  } = {}) {\n    if (redirect2.response.headers.has(\"X-Remix-Revalidate\")) {\n      isRevalidationRequired = true;\n    }\n    let location = redirect2.response.headers.get(\"Location\");\n    invariant(location, \"Expected a Location header on the redirect Response\");\n    location = normalizeRedirectLocation(\n      location,\n      new URL(request.url),\n      basename\n    );\n    let redirectLocation = createLocation(state.location, location, {\n      _isRedirect: true\n    });\n    if (isBrowser2) {\n      let isDocumentReload = false;\n      if (redirect2.response.headers.has(\"X-Remix-Reload-Document\")) {\n        isDocumentReload = true;\n      } else if (isAbsoluteUrl(location)) {\n        const url = createBrowserURLImpl(location, true);\n        isDocumentReload = // Hard reload if it's an absolute URL to a new origin\n        url.origin !== routerWindow.location.origin || // Hard reload if it's an absolute URL that does not match our basename\n        stripBasename(url.pathname, basename) == null;\n      }\n      if (isDocumentReload) {\n        if (replace2) {\n          routerWindow.location.replace(location);\n        } else {\n          routerWindow.location.assign(location);\n        }\n        return;\n      }\n    }\n    pendingNavigationController = null;\n    let redirectNavigationType = replace2 === true || redirect2.response.headers.has(\"X-Remix-Replace\") ? \"REPLACE\" /* Replace */ : \"PUSH\" /* Push */;\n    let { formMethod, formAction, formEncType } = state.navigation;\n    if (!submission && !fetcherSubmission && formMethod && formAction && formEncType) {\n      submission = getSubmissionFromNavigation(state.navigation);\n    }\n    let activeSubmission = submission || fetcherSubmission;\n    if (redirectPreserveMethodStatusCodes.has(redirect2.response.status) && activeSubmission && isMutationMethod(activeSubmission.formMethod)) {\n      await startNavigation(redirectNavigationType, redirectLocation, {\n        submission: {\n          ...activeSubmission,\n          formAction: location\n        },\n        // Preserve these flags across redirects\n        preventScrollReset: preventScrollReset || pendingPreventScrollReset,\n        enableViewTransition: isNavigation ? pendingViewTransitionEnabled : void 0\n      });\n    } else {\n      let overrideNavigation = getLoadingNavigation(\n        redirectLocation,\n        submission\n      );\n      await startNavigation(redirectNavigationType, redirectLocation, {\n        overrideNavigation,\n        // Send fetcher submissions through for shouldRevalidate\n        fetcherSubmission,\n        // Preserve these flags across redirects\n        preventScrollReset: preventScrollReset || pendingPreventScrollReset,\n        enableViewTransition: isNavigation ? pendingViewTransitionEnabled : void 0\n      });\n    }\n  }\n  async function callDataStrategy(request, matches, scopedContext, fetcherKey) {\n    let results;\n    let dataResults = {};\n    try {\n      results = await callDataStrategyImpl(\n        dataStrategyImpl,\n        request,\n        matches,\n        fetcherKey,\n        scopedContext,\n        false\n      );\n    } catch (e) {\n      matches.filter((m) => m.shouldLoad).forEach((m) => {\n        dataResults[m.route.id] = {\n          type: \"error\" /* error */,\n          error: e\n        };\n      });\n      return dataResults;\n    }\n    if (request.signal.aborted) {\n      return dataResults;\n    }\n    for (let [routeId, result] of Object.entries(results)) {\n      if (isRedirectDataStrategyResult(result)) {\n        let response = result.result;\n        dataResults[routeId] = {\n          type: \"redirect\" /* redirect */,\n          response: normalizeRelativeRoutingRedirectResponse(\n            response,\n            request,\n            routeId,\n            matches,\n            basename\n          )\n        };\n      } else {\n        dataResults[routeId] = await convertDataStrategyResultToDataResult(result);\n      }\n    }\n    return dataResults;\n  }\n  async function callLoadersAndMaybeResolveData(matches, fetchersToLoad, request, scopedContext) {\n    let loaderResultsPromise = callDataStrategy(\n      request,\n      matches,\n      scopedContext,\n      null\n    );\n    let fetcherResultsPromise = Promise.all(\n      fetchersToLoad.map(async (f) => {\n        if (f.matches && f.match && f.request && f.controller) {\n          let results = await callDataStrategy(\n            f.request,\n            f.matches,\n            scopedContext,\n            f.key\n          );\n          let result = results[f.match.route.id];\n          return { [f.key]: result };\n        } else {\n          return Promise.resolve({\n            [f.key]: {\n              type: \"error\" /* error */,\n              error: getInternalRouterError(404, {\n                pathname: f.path\n              })\n            }\n          });\n        }\n      })\n    );\n    let loaderResults = await loaderResultsPromise;\n    let fetcherResults = (await fetcherResultsPromise).reduce(\n      (acc, r) => Object.assign(acc, r),\n      {}\n    );\n    return {\n      loaderResults,\n      fetcherResults\n    };\n  }\n  function interruptActiveLoads() {\n    isRevalidationRequired = true;\n    fetchLoadMatches.forEach((_, key) => {\n      if (fetchControllers.has(key)) {\n        cancelledFetcherLoads.add(key);\n      }\n      abortFetcher(key);\n    });\n  }\n  function updateFetcherState(key, fetcher, opts = {}) {\n    state.fetchers.set(key, fetcher);\n    updateState(\n      { fetchers: new Map(state.fetchers) },\n      { flushSync: (opts && opts.flushSync) === true }\n    );\n  }\n  function setFetcherError(key, routeId, error, opts = {}) {\n    let boundaryMatch = findNearestBoundary(state.matches, routeId);\n    deleteFetcher(key);\n    updateState(\n      {\n        errors: {\n          [boundaryMatch.route.id]: error\n        },\n        fetchers: new Map(state.fetchers)\n      },\n      { flushSync: (opts && opts.flushSync) === true }\n    );\n  }\n  function getFetcher(key) {\n    activeFetchers.set(key, (activeFetchers.get(key) || 0) + 1);\n    if (fetchersQueuedForDeletion.has(key)) {\n      fetchersQueuedForDeletion.delete(key);\n    }\n    return state.fetchers.get(key) || IDLE_FETCHER;\n  }\n  function resetFetcher(key, opts) {\n    abortFetcher(key, opts?.reason);\n    updateFetcherState(key, getDoneFetcher(null));\n  }\n  function deleteFetcher(key) {\n    let fetcher = state.fetchers.get(key);\n    if (fetchControllers.has(key) && !(fetcher && fetcher.state === \"loading\" && fetchReloadIds.has(key))) {\n      abortFetcher(key);\n    }\n    fetchLoadMatches.delete(key);\n    fetchReloadIds.delete(key);\n    fetchRedirectIds.delete(key);\n    fetchersQueuedForDeletion.delete(key);\n    cancelledFetcherLoads.delete(key);\n    state.fetchers.delete(key);\n  }\n  function queueFetcherForDeletion(key) {\n    let count = (activeFetchers.get(key) || 0) - 1;\n    if (count <= 0) {\n      activeFetchers.delete(key);\n      fetchersQueuedForDeletion.add(key);\n    } else {\n      activeFetchers.set(key, count);\n    }\n    updateState({ fetchers: new Map(state.fetchers) });\n  }\n  function abortFetcher(key, reason) {\n    let controller = fetchControllers.get(key);\n    if (controller) {\n      controller.abort(reason);\n      fetchControllers.delete(key);\n    }\n  }\n  function markFetchersDone(keys) {\n    for (let key of keys) {\n      let fetcher = getFetcher(key);\n      let doneFetcher = getDoneFetcher(fetcher.data);\n      state.fetchers.set(key, doneFetcher);\n    }\n  }\n  function markFetchRedirectsDone() {\n    let doneKeys = [];\n    let updatedFetchers = false;\n    for (let key of fetchRedirectIds) {\n      let fetcher = state.fetchers.get(key);\n      invariant(fetcher, `Expected fetcher: ${key}`);\n      if (fetcher.state === \"loading\") {\n        fetchRedirectIds.delete(key);\n        doneKeys.push(key);\n        updatedFetchers = true;\n      }\n    }\n    markFetchersDone(doneKeys);\n    return updatedFetchers;\n  }\n  function abortStaleFetchLoads(landedId) {\n    let yeetedKeys = [];\n    for (let [key, id] of fetchReloadIds) {\n      if (id < landedId) {\n        let fetcher = state.fetchers.get(key);\n        invariant(fetcher, `Expected fetcher: ${key}`);\n        if (fetcher.state === \"loading\") {\n          abortFetcher(key);\n          fetchReloadIds.delete(key);\n          yeetedKeys.push(key);\n        }\n      }\n    }\n    markFetchersDone(yeetedKeys);\n    return yeetedKeys.length > 0;\n  }\n  function getBlocker(key, fn) {\n    let blocker = state.blockers.get(key) || IDLE_BLOCKER;\n    if (blockerFunctions.get(key) !== fn) {\n      blockerFunctions.set(key, fn);\n    }\n    return blocker;\n  }\n  function deleteBlocker(key) {\n    state.blockers.delete(key);\n    blockerFunctions.delete(key);\n  }\n  function updateBlocker(key, newBlocker) {\n    let blocker = state.blockers.get(key) || IDLE_BLOCKER;\n    invariant(\n      blocker.state === \"unblocked\" && newBlocker.state === \"blocked\" || blocker.state === \"blocked\" && newBlocker.state === \"blocked\" || blocker.state === \"blocked\" && newBlocker.state === \"proceeding\" || blocker.state === \"blocked\" && newBlocker.state === \"unblocked\" || blocker.state === \"proceeding\" && newBlocker.state === \"unblocked\",\n      `Invalid blocker state transition: ${blocker.state} -> ${newBlocker.state}`\n    );\n    let blockers = new Map(state.blockers);\n    blockers.set(key, newBlocker);\n    updateState({ blockers });\n  }\n  function shouldBlockNavigation({\n    currentLocation,\n    nextLocation,\n    historyAction\n  }) {\n    if (blockerFunctions.size === 0) {\n      return;\n    }\n    if (blockerFunctions.size > 1) {\n      warning(false, \"A router only supports one blocker at a time\");\n    }\n    let entries = Array.from(blockerFunctions.entries());\n    let [blockerKey, blockerFunction] = entries[entries.length - 1];\n    let blocker = state.blockers.get(blockerKey);\n    if (blocker && blocker.state === \"proceeding\") {\n      return;\n    }\n    if (blockerFunction({ currentLocation, nextLocation, historyAction })) {\n      return blockerKey;\n    }\n  }\n  function handleNavigational404(pathname) {\n    let error = getInternalRouterError(404, { pathname });\n    let routesToUse = inFlightDataRoutes || dataRoutes;\n    let { matches, route } = getShortCircuitMatches(routesToUse);\n    return { notFoundMatches: matches, route, error };\n  }\n  function enableScrollRestoration(positions, getPosition, getKey) {\n    savedScrollPositions2 = positions;\n    getScrollPosition = getPosition;\n    getScrollRestorationKey2 = getKey || null;\n    if (!initialScrollRestored && state.navigation === IDLE_NAVIGATION) {\n      initialScrollRestored = true;\n      let y = getSavedScrollPosition(state.location, state.matches);\n      if (y != null) {\n        updateState({ restoreScrollPosition: y });\n      }\n    }\n    return () => {\n      savedScrollPositions2 = null;\n      getScrollPosition = null;\n      getScrollRestorationKey2 = null;\n    };\n  }\n  function getScrollKey(location, matches) {\n    if (getScrollRestorationKey2) {\n      let key = getScrollRestorationKey2(\n        location,\n        matches.map((m) => convertRouteMatchToUiMatch(m, state.loaderData))\n      );\n      return key || location.key;\n    }\n    return location.key;\n  }\n  function saveScrollPosition(location, matches) {\n    if (savedScrollPositions2 && getScrollPosition) {\n      let key = getScrollKey(location, matches);\n      savedScrollPositions2[key] = getScrollPosition();\n    }\n  }\n  function getSavedScrollPosition(location, matches) {\n    if (savedScrollPositions2) {\n      let key = getScrollKey(location, matches);\n      let y = savedScrollPositions2[key];\n      if (typeof y === \"number\") {\n        return y;\n      }\n    }\n    return null;\n  }\n  function checkFogOfWar(matches, routesToUse, pathname) {\n    if (init.patchRoutesOnNavigation) {\n      if (!matches) {\n        let fogMatches = matchRoutesImpl(\n          routesToUse,\n          pathname,\n          basename,\n          true\n        );\n        return { active: true, matches: fogMatches || [] };\n      } else {\n        if (Object.keys(matches[0].params).length > 0) {\n          let partialMatches = matchRoutesImpl(\n            routesToUse,\n            pathname,\n            basename,\n            true\n          );\n          return { active: true, matches: partialMatches };\n        }\n      }\n    }\n    return { active: false, matches: null };\n  }\n  async function discoverRoutes(matches, pathname, signal, fetcherKey) {\n    if (!init.patchRoutesOnNavigation) {\n      return { type: \"success\", matches };\n    }\n    let partialMatches = matches;\n    while (true) {\n      let isNonHMR = inFlightDataRoutes == null;\n      let routesToUse = inFlightDataRoutes || dataRoutes;\n      let localManifest = manifest;\n      try {\n        await init.patchRoutesOnNavigation({\n          signal,\n          path: pathname,\n          matches: partialMatches,\n          fetcherKey,\n          patch: (routeId, children) => {\n            if (signal.aborted) return;\n            patchRoutesImpl(\n              routeId,\n              children,\n              routesToUse,\n              localManifest,\n              mapRouteProperties2,\n              false\n            );\n          }\n        });\n      } catch (e) {\n        return { type: \"error\", error: e, partialMatches };\n      } finally {\n        if (isNonHMR && !signal.aborted) {\n          dataRoutes = [...dataRoutes];\n        }\n      }\n      if (signal.aborted) {\n        return { type: \"aborted\" };\n      }\n      let newMatches = matchRoutes(routesToUse, pathname, basename);\n      let newPartialMatches = null;\n      if (newMatches) {\n        if (Object.keys(newMatches[0].params).length === 0) {\n          return { type: \"success\", matches: newMatches };\n        } else {\n          newPartialMatches = matchRoutesImpl(\n            routesToUse,\n            pathname,\n            basename,\n            true\n          );\n          let matchedDeeper = newPartialMatches && partialMatches.length < newPartialMatches.length && compareMatches(\n            partialMatches,\n            newPartialMatches.slice(0, partialMatches.length)\n          );\n          if (!matchedDeeper) {\n            return { type: \"success\", matches: newMatches };\n          }\n        }\n      }\n      if (!newPartialMatches) {\n        newPartialMatches = matchRoutesImpl(\n          routesToUse,\n          pathname,\n          basename,\n          true\n        );\n      }\n      if (!newPartialMatches || compareMatches(partialMatches, newPartialMatches)) {\n        return { type: \"success\", matches: null };\n      }\n      partialMatches = newPartialMatches;\n    }\n  }\n  function compareMatches(a, b) {\n    return a.length === b.length && a.every((m, i) => m.route.id === b[i].route.id);\n  }\n  function _internalSetRoutes(newRoutes) {\n    manifest = {};\n    inFlightDataRoutes = convertRoutesToDataRoutes(\n      newRoutes,\n      mapRouteProperties2,\n      void 0,\n      manifest\n    );\n  }\n  function patchRoutes(routeId, children, unstable_allowElementMutations = false) {\n    let isNonHMR = inFlightDataRoutes == null;\n    let routesToUse = inFlightDataRoutes || dataRoutes;\n    patchRoutesImpl(\n      routeId,\n      children,\n      routesToUse,\n      manifest,\n      mapRouteProperties2,\n      unstable_allowElementMutations\n    );\n    if (isNonHMR) {\n      dataRoutes = [...dataRoutes];\n      updateState({});\n    }\n  }\n  router = {\n    get basename() {\n      return basename;\n    },\n    get future() {\n      return future;\n    },\n    get state() {\n      return state;\n    },\n    get routes() {\n      return dataRoutes;\n    },\n    get window() {\n      return routerWindow;\n    },\n    initialize,\n    subscribe,\n    enableScrollRestoration,\n    navigate,\n    fetch: fetch2,\n    revalidate,\n    // Passthrough to history-aware createHref used by useHref so we get proper\n    // hash-aware URLs in DOM paths\n    createHref: (to) => init.history.createHref(to),\n    encodeLocation: (to) => init.history.encodeLocation(to),\n    getFetcher,\n    resetFetcher,\n    deleteFetcher: queueFetcherForDeletion,\n    dispose,\n    getBlocker,\n    deleteBlocker,\n    patchRoutes,\n    _internalFetchControllers: fetchControllers,\n    // TODO: Remove setRoutes, it's temporary to avoid dealing with\n    // updating the tree while validating the update algorithm.\n    _internalSetRoutes,\n    _internalSetStateDoNotUseOrYouWillBreakYourApp(newState) {\n      updateState(newState);\n    }\n  };\n  if (init.unstable_instrumentations) {\n    router = instrumentClientSideRouter(\n      router,\n      init.unstable_instrumentations.map((i) => i.router).filter(Boolean)\n    );\n  }\n  return router;\n}\nfunction createStaticHandler(routes, opts) {\n  invariant(\n    routes.length > 0,\n    \"You must provide a non-empty routes array to createStaticHandler\"\n  );\n  let manifest = {};\n  let basename = (opts ? opts.basename : null) || \"/\";\n  let _mapRouteProperties = opts?.mapRouteProperties || defaultMapRouteProperties;\n  let mapRouteProperties2 = _mapRouteProperties;\n  if (opts?.unstable_instrumentations) {\n    let instrumentations = opts.unstable_instrumentations;\n    mapRouteProperties2 = (route) => {\n      return {\n        ..._mapRouteProperties(route),\n        ...getRouteInstrumentationUpdates(\n          instrumentations.map((i) => i.route).filter(Boolean),\n          route\n        )\n      };\n    };\n  }\n  let dataRoutes = convertRoutesToDataRoutes(\n    routes,\n    mapRouteProperties2,\n    void 0,\n    manifest\n  );\n  async function query(request, {\n    requestContext,\n    filterMatchesToLoad,\n    skipLoaderErrorBubbling,\n    skipRevalidation,\n    dataStrategy,\n    generateMiddlewareResponse\n  } = {}) {\n    let url = new URL(request.url);\n    let method = request.method;\n    let location = createLocation(\"\", createPath(url), null, \"default\");\n    let matches = matchRoutes(dataRoutes, location, basename);\n    requestContext = requestContext != null ? requestContext : new RouterContextProvider();\n    if (!isValidMethod(method) && method !== \"HEAD\") {\n      let error = getInternalRouterError(405, { method });\n      let { matches: methodNotAllowedMatches, route } = getShortCircuitMatches(dataRoutes);\n      let staticContext = {\n        basename,\n        location,\n        matches: methodNotAllowedMatches,\n        loaderData: {},\n        actionData: null,\n        errors: {\n          [route.id]: error\n        },\n        statusCode: error.status,\n        loaderHeaders: {},\n        actionHeaders: {}\n      };\n      return generateMiddlewareResponse ? generateMiddlewareResponse(() => Promise.resolve(staticContext)) : staticContext;\n    } else if (!matches) {\n      let error = getInternalRouterError(404, { pathname: location.pathname });\n      let { matches: notFoundMatches, route } = getShortCircuitMatches(dataRoutes);\n      let staticContext = {\n        basename,\n        location,\n        matches: notFoundMatches,\n        loaderData: {},\n        actionData: null,\n        errors: {\n          [route.id]: error\n        },\n        statusCode: error.status,\n        loaderHeaders: {},\n        actionHeaders: {}\n      };\n      return generateMiddlewareResponse ? generateMiddlewareResponse(() => Promise.resolve(staticContext)) : staticContext;\n    }\n    if (generateMiddlewareResponse) {\n      invariant(\n        requestContext instanceof RouterContextProvider,\n        \"When using middleware in `staticHandler.query()`, any provided `requestContext` must be an instance of `RouterContextProvider`\"\n      );\n      try {\n        await loadLazyMiddlewareForMatches(\n          matches,\n          manifest,\n          mapRouteProperties2\n        );\n        let renderedStaticContext;\n        let response = await runServerMiddlewarePipeline(\n          {\n            request,\n            unstable_pattern: getRoutePattern(matches.map((m) => m.route.path)),\n            matches,\n            params: matches[0].params,\n            // If we're calling middleware then it must be enabled so we can cast\n            // this to the proper type knowing it's not an `AppLoadContext`\n            context: requestContext\n          },\n          async () => {\n            let res = await generateMiddlewareResponse(\n              async (revalidationRequest, opts2 = {}) => {\n                let result2 = await queryImpl(\n                  revalidationRequest,\n                  location,\n                  matches,\n                  requestContext,\n                  dataStrategy || null,\n                  skipLoaderErrorBubbling === true,\n                  null,\n                  \"filterMatchesToLoad\" in opts2 ? opts2.filterMatchesToLoad ?? null : filterMatchesToLoad ?? null,\n                  skipRevalidation === true\n                );\n                if (isResponse(result2)) {\n                  return result2;\n                }\n                renderedStaticContext = { location, basename, ...result2 };\n                return renderedStaticContext;\n              }\n            );\n            return res;\n          },\n          async (error, routeId) => {\n            if (isRedirectResponse(error)) {\n              return error;\n            }\n            if (isResponse(error)) {\n              try {\n                error = new ErrorResponseImpl(\n                  error.status,\n                  error.statusText,\n                  await parseResponseBody(error)\n                );\n              } catch (e) {\n                error = e;\n              }\n            }\n            if (isDataWithResponseInit(error)) {\n              error = dataWithResponseInitToErrorResponse(error);\n            }\n            if (renderedStaticContext) {\n              if (routeId in renderedStaticContext.loaderData) {\n                renderedStaticContext.loaderData[routeId] = void 0;\n              }\n              let staticContext = getStaticContextFromError(\n                dataRoutes,\n                renderedStaticContext,\n                error,\n                skipLoaderErrorBubbling ? routeId : findNearestBoundary(matches, routeId).route.id\n              );\n              return generateMiddlewareResponse(\n                () => Promise.resolve(staticContext)\n              );\n            } else {\n              let boundaryRouteId = skipLoaderErrorBubbling ? routeId : findNearestBoundary(\n                matches,\n                matches.find(\n                  (m) => m.route.id === routeId || m.route.loader\n                )?.route.id || routeId\n              ).route.id;\n              let staticContext = {\n                matches,\n                location,\n                basename,\n                loaderData: {},\n                actionData: null,\n                errors: {\n                  [boundaryRouteId]: error\n                },\n                statusCode: isRouteErrorResponse(error) ? error.status : 500,\n                actionHeaders: {},\n                loaderHeaders: {}\n              };\n              return generateMiddlewareResponse(\n                () => Promise.resolve(staticContext)\n              );\n            }\n          }\n        );\n        invariant(isResponse(response), \"Expected a response in query()\");\n        return response;\n      } catch (e) {\n        if (isResponse(e)) {\n          return e;\n        }\n        throw e;\n      }\n    }\n    let result = await queryImpl(\n      request,\n      location,\n      matches,\n      requestContext,\n      dataStrategy || null,\n      skipLoaderErrorBubbling === true,\n      null,\n      filterMatchesToLoad || null,\n      skipRevalidation === true\n    );\n    if (isResponse(result)) {\n      return result;\n    }\n    return { location, basename, ...result };\n  }\n  async function queryRoute(request, {\n    routeId,\n    requestContext,\n    dataStrategy,\n    generateMiddlewareResponse\n  } = {}) {\n    let url = new URL(request.url);\n    let method = request.method;\n    let location = createLocation(\"\", createPath(url), null, \"default\");\n    let matches = matchRoutes(dataRoutes, location, basename);\n    requestContext = requestContext != null ? requestContext : new RouterContextProvider();\n    if (!isValidMethod(method) && method !== \"HEAD\" && method !== \"OPTIONS\") {\n      throw getInternalRouterError(405, { method });\n    } else if (!matches) {\n      throw getInternalRouterError(404, { pathname: location.pathname });\n    }\n    let match = routeId ? matches.find((m) => m.route.id === routeId) : getTargetMatch(matches, location);\n    if (routeId && !match) {\n      throw getInternalRouterError(403, {\n        pathname: location.pathname,\n        routeId\n      });\n    } else if (!match) {\n      throw getInternalRouterError(404, { pathname: location.pathname });\n    }\n    if (generateMiddlewareResponse) {\n      invariant(\n        requestContext instanceof RouterContextProvider,\n        \"When using middleware in `staticHandler.queryRoute()`, any provided `requestContext` must be an instance of `RouterContextProvider`\"\n      );\n      await loadLazyMiddlewareForMatches(matches, manifest, mapRouteProperties2);\n      let response = await runServerMiddlewarePipeline(\n        {\n          request,\n          unstable_pattern: getRoutePattern(matches.map((m) => m.route.path)),\n          matches,\n          params: matches[0].params,\n          // If we're calling middleware then it must be enabled so we can cast\n          // this to the proper type knowing it's not an `AppLoadContext`\n          context: requestContext\n        },\n        async () => {\n          let res = await generateMiddlewareResponse(\n            async (innerRequest) => {\n              let result2 = await queryImpl(\n                innerRequest,\n                location,\n                matches,\n                requestContext,\n                dataStrategy || null,\n                false,\n                match,\n                null,\n                false\n              );\n              let processed = handleQueryResult(result2);\n              return isResponse(processed) ? processed : typeof processed === \"string\" ? new Response(processed) : Response.json(processed);\n            }\n          );\n          return res;\n        },\n        (error) => {\n          if (isDataWithResponseInit(error)) {\n            return Promise.resolve(dataWithResponseInitToResponse(error));\n          }\n          if (isResponse(error)) {\n            return Promise.resolve(error);\n          }\n          throw error;\n        }\n      );\n      return response;\n    }\n    let result = await queryImpl(\n      request,\n      location,\n      matches,\n      requestContext,\n      dataStrategy || null,\n      false,\n      match,\n      null,\n      false\n    );\n    return handleQueryResult(result);\n    function handleQueryResult(result2) {\n      if (isResponse(result2)) {\n        return result2;\n      }\n      let error = result2.errors ? Object.values(result2.errors)[0] : void 0;\n      if (error !== void 0) {\n        throw error;\n      }\n      if (result2.actionData) {\n        return Object.values(result2.actionData)[0];\n      }\n      if (result2.loaderData) {\n        return Object.values(result2.loaderData)[0];\n      }\n      return void 0;\n    }\n  }\n  async function queryImpl(request, location, matches, requestContext, dataStrategy, skipLoaderErrorBubbling, routeMatch, filterMatchesToLoad, skipRevalidation) {\n    invariant(\n      request.signal,\n      \"query()/queryRoute() requests must contain an AbortController signal\"\n    );\n    try {\n      if (isMutationMethod(request.method)) {\n        let result2 = await submit(\n          request,\n          matches,\n          routeMatch || getTargetMatch(matches, location),\n          requestContext,\n          dataStrategy,\n          skipLoaderErrorBubbling,\n          routeMatch != null,\n          filterMatchesToLoad,\n          skipRevalidation\n        );\n        return result2;\n      }\n      let result = await loadRouteData(\n        request,\n        matches,\n        requestContext,\n        dataStrategy,\n        skipLoaderErrorBubbling,\n        routeMatch,\n        filterMatchesToLoad\n      );\n      return isResponse(result) ? result : {\n        ...result,\n        actionData: null,\n        actionHeaders: {}\n      };\n    } catch (e) {\n      if (isDataStrategyResult(e) && isResponse(e.result)) {\n        if (e.type === \"error\" /* error */) {\n          throw e.result;\n        }\n        return e.result;\n      }\n      if (isRedirectResponse(e)) {\n        return e;\n      }\n      throw e;\n    }\n  }\n  async function submit(request, matches, actionMatch, requestContext, dataStrategy, skipLoaderErrorBubbling, isRouteRequest, filterMatchesToLoad, skipRevalidation) {\n    let result;\n    if (!actionMatch.route.action && !actionMatch.route.lazy) {\n      let error = getInternalRouterError(405, {\n        method: request.method,\n        pathname: new URL(request.url).pathname,\n        routeId: actionMatch.route.id\n      });\n      if (isRouteRequest) {\n        throw error;\n      }\n      result = {\n        type: \"error\" /* error */,\n        error\n      };\n    } else {\n      let dsMatches = getTargetedDataStrategyMatches(\n        mapRouteProperties2,\n        manifest,\n        request,\n        matches,\n        actionMatch,\n        [],\n        requestContext\n      );\n      let results = await callDataStrategy(\n        request,\n        dsMatches,\n        isRouteRequest,\n        requestContext,\n        dataStrategy\n      );\n      result = results[actionMatch.route.id];\n      if (request.signal.aborted) {\n        throwStaticHandlerAbortedError(request, isRouteRequest);\n      }\n    }\n    if (isRedirectResult(result)) {\n      throw new Response(null, {\n        status: result.response.status,\n        headers: {\n          Location: result.response.headers.get(\"Location\")\n        }\n      });\n    }\n    if (isRouteRequest) {\n      if (isErrorResult(result)) {\n        throw result.error;\n      }\n      return {\n        matches: [actionMatch],\n        loaderData: {},\n        actionData: { [actionMatch.route.id]: result.data },\n        errors: null,\n        // Note: statusCode + headers are unused here since queryRoute will\n        // return the raw Response or value\n        statusCode: 200,\n        loaderHeaders: {},\n        actionHeaders: {}\n      };\n    }\n    if (skipRevalidation) {\n      if (isErrorResult(result)) {\n        let boundaryMatch = skipLoaderErrorBubbling ? actionMatch : findNearestBoundary(matches, actionMatch.route.id);\n        return {\n          statusCode: isRouteErrorResponse(result.error) ? result.error.status : result.statusCode != null ? result.statusCode : 500,\n          actionData: null,\n          actionHeaders: {\n            ...result.headers ? { [actionMatch.route.id]: result.headers } : {}\n          },\n          matches,\n          loaderData: {},\n          errors: {\n            [boundaryMatch.route.id]: result.error\n          },\n          loaderHeaders: {}\n        };\n      } else {\n        return {\n          actionData: {\n            [actionMatch.route.id]: result.data\n          },\n          actionHeaders: result.headers ? { [actionMatch.route.id]: result.headers } : {},\n          matches,\n          loaderData: {},\n          errors: null,\n          statusCode: result.statusCode || 200,\n          loaderHeaders: {}\n        };\n      }\n    }\n    let loaderRequest = new Request(request.url, {\n      headers: request.headers,\n      redirect: request.redirect,\n      signal: request.signal\n    });\n    if (isErrorResult(result)) {\n      let boundaryMatch = skipLoaderErrorBubbling ? actionMatch : findNearestBoundary(matches, actionMatch.route.id);\n      let handlerContext2 = await loadRouteData(\n        loaderRequest,\n        matches,\n        requestContext,\n        dataStrategy,\n        skipLoaderErrorBubbling,\n        null,\n        filterMatchesToLoad,\n        [boundaryMatch.route.id, result]\n      );\n      return {\n        ...handlerContext2,\n        statusCode: isRouteErrorResponse(result.error) ? result.error.status : result.statusCode != null ? result.statusCode : 500,\n        actionData: null,\n        actionHeaders: {\n          ...result.headers ? { [actionMatch.route.id]: result.headers } : {}\n        }\n      };\n    }\n    let handlerContext = await loadRouteData(\n      loaderRequest,\n      matches,\n      requestContext,\n      dataStrategy,\n      skipLoaderErrorBubbling,\n      null,\n      filterMatchesToLoad\n    );\n    return {\n      ...handlerContext,\n      actionData: {\n        [actionMatch.route.id]: result.data\n      },\n      // action status codes take precedence over loader status codes\n      ...result.statusCode ? { statusCode: result.statusCode } : {},\n      actionHeaders: result.headers ? { [actionMatch.route.id]: result.headers } : {}\n    };\n  }\n  async function loadRouteData(request, matches, requestContext, dataStrategy, skipLoaderErrorBubbling, routeMatch, filterMatchesToLoad, pendingActionResult) {\n    let isRouteRequest = routeMatch != null;\n    if (isRouteRequest && !routeMatch?.route.loader && !routeMatch?.route.lazy) {\n      throw getInternalRouterError(400, {\n        method: request.method,\n        pathname: new URL(request.url).pathname,\n        routeId: routeMatch?.route.id\n      });\n    }\n    let dsMatches;\n    if (routeMatch) {\n      dsMatches = getTargetedDataStrategyMatches(\n        mapRouteProperties2,\n        manifest,\n        request,\n        matches,\n        routeMatch,\n        [],\n        requestContext\n      );\n    } else {\n      let maxIdx = pendingActionResult && isErrorResult(pendingActionResult[1]) ? (\n        // Up to but not including the boundary\n        matches.findIndex((m) => m.route.id === pendingActionResult[0]) - 1\n      ) : void 0;\n      let pattern = getRoutePattern(matches.map((m) => m.route.path));\n      dsMatches = matches.map((match, index) => {\n        if (maxIdx != null && index > maxIdx) {\n          return getDataStrategyMatch(\n            mapRouteProperties2,\n            manifest,\n            request,\n            pattern,\n            match,\n            [],\n            requestContext,\n            false\n          );\n        }\n        return getDataStrategyMatch(\n          mapRouteProperties2,\n          manifest,\n          request,\n          pattern,\n          match,\n          [],\n          requestContext,\n          (match.route.loader || match.route.lazy) != null && (!filterMatchesToLoad || filterMatchesToLoad(match))\n        );\n      });\n    }\n    if (!dataStrategy && !dsMatches.some((m) => m.shouldLoad)) {\n      return {\n        matches,\n        loaderData: {},\n        errors: pendingActionResult && isErrorResult(pendingActionResult[1]) ? {\n          [pendingActionResult[0]]: pendingActionResult[1].error\n        } : null,\n        statusCode: 200,\n        loaderHeaders: {}\n      };\n    }\n    let results = await callDataStrategy(\n      request,\n      dsMatches,\n      isRouteRequest,\n      requestContext,\n      dataStrategy\n    );\n    if (request.signal.aborted) {\n      throwStaticHandlerAbortedError(request, isRouteRequest);\n    }\n    let handlerContext = processRouteLoaderData(\n      matches,\n      results,\n      pendingActionResult,\n      true,\n      skipLoaderErrorBubbling\n    );\n    return {\n      ...handlerContext,\n      matches\n    };\n  }\n  async function callDataStrategy(request, matches, isRouteRequest, requestContext, dataStrategy) {\n    let results = await callDataStrategyImpl(\n      dataStrategy || defaultDataStrategy,\n      request,\n      matches,\n      null,\n      requestContext,\n      true\n    );\n    let dataResults = {};\n    await Promise.all(\n      matches.map(async (match) => {\n        if (!(match.route.id in results)) {\n          return;\n        }\n        let result = results[match.route.id];\n        if (isRedirectDataStrategyResult(result)) {\n          let response = result.result;\n          throw normalizeRelativeRoutingRedirectResponse(\n            response,\n            request,\n            match.route.id,\n            matches,\n            basename\n          );\n        }\n        if (isRouteRequest) {\n          if (isResponse(result.result)) {\n            throw result;\n          } else if (isDataWithResponseInit(result.result)) {\n            throw dataWithResponseInitToResponse(result.result);\n          }\n        }\n        dataResults[match.route.id] = await convertDataStrategyResultToDataResult(result);\n      })\n    );\n    return dataResults;\n  }\n  return {\n    dataRoutes,\n    query,\n    queryRoute\n  };\n}\nfunction getStaticContextFromError(routes, handlerContext, error, boundaryId) {\n  let errorBoundaryId = boundaryId || handlerContext._deepestRenderedBoundaryId || routes[0].id;\n  return {\n    ...handlerContext,\n    statusCode: isRouteErrorResponse(error) ? error.status : 500,\n    errors: {\n      [errorBoundaryId]: error\n    }\n  };\n}\nfunction throwStaticHandlerAbortedError(request, isRouteRequest) {\n  if (request.signal.reason !== void 0) {\n    throw request.signal.reason;\n  }\n  let method = isRouteRequest ? \"queryRoute\" : \"query\";\n  throw new Error(\n    `${method}() call aborted without an \\`AbortSignal.reason\\`: ${request.method} ${request.url}`\n  );\n}\nfunction isSubmissionNavigation(opts) {\n  return opts != null && (\"formData\" in opts && opts.formData != null || \"body\" in opts && opts.body !== void 0);\n}\nfunction normalizeTo(location, matches, basename, to, fromRouteId, relative) {\n  let contextualMatches;\n  let activeRouteMatch;\n  if (fromRouteId) {\n    contextualMatches = [];\n    for (let match of matches) {\n      contextualMatches.push(match);\n      if (match.route.id === fromRouteId) {\n        activeRouteMatch = match;\n        break;\n      }\n    }\n  } else {\n    contextualMatches = matches;\n    activeRouteMatch = matches[matches.length - 1];\n  }\n  let path = resolveTo(\n    to ? to : \".\",\n    getResolveToMatches(contextualMatches),\n    stripBasename(location.pathname, basename) || location.pathname,\n    relative === \"path\"\n  );\n  if (to == null) {\n    path.search = location.search;\n    path.hash = location.hash;\n  }\n  if ((to == null || to === \"\" || to === \".\") && activeRouteMatch) {\n    let nakedIndex = hasNakedIndexQuery(path.search);\n    if (activeRouteMatch.route.index && !nakedIndex) {\n      path.search = path.search ? path.search.replace(/^\\?/, \"?index&\") : \"?index\";\n    } else if (!activeRouteMatch.route.index && nakedIndex) {\n      let params = new URLSearchParams(path.search);\n      let indexValues = params.getAll(\"index\");\n      params.delete(\"index\");\n      indexValues.filter((v) => v).forEach((v) => params.append(\"index\", v));\n      let qs = params.toString();\n      path.search = qs ? `?${qs}` : \"\";\n    }\n  }\n  if (basename !== \"/\") {\n    path.pathname = prependBasename({ basename, pathname: path.pathname });\n  }\n  return createPath(path);\n}\nfunction normalizeNavigateOptions(isFetcher, path, opts) {\n  if (!opts || !isSubmissionNavigation(opts)) {\n    return { path };\n  }\n  if (opts.formMethod && !isValidMethod(opts.formMethod)) {\n    return {\n      path,\n      error: getInternalRouterError(405, { method: opts.formMethod })\n    };\n  }\n  let getInvalidBodyError = () => ({\n    path,\n    error: getInternalRouterError(400, { type: \"invalid-body\" })\n  });\n  let rawFormMethod = opts.formMethod || \"get\";\n  let formMethod = rawFormMethod.toUpperCase();\n  let formAction = stripHashFromPath(path);\n  if (opts.body !== void 0) {\n    if (opts.formEncType === \"text/plain\") {\n      if (!isMutationMethod(formMethod)) {\n        return getInvalidBodyError();\n      }\n      let text = typeof opts.body === \"string\" ? opts.body : opts.body instanceof FormData || opts.body instanceof URLSearchParams ? (\n        // https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#plain-text-form-data\n        Array.from(opts.body.entries()).reduce(\n          (acc, [name, value]) => `${acc}${name}=${value}\n`,\n          \"\"\n        )\n      ) : String(opts.body);\n      return {\n        path,\n        submission: {\n          formMethod,\n          formAction,\n          formEncType: opts.formEncType,\n          formData: void 0,\n          json: void 0,\n          text\n        }\n      };\n    } else if (opts.formEncType === \"application/json\") {\n      if (!isMutationMethod(formMethod)) {\n        return getInvalidBodyError();\n      }\n      try {\n        let json = typeof opts.body === \"string\" ? JSON.parse(opts.body) : opts.body;\n        return {\n          path,\n          submission: {\n            formMethod,\n            formAction,\n            formEncType: opts.formEncType,\n            formData: void 0,\n            json,\n            text: void 0\n          }\n        };\n      } catch (e) {\n        return getInvalidBodyError();\n      }\n    }\n  }\n  invariant(\n    typeof FormData === \"function\",\n    \"FormData is not available in this environment\"\n  );\n  let searchParams;\n  let formData;\n  if (opts.formData) {\n    searchParams = convertFormDataToSearchParams(opts.formData);\n    formData = opts.formData;\n  } else if (opts.body instanceof FormData) {\n    searchParams = convertFormDataToSearchParams(opts.body);\n    formData = opts.body;\n  } else if (opts.body instanceof URLSearchParams) {\n    searchParams = opts.body;\n    formData = convertSearchParamsToFormData(searchParams);\n  } else if (opts.body == null) {\n    searchParams = new URLSearchParams();\n    formData = new FormData();\n  } else {\n    try {\n      searchParams = new URLSearchParams(opts.body);\n      formData = convertSearchParamsToFormData(searchParams);\n    } catch (e) {\n      return getInvalidBodyError();\n    }\n  }\n  let submission = {\n    formMethod,\n    formAction,\n    formEncType: opts && opts.formEncType || \"application/x-www-form-urlencoded\",\n    formData,\n    json: void 0,\n    text: void 0\n  };\n  if (isMutationMethod(submission.formMethod)) {\n    return { path, submission };\n  }\n  let parsedPath = parsePath(path);\n  if (isFetcher && parsedPath.search && hasNakedIndexQuery(parsedPath.search)) {\n    searchParams.append(\"index\", \"\");\n  }\n  parsedPath.search = `?${searchParams}`;\n  return { path: createPath(parsedPath), submission };\n}\nfunction getMatchesToLoad(request, scopedContext, mapRouteProperties2, manifest, history, state, matches, submission, location, lazyRoutePropertiesToSkip, initialHydration, isRevalidationRequired, cancelledFetcherLoads, fetchersQueuedForDeletion, fetchLoadMatches, fetchRedirectIds, routesToUse, basename, hasPatchRoutesOnNavigation, pendingActionResult) {\n  let actionResult = pendingActionResult ? isErrorResult(pendingActionResult[1]) ? pendingActionResult[1].error : pendingActionResult[1].data : void 0;\n  let currentUrl = history.createURL(state.location);\n  let nextUrl = history.createURL(location);\n  let maxIdx;\n  if (initialHydration && state.errors) {\n    let boundaryId = Object.keys(state.errors)[0];\n    maxIdx = matches.findIndex((m) => m.route.id === boundaryId);\n  } else if (pendingActionResult && isErrorResult(pendingActionResult[1])) {\n    let boundaryId = pendingActionResult[0];\n    maxIdx = matches.findIndex((m) => m.route.id === boundaryId) - 1;\n  }\n  let actionStatus = pendingActionResult ? pendingActionResult[1].statusCode : void 0;\n  let shouldSkipRevalidation = actionStatus && actionStatus >= 400;\n  let baseShouldRevalidateArgs = {\n    currentUrl,\n    currentParams: state.matches[0]?.params || {},\n    nextUrl,\n    nextParams: matches[0].params,\n    ...submission,\n    actionResult,\n    actionStatus\n  };\n  let pattern = getRoutePattern(matches.map((m) => m.route.path));\n  let dsMatches = matches.map((match, index) => {\n    let { route } = match;\n    let forceShouldLoad = null;\n    if (maxIdx != null && index > maxIdx) {\n      forceShouldLoad = false;\n    } else if (route.lazy) {\n      forceShouldLoad = true;\n    } else if (!routeHasLoaderOrMiddleware(route)) {\n      forceShouldLoad = false;\n    } else if (initialHydration) {\n      forceShouldLoad = shouldLoadRouteOnHydration(\n        route,\n        state.loaderData,\n        state.errors\n      );\n    } else if (isNewLoader(state.loaderData, state.matches[index], match)) {\n      forceShouldLoad = true;\n    }\n    if (forceShouldLoad !== null) {\n      return getDataStrategyMatch(\n        mapRouteProperties2,\n        manifest,\n        request,\n        pattern,\n        match,\n        lazyRoutePropertiesToSkip,\n        scopedContext,\n        forceShouldLoad\n      );\n    }\n    let defaultShouldRevalidate = shouldSkipRevalidation ? false : (\n      // Forced revalidation due to submission, useRevalidator, or X-Remix-Revalidate\n      isRevalidationRequired || currentUrl.pathname + currentUrl.search === nextUrl.pathname + nextUrl.search || // Search params affect all loaders\n      currentUrl.search !== nextUrl.search || isNewRouteInstance(state.matches[index], match)\n    );\n    let shouldRevalidateArgs = {\n      ...baseShouldRevalidateArgs,\n      defaultShouldRevalidate\n    };\n    let shouldLoad = shouldRevalidateLoader(match, shouldRevalidateArgs);\n    return getDataStrategyMatch(\n      mapRouteProperties2,\n      manifest,\n      request,\n      pattern,\n      match,\n      lazyRoutePropertiesToSkip,\n      scopedContext,\n      shouldLoad,\n      shouldRevalidateArgs\n    );\n  });\n  let revalidatingFetchers = [];\n  fetchLoadMatches.forEach((f, key) => {\n    if (initialHydration || !matches.some((m) => m.route.id === f.routeId) || fetchersQueuedForDeletion.has(key)) {\n      return;\n    }\n    let fetcher = state.fetchers.get(key);\n    let isMidInitialLoad = fetcher && fetcher.state !== \"idle\" && fetcher.data === void 0;\n    let fetcherMatches = matchRoutes(routesToUse, f.path, basename);\n    if (!fetcherMatches) {\n      if (hasPatchRoutesOnNavigation && isMidInitialLoad) {\n        return;\n      }\n      revalidatingFetchers.push({\n        key,\n        routeId: f.routeId,\n        path: f.path,\n        matches: null,\n        match: null,\n        request: null,\n        controller: null\n      });\n      return;\n    }\n    if (fetchRedirectIds.has(key)) {\n      return;\n    }\n    let fetcherMatch = getTargetMatch(fetcherMatches, f.path);\n    let fetchController = new AbortController();\n    let fetchRequest = createClientSideRequest(\n      history,\n      f.path,\n      fetchController.signal\n    );\n    let fetcherDsMatches = null;\n    if (cancelledFetcherLoads.has(key)) {\n      cancelledFetcherLoads.delete(key);\n      fetcherDsMatches = getTargetedDataStrategyMatches(\n        mapRouteProperties2,\n        manifest,\n        fetchRequest,\n        fetcherMatches,\n        fetcherMatch,\n        lazyRoutePropertiesToSkip,\n        scopedContext\n      );\n    } else if (isMidInitialLoad) {\n      if (isRevalidationRequired) {\n        fetcherDsMatches = getTargetedDataStrategyMatches(\n          mapRouteProperties2,\n          manifest,\n          fetchRequest,\n          fetcherMatches,\n          fetcherMatch,\n          lazyRoutePropertiesToSkip,\n          scopedContext\n        );\n      }\n    } else {\n      let shouldRevalidateArgs = {\n        ...baseShouldRevalidateArgs,\n        defaultShouldRevalidate: shouldSkipRevalidation ? false : isRevalidationRequired\n      };\n      if (shouldRevalidateLoader(fetcherMatch, shouldRevalidateArgs)) {\n        fetcherDsMatches = getTargetedDataStrategyMatches(\n          mapRouteProperties2,\n          manifest,\n          fetchRequest,\n          fetcherMatches,\n          fetcherMatch,\n          lazyRoutePropertiesToSkip,\n          scopedContext,\n          shouldRevalidateArgs\n        );\n      }\n    }\n    if (fetcherDsMatches) {\n      revalidatingFetchers.push({\n        key,\n        routeId: f.routeId,\n        path: f.path,\n        matches: fetcherDsMatches,\n        match: fetcherMatch,\n        request: fetchRequest,\n        controller: fetchController\n      });\n    }\n  });\n  return { dsMatches, revalidatingFetchers };\n}\nfunction routeHasLoaderOrMiddleware(route) {\n  return route.loader != null || route.middleware != null && route.middleware.length > 0;\n}\nfunction shouldLoadRouteOnHydration(route, loaderData, errors) {\n  if (route.lazy) {\n    return true;\n  }\n  if (!routeHasLoaderOrMiddleware(route)) {\n    return false;\n  }\n  let hasData = loaderData != null && route.id in loaderData;\n  let hasError = errors != null && errors[route.id] !== void 0;\n  if (!hasData && hasError) {\n    return false;\n  }\n  if (typeof route.loader === \"function\" && route.loader.hydrate === true) {\n    return true;\n  }\n  return !hasData && !hasError;\n}\nfunction isNewLoader(currentLoaderData, currentMatch, match) {\n  let isNew = (\n    // [a] -> [a, b]\n    !currentMatch || // [a, b] -> [a, c]\n    match.route.id !== currentMatch.route.id\n  );\n  let isMissingData = !currentLoaderData.hasOwnProperty(match.route.id);\n  return isNew || isMissingData;\n}\nfunction isNewRouteInstance(currentMatch, match) {\n  let currentPath = currentMatch.route.path;\n  return (\n    // param change for this match, /users/123 -> /users/456\n    currentMatch.pathname !== match.pathname || // splat param changed, which is not present in match.path\n    // e.g. /files/images/avatar.jpg -> files/finances.xls\n    currentPath != null && currentPath.endsWith(\"*\") && currentMatch.params[\"*\"] !== match.params[\"*\"]\n  );\n}\nfunction shouldRevalidateLoader(loaderMatch, arg) {\n  if (loaderMatch.route.shouldRevalidate) {\n    let routeChoice = loaderMatch.route.shouldRevalidate(arg);\n    if (typeof routeChoice === \"boolean\") {\n      return routeChoice;\n    }\n  }\n  return arg.defaultShouldRevalidate;\n}\nfunction patchRoutesImpl(routeId, children, routesToUse, manifest, mapRouteProperties2, allowElementMutations) {\n  let childrenToPatch;\n  if (routeId) {\n    let route = manifest[routeId];\n    invariant(\n      route,\n      `No route found to patch children into: routeId = ${routeId}`\n    );\n    if (!route.children) {\n      route.children = [];\n    }\n    childrenToPatch = route.children;\n  } else {\n    childrenToPatch = routesToUse;\n  }\n  let uniqueChildren = [];\n  let existingChildren = [];\n  children.forEach((newRoute) => {\n    let existingRoute = childrenToPatch.find(\n      (existingRoute2) => isSameRoute(newRoute, existingRoute2)\n    );\n    if (existingRoute) {\n      existingChildren.push({ existingRoute, newRoute });\n    } else {\n      uniqueChildren.push(newRoute);\n    }\n  });\n  if (uniqueChildren.length > 0) {\n    let newRoutes = convertRoutesToDataRoutes(\n      uniqueChildren,\n      mapRouteProperties2,\n      [routeId || \"_\", \"patch\", String(childrenToPatch?.length || \"0\")],\n      manifest\n    );\n    childrenToPatch.push(...newRoutes);\n  }\n  if (allowElementMutations && existingChildren.length > 0) {\n    for (let i = 0; i < existingChildren.length; i++) {\n      let { existingRoute, newRoute } = existingChildren[i];\n      let existingRouteTyped = existingRoute;\n      let [newRouteTyped] = convertRoutesToDataRoutes(\n        [newRoute],\n        mapRouteProperties2,\n        [],\n        // Doesn't matter for mutated routes since they already have an id\n        {},\n        // Don't touch the manifest here since we're updating in place\n        true\n      );\n      Object.assign(existingRouteTyped, {\n        element: newRouteTyped.element ? newRouteTyped.element : existingRouteTyped.element,\n        errorElement: newRouteTyped.errorElement ? newRouteTyped.errorElement : existingRouteTyped.errorElement,\n        hydrateFallbackElement: newRouteTyped.hydrateFallbackElement ? newRouteTyped.hydrateFallbackElement : existingRouteTyped.hydrateFallbackElement\n      });\n    }\n  }\n}\nfunction isSameRoute(newRoute, existingRoute) {\n  if (\"id\" in newRoute && \"id\" in existingRoute && newRoute.id === existingRoute.id) {\n    return true;\n  }\n  if (!(newRoute.index === existingRoute.index && newRoute.path === existingRoute.path && newRoute.caseSensitive === existingRoute.caseSensitive)) {\n    return false;\n  }\n  if ((!newRoute.children || newRoute.children.length === 0) && (!existingRoute.children || existingRoute.children.length === 0)) {\n    return true;\n  }\n  return newRoute.children.every(\n    (aChild, i) => existingRoute.children?.some((bChild) => isSameRoute(aChild, bChild))\n  );\n}\nvar lazyRoutePropertyCache = /* @__PURE__ */ new WeakMap();\nvar loadLazyRouteProperty = ({\n  key,\n  route,\n  manifest,\n  mapRouteProperties: mapRouteProperties2\n}) => {\n  let routeToUpdate = manifest[route.id];\n  invariant(routeToUpdate, \"No route found in manifest\");\n  if (!routeToUpdate.lazy || typeof routeToUpdate.lazy !== \"object\") {\n    return;\n  }\n  let lazyFn = routeToUpdate.lazy[key];\n  if (!lazyFn) {\n    return;\n  }\n  let cache = lazyRoutePropertyCache.get(routeToUpdate);\n  if (!cache) {\n    cache = {};\n    lazyRoutePropertyCache.set(routeToUpdate, cache);\n  }\n  let cachedPromise = cache[key];\n  if (cachedPromise) {\n    return cachedPromise;\n  }\n  let propertyPromise = (async () => {\n    let isUnsupported = isUnsupportedLazyRouteObjectKey(key);\n    let staticRouteValue = routeToUpdate[key];\n    let isStaticallyDefined = staticRouteValue !== void 0 && key !== \"hasErrorBoundary\";\n    if (isUnsupported) {\n      warning(\n        !isUnsupported,\n        \"Route property \" + key + \" is not a supported lazy route property. This property will be ignored.\"\n      );\n      cache[key] = Promise.resolve();\n    } else if (isStaticallyDefined) {\n      warning(\n        false,\n        `Route \"${routeToUpdate.id}\" has a static property \"${key}\" defined. The lazy property will be ignored.`\n      );\n    } else {\n      let value = await lazyFn();\n      if (value != null) {\n        Object.assign(routeToUpdate, { [key]: value });\n        Object.assign(routeToUpdate, mapRouteProperties2(routeToUpdate));\n      }\n    }\n    if (typeof routeToUpdate.lazy === \"object\") {\n      routeToUpdate.lazy[key] = void 0;\n      if (Object.values(routeToUpdate.lazy).every((value) => value === void 0)) {\n        routeToUpdate.lazy = void 0;\n      }\n    }\n  })();\n  cache[key] = propertyPromise;\n  return propertyPromise;\n};\nvar lazyRouteFunctionCache = /* @__PURE__ */ new WeakMap();\nfunction loadLazyRoute(route, type, manifest, mapRouteProperties2, lazyRoutePropertiesToSkip) {\n  let routeToUpdate = manifest[route.id];\n  invariant(routeToUpdate, \"No route found in manifest\");\n  if (!route.lazy) {\n    return {\n      lazyRoutePromise: void 0,\n      lazyHandlerPromise: void 0\n    };\n  }\n  if (typeof route.lazy === \"function\") {\n    let cachedPromise = lazyRouteFunctionCache.get(routeToUpdate);\n    if (cachedPromise) {\n      return {\n        lazyRoutePromise: cachedPromise,\n        lazyHandlerPromise: cachedPromise\n      };\n    }\n    let lazyRoutePromise2 = (async () => {\n      invariant(\n        typeof route.lazy === \"function\",\n        \"No lazy route function found\"\n      );\n      let lazyRoute = await route.lazy();\n      let routeUpdates = {};\n      for (let lazyRouteProperty in lazyRoute) {\n        let lazyValue = lazyRoute[lazyRouteProperty];\n        if (lazyValue === void 0) {\n          continue;\n        }\n        let isUnsupported = isUnsupportedLazyRouteFunctionKey(lazyRouteProperty);\n        let staticRouteValue = routeToUpdate[lazyRouteProperty];\n        let isStaticallyDefined = staticRouteValue !== void 0 && // This property isn't static since it should always be updated based\n        // on the route updates\n        lazyRouteProperty !== \"hasErrorBoundary\";\n        if (isUnsupported) {\n          warning(\n            !isUnsupported,\n            \"Route property \" + lazyRouteProperty + \" is not a supported property to be returned from a lazy route function. This property will be ignored.\"\n          );\n        } else if (isStaticallyDefined) {\n          warning(\n            !isStaticallyDefined,\n            `Route \"${routeToUpdate.id}\" has a static property \"${lazyRouteProperty}\" defined but its lazy function is also returning a value for this property. The lazy route property \"${lazyRouteProperty}\" will be ignored.`\n          );\n        } else {\n          routeUpdates[lazyRouteProperty] = lazyValue;\n        }\n      }\n      Object.assign(routeToUpdate, routeUpdates);\n      Object.assign(routeToUpdate, {\n        // To keep things framework agnostic, we use the provided `mapRouteProperties`\n        // function to set the framework-aware properties (`element`/`hasErrorBoundary`)\n        // since the logic will differ between frameworks.\n        ...mapRouteProperties2(routeToUpdate),\n        lazy: void 0\n      });\n    })();\n    lazyRouteFunctionCache.set(routeToUpdate, lazyRoutePromise2);\n    lazyRoutePromise2.catch(() => {\n    });\n    return {\n      lazyRoutePromise: lazyRoutePromise2,\n      lazyHandlerPromise: lazyRoutePromise2\n    };\n  }\n  let lazyKeys = Object.keys(route.lazy);\n  let lazyPropertyPromises = [];\n  let lazyHandlerPromise = void 0;\n  for (let key of lazyKeys) {\n    if (lazyRoutePropertiesToSkip && lazyRoutePropertiesToSkip.includes(key)) {\n      continue;\n    }\n    let promise = loadLazyRouteProperty({\n      key,\n      route,\n      manifest,\n      mapRouteProperties: mapRouteProperties2\n    });\n    if (promise) {\n      lazyPropertyPromises.push(promise);\n      if (key === type) {\n        lazyHandlerPromise = promise;\n      }\n    }\n  }\n  let lazyRoutePromise = lazyPropertyPromises.length > 0 ? Promise.all(lazyPropertyPromises).then(() => {\n  }) : void 0;\n  lazyRoutePromise?.catch(() => {\n  });\n  lazyHandlerPromise?.catch(() => {\n  });\n  return {\n    lazyRoutePromise,\n    lazyHandlerPromise\n  };\n}\nfunction isNonNullable(value) {\n  return value !== void 0;\n}\nfunction loadLazyMiddlewareForMatches(matches, manifest, mapRouteProperties2) {\n  let promises = matches.map(({ route }) => {\n    if (typeof route.lazy !== \"object\" || !route.lazy.middleware) {\n      return void 0;\n    }\n    return loadLazyRouteProperty({\n      key: \"middleware\",\n      route,\n      manifest,\n      mapRouteProperties: mapRouteProperties2\n    });\n  }).filter(isNonNullable);\n  return promises.length > 0 ? Promise.all(promises) : void 0;\n}\nasync function defaultDataStrategy(args) {\n  let matchesToLoad = args.matches.filter((m) => m.shouldLoad);\n  let keyedResults = {};\n  let results = await Promise.all(matchesToLoad.map((m) => m.resolve()));\n  results.forEach((result, i) => {\n    keyedResults[matchesToLoad[i].route.id] = result;\n  });\n  return keyedResults;\n}\nasync function defaultDataStrategyWithMiddleware(args) {\n  if (!args.matches.some((m) => m.route.middleware)) {\n    return defaultDataStrategy(args);\n  }\n  return runClientMiddlewarePipeline(args, () => defaultDataStrategy(args));\n}\nfunction runServerMiddlewarePipeline(args, handler, errorHandler) {\n  return runMiddlewarePipeline(\n    args,\n    handler,\n    processResult,\n    isResponse,\n    errorHandler\n  );\n  function processResult(result) {\n    return isDataWithResponseInit(result) ? dataWithResponseInitToResponse(result) : result;\n  }\n}\nfunction runClientMiddlewarePipeline(args, handler) {\n  return runMiddlewarePipeline(\n    args,\n    handler,\n    (r) => r,\n    // No post-processing needed on the client\n    isDataStrategyResults,\n    errorHandler\n  );\n  function errorHandler(error, routeId, nextResult) {\n    if (nextResult) {\n      return Promise.resolve(\n        Object.assign(nextResult.value, {\n          [routeId]: { type: \"error\", result: error }\n        })\n      );\n    } else {\n      let { matches } = args;\n      let maxBoundaryIdx = Math.min(\n        // Throwing route\n        Math.max(\n          matches.findIndex((m) => m.route.id === routeId),\n          0\n        ),\n        // or the shallowest route that needs to load data\n        Math.max(\n          matches.findIndex((m) => m.unstable_shouldCallHandler()),\n          0\n        )\n      );\n      let boundaryRouteId = findNearestBoundary(\n        matches,\n        matches[maxBoundaryIdx].route.id\n      ).route.id;\n      return Promise.resolve({\n        [boundaryRouteId]: { type: \"error\", result: error }\n      });\n    }\n  }\n}\nasync function runMiddlewarePipeline(args, handler, processResult, isResult, errorHandler) {\n  let { matches, request, params, context, unstable_pattern } = args;\n  let tuples = matches.flatMap(\n    (m) => m.route.middleware ? m.route.middleware.map((fn) => [m.route.id, fn]) : []\n  );\n  let result = await callRouteMiddleware(\n    {\n      request,\n      params,\n      context,\n      unstable_pattern\n    },\n    tuples,\n    handler,\n    processResult,\n    isResult,\n    errorHandler\n  );\n  return result;\n}\nasync function callRouteMiddleware(args, middlewares, handler, processResult, isResult, errorHandler, idx = 0) {\n  let { request } = args;\n  if (request.signal.aborted) {\n    throw request.signal.reason ?? new Error(`Request aborted: ${request.method} ${request.url}`);\n  }\n  let tuple = middlewares[idx];\n  if (!tuple) {\n    let result = await handler();\n    return result;\n  }\n  let [routeId, middleware] = tuple;\n  let nextResult;\n  let next = async () => {\n    if (nextResult) {\n      throw new Error(\"You may only call `next()` once per middleware\");\n    }\n    try {\n      let result = await callRouteMiddleware(\n        args,\n        middlewares,\n        handler,\n        processResult,\n        isResult,\n        errorHandler,\n        idx + 1\n      );\n      nextResult = { value: result };\n      return nextResult.value;\n    } catch (error) {\n      nextResult = { value: await errorHandler(error, routeId, nextResult) };\n      return nextResult.value;\n    }\n  };\n  try {\n    let value = await middleware(args, next);\n    let result = value != null ? processResult(value) : void 0;\n    if (isResult(result)) {\n      return result;\n    } else if (nextResult) {\n      return result ?? nextResult.value;\n    } else {\n      nextResult = { value: await next() };\n      return nextResult.value;\n    }\n  } catch (error) {\n    let response = await errorHandler(error, routeId, nextResult);\n    return response;\n  }\n}\nfunction getDataStrategyMatchLazyPromises(mapRouteProperties2, manifest, request, match, lazyRoutePropertiesToSkip) {\n  let lazyMiddlewarePromise = loadLazyRouteProperty({\n    key: \"middleware\",\n    route: match.route,\n    manifest,\n    mapRouteProperties: mapRouteProperties2\n  });\n  let lazyRoutePromises = loadLazyRoute(\n    match.route,\n    isMutationMethod(request.method) ? \"action\" : \"loader\",\n    manifest,\n    mapRouteProperties2,\n    lazyRoutePropertiesToSkip\n  );\n  return {\n    middleware: lazyMiddlewarePromise,\n    route: lazyRoutePromises.lazyRoutePromise,\n    handler: lazyRoutePromises.lazyHandlerPromise\n  };\n}\nfunction getDataStrategyMatch(mapRouteProperties2, manifest, request, unstable_pattern, match, lazyRoutePropertiesToSkip, scopedContext, shouldLoad, unstable_shouldRevalidateArgs = null) {\n  let isUsingNewApi = false;\n  let _lazyPromises = getDataStrategyMatchLazyPromises(\n    mapRouteProperties2,\n    manifest,\n    request,\n    match,\n    lazyRoutePropertiesToSkip\n  );\n  return {\n    ...match,\n    _lazyPromises,\n    shouldLoad,\n    unstable_shouldRevalidateArgs,\n    unstable_shouldCallHandler(defaultShouldRevalidate) {\n      isUsingNewApi = true;\n      if (!unstable_shouldRevalidateArgs) {\n        return shouldLoad;\n      }\n      if (typeof defaultShouldRevalidate === \"boolean\") {\n        return shouldRevalidateLoader(match, {\n          ...unstable_shouldRevalidateArgs,\n          defaultShouldRevalidate\n        });\n      }\n      return shouldRevalidateLoader(match, unstable_shouldRevalidateArgs);\n    },\n    resolve(handlerOverride) {\n      let { lazy, loader, middleware } = match.route;\n      let callHandler = isUsingNewApi || shouldLoad || handlerOverride && !isMutationMethod(request.method) && (lazy || loader);\n      let isMiddlewareOnlyRoute = middleware && middleware.length > 0 && !loader && !lazy;\n      if (callHandler && (isMutationMethod(request.method) || !isMiddlewareOnlyRoute)) {\n        return callLoaderOrAction({\n          request,\n          unstable_pattern,\n          match,\n          lazyHandlerPromise: _lazyPromises?.handler,\n          lazyRoutePromise: _lazyPromises?.route,\n          handlerOverride,\n          scopedContext\n        });\n      }\n      return Promise.resolve({ type: \"data\" /* data */, result: void 0 });\n    }\n  };\n}\nfunction getTargetedDataStrategyMatches(mapRouteProperties2, manifest, request, matches, targetMatch, lazyRoutePropertiesToSkip, scopedContext, shouldRevalidateArgs = null) {\n  return matches.map((match) => {\n    if (match.route.id !== targetMatch.route.id) {\n      return {\n        ...match,\n        shouldLoad: false,\n        unstable_shouldRevalidateArgs: shouldRevalidateArgs,\n        unstable_shouldCallHandler: () => false,\n        _lazyPromises: getDataStrategyMatchLazyPromises(\n          mapRouteProperties2,\n          manifest,\n          request,\n          match,\n          lazyRoutePropertiesToSkip\n        ),\n        resolve: () => Promise.resolve({ type: \"data\", result: void 0 })\n      };\n    }\n    return getDataStrategyMatch(\n      mapRouteProperties2,\n      manifest,\n      request,\n      getRoutePattern(matches.map((m) => m.route.path)),\n      match,\n      lazyRoutePropertiesToSkip,\n      scopedContext,\n      true,\n      shouldRevalidateArgs\n    );\n  });\n}\nasync function callDataStrategyImpl(dataStrategyImpl, request, matches, fetcherKey, scopedContext, isStaticHandler) {\n  if (matches.some((m) => m._lazyPromises?.middleware)) {\n    await Promise.all(matches.map((m) => m._lazyPromises?.middleware));\n  }\n  let dataStrategyArgs = {\n    request,\n    unstable_pattern: getRoutePattern(matches.map((m) => m.route.path)),\n    params: matches[0].params,\n    context: scopedContext,\n    matches\n  };\n  let runClientMiddleware = isStaticHandler ? () => {\n    throw new Error(\n      \"You cannot call `runClientMiddleware()` from a static handler `dataStrategy`. Middleware is run outside of `dataStrategy` during SSR in order to bubble up the Response.  You can enable middleware via the `respond` API in `query`/`queryRoute`\"\n    );\n  } : (cb) => {\n    let typedDataStrategyArgs = dataStrategyArgs;\n    return runClientMiddlewarePipeline(typedDataStrategyArgs, () => {\n      return cb({\n        ...typedDataStrategyArgs,\n        fetcherKey,\n        runClientMiddleware: () => {\n          throw new Error(\n            \"Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler\"\n          );\n        }\n      });\n    });\n  };\n  let results = await dataStrategyImpl({\n    ...dataStrategyArgs,\n    fetcherKey,\n    runClientMiddleware\n  });\n  try {\n    await Promise.all(\n      matches.flatMap((m) => [\n        m._lazyPromises?.handler,\n        m._lazyPromises?.route\n      ])\n    );\n  } catch (e) {\n  }\n  return results;\n}\nasync function callLoaderOrAction({\n  request,\n  unstable_pattern,\n  match,\n  lazyHandlerPromise,\n  lazyRoutePromise,\n  handlerOverride,\n  scopedContext\n}) {\n  let result;\n  let onReject;\n  let isAction = isMutationMethod(request.method);\n  let type = isAction ? \"action\" : \"loader\";\n  let runHandler = (handler) => {\n    let reject;\n    let abortPromise = new Promise((_, r) => reject = r);\n    onReject = () => reject();\n    request.signal.addEventListener(\"abort\", onReject);\n    let actualHandler = (ctx) => {\n      if (typeof handler !== \"function\") {\n        return Promise.reject(\n          new Error(\n            `You cannot call the handler for a route which defines a boolean \"${type}\" [routeId: ${match.route.id}]`\n          )\n        );\n      }\n      return handler(\n        {\n          request,\n          unstable_pattern,\n          params: match.params,\n          context: scopedContext\n        },\n        ...ctx !== void 0 ? [ctx] : []\n      );\n    };\n    let handlerPromise = (async () => {\n      try {\n        let val = await (handlerOverride ? handlerOverride((ctx) => actualHandler(ctx)) : actualHandler());\n        return { type: \"data\", result: val };\n      } catch (e) {\n        return { type: \"error\", result: e };\n      }\n    })();\n    return Promise.race([handlerPromise, abortPromise]);\n  };\n  try {\n    let handler = isAction ? match.route.action : match.route.loader;\n    if (lazyHandlerPromise || lazyRoutePromise) {\n      if (handler) {\n        let handlerError;\n        let [value] = await Promise.all([\n          // If the handler throws, don't let it immediately bubble out,\n          // since we need to let the lazy() execution finish so we know if this\n          // route has a boundary that can handle the error\n          runHandler(handler).catch((e) => {\n            handlerError = e;\n          }),\n          // Ensure all lazy route promises are resolved before continuing\n          lazyHandlerPromise,\n          lazyRoutePromise\n        ]);\n        if (handlerError !== void 0) {\n          throw handlerError;\n        }\n        result = value;\n      } else {\n        await lazyHandlerPromise;\n        let handler2 = isAction ? match.route.action : match.route.loader;\n        if (handler2) {\n          [result] = await Promise.all([runHandler(handler2), lazyRoutePromise]);\n        } else if (type === \"action\") {\n          let url = new URL(request.url);\n          let pathname = url.pathname + url.search;\n          throw getInternalRouterError(405, {\n            method: request.method,\n            pathname,\n            routeId: match.route.id\n          });\n        } else {\n          return { type: \"data\" /* data */, result: void 0 };\n        }\n      }\n    } else if (!handler) {\n      let url = new URL(request.url);\n      let pathname = url.pathname + url.search;\n      throw getInternalRouterError(404, {\n        pathname\n      });\n    } else {\n      result = await runHandler(handler);\n    }\n  } catch (e) {\n    return { type: \"error\" /* error */, result: e };\n  } finally {\n    if (onReject) {\n      request.signal.removeEventListener(\"abort\", onReject);\n    }\n  }\n  return result;\n}\nasync function parseResponseBody(response) {\n  let contentType = response.headers.get(\"Content-Type\");\n  if (contentType && /\\bapplication\\/json\\b/.test(contentType)) {\n    return response.body == null ? null : response.json();\n  }\n  return response.text();\n}\nasync function convertDataStrategyResultToDataResult(dataStrategyResult) {\n  let { result, type } = dataStrategyResult;\n  if (isResponse(result)) {\n    let data2;\n    try {\n      data2 = await parseResponseBody(result);\n    } catch (e) {\n      return { type: \"error\" /* error */, error: e };\n    }\n    if (type === \"error\" /* error */) {\n      return {\n        type: \"error\" /* error */,\n        error: new ErrorResponseImpl(result.status, result.statusText, data2),\n        statusCode: result.status,\n        headers: result.headers\n      };\n    }\n    return {\n      type: \"data\" /* data */,\n      data: data2,\n      statusCode: result.status,\n      headers: result.headers\n    };\n  }\n  if (type === \"error\" /* error */) {\n    if (isDataWithResponseInit(result)) {\n      if (result.data instanceof Error) {\n        return {\n          type: \"error\" /* error */,\n          error: result.data,\n          statusCode: result.init?.status,\n          headers: result.init?.headers ? new Headers(result.init.headers) : void 0\n        };\n      }\n      return {\n        type: \"error\" /* error */,\n        error: new ErrorResponseImpl(\n          result.init?.status || 500,\n          void 0,\n          result.data\n        ),\n        statusCode: isRouteErrorResponse(result) ? result.status : void 0,\n        headers: result.init?.headers ? new Headers(result.init.headers) : void 0\n      };\n    }\n    return {\n      type: \"error\" /* error */,\n      error: result,\n      statusCode: isRouteErrorResponse(result) ? result.status : void 0\n    };\n  }\n  if (isDataWithResponseInit(result)) {\n    return {\n      type: \"data\" /* data */,\n      data: result.data,\n      statusCode: result.init?.status,\n      headers: result.init?.headers ? new Headers(result.init.headers) : void 0\n    };\n  }\n  return { type: \"data\" /* data */, data: result };\n}\nfunction normalizeRelativeRoutingRedirectResponse(response, request, routeId, matches, basename) {\n  let location = response.headers.get(\"Location\");\n  invariant(\n    location,\n    \"Redirects returned/thrown from loaders/actions must have a Location header\"\n  );\n  if (!isAbsoluteUrl(location)) {\n    let trimmedMatches = matches.slice(\n      0,\n      matches.findIndex((m) => m.route.id === routeId) + 1\n    );\n    location = normalizeTo(\n      new URL(request.url),\n      trimmedMatches,\n      basename,\n      location\n    );\n    response.headers.set(\"Location\", location);\n  }\n  return response;\n}\nfunction normalizeRedirectLocation(location, currentUrl, basename) {\n  if (isAbsoluteUrl(location)) {\n    let normalizedLocation = location;\n    let url = normalizedLocation.startsWith(\"//\") ? new URL(currentUrl.protocol + normalizedLocation) : new URL(normalizedLocation);\n    let isSameBasename = stripBasename(url.pathname, basename) != null;\n    if (url.origin === currentUrl.origin && isSameBasename) {\n      return url.pathname + url.search + url.hash;\n    }\n  }\n  return location;\n}\nfunction createClientSideRequest(history, location, signal, submission) {\n  let url = history.createURL(stripHashFromPath(location)).toString();\n  let init = { signal };\n  if (submission && isMutationMethod(submission.formMethod)) {\n    let { formMethod, formEncType } = submission;\n    init.method = formMethod.toUpperCase();\n    if (formEncType === \"application/json\") {\n      init.headers = new Headers({ \"Content-Type\": formEncType });\n      init.body = JSON.stringify(submission.json);\n    } else if (formEncType === \"text/plain\") {\n      init.body = submission.text;\n    } else if (formEncType === \"application/x-www-form-urlencoded\" && submission.formData) {\n      init.body = convertFormDataToSearchParams(submission.formData);\n    } else {\n      init.body = submission.formData;\n    }\n  }\n  return new Request(url, init);\n}\nfunction convertFormDataToSearchParams(formData) {\n  let searchParams = new URLSearchParams();\n  for (let [key, value] of formData.entries()) {\n    searchParams.append(key, typeof value === \"string\" ? value : value.name);\n  }\n  return searchParams;\n}\nfunction convertSearchParamsToFormData(searchParams) {\n  let formData = new FormData();\n  for (let [key, value] of searchParams.entries()) {\n    formData.append(key, value);\n  }\n  return formData;\n}\nfunction processRouteLoaderData(matches, results, pendingActionResult, isStaticHandler = false, skipLoaderErrorBubbling = false) {\n  let loaderData = {};\n  let errors = null;\n  let statusCode;\n  let foundError = false;\n  let loaderHeaders = {};\n  let pendingError = pendingActionResult && isErrorResult(pendingActionResult[1]) ? pendingActionResult[1].error : void 0;\n  matches.forEach((match) => {\n    if (!(match.route.id in results)) {\n      return;\n    }\n    let id = match.route.id;\n    let result = results[id];\n    invariant(\n      !isRedirectResult(result),\n      \"Cannot handle redirect results in processLoaderData\"\n    );\n    if (isErrorResult(result)) {\n      let error = result.error;\n      if (pendingError !== void 0) {\n        error = pendingError;\n        pendingError = void 0;\n      }\n      errors = errors || {};\n      if (skipLoaderErrorBubbling) {\n        errors[id] = error;\n      } else {\n        let boundaryMatch = findNearestBoundary(matches, id);\n        if (errors[boundaryMatch.route.id] == null) {\n          errors[boundaryMatch.route.id] = error;\n        }\n      }\n      if (!isStaticHandler) {\n        loaderData[id] = ResetLoaderDataSymbol;\n      }\n      if (!foundError) {\n        foundError = true;\n        statusCode = isRouteErrorResponse(result.error) ? result.error.status : 500;\n      }\n      if (result.headers) {\n        loaderHeaders[id] = result.headers;\n      }\n    } else {\n      loaderData[id] = result.data;\n      if (result.statusCode && result.statusCode !== 200 && !foundError) {\n        statusCode = result.statusCode;\n      }\n      if (result.headers) {\n        loaderHeaders[id] = result.headers;\n      }\n    }\n  });\n  if (pendingError !== void 0 && pendingActionResult) {\n    errors = { [pendingActionResult[0]]: pendingError };\n    if (pendingActionResult[2]) {\n      loaderData[pendingActionResult[2]] = void 0;\n    }\n  }\n  return {\n    loaderData,\n    errors,\n    statusCode: statusCode || 200,\n    loaderHeaders\n  };\n}\nfunction processLoaderData(state, matches, results, pendingActionResult, revalidatingFetchers, fetcherResults) {\n  let { loaderData, errors } = processRouteLoaderData(\n    matches,\n    results,\n    pendingActionResult\n  );\n  revalidatingFetchers.filter((f) => !f.matches || f.matches.some((m) => m.shouldLoad)).forEach((rf) => {\n    let { key, match, controller } = rf;\n    if (controller && controller.signal.aborted) {\n      return;\n    }\n    let result = fetcherResults[key];\n    invariant(result, \"Did not find corresponding fetcher result\");\n    if (isErrorResult(result)) {\n      let boundaryMatch = findNearestBoundary(state.matches, match?.route.id);\n      if (!(errors && errors[boundaryMatch.route.id])) {\n        errors = {\n          ...errors,\n          [boundaryMatch.route.id]: result.error\n        };\n      }\n      state.fetchers.delete(key);\n    } else if (isRedirectResult(result)) {\n      invariant(false, \"Unhandled fetcher revalidation redirect\");\n    } else {\n      let doneFetcher = getDoneFetcher(result.data);\n      state.fetchers.set(key, doneFetcher);\n    }\n  });\n  return { loaderData, errors };\n}\nfunction mergeLoaderData(loaderData, newLoaderData, matches, errors) {\n  let mergedLoaderData = Object.entries(newLoaderData).filter(([, v]) => v !== ResetLoaderDataSymbol).reduce((merged, [k, v]) => {\n    merged[k] = v;\n    return merged;\n  }, {});\n  for (let match of matches) {\n    let id = match.route.id;\n    if (!newLoaderData.hasOwnProperty(id) && loaderData.hasOwnProperty(id) && match.route.loader) {\n      mergedLoaderData[id] = loaderData[id];\n    }\n    if (errors && errors.hasOwnProperty(id)) {\n      break;\n    }\n  }\n  return mergedLoaderData;\n}\nfunction getActionDataForCommit(pendingActionResult) {\n  if (!pendingActionResult) {\n    return {};\n  }\n  return isErrorResult(pendingActionResult[1]) ? {\n    // Clear out prior actionData on errors\n    actionData: {}\n  } : {\n    actionData: {\n      [pendingActionResult[0]]: pendingActionResult[1].data\n    }\n  };\n}\nfunction findNearestBoundary(matches, routeId) {\n  let eligibleMatches = routeId ? matches.slice(0, matches.findIndex((m) => m.route.id === routeId) + 1) : [...matches];\n  return eligibleMatches.reverse().find((m) => m.route.hasErrorBoundary === true) || matches[0];\n}\nfunction getShortCircuitMatches(routes) {\n  let route = routes.length === 1 ? routes[0] : routes.find((r) => r.index || !r.path || r.path === \"/\") || {\n    id: `__shim-error-route__`\n  };\n  return {\n    matches: [\n      {\n        params: {},\n        pathname: \"\",\n        pathnameBase: \"\",\n        route\n      }\n    ],\n    route\n  };\n}\nfunction getInternalRouterError(status, {\n  pathname,\n  routeId,\n  method,\n  type,\n  message\n} = {}) {\n  let statusText = \"Unknown Server Error\";\n  let errorMessage = \"Unknown @remix-run/router error\";\n  if (status === 400) {\n    statusText = \"Bad Request\";\n    if (method && pathname && routeId) {\n      errorMessage = `You made a ${method} request to \"${pathname}\" but did not provide a \\`loader\\` for route \"${routeId}\", so there is no way to handle the request.`;\n    } else if (type === \"invalid-body\") {\n      errorMessage = \"Unable to encode submission body\";\n    }\n  } else if (status === 403) {\n    statusText = \"Forbidden\";\n    errorMessage = `Route \"${routeId}\" does not match URL \"${pathname}\"`;\n  } else if (status === 404) {\n    statusText = \"Not Found\";\n    errorMessage = `No route matches URL \"${pathname}\"`;\n  } else if (status === 405) {\n    statusText = \"Method Not Allowed\";\n    if (method && pathname && routeId) {\n      errorMessage = `You made a ${method.toUpperCase()} request to \"${pathname}\" but did not provide an \\`action\\` for route \"${routeId}\", so there is no way to handle the request.`;\n    } else if (method) {\n      errorMessage = `Invalid request method \"${method.toUpperCase()}\"`;\n    }\n  }\n  return new ErrorResponseImpl(\n    status || 500,\n    statusText,\n    new Error(errorMessage),\n    true\n  );\n}\nfunction findRedirect(results) {\n  let entries = Object.entries(results);\n  for (let i = entries.length - 1; i >= 0; i--) {\n    let [key, result] = entries[i];\n    if (isRedirectResult(result)) {\n      return { key, result };\n    }\n  }\n}\nfunction stripHashFromPath(path) {\n  let parsedPath = typeof path === \"string\" ? parsePath(path) : path;\n  return createPath({ ...parsedPath, hash: \"\" });\n}\nfunction isHashChangeOnly(a, b) {\n  if (a.pathname !== b.pathname || a.search !== b.search) {\n    return false;\n  }\n  if (a.hash === \"\") {\n    return b.hash !== \"\";\n  } else if (a.hash === b.hash) {\n    return true;\n  } else if (b.hash !== \"\") {\n    return true;\n  }\n  return false;\n}\nfunction dataWithResponseInitToResponse(data2) {\n  return Response.json(data2.data, data2.init ?? void 0);\n}\nfunction dataWithResponseInitToErrorResponse(data2) {\n  return new ErrorResponseImpl(\n    data2.init?.status ?? 500,\n    data2.init?.statusText ?? \"Internal Server Error\",\n    data2.data\n  );\n}\nfunction isDataStrategyResults(result) {\n  return result != null && typeof result === \"object\" && Object.entries(result).every(\n    ([key, value]) => typeof key === \"string\" && isDataStrategyResult(value)\n  );\n}\nfunction isDataStrategyResult(result) {\n  return result != null && typeof result === \"object\" && \"type\" in result && \"result\" in result && (result.type === \"data\" /* data */ || result.type === \"error\" /* error */);\n}\nfunction isRedirectDataStrategyResult(result) {\n  return isResponse(result.result) && redirectStatusCodes.has(result.result.status);\n}\nfunction isErrorResult(result) {\n  return result.type === \"error\" /* error */;\n}\nfunction isRedirectResult(result) {\n  return (result && result.type) === \"redirect\" /* redirect */;\n}\nfunction isDataWithResponseInit(value) {\n  return typeof value === \"object\" && value != null && \"type\" in value && \"data\" in value && \"init\" in value && value.type === \"DataWithResponseInit\";\n}\nfunction isResponse(value) {\n  return value != null && typeof value.status === \"number\" && typeof value.statusText === \"string\" && typeof value.headers === \"object\" && typeof value.body !== \"undefined\";\n}\nfunction isRedirectStatusCode(statusCode) {\n  return redirectStatusCodes.has(statusCode);\n}\nfunction isRedirectResponse(result) {\n  return isResponse(result) && isRedirectStatusCode(result.status) && result.headers.has(\"Location\");\n}\nfunction isValidMethod(method) {\n  return validRequestMethods.has(method.toUpperCase());\n}\nfunction isMutationMethod(method) {\n  return validMutationMethods.has(method.toUpperCase());\n}\nfunction hasNakedIndexQuery(search) {\n  return new URLSearchParams(search).getAll(\"index\").some((v) => v === \"\");\n}\nfunction getTargetMatch(matches, location) {\n  let search = typeof location === \"string\" ? parsePath(location).search : location.search;\n  if (matches[matches.length - 1].route.index && hasNakedIndexQuery(search || \"\")) {\n    return matches[matches.length - 1];\n  }\n  let pathMatches = getPathContributingMatches(matches);\n  return pathMatches[pathMatches.length - 1];\n}\nfunction getSubmissionFromNavigation(navigation) {\n  let { formMethod, formAction, formEncType, text, formData, json } = navigation;\n  if (!formMethod || !formAction || !formEncType) {\n    return;\n  }\n  if (text != null) {\n    return {\n      formMethod,\n      formAction,\n      formEncType,\n      formData: void 0,\n      json: void 0,\n      text\n    };\n  } else if (formData != null) {\n    return {\n      formMethod,\n      formAction,\n      formEncType,\n      formData,\n      json: void 0,\n      text: void 0\n    };\n  } else if (json !== void 0) {\n    return {\n      formMethod,\n      formAction,\n      formEncType,\n      formData: void 0,\n      json,\n      text: void 0\n    };\n  }\n}\nfunction getLoadingNavigation(location, submission) {\n  if (submission) {\n    let navigation = {\n      state: \"loading\",\n      location,\n      formMethod: submission.formMethod,\n      formAction: submission.formAction,\n      formEncType: submission.formEncType,\n      formData: submission.formData,\n      json: submission.json,\n      text: submission.text\n    };\n    return navigation;\n  } else {\n    let navigation = {\n      state: \"loading\",\n      location,\n      formMethod: void 0,\n      formAction: void 0,\n      formEncType: void 0,\n      formData: void 0,\n      json: void 0,\n      text: void 0\n    };\n    return navigation;\n  }\n}\nfunction getSubmittingNavigation(location, submission) {\n  let navigation = {\n    state: \"submitting\",\n    location,\n    formMethod: submission.formMethod,\n    formAction: submission.formAction,\n    formEncType: submission.formEncType,\n    formData: submission.formData,\n    json: submission.json,\n    text: submission.text\n  };\n  return navigation;\n}\nfunction getLoadingFetcher(submission, data2) {\n  if (submission) {\n    let fetcher = {\n      state: \"loading\",\n      formMethod: submission.formMethod,\n      formAction: submission.formAction,\n      formEncType: submission.formEncType,\n      formData: submission.formData,\n      json: submission.json,\n      text: submission.text,\n      data: data2\n    };\n    return fetcher;\n  } else {\n    let fetcher = {\n      state: \"loading\",\n      formMethod: void 0,\n      formAction: void 0,\n      formEncType: void 0,\n      formData: void 0,\n      json: void 0,\n      text: void 0,\n      data: data2\n    };\n    return fetcher;\n  }\n}\nfunction getSubmittingFetcher(submission, existingFetcher) {\n  let fetcher = {\n    state: \"submitting\",\n    formMethod: submission.formMethod,\n    formAction: submission.formAction,\n    formEncType: submission.formEncType,\n    formData: submission.formData,\n    json: submission.json,\n    text: submission.text,\n    data: existingFetcher ? existingFetcher.data : void 0\n  };\n  return fetcher;\n}\nfunction getDoneFetcher(data2) {\n  let fetcher = {\n    state: \"idle\",\n    formMethod: void 0,\n    formAction: void 0,\n    formEncType: void 0,\n    formData: void 0,\n    json: void 0,\n    text: void 0,\n    data: data2\n  };\n  return fetcher;\n}\nfunction restoreAppliedTransitions(_window, transitions) {\n  try {\n    let sessionPositions = _window.sessionStorage.getItem(\n      TRANSITIONS_STORAGE_KEY\n    );\n    if (sessionPositions) {\n      let json = JSON.parse(sessionPositions);\n      for (let [k, v] of Object.entries(json || {})) {\n        if (v && Array.isArray(v)) {\n          transitions.set(k, new Set(v || []));\n        }\n      }\n    }\n  } catch (e) {\n  }\n}\nfunction persistAppliedTransitions(_window, transitions) {\n  if (transitions.size > 0) {\n    let json = {};\n    for (let [k, v] of transitions) {\n      json[k] = [...v];\n    }\n    try {\n      _window.sessionStorage.setItem(\n        TRANSITIONS_STORAGE_KEY,\n        JSON.stringify(json)\n      );\n    } catch (error) {\n      warning(\n        false,\n        `Failed to save applied view transitions in sessionStorage (${error}).`\n      );\n    }\n  }\n}\nfunction createDeferred() {\n  let resolve;\n  let reject;\n  let promise = new Promise((res, rej) => {\n    resolve = async (val) => {\n      res(val);\n      try {\n        await promise;\n      } catch (e) {\n      }\n    };\n    reject = async (error) => {\n      rej(error);\n      try {\n        await promise;\n      } catch (e) {\n      }\n    };\n  });\n  return {\n    promise,\n    //@ts-ignore\n    resolve,\n    //@ts-ignore\n    reject\n  };\n}\n\n// lib/context.ts\nimport * as React from \"react\";\nvar DataRouterContext = React.createContext(null);\nDataRouterContext.displayName = \"DataRouter\";\nvar DataRouterStateContext = React.createContext(null);\nDataRouterStateContext.displayName = \"DataRouterState\";\nvar RSCRouterContext = React.createContext(false);\nfunction useIsRSCRouterContext() {\n  return React.useContext(RSCRouterContext);\n}\nvar ViewTransitionContext = React.createContext({\n  isTransitioning: false\n});\nViewTransitionContext.displayName = \"ViewTransition\";\nvar FetchersContext = React.createContext(\n  /* @__PURE__ */ new Map()\n);\nFetchersContext.displayName = \"Fetchers\";\nvar AwaitContext = React.createContext(null);\nAwaitContext.displayName = \"Await\";\nvar AwaitContextProvider = (props) => React.createElement(AwaitContext.Provider, props);\nvar NavigationContext = React.createContext(\n  null\n);\nNavigationContext.displayName = \"Navigation\";\nvar LocationContext = React.createContext(\n  null\n);\nLocationContext.displayName = \"Location\";\nvar RouteContext = React.createContext({\n  outlet: null,\n  matches: [],\n  isDataRoute: false\n});\nRouteContext.displayName = \"Route\";\nvar RouteErrorContext = React.createContext(null);\nRouteErrorContext.displayName = \"RouteError\";\nvar ENABLE_DEV_WARNINGS = true;\n\n// lib/hooks.tsx\nimport * as React2 from \"react\";\nfunction useHref(to, { relative } = {}) {\n  invariant(\n    useInRouterContext(),\n    // TODO: This error is probably because they somehow have 2 versions of the\n    // router loaded. We can help them understand how to avoid that.\n    `useHref() may be used only in the context of a <Router> component.`\n  );\n  let { basename, navigator } = React2.useContext(NavigationContext);\n  let { hash, pathname, search } = useResolvedPath(to, { relative });\n  let joinedPathname = pathname;\n  if (basename !== \"/\") {\n    joinedPathname = pathname === \"/\" ? basename : joinPaths([basename, pathname]);\n  }\n  return navigator.createHref({ pathname: joinedPathname, search, hash });\n}\nfunction useInRouterContext() {\n  return React2.useContext(LocationContext) != null;\n}\nfunction useLocation() {\n  invariant(\n    useInRouterContext(),\n    // TODO: This error is probably because they somehow have 2 versions of the\n    // router loaded. We can help them understand how to avoid that.\n    `useLocation() may be used only in the context of a <Router> component.`\n  );\n  return React2.useContext(LocationContext).location;\n}\nfunction useNavigationType() {\n  return React2.useContext(LocationContext).navigationType;\n}\nfunction useMatch(pattern) {\n  invariant(\n    useInRouterContext(),\n    // TODO: This error is probably because they somehow have 2 versions of the\n    // router loaded. We can help them understand how to avoid that.\n    `useMatch() may be used only in the context of a <Router> component.`\n  );\n  let { pathname } = useLocation();\n  return React2.useMemo(\n    () => matchPath(pattern, decodePath(pathname)),\n    [pathname, pattern]\n  );\n}\nvar navigateEffectWarning = `You should call navigate() in a React.useEffect(), not when your component is first rendered.`;\nfunction useIsomorphicLayoutEffect(cb) {\n  let isStatic = React2.useContext(NavigationContext).static;\n  if (!isStatic) {\n    React2.useLayoutEffect(cb);\n  }\n}\nfunction useNavigate() {\n  let { isDataRoute } = React2.useContext(RouteContext);\n  return isDataRoute ? useNavigateStable() : useNavigateUnstable();\n}\nfunction useNavigateUnstable() {\n  invariant(\n    useInRouterContext(),\n    // TODO: This error is probably because they somehow have 2 versions of the\n    // router loaded. We can help them understand how to avoid that.\n    `useNavigate() may be used only in the context of a <Router> component.`\n  );\n  let dataRouterContext = React2.useContext(DataRouterContext);\n  let { basename, navigator } = React2.useContext(NavigationContext);\n  let { matches } = React2.useContext(RouteContext);\n  let { pathname: locationPathname } = useLocation();\n  let routePathnamesJson = JSON.stringify(getResolveToMatches(matches));\n  let activeRef = React2.useRef(false);\n  useIsomorphicLayoutEffect(() => {\n    activeRef.current = true;\n  });\n  let navigate = React2.useCallback(\n    (to, options = {}) => {\n      warning(activeRef.current, navigateEffectWarning);\n      if (!activeRef.current) return;\n      if (typeof to === \"number\") {\n        navigator.go(to);\n        return;\n      }\n      let path = resolveTo(\n        to,\n        JSON.parse(routePathnamesJson),\n        locationPathname,\n        options.relative === \"path\"\n      );\n      if (dataRouterContext == null && basename !== \"/\") {\n        path.pathname = path.pathname === \"/\" ? basename : joinPaths([basename, path.pathname]);\n      }\n      (!!options.replace ? navigator.replace : navigator.push)(\n        path,\n        options.state,\n        options\n      );\n    },\n    [\n      basename,\n      navigator,\n      routePathnamesJson,\n      locationPathname,\n      dataRouterContext\n    ]\n  );\n  return navigate;\n}\nvar OutletContext = React2.createContext(null);\nfunction useOutletContext() {\n  return React2.useContext(OutletContext);\n}\nfunction useOutlet(context) {\n  let outlet = React2.useContext(RouteContext).outlet;\n  return React2.useMemo(\n    () => outlet && /* @__PURE__ */ React2.createElement(OutletContext.Provider, { value: context }, outlet),\n    [outlet, context]\n  );\n}\nfunction useParams() {\n  let { matches } = React2.useContext(RouteContext);\n  let routeMatch = matches[matches.length - 1];\n  return routeMatch ? routeMatch.params : {};\n}\nfunction useResolvedPath(to, { relative } = {}) {\n  let { matches } = React2.useContext(RouteContext);\n  let { pathname: locationPathname } = useLocation();\n  let routePathnamesJson = JSON.stringify(getResolveToMatches(matches));\n  return React2.useMemo(\n    () => resolveTo(\n      to,\n      JSON.parse(routePathnamesJson),\n      locationPathname,\n      relative === \"path\"\n    ),\n    [to, routePathnamesJson, locationPathname, relative]\n  );\n}\nfunction useRoutes(routes, locationArg) {\n  return useRoutesImpl(routes, locationArg);\n}\nfunction useRoutesImpl(routes, locationArg, dataRouterState, unstable_onError, future) {\n  invariant(\n    useInRouterContext(),\n    // TODO: This error is probably because they somehow have 2 versions of the\n    // router loaded. We can help them understand how to avoid that.\n    `useRoutes() may be used only in the context of a <Router> component.`\n  );\n  let { navigator } = React2.useContext(NavigationContext);\n  let { matches: parentMatches } = React2.useContext(RouteContext);\n  let routeMatch = parentMatches[parentMatches.length - 1];\n  let parentParams = routeMatch ? routeMatch.params : {};\n  let parentPathname = routeMatch ? routeMatch.pathname : \"/\";\n  let parentPathnameBase = routeMatch ? routeMatch.pathnameBase : \"/\";\n  let parentRoute = routeMatch && routeMatch.route;\n  if (ENABLE_DEV_WARNINGS) {\n    let parentPath = parentRoute && parentRoute.path || \"\";\n    warningOnce(\n      parentPathname,\n      !parentRoute || parentPath.endsWith(\"*\") || parentPath.endsWith(\"*?\"),\n      `You rendered descendant <Routes> (or called \\`useRoutes()\\`) at \"${parentPathname}\" (under <Route path=\"${parentPath}\">) but the parent route path has no trailing \"*\". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path=\"${parentPath}\"> to <Route path=\"${parentPath === \"/\" ? \"*\" : `${parentPath}/*`}\">.`\n    );\n  }\n  let locationFromContext = useLocation();\n  let location;\n  if (locationArg) {\n    let parsedLocationArg = typeof locationArg === \"string\" ? parsePath(locationArg) : locationArg;\n    invariant(\n      parentPathnameBase === \"/\" || parsedLocationArg.pathname?.startsWith(parentPathnameBase),\n      `When overriding the location using \\`<Routes location>\\` or \\`useRoutes(routes, location)\\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is \"${parentPathnameBase}\" but pathname \"${parsedLocationArg.pathname}\" was given in the \\`location\\` prop.`\n    );\n    location = parsedLocationArg;\n  } else {\n    location = locationFromContext;\n  }\n  let pathname = location.pathname || \"/\";\n  let remainingPathname = pathname;\n  if (parentPathnameBase !== \"/\") {\n    let parentSegments = parentPathnameBase.replace(/^\\//, \"\").split(\"/\");\n    let segments = pathname.replace(/^\\//, \"\").split(\"/\");\n    remainingPathname = \"/\" + segments.slice(parentSegments.length).join(\"/\");\n  }\n  let matches = matchRoutes(routes, { pathname: remainingPathname });\n  if (ENABLE_DEV_WARNINGS) {\n    warning(\n      parentRoute || matches != null,\n      `No routes matched location \"${location.pathname}${location.search}${location.hash}\" `\n    );\n    warning(\n      matches == null || matches[matches.length - 1].route.element !== void 0 || matches[matches.length - 1].route.Component !== void 0 || matches[matches.length - 1].route.lazy !== void 0,\n      `Matched leaf route at location \"${location.pathname}${location.search}${location.hash}\" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an \"empty\" page.`\n    );\n  }\n  let renderedMatches = _renderMatches(\n    matches && matches.map(\n      (match) => Object.assign({}, match, {\n        params: Object.assign({}, parentParams, match.params),\n        pathname: joinPaths([\n          parentPathnameBase,\n          // Re-encode pathnames that were decoded inside matchRoutes.\n          // Pre-encode `?` and `#` ahead of `encodeLocation` because it uses\n          // `new URL()` internally and we need to prevent it from treating\n          // them as separators\n          navigator.encodeLocation ? navigator.encodeLocation(\n            match.pathname.replace(/\\?/g, \"%3F\").replace(/#/g, \"%23\")\n          ).pathname : match.pathname\n        ]),\n        pathnameBase: match.pathnameBase === \"/\" ? parentPathnameBase : joinPaths([\n          parentPathnameBase,\n          // Re-encode pathnames that were decoded inside matchRoutes\n          // Pre-encode `?` and `#` ahead of `encodeLocation` because it uses\n          // `new URL()` internally and we need to prevent it from treating\n          // them as separators\n          navigator.encodeLocation ? navigator.encodeLocation(\n            match.pathnameBase.replace(/\\?/g, \"%3F\").replace(/#/g, \"%23\")\n          ).pathname : match.pathnameBase\n        ])\n      })\n    ),\n    parentMatches,\n    dataRouterState,\n    unstable_onError,\n    future\n  );\n  if (locationArg && renderedMatches) {\n    return /* @__PURE__ */ React2.createElement(\n      LocationContext.Provider,\n      {\n        value: {\n          location: {\n            pathname: \"/\",\n            search: \"\",\n            hash: \"\",\n            state: null,\n            key: \"default\",\n            ...location\n          },\n          navigationType: \"POP\" /* Pop */\n        }\n      },\n      renderedMatches\n    );\n  }\n  return renderedMatches;\n}\nfunction DefaultErrorComponent() {\n  let error = useRouteError();\n  let message = isRouteErrorResponse(error) ? `${error.status} ${error.statusText}` : error instanceof Error ? error.message : JSON.stringify(error);\n  let stack = error instanceof Error ? error.stack : null;\n  let lightgrey = \"rgba(200,200,200, 0.5)\";\n  let preStyles = { padding: \"0.5rem\", backgroundColor: lightgrey };\n  let codeStyles = { padding: \"2px 4px\", backgroundColor: lightgrey };\n  let devInfo = null;\n  if (ENABLE_DEV_WARNINGS) {\n    console.error(\n      \"Error handled by React Router default ErrorBoundary:\",\n      error\n    );\n    devInfo = /* @__PURE__ */ React2.createElement(React2.Fragment, null, /* @__PURE__ */ React2.createElement(\"p\", null, \"\\u{1F4BF} Hey developer \\u{1F44B}\"), /* @__PURE__ */ React2.createElement(\"p\", null, \"You can provide a way better UX than this when your app throws errors by providing your own \", /* @__PURE__ */ React2.createElement(\"code\", { style: codeStyles }, \"ErrorBoundary\"), \" or\", \" \", /* @__PURE__ */ React2.createElement(\"code\", { style: codeStyles }, \"errorElement\"), \" prop on your route.\"));\n  }\n  return /* @__PURE__ */ React2.createElement(React2.Fragment, null, /* @__PURE__ */ React2.createElement(\"h2\", null, \"Unexpected Application Error!\"), /* @__PURE__ */ React2.createElement(\"h3\", { style: { fontStyle: \"italic\" } }, message), stack ? /* @__PURE__ */ React2.createElement(\"pre\", { style: preStyles }, stack) : null, devInfo);\n}\nvar defaultErrorElement = /* @__PURE__ */ React2.createElement(DefaultErrorComponent, null);\nvar RenderErrorBoundary = class extends React2.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      location: props.location,\n      revalidation: props.revalidation,\n      error: props.error\n    };\n  }\n  static getDerivedStateFromError(error) {\n    return { error };\n  }\n  static getDerivedStateFromProps(props, state) {\n    if (state.location !== props.location || state.revalidation !== \"idle\" && props.revalidation === \"idle\") {\n      return {\n        error: props.error,\n        location: props.location,\n        revalidation: props.revalidation\n      };\n    }\n    return {\n      error: props.error !== void 0 ? props.error : state.error,\n      location: state.location,\n      revalidation: props.revalidation || state.revalidation\n    };\n  }\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    } else {\n      console.error(\n        \"React Router caught the following error during render\",\n        error\n      );\n    }\n  }\n  render() {\n    return this.state.error !== void 0 ? /* @__PURE__ */ React2.createElement(RouteContext.Provider, { value: this.props.routeContext }, /* @__PURE__ */ React2.createElement(\n      RouteErrorContext.Provider,\n      {\n        value: this.state.error,\n        children: this.props.component\n      }\n    )) : this.props.children;\n  }\n};\nfunction RenderedRoute({ routeContext, match, children }) {\n  let dataRouterContext = React2.useContext(DataRouterContext);\n  if (dataRouterContext && dataRouterContext.static && dataRouterContext.staticContext && (match.route.errorElement || match.route.ErrorBoundary)) {\n    dataRouterContext.staticContext._deepestRenderedBoundaryId = match.route.id;\n  }\n  return /* @__PURE__ */ React2.createElement(RouteContext.Provider, { value: routeContext }, children);\n}\nfunction _renderMatches(matches, parentMatches = [], dataRouterState = null, unstable_onError = null, future = null) {\n  if (matches == null) {\n    if (!dataRouterState) {\n      return null;\n    }\n    if (dataRouterState.errors) {\n      matches = dataRouterState.matches;\n    } else if (parentMatches.length === 0 && !dataRouterState.initialized && dataRouterState.matches.length > 0) {\n      matches = dataRouterState.matches;\n    } else {\n      return null;\n    }\n  }\n  let renderedMatches = matches;\n  let errors = dataRouterState?.errors;\n  if (errors != null) {\n    let errorIndex = renderedMatches.findIndex(\n      (m) => m.route.id && errors?.[m.route.id] !== void 0\n    );\n    invariant(\n      errorIndex >= 0,\n      `Could not find a matching route for errors on route IDs: ${Object.keys(\n        errors\n      ).join(\",\")}`\n    );\n    renderedMatches = renderedMatches.slice(\n      0,\n      Math.min(renderedMatches.length, errorIndex + 1)\n    );\n  }\n  let renderFallback = false;\n  let fallbackIndex = -1;\n  if (dataRouterState) {\n    for (let i = 0; i < renderedMatches.length; i++) {\n      let match = renderedMatches[i];\n      if (match.route.HydrateFallback || match.route.hydrateFallbackElement) {\n        fallbackIndex = i;\n      }\n      if (match.route.id) {\n        let { loaderData, errors: errors2 } = dataRouterState;\n        let needsToRunLoader = match.route.loader && !loaderData.hasOwnProperty(match.route.id) && (!errors2 || errors2[match.route.id] === void 0);\n        if (match.route.lazy || needsToRunLoader) {\n          renderFallback = true;\n          if (fallbackIndex >= 0) {\n            renderedMatches = renderedMatches.slice(0, fallbackIndex + 1);\n          } else {\n            renderedMatches = [renderedMatches[0]];\n          }\n          break;\n        }\n      }\n    }\n  }\n  let onError = dataRouterState && unstable_onError ? (error, errorInfo) => {\n    unstable_onError(error, {\n      location: dataRouterState.location,\n      params: dataRouterState.matches?.[0]?.params ?? {},\n      errorInfo\n    });\n  } : void 0;\n  return renderedMatches.reduceRight(\n    (outlet, match, index) => {\n      let error;\n      let shouldRenderHydrateFallback = false;\n      let errorElement = null;\n      let hydrateFallbackElement = null;\n      if (dataRouterState) {\n        error = errors && match.route.id ? errors[match.route.id] : void 0;\n        errorElement = match.route.errorElement || defaultErrorElement;\n        if (renderFallback) {\n          if (fallbackIndex < 0 && index === 0) {\n            warningOnce(\n              \"route-fallback\",\n              false,\n              \"No `HydrateFallback` element provided to render during initial hydration\"\n            );\n            shouldRenderHydrateFallback = true;\n            hydrateFallbackElement = null;\n          } else if (fallbackIndex === index) {\n            shouldRenderHydrateFallback = true;\n            hydrateFallbackElement = match.route.hydrateFallbackElement || null;\n          }\n        }\n      }\n      let matches2 = parentMatches.concat(renderedMatches.slice(0, index + 1));\n      let getChildren = () => {\n        let children;\n        if (error) {\n          children = errorElement;\n        } else if (shouldRenderHydrateFallback) {\n          children = hydrateFallbackElement;\n        } else if (match.route.Component) {\n          children = /* @__PURE__ */ React2.createElement(match.route.Component, null);\n        } else if (match.route.element) {\n          children = match.route.element;\n        } else {\n          children = outlet;\n        }\n        return /* @__PURE__ */ React2.createElement(\n          RenderedRoute,\n          {\n            match,\n            routeContext: {\n              outlet,\n              matches: matches2,\n              isDataRoute: dataRouterState != null\n            },\n            children\n          }\n        );\n      };\n      return dataRouterState && (match.route.ErrorBoundary || match.route.errorElement || index === 0) ? /* @__PURE__ */ React2.createElement(\n        RenderErrorBoundary,\n        {\n          location: dataRouterState.location,\n          revalidation: dataRouterState.revalidation,\n          component: errorElement,\n          error,\n          children: getChildren(),\n          routeContext: { outlet: null, matches: matches2, isDataRoute: true },\n          onError\n        }\n      ) : getChildren();\n    },\n    null\n  );\n}\nfunction getDataRouterConsoleError(hookName) {\n  return `${hookName} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`;\n}\nfunction useDataRouterContext(hookName) {\n  let ctx = React2.useContext(DataRouterContext);\n  invariant(ctx, getDataRouterConsoleError(hookName));\n  return ctx;\n}\nfunction useDataRouterState(hookName) {\n  let state = React2.useContext(DataRouterStateContext);\n  invariant(state, getDataRouterConsoleError(hookName));\n  return state;\n}\nfunction useRouteContext(hookName) {\n  let route = React2.useContext(RouteContext);\n  invariant(route, getDataRouterConsoleError(hookName));\n  return route;\n}\nfunction useCurrentRouteId(hookName) {\n  let route = useRouteContext(hookName);\n  let thisRoute = route.matches[route.matches.length - 1];\n  invariant(\n    thisRoute.route.id,\n    `${hookName} can only be used on routes that contain a unique \"id\"`\n  );\n  return thisRoute.route.id;\n}\nfunction useRouteId() {\n  return useCurrentRouteId(\"useRouteId\" /* UseRouteId */);\n}\nfunction useNavigation() {\n  let state = useDataRouterState(\"useNavigation\" /* UseNavigation */);\n  return state.navigation;\n}\nfunction useRevalidator() {\n  let dataRouterContext = useDataRouterContext(\"useRevalidator\" /* UseRevalidator */);\n  let state = useDataRouterState(\"useRevalidator\" /* UseRevalidator */);\n  let revalidate = React2.useCallback(async () => {\n    await dataRouterContext.router.revalidate();\n  }, [dataRouterContext.router]);\n  return React2.useMemo(\n    () => ({ revalidate, state: state.revalidation }),\n    [revalidate, state.revalidation]\n  );\n}\nfunction useMatches() {\n  let { matches, loaderData } = useDataRouterState(\n    \"useMatches\" /* UseMatches */\n  );\n  return React2.useMemo(\n    () => matches.map((m) => convertRouteMatchToUiMatch(m, loaderData)),\n    [matches, loaderData]\n  );\n}\nfunction useLoaderData() {\n  let state = useDataRouterState(\"useLoaderData\" /* UseLoaderData */);\n  let routeId = useCurrentRouteId(\"useLoaderData\" /* UseLoaderData */);\n  return state.loaderData[routeId];\n}\nfunction useRouteLoaderData(routeId) {\n  let state = useDataRouterState(\"useRouteLoaderData\" /* UseRouteLoaderData */);\n  return state.loaderData[routeId];\n}\nfunction useActionData() {\n  let state = useDataRouterState(\"useActionData\" /* UseActionData */);\n  let routeId = useCurrentRouteId(\"useLoaderData\" /* UseLoaderData */);\n  return state.actionData ? state.actionData[routeId] : void 0;\n}\nfunction useRouteError() {\n  let error = React2.useContext(RouteErrorContext);\n  let state = useDataRouterState(\"useRouteError\" /* UseRouteError */);\n  let routeId = useCurrentRouteId(\"useRouteError\" /* UseRouteError */);\n  if (error !== void 0) {\n    return error;\n  }\n  return state.errors?.[routeId];\n}\nfunction useAsyncValue() {\n  let value = React2.useContext(AwaitContext);\n  return value?._data;\n}\nfunction useAsyncError() {\n  let value = React2.useContext(AwaitContext);\n  return value?._error;\n}\nvar blockerId = 0;\nfunction useBlocker(shouldBlock) {\n  let { router, basename } = useDataRouterContext(\"useBlocker\" /* UseBlocker */);\n  let state = useDataRouterState(\"useBlocker\" /* UseBlocker */);\n  let [blockerKey, setBlockerKey] = React2.useState(\"\");\n  let blockerFunction = React2.useCallback(\n    (arg) => {\n      if (typeof shouldBlock !== \"function\") {\n        return !!shouldBlock;\n      }\n      if (basename === \"/\") {\n        return shouldBlock(arg);\n      }\n      let { currentLocation, nextLocation, historyAction } = arg;\n      return shouldBlock({\n        currentLocation: {\n          ...currentLocation,\n          pathname: stripBasename(currentLocation.pathname, basename) || currentLocation.pathname\n        },\n        nextLocation: {\n          ...nextLocation,\n          pathname: stripBasename(nextLocation.pathname, basename) || nextLocation.pathname\n        },\n        historyAction\n      });\n    },\n    [basename, shouldBlock]\n  );\n  React2.useEffect(() => {\n    let key = String(++blockerId);\n    setBlockerKey(key);\n    return () => router.deleteBlocker(key);\n  }, [router]);\n  React2.useEffect(() => {\n    if (blockerKey !== \"\") {\n      router.getBlocker(blockerKey, blockerFunction);\n    }\n  }, [router, blockerKey, blockerFunction]);\n  return blockerKey && state.blockers.has(blockerKey) ? state.blockers.get(blockerKey) : IDLE_BLOCKER;\n}\nfunction useNavigateStable() {\n  let { router } = useDataRouterContext(\"useNavigate\" /* UseNavigateStable */);\n  let id = useCurrentRouteId(\"useNavigate\" /* UseNavigateStable */);\n  let activeRef = React2.useRef(false);\n  useIsomorphicLayoutEffect(() => {\n    activeRef.current = true;\n  });\n  let navigate = React2.useCallback(\n    async (to, options = {}) => {\n      warning(activeRef.current, navigateEffectWarning);\n      if (!activeRef.current) return;\n      if (typeof to === \"number\") {\n        router.navigate(to);\n      } else {\n        await router.navigate(to, { fromRouteId: id, ...options });\n      }\n    },\n    [router, id]\n  );\n  return navigate;\n}\nvar alreadyWarned = {};\nfunction warningOnce(key, cond, message) {\n  if (!cond && !alreadyWarned[key]) {\n    alreadyWarned[key] = true;\n    warning(false, message);\n  }\n}\nfunction useRoute(...args) {\n  const currentRouteId = useCurrentRouteId(\n    \"useRoute\" /* UseRoute */\n  );\n  const id = args[0] ?? currentRouteId;\n  const state = useDataRouterState(\"useRoute\" /* UseRoute */);\n  const route = state.matches.find(({ route: route2 }) => route2.id === id);\n  if (route === void 0) return void 0;\n  return {\n    handle: route.route.handle,\n    loaderData: state.loaderData[id],\n    actionData: state.actionData?.[id]\n  };\n}\n\n// lib/components.tsx\nimport * as React3 from \"react\";\n\n// lib/server-runtime/warnings.ts\nvar alreadyWarned2 = {};\nfunction warnOnce(condition, message) {\n  if (!condition && !alreadyWarned2[message]) {\n    alreadyWarned2[message] = true;\n    console.warn(message);\n  }\n}\n\n// lib/components.tsx\nfunction mapRouteProperties(route) {\n  let updates = {\n    // Note: this check also occurs in createRoutesFromChildren so update\n    // there if you change this -- please and thank you!\n    hasErrorBoundary: route.hasErrorBoundary || route.ErrorBoundary != null || route.errorElement != null\n  };\n  if (route.Component) {\n    if (ENABLE_DEV_WARNINGS) {\n      if (route.element) {\n        warning(\n          false,\n          \"You should not include both `Component` and `element` on your route - `Component` will be used.\"\n        );\n      }\n    }\n    Object.assign(updates, {\n      element: React3.createElement(route.Component),\n      Component: void 0\n    });\n  }\n  if (route.HydrateFallback) {\n    if (ENABLE_DEV_WARNINGS) {\n      if (route.hydrateFallbackElement) {\n        warning(\n          false,\n          \"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used.\"\n        );\n      }\n    }\n    Object.assign(updates, {\n      hydrateFallbackElement: React3.createElement(route.HydrateFallback),\n      HydrateFallback: void 0\n    });\n  }\n  if (route.ErrorBoundary) {\n    if (ENABLE_DEV_WARNINGS) {\n      if (route.errorElement) {\n        warning(\n          false,\n          \"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used.\"\n        );\n      }\n    }\n    Object.assign(updates, {\n      errorElement: React3.createElement(route.ErrorBoundary),\n      ErrorBoundary: void 0\n    });\n  }\n  return updates;\n}\nvar hydrationRouteProperties = [\n  \"HydrateFallback\",\n  \"hydrateFallbackElement\"\n];\nfunction createMemoryRouter(routes, opts) {\n  return createRouter({\n    basename: opts?.basename,\n    getContext: opts?.getContext,\n    future: opts?.future,\n    history: createMemoryHistory({\n      initialEntries: opts?.initialEntries,\n      initialIndex: opts?.initialIndex\n    }),\n    hydrationData: opts?.hydrationData,\n    routes,\n    hydrationRouteProperties,\n    mapRouteProperties,\n    dataStrategy: opts?.dataStrategy,\n    patchRoutesOnNavigation: opts?.patchRoutesOnNavigation,\n    unstable_instrumentations: opts?.unstable_instrumentations\n  }).initialize();\n}\nvar Deferred = class {\n  constructor() {\n    this.status = \"pending\";\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = (value) => {\n        if (this.status === \"pending\") {\n          this.status = \"resolved\";\n          resolve(value);\n        }\n      };\n      this.reject = (reason) => {\n        if (this.status === \"pending\") {\n          this.status = \"rejected\";\n          reject(reason);\n        }\n      };\n    });\n  }\n};\nfunction shallowDiff(a, b) {\n  if (a === b) {\n    return false;\n  }\n  let aKeys = Object.keys(a);\n  let bKeys = Object.keys(b);\n  if (aKeys.length !== bKeys.length) {\n    return true;\n  }\n  for (let key of aKeys) {\n    if (a[key] !== b[key]) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction UNSTABLE_TransitionEnabledRouterProvider({\n  router,\n  flushSync: reactDomFlushSyncImpl,\n  unstable_onError\n}) {\n  let fetcherData = React3.useRef(/* @__PURE__ */ new Map());\n  let [revalidating, startRevalidation] = React3.useTransition();\n  let [state, setState] = React3.useState(router.state);\n  router.__setPendingRerender = (promise) => startRevalidation(\n    // @ts-expect-error - need react 19 types for this to be async\n    async () => {\n      const rerender = await promise;\n      startRevalidation(() => {\n        rerender();\n      });\n    }\n  );\n  let navigator = React3.useMemo(() => {\n    return {\n      createHref: router.createHref,\n      encodeLocation: router.encodeLocation,\n      go: (n) => router.navigate(n),\n      push: (to, state2, opts) => router.navigate(to, {\n        state: state2,\n        preventScrollReset: opts?.preventScrollReset\n      }),\n      replace: (to, state2, opts) => router.navigate(to, {\n        replace: true,\n        state: state2,\n        preventScrollReset: opts?.preventScrollReset\n      })\n    };\n  }, [router]);\n  let basename = router.basename || \"/\";\n  let dataRouterContext = React3.useMemo(\n    () => ({\n      router,\n      navigator,\n      static: false,\n      basename,\n      unstable_onError\n    }),\n    [router, navigator, basename, unstable_onError]\n  );\n  React3.useLayoutEffect(() => {\n    return router.subscribe(\n      (newState, { deletedFetchers, flushSync, viewTransitionOpts }) => {\n        newState.fetchers.forEach((fetcher, key) => {\n          if (fetcher.data !== void 0) {\n            fetcherData.current.set(key, fetcher.data);\n          }\n        });\n        deletedFetchers.forEach((key) => fetcherData.current.delete(key));\n        const diff = shallowDiff(state, newState);\n        if (!diff) return;\n        if (flushSync) {\n          if (reactDomFlushSyncImpl) {\n            reactDomFlushSyncImpl(() => setState(newState));\n          } else {\n            setState(newState);\n          }\n        } else {\n          React3.startTransition(() => {\n            setState(newState);\n          });\n        }\n      }\n    );\n  }, [router, reactDomFlushSyncImpl, state]);\n  return /* @__PURE__ */ React3.createElement(React3.Fragment, null, /* @__PURE__ */ React3.createElement(DataRouterContext.Provider, { value: dataRouterContext }, /* @__PURE__ */ React3.createElement(\n    DataRouterStateContext.Provider,\n    {\n      value: {\n        ...state,\n        revalidation: revalidating ? \"loading\" : state.revalidation\n      }\n    },\n    /* @__PURE__ */ React3.createElement(FetchersContext.Provider, { value: fetcherData.current }, /* @__PURE__ */ React3.createElement(\n      Router,\n      {\n        basename,\n        location: state.location,\n        navigationType: state.historyAction,\n        navigator\n      },\n      /* @__PURE__ */ React3.createElement(\n        MemoizedDataRoutes,\n        {\n          routes: router.routes,\n          future: router.future,\n          state,\n          unstable_onError\n        }\n      )\n    ))\n  )), null);\n}\nfunction RouterProvider({\n  router,\n  flushSync: reactDomFlushSyncImpl,\n  unstable_onError\n}) {\n  let [state, setStateImpl] = React3.useState(router.state);\n  let [pendingState, setPendingState] = React3.useState();\n  let [vtContext, setVtContext] = React3.useState({\n    isTransitioning: false\n  });\n  let [renderDfd, setRenderDfd] = React3.useState();\n  let [transition, setTransition] = React3.useState();\n  let [interruption, setInterruption] = React3.useState();\n  let fetcherData = React3.useRef(/* @__PURE__ */ new Map());\n  let logErrorsAndSetState = React3.useCallback(\n    (newState) => {\n      setStateImpl((prevState) => {\n        if (newState.errors && unstable_onError) {\n          Object.entries(newState.errors).forEach(([routeId, error]) => {\n            if (prevState.errors?.[routeId] !== error) {\n              unstable_onError(error, {\n                location: newState.location,\n                params: newState.matches[0]?.params ?? {}\n              });\n            }\n          });\n        }\n        return newState;\n      });\n    },\n    [unstable_onError]\n  );\n  let setState = React3.useCallback(\n    (newState, { deletedFetchers, flushSync, viewTransitionOpts }) => {\n      newState.fetchers.forEach((fetcher, key) => {\n        if (fetcher.data !== void 0) {\n          fetcherData.current.set(key, fetcher.data);\n        }\n      });\n      deletedFetchers.forEach((key) => fetcherData.current.delete(key));\n      warnOnce(\n        flushSync === false || reactDomFlushSyncImpl != null,\n        'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from \"react-router/dom\"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.'\n      );\n      let isViewTransitionAvailable = router.window != null && router.window.document != null && typeof router.window.document.startViewTransition === \"function\";\n      warnOnce(\n        viewTransitionOpts == null || isViewTransitionAvailable,\n        \"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available.\"\n      );\n      if (!viewTransitionOpts || !isViewTransitionAvailable) {\n        if (reactDomFlushSyncImpl && flushSync) {\n          reactDomFlushSyncImpl(() => logErrorsAndSetState(newState));\n        } else {\n          React3.startTransition(() => logErrorsAndSetState(newState));\n        }\n        return;\n      }\n      if (reactDomFlushSyncImpl && flushSync) {\n        reactDomFlushSyncImpl(() => {\n          if (transition) {\n            renderDfd && renderDfd.resolve();\n            transition.skipTransition();\n          }\n          setVtContext({\n            isTransitioning: true,\n            flushSync: true,\n            currentLocation: viewTransitionOpts.currentLocation,\n            nextLocation: viewTransitionOpts.nextLocation\n          });\n        });\n        let t = router.window.document.startViewTransition(() => {\n          reactDomFlushSyncImpl(() => logErrorsAndSetState(newState));\n        });\n        t.finished.finally(() => {\n          reactDomFlushSyncImpl(() => {\n            setRenderDfd(void 0);\n            setTransition(void 0);\n            setPendingState(void 0);\n            setVtContext({ isTransitioning: false });\n          });\n        });\n        reactDomFlushSyncImpl(() => setTransition(t));\n        return;\n      }\n      if (transition) {\n        renderDfd && renderDfd.resolve();\n        transition.skipTransition();\n        setInterruption({\n          state: newState,\n          currentLocation: viewTransitionOpts.currentLocation,\n          nextLocation: viewTransitionOpts.nextLocation\n        });\n      } else {\n        setPendingState(newState);\n        setVtContext({\n          isTransitioning: true,\n          flushSync: false,\n          currentLocation: viewTransitionOpts.currentLocation,\n          nextLocation: viewTransitionOpts.nextLocation\n        });\n      }\n    },\n    [\n      router.window,\n      reactDomFlushSyncImpl,\n      transition,\n      renderDfd,\n      logErrorsAndSetState\n    ]\n  );\n  React3.useLayoutEffect(() => router.subscribe(setState), [router, setState]);\n  React3.useEffect(() => {\n    if (vtContext.isTransitioning && !vtContext.flushSync) {\n      setRenderDfd(new Deferred());\n    }\n  }, [vtContext]);\n  React3.useEffect(() => {\n    if (renderDfd && pendingState && router.window) {\n      let newState = pendingState;\n      let renderPromise = renderDfd.promise;\n      let transition2 = router.window.document.startViewTransition(async () => {\n        React3.startTransition(() => logErrorsAndSetState(newState));\n        await renderPromise;\n      });\n      transition2.finished.finally(() => {\n        setRenderDfd(void 0);\n        setTransition(void 0);\n        setPendingState(void 0);\n        setVtContext({ isTransitioning: false });\n      });\n      setTransition(transition2);\n    }\n  }, [pendingState, renderDfd, router.window, logErrorsAndSetState]);\n  React3.useEffect(() => {\n    if (renderDfd && pendingState && state.location.key === pendingState.location.key) {\n      renderDfd.resolve();\n    }\n  }, [renderDfd, transition, state.location, pendingState]);\n  React3.useEffect(() => {\n    if (!vtContext.isTransitioning && interruption) {\n      setPendingState(interruption.state);\n      setVtContext({\n        isTransitioning: true,\n        flushSync: false,\n        currentLocation: interruption.currentLocation,\n        nextLocation: interruption.nextLocation\n      });\n      setInterruption(void 0);\n    }\n  }, [vtContext.isTransitioning, interruption]);\n  let navigator = React3.useMemo(() => {\n    return {\n      createHref: router.createHref,\n      encodeLocation: router.encodeLocation,\n      go: (n) => router.navigate(n),\n      push: (to, state2, opts) => router.navigate(to, {\n        state: state2,\n        preventScrollReset: opts?.preventScrollReset\n      }),\n      replace: (to, state2, opts) => router.navigate(to, {\n        replace: true,\n        state: state2,\n        preventScrollReset: opts?.preventScrollReset\n      })\n    };\n  }, [router]);\n  let basename = router.basename || \"/\";\n  let dataRouterContext = React3.useMemo(\n    () => ({\n      router,\n      navigator,\n      static: false,\n      basename,\n      unstable_onError\n    }),\n    [router, navigator, basename, unstable_onError]\n  );\n  return /* @__PURE__ */ React3.createElement(React3.Fragment, null, /* @__PURE__ */ React3.createElement(DataRouterContext.Provider, { value: dataRouterContext }, /* @__PURE__ */ React3.createElement(DataRouterStateContext.Provider, { value: state }, /* @__PURE__ */ React3.createElement(FetchersContext.Provider, { value: fetcherData.current }, /* @__PURE__ */ React3.createElement(ViewTransitionContext.Provider, { value: vtContext }, /* @__PURE__ */ React3.createElement(\n    Router,\n    {\n      basename,\n      location: state.location,\n      navigationType: state.historyAction,\n      navigator\n    },\n    /* @__PURE__ */ React3.createElement(\n      MemoizedDataRoutes,\n      {\n        routes: router.routes,\n        future: router.future,\n        state,\n        unstable_onError\n      }\n    )\n  ))))), null);\n}\nvar MemoizedDataRoutes = React3.memo(DataRoutes);\nfunction DataRoutes({\n  routes,\n  future,\n  state,\n  unstable_onError\n}) {\n  return useRoutesImpl(routes, void 0, state, unstable_onError, future);\n}\nfunction MemoryRouter({\n  basename,\n  children,\n  initialEntries,\n  initialIndex\n}) {\n  let historyRef = React3.useRef();\n  if (historyRef.current == null) {\n    historyRef.current = createMemoryHistory({\n      initialEntries,\n      initialIndex,\n      v5Compat: true\n    });\n  }\n  let history = historyRef.current;\n  let [state, setStateImpl] = React3.useState({\n    action: history.action,\n    location: history.location\n  });\n  let setState = React3.useCallback(\n    (newState) => {\n      React3.startTransition(() => setStateImpl(newState));\n    },\n    [setStateImpl]\n  );\n  React3.useLayoutEffect(() => history.listen(setState), [history, setState]);\n  return /* @__PURE__ */ React3.createElement(\n    Router,\n    {\n      basename,\n      children,\n      location: state.location,\n      navigationType: state.action,\n      navigator: history\n    }\n  );\n}\nfunction Navigate({\n  to,\n  replace: replace2,\n  state,\n  relative\n}) {\n  invariant(\n    useInRouterContext(),\n    // TODO: This error is probably because they somehow have 2 versions of\n    // the router loaded. We can help them understand how to avoid that.\n    `<Navigate> may be used only in the context of a <Router> component.`\n  );\n  let { static: isStatic } = React3.useContext(NavigationContext);\n  warning(\n    !isStatic,\n    `<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.`\n  );\n  let { matches } = React3.useContext(RouteContext);\n  let { pathname: locationPathname } = useLocation();\n  let navigate = useNavigate();\n  let path = resolveTo(\n    to,\n    getResolveToMatches(matches),\n    locationPathname,\n    relative === \"path\"\n  );\n  let jsonPath = JSON.stringify(path);\n  React3.useEffect(() => {\n    navigate(JSON.parse(jsonPath), { replace: replace2, state, relative });\n  }, [navigate, jsonPath, relative, replace2, state]);\n  return null;\n}\nfunction Outlet(props) {\n  return useOutlet(props.context);\n}\nfunction Route(props) {\n  invariant(\n    false,\n    `A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.`\n  );\n}\nfunction Router({\n  basename: basenameProp = \"/\",\n  children = null,\n  location: locationProp,\n  navigationType = \"POP\" /* Pop */,\n  navigator,\n  static: staticProp = false\n}) {\n  invariant(\n    !useInRouterContext(),\n    `You cannot render a <Router> inside another <Router>. You should never have more than one in your app.`\n  );\n  let basename = basenameProp.replace(/^\\/*/, \"/\");\n  let navigationContext = React3.useMemo(\n    () => ({\n      basename,\n      navigator,\n      static: staticProp,\n      future: {}\n    }),\n    [basename, navigator, staticProp]\n  );\n  if (typeof locationProp === \"string\") {\n    locationProp = parsePath(locationProp);\n  }\n  let {\n    pathname = \"/\",\n    search = \"\",\n    hash = \"\",\n    state = null,\n    key = \"default\"\n  } = locationProp;\n  let locationContext = React3.useMemo(() => {\n    let trailingPathname = stripBasename(pathname, basename);\n    if (trailingPathname == null) {\n      return null;\n    }\n    return {\n      location: {\n        pathname: trailingPathname,\n        search,\n        hash,\n        state,\n        key\n      },\n      navigationType\n    };\n  }, [basename, pathname, search, hash, state, key, navigationType]);\n  warning(\n    locationContext != null,\n    `<Router basename=\"${basename}\"> is not able to match the URL \"${pathname}${search}${hash}\" because it does not start with the basename, so the <Router> won't render anything.`\n  );\n  if (locationContext == null) {\n    return null;\n  }\n  return /* @__PURE__ */ React3.createElement(NavigationContext.Provider, { value: navigationContext }, /* @__PURE__ */ React3.createElement(LocationContext.Provider, { children, value: locationContext }));\n}\nfunction Routes({\n  children,\n  location\n}) {\n  return useRoutes(createRoutesFromChildren(children), location);\n}\nfunction Await({\n  children,\n  errorElement,\n  resolve\n}) {\n  let dataRouterContext = React3.useContext(DataRouterContext);\n  let dataRouterStateContext = React3.useContext(DataRouterStateContext);\n  let onError = React3.useCallback(\n    (error, errorInfo) => {\n      if (dataRouterContext && dataRouterContext.unstable_onError && dataRouterStateContext) {\n        dataRouterContext.unstable_onError(error, {\n          location: dataRouterStateContext.location,\n          params: dataRouterStateContext.matches?.[0]?.params || {},\n          errorInfo\n        });\n      }\n    },\n    [dataRouterContext, dataRouterStateContext]\n  );\n  return /* @__PURE__ */ React3.createElement(\n    AwaitErrorBoundary,\n    {\n      resolve,\n      errorElement,\n      onError\n    },\n    /* @__PURE__ */ React3.createElement(ResolveAwait, null, children)\n  );\n}\nvar AwaitErrorBoundary = class extends React3.Component {\n  constructor(props) {\n    super(props);\n    this.state = { error: null };\n  }\n  static getDerivedStateFromError(error) {\n    return { error };\n  }\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    } else {\n      console.error(\n        \"<Await> caught the following error during render\",\n        error,\n        errorInfo\n      );\n    }\n  }\n  render() {\n    let { children, errorElement, resolve } = this.props;\n    let promise = null;\n    let status = 0 /* pending */;\n    if (!(resolve instanceof Promise)) {\n      status = 1 /* success */;\n      promise = Promise.resolve();\n      Object.defineProperty(promise, \"_tracked\", { get: () => true });\n      Object.defineProperty(promise, \"_data\", { get: () => resolve });\n    } else if (this.state.error) {\n      status = 2 /* error */;\n      let renderError = this.state.error;\n      promise = Promise.reject().catch(() => {\n      });\n      Object.defineProperty(promise, \"_tracked\", { get: () => true });\n      Object.defineProperty(promise, \"_error\", { get: () => renderError });\n    } else if (resolve._tracked) {\n      promise = resolve;\n      status = \"_error\" in promise ? 2 /* error */ : \"_data\" in promise ? 1 /* success */ : 0 /* pending */;\n    } else {\n      status = 0 /* pending */;\n      Object.defineProperty(resolve, \"_tracked\", { get: () => true });\n      promise = resolve.then(\n        (data2) => Object.defineProperty(resolve, \"_data\", { get: () => data2 }),\n        (error) => {\n          this.props.onError?.(error);\n          Object.defineProperty(resolve, \"_error\", { get: () => error });\n        }\n      );\n    }\n    if (status === 2 /* error */ && !errorElement) {\n      throw promise._error;\n    }\n    if (status === 2 /* error */) {\n      return /* @__PURE__ */ React3.createElement(AwaitContext.Provider, { value: promise, children: errorElement });\n    }\n    if (status === 1 /* success */) {\n      return /* @__PURE__ */ React3.createElement(AwaitContext.Provider, { value: promise, children });\n    }\n    throw promise;\n  }\n};\nfunction ResolveAwait({\n  children\n}) {\n  let data2 = useAsyncValue();\n  let toRender = typeof children === \"function\" ? children(data2) : children;\n  return /* @__PURE__ */ React3.createElement(React3.Fragment, null, toRender);\n}\nfunction createRoutesFromChildren(children, parentPath = []) {\n  let routes = [];\n  React3.Children.forEach(children, (element, index) => {\n    if (!React3.isValidElement(element)) {\n      return;\n    }\n    let treePath = [...parentPath, index];\n    if (element.type === React3.Fragment) {\n      routes.push.apply(\n        routes,\n        createRoutesFromChildren(element.props.children, treePath)\n      );\n      return;\n    }\n    invariant(\n      element.type === Route,\n      `[${typeof element.type === \"string\" ? element.type : element.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`\n    );\n    invariant(\n      !element.props.index || !element.props.children,\n      \"An index route cannot have child routes.\"\n    );\n    let route = {\n      id: element.props.id || treePath.join(\"-\"),\n      caseSensitive: element.props.caseSensitive,\n      element: element.props.element,\n      Component: element.props.Component,\n      index: element.props.index,\n      path: element.props.path,\n      middleware: element.props.middleware,\n      loader: element.props.loader,\n      action: element.props.action,\n      hydrateFallbackElement: element.props.hydrateFallbackElement,\n      HydrateFallback: element.props.HydrateFallback,\n      errorElement: element.props.errorElement,\n      ErrorBoundary: element.props.ErrorBoundary,\n      hasErrorBoundary: element.props.hasErrorBoundary === true || element.props.ErrorBoundary != null || element.props.errorElement != null,\n      shouldRevalidate: element.props.shouldRevalidate,\n      handle: element.props.handle,\n      lazy: element.props.lazy\n    };\n    if (element.props.children) {\n      route.children = createRoutesFromChildren(\n        element.props.children,\n        treePath\n      );\n    }\n    routes.push(route);\n  });\n  return routes;\n}\nvar createRoutesFromElements = createRoutesFromChildren;\nfunction renderMatches(matches) {\n  return _renderMatches(matches);\n}\nfunction useRouteComponentProps() {\n  return {\n    params: useParams(),\n    loaderData: useLoaderData(),\n    actionData: useActionData(),\n    matches: useMatches()\n  };\n}\nfunction WithComponentProps({\n  children\n}) {\n  const props = useRouteComponentProps();\n  return React3.cloneElement(children, props);\n}\nfunction withComponentProps(Component4) {\n  return function WithComponentProps2() {\n    const props = useRouteComponentProps();\n    return React3.createElement(Component4, props);\n  };\n}\nfunction useHydrateFallbackProps() {\n  return {\n    params: useParams(),\n    loaderData: useLoaderData(),\n    actionData: useActionData()\n  };\n}\nfunction WithHydrateFallbackProps({\n  children\n}) {\n  const props = useHydrateFallbackProps();\n  return React3.cloneElement(children, props);\n}\nfunction withHydrateFallbackProps(HydrateFallback) {\n  return function WithHydrateFallbackProps2() {\n    const props = useHydrateFallbackProps();\n    return React3.createElement(HydrateFallback, props);\n  };\n}\nfunction useErrorBoundaryProps() {\n  return {\n    params: useParams(),\n    loaderData: useLoaderData(),\n    actionData: useActionData(),\n    error: useRouteError()\n  };\n}\nfunction WithErrorBoundaryProps({\n  children\n}) {\n  const props = useErrorBoundaryProps();\n  return React3.cloneElement(children, props);\n}\nfunction withErrorBoundaryProps(ErrorBoundary) {\n  return function WithErrorBoundaryProps2() {\n    const props = useErrorBoundaryProps();\n    return React3.createElement(ErrorBoundary, props);\n  };\n}\n\n// lib/dom/dom.ts\nvar defaultMethod = \"get\";\nvar defaultEncType = \"application/x-www-form-urlencoded\";\nfunction isHtmlElement(object) {\n  return object != null && typeof object.tagName === \"string\";\n}\nfunction isButtonElement(object) {\n  return isHtmlElement(object) && object.tagName.toLowerCase() === \"button\";\n}\nfunction isFormElement(object) {\n  return isHtmlElement(object) && object.tagName.toLowerCase() === \"form\";\n}\nfunction isInputElement(object) {\n  return isHtmlElement(object) && object.tagName.toLowerCase() === \"input\";\n}\nfunction isModifiedEvent(event) {\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\nfunction shouldProcessLinkClick(event, target) {\n  return event.button === 0 && // Ignore everything but left clicks\n  (!target || target === \"_self\") && // Let browser handle \"target=_blank\" etc.\n  !isModifiedEvent(event);\n}\nfunction createSearchParams(init = \"\") {\n  return new URLSearchParams(\n    typeof init === \"string\" || Array.isArray(init) || init instanceof URLSearchParams ? init : Object.keys(init).reduce((memo2, key) => {\n      let value = init[key];\n      return memo2.concat(\n        Array.isArray(value) ? value.map((v) => [key, v]) : [[key, value]]\n      );\n    }, [])\n  );\n}\nfunction getSearchParamsForLocation(locationSearch, defaultSearchParams) {\n  let searchParams = createSearchParams(locationSearch);\n  if (defaultSearchParams) {\n    defaultSearchParams.forEach((_, key) => {\n      if (!searchParams.has(key)) {\n        defaultSearchParams.getAll(key).forEach((value) => {\n          searchParams.append(key, value);\n        });\n      }\n    });\n  }\n  return searchParams;\n}\nvar _formDataSupportsSubmitter = null;\nfunction isFormDataSubmitterSupported() {\n  if (_formDataSupportsSubmitter === null) {\n    try {\n      new FormData(\n        document.createElement(\"form\"),\n        // @ts-expect-error if FormData supports the submitter parameter, this will throw\n        0\n      );\n      _formDataSupportsSubmitter = false;\n    } catch (e) {\n      _formDataSupportsSubmitter = true;\n    }\n  }\n  return _formDataSupportsSubmitter;\n}\nvar supportedFormEncTypes = /* @__PURE__ */ new Set([\n  \"application/x-www-form-urlencoded\",\n  \"multipart/form-data\",\n  \"text/plain\"\n]);\nfunction getFormEncType(encType) {\n  if (encType != null && !supportedFormEncTypes.has(encType)) {\n    warning(\n      false,\n      `\"${encType}\" is not a valid \\`encType\\` for \\`<Form>\\`/\\`<fetcher.Form>\\` and will default to \"${defaultEncType}\"`\n    );\n    return null;\n  }\n  return encType;\n}\nfunction getFormSubmissionInfo(target, basename) {\n  let method;\n  let action;\n  let encType;\n  let formData;\n  let body;\n  if (isFormElement(target)) {\n    let attr = target.getAttribute(\"action\");\n    action = attr ? stripBasename(attr, basename) : null;\n    method = target.getAttribute(\"method\") || defaultMethod;\n    encType = getFormEncType(target.getAttribute(\"enctype\")) || defaultEncType;\n    formData = new FormData(target);\n  } else if (isButtonElement(target) || isInputElement(target) && (target.type === \"submit\" || target.type === \"image\")) {\n    let form = target.form;\n    if (form == null) {\n      throw new Error(\n        `Cannot submit a <button> or <input type=\"submit\"> without a <form>`\n      );\n    }\n    let attr = target.getAttribute(\"formaction\") || form.getAttribute(\"action\");\n    action = attr ? stripBasename(attr, basename) : null;\n    method = target.getAttribute(\"formmethod\") || form.getAttribute(\"method\") || defaultMethod;\n    encType = getFormEncType(target.getAttribute(\"formenctype\")) || getFormEncType(form.getAttribute(\"enctype\")) || defaultEncType;\n    formData = new FormData(form, target);\n    if (!isFormDataSubmitterSupported()) {\n      let { name, type, value } = target;\n      if (type === \"image\") {\n        let prefix = name ? `${name}.` : \"\";\n        formData.append(`${prefix}x`, \"0\");\n        formData.append(`${prefix}y`, \"0\");\n      } else if (name) {\n        formData.append(name, value);\n      }\n    }\n  } else if (isHtmlElement(target)) {\n    throw new Error(\n      `Cannot submit element that is not <form>, <button>, or <input type=\"submit|image\">`\n    );\n  } else {\n    method = defaultMethod;\n    action = null;\n    encType = defaultEncType;\n    body = target;\n  }\n  if (formData && encType === \"text/plain\") {\n    body = formData;\n    formData = void 0;\n  }\n  return { action, method: method.toLowerCase(), encType, formData, body };\n}\n\n// lib/dom/ssr/single-fetch.tsx\nimport * as React4 from \"react\";\n\n// vendor/turbo-stream-v2/utils.ts\nvar HOLE = -1;\nvar NAN = -2;\nvar NEGATIVE_INFINITY = -3;\nvar NEGATIVE_ZERO = -4;\nvar NULL = -5;\nvar POSITIVE_INFINITY = -6;\nvar UNDEFINED = -7;\nvar TYPE_BIGINT = \"B\";\nvar TYPE_DATE = \"D\";\nvar TYPE_ERROR = \"E\";\nvar TYPE_MAP = \"M\";\nvar TYPE_NULL_OBJECT = \"N\";\nvar TYPE_PROMISE = \"P\";\nvar TYPE_REGEXP = \"R\";\nvar TYPE_SET = \"S\";\nvar TYPE_SYMBOL = \"Y\";\nvar TYPE_URL = \"U\";\nvar TYPE_PREVIOUS_RESOLVED = \"Z\";\nvar Deferred2 = class {\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n  }\n};\nfunction createLineSplittingTransform() {\n  const decoder = new TextDecoder();\n  let leftover = \"\";\n  return new TransformStream({\n    transform(chunk, controller) {\n      const str = decoder.decode(chunk, { stream: true });\n      const parts = (leftover + str).split(\"\\n\");\n      leftover = parts.pop() || \"\";\n      for (const part of parts) {\n        controller.enqueue(part);\n      }\n    },\n    flush(controller) {\n      if (leftover) {\n        controller.enqueue(leftover);\n      }\n    }\n  });\n}\n\n// vendor/turbo-stream-v2/flatten.ts\nfunction flatten(input) {\n  const { indices } = this;\n  const existing = indices.get(input);\n  if (existing) return [existing];\n  if (input === void 0) return UNDEFINED;\n  if (input === null) return NULL;\n  if (Number.isNaN(input)) return NAN;\n  if (input === Number.POSITIVE_INFINITY) return POSITIVE_INFINITY;\n  if (input === Number.NEGATIVE_INFINITY) return NEGATIVE_INFINITY;\n  if (input === 0 && 1 / input < 0) return NEGATIVE_ZERO;\n  const index = this.index++;\n  indices.set(input, index);\n  stringify.call(this, input, index);\n  return index;\n}\nfunction stringify(input, index) {\n  const { deferred, plugins, postPlugins } = this;\n  const str = this.stringified;\n  const stack = [[input, index]];\n  while (stack.length > 0) {\n    const [input2, index2] = stack.pop();\n    const partsForObj = (obj) => Object.keys(obj).map((k) => `\"_${flatten.call(this, k)}\":${flatten.call(this, obj[k])}`).join(\",\");\n    let error = null;\n    switch (typeof input2) {\n      case \"boolean\":\n      case \"number\":\n      case \"string\":\n        str[index2] = JSON.stringify(input2);\n        break;\n      case \"bigint\":\n        str[index2] = `[\"${TYPE_BIGINT}\",\"${input2}\"]`;\n        break;\n      case \"symbol\": {\n        const keyFor = Symbol.keyFor(input2);\n        if (!keyFor) {\n          error = new Error(\n            \"Cannot encode symbol unless created with Symbol.for()\"\n          );\n        } else {\n          str[index2] = `[\"${TYPE_SYMBOL}\",${JSON.stringify(keyFor)}]`;\n        }\n        break;\n      }\n      case \"object\": {\n        if (!input2) {\n          str[index2] = `${NULL}`;\n          break;\n        }\n        const isArray = Array.isArray(input2);\n        let pluginHandled = false;\n        if (!isArray && plugins) {\n          for (const plugin of plugins) {\n            const pluginResult = plugin(input2);\n            if (Array.isArray(pluginResult)) {\n              pluginHandled = true;\n              const [pluginIdentifier, ...rest] = pluginResult;\n              str[index2] = `[${JSON.stringify(pluginIdentifier)}`;\n              if (rest.length > 0) {\n                str[index2] += `,${rest.map((v) => flatten.call(this, v)).join(\",\")}`;\n              }\n              str[index2] += \"]\";\n              break;\n            }\n          }\n        }\n        if (!pluginHandled) {\n          let result = isArray ? \"[\" : \"{\";\n          if (isArray) {\n            for (let i = 0; i < input2.length; i++)\n              result += (i ? \",\" : \"\") + (i in input2 ? flatten.call(this, input2[i]) : HOLE);\n            str[index2] = `${result}]`;\n          } else if (input2 instanceof Date) {\n            const dateTime = input2.getTime();\n            str[index2] = `[\"${TYPE_DATE}\",${Number.isNaN(dateTime) ? JSON.stringify(\"invalid\") : dateTime}]`;\n          } else if (input2 instanceof URL) {\n            str[index2] = `[\"${TYPE_URL}\",${JSON.stringify(input2.href)}]`;\n          } else if (input2 instanceof RegExp) {\n            str[index2] = `[\"${TYPE_REGEXP}\",${JSON.stringify(\n              input2.source\n            )},${JSON.stringify(input2.flags)}]`;\n          } else if (input2 instanceof Set) {\n            if (input2.size > 0) {\n              str[index2] = `[\"${TYPE_SET}\",${[...input2].map((val) => flatten.call(this, val)).join(\",\")}]`;\n            } else {\n              str[index2] = `[\"${TYPE_SET}\"]`;\n            }\n          } else if (input2 instanceof Map) {\n            if (input2.size > 0) {\n              str[index2] = `[\"${TYPE_MAP}\",${[...input2].flatMap(([k, v]) => [\n                flatten.call(this, k),\n                flatten.call(this, v)\n              ]).join(\",\")}]`;\n            } else {\n              str[index2] = `[\"${TYPE_MAP}\"]`;\n            }\n          } else if (input2 instanceof Promise) {\n            str[index2] = `[\"${TYPE_PROMISE}\",${index2}]`;\n            deferred[index2] = input2;\n          } else if (input2 instanceof Error) {\n            str[index2] = `[\"${TYPE_ERROR}\",${JSON.stringify(input2.message)}`;\n            if (input2.name !== \"Error\") {\n              str[index2] += `,${JSON.stringify(input2.name)}`;\n            }\n            str[index2] += \"]\";\n          } else if (Object.getPrototypeOf(input2) === null) {\n            str[index2] = `[\"${TYPE_NULL_OBJECT}\",{${partsForObj(input2)}}]`;\n          } else if (isPlainObject2(input2)) {\n            str[index2] = `{${partsForObj(input2)}}`;\n          } else {\n            error = new Error(\"Cannot encode object with prototype\");\n          }\n        }\n        break;\n      }\n      default: {\n        const isArray = Array.isArray(input2);\n        let pluginHandled = false;\n        if (!isArray && plugins) {\n          for (const plugin of plugins) {\n            const pluginResult = plugin(input2);\n            if (Array.isArray(pluginResult)) {\n              pluginHandled = true;\n              const [pluginIdentifier, ...rest] = pluginResult;\n              str[index2] = `[${JSON.stringify(pluginIdentifier)}`;\n              if (rest.length > 0) {\n                str[index2] += `,${rest.map((v) => flatten.call(this, v)).join(\",\")}`;\n              }\n              str[index2] += \"]\";\n              break;\n            }\n          }\n        }\n        if (!pluginHandled) {\n          error = new Error(\"Cannot encode function or unexpected type\");\n        }\n      }\n    }\n    if (error) {\n      let pluginHandled = false;\n      if (postPlugins) {\n        for (const plugin of postPlugins) {\n          const pluginResult = plugin(input2);\n          if (Array.isArray(pluginResult)) {\n            pluginHandled = true;\n            const [pluginIdentifier, ...rest] = pluginResult;\n            str[index2] = `[${JSON.stringify(pluginIdentifier)}`;\n            if (rest.length > 0) {\n              str[index2] += `,${rest.map((v) => flatten.call(this, v)).join(\",\")}`;\n            }\n            str[index2] += \"]\";\n            break;\n          }\n        }\n      }\n      if (!pluginHandled) {\n        throw error;\n      }\n    }\n  }\n}\nvar objectProtoNames2 = Object.getOwnPropertyNames(Object.prototype).sort().join(\"\\0\");\nfunction isPlainObject2(thing) {\n  const proto = Object.getPrototypeOf(thing);\n  return proto === Object.prototype || proto === null || Object.getOwnPropertyNames(proto).sort().join(\"\\0\") === objectProtoNames2;\n}\n\n// vendor/turbo-stream-v2/unflatten.ts\nvar globalObj = typeof window !== \"undefined\" ? window : typeof globalThis !== \"undefined\" ? globalThis : void 0;\nfunction unflatten(parsed) {\n  const { hydrated, values } = this;\n  if (typeof parsed === \"number\") return hydrate.call(this, parsed);\n  if (!Array.isArray(parsed) || !parsed.length) throw new SyntaxError();\n  const startIndex = values.length;\n  for (const value of parsed) {\n    values.push(value);\n  }\n  hydrated.length = values.length;\n  return hydrate.call(this, startIndex);\n}\nfunction hydrate(index) {\n  const { hydrated, values, deferred, plugins } = this;\n  let result;\n  const stack = [\n    [\n      index,\n      (v) => {\n        result = v;\n      }\n    ]\n  ];\n  let postRun = [];\n  while (stack.length > 0) {\n    const [index2, set] = stack.pop();\n    switch (index2) {\n      case UNDEFINED:\n        set(void 0);\n        continue;\n      case NULL:\n        set(null);\n        continue;\n      case NAN:\n        set(NaN);\n        continue;\n      case POSITIVE_INFINITY:\n        set(Infinity);\n        continue;\n      case NEGATIVE_INFINITY:\n        set(-Infinity);\n        continue;\n      case NEGATIVE_ZERO:\n        set(-0);\n        continue;\n    }\n    if (hydrated[index2]) {\n      set(hydrated[index2]);\n      continue;\n    }\n    const value = values[index2];\n    if (!value || typeof value !== \"object\") {\n      hydrated[index2] = value;\n      set(value);\n      continue;\n    }\n    if (Array.isArray(value)) {\n      if (typeof value[0] === \"string\") {\n        const [type, b, c] = value;\n        switch (type) {\n          case TYPE_DATE:\n            set(hydrated[index2] = new Date(b));\n            continue;\n          case TYPE_URL:\n            set(hydrated[index2] = new URL(b));\n            continue;\n          case TYPE_BIGINT:\n            set(hydrated[index2] = BigInt(b));\n            continue;\n          case TYPE_REGEXP:\n            set(hydrated[index2] = new RegExp(b, c));\n            continue;\n          case TYPE_SYMBOL:\n            set(hydrated[index2] = Symbol.for(b));\n            continue;\n          case TYPE_SET:\n            const newSet = /* @__PURE__ */ new Set();\n            hydrated[index2] = newSet;\n            for (let i = value.length - 1; i > 0; i--)\n              stack.push([\n                value[i],\n                (v) => {\n                  newSet.add(v);\n                }\n              ]);\n            set(newSet);\n            continue;\n          case TYPE_MAP:\n            const map = /* @__PURE__ */ new Map();\n            hydrated[index2] = map;\n            for (let i = value.length - 2; i > 0; i -= 2) {\n              const r = [];\n              stack.push([\n                value[i + 1],\n                (v) => {\n                  r[1] = v;\n                }\n              ]);\n              stack.push([\n                value[i],\n                (k) => {\n                  r[0] = k;\n                }\n              ]);\n              postRun.push(() => {\n                map.set(r[0], r[1]);\n              });\n            }\n            set(map);\n            continue;\n          case TYPE_NULL_OBJECT:\n            const obj = /* @__PURE__ */ Object.create(null);\n            hydrated[index2] = obj;\n            for (const key of Object.keys(b).reverse()) {\n              const r = [];\n              stack.push([\n                b[key],\n                (v) => {\n                  r[1] = v;\n                }\n              ]);\n              stack.push([\n                Number(key.slice(1)),\n                (k) => {\n                  r[0] = k;\n                }\n              ]);\n              postRun.push(() => {\n                obj[r[0]] = r[1];\n              });\n            }\n            set(obj);\n            continue;\n          case TYPE_PROMISE:\n            if (hydrated[b]) {\n              set(hydrated[index2] = hydrated[b]);\n            } else {\n              const d = new Deferred2();\n              deferred[b] = d;\n              set(hydrated[index2] = d.promise);\n            }\n            continue;\n          case TYPE_ERROR:\n            const [, message, errorType] = value;\n            let error = errorType && globalObj && globalObj[errorType] ? new globalObj[errorType](message) : new Error(message);\n            hydrated[index2] = error;\n            set(error);\n            continue;\n          case TYPE_PREVIOUS_RESOLVED:\n            set(hydrated[index2] = hydrated[b]);\n            continue;\n          default:\n            if (Array.isArray(plugins)) {\n              const r = [];\n              const vals = value.slice(1);\n              for (let i = 0; i < vals.length; i++) {\n                const v = vals[i];\n                stack.push([\n                  v,\n                  (v2) => {\n                    r[i] = v2;\n                  }\n                ]);\n              }\n              postRun.push(() => {\n                for (const plugin of plugins) {\n                  const result2 = plugin(value[0], ...r);\n                  if (result2) {\n                    set(hydrated[index2] = result2.value);\n                    return;\n                  }\n                }\n                throw new SyntaxError();\n              });\n              continue;\n            }\n            throw new SyntaxError();\n        }\n      } else {\n        const array = [];\n        hydrated[index2] = array;\n        for (let i = 0; i < value.length; i++) {\n          const n = value[i];\n          if (n !== HOLE) {\n            stack.push([\n              n,\n              (v) => {\n                array[i] = v;\n              }\n            ]);\n          }\n        }\n        set(array);\n        continue;\n      }\n    } else {\n      const object = {};\n      hydrated[index2] = object;\n      for (const key of Object.keys(value).reverse()) {\n        const r = [];\n        stack.push([\n          value[key],\n          (v) => {\n            r[1] = v;\n          }\n        ]);\n        stack.push([\n          Number(key.slice(1)),\n          (k) => {\n            r[0] = k;\n          }\n        ]);\n        postRun.push(() => {\n          object[r[0]] = r[1];\n        });\n      }\n      set(object);\n      continue;\n    }\n  }\n  while (postRun.length > 0) {\n    postRun.pop()();\n  }\n  return result;\n}\n\n// vendor/turbo-stream-v2/turbo-stream.ts\nasync function decode(readable, options) {\n  const { plugins } = options ?? {};\n  const done = new Deferred2();\n  const reader = readable.pipeThrough(createLineSplittingTransform()).getReader();\n  const decoder = {\n    values: [],\n    hydrated: [],\n    deferred: {},\n    plugins\n  };\n  const decoded = await decodeInitial.call(decoder, reader);\n  let donePromise = done.promise;\n  if (decoded.done) {\n    done.resolve();\n  } else {\n    donePromise = decodeDeferred.call(decoder, reader).then(done.resolve).catch((reason) => {\n      for (const deferred of Object.values(decoder.deferred)) {\n        deferred.reject(reason);\n      }\n      done.reject(reason);\n    });\n  }\n  return {\n    done: donePromise.then(() => reader.closed),\n    value: decoded.value\n  };\n}\nasync function decodeInitial(reader) {\n  const read = await reader.read();\n  if (!read.value) {\n    throw new SyntaxError();\n  }\n  let line;\n  try {\n    line = JSON.parse(read.value);\n  } catch (reason) {\n    throw new SyntaxError();\n  }\n  return {\n    done: read.done,\n    value: unflatten.call(this, line)\n  };\n}\nasync function decodeDeferred(reader) {\n  let read = await reader.read();\n  while (!read.done) {\n    if (!read.value) continue;\n    const line = read.value;\n    switch (line[0]) {\n      case TYPE_PROMISE: {\n        const colonIndex = line.indexOf(\":\");\n        const deferredId = Number(line.slice(1, colonIndex));\n        const deferred = this.deferred[deferredId];\n        if (!deferred) {\n          throw new Error(`Deferred ID ${deferredId} not found in stream`);\n        }\n        const lineData = line.slice(colonIndex + 1);\n        let jsonLine;\n        try {\n          jsonLine = JSON.parse(lineData);\n        } catch (reason) {\n          throw new SyntaxError();\n        }\n        const value = unflatten.call(this, jsonLine);\n        deferred.resolve(value);\n        break;\n      }\n      case TYPE_ERROR: {\n        const colonIndex = line.indexOf(\":\");\n        const deferredId = Number(line.slice(1, colonIndex));\n        const deferred = this.deferred[deferredId];\n        if (!deferred) {\n          throw new Error(`Deferred ID ${deferredId} not found in stream`);\n        }\n        const lineData = line.slice(colonIndex + 1);\n        let jsonLine;\n        try {\n          jsonLine = JSON.parse(lineData);\n        } catch (reason) {\n          throw new SyntaxError();\n        }\n        const value = unflatten.call(this, jsonLine);\n        deferred.reject(value);\n        break;\n      }\n      default:\n        throw new SyntaxError();\n    }\n    read = await reader.read();\n  }\n}\nfunction encode(input, options) {\n  const { plugins, postPlugins, signal } = options ?? {};\n  const encoder = {\n    deferred: {},\n    index: 0,\n    indices: /* @__PURE__ */ new Map(),\n    stringified: [],\n    plugins,\n    postPlugins,\n    signal\n  };\n  const textEncoder = new TextEncoder();\n  let lastSentIndex = 0;\n  const readable = new ReadableStream({\n    async start(controller) {\n      const id = flatten.call(encoder, input);\n      if (Array.isArray(id)) {\n        throw new Error(\"This should never happen\");\n      }\n      if (id < 0) {\n        controller.enqueue(textEncoder.encode(`${id}\n`));\n      } else {\n        controller.enqueue(\n          textEncoder.encode(`[${encoder.stringified.join(\",\")}]\n`)\n        );\n        lastSentIndex = encoder.stringified.length - 1;\n      }\n      const seenPromises = /* @__PURE__ */ new WeakSet();\n      if (Object.keys(encoder.deferred).length) {\n        let raceDone;\n        const racePromise = new Promise((resolve, reject) => {\n          raceDone = resolve;\n          if (signal) {\n            const rejectPromise = () => reject(signal.reason || new Error(\"Signal was aborted.\"));\n            if (signal.aborted) {\n              rejectPromise();\n            } else {\n              signal.addEventListener(\"abort\", (event) => {\n                rejectPromise();\n              });\n            }\n          }\n        });\n        while (Object.keys(encoder.deferred).length > 0) {\n          for (const [deferredId, deferred] of Object.entries(\n            encoder.deferred\n          )) {\n            if (seenPromises.has(deferred)) continue;\n            seenPromises.add(\n              // biome-ignore lint/suspicious/noAssignInExpressions: <explanation>\n              encoder.deferred[Number(deferredId)] = Promise.race([\n                racePromise,\n                deferred\n              ]).then(\n                (resolved) => {\n                  const id2 = flatten.call(encoder, resolved);\n                  if (Array.isArray(id2)) {\n                    controller.enqueue(\n                      textEncoder.encode(\n                        `${TYPE_PROMISE}${deferredId}:[[\"${TYPE_PREVIOUS_RESOLVED}\",${id2[0]}]]\n`\n                      )\n                    );\n                    encoder.index++;\n                    lastSentIndex++;\n                  } else if (id2 < 0) {\n                    controller.enqueue(\n                      textEncoder.encode(\n                        `${TYPE_PROMISE}${deferredId}:${id2}\n`\n                      )\n                    );\n                  } else {\n                    const values = encoder.stringified.slice(lastSentIndex + 1).join(\",\");\n                    controller.enqueue(\n                      textEncoder.encode(\n                        `${TYPE_PROMISE}${deferredId}:[${values}]\n`\n                      )\n                    );\n                    lastSentIndex = encoder.stringified.length - 1;\n                  }\n                },\n                (reason) => {\n                  if (!reason || typeof reason !== \"object\" || !(reason instanceof Error)) {\n                    reason = new Error(\"An unknown error occurred\");\n                  }\n                  const id2 = flatten.call(encoder, reason);\n                  if (Array.isArray(id2)) {\n                    controller.enqueue(\n                      textEncoder.encode(\n                        `${TYPE_ERROR}${deferredId}:[[\"${TYPE_PREVIOUS_RESOLVED}\",${id2[0]}]]\n`\n                      )\n                    );\n                    encoder.index++;\n                    lastSentIndex++;\n                  } else if (id2 < 0) {\n                    controller.enqueue(\n                      textEncoder.encode(\n                        `${TYPE_ERROR}${deferredId}:${id2}\n`\n                      )\n                    );\n                  } else {\n                    const values = encoder.stringified.slice(lastSentIndex + 1).join(\",\");\n                    controller.enqueue(\n                      textEncoder.encode(\n                        `${TYPE_ERROR}${deferredId}:[${values}]\n`\n                      )\n                    );\n                    lastSentIndex = encoder.stringified.length - 1;\n                  }\n                }\n              ).finally(() => {\n                delete encoder.deferred[Number(deferredId)];\n              })\n            );\n          }\n          await Promise.race(Object.values(encoder.deferred));\n        }\n        raceDone();\n      }\n      await Promise.all(Object.values(encoder.deferred));\n      controller.close();\n    }\n  });\n  return readable;\n}\n\n// lib/dom/ssr/data.ts\nasync function createRequestInit(request) {\n  let init = { signal: request.signal };\n  if (request.method !== \"GET\") {\n    init.method = request.method;\n    let contentType = request.headers.get(\"Content-Type\");\n    if (contentType && /\\bapplication\\/json\\b/.test(contentType)) {\n      init.headers = { \"Content-Type\": contentType };\n      init.body = JSON.stringify(await request.json());\n    } else if (contentType && /\\btext\\/plain\\b/.test(contentType)) {\n      init.headers = { \"Content-Type\": contentType };\n      init.body = await request.text();\n    } else if (contentType && /\\bapplication\\/x-www-form-urlencoded\\b/.test(contentType)) {\n      init.body = new URLSearchParams(await request.text());\n    } else {\n      init.body = await request.formData();\n    }\n  }\n  return init;\n}\n\n// lib/dom/ssr/markup.ts\nvar ESCAPE_LOOKUP = {\n  \"&\": \"\\\\u0026\",\n  \">\": \"\\\\u003e\",\n  \"<\": \"\\\\u003c\",\n  \"\\u2028\": \"\\\\u2028\",\n  \"\\u2029\": \"\\\\u2029\"\n};\nvar ESCAPE_REGEX = /[&><\\u2028\\u2029]/g;\nfunction escapeHtml(html) {\n  return html.replace(ESCAPE_REGEX, (match) => ESCAPE_LOOKUP[match]);\n}\n\n// lib/dom/ssr/invariant.ts\nfunction invariant2(value, message) {\n  if (value === false || value === null || typeof value === \"undefined\") {\n    throw new Error(message);\n  }\n}\n\n// lib/dom/ssr/single-fetch.tsx\nvar SingleFetchRedirectSymbol = Symbol(\"SingleFetchRedirect\");\nvar SingleFetchNoResultError = class extends Error {\n};\nvar SINGLE_FETCH_REDIRECT_STATUS = 202;\nvar NO_BODY_STATUS_CODES = /* @__PURE__ */ new Set([100, 101, 204, 205]);\nfunction StreamTransfer({\n  context,\n  identifier,\n  reader,\n  textDecoder,\n  nonce\n}) {\n  if (!context.renderMeta || !context.renderMeta.didRenderScripts) {\n    return null;\n  }\n  if (!context.renderMeta.streamCache) {\n    context.renderMeta.streamCache = {};\n  }\n  let { streamCache } = context.renderMeta;\n  let promise = streamCache[identifier];\n  if (!promise) {\n    promise = streamCache[identifier] = reader.read().then((result) => {\n      streamCache[identifier].result = {\n        done: result.done,\n        value: textDecoder.decode(result.value, { stream: true })\n      };\n    }).catch((e) => {\n      streamCache[identifier].error = e;\n    });\n  }\n  if (promise.error) {\n    throw promise.error;\n  }\n  if (promise.result === void 0) {\n    throw promise;\n  }\n  let { done, value } = promise.result;\n  let scriptTag = value ? /* @__PURE__ */ React4.createElement(\n    \"script\",\n    {\n      nonce,\n      dangerouslySetInnerHTML: {\n        __html: `window.__reactRouterContext.streamController.enqueue(${escapeHtml(\n          JSON.stringify(value)\n        )});`\n      }\n    }\n  ) : null;\n  if (done) {\n    return /* @__PURE__ */ React4.createElement(React4.Fragment, null, scriptTag, /* @__PURE__ */ React4.createElement(\n      \"script\",\n      {\n        nonce,\n        dangerouslySetInnerHTML: {\n          __html: `window.__reactRouterContext.streamController.close();`\n        }\n      }\n    ));\n  } else {\n    return /* @__PURE__ */ React4.createElement(React4.Fragment, null, scriptTag, /* @__PURE__ */ React4.createElement(React4.Suspense, null, /* @__PURE__ */ React4.createElement(\n      StreamTransfer,\n      {\n        context,\n        identifier: identifier + 1,\n        reader,\n        textDecoder,\n        nonce\n      }\n    )));\n  }\n}\nfunction getTurboStreamSingleFetchDataStrategy(getRouter, manifest, routeModules, ssr, basename) {\n  let dataStrategy = getSingleFetchDataStrategyImpl(\n    getRouter,\n    (match) => {\n      let manifestRoute = manifest.routes[match.route.id];\n      invariant2(manifestRoute, \"Route not found in manifest\");\n      let routeModule = routeModules[match.route.id];\n      return {\n        hasLoader: manifestRoute.hasLoader,\n        hasClientLoader: manifestRoute.hasClientLoader,\n        hasShouldRevalidate: Boolean(routeModule?.shouldRevalidate)\n      };\n    },\n    fetchAndDecodeViaTurboStream,\n    ssr,\n    basename\n  );\n  return async (args) => args.runClientMiddleware(dataStrategy);\n}\nfunction getSingleFetchDataStrategyImpl(getRouter, getRouteInfo, fetchAndDecode, ssr, basename, shouldAllowOptOut = () => true) {\n  return async (args) => {\n    let { request, matches, fetcherKey } = args;\n    let router = getRouter();\n    if (request.method !== \"GET\") {\n      return singleFetchActionStrategy(args, fetchAndDecode, basename);\n    }\n    let foundRevalidatingServerLoader = matches.some((m) => {\n      let { hasLoader, hasClientLoader } = getRouteInfo(m);\n      return m.unstable_shouldCallHandler() && hasLoader && !hasClientLoader;\n    });\n    if (!ssr && !foundRevalidatingServerLoader) {\n      return nonSsrStrategy(args, getRouteInfo, fetchAndDecode, basename);\n    }\n    if (fetcherKey) {\n      return singleFetchLoaderFetcherStrategy(args, fetchAndDecode, basename);\n    }\n    return singleFetchLoaderNavigationStrategy(\n      args,\n      router,\n      getRouteInfo,\n      fetchAndDecode,\n      ssr,\n      basename,\n      shouldAllowOptOut\n    );\n  };\n}\nasync function singleFetchActionStrategy(args, fetchAndDecode, basename) {\n  let actionMatch = args.matches.find((m) => m.unstable_shouldCallHandler());\n  invariant2(actionMatch, \"No action match found\");\n  let actionStatus = void 0;\n  let result = await actionMatch.resolve(async (handler) => {\n    let result2 = await handler(async () => {\n      let { data: data2, status } = await fetchAndDecode(args, basename, [\n        actionMatch.route.id\n      ]);\n      actionStatus = status;\n      return unwrapSingleFetchResult(data2, actionMatch.route.id);\n    });\n    return result2;\n  });\n  if (isResponse(result.result) || isRouteErrorResponse(result.result) || isDataWithResponseInit(result.result)) {\n    return { [actionMatch.route.id]: result };\n  }\n  return {\n    [actionMatch.route.id]: {\n      type: result.type,\n      result: data(result.result, actionStatus)\n    }\n  };\n}\nasync function nonSsrStrategy(args, getRouteInfo, fetchAndDecode, basename) {\n  let matchesToLoad = args.matches.filter(\n    (m) => m.unstable_shouldCallHandler()\n  );\n  let results = {};\n  await Promise.all(\n    matchesToLoad.map(\n      (m) => m.resolve(async (handler) => {\n        try {\n          let { hasClientLoader } = getRouteInfo(m);\n          let routeId = m.route.id;\n          let result = hasClientLoader ? await handler(async () => {\n            let { data: data2 } = await fetchAndDecode(args, basename, [routeId]);\n            return unwrapSingleFetchResult(data2, routeId);\n          }) : await handler();\n          results[m.route.id] = { type: \"data\", result };\n        } catch (e) {\n          results[m.route.id] = { type: \"error\", result: e };\n        }\n      })\n    )\n  );\n  return results;\n}\nasync function singleFetchLoaderNavigationStrategy(args, router, getRouteInfo, fetchAndDecode, ssr, basename, shouldAllowOptOut = () => true) {\n  let routesParams = /* @__PURE__ */ new Set();\n  let foundOptOutRoute = false;\n  let routeDfds = args.matches.map(() => createDeferred2());\n  let singleFetchDfd = createDeferred2();\n  let results = {};\n  let resolvePromise = Promise.all(\n    args.matches.map(\n      async (m, i) => m.resolve(async (handler) => {\n        routeDfds[i].resolve();\n        let routeId = m.route.id;\n        let { hasLoader, hasClientLoader, hasShouldRevalidate } = getRouteInfo(m);\n        let defaultShouldRevalidate = !m.unstable_shouldRevalidateArgs || m.unstable_shouldRevalidateArgs.actionStatus == null || m.unstable_shouldRevalidateArgs.actionStatus < 400;\n        let shouldCall = m.unstable_shouldCallHandler(defaultShouldRevalidate);\n        if (!shouldCall) {\n          foundOptOutRoute || (foundOptOutRoute = m.unstable_shouldRevalidateArgs != null && // This is a revalidation,\n          hasLoader && // for a route with a server loader,\n          hasShouldRevalidate === true);\n          return;\n        }\n        if (shouldAllowOptOut(m) && hasClientLoader) {\n          if (hasLoader) {\n            foundOptOutRoute = true;\n          }\n          try {\n            let result = await handler(async () => {\n              let { data: data2 } = await fetchAndDecode(args, basename, [routeId]);\n              return unwrapSingleFetchResult(data2, routeId);\n            });\n            results[routeId] = { type: \"data\", result };\n          } catch (e) {\n            results[routeId] = { type: \"error\", result: e };\n          }\n          return;\n        }\n        if (hasLoader) {\n          routesParams.add(routeId);\n        }\n        try {\n          let result = await handler(async () => {\n            let data2 = await singleFetchDfd.promise;\n            return unwrapSingleFetchResult(data2, routeId);\n          });\n          results[routeId] = { type: \"data\", result };\n        } catch (e) {\n          results[routeId] = { type: \"error\", result: e };\n        }\n      })\n    )\n  );\n  await Promise.all(routeDfds.map((d) => d.promise));\n  let isInitialLoad = !router.state.initialized && router.state.navigation.state === \"idle\";\n  if ((isInitialLoad || routesParams.size === 0) && !window.__reactRouterHdrActive) {\n    singleFetchDfd.resolve({ routes: {} });\n  } else {\n    let targetRoutes = ssr && foundOptOutRoute && routesParams.size > 0 ? [...routesParams.keys()] : void 0;\n    try {\n      let data2 = await fetchAndDecode(args, basename, targetRoutes);\n      singleFetchDfd.resolve(data2.data);\n    } catch (e) {\n      singleFetchDfd.reject(e);\n    }\n  }\n  await resolvePromise;\n  await bubbleMiddlewareErrors(\n    singleFetchDfd.promise,\n    args.matches,\n    routesParams,\n    results\n  );\n  return results;\n}\nasync function bubbleMiddlewareErrors(singleFetchPromise, matches, routesParams, results) {\n  try {\n    let middlewareError;\n    let fetchedData = await singleFetchPromise;\n    if (\"routes\" in fetchedData) {\n      for (let match of matches) {\n        if (match.route.id in fetchedData.routes) {\n          let routeResult = fetchedData.routes[match.route.id];\n          if (\"error\" in routeResult) {\n            middlewareError = routeResult.error;\n            if (results[match.route.id]?.result == null) {\n              results[match.route.id] = {\n                type: \"error\",\n                result: middlewareError\n              };\n            }\n            break;\n          }\n        }\n      }\n    }\n    if (middlewareError !== void 0) {\n      Array.from(routesParams.values()).forEach((routeId) => {\n        if (results[routeId].result instanceof SingleFetchNoResultError) {\n          results[routeId].result = middlewareError;\n        }\n      });\n    }\n  } catch (e) {\n  }\n}\nasync function singleFetchLoaderFetcherStrategy(args, fetchAndDecode, basename) {\n  let fetcherMatch = args.matches.find((m) => m.unstable_shouldCallHandler());\n  invariant2(fetcherMatch, \"No fetcher match found\");\n  let routeId = fetcherMatch.route.id;\n  let result = await fetcherMatch.resolve(\n    async (handler) => handler(async () => {\n      let { data: data2 } = await fetchAndDecode(args, basename, [routeId]);\n      return unwrapSingleFetchResult(data2, routeId);\n    })\n  );\n  return { [fetcherMatch.route.id]: result };\n}\nfunction stripIndexParam(url) {\n  let indexValues = url.searchParams.getAll(\"index\");\n  url.searchParams.delete(\"index\");\n  let indexValuesToKeep = [];\n  for (let indexValue of indexValues) {\n    if (indexValue) {\n      indexValuesToKeep.push(indexValue);\n    }\n  }\n  for (let toKeep of indexValuesToKeep) {\n    url.searchParams.append(\"index\", toKeep);\n  }\n  return url;\n}\nfunction singleFetchUrl(reqUrl, basename, extension) {\n  let url = typeof reqUrl === \"string\" ? new URL(\n    reqUrl,\n    // This can be called during the SSR flow via PrefetchPageLinksImpl so\n    // don't assume window is available\n    typeof window === \"undefined\" ? \"server://singlefetch/\" : window.location.origin\n  ) : reqUrl;\n  if (url.pathname === \"/\") {\n    url.pathname = `_root.${extension}`;\n  } else if (basename && stripBasename(url.pathname, basename) === \"/\") {\n    url.pathname = `${basename.replace(/\\/$/, \"\")}/_root.${extension}`;\n  } else {\n    url.pathname = `${url.pathname.replace(/\\/$/, \"\")}.${extension}`;\n  }\n  return url;\n}\nasync function fetchAndDecodeViaTurboStream(args, basename, targetRoutes) {\n  let { request } = args;\n  let url = singleFetchUrl(request.url, basename, \"data\");\n  if (request.method === \"GET\") {\n    url = stripIndexParam(url);\n    if (targetRoutes) {\n      url.searchParams.set(\"_routes\", targetRoutes.join(\",\"));\n    }\n  }\n  let res = await fetch(url, await createRequestInit(request));\n  if (res.status >= 400 && !res.headers.has(\"X-Remix-Response\")) {\n    throw new ErrorResponseImpl(res.status, res.statusText, await res.text());\n  }\n  if (res.status === 204 && res.headers.has(\"X-Remix-Redirect\")) {\n    return {\n      status: SINGLE_FETCH_REDIRECT_STATUS,\n      data: {\n        redirect: {\n          redirect: res.headers.get(\"X-Remix-Redirect\"),\n          status: Number(res.headers.get(\"X-Remix-Status\") || \"302\"),\n          revalidate: res.headers.get(\"X-Remix-Revalidate\") === \"true\",\n          reload: res.headers.get(\"X-Remix-Reload-Document\") === \"true\",\n          replace: res.headers.get(\"X-Remix-Replace\") === \"true\"\n        }\n      }\n    };\n  }\n  if (NO_BODY_STATUS_CODES.has(res.status)) {\n    let routes = {};\n    if (targetRoutes && request.method !== \"GET\") {\n      routes[targetRoutes[0]] = { data: void 0 };\n    }\n    return {\n      status: res.status,\n      data: { routes }\n    };\n  }\n  invariant2(res.body, \"No response body to decode\");\n  try {\n    let decoded = await decodeViaTurboStream(res.body, window);\n    let data2;\n    if (request.method === \"GET\") {\n      let typed = decoded.value;\n      if (SingleFetchRedirectSymbol in typed) {\n        data2 = { redirect: typed[SingleFetchRedirectSymbol] };\n      } else {\n        data2 = { routes: typed };\n      }\n    } else {\n      let typed = decoded.value;\n      let routeId = targetRoutes?.[0];\n      invariant2(routeId, \"No routeId found for single fetch call decoding\");\n      if (\"redirect\" in typed) {\n        data2 = { redirect: typed };\n      } else {\n        data2 = { routes: { [routeId]: typed } };\n      }\n    }\n    return { status: res.status, data: data2 };\n  } catch (e) {\n    throw new Error(\"Unable to decode turbo-stream response\");\n  }\n}\nfunction decodeViaTurboStream(body, global) {\n  return decode(body, {\n    plugins: [\n      (type, ...rest) => {\n        if (type === \"SanitizedError\") {\n          let [name, message, stack] = rest;\n          let Constructor = Error;\n          if (name && name in global && typeof global[name] === \"function\") {\n            Constructor = global[name];\n          }\n          let error = new Constructor(message);\n          error.stack = stack;\n          return { value: error };\n        }\n        if (type === \"ErrorResponse\") {\n          let [data2, status, statusText] = rest;\n          return {\n            value: new ErrorResponseImpl(status, statusText, data2)\n          };\n        }\n        if (type === \"SingleFetchRedirect\") {\n          return { value: { [SingleFetchRedirectSymbol]: rest[0] } };\n        }\n        if (type === \"SingleFetchClassInstance\") {\n          return { value: rest[0] };\n        }\n        if (type === \"SingleFetchFallback\") {\n          return { value: void 0 };\n        }\n      }\n    ]\n  });\n}\nfunction unwrapSingleFetchResult(result, routeId) {\n  if (\"redirect\" in result) {\n    let {\n      redirect: location,\n      revalidate,\n      reload,\n      replace: replace2,\n      status\n    } = result.redirect;\n    throw redirect(location, {\n      status,\n      headers: {\n        // Three R's of redirecting (lol Veep)\n        ...revalidate ? { \"X-Remix-Revalidate\": \"yes\" } : null,\n        ...reload ? { \"X-Remix-Reload-Document\": \"yes\" } : null,\n        ...replace2 ? { \"X-Remix-Replace\": \"yes\" } : null\n      }\n    });\n  }\n  let routeResult = result.routes[routeId];\n  if (routeResult == null) {\n    throw new SingleFetchNoResultError(\n      `No result found for routeId \"${routeId}\"`\n    );\n  } else if (\"error\" in routeResult) {\n    throw routeResult.error;\n  } else if (\"data\" in routeResult) {\n    return routeResult.data;\n  } else {\n    throw new Error(`Invalid response found for routeId \"${routeId}\"`);\n  }\n}\nfunction createDeferred2() {\n  let resolve;\n  let reject;\n  let promise = new Promise((res, rej) => {\n    resolve = async (val) => {\n      res(val);\n      try {\n        await promise;\n      } catch (e) {\n      }\n    };\n    reject = async (error) => {\n      rej(error);\n      try {\n        await promise;\n      } catch (e) {\n      }\n    };\n  });\n  return {\n    promise,\n    //@ts-ignore\n    resolve,\n    //@ts-ignore\n    reject\n  };\n}\n\n// lib/dom/ssr/errorBoundaries.tsx\nimport * as React9 from \"react\";\n\n// lib/dom/ssr/components.tsx\nimport * as React8 from \"react\";\n\n// lib/dom/ssr/routeModules.ts\nasync function loadRouteModule(route, routeModulesCache) {\n  if (route.id in routeModulesCache) {\n    return routeModulesCache[route.id];\n  }\n  try {\n    let routeModule = await import(\n      /* @vite-ignore */\n      /* webpackIgnore: true */\n      route.module\n    );\n    routeModulesCache[route.id] = routeModule;\n    return routeModule;\n  } catch (error) {\n    console.error(\n      `Error loading route module \\`${route.module}\\`, reloading page...`\n    );\n    console.error(error);\n    if (window.__reactRouterContext && window.__reactRouterContext.isSpaMode && // @ts-expect-error\n    import.meta.hot) {\n      throw error;\n    }\n    window.location.reload();\n    return new Promise(() => {\n    });\n  }\n}\n\n// lib/dom/ssr/links.ts\nfunction getKeyedLinksForMatches(matches, routeModules, manifest) {\n  let descriptors = matches.map((match) => {\n    let module = routeModules[match.route.id];\n    let route = manifest.routes[match.route.id];\n    return [\n      route && route.css ? route.css.map((href) => ({ rel: \"stylesheet\", href })) : [],\n      module?.links?.() || []\n    ];\n  }).flat(2);\n  let preloads = getModuleLinkHrefs(matches, manifest);\n  return dedupeLinkDescriptors(descriptors, preloads);\n}\nfunction getRouteCssDescriptors(route) {\n  if (!route.css) return [];\n  return route.css.map((href) => ({ rel: \"stylesheet\", href }));\n}\nasync function prefetchRouteCss(route) {\n  if (!route.css) return;\n  let descriptors = getRouteCssDescriptors(route);\n  await Promise.all(descriptors.map(prefetchStyleLink));\n}\nasync function prefetchStyleLinks(route, routeModule) {\n  if (!route.css && !routeModule.links || !isPreloadSupported()) return;\n  let descriptors = [];\n  if (route.css) {\n    descriptors.push(...getRouteCssDescriptors(route));\n  }\n  if (routeModule.links) {\n    descriptors.push(...routeModule.links());\n  }\n  if (descriptors.length === 0) return;\n  let styleLinks = [];\n  for (let descriptor of descriptors) {\n    if (!isPageLinkDescriptor(descriptor) && descriptor.rel === \"stylesheet\") {\n      styleLinks.push({\n        ...descriptor,\n        rel: \"preload\",\n        as: \"style\"\n      });\n    }\n  }\n  await Promise.all(styleLinks.map(prefetchStyleLink));\n}\nasync function prefetchStyleLink(descriptor) {\n  return new Promise((resolve) => {\n    if (descriptor.media && !window.matchMedia(descriptor.media).matches || document.querySelector(\n      `link[rel=\"stylesheet\"][href=\"${descriptor.href}\"]`\n    )) {\n      return resolve();\n    }\n    let link = document.createElement(\"link\");\n    Object.assign(link, descriptor);\n    function removeLink() {\n      if (document.head.contains(link)) {\n        document.head.removeChild(link);\n      }\n    }\n    link.onload = () => {\n      removeLink();\n      resolve();\n    };\n    link.onerror = () => {\n      removeLink();\n      resolve();\n    };\n    document.head.appendChild(link);\n  });\n}\nfunction isPageLinkDescriptor(object) {\n  return object != null && typeof object.page === \"string\";\n}\nfunction isHtmlLinkDescriptor(object) {\n  if (object == null) {\n    return false;\n  }\n  if (object.href == null) {\n    return object.rel === \"preload\" && typeof object.imageSrcSet === \"string\" && typeof object.imageSizes === \"string\";\n  }\n  return typeof object.rel === \"string\" && typeof object.href === \"string\";\n}\nasync function getKeyedPrefetchLinks(matches, manifest, routeModules) {\n  let links = await Promise.all(\n    matches.map(async (match) => {\n      let route = manifest.routes[match.route.id];\n      if (route) {\n        let mod = await loadRouteModule(route, routeModules);\n        return mod.links ? mod.links() : [];\n      }\n      return [];\n    })\n  );\n  return dedupeLinkDescriptors(\n    links.flat(1).filter(isHtmlLinkDescriptor).filter((link) => link.rel === \"stylesheet\" || link.rel === \"preload\").map(\n      (link) => link.rel === \"stylesheet\" ? { ...link, rel: \"prefetch\", as: \"style\" } : { ...link, rel: \"prefetch\" }\n    )\n  );\n}\nfunction getNewMatchesForLinks(page, nextMatches, currentMatches, manifest, location, mode) {\n  let isNew = (match, index) => {\n    if (!currentMatches[index]) return true;\n    return match.route.id !== currentMatches[index].route.id;\n  };\n  let matchPathChanged = (match, index) => {\n    return (\n      // param change, /users/123 -> /users/456\n      currentMatches[index].pathname !== match.pathname || // splat param changed, which is not present in match.path\n      // e.g. /files/images/avatar.jpg -> files/finances.xls\n      currentMatches[index].route.path?.endsWith(\"*\") && currentMatches[index].params[\"*\"] !== match.params[\"*\"]\n    );\n  };\n  if (mode === \"assets\") {\n    return nextMatches.filter(\n      (match, index) => isNew(match, index) || matchPathChanged(match, index)\n    );\n  }\n  if (mode === \"data\") {\n    return nextMatches.filter((match, index) => {\n      let manifestRoute = manifest.routes[match.route.id];\n      if (!manifestRoute || !manifestRoute.hasLoader) {\n        return false;\n      }\n      if (isNew(match, index) || matchPathChanged(match, index)) {\n        return true;\n      }\n      if (match.route.shouldRevalidate) {\n        let routeChoice = match.route.shouldRevalidate({\n          currentUrl: new URL(\n            location.pathname + location.search + location.hash,\n            window.origin\n          ),\n          currentParams: currentMatches[0]?.params || {},\n          nextUrl: new URL(page, window.origin),\n          nextParams: match.params,\n          defaultShouldRevalidate: true\n        });\n        if (typeof routeChoice === \"boolean\") {\n          return routeChoice;\n        }\n      }\n      return true;\n    });\n  }\n  return [];\n}\nfunction getModuleLinkHrefs(matches, manifest, { includeHydrateFallback } = {}) {\n  return dedupeHrefs(\n    matches.map((match) => {\n      let route = manifest.routes[match.route.id];\n      if (!route) return [];\n      let hrefs = [route.module];\n      if (route.clientActionModule) {\n        hrefs = hrefs.concat(route.clientActionModule);\n      }\n      if (route.clientLoaderModule) {\n        hrefs = hrefs.concat(route.clientLoaderModule);\n      }\n      if (includeHydrateFallback && route.hydrateFallbackModule) {\n        hrefs = hrefs.concat(route.hydrateFallbackModule);\n      }\n      if (route.imports) {\n        hrefs = hrefs.concat(route.imports);\n      }\n      return hrefs;\n    }).flat(1)\n  );\n}\nfunction dedupeHrefs(hrefs) {\n  return [...new Set(hrefs)];\n}\nfunction sortKeys(obj) {\n  let sorted = {};\n  let keys = Object.keys(obj).sort();\n  for (let key of keys) {\n    sorted[key] = obj[key];\n  }\n  return sorted;\n}\nfunction dedupeLinkDescriptors(descriptors, preloads) {\n  let set = /* @__PURE__ */ new Set();\n  let preloadsSet = new Set(preloads);\n  return descriptors.reduce((deduped, descriptor) => {\n    let alreadyModulePreload = preloads && !isPageLinkDescriptor(descriptor) && descriptor.as === \"script\" && descriptor.href && preloadsSet.has(descriptor.href);\n    if (alreadyModulePreload) {\n      return deduped;\n    }\n    let key = JSON.stringify(sortKeys(descriptor));\n    if (!set.has(key)) {\n      set.add(key);\n      deduped.push({ key, link: descriptor });\n    }\n    return deduped;\n  }, []);\n}\nvar _isPreloadSupported;\nfunction isPreloadSupported() {\n  if (_isPreloadSupported !== void 0) {\n    return _isPreloadSupported;\n  }\n  let el = document.createElement(\"link\");\n  _isPreloadSupported = el.relList.supports(\"preload\");\n  el = null;\n  return _isPreloadSupported;\n}\n\n// lib/dom/ssr/fog-of-war.ts\nimport * as React7 from \"react\";\n\n// lib/dom/ssr/routes.tsx\nimport * as React6 from \"react\";\n\n// lib/dom/ssr/fallback.tsx\nimport * as React5 from \"react\";\nfunction RemixRootDefaultHydrateFallback() {\n  return /* @__PURE__ */ React5.createElement(BoundaryShell, { title: \"Loading...\", renderScripts: true }, ENABLE_DEV_WARNINGS ? /* @__PURE__ */ React5.createElement(\n    \"script\",\n    {\n      dangerouslySetInnerHTML: {\n        __html: `\n              console.log(\n                \"\\u{1F4BF} Hey developer \\u{1F44B}. You can provide a way better UX than this \" +\n                \"when your app is loading JS modules and/or running \\`clientLoader\\` \" +\n                \"functions. Check out https://reactrouter.com/start/framework/route-module#hydratefallback \" +\n                \"for more information.\"\n              );\n            `\n      }\n    }\n  ) : null);\n}\n\n// lib/dom/ssr/routes.tsx\nfunction groupRoutesByParentId(manifest) {\n  let routes = {};\n  Object.values(manifest).forEach((route) => {\n    if (route) {\n      let parentId = route.parentId || \"\";\n      if (!routes[parentId]) {\n        routes[parentId] = [];\n      }\n      routes[parentId].push(route);\n    }\n  });\n  return routes;\n}\nfunction getRouteComponents(route, routeModule, isSpaMode) {\n  let Component4 = getRouteModuleComponent(routeModule);\n  let HydrateFallback = routeModule.HydrateFallback && (!isSpaMode || route.id === \"root\") ? routeModule.HydrateFallback : route.id === \"root\" ? RemixRootDefaultHydrateFallback : void 0;\n  let ErrorBoundary = routeModule.ErrorBoundary ? routeModule.ErrorBoundary : route.id === \"root\" ? () => /* @__PURE__ */ React6.createElement(RemixRootDefaultErrorBoundary, { error: useRouteError() }) : void 0;\n  if (route.id === \"root\" && routeModule.Layout) {\n    return {\n      ...Component4 ? {\n        element: /* @__PURE__ */ React6.createElement(routeModule.Layout, null, /* @__PURE__ */ React6.createElement(Component4, null))\n      } : { Component: Component4 },\n      ...ErrorBoundary ? {\n        errorElement: /* @__PURE__ */ React6.createElement(routeModule.Layout, null, /* @__PURE__ */ React6.createElement(ErrorBoundary, null))\n      } : { ErrorBoundary },\n      ...HydrateFallback ? {\n        hydrateFallbackElement: /* @__PURE__ */ React6.createElement(routeModule.Layout, null, /* @__PURE__ */ React6.createElement(HydrateFallback, null))\n      } : { HydrateFallback }\n    };\n  }\n  return { Component: Component4, ErrorBoundary, HydrateFallback };\n}\nfunction createServerRoutes(manifest, routeModules, future, isSpaMode, parentId = \"\", routesByParentId = groupRoutesByParentId(manifest), spaModeLazyPromise = Promise.resolve({ Component: () => null })) {\n  return (routesByParentId[parentId] || []).map((route) => {\n    let routeModule = routeModules[route.id];\n    invariant2(\n      routeModule,\n      \"No `routeModule` available to create server routes\"\n    );\n    let dataRoute = {\n      ...getRouteComponents(route, routeModule, isSpaMode),\n      caseSensitive: route.caseSensitive,\n      id: route.id,\n      index: route.index,\n      path: route.path,\n      handle: routeModule.handle,\n      // For SPA Mode, all routes are lazy except root.  However we tell the\n      // router root is also lazy here too since we don't need a full\n      // implementation - we just need a `lazy` prop to tell the RR rendering\n      // where to stop which is always at the root route in SPA mode\n      lazy: isSpaMode ? () => spaModeLazyPromise : void 0,\n      // For partial hydration rendering, we need to indicate when the route\n      // has a loader/clientLoader, but it won't ever be called during the static\n      // render, so just give it a no-op function so we can render down to the\n      // proper fallback\n      loader: route.hasLoader || route.hasClientLoader ? () => null : void 0\n      // We don't need middleware/action/shouldRevalidate on these routes since\n      // they're for a static render\n    };\n    let children = createServerRoutes(\n      manifest,\n      routeModules,\n      future,\n      isSpaMode,\n      route.id,\n      routesByParentId,\n      spaModeLazyPromise\n    );\n    if (children.length > 0) dataRoute.children = children;\n    return dataRoute;\n  });\n}\nfunction createClientRoutesWithHMRRevalidationOptOut(needsRevalidation, manifest, routeModulesCache, initialState, ssr, isSpaMode) {\n  return createClientRoutes(\n    manifest,\n    routeModulesCache,\n    initialState,\n    ssr,\n    isSpaMode,\n    \"\",\n    groupRoutesByParentId(manifest),\n    needsRevalidation\n  );\n}\nfunction preventInvalidServerHandlerCall(type, route) {\n  if (type === \"loader\" && !route.hasLoader || type === \"action\" && !route.hasAction) {\n    let fn = type === \"action\" ? \"serverAction()\" : \"serverLoader()\";\n    let msg = `You are trying to call ${fn} on a route that does not have a server ${type} (routeId: \"${route.id}\")`;\n    console.error(msg);\n    throw new ErrorResponseImpl(400, \"Bad Request\", new Error(msg), true);\n  }\n}\nfunction noActionDefinedError(type, routeId) {\n  let article = type === \"clientAction\" ? \"a\" : \"an\";\n  let msg = `Route \"${routeId}\" does not have ${article} ${type}, but you are trying to submit to it. To fix this, please add ${article} \\`${type}\\` function to the route`;\n  console.error(msg);\n  throw new ErrorResponseImpl(405, \"Method Not Allowed\", new Error(msg), true);\n}\nfunction createClientRoutes(manifest, routeModulesCache, initialState, ssr, isSpaMode, parentId = \"\", routesByParentId = groupRoutesByParentId(manifest), needsRevalidation) {\n  return (routesByParentId[parentId] || []).map((route) => {\n    let routeModule = routeModulesCache[route.id];\n    function fetchServerHandler(singleFetch) {\n      invariant2(\n        typeof singleFetch === \"function\",\n        \"No single fetch function available for route handler\"\n      );\n      return singleFetch();\n    }\n    function fetchServerLoader(singleFetch) {\n      if (!route.hasLoader) return Promise.resolve(null);\n      return fetchServerHandler(singleFetch);\n    }\n    function fetchServerAction(singleFetch) {\n      if (!route.hasAction) {\n        throw noActionDefinedError(\"action\", route.id);\n      }\n      return fetchServerHandler(singleFetch);\n    }\n    function prefetchModule(modulePath) {\n      import(\n        /* @vite-ignore */\n        /* webpackIgnore: true */\n        modulePath\n      );\n    }\n    function prefetchRouteModuleChunks(route2) {\n      if (route2.clientActionModule) {\n        prefetchModule(route2.clientActionModule);\n      }\n      if (route2.clientLoaderModule) {\n        prefetchModule(route2.clientLoaderModule);\n      }\n    }\n    async function prefetchStylesAndCallHandler(handler) {\n      let cachedModule = routeModulesCache[route.id];\n      let linkPrefetchPromise = cachedModule ? prefetchStyleLinks(route, cachedModule) : Promise.resolve();\n      try {\n        return handler();\n      } finally {\n        await linkPrefetchPromise;\n      }\n    }\n    let dataRoute = {\n      id: route.id,\n      index: route.index,\n      path: route.path\n    };\n    if (routeModule) {\n      Object.assign(dataRoute, {\n        ...dataRoute,\n        ...getRouteComponents(route, routeModule, isSpaMode),\n        middleware: routeModule.clientMiddleware,\n        handle: routeModule.handle,\n        shouldRevalidate: getShouldRevalidateFunction(\n          dataRoute.path,\n          routeModule,\n          route,\n          ssr,\n          needsRevalidation\n        )\n      });\n      let hasInitialData = initialState && initialState.loaderData && route.id in initialState.loaderData;\n      let initialData = hasInitialData ? initialState?.loaderData?.[route.id] : void 0;\n      let hasInitialError = initialState && initialState.errors && route.id in initialState.errors;\n      let initialError = hasInitialError ? initialState?.errors?.[route.id] : void 0;\n      let isHydrationRequest = needsRevalidation == null && (routeModule.clientLoader?.hydrate === true || !route.hasLoader);\n      dataRoute.loader = async ({ request, params, context, unstable_pattern }, singleFetch) => {\n        try {\n          let result = await prefetchStylesAndCallHandler(async () => {\n            invariant2(\n              routeModule,\n              \"No `routeModule` available for critical-route loader\"\n            );\n            if (!routeModule.clientLoader) {\n              return fetchServerLoader(singleFetch);\n            }\n            return routeModule.clientLoader({\n              request,\n              params,\n              context,\n              unstable_pattern,\n              async serverLoader() {\n                preventInvalidServerHandlerCall(\"loader\", route);\n                if (isHydrationRequest) {\n                  if (hasInitialData) {\n                    return initialData;\n                  }\n                  if (hasInitialError) {\n                    throw initialError;\n                  }\n                }\n                return fetchServerLoader(singleFetch);\n              }\n            });\n          });\n          return result;\n        } finally {\n          isHydrationRequest = false;\n        }\n      };\n      dataRoute.loader.hydrate = shouldHydrateRouteLoader(\n        route.id,\n        routeModule.clientLoader,\n        route.hasLoader,\n        isSpaMode\n      );\n      dataRoute.action = ({ request, params, context, unstable_pattern }, singleFetch) => {\n        return prefetchStylesAndCallHandler(async () => {\n          invariant2(\n            routeModule,\n            \"No `routeModule` available for critical-route action\"\n          );\n          if (!routeModule.clientAction) {\n            if (isSpaMode) {\n              throw noActionDefinedError(\"clientAction\", route.id);\n            }\n            return fetchServerAction(singleFetch);\n          }\n          return routeModule.clientAction({\n            request,\n            params,\n            context,\n            unstable_pattern,\n            async serverAction() {\n              preventInvalidServerHandlerCall(\"action\", route);\n              return fetchServerAction(singleFetch);\n            }\n          });\n        });\n      };\n    } else {\n      if (!route.hasClientLoader) {\n        dataRoute.loader = (_, singleFetch) => prefetchStylesAndCallHandler(() => {\n          return fetchServerLoader(singleFetch);\n        });\n      }\n      if (!route.hasClientAction) {\n        dataRoute.action = (_, singleFetch) => prefetchStylesAndCallHandler(() => {\n          if (isSpaMode) {\n            throw noActionDefinedError(\"clientAction\", route.id);\n          }\n          return fetchServerAction(singleFetch);\n        });\n      }\n      let lazyRoutePromise;\n      async function getLazyRoute() {\n        if (lazyRoutePromise) {\n          return await lazyRoutePromise;\n        }\n        lazyRoutePromise = (async () => {\n          if (route.clientLoaderModule || route.clientActionModule) {\n            await new Promise((resolve) => setTimeout(resolve, 0));\n          }\n          let routeModulePromise = loadRouteModuleWithBlockingLinks(\n            route,\n            routeModulesCache\n          );\n          prefetchRouteModuleChunks(route);\n          return await routeModulePromise;\n        })();\n        return await lazyRoutePromise;\n      }\n      dataRoute.lazy = {\n        loader: route.hasClientLoader ? async () => {\n          let { clientLoader } = route.clientLoaderModule ? await import(\n            /* @vite-ignore */\n            /* webpackIgnore: true */\n            route.clientLoaderModule\n          ) : await getLazyRoute();\n          invariant2(clientLoader, \"No `clientLoader` export found\");\n          return (args, singleFetch) => clientLoader({\n            ...args,\n            async serverLoader() {\n              preventInvalidServerHandlerCall(\"loader\", route);\n              return fetchServerLoader(singleFetch);\n            }\n          });\n        } : void 0,\n        action: route.hasClientAction ? async () => {\n          let clientActionPromise = route.clientActionModule ? import(\n            /* @vite-ignore */\n            /* webpackIgnore: true */\n            route.clientActionModule\n          ) : getLazyRoute();\n          prefetchRouteModuleChunks(route);\n          let { clientAction } = await clientActionPromise;\n          invariant2(clientAction, \"No `clientAction` export found\");\n          return (args, singleFetch) => clientAction({\n            ...args,\n            async serverAction() {\n              preventInvalidServerHandlerCall(\"action\", route);\n              return fetchServerAction(singleFetch);\n            }\n          });\n        } : void 0,\n        middleware: route.hasClientMiddleware ? async () => {\n          let { clientMiddleware } = route.clientMiddlewareModule ? await import(\n            /* @vite-ignore */\n            /* webpackIgnore: true */\n            route.clientMiddlewareModule\n          ) : await getLazyRoute();\n          invariant2(clientMiddleware, \"No `clientMiddleware` export found\");\n          return clientMiddleware;\n        } : void 0,\n        shouldRevalidate: async () => {\n          let lazyRoute = await getLazyRoute();\n          return getShouldRevalidateFunction(\n            dataRoute.path,\n            lazyRoute,\n            route,\n            ssr,\n            needsRevalidation\n          );\n        },\n        handle: async () => (await getLazyRoute()).handle,\n        // No need to wrap these in layout since the root route is never\n        // loaded via route.lazy()\n        Component: async () => (await getLazyRoute()).Component,\n        ErrorBoundary: route.hasErrorBoundary ? async () => (await getLazyRoute()).ErrorBoundary : void 0\n      };\n    }\n    let children = createClientRoutes(\n      manifest,\n      routeModulesCache,\n      initialState,\n      ssr,\n      isSpaMode,\n      route.id,\n      routesByParentId,\n      needsRevalidation\n    );\n    if (children.length > 0) dataRoute.children = children;\n    return dataRoute;\n  });\n}\nfunction getShouldRevalidateFunction(path, route, manifestRoute, ssr, needsRevalidation) {\n  if (needsRevalidation) {\n    return wrapShouldRevalidateForHdr(\n      manifestRoute.id,\n      route.shouldRevalidate,\n      needsRevalidation\n    );\n  }\n  if (!ssr && manifestRoute.hasLoader && !manifestRoute.hasClientLoader) {\n    let myParams = path ? compilePath(path)[1].map((p) => p.paramName) : [];\n    const didParamsChange = (opts) => myParams.some((p) => opts.currentParams[p] !== opts.nextParams[p]);\n    if (route.shouldRevalidate) {\n      let fn = route.shouldRevalidate;\n      return (opts) => fn({\n        ...opts,\n        defaultShouldRevalidate: didParamsChange(opts)\n      });\n    } else {\n      return (opts) => didParamsChange(opts);\n    }\n  }\n  if (ssr && route.shouldRevalidate) {\n    let fn = route.shouldRevalidate;\n    return (opts) => fn({ ...opts, defaultShouldRevalidate: true });\n  }\n  return route.shouldRevalidate;\n}\nfunction wrapShouldRevalidateForHdr(routeId, routeShouldRevalidate, needsRevalidation) {\n  let handledRevalidation = false;\n  return (arg) => {\n    if (!handledRevalidation) {\n      handledRevalidation = true;\n      return needsRevalidation.has(routeId);\n    }\n    return routeShouldRevalidate ? routeShouldRevalidate(arg) : arg.defaultShouldRevalidate;\n  };\n}\nasync function loadRouteModuleWithBlockingLinks(route, routeModules) {\n  let routeModulePromise = loadRouteModule(route, routeModules);\n  let prefetchRouteCssPromise = prefetchRouteCss(route);\n  let routeModule = await routeModulePromise;\n  await Promise.all([\n    prefetchRouteCssPromise,\n    prefetchStyleLinks(route, routeModule)\n  ]);\n  return {\n    Component: getRouteModuleComponent(routeModule),\n    ErrorBoundary: routeModule.ErrorBoundary,\n    clientMiddleware: routeModule.clientMiddleware,\n    clientAction: routeModule.clientAction,\n    clientLoader: routeModule.clientLoader,\n    handle: routeModule.handle,\n    links: routeModule.links,\n    meta: routeModule.meta,\n    shouldRevalidate: routeModule.shouldRevalidate\n  };\n}\nfunction getRouteModuleComponent(routeModule) {\n  if (routeModule.default == null) return void 0;\n  let isEmptyObject = typeof routeModule.default === \"object\" && Object.keys(routeModule.default).length === 0;\n  if (!isEmptyObject) {\n    return routeModule.default;\n  }\n}\nfunction shouldHydrateRouteLoader(routeId, clientLoader, hasLoader, isSpaMode) {\n  return isSpaMode && routeId !== \"root\" || clientLoader != null && (clientLoader.hydrate === true || hasLoader !== true);\n}\n\n// lib/dom/ssr/fog-of-war.ts\nvar nextPaths = /* @__PURE__ */ new Set();\nvar discoveredPathsMaxSize = 1e3;\nvar discoveredPaths = /* @__PURE__ */ new Set();\nvar URL_LIMIT = 7680;\nfunction isFogOfWarEnabled(routeDiscovery, ssr) {\n  return routeDiscovery.mode === \"lazy\" && ssr === true;\n}\nfunction getPartialManifest({ sri, ...manifest }, router) {\n  let routeIds = new Set(router.state.matches.map((m) => m.route.id));\n  let segments = router.state.location.pathname.split(\"/\").filter(Boolean);\n  let paths = [\"/\"];\n  segments.pop();\n  while (segments.length > 0) {\n    paths.push(`/${segments.join(\"/\")}`);\n    segments.pop();\n  }\n  paths.forEach((path) => {\n    let matches = matchRoutes(router.routes, path, router.basename);\n    if (matches) {\n      matches.forEach((m) => routeIds.add(m.route.id));\n    }\n  });\n  let initialRoutes = [...routeIds].reduce(\n    (acc, id) => Object.assign(acc, { [id]: manifest.routes[id] }),\n    {}\n  );\n  return {\n    ...manifest,\n    routes: initialRoutes,\n    sri: sri ? true : void 0\n  };\n}\nfunction getPatchRoutesOnNavigationFunction(manifest, routeModules, ssr, routeDiscovery, isSpaMode, basename) {\n  if (!isFogOfWarEnabled(routeDiscovery, ssr)) {\n    return void 0;\n  }\n  return async ({ path, patch, signal, fetcherKey }) => {\n    if (discoveredPaths.has(path)) {\n      return;\n    }\n    await fetchAndApplyManifestPatches(\n      [path],\n      fetcherKey ? window.location.href : path,\n      manifest,\n      routeModules,\n      ssr,\n      isSpaMode,\n      basename,\n      routeDiscovery.manifestPath,\n      patch,\n      signal\n    );\n  };\n}\nfunction useFogOFWarDiscovery(router, manifest, routeModules, ssr, routeDiscovery, isSpaMode) {\n  React7.useEffect(() => {\n    if (!isFogOfWarEnabled(routeDiscovery, ssr) || // @ts-expect-error - TS doesn't know about this yet\n    window.navigator?.connection?.saveData === true) {\n      return;\n    }\n    function registerElement(el) {\n      let path = el.tagName === \"FORM\" ? el.getAttribute(\"action\") : el.getAttribute(\"href\");\n      if (!path) {\n        return;\n      }\n      let pathname = el.tagName === \"A\" ? el.pathname : new URL(path, window.location.origin).pathname;\n      if (!discoveredPaths.has(pathname)) {\n        nextPaths.add(pathname);\n      }\n    }\n    async function fetchPatches() {\n      document.querySelectorAll(\"a[data-discover], form[data-discover]\").forEach(registerElement);\n      let lazyPaths = Array.from(nextPaths.keys()).filter((path) => {\n        if (discoveredPaths.has(path)) {\n          nextPaths.delete(path);\n          return false;\n        }\n        return true;\n      });\n      if (lazyPaths.length === 0) {\n        return;\n      }\n      try {\n        await fetchAndApplyManifestPatches(\n          lazyPaths,\n          null,\n          manifest,\n          routeModules,\n          ssr,\n          isSpaMode,\n          router.basename,\n          routeDiscovery.manifestPath,\n          router.patchRoutes\n        );\n      } catch (e) {\n        console.error(\"Failed to fetch manifest patches\", e);\n      }\n    }\n    let debouncedFetchPatches = debounce(fetchPatches, 100);\n    fetchPatches();\n    let observer = new MutationObserver(() => debouncedFetchPatches());\n    observer.observe(document.documentElement, {\n      subtree: true,\n      childList: true,\n      attributes: true,\n      attributeFilter: [\"data-discover\", \"href\", \"action\"]\n    });\n    return () => observer.disconnect();\n  }, [ssr, isSpaMode, manifest, routeModules, router, routeDiscovery]);\n}\nfunction getManifestPath(_manifestPath, basename) {\n  let manifestPath = _manifestPath || \"/__manifest\";\n  if (basename == null) {\n    return manifestPath;\n  }\n  return `${basename}${manifestPath}`.replace(/\\/+/g, \"/\");\n}\nvar MANIFEST_VERSION_STORAGE_KEY = \"react-router-manifest-version\";\nasync function fetchAndApplyManifestPatches(paths, errorReloadPath, manifest, routeModules, ssr, isSpaMode, basename, manifestPath, patchRoutes, signal) {\n  const searchParams = new URLSearchParams();\n  searchParams.set(\"paths\", paths.sort().join(\",\"));\n  searchParams.set(\"version\", manifest.version);\n  let url = new URL(\n    getManifestPath(manifestPath, basename),\n    window.location.origin\n  );\n  url.search = searchParams.toString();\n  if (url.toString().length > URL_LIMIT) {\n    nextPaths.clear();\n    return;\n  }\n  let serverPatches;\n  try {\n    let res = await fetch(url, { signal });\n    if (!res.ok) {\n      throw new Error(`${res.status} ${res.statusText}`);\n    } else if (res.status === 204 && res.headers.has(\"X-Remix-Reload-Document\")) {\n      if (!errorReloadPath) {\n        console.warn(\n          \"Detected a manifest version mismatch during eager route discovery. The next navigation/fetch to an undiscovered route will result in a new document navigation to sync up with the latest manifest.\"\n        );\n        return;\n      }\n      try {\n        if (sessionStorage.getItem(MANIFEST_VERSION_STORAGE_KEY) === manifest.version) {\n          console.error(\n            \"Unable to discover routes due to manifest version mismatch.\"\n          );\n          return;\n        }\n        sessionStorage.setItem(MANIFEST_VERSION_STORAGE_KEY, manifest.version);\n      } catch {\n      }\n      window.location.href = errorReloadPath;\n      console.warn(\"Detected manifest version mismatch, reloading...\");\n      await new Promise(() => {\n      });\n    } else if (res.status >= 400) {\n      throw new Error(await res.text());\n    }\n    try {\n      sessionStorage.removeItem(MANIFEST_VERSION_STORAGE_KEY);\n    } catch {\n    }\n    serverPatches = await res.json();\n  } catch (e) {\n    if (signal?.aborted) return;\n    throw e;\n  }\n  let knownRoutes = new Set(Object.keys(manifest.routes));\n  let patches = Object.values(serverPatches).reduce((acc, route) => {\n    if (route && !knownRoutes.has(route.id)) {\n      acc[route.id] = route;\n    }\n    return acc;\n  }, {});\n  Object.assign(manifest.routes, patches);\n  paths.forEach((p) => addToFifoQueue(p, discoveredPaths));\n  let parentIds = /* @__PURE__ */ new Set();\n  Object.values(patches).forEach((patch) => {\n    if (patch && (!patch.parentId || !patches[patch.parentId])) {\n      parentIds.add(patch.parentId);\n    }\n  });\n  parentIds.forEach(\n    (parentId) => patchRoutes(\n      parentId || null,\n      createClientRoutes(patches, routeModules, null, ssr, isSpaMode, parentId)\n    )\n  );\n}\nfunction addToFifoQueue(path, queue) {\n  if (queue.size >= discoveredPathsMaxSize) {\n    let first = queue.values().next().value;\n    queue.delete(first);\n  }\n  queue.add(path);\n}\nfunction debounce(callback, wait) {\n  let timeoutId;\n  return (...args) => {\n    window.clearTimeout(timeoutId);\n    timeoutId = window.setTimeout(() => callback(...args), wait);\n  };\n}\n\n// lib/dom/ssr/components.tsx\nfunction useDataRouterContext2() {\n  let context = React8.useContext(DataRouterContext);\n  invariant2(\n    context,\n    \"You must render this element inside a <DataRouterContext.Provider> element\"\n  );\n  return context;\n}\nfunction useDataRouterStateContext() {\n  let context = React8.useContext(DataRouterStateContext);\n  invariant2(\n    context,\n    \"You must render this element inside a <DataRouterStateContext.Provider> element\"\n  );\n  return context;\n}\nvar FrameworkContext = React8.createContext(void 0);\nFrameworkContext.displayName = \"FrameworkContext\";\nfunction useFrameworkContext() {\n  let context = React8.useContext(FrameworkContext);\n  invariant2(\n    context,\n    \"You must render this element inside a <HydratedRouter> element\"\n  );\n  return context;\n}\nfunction usePrefetchBehavior(prefetch, theirElementProps) {\n  let frameworkContext = React8.useContext(FrameworkContext);\n  let [maybePrefetch, setMaybePrefetch] = React8.useState(false);\n  let [shouldPrefetch, setShouldPrefetch] = React8.useState(false);\n  let { onFocus, onBlur, onMouseEnter, onMouseLeave, onTouchStart } = theirElementProps;\n  let ref = React8.useRef(null);\n  React8.useEffect(() => {\n    if (prefetch === \"render\") {\n      setShouldPrefetch(true);\n    }\n    if (prefetch === \"viewport\") {\n      let callback = (entries) => {\n        entries.forEach((entry) => {\n          setShouldPrefetch(entry.isIntersecting);\n        });\n      };\n      let observer = new IntersectionObserver(callback, { threshold: 0.5 });\n      if (ref.current) observer.observe(ref.current);\n      return () => {\n        observer.disconnect();\n      };\n    }\n  }, [prefetch]);\n  React8.useEffect(() => {\n    if (maybePrefetch) {\n      let id = setTimeout(() => {\n        setShouldPrefetch(true);\n      }, 100);\n      return () => {\n        clearTimeout(id);\n      };\n    }\n  }, [maybePrefetch]);\n  let setIntent = () => {\n    setMaybePrefetch(true);\n  };\n  let cancelIntent = () => {\n    setMaybePrefetch(false);\n    setShouldPrefetch(false);\n  };\n  if (!frameworkContext) {\n    return [false, ref, {}];\n  }\n  if (prefetch !== \"intent\") {\n    return [shouldPrefetch, ref, {}];\n  }\n  return [\n    shouldPrefetch,\n    ref,\n    {\n      onFocus: composeEventHandlers(onFocus, setIntent),\n      onBlur: composeEventHandlers(onBlur, cancelIntent),\n      onMouseEnter: composeEventHandlers(onMouseEnter, setIntent),\n      onMouseLeave: composeEventHandlers(onMouseLeave, cancelIntent),\n      onTouchStart: composeEventHandlers(onTouchStart, setIntent)\n    }\n  ];\n}\nfunction composeEventHandlers(theirHandler, ourHandler) {\n  return (event) => {\n    theirHandler && theirHandler(event);\n    if (!event.defaultPrevented) {\n      ourHandler(event);\n    }\n  };\n}\nfunction getActiveMatches(matches, errors, isSpaMode) {\n  if (isSpaMode && !isHydrated) {\n    return [matches[0]];\n  }\n  if (errors) {\n    let errorIdx = matches.findIndex((m) => errors[m.route.id] !== void 0);\n    return matches.slice(0, errorIdx + 1);\n  }\n  return matches;\n}\nvar CRITICAL_CSS_DATA_ATTRIBUTE = \"data-react-router-critical-css\";\nfunction Links({ nonce }) {\n  let { isSpaMode, manifest, routeModules, criticalCss } = useFrameworkContext();\n  let { errors, matches: routerMatches } = useDataRouterStateContext();\n  let matches = getActiveMatches(routerMatches, errors, isSpaMode);\n  let keyedLinks = React8.useMemo(\n    () => getKeyedLinksForMatches(matches, routeModules, manifest),\n    [matches, routeModules, manifest]\n  );\n  return /* @__PURE__ */ React8.createElement(React8.Fragment, null, typeof criticalCss === \"string\" ? /* @__PURE__ */ React8.createElement(\n    \"style\",\n    {\n      ...{ [CRITICAL_CSS_DATA_ATTRIBUTE]: \"\" },\n      dangerouslySetInnerHTML: { __html: criticalCss }\n    }\n  ) : null, typeof criticalCss === \"object\" ? /* @__PURE__ */ React8.createElement(\n    \"link\",\n    {\n      ...{ [CRITICAL_CSS_DATA_ATTRIBUTE]: \"\" },\n      rel: \"stylesheet\",\n      href: criticalCss.href,\n      nonce\n    }\n  ) : null, keyedLinks.map(\n    ({ key, link }) => isPageLinkDescriptor(link) ? /* @__PURE__ */ React8.createElement(PrefetchPageLinks, { key, nonce, ...link }) : /* @__PURE__ */ React8.createElement(\"link\", { key, nonce, ...link })\n  ));\n}\nfunction PrefetchPageLinks({ page, ...linkProps }) {\n  let { router } = useDataRouterContext2();\n  let matches = React8.useMemo(\n    () => matchRoutes(router.routes, page, router.basename),\n    [router.routes, page, router.basename]\n  );\n  if (!matches) {\n    return null;\n  }\n  return /* @__PURE__ */ React8.createElement(PrefetchPageLinksImpl, { page, matches, ...linkProps });\n}\nfunction useKeyedPrefetchLinks(matches) {\n  let { manifest, routeModules } = useFrameworkContext();\n  let [keyedPrefetchLinks, setKeyedPrefetchLinks] = React8.useState([]);\n  React8.useEffect(() => {\n    let interrupted = false;\n    void getKeyedPrefetchLinks(matches, manifest, routeModules).then(\n      (links) => {\n        if (!interrupted) {\n          setKeyedPrefetchLinks(links);\n        }\n      }\n    );\n    return () => {\n      interrupted = true;\n    };\n  }, [matches, manifest, routeModules]);\n  return keyedPrefetchLinks;\n}\nfunction PrefetchPageLinksImpl({\n  page,\n  matches: nextMatches,\n  ...linkProps\n}) {\n  let location = useLocation();\n  let { manifest, routeModules } = useFrameworkContext();\n  let { basename } = useDataRouterContext2();\n  let { loaderData, matches } = useDataRouterStateContext();\n  let newMatchesForData = React8.useMemo(\n    () => getNewMatchesForLinks(\n      page,\n      nextMatches,\n      matches,\n      manifest,\n      location,\n      \"data\"\n    ),\n    [page, nextMatches, matches, manifest, location]\n  );\n  let newMatchesForAssets = React8.useMemo(\n    () => getNewMatchesForLinks(\n      page,\n      nextMatches,\n      matches,\n      manifest,\n      location,\n      \"assets\"\n    ),\n    [page, nextMatches, matches, manifest, location]\n  );\n  let dataHrefs = React8.useMemo(() => {\n    if (page === location.pathname + location.search + location.hash) {\n      return [];\n    }\n    let routesParams = /* @__PURE__ */ new Set();\n    let foundOptOutRoute = false;\n    nextMatches.forEach((m) => {\n      let manifestRoute = manifest.routes[m.route.id];\n      if (!manifestRoute || !manifestRoute.hasLoader) {\n        return;\n      }\n      if (!newMatchesForData.some((m2) => m2.route.id === m.route.id) && m.route.id in loaderData && routeModules[m.route.id]?.shouldRevalidate) {\n        foundOptOutRoute = true;\n      } else if (manifestRoute.hasClientLoader) {\n        foundOptOutRoute = true;\n      } else {\n        routesParams.add(m.route.id);\n      }\n    });\n    if (routesParams.size === 0) {\n      return [];\n    }\n    let url = singleFetchUrl(page, basename, \"data\");\n    if (foundOptOutRoute && routesParams.size > 0) {\n      url.searchParams.set(\n        \"_routes\",\n        nextMatches.filter((m) => routesParams.has(m.route.id)).map((m) => m.route.id).join(\",\")\n      );\n    }\n    return [url.pathname + url.search];\n  }, [\n    basename,\n    loaderData,\n    location,\n    manifest,\n    newMatchesForData,\n    nextMatches,\n    page,\n    routeModules\n  ]);\n  let moduleHrefs = React8.useMemo(\n    () => getModuleLinkHrefs(newMatchesForAssets, manifest),\n    [newMatchesForAssets, manifest]\n  );\n  let keyedPrefetchLinks = useKeyedPrefetchLinks(newMatchesForAssets);\n  return /* @__PURE__ */ React8.createElement(React8.Fragment, null, dataHrefs.map((href) => /* @__PURE__ */ React8.createElement(\"link\", { key: href, rel: \"prefetch\", as: \"fetch\", href, ...linkProps })), moduleHrefs.map((href) => /* @__PURE__ */ React8.createElement(\"link\", { key: href, rel: \"modulepreload\", href, ...linkProps })), keyedPrefetchLinks.map(({ key, link }) => (\n    // these don't spread `linkProps` because they are full link descriptors\n    // already with their own props\n    /* @__PURE__ */ React8.createElement(\"link\", { key, nonce: linkProps.nonce, ...link })\n  )));\n}\nfunction Meta() {\n  let { isSpaMode, routeModules } = useFrameworkContext();\n  let {\n    errors,\n    matches: routerMatches,\n    loaderData\n  } = useDataRouterStateContext();\n  let location = useLocation();\n  let _matches = getActiveMatches(routerMatches, errors, isSpaMode);\n  let error = null;\n  if (errors) {\n    error = errors[_matches[_matches.length - 1].route.id];\n  }\n  let meta = [];\n  let leafMeta = null;\n  let matches = [];\n  for (let i = 0; i < _matches.length; i++) {\n    let _match = _matches[i];\n    let routeId = _match.route.id;\n    let data2 = loaderData[routeId];\n    let params = _match.params;\n    let routeModule = routeModules[routeId];\n    let routeMeta = [];\n    let match = {\n      id: routeId,\n      data: data2,\n      loaderData: data2,\n      meta: [],\n      params: _match.params,\n      pathname: _match.pathname,\n      handle: _match.route.handle,\n      error\n    };\n    matches[i] = match;\n    if (routeModule?.meta) {\n      routeMeta = typeof routeModule.meta === \"function\" ? routeModule.meta({\n        data: data2,\n        loaderData: data2,\n        params,\n        location,\n        matches,\n        error\n      }) : Array.isArray(routeModule.meta) ? [...routeModule.meta] : routeModule.meta;\n    } else if (leafMeta) {\n      routeMeta = [...leafMeta];\n    }\n    routeMeta = routeMeta || [];\n    if (!Array.isArray(routeMeta)) {\n      throw new Error(\n        \"The route at \" + _match.route.path + \" returns an invalid value. All route meta functions must return an array of meta objects.\\n\\nTo reference the meta function API, see https://remix.run/route/meta\"\n      );\n    }\n    match.meta = routeMeta;\n    matches[i] = match;\n    meta = [...routeMeta];\n    leafMeta = meta;\n  }\n  return /* @__PURE__ */ React8.createElement(React8.Fragment, null, meta.flat().map((metaProps) => {\n    if (!metaProps) {\n      return null;\n    }\n    if (\"tagName\" in metaProps) {\n      let { tagName, ...rest } = metaProps;\n      if (!isValidMetaTag(tagName)) {\n        console.warn(\n          `A meta object uses an invalid tagName: ${tagName}. Expected either 'link' or 'meta'`\n        );\n        return null;\n      }\n      let Comp = tagName;\n      return /* @__PURE__ */ React8.createElement(Comp, { key: JSON.stringify(rest), ...rest });\n    }\n    if (\"title\" in metaProps) {\n      return /* @__PURE__ */ React8.createElement(\"title\", { key: \"title\" }, String(metaProps.title));\n    }\n    if (\"charset\" in metaProps) {\n      metaProps.charSet ?? (metaProps.charSet = metaProps.charset);\n      delete metaProps.charset;\n    }\n    if (\"charSet\" in metaProps && metaProps.charSet != null) {\n      return typeof metaProps.charSet === \"string\" ? /* @__PURE__ */ React8.createElement(\"meta\", { key: \"charSet\", charSet: metaProps.charSet }) : null;\n    }\n    if (\"script:ld+json\" in metaProps) {\n      try {\n        let json = JSON.stringify(metaProps[\"script:ld+json\"]);\n        return /* @__PURE__ */ React8.createElement(\n          \"script\",\n          {\n            key: `script:ld+json:${json}`,\n            type: \"application/ld+json\",\n            dangerouslySetInnerHTML: { __html: escapeHtml(json) }\n          }\n        );\n      } catch (err) {\n        return null;\n      }\n    }\n    return /* @__PURE__ */ React8.createElement(\"meta\", { key: JSON.stringify(metaProps), ...metaProps });\n  }));\n}\nfunction isValidMetaTag(tagName) {\n  return typeof tagName === \"string\" && /^(meta|link)$/.test(tagName);\n}\nvar isHydrated = false;\nfunction setIsHydrated() {\n  isHydrated = true;\n}\nfunction Scripts(scriptProps) {\n  let {\n    manifest,\n    serverHandoffString,\n    isSpaMode,\n    renderMeta,\n    routeDiscovery,\n    ssr\n  } = useFrameworkContext();\n  let { router, static: isStatic, staticContext } = useDataRouterContext2();\n  let { matches: routerMatches } = useDataRouterStateContext();\n  let isRSCRouterContext = useIsRSCRouterContext();\n  let enableFogOfWar = isFogOfWarEnabled(routeDiscovery, ssr);\n  if (renderMeta) {\n    renderMeta.didRenderScripts = true;\n  }\n  let matches = getActiveMatches(routerMatches, null, isSpaMode);\n  React8.useEffect(() => {\n    setIsHydrated();\n  }, []);\n  let initialScripts = React8.useMemo(() => {\n    if (isRSCRouterContext) {\n      return null;\n    }\n    let streamScript = \"window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());\";\n    let contextScript = staticContext ? `window.__reactRouterContext = ${serverHandoffString};${streamScript}` : \" \";\n    let routeModulesScript = !isStatic ? \" \" : `${manifest.hmr?.runtime ? `import ${JSON.stringify(manifest.hmr.runtime)};` : \"\"}${!enableFogOfWar ? `import ${JSON.stringify(manifest.url)}` : \"\"};\n${matches.map((match, routeIndex) => {\n      let routeVarName = `route${routeIndex}`;\n      let manifestEntry = manifest.routes[match.route.id];\n      invariant2(manifestEntry, `Route ${match.route.id} not found in manifest`);\n      let {\n        clientActionModule,\n        clientLoaderModule,\n        clientMiddlewareModule,\n        hydrateFallbackModule,\n        module\n      } = manifestEntry;\n      let chunks = [\n        ...clientActionModule ? [\n          {\n            module: clientActionModule,\n            varName: `${routeVarName}_clientAction`\n          }\n        ] : [],\n        ...clientLoaderModule ? [\n          {\n            module: clientLoaderModule,\n            varName: `${routeVarName}_clientLoader`\n          }\n        ] : [],\n        ...clientMiddlewareModule ? [\n          {\n            module: clientMiddlewareModule,\n            varName: `${routeVarName}_clientMiddleware`\n          }\n        ] : [],\n        ...hydrateFallbackModule ? [\n          {\n            module: hydrateFallbackModule,\n            varName: `${routeVarName}_HydrateFallback`\n          }\n        ] : [],\n        { module, varName: `${routeVarName}_main` }\n      ];\n      if (chunks.length === 1) {\n        return `import * as ${routeVarName} from ${JSON.stringify(module)};`;\n      }\n      let chunkImportsSnippet = chunks.map((chunk) => `import * as ${chunk.varName} from \"${chunk.module}\";`).join(\"\\n\");\n      let mergedChunksSnippet = `const ${routeVarName} = {${chunks.map((chunk) => `...${chunk.varName}`).join(\",\")}};`;\n      return [chunkImportsSnippet, mergedChunksSnippet].join(\"\\n\");\n    }).join(\"\\n\")}\n  ${enableFogOfWar ? (\n      // Inline a minimal manifest with the SSR matches\n      `window.__reactRouterManifest = ${JSON.stringify(\n        getPartialManifest(manifest, router),\n        null,\n        2\n      )};`\n    ) : \"\"}\n  window.__reactRouterRouteModules = {${matches.map((match, index) => `${JSON.stringify(match.route.id)}:route${index}`).join(\",\")}};\n\nimport(${JSON.stringify(manifest.entry.module)});`;\n    return /* @__PURE__ */ React8.createElement(React8.Fragment, null, /* @__PURE__ */ React8.createElement(\n      \"script\",\n      {\n        ...scriptProps,\n        suppressHydrationWarning: true,\n        dangerouslySetInnerHTML: { __html: contextScript },\n        type: void 0\n      }\n    ), /* @__PURE__ */ React8.createElement(\n      \"script\",\n      {\n        ...scriptProps,\n        suppressHydrationWarning: true,\n        dangerouslySetInnerHTML: { __html: routeModulesScript },\n        type: \"module\",\n        async: true\n      }\n    ));\n  }, []);\n  let preloads = isHydrated || isRSCRouterContext ? [] : dedupe(\n    manifest.entry.imports.concat(\n      getModuleLinkHrefs(matches, manifest, {\n        includeHydrateFallback: true\n      })\n    )\n  );\n  let sri = typeof manifest.sri === \"object\" ? manifest.sri : {};\n  warnOnce(\n    !isRSCRouterContext,\n    \"The <Scripts /> element is a no-op when using RSC and can be safely removed.\"\n  );\n  return isHydrated || isRSCRouterContext ? null : /* @__PURE__ */ React8.createElement(React8.Fragment, null, typeof manifest.sri === \"object\" ? /* @__PURE__ */ React8.createElement(\n    \"script\",\n    {\n      \"rr-importmap\": \"\",\n      type: \"importmap\",\n      suppressHydrationWarning: true,\n      dangerouslySetInnerHTML: {\n        __html: JSON.stringify({\n          integrity: sri\n        })\n      }\n    }\n  ) : null, !enableFogOfWar ? /* @__PURE__ */ React8.createElement(\n    \"link\",\n    {\n      rel: \"modulepreload\",\n      href: manifest.url,\n      crossOrigin: scriptProps.crossOrigin,\n      integrity: sri[manifest.url],\n      suppressHydrationWarning: true\n    }\n  ) : null, /* @__PURE__ */ React8.createElement(\n    \"link\",\n    {\n      rel: \"modulepreload\",\n      href: manifest.entry.module,\n      crossOrigin: scriptProps.crossOrigin,\n      integrity: sri[manifest.entry.module],\n      suppressHydrationWarning: true\n    }\n  ), preloads.map((path) => /* @__PURE__ */ React8.createElement(\n    \"link\",\n    {\n      key: path,\n      rel: \"modulepreload\",\n      href: path,\n      crossOrigin: scriptProps.crossOrigin,\n      integrity: sri[path],\n      suppressHydrationWarning: true\n    }\n  )), initialScripts);\n}\nfunction dedupe(array) {\n  return [...new Set(array)];\n}\nfunction mergeRefs(...refs) {\n  return (value) => {\n    refs.forEach((ref) => {\n      if (typeof ref === \"function\") {\n        ref(value);\n      } else if (ref != null) {\n        ref.current = value;\n      }\n    });\n  };\n}\n\n// lib/dom/ssr/errorBoundaries.tsx\nvar RemixErrorBoundary = class extends React9.Component {\n  constructor(props) {\n    super(props);\n    this.state = { error: props.error || null, location: props.location };\n  }\n  static getDerivedStateFromError(error) {\n    return { error };\n  }\n  static getDerivedStateFromProps(props, state) {\n    if (state.location !== props.location) {\n      return { error: props.error || null, location: props.location };\n    }\n    return { error: props.error || state.error, location: state.location };\n  }\n  render() {\n    if (this.state.error) {\n      return /* @__PURE__ */ React9.createElement(\n        RemixRootDefaultErrorBoundary,\n        {\n          error: this.state.error,\n          isOutsideRemixApp: true\n        }\n      );\n    } else {\n      return this.props.children;\n    }\n  }\n};\nfunction RemixRootDefaultErrorBoundary({\n  error,\n  isOutsideRemixApp\n}) {\n  console.error(error);\n  let heyDeveloper = /* @__PURE__ */ React9.createElement(\n    \"script\",\n    {\n      dangerouslySetInnerHTML: {\n        __html: `\n        console.log(\n          \"\\u{1F4BF} Hey developer \\u{1F44B}. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information.\"\n        );\n      `\n      }\n    }\n  );\n  if (isRouteErrorResponse(error)) {\n    return /* @__PURE__ */ React9.createElement(BoundaryShell, { title: \"Unhandled Thrown Response!\" }, /* @__PURE__ */ React9.createElement(\"h1\", { style: { fontSize: \"24px\" } }, error.status, \" \", error.statusText), ENABLE_DEV_WARNINGS ? heyDeveloper : null);\n  }\n  let errorInstance;\n  if (error instanceof Error) {\n    errorInstance = error;\n  } else {\n    let errorString = error == null ? \"Unknown Error\" : typeof error === \"object\" && \"toString\" in error ? error.toString() : JSON.stringify(error);\n    errorInstance = new Error(errorString);\n  }\n  return /* @__PURE__ */ React9.createElement(\n    BoundaryShell,\n    {\n      title: \"Application Error!\",\n      isOutsideRemixApp\n    },\n    /* @__PURE__ */ React9.createElement(\"h1\", { style: { fontSize: \"24px\" } }, \"Application Error\"),\n    /* @__PURE__ */ React9.createElement(\n      \"pre\",\n      {\n        style: {\n          padding: \"2rem\",\n          background: \"hsla(10, 50%, 50%, 0.1)\",\n          color: \"red\",\n          overflow: \"auto\"\n        }\n      },\n      errorInstance.stack\n    ),\n    heyDeveloper\n  );\n}\nfunction BoundaryShell({\n  title,\n  renderScripts,\n  isOutsideRemixApp,\n  children\n}) {\n  let { routeModules } = useFrameworkContext();\n  if (routeModules.root?.Layout && !isOutsideRemixApp) {\n    return children;\n  }\n  return /* @__PURE__ */ React9.createElement(\"html\", { lang: \"en\" }, /* @__PURE__ */ React9.createElement(\"head\", null, /* @__PURE__ */ React9.createElement(\"meta\", { charSet: \"utf-8\" }), /* @__PURE__ */ React9.createElement(\n    \"meta\",\n    {\n      name: \"viewport\",\n      content: \"width=device-width,initial-scale=1,viewport-fit=cover\"\n    }\n  ), /* @__PURE__ */ React9.createElement(\"title\", null, title)), /* @__PURE__ */ React9.createElement(\"body\", null, /* @__PURE__ */ React9.createElement(\"main\", { style: { fontFamily: \"system-ui, sans-serif\", padding: \"2rem\" } }, children, renderScripts ? /* @__PURE__ */ React9.createElement(Scripts, null) : null)));\n}\n\n// lib/dom/lib.tsx\nimport * as React10 from \"react\";\nvar isBrowser = typeof window !== \"undefined\" && typeof window.document !== \"undefined\" && typeof window.document.createElement !== \"undefined\";\ntry {\n  if (isBrowser) {\n    window.__reactRouterVersion = // @ts-expect-error\n    \"7.9.6\";\n  }\n} catch (e) {\n}\nfunction createBrowserRouter(routes, opts) {\n  return createRouter({\n    basename: opts?.basename,\n    getContext: opts?.getContext,\n    future: opts?.future,\n    history: createBrowserHistory({ window: opts?.window }),\n    hydrationData: opts?.hydrationData || parseHydrationData(),\n    routes,\n    mapRouteProperties,\n    hydrationRouteProperties,\n    dataStrategy: opts?.dataStrategy,\n    patchRoutesOnNavigation: opts?.patchRoutesOnNavigation,\n    window: opts?.window,\n    unstable_instrumentations: opts?.unstable_instrumentations\n  }).initialize();\n}\nfunction createHashRouter(routes, opts) {\n  return createRouter({\n    basename: opts?.basename,\n    getContext: opts?.getContext,\n    future: opts?.future,\n    history: createHashHistory({ window: opts?.window }),\n    hydrationData: opts?.hydrationData || parseHydrationData(),\n    routes,\n    mapRouteProperties,\n    hydrationRouteProperties,\n    dataStrategy: opts?.dataStrategy,\n    patchRoutesOnNavigation: opts?.patchRoutesOnNavigation,\n    window: opts?.window,\n    unstable_instrumentations: opts?.unstable_instrumentations\n  }).initialize();\n}\nfunction parseHydrationData() {\n  let state = window?.__staticRouterHydrationData;\n  if (state && state.errors) {\n    state = {\n      ...state,\n      errors: deserializeErrors(state.errors)\n    };\n  }\n  return state;\n}\nfunction deserializeErrors(errors) {\n  if (!errors) return null;\n  let entries = Object.entries(errors);\n  let serialized = {};\n  for (let [key, val] of entries) {\n    if (val && val.__type === \"RouteErrorResponse\") {\n      serialized[key] = new ErrorResponseImpl(\n        val.status,\n        val.statusText,\n        val.data,\n        val.internal === true\n      );\n    } else if (val && val.__type === \"Error\") {\n      if (val.__subType) {\n        let ErrorConstructor = window[val.__subType];\n        if (typeof ErrorConstructor === \"function\") {\n          try {\n            let error = new ErrorConstructor(val.message);\n            error.stack = \"\";\n            serialized[key] = error;\n          } catch (e) {\n          }\n        }\n      }\n      if (serialized[key] == null) {\n        let error = new Error(val.message);\n        error.stack = \"\";\n        serialized[key] = error;\n      }\n    } else {\n      serialized[key] = val;\n    }\n  }\n  return serialized;\n}\nfunction BrowserRouter({\n  basename,\n  children,\n  window: window2\n}) {\n  let historyRef = React10.useRef();\n  if (historyRef.current == null) {\n    historyRef.current = createBrowserHistory({ window: window2, v5Compat: true });\n  }\n  let history = historyRef.current;\n  let [state, setStateImpl] = React10.useState({\n    action: history.action,\n    location: history.location\n  });\n  let setState = React10.useCallback(\n    (newState) => {\n      React10.startTransition(() => setStateImpl(newState));\n    },\n    [setStateImpl]\n  );\n  React10.useLayoutEffect(() => history.listen(setState), [history, setState]);\n  return /* @__PURE__ */ React10.createElement(\n    Router,\n    {\n      basename,\n      children,\n      location: state.location,\n      navigationType: state.action,\n      navigator: history\n    }\n  );\n}\nfunction HashRouter({ basename, children, window: window2 }) {\n  let historyRef = React10.useRef();\n  if (historyRef.current == null) {\n    historyRef.current = createHashHistory({ window: window2, v5Compat: true });\n  }\n  let history = historyRef.current;\n  let [state, setStateImpl] = React10.useState({\n    action: history.action,\n    location: history.location\n  });\n  let setState = React10.useCallback(\n    (newState) => {\n      React10.startTransition(() => setStateImpl(newState));\n    },\n    [setStateImpl]\n  );\n  React10.useLayoutEffect(() => history.listen(setState), [history, setState]);\n  return /* @__PURE__ */ React10.createElement(\n    Router,\n    {\n      basename,\n      children,\n      location: state.location,\n      navigationType: state.action,\n      navigator: history\n    }\n  );\n}\nfunction HistoryRouter({\n  basename,\n  children,\n  history\n}) {\n  let [state, setStateImpl] = React10.useState({\n    action: history.action,\n    location: history.location\n  });\n  let setState = React10.useCallback(\n    (newState) => {\n      React10.startTransition(() => setStateImpl(newState));\n    },\n    [setStateImpl]\n  );\n  React10.useLayoutEffect(() => history.listen(setState), [history, setState]);\n  return /* @__PURE__ */ React10.createElement(\n    Router,\n    {\n      basename,\n      children,\n      location: state.location,\n      navigationType: state.action,\n      navigator: history\n    }\n  );\n}\nHistoryRouter.displayName = \"unstable_HistoryRouter\";\nvar ABSOLUTE_URL_REGEX2 = /^(?:[a-z][a-z0-9+.-]*:|\\/\\/)/i;\nvar Link = React10.forwardRef(\n  function LinkWithRef({\n    onClick,\n    discover = \"render\",\n    prefetch = \"none\",\n    relative,\n    reloadDocument,\n    replace: replace2,\n    state,\n    target,\n    to,\n    preventScrollReset,\n    viewTransition,\n    ...rest\n  }, forwardedRef) {\n    let { basename } = React10.useContext(NavigationContext);\n    let isAbsolute = typeof to === \"string\" && ABSOLUTE_URL_REGEX2.test(to);\n    let absoluteHref;\n    let isExternal = false;\n    if (typeof to === \"string\" && isAbsolute) {\n      absoluteHref = to;\n      if (isBrowser) {\n        try {\n          let currentUrl = new URL(window.location.href);\n          let targetUrl = to.startsWith(\"//\") ? new URL(currentUrl.protocol + to) : new URL(to);\n          let path = stripBasename(targetUrl.pathname, basename);\n          if (targetUrl.origin === currentUrl.origin && path != null) {\n            to = path + targetUrl.search + targetUrl.hash;\n          } else {\n            isExternal = true;\n          }\n        } catch (e) {\n          warning(\n            false,\n            `<Link to=\"${to}\"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`\n          );\n        }\n      }\n    }\n    let href = useHref(to, { relative });\n    let [shouldPrefetch, prefetchRef, prefetchHandlers] = usePrefetchBehavior(\n      prefetch,\n      rest\n    );\n    let internalOnClick = useLinkClickHandler(to, {\n      replace: replace2,\n      state,\n      target,\n      preventScrollReset,\n      relative,\n      viewTransition\n    });\n    function handleClick(event) {\n      if (onClick) onClick(event);\n      if (!event.defaultPrevented) {\n        internalOnClick(event);\n      }\n    }\n    let link = (\n      // eslint-disable-next-line jsx-a11y/anchor-has-content\n      /* @__PURE__ */ React10.createElement(\n        \"a\",\n        {\n          ...rest,\n          ...prefetchHandlers,\n          href: absoluteHref || href,\n          onClick: isExternal || reloadDocument ? onClick : handleClick,\n          ref: mergeRefs(forwardedRef, prefetchRef),\n          target,\n          \"data-discover\": !isAbsolute && discover === \"render\" ? \"true\" : void 0\n        }\n      )\n    );\n    return shouldPrefetch && !isAbsolute ? /* @__PURE__ */ React10.createElement(React10.Fragment, null, link, /* @__PURE__ */ React10.createElement(PrefetchPageLinks, { page: href })) : link;\n  }\n);\nLink.displayName = \"Link\";\nvar NavLink = React10.forwardRef(\n  function NavLinkWithRef({\n    \"aria-current\": ariaCurrentProp = \"page\",\n    caseSensitive = false,\n    className: classNameProp = \"\",\n    end = false,\n    style: styleProp,\n    to,\n    viewTransition,\n    children,\n    ...rest\n  }, ref) {\n    let path = useResolvedPath(to, { relative: rest.relative });\n    let location = useLocation();\n    let routerState = React10.useContext(DataRouterStateContext);\n    let { navigator, basename } = React10.useContext(NavigationContext);\n    let isTransitioning = routerState != null && // Conditional usage is OK here because the usage of a data router is static\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    useViewTransitionState(path) && viewTransition === true;\n    let toPathname = navigator.encodeLocation ? navigator.encodeLocation(path).pathname : path.pathname;\n    let locationPathname = location.pathname;\n    let nextLocationPathname = routerState && routerState.navigation && routerState.navigation.location ? routerState.navigation.location.pathname : null;\n    if (!caseSensitive) {\n      locationPathname = locationPathname.toLowerCase();\n      nextLocationPathname = nextLocationPathname ? nextLocationPathname.toLowerCase() : null;\n      toPathname = toPathname.toLowerCase();\n    }\n    if (nextLocationPathname && basename) {\n      nextLocationPathname = stripBasename(nextLocationPathname, basename) || nextLocationPathname;\n    }\n    const endSlashPosition = toPathname !== \"/\" && toPathname.endsWith(\"/\") ? toPathname.length - 1 : toPathname.length;\n    let isActive = locationPathname === toPathname || !end && locationPathname.startsWith(toPathname) && locationPathname.charAt(endSlashPosition) === \"/\";\n    let isPending = nextLocationPathname != null && (nextLocationPathname === toPathname || !end && nextLocationPathname.startsWith(toPathname) && nextLocationPathname.charAt(toPathname.length) === \"/\");\n    let renderProps = {\n      isActive,\n      isPending,\n      isTransitioning\n    };\n    let ariaCurrent = isActive ? ariaCurrentProp : void 0;\n    let className;\n    if (typeof classNameProp === \"function\") {\n      className = classNameProp(renderProps);\n    } else {\n      className = [\n        classNameProp,\n        isActive ? \"active\" : null,\n        isPending ? \"pending\" : null,\n        isTransitioning ? \"transitioning\" : null\n      ].filter(Boolean).join(\" \");\n    }\n    let style = typeof styleProp === \"function\" ? styleProp(renderProps) : styleProp;\n    return /* @__PURE__ */ React10.createElement(\n      Link,\n      {\n        ...rest,\n        \"aria-current\": ariaCurrent,\n        className,\n        ref,\n        style,\n        to,\n        viewTransition\n      },\n      typeof children === \"function\" ? children(renderProps) : children\n    );\n  }\n);\nNavLink.displayName = \"NavLink\";\nvar Form = React10.forwardRef(\n  ({\n    discover = \"render\",\n    fetcherKey,\n    navigate,\n    reloadDocument,\n    replace: replace2,\n    state,\n    method = defaultMethod,\n    action,\n    onSubmit,\n    relative,\n    preventScrollReset,\n    viewTransition,\n    ...props\n  }, forwardedRef) => {\n    let submit = useSubmit();\n    let formAction = useFormAction(action, { relative });\n    let formMethod = method.toLowerCase() === \"get\" ? \"get\" : \"post\";\n    let isAbsolute = typeof action === \"string\" && ABSOLUTE_URL_REGEX2.test(action);\n    let submitHandler = (event) => {\n      onSubmit && onSubmit(event);\n      if (event.defaultPrevented) return;\n      event.preventDefault();\n      let submitter = event.nativeEvent.submitter;\n      let submitMethod = submitter?.getAttribute(\"formmethod\") || method;\n      submit(submitter || event.currentTarget, {\n        fetcherKey,\n        method: submitMethod,\n        navigate,\n        replace: replace2,\n        state,\n        relative,\n        preventScrollReset,\n        viewTransition\n      });\n    };\n    return /* @__PURE__ */ React10.createElement(\n      \"form\",\n      {\n        ref: forwardedRef,\n        method: formMethod,\n        action: formAction,\n        onSubmit: reloadDocument ? onSubmit : submitHandler,\n        ...props,\n        \"data-discover\": !isAbsolute && discover === \"render\" ? \"true\" : void 0\n      }\n    );\n  }\n);\nForm.displayName = \"Form\";\nfunction ScrollRestoration({\n  getKey,\n  storageKey,\n  ...props\n}) {\n  let remixContext = React10.useContext(FrameworkContext);\n  let { basename } = React10.useContext(NavigationContext);\n  let location = useLocation();\n  let matches = useMatches();\n  useScrollRestoration({ getKey, storageKey });\n  let ssrKey = React10.useMemo(\n    () => {\n      if (!remixContext || !getKey) return null;\n      let userKey = getScrollRestorationKey(\n        location,\n        matches,\n        basename,\n        getKey\n      );\n      return userKey !== location.key ? userKey : null;\n    },\n    // Nah, we only need this the first time for the SSR render\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n  if (!remixContext || remixContext.isSpaMode) {\n    return null;\n  }\n  let restoreScroll = ((storageKey2, restoreKey) => {\n    if (!window.history.state || !window.history.state.key) {\n      let key = Math.random().toString(32).slice(2);\n      window.history.replaceState({ key }, \"\");\n    }\n    try {\n      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || \"{}\");\n      let storedY = positions[restoreKey || window.history.state.key];\n      if (typeof storedY === \"number\") {\n        window.scrollTo(0, storedY);\n      }\n    } catch (error) {\n      console.error(error);\n      sessionStorage.removeItem(storageKey2);\n    }\n  }).toString();\n  return /* @__PURE__ */ React10.createElement(\n    \"script\",\n    {\n      ...props,\n      suppressHydrationWarning: true,\n      dangerouslySetInnerHTML: {\n        __html: `(${restoreScroll})(${JSON.stringify(\n          storageKey || SCROLL_RESTORATION_STORAGE_KEY\n        )}, ${JSON.stringify(ssrKey)})`\n      }\n    }\n  );\n}\nScrollRestoration.displayName = \"ScrollRestoration\";\nfunction getDataRouterConsoleError2(hookName) {\n  return `${hookName} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`;\n}\nfunction useDataRouterContext3(hookName) {\n  let ctx = React10.useContext(DataRouterContext);\n  invariant(ctx, getDataRouterConsoleError2(hookName));\n  return ctx;\n}\nfunction useDataRouterState2(hookName) {\n  let state = React10.useContext(DataRouterStateContext);\n  invariant(state, getDataRouterConsoleError2(hookName));\n  return state;\n}\nfunction useLinkClickHandler(to, {\n  target,\n  replace: replaceProp,\n  state,\n  preventScrollReset,\n  relative,\n  viewTransition\n} = {}) {\n  let navigate = useNavigate();\n  let location = useLocation();\n  let path = useResolvedPath(to, { relative });\n  return React10.useCallback(\n    (event) => {\n      if (shouldProcessLinkClick(event, target)) {\n        event.preventDefault();\n        let replace2 = replaceProp !== void 0 ? replaceProp : createPath(location) === createPath(path);\n        navigate(to, {\n          replace: replace2,\n          state,\n          preventScrollReset,\n          relative,\n          viewTransition\n        });\n      }\n    },\n    [\n      location,\n      navigate,\n      path,\n      replaceProp,\n      state,\n      target,\n      to,\n      preventScrollReset,\n      relative,\n      viewTransition\n    ]\n  );\n}\nfunction useSearchParams(defaultInit) {\n  warning(\n    typeof URLSearchParams !== \"undefined\",\n    `You cannot use the \\`useSearchParams\\` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.`\n  );\n  let defaultSearchParamsRef = React10.useRef(createSearchParams(defaultInit));\n  let hasSetSearchParamsRef = React10.useRef(false);\n  let location = useLocation();\n  let searchParams = React10.useMemo(\n    () => (\n      // Only merge in the defaults if we haven't yet called setSearchParams.\n      // Once we call that we want those to take precedence, otherwise you can't\n      // remove a param with setSearchParams({}) if it has an initial value\n      getSearchParamsForLocation(\n        location.search,\n        hasSetSearchParamsRef.current ? null : defaultSearchParamsRef.current\n      )\n    ),\n    [location.search]\n  );\n  let navigate = useNavigate();\n  let setSearchParams = React10.useCallback(\n    (nextInit, navigateOptions) => {\n      const newSearchParams = createSearchParams(\n        typeof nextInit === \"function\" ? nextInit(new URLSearchParams(searchParams)) : nextInit\n      );\n      hasSetSearchParamsRef.current = true;\n      navigate(\"?\" + newSearchParams, navigateOptions);\n    },\n    [navigate, searchParams]\n  );\n  return [searchParams, setSearchParams];\n}\nvar fetcherId = 0;\nvar getUniqueFetcherId = () => `__${String(++fetcherId)}__`;\nfunction useSubmit() {\n  let { router } = useDataRouterContext3(\"useSubmit\" /* UseSubmit */);\n  let { basename } = React10.useContext(NavigationContext);\n  let currentRouteId = useRouteId();\n  return React10.useCallback(\n    async (target, options = {}) => {\n      let { action, method, encType, formData, body } = getFormSubmissionInfo(\n        target,\n        basename\n      );\n      if (options.navigate === false) {\n        let key = options.fetcherKey || getUniqueFetcherId();\n        await router.fetch(key, currentRouteId, options.action || action, {\n          preventScrollReset: options.preventScrollReset,\n          formData,\n          body,\n          formMethod: options.method || method,\n          formEncType: options.encType || encType,\n          flushSync: options.flushSync\n        });\n      } else {\n        await router.navigate(options.action || action, {\n          preventScrollReset: options.preventScrollReset,\n          formData,\n          body,\n          formMethod: options.method || method,\n          formEncType: options.encType || encType,\n          replace: options.replace,\n          state: options.state,\n          fromRouteId: currentRouteId,\n          flushSync: options.flushSync,\n          viewTransition: options.viewTransition\n        });\n      }\n    },\n    [router, basename, currentRouteId]\n  );\n}\nfunction useFormAction(action, { relative } = {}) {\n  let { basename } = React10.useContext(NavigationContext);\n  let routeContext = React10.useContext(RouteContext);\n  invariant(routeContext, \"useFormAction must be used inside a RouteContext\");\n  let [match] = routeContext.matches.slice(-1);\n  let path = { ...useResolvedPath(action ? action : \".\", { relative }) };\n  let location = useLocation();\n  if (action == null) {\n    path.search = location.search;\n    let params = new URLSearchParams(path.search);\n    let indexValues = params.getAll(\"index\");\n    let hasNakedIndexParam = indexValues.some((v) => v === \"\");\n    if (hasNakedIndexParam) {\n      params.delete(\"index\");\n      indexValues.filter((v) => v).forEach((v) => params.append(\"index\", v));\n      let qs = params.toString();\n      path.search = qs ? `?${qs}` : \"\";\n    }\n  }\n  if ((!action || action === \".\") && match.route.index) {\n    path.search = path.search ? path.search.replace(/^\\?/, \"?index&\") : \"?index\";\n  }\n  if (basename !== \"/\") {\n    path.pathname = path.pathname === \"/\" ? basename : joinPaths([basename, path.pathname]);\n  }\n  return createPath(path);\n}\nfunction useFetcher({\n  key\n} = {}) {\n  let { router } = useDataRouterContext3(\"useFetcher\" /* UseFetcher */);\n  let state = useDataRouterState2(\"useFetcher\" /* UseFetcher */);\n  let fetcherData = React10.useContext(FetchersContext);\n  let route = React10.useContext(RouteContext);\n  let routeId = route.matches[route.matches.length - 1]?.route.id;\n  invariant(fetcherData, `useFetcher must be used inside a FetchersContext`);\n  invariant(route, `useFetcher must be used inside a RouteContext`);\n  invariant(\n    routeId != null,\n    `useFetcher can only be used on routes that contain a unique \"id\"`\n  );\n  let defaultKey = React10.useId();\n  let [fetcherKey, setFetcherKey] = React10.useState(key || defaultKey);\n  if (key && key !== fetcherKey) {\n    setFetcherKey(key);\n  }\n  React10.useEffect(() => {\n    router.getFetcher(fetcherKey);\n    return () => router.deleteFetcher(fetcherKey);\n  }, [router, fetcherKey]);\n  let load = React10.useCallback(\n    async (href, opts) => {\n      invariant(routeId, \"No routeId available for fetcher.load()\");\n      await router.fetch(fetcherKey, routeId, href, opts);\n    },\n    [fetcherKey, routeId, router]\n  );\n  let submitImpl = useSubmit();\n  let submit = React10.useCallback(\n    async (target, opts) => {\n      await submitImpl(target, {\n        ...opts,\n        navigate: false,\n        fetcherKey\n      });\n    },\n    [fetcherKey, submitImpl]\n  );\n  let unstable_reset = React10.useCallback((opts) => router.resetFetcher(fetcherKey, opts), [router, fetcherKey]);\n  let FetcherForm = React10.useMemo(() => {\n    let FetcherForm2 = React10.forwardRef(\n      (props, ref) => {\n        return /* @__PURE__ */ React10.createElement(Form, { ...props, navigate: false, fetcherKey, ref });\n      }\n    );\n    FetcherForm2.displayName = \"fetcher.Form\";\n    return FetcherForm2;\n  }, [fetcherKey]);\n  let fetcher = state.fetchers.get(fetcherKey) || IDLE_FETCHER;\n  let data2 = fetcherData.get(fetcherKey);\n  let fetcherWithComponents = React10.useMemo(\n    () => ({\n      Form: FetcherForm,\n      submit,\n      load,\n      unstable_reset,\n      ...fetcher,\n      data: data2\n    }),\n    [FetcherForm, submit, load, unstable_reset, fetcher, data2]\n  );\n  return fetcherWithComponents;\n}\nfunction useFetchers() {\n  let state = useDataRouterState2(\"useFetchers\" /* UseFetchers */);\n  return Array.from(state.fetchers.entries()).map(([key, fetcher]) => ({\n    ...fetcher,\n    key\n  }));\n}\nvar SCROLL_RESTORATION_STORAGE_KEY = \"react-router-scroll-positions\";\nvar savedScrollPositions = {};\nfunction getScrollRestorationKey(location, matches, basename, getKey) {\n  let key = null;\n  if (getKey) {\n    if (basename !== \"/\") {\n      key = getKey(\n        {\n          ...location,\n          pathname: stripBasename(location.pathname, basename) || location.pathname\n        },\n        matches\n      );\n    } else {\n      key = getKey(location, matches);\n    }\n  }\n  if (key == null) {\n    key = location.key;\n  }\n  return key;\n}\nfunction useScrollRestoration({\n  getKey,\n  storageKey\n} = {}) {\n  let { router } = useDataRouterContext3(\"useScrollRestoration\" /* UseScrollRestoration */);\n  let { restoreScrollPosition, preventScrollReset } = useDataRouterState2(\n    \"useScrollRestoration\" /* UseScrollRestoration */\n  );\n  let { basename } = React10.useContext(NavigationContext);\n  let location = useLocation();\n  let matches = useMatches();\n  let navigation = useNavigation();\n  React10.useEffect(() => {\n    window.history.scrollRestoration = \"manual\";\n    return () => {\n      window.history.scrollRestoration = \"auto\";\n    };\n  }, []);\n  usePageHide(\n    React10.useCallback(() => {\n      if (navigation.state === \"idle\") {\n        let key = getScrollRestorationKey(location, matches, basename, getKey);\n        savedScrollPositions[key] = window.scrollY;\n      }\n      try {\n        sessionStorage.setItem(\n          storageKey || SCROLL_RESTORATION_STORAGE_KEY,\n          JSON.stringify(savedScrollPositions)\n        );\n      } catch (error) {\n        warning(\n          false,\n          `Failed to save scroll positions in sessionStorage, <ScrollRestoration /> will not work properly (${error}).`\n        );\n      }\n      window.history.scrollRestoration = \"auto\";\n    }, [navigation.state, getKey, basename, location, matches, storageKey])\n  );\n  if (typeof document !== \"undefined\") {\n    React10.useLayoutEffect(() => {\n      try {\n        let sessionPositions = sessionStorage.getItem(\n          storageKey || SCROLL_RESTORATION_STORAGE_KEY\n        );\n        if (sessionPositions) {\n          savedScrollPositions = JSON.parse(sessionPositions);\n        }\n      } catch (e) {\n      }\n    }, [storageKey]);\n    React10.useLayoutEffect(() => {\n      let disableScrollRestoration = router?.enableScrollRestoration(\n        savedScrollPositions,\n        () => window.scrollY,\n        getKey ? (location2, matches2) => getScrollRestorationKey(location2, matches2, basename, getKey) : void 0\n      );\n      return () => disableScrollRestoration && disableScrollRestoration();\n    }, [router, basename, getKey]);\n    React10.useLayoutEffect(() => {\n      if (restoreScrollPosition === false) {\n        return;\n      }\n      if (typeof restoreScrollPosition === \"number\") {\n        window.scrollTo(0, restoreScrollPosition);\n        return;\n      }\n      try {\n        if (location.hash) {\n          let el = document.getElementById(\n            decodeURIComponent(location.hash.slice(1))\n          );\n          if (el) {\n            el.scrollIntoView();\n            return;\n          }\n        }\n      } catch {\n        warning(\n          false,\n          `\"${location.hash.slice(\n            1\n          )}\" is not a decodable element ID. The view will not scroll to it.`\n        );\n      }\n      if (preventScrollReset === true) {\n        return;\n      }\n      window.scrollTo(0, 0);\n    }, [location, restoreScrollPosition, preventScrollReset]);\n  }\n}\nfunction useBeforeUnload(callback, options) {\n  let { capture } = options || {};\n  React10.useEffect(() => {\n    let opts = capture != null ? { capture } : void 0;\n    window.addEventListener(\"beforeunload\", callback, opts);\n    return () => {\n      window.removeEventListener(\"beforeunload\", callback, opts);\n    };\n  }, [callback, capture]);\n}\nfunction usePageHide(callback, options) {\n  let { capture } = options || {};\n  React10.useEffect(() => {\n    let opts = capture != null ? { capture } : void 0;\n    window.addEventListener(\"pagehide\", callback, opts);\n    return () => {\n      window.removeEventListener(\"pagehide\", callback, opts);\n    };\n  }, [callback, capture]);\n}\nfunction usePrompt({\n  when,\n  message\n}) {\n  let blocker = useBlocker(when);\n  React10.useEffect(() => {\n    if (blocker.state === \"blocked\") {\n      let proceed = window.confirm(message);\n      if (proceed) {\n        setTimeout(blocker.proceed, 0);\n      } else {\n        blocker.reset();\n      }\n    }\n  }, [blocker, message]);\n  React10.useEffect(() => {\n    if (blocker.state === \"blocked\" && !when) {\n      blocker.reset();\n    }\n  }, [blocker, when]);\n}\nfunction useViewTransitionState(to, { relative } = {}) {\n  let vtContext = React10.useContext(ViewTransitionContext);\n  invariant(\n    vtContext != null,\n    \"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?\"\n  );\n  let { basename } = useDataRouterContext3(\n    \"useViewTransitionState\" /* useViewTransitionState */\n  );\n  let path = useResolvedPath(to, { relative });\n  if (!vtContext.isTransitioning) {\n    return false;\n  }\n  let currentPath = stripBasename(vtContext.currentLocation.pathname, basename) || vtContext.currentLocation.pathname;\n  let nextPath = stripBasename(vtContext.nextLocation.pathname, basename) || vtContext.nextLocation.pathname;\n  return matchPath(path.pathname, nextPath) != null || matchPath(path.pathname, currentPath) != null;\n}\n\n// lib/dom/server.tsx\nimport * as React11 from \"react\";\nfunction StaticRouter({\n  basename,\n  children,\n  location: locationProp = \"/\"\n}) {\n  if (typeof locationProp === \"string\") {\n    locationProp = parsePath(locationProp);\n  }\n  let action = \"POP\" /* Pop */;\n  let location = {\n    pathname: locationProp.pathname || \"/\",\n    search: locationProp.search || \"\",\n    hash: locationProp.hash || \"\",\n    state: locationProp.state != null ? locationProp.state : null,\n    key: locationProp.key || \"default\"\n  };\n  let staticNavigator = getStatelessNavigator();\n  return /* @__PURE__ */ React11.createElement(\n    Router,\n    {\n      basename,\n      children,\n      location,\n      navigationType: action,\n      navigator: staticNavigator,\n      static: true\n    }\n  );\n}\nfunction StaticRouterProvider({\n  context,\n  router,\n  hydrate: hydrate2 = true,\n  nonce\n}) {\n  invariant(\n    router && context,\n    \"You must provide `router` and `context` to <StaticRouterProvider>\"\n  );\n  let dataRouterContext = {\n    router,\n    navigator: getStatelessNavigator(),\n    static: true,\n    staticContext: context,\n    basename: context.basename || \"/\"\n  };\n  let fetchersContext = /* @__PURE__ */ new Map();\n  let hydrateScript = \"\";\n  if (hydrate2 !== false) {\n    let data2 = {\n      loaderData: context.loaderData,\n      actionData: context.actionData,\n      errors: serializeErrors(context.errors)\n    };\n    let json = htmlEscape(JSON.stringify(JSON.stringify(data2)));\n    hydrateScript = `window.__staticRouterHydrationData = JSON.parse(${json});`;\n  }\n  let { state } = dataRouterContext.router;\n  return /* @__PURE__ */ React11.createElement(React11.Fragment, null, /* @__PURE__ */ React11.createElement(DataRouterContext.Provider, { value: dataRouterContext }, /* @__PURE__ */ React11.createElement(DataRouterStateContext.Provider, { value: state }, /* @__PURE__ */ React11.createElement(FetchersContext.Provider, { value: fetchersContext }, /* @__PURE__ */ React11.createElement(ViewTransitionContext.Provider, { value: { isTransitioning: false } }, /* @__PURE__ */ React11.createElement(\n    Router,\n    {\n      basename: dataRouterContext.basename,\n      location: state.location,\n      navigationType: state.historyAction,\n      navigator: dataRouterContext.navigator,\n      static: dataRouterContext.static\n    },\n    /* @__PURE__ */ React11.createElement(\n      DataRoutes2,\n      {\n        routes: router.routes,\n        future: router.future,\n        state\n      }\n    )\n  ))))), hydrateScript ? /* @__PURE__ */ React11.createElement(\n    \"script\",\n    {\n      suppressHydrationWarning: true,\n      nonce,\n      dangerouslySetInnerHTML: { __html: hydrateScript }\n    }\n  ) : null);\n}\nfunction DataRoutes2({\n  routes,\n  future,\n  state\n}) {\n  return useRoutesImpl(routes, void 0, state, void 0, future);\n}\nfunction serializeErrors(errors) {\n  if (!errors) return null;\n  let entries = Object.entries(errors);\n  let serialized = {};\n  for (let [key, val] of entries) {\n    if (isRouteErrorResponse(val)) {\n      serialized[key] = { ...val, __type: \"RouteErrorResponse\" };\n    } else if (val instanceof Error) {\n      serialized[key] = {\n        message: val.message,\n        __type: \"Error\",\n        // If this is a subclass (i.e., ReferenceError), send up the type so we\n        // can re-create the same type during hydration.\n        ...val.name !== \"Error\" ? {\n          __subType: val.name\n        } : {}\n      };\n    } else {\n      serialized[key] = val;\n    }\n  }\n  return serialized;\n}\nfunction getStatelessNavigator() {\n  return {\n    createHref,\n    encodeLocation,\n    push(to) {\n      throw new Error(\n        `You cannot use navigator.push() on the server because it is a stateless environment. This error was probably triggered when you did a \\`navigate(${JSON.stringify(to)})\\` somewhere in your app.`\n      );\n    },\n    replace(to) {\n      throw new Error(\n        `You cannot use navigator.replace() on the server because it is a stateless environment. This error was probably triggered when you did a \\`navigate(${JSON.stringify(to)}, { replace: true })\\` somewhere in your app.`\n      );\n    },\n    go(delta) {\n      throw new Error(\n        `You cannot use navigator.go() on the server because it is a stateless environment. This error was probably triggered when you did a \\`navigate(${delta})\\` somewhere in your app.`\n      );\n    },\n    back() {\n      throw new Error(\n        `You cannot use navigator.back() on the server because it is a stateless environment.`\n      );\n    },\n    forward() {\n      throw new Error(\n        `You cannot use navigator.forward() on the server because it is a stateless environment.`\n      );\n    }\n  };\n}\nfunction createStaticHandler2(routes, opts) {\n  return createStaticHandler(routes, {\n    ...opts,\n    mapRouteProperties\n  });\n}\nfunction createStaticRouter(routes, context, opts = {}) {\n  let manifest = {};\n  let dataRoutes = convertRoutesToDataRoutes(\n    routes,\n    mapRouteProperties,\n    void 0,\n    manifest\n  );\n  let matches = context.matches.map((match) => {\n    let route = manifest[match.route.id] || match.route;\n    return {\n      ...match,\n      route\n    };\n  });\n  let msg = (method) => `You cannot use router.${method}() on the server because it is a stateless environment`;\n  return {\n    get basename() {\n      return context.basename;\n    },\n    get future() {\n      return {\n        v8_middleware: false,\n        ...opts?.future\n      };\n    },\n    get state() {\n      return {\n        historyAction: \"POP\" /* Pop */,\n        location: context.location,\n        matches,\n        loaderData: context.loaderData,\n        actionData: context.actionData,\n        errors: context.errors,\n        initialized: true,\n        navigation: IDLE_NAVIGATION,\n        restoreScrollPosition: null,\n        preventScrollReset: false,\n        revalidation: \"idle\",\n        fetchers: /* @__PURE__ */ new Map(),\n        blockers: /* @__PURE__ */ new Map()\n      };\n    },\n    get routes() {\n      return dataRoutes;\n    },\n    get window() {\n      return void 0;\n    },\n    initialize() {\n      throw msg(\"initialize\");\n    },\n    subscribe() {\n      throw msg(\"subscribe\");\n    },\n    enableScrollRestoration() {\n      throw msg(\"enableScrollRestoration\");\n    },\n    navigate() {\n      throw msg(\"navigate\");\n    },\n    fetch() {\n      throw msg(\"fetch\");\n    },\n    revalidate() {\n      throw msg(\"revalidate\");\n    },\n    createHref,\n    encodeLocation,\n    getFetcher() {\n      return IDLE_FETCHER;\n    },\n    deleteFetcher() {\n      throw msg(\"deleteFetcher\");\n    },\n    resetFetcher() {\n      throw msg(\"resetFetcher\");\n    },\n    dispose() {\n      throw msg(\"dispose\");\n    },\n    getBlocker() {\n      return IDLE_BLOCKER;\n    },\n    deleteBlocker() {\n      throw msg(\"deleteBlocker\");\n    },\n    patchRoutes() {\n      throw msg(\"patchRoutes\");\n    },\n    _internalFetchControllers: /* @__PURE__ */ new Map(),\n    _internalSetRoutes() {\n      throw msg(\"_internalSetRoutes\");\n    },\n    _internalSetStateDoNotUseOrYouWillBreakYourApp() {\n      throw msg(\"_internalSetStateDoNotUseOrYouWillBreakYourApp\");\n    }\n  };\n}\nfunction createHref(to) {\n  return typeof to === \"string\" ? to : createPath(to);\n}\nfunction encodeLocation(to) {\n  let href = typeof to === \"string\" ? to : createPath(to);\n  href = href.replace(/ $/, \"%20\");\n  let encoded = ABSOLUTE_URL_REGEX3.test(href) ? new URL(href) : new URL(href, \"http://localhost\");\n  return {\n    pathname: encoded.pathname,\n    search: encoded.search,\n    hash: encoded.hash\n  };\n}\nvar ABSOLUTE_URL_REGEX3 = /^(?:[a-z][a-z0-9+.-]*:|\\/\\/)/i;\nvar ESCAPE_LOOKUP2 = {\n  \"&\": \"\\\\u0026\",\n  \">\": \"\\\\u003e\",\n  \"<\": \"\\\\u003c\",\n  \"\\u2028\": \"\\\\u2028\",\n  \"\\u2029\": \"\\\\u2029\"\n};\nvar ESCAPE_REGEX2 = /[&><\\u2028\\u2029]/g;\nfunction htmlEscape(str) {\n  return str.replace(ESCAPE_REGEX2, (match) => ESCAPE_LOOKUP2[match]);\n}\n\nexport {\n  Action,\n  createBrowserHistory,\n  invariant,\n  createPath,\n  parsePath,\n  createContext,\n  RouterContextProvider,\n  convertRoutesToDataRoutes,\n  matchRoutes,\n  generatePath,\n  matchPath,\n  stripBasename,\n  resolvePath,\n  data,\n  redirect,\n  redirectDocument,\n  replace,\n  ErrorResponseImpl,\n  isRouteErrorResponse,\n  instrumentHandler,\n  IDLE_NAVIGATION,\n  IDLE_FETCHER,\n  IDLE_BLOCKER,\n  createRouter,\n  createStaticHandler,\n  getStaticContextFromError,\n  isDataWithResponseInit,\n  isResponse,\n  isRedirectStatusCode,\n  isRedirectResponse,\n  isMutationMethod,\n  DataRouterContext,\n  DataRouterStateContext,\n  RSCRouterContext,\n  ViewTransitionContext,\n  FetchersContext,\n  AwaitContextProvider,\n  NavigationContext,\n  LocationContext,\n  RouteContext,\n  ENABLE_DEV_WARNINGS,\n  useHref,\n  useInRouterContext,\n  useLocation,\n  useNavigationType,\n  useMatch,\n  useNavigate,\n  useOutletContext,\n  useOutlet,\n  useParams,\n  useResolvedPath,\n  useRoutes,\n  useNavigation,\n  useRevalidator,\n  useMatches,\n  useLoaderData,\n  useRouteLoaderData,\n  useActionData,\n  useRouteError,\n  useAsyncValue,\n  useAsyncError,\n  useBlocker,\n  useRoute,\n  warnOnce,\n  mapRouteProperties,\n  hydrationRouteProperties,\n  createMemoryRouter,\n  UNSTABLE_TransitionEnabledRouterProvider,\n  RouterProvider,\n  MemoryRouter,\n  Navigate,\n  Outlet,\n  Route,\n  Router,\n  Routes,\n  Await,\n  createRoutesFromChildren,\n  createRoutesFromElements,\n  renderMatches,\n  WithComponentProps,\n  withComponentProps,\n  WithHydrateFallbackProps,\n  withHydrateFallbackProps,\n  WithErrorBoundaryProps,\n  withErrorBoundaryProps,\n  createSearchParams,\n  escapeHtml,\n  encode,\n  createRequestInit,\n  SingleFetchRedirectSymbol,\n  SINGLE_FETCH_REDIRECT_STATUS,\n  NO_BODY_STATUS_CODES,\n  StreamTransfer,\n  getTurboStreamSingleFetchDataStrategy,\n  getSingleFetchDataStrategyImpl,\n  stripIndexParam,\n  singleFetchUrl,\n  decodeViaTurboStream,\n  RemixErrorBoundary,\n  createServerRoutes,\n  createClientRoutesWithHMRRevalidationOptOut,\n  noActionDefinedError,\n  createClientRoutes,\n  shouldHydrateRouteLoader,\n  getPatchRoutesOnNavigationFunction,\n  useFogOFWarDiscovery,\n  getManifestPath,\n  FrameworkContext,\n  CRITICAL_CSS_DATA_ATTRIBUTE,\n  Links,\n  PrefetchPageLinks,\n  Meta,\n  setIsHydrated,\n  Scripts,\n  createBrowserRouter,\n  createHashRouter,\n  BrowserRouter,\n  HashRouter,\n  HistoryRouter,\n  Link,\n  NavLink,\n  Form,\n  ScrollRestoration,\n  useLinkClickHandler,\n  useSearchParams,\n  useSubmit,\n  useFormAction,\n  useFetcher,\n  useFetchers,\n  useScrollRestoration,\n  useBeforeUnload,\n  usePrompt,\n  useViewTransitionState,\n  StaticRouter,\n  StaticRouterProvider,\n  createStaticHandler2,\n  createStaticRouter\n};\n","export const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\n//# sourceMappingURL=helper.js.map","/**\n * Base error for Supabase Edge Function invocations.\n *\n * @example\n * ```ts\n * import { FunctionsError } from '@supabase/functions-js'\n *\n * throw new FunctionsError('Unexpected error invoking function', 'FunctionsError', {\n *   requestId: 'abc123',\n * })\n * ```\n */\nexport class FunctionsError extends Error {\n    constructor(message, name = 'FunctionsError', context) {\n        super(message);\n        this.name = name;\n        this.context = context;\n    }\n}\n/**\n * Error thrown when the network request to an Edge Function fails.\n *\n * @example\n * ```ts\n * import { FunctionsFetchError } from '@supabase/functions-js'\n *\n * throw new FunctionsFetchError({ requestId: 'abc123' })\n * ```\n */\nexport class FunctionsFetchError extends FunctionsError {\n    constructor(context) {\n        super('Failed to send a request to the Edge Function', 'FunctionsFetchError', context);\n    }\n}\n/**\n * Error thrown when the Supabase relay cannot reach the Edge Function.\n *\n * @example\n * ```ts\n * import { FunctionsRelayError } from '@supabase/functions-js'\n *\n * throw new FunctionsRelayError({ region: 'us-east-1' })\n * ```\n */\nexport class FunctionsRelayError extends FunctionsError {\n    constructor(context) {\n        super('Relay Error invoking the Edge Function', 'FunctionsRelayError', context);\n    }\n}\n/**\n * Error thrown when the Edge Function returns a non-2xx status code.\n *\n * @example\n * ```ts\n * import { FunctionsHttpError } from '@supabase/functions-js'\n *\n * throw new FunctionsHttpError({ status: 500 })\n * ```\n */\nexport class FunctionsHttpError extends FunctionsError {\n    constructor(context) {\n        super('Edge Function returned a non-2xx status code', 'FunctionsHttpError', context);\n    }\n}\n// Define the enum for the 'region' property\nexport var FunctionRegion;\n(function (FunctionRegion) {\n    FunctionRegion[\"Any\"] = \"any\";\n    FunctionRegion[\"ApNortheast1\"] = \"ap-northeast-1\";\n    FunctionRegion[\"ApNortheast2\"] = \"ap-northeast-2\";\n    FunctionRegion[\"ApSouth1\"] = \"ap-south-1\";\n    FunctionRegion[\"ApSoutheast1\"] = \"ap-southeast-1\";\n    FunctionRegion[\"ApSoutheast2\"] = \"ap-southeast-2\";\n    FunctionRegion[\"CaCentral1\"] = \"ca-central-1\";\n    FunctionRegion[\"EuCentral1\"] = \"eu-central-1\";\n    FunctionRegion[\"EuWest1\"] = \"eu-west-1\";\n    FunctionRegion[\"EuWest2\"] = \"eu-west-2\";\n    FunctionRegion[\"EuWest3\"] = \"eu-west-3\";\n    FunctionRegion[\"SaEast1\"] = \"sa-east-1\";\n    FunctionRegion[\"UsEast1\"] = \"us-east-1\";\n    FunctionRegion[\"UsWest1\"] = \"us-west-1\";\n    FunctionRegion[\"UsWest2\"] = \"us-west-2\";\n})(FunctionRegion || (FunctionRegion = {}));\n//# sourceMappingURL=types.js.map","import { __awaiter } from \"tslib\";\nimport { resolveFetch } from './helper';\nimport { FunctionRegion, FunctionsFetchError, FunctionsHttpError, FunctionsRelayError, } from './types';\n/**\n * Client for invoking Supabase Edge Functions.\n */\nexport class FunctionsClient {\n    /**\n     * Creates a new Functions client bound to an Edge Functions URL.\n     *\n     * @example\n     * ```ts\n     * import { FunctionsClient, FunctionRegion } from '@supabase/functions-js'\n     *\n     * const functions = new FunctionsClient('https://xyzcompany.supabase.co/functions/v1', {\n     *   headers: { apikey: 'public-anon-key' },\n     *   region: FunctionRegion.UsEast1,\n     * })\n     * ```\n     */\n    constructor(url, { headers = {}, customFetch, region = FunctionRegion.Any, } = {}) {\n        this.url = url;\n        this.headers = headers;\n        this.region = region;\n        this.fetch = resolveFetch(customFetch);\n    }\n    /**\n     * Updates the authorization header\n     * @param token - the new jwt token sent in the authorisation header\n     * @example\n     * ```ts\n     * functions.setAuth(session.access_token)\n     * ```\n     */\n    setAuth(token) {\n        this.headers.Authorization = `Bearer ${token}`;\n    }\n    /**\n     * Invokes a function\n     * @param functionName - The name of the Function to invoke.\n     * @param options - Options for invoking the Function.\n     * @example\n     * ```ts\n     * const { data, error } = await functions.invoke('hello-world', {\n     *   body: { name: 'Ada' },\n     * })\n     * ```\n     */\n    invoke(functionName_1) {\n        return __awaiter(this, arguments, void 0, function* (functionName, options = {}) {\n            var _a;\n            let timeoutId;\n            let timeoutController;\n            try {\n                const { headers, method, body: functionArgs, signal, timeout } = options;\n                let _headers = {};\n                let { region } = options;\n                if (!region) {\n                    region = this.region;\n                }\n                // Add region as query parameter using URL API\n                const url = new URL(`${this.url}/${functionName}`);\n                if (region && region !== 'any') {\n                    _headers['x-region'] = region;\n                    url.searchParams.set('forceFunctionRegion', region);\n                }\n                let body;\n                if (functionArgs &&\n                    ((headers && !Object.prototype.hasOwnProperty.call(headers, 'Content-Type')) || !headers)) {\n                    if ((typeof Blob !== 'undefined' && functionArgs instanceof Blob) ||\n                        functionArgs instanceof ArrayBuffer) {\n                        // will work for File as File inherits Blob\n                        // also works for ArrayBuffer as it is the same underlying structure as a Blob\n                        _headers['Content-Type'] = 'application/octet-stream';\n                        body = functionArgs;\n                    }\n                    else if (typeof functionArgs === 'string') {\n                        // plain string\n                        _headers['Content-Type'] = 'text/plain';\n                        body = functionArgs;\n                    }\n                    else if (typeof FormData !== 'undefined' && functionArgs instanceof FormData) {\n                        // don't set content-type headers\n                        // Request will automatically add the right boundary value\n                        body = functionArgs;\n                    }\n                    else {\n                        // default, assume this is JSON\n                        _headers['Content-Type'] = 'application/json';\n                        body = JSON.stringify(functionArgs);\n                    }\n                }\n                else {\n                    // if the Content-Type was supplied, simply set the body\n                    body = functionArgs;\n                }\n                // Handle timeout by creating an AbortController\n                let effectiveSignal = signal;\n                if (timeout) {\n                    timeoutController = new AbortController();\n                    timeoutId = setTimeout(() => timeoutController.abort(), timeout);\n                    // If user provided their own signal, we need to respect both\n                    if (signal) {\n                        effectiveSignal = timeoutController.signal;\n                        // If the user's signal is aborted, abort our timeout controller too\n                        signal.addEventListener('abort', () => timeoutController.abort());\n                    }\n                    else {\n                        effectiveSignal = timeoutController.signal;\n                    }\n                }\n                const response = yield this.fetch(url.toString(), {\n                    method: method || 'POST',\n                    // headers priority is (high to low):\n                    // 1. invoke-level headers\n                    // 2. client-level headers\n                    // 3. default Content-Type header\n                    headers: Object.assign(Object.assign(Object.assign({}, _headers), this.headers), headers),\n                    body,\n                    signal: effectiveSignal,\n                }).catch((fetchError) => {\n                    throw new FunctionsFetchError(fetchError);\n                });\n                const isRelayError = response.headers.get('x-relay-error');\n                if (isRelayError && isRelayError === 'true') {\n                    throw new FunctionsRelayError(response);\n                }\n                if (!response.ok) {\n                    throw new FunctionsHttpError(response);\n                }\n                let responseType = ((_a = response.headers.get('Content-Type')) !== null && _a !== void 0 ? _a : 'text/plain').split(';')[0].trim();\n                let data;\n                if (responseType === 'application/json') {\n                    data = yield response.json();\n                }\n                else if (responseType === 'application/octet-stream' ||\n                    responseType === 'application/pdf') {\n                    data = yield response.blob();\n                }\n                else if (responseType === 'text/event-stream') {\n                    data = response;\n                }\n                else if (responseType === 'multipart/form-data') {\n                    data = yield response.formData();\n                }\n                else {\n                    // default to text\n                    data = yield response.text();\n                }\n                return { data, error: null, response };\n            }\n            catch (error) {\n                return {\n                    data: null,\n                    error,\n                    response: error instanceof FunctionsHttpError || error instanceof FunctionsRelayError\n                        ? error.context\n                        : undefined,\n                };\n            }\n            finally {\n                // Clear the timeout if it was set\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n            }\n        });\n    }\n}\n//# sourceMappingURL=FunctionsClient.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Error format\n *\n * {@link https://postgrest.org/en/stable/api.html?highlight=options#errors-and-http-status-codes}\n */\nclass PostgrestError extends Error {\n    /**\n     * @example\n     * ```ts\n     * import PostgrestError from '@supabase/postgrest-js'\n     *\n     * throw new PostgrestError({\n     *   message: 'Row level security prevented the request',\n     *   details: 'RLS denied the insert',\n     *   hint: 'Check your policies',\n     *   code: 'PGRST301',\n     * })\n     * ```\n     */\n    constructor(context) {\n        super(context.message);\n        this.name = 'PostgrestError';\n        this.details = context.details;\n        this.hint = context.hint;\n        this.code = context.code;\n    }\n}\nexports.default = PostgrestError;\n//# sourceMappingURL=PostgrestError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestError_1 = tslib_1.__importDefault(require(\"./PostgrestError\"));\nclass PostgrestBuilder {\n    /**\n     * Creates a builder configured for a specific PostgREST request.\n     *\n     * @example\n     * ```ts\n     * import PostgrestQueryBuilder from '@supabase/postgrest-js'\n     *\n     * const builder = new PostgrestQueryBuilder(\n     *   new URL('https://xyzcompany.supabase.co/rest/v1/users'),\n     *   { headers: new Headers({ apikey: 'public-anon-key' }) }\n     * )\n     * ```\n     */\n    constructor(builder) {\n        var _a, _b;\n        this.shouldThrowOnError = false;\n        this.method = builder.method;\n        this.url = builder.url;\n        this.headers = new Headers(builder.headers);\n        this.schema = builder.schema;\n        this.body = builder.body;\n        this.shouldThrowOnError = (_a = builder.shouldThrowOnError) !== null && _a !== void 0 ? _a : false;\n        this.signal = builder.signal;\n        this.isMaybeSingle = (_b = builder.isMaybeSingle) !== null && _b !== void 0 ? _b : false;\n        if (builder.fetch) {\n            this.fetch = builder.fetch;\n        }\n        else {\n            this.fetch = fetch;\n        }\n    }\n    /**\n     * If there's an error with the query, throwOnError will reject the promise by\n     * throwing the error instead of returning it as part of a successful response.\n     *\n     * {@link https://github.com/supabase/supabase-js/issues/92}\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Set an HTTP header for the request.\n     */\n    setHeader(name, value) {\n        this.headers = new Headers(this.headers);\n        this.headers.set(name, value);\n        return this;\n    }\n    then(onfulfilled, onrejected) {\n        // https://postgrest.org/en/stable/api.html#switching-schemas\n        if (this.schema === undefined) {\n            // skip\n        }\n        else if (['GET', 'HEAD'].includes(this.method)) {\n            this.headers.set('Accept-Profile', this.schema);\n        }\n        else {\n            this.headers.set('Content-Profile', this.schema);\n        }\n        if (this.method !== 'GET' && this.method !== 'HEAD') {\n            this.headers.set('Content-Type', 'application/json');\n        }\n        // NOTE: Invoke w/o `this` to avoid illegal invocation error.\n        // https://github.com/supabase/postgrest-js/pull/247\n        const _fetch = this.fetch;\n        let res = _fetch(this.url.toString(), {\n            method: this.method,\n            headers: this.headers,\n            body: JSON.stringify(this.body),\n            signal: this.signal,\n        }).then(async (res) => {\n            var _a, _b, _c, _d;\n            let error = null;\n            let data = null;\n            let count = null;\n            let status = res.status;\n            let statusText = res.statusText;\n            if (res.ok) {\n                if (this.method !== 'HEAD') {\n                    const body = await res.text();\n                    if (body === '') {\n                        // Prefer: return=minimal\n                    }\n                    else if (this.headers.get('Accept') === 'text/csv') {\n                        data = body;\n                    }\n                    else if (this.headers.get('Accept') &&\n                        ((_a = this.headers.get('Accept')) === null || _a === void 0 ? void 0 : _a.includes('application/vnd.pgrst.plan+text'))) {\n                        data = body;\n                    }\n                    else {\n                        data = JSON.parse(body);\n                    }\n                }\n                const countHeader = (_b = this.headers.get('Prefer')) === null || _b === void 0 ? void 0 : _b.match(/count=(exact|planned|estimated)/);\n                const contentRange = (_c = res.headers.get('content-range')) === null || _c === void 0 ? void 0 : _c.split('/');\n                if (countHeader && contentRange && contentRange.length > 1) {\n                    count = parseInt(contentRange[1]);\n                }\n                // Temporary partial fix for https://github.com/supabase/postgrest-js/issues/361\n                // Issue persists e.g. for `.insert([...]).select().maybeSingle()`\n                if (this.isMaybeSingle && this.method === 'GET' && Array.isArray(data)) {\n                    if (data.length > 1) {\n                        error = {\n                            // https://github.com/PostgREST/postgrest/blob/a867d79c42419af16c18c3fb019eba8df992626f/src/PostgREST/Error.hs#L553\n                            code: 'PGRST116',\n                            details: `Results contain ${data.length} rows, application/vnd.pgrst.object+json requires 1 row`,\n                            hint: null,\n                            message: 'JSON object requested, multiple (or no) rows returned',\n                        };\n                        data = null;\n                        count = null;\n                        status = 406;\n                        statusText = 'Not Acceptable';\n                    }\n                    else if (data.length === 1) {\n                        data = data[0];\n                    }\n                    else {\n                        data = null;\n                    }\n                }\n            }\n            else {\n                const body = await res.text();\n                try {\n                    error = JSON.parse(body);\n                    // Workaround for https://github.com/supabase/postgrest-js/issues/295\n                    if (Array.isArray(error) && res.status === 404) {\n                        data = [];\n                        error = null;\n                        status = 200;\n                        statusText = 'OK';\n                    }\n                }\n                catch (_e) {\n                    // Workaround for https://github.com/supabase/postgrest-js/issues/295\n                    if (res.status === 404 && body === '') {\n                        status = 204;\n                        statusText = 'No Content';\n                    }\n                    else {\n                        error = {\n                            message: body,\n                        };\n                    }\n                }\n                if (error && this.isMaybeSingle && ((_d = error === null || error === void 0 ? void 0 : error.details) === null || _d === void 0 ? void 0 : _d.includes('0 rows'))) {\n                    error = null;\n                    status = 200;\n                    statusText = 'OK';\n                }\n                if (error && this.shouldThrowOnError) {\n                    throw new PostgrestError_1.default(error);\n                }\n            }\n            const postgrestResponse = {\n                error,\n                data,\n                count,\n                status,\n                statusText,\n            };\n            return postgrestResponse;\n        });\n        if (!this.shouldThrowOnError) {\n            res = res.catch((fetchError) => {\n                var _a, _b, _c, _d, _e, _f;\n                // Build detailed error information including cause if available\n                // Note: We don't populate code/hint for client-side network errors since those\n                // fields are meant for upstream service errors (PostgREST/PostgreSQL)\n                let errorDetails = '';\n                // Add cause information if available (e.g., DNS errors, network failures)\n                const cause = fetchError === null || fetchError === void 0 ? void 0 : fetchError.cause;\n                if (cause) {\n                    const causeMessage = (_a = cause === null || cause === void 0 ? void 0 : cause.message) !== null && _a !== void 0 ? _a : '';\n                    const causeCode = (_b = cause === null || cause === void 0 ? void 0 : cause.code) !== null && _b !== void 0 ? _b : '';\n                    errorDetails = `${(_c = fetchError === null || fetchError === void 0 ? void 0 : fetchError.name) !== null && _c !== void 0 ? _c : 'FetchError'}: ${fetchError === null || fetchError === void 0 ? void 0 : fetchError.message}`;\n                    errorDetails += `\\n\\nCaused by: ${(_d = cause === null || cause === void 0 ? void 0 : cause.name) !== null && _d !== void 0 ? _d : 'Error'}: ${causeMessage}`;\n                    if (causeCode) {\n                        errorDetails += ` (${causeCode})`;\n                    }\n                    if (cause === null || cause === void 0 ? void 0 : cause.stack) {\n                        errorDetails += `\\n${cause.stack}`;\n                    }\n                }\n                else {\n                    // No cause available, just include the error stack\n                    errorDetails = (_e = fetchError === null || fetchError === void 0 ? void 0 : fetchError.stack) !== null && _e !== void 0 ? _e : '';\n                }\n                return {\n                    error: {\n                        message: `${(_f = fetchError === null || fetchError === void 0 ? void 0 : fetchError.name) !== null && _f !== void 0 ? _f : 'FetchError'}: ${fetchError === null || fetchError === void 0 ? void 0 : fetchError.message}`,\n                        details: errorDetails,\n                        hint: '',\n                        code: '',\n                    },\n                    data: null,\n                    count: null,\n                    status: 0,\n                    statusText: '',\n                };\n            });\n        }\n        return res.then(onfulfilled, onrejected);\n    }\n    /**\n     * Override the type of the returned `data`.\n     *\n     * @typeParam NewResult - The new result type to override with\n     * @deprecated Use overrideTypes<yourType, { merge: false }>() method at the end of your call chain instead\n     */\n    returns() {\n        /* istanbul ignore next */\n        return this;\n    }\n    /**\n     * Override the type of the returned `data` field in the response.\n     *\n     * @typeParam NewResult - The new type to cast the response data to\n     * @typeParam Options - Optional type configuration (defaults to { merge: true })\n     * @typeParam Options.merge - When true, merges the new type with existing return type. When false, replaces the existing types entirely (defaults to true)\n     * @example\n     * ```typescript\n     * // Merge with existing types (default behavior)\n     * const query = supabase\n     *   .from('users')\n     *   .select()\n     *   .overrideTypes<{ custom_field: string }>()\n     *\n     * // Replace existing types completely\n     * const replaceQuery = supabase\n     *   .from('users')\n     *   .select()\n     *   .overrideTypes<{ id: number; name: string }, { merge: false }>()\n     * ```\n     * @returns A PostgrestBuilder instance with the new type\n     */\n    overrideTypes() {\n        return this;\n    }\n}\nexports.default = PostgrestBuilder;\n//# sourceMappingURL=PostgrestBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestBuilder\"));\nclass PostgrestTransformBuilder extends PostgrestBuilder_1.default {\n    /**\n     * Perform a SELECT on the query result.\n     *\n     * By default, `.insert()`, `.update()`, `.upsert()`, and `.delete()` do not\n     * return modified rows. By calling this method, modified rows are returned in\n     * `data`.\n     *\n     * @param columns - The columns to retrieve, separated by commas\n     */\n    select(columns) {\n        // Remove whitespaces except when quoted\n        let quoted = false;\n        const cleanedColumns = (columns !== null && columns !== void 0 ? columns : '*')\n            .split('')\n            .map((c) => {\n            if (/\\s/.test(c) && !quoted) {\n                return '';\n            }\n            if (c === '\"') {\n                quoted = !quoted;\n            }\n            return c;\n        })\n            .join('');\n        this.url.searchParams.set('select', cleanedColumns);\n        this.headers.append('Prefer', 'return=representation');\n        return this;\n    }\n    /**\n     * Order the query result by `column`.\n     *\n     * You can call this method multiple times to order by multiple columns.\n     *\n     * You can order referenced tables, but it only affects the ordering of the\n     * parent table if you use `!inner` in the query.\n     *\n     * @param column - The column to order by\n     * @param options - Named parameters\n     * @param options.ascending - If `true`, the result will be in ascending order\n     * @param options.nullsFirst - If `true`, `null`s appear first. If `false`,\n     * `null`s appear last.\n     * @param options.referencedTable - Set this to order a referenced table by\n     * its columns\n     * @param options.foreignTable - Deprecated, use `options.referencedTable`\n     * instead\n     */\n    order(column, { ascending = true, nullsFirst, foreignTable, referencedTable = foreignTable, } = {}) {\n        const key = referencedTable ? `${referencedTable}.order` : 'order';\n        const existingOrder = this.url.searchParams.get(key);\n        this.url.searchParams.set(key, `${existingOrder ? `${existingOrder},` : ''}${column}.${ascending ? 'asc' : 'desc'}${nullsFirst === undefined ? '' : nullsFirst ? '.nullsfirst' : '.nullslast'}`);\n        return this;\n    }\n    /**\n     * Limit the query result by `count`.\n     *\n     * @param count - The maximum number of rows to return\n     * @param options - Named parameters\n     * @param options.referencedTable - Set this to limit rows of referenced\n     * tables instead of the parent table\n     * @param options.foreignTable - Deprecated, use `options.referencedTable`\n     * instead\n     */\n    limit(count, { foreignTable, referencedTable = foreignTable, } = {}) {\n        const key = typeof referencedTable === 'undefined' ? 'limit' : `${referencedTable}.limit`;\n        this.url.searchParams.set(key, `${count}`);\n        return this;\n    }\n    /**\n     * Limit the query result by starting at an offset `from` and ending at the offset `to`.\n     * Only records within this range are returned.\n     * This respects the query order and if there is no order clause the range could behave unexpectedly.\n     * The `from` and `to` values are 0-based and inclusive: `range(1, 3)` will include the second, third\n     * and fourth rows of the query.\n     *\n     * @param from - The starting index from which to limit the result\n     * @param to - The last index to which to limit the result\n     * @param options - Named parameters\n     * @param options.referencedTable - Set this to limit rows of referenced\n     * tables instead of the parent table\n     * @param options.foreignTable - Deprecated, use `options.referencedTable`\n     * instead\n     */\n    range(from, to, { foreignTable, referencedTable = foreignTable, } = {}) {\n        const keyOffset = typeof referencedTable === 'undefined' ? 'offset' : `${referencedTable}.offset`;\n        const keyLimit = typeof referencedTable === 'undefined' ? 'limit' : `${referencedTable}.limit`;\n        this.url.searchParams.set(keyOffset, `${from}`);\n        // Range is inclusive, so add 1\n        this.url.searchParams.set(keyLimit, `${to - from + 1}`);\n        return this;\n    }\n    /**\n     * Set the AbortSignal for the fetch request.\n     *\n     * @param signal - The AbortSignal to use for the fetch request\n     */\n    abortSignal(signal) {\n        this.signal = signal;\n        return this;\n    }\n    /**\n     * Return `data` as a single object instead of an array of objects.\n     *\n     * Query result must be one row (e.g. using `.limit(1)`), otherwise this\n     * returns an error.\n     */\n    single() {\n        this.headers.set('Accept', 'application/vnd.pgrst.object+json');\n        return this;\n    }\n    /**\n     * Return `data` as a single object instead of an array of objects.\n     *\n     * Query result must be zero or one row (e.g. using `.limit(1)`), otherwise\n     * this returns an error.\n     */\n    maybeSingle() {\n        // Temporary partial fix for https://github.com/supabase/postgrest-js/issues/361\n        // Issue persists e.g. for `.insert([...]).select().maybeSingle()`\n        if (this.method === 'GET') {\n            this.headers.set('Accept', 'application/json');\n        }\n        else {\n            this.headers.set('Accept', 'application/vnd.pgrst.object+json');\n        }\n        this.isMaybeSingle = true;\n        return this;\n    }\n    /**\n     * Return `data` as a string in CSV format.\n     */\n    csv() {\n        this.headers.set('Accept', 'text/csv');\n        return this;\n    }\n    /**\n     * Return `data` as an object in [GeoJSON](https://geojson.org) format.\n     */\n    geojson() {\n        this.headers.set('Accept', 'application/geo+json');\n        return this;\n    }\n    /**\n     * Return `data` as the EXPLAIN plan for the query.\n     *\n     * You need to enable the\n     * [db_plan_enabled](https://supabase.com/docs/guides/database/debugging-performance#enabling-explain)\n     * setting before using this method.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.analyze - If `true`, the query will be executed and the\n     * actual run time will be returned\n     *\n     * @param options.verbose - If `true`, the query identifier will be returned\n     * and `data` will include the output columns of the query\n     *\n     * @param options.settings - If `true`, include information on configuration\n     * parameters that affect query planning\n     *\n     * @param options.buffers - If `true`, include information on buffer usage\n     *\n     * @param options.wal - If `true`, include information on WAL record generation\n     *\n     * @param options.format - The format of the output, can be `\"text\"` (default)\n     * or `\"json\"`\n     */\n    explain({ analyze = false, verbose = false, settings = false, buffers = false, wal = false, format = 'text', } = {}) {\n        var _a;\n        const options = [\n            analyze ? 'analyze' : null,\n            verbose ? 'verbose' : null,\n            settings ? 'settings' : null,\n            buffers ? 'buffers' : null,\n            wal ? 'wal' : null,\n        ]\n            .filter(Boolean)\n            .join('|');\n        // An Accept header can carry multiple media types but postgrest-js always sends one\n        const forMediatype = (_a = this.headers.get('Accept')) !== null && _a !== void 0 ? _a : 'application/json';\n        this.headers.set('Accept', `application/vnd.pgrst.plan+${format}; for=\"${forMediatype}\"; options=${options};`);\n        if (format === 'json') {\n            return this;\n        }\n        else {\n            return this;\n        }\n    }\n    /**\n     * Rollback the query.\n     *\n     * `data` will still be returned, but the query is not committed.\n     */\n    rollback() {\n        this.headers.append('Prefer', 'tx=rollback');\n        return this;\n    }\n    /**\n     * Override the type of the returned `data`.\n     *\n     * @typeParam NewResult - The new result type to override with\n     * @deprecated Use overrideTypes<yourType, { merge: false }>() method at the end of your call chain instead\n     */\n    returns() {\n        return this;\n    }\n    /**\n     * Set the maximum number of rows that can be affected by the query.\n     * Only available in PostgREST v13+ and only works with PATCH and DELETE methods.\n     *\n     * @param value - The maximum number of rows that can be affected\n     */\n    maxAffected(value) {\n        this.headers.append('Prefer', 'handling=strict');\n        this.headers.append('Prefer', `max-affected=${value}`);\n        return this;\n    }\n}\nexports.default = PostgrestTransformBuilder;\n//# sourceMappingURL=PostgrestTransformBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestTransformBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestTransformBuilder\"));\nconst PostgrestReservedCharsRegexp = new RegExp('[,()]');\nclass PostgrestFilterBuilder extends PostgrestTransformBuilder_1.default {\n    /**\n     * Match only rows where `column` is equal to `value`.\n     *\n     * To check if the value of `column` is NULL, you should use `.is()` instead.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    eq(column, value) {\n        this.url.searchParams.append(column, `eq.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is not equal to `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    neq(column, value) {\n        this.url.searchParams.append(column, `neq.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is greater than `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    gt(column, value) {\n        this.url.searchParams.append(column, `gt.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is greater than or equal to `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    gte(column, value) {\n        this.url.searchParams.append(column, `gte.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is less than `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    lt(column, value) {\n        this.url.searchParams.append(column, `lt.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is less than or equal to `value`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    lte(column, value) {\n        this.url.searchParams.append(column, `lte.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches `pattern` case-sensitively.\n     *\n     * @param column - The column to filter on\n     * @param pattern - The pattern to match with\n     */\n    like(column, pattern) {\n        this.url.searchParams.append(column, `like.${pattern}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches all of `patterns` case-sensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    likeAllOf(column, patterns) {\n        this.url.searchParams.append(column, `like(all).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches any of `patterns` case-sensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    likeAnyOf(column, patterns) {\n        this.url.searchParams.append(column, `like(any).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches `pattern` case-insensitively.\n     *\n     * @param column - The column to filter on\n     * @param pattern - The pattern to match with\n     */\n    ilike(column, pattern) {\n        this.url.searchParams.append(column, `ilike.${pattern}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches all of `patterns` case-insensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    ilikeAllOf(column, patterns) {\n        this.url.searchParams.append(column, `ilike(all).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches any of `patterns` case-insensitively.\n     *\n     * @param column - The column to filter on\n     * @param patterns - The patterns to match with\n     */\n    ilikeAnyOf(column, patterns) {\n        this.url.searchParams.append(column, `ilike(any).{${patterns.join(',')}}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches the PostgreSQL regex `pattern`\n     * case-sensitively (using the `~` operator).\n     *\n     * @param column - The column to filter on\n     * @param pattern - The PostgreSQL regular expression pattern to match with\n     */\n    regexMatch(column, pattern) {\n        this.url.searchParams.append(column, `match.${pattern}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` matches the PostgreSQL regex `pattern`\n     * case-insensitively (using the `~*` operator).\n     *\n     * @param column - The column to filter on\n     * @param pattern - The PostgreSQL regular expression pattern to match with\n     */\n    regexIMatch(column, pattern) {\n        this.url.searchParams.append(column, `imatch.${pattern}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` IS `value`.\n     *\n     * For non-boolean columns, this is only relevant for checking if the value of\n     * `column` is NULL by setting `value` to `null`.\n     *\n     * For boolean columns, you can also set `value` to `true` or `false` and it\n     * will behave the same way as `.eq()`.\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    is(column, value) {\n        this.url.searchParams.append(column, `is.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` IS DISTINCT FROM `value`.\n     *\n     * Unlike `.neq()`, this treats `NULL` as a comparable value. Two `NULL` values\n     * are considered equal (not distinct), and comparing `NULL` with any non-NULL\n     * value returns true (distinct).\n     *\n     * @param column - The column to filter on\n     * @param value - The value to filter with\n     */\n    isDistinct(column, value) {\n        this.url.searchParams.append(column, `isdistinct.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows where `column` is included in the `values` array.\n     *\n     * @param column - The column to filter on\n     * @param values - The values array to filter with\n     */\n    in(column, values) {\n        const cleanedValues = Array.from(new Set(values))\n            .map((s) => {\n            // handle postgrest reserved characters\n            // https://postgrest.org/en/v7.0.0/api.html#reserved-characters\n            if (typeof s === 'string' && PostgrestReservedCharsRegexp.test(s))\n                return `\"${s}\"`;\n            else\n                return `${s}`;\n        })\n            .join(',');\n        this.url.searchParams.append(column, `in.(${cleanedValues})`);\n        return this;\n    }\n    /**\n     * Only relevant for jsonb, array, and range columns. Match only rows where\n     * `column` contains every element appearing in `value`.\n     *\n     * @param column - The jsonb, array, or range column to filter on\n     * @param value - The jsonb, array, or range value to filter with\n     */\n    contains(column, value) {\n        if (typeof value === 'string') {\n            // range types can be inclusive '[', ']' or exclusive '(', ')' so just\n            // keep it simple and accept a string\n            this.url.searchParams.append(column, `cs.${value}`);\n        }\n        else if (Array.isArray(value)) {\n            // array\n            this.url.searchParams.append(column, `cs.{${value.join(',')}}`);\n        }\n        else {\n            // json\n            this.url.searchParams.append(column, `cs.${JSON.stringify(value)}`);\n        }\n        return this;\n    }\n    /**\n     * Only relevant for jsonb, array, and range columns. Match only rows where\n     * every element appearing in `column` is contained by `value`.\n     *\n     * @param column - The jsonb, array, or range column to filter on\n     * @param value - The jsonb, array, or range value to filter with\n     */\n    containedBy(column, value) {\n        if (typeof value === 'string') {\n            // range\n            this.url.searchParams.append(column, `cd.${value}`);\n        }\n        else if (Array.isArray(value)) {\n            // array\n            this.url.searchParams.append(column, `cd.{${value.join(',')}}`);\n        }\n        else {\n            // json\n            this.url.searchParams.append(column, `cd.${JSON.stringify(value)}`);\n        }\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is greater than any element in `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeGt(column, range) {\n        this.url.searchParams.append(column, `sr.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is either contained in `range` or greater than any element in\n     * `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeGte(column, range) {\n        this.url.searchParams.append(column, `nxl.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is less than any element in `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeLt(column, range) {\n        this.url.searchParams.append(column, `sl.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where every element in\n     * `column` is either contained in `range` or less than any element in\n     * `range`.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeLte(column, range) {\n        this.url.searchParams.append(column, `nxr.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for range columns. Match only rows where `column` is\n     * mutually exclusive to `range` and there can be no element between the two\n     * ranges.\n     *\n     * @param column - The range column to filter on\n     * @param range - The range to filter with\n     */\n    rangeAdjacent(column, range) {\n        this.url.searchParams.append(column, `adj.${range}`);\n        return this;\n    }\n    /**\n     * Only relevant for array and range columns. Match only rows where\n     * `column` and `value` have an element in common.\n     *\n     * @param column - The array or range column to filter on\n     * @param value - The array or range value to filter with\n     */\n    overlaps(column, value) {\n        if (typeof value === 'string') {\n            // range\n            this.url.searchParams.append(column, `ov.${value}`);\n        }\n        else {\n            // array\n            this.url.searchParams.append(column, `ov.{${value.join(',')}}`);\n        }\n        return this;\n    }\n    /**\n     * Only relevant for text and tsvector columns. Match only rows where\n     * `column` matches the query string in `query`.\n     *\n     * @param column - The text or tsvector column to filter on\n     * @param query - The query text to match with\n     * @param options - Named parameters\n     * @param options.config - The text search configuration to use\n     * @param options.type - Change how the `query` text is interpreted\n     */\n    textSearch(column, query, { config, type } = {}) {\n        let typePart = '';\n        if (type === 'plain') {\n            typePart = 'pl';\n        }\n        else if (type === 'phrase') {\n            typePart = 'ph';\n        }\n        else if (type === 'websearch') {\n            typePart = 'w';\n        }\n        const configPart = config === undefined ? '' : `(${config})`;\n        this.url.searchParams.append(column, `${typePart}fts${configPart}.${query}`);\n        return this;\n    }\n    /**\n     * Match only rows where each column in `query` keys is equal to its\n     * associated value. Shorthand for multiple `.eq()`s.\n     *\n     * @param query - The object to filter with, with column names as keys mapped\n     * to their filter values\n     */\n    match(query) {\n        Object.entries(query).forEach(([column, value]) => {\n            this.url.searchParams.append(column, `eq.${value}`);\n        });\n        return this;\n    }\n    /**\n     * Match only rows which doesn't satisfy the filter.\n     *\n     * Unlike most filters, `opearator` and `value` are used as-is and need to\n     * follow [PostgREST\n     * syntax](https://postgrest.org/en/stable/api.html#operators). You also need\n     * to make sure they are properly sanitized.\n     *\n     * @param column - The column to filter on\n     * @param operator - The operator to be negated to filter with, following\n     * PostgREST syntax\n     * @param value - The value to filter with, following PostgREST syntax\n     */\n    not(column, operator, value) {\n        this.url.searchParams.append(column, `not.${operator}.${value}`);\n        return this;\n    }\n    /**\n     * Match only rows which satisfy at least one of the filters.\n     *\n     * Unlike most filters, `filters` is used as-is and needs to follow [PostgREST\n     * syntax](https://postgrest.org/en/stable/api.html#operators). You also need\n     * to make sure it's properly sanitized.\n     *\n     * It's currently not possible to do an `.or()` filter across multiple tables.\n     *\n     * @param filters - The filters to use, following PostgREST syntax\n     * @param options - Named parameters\n     * @param options.referencedTable - Set this to filter on referenced tables\n     * instead of the parent table\n     * @param options.foreignTable - Deprecated, use `referencedTable` instead\n     */\n    or(filters, { foreignTable, referencedTable = foreignTable, } = {}) {\n        const key = referencedTable ? `${referencedTable}.or` : 'or';\n        this.url.searchParams.append(key, `(${filters})`);\n        return this;\n    }\n    /**\n     * Match only rows which satisfy the filter. This is an escape hatch - you\n     * should use the specific filter methods wherever possible.\n     *\n     * Unlike most filters, `opearator` and `value` are used as-is and need to\n     * follow [PostgREST\n     * syntax](https://postgrest.org/en/stable/api.html#operators). You also need\n     * to make sure they are properly sanitized.\n     *\n     * @param column - The column to filter on\n     * @param operator - The operator to filter with, following PostgREST syntax\n     * @param value - The value to filter with, following PostgREST syntax\n     */\n    filter(column, operator, value) {\n        this.url.searchParams.append(column, `${operator}.${value}`);\n        return this;\n    }\n}\nexports.default = PostgrestFilterBuilder;\n//# sourceMappingURL=PostgrestFilterBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestFilterBuilder\"));\nclass PostgrestQueryBuilder {\n    /**\n     * Creates a query builder scoped to a Postgres table or view.\n     *\n     * @example\n     * ```ts\n     * import PostgrestQueryBuilder from '@supabase/postgrest-js'\n     *\n     * const query = new PostgrestQueryBuilder(\n     *   new URL('https://xyzcompany.supabase.co/rest/v1/users'),\n     *   { headers: { apikey: 'public-anon-key' } }\n     * )\n     * ```\n     */\n    constructor(url, { headers = {}, schema, fetch, }) {\n        this.url = url;\n        this.headers = new Headers(headers);\n        this.schema = schema;\n        this.fetch = fetch;\n    }\n    /**\n     * Perform a SELECT query on the table or view.\n     *\n     * @param columns - The columns to retrieve, separated by commas. Columns can be renamed when returned with `customName:columnName`\n     *\n     * @param options - Named parameters\n     *\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     *\n     * @param options.count - Count algorithm to use to count rows in the table or view.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    select(columns, options) {\n        const { head = false, count } = options !== null && options !== void 0 ? options : {};\n        const method = head ? 'HEAD' : 'GET';\n        // Remove whitespaces except when quoted\n        let quoted = false;\n        const cleanedColumns = (columns !== null && columns !== void 0 ? columns : '*')\n            .split('')\n            .map((c) => {\n            if (/\\s/.test(c) && !quoted) {\n                return '';\n            }\n            if (c === '\"') {\n                quoted = !quoted;\n            }\n            return c;\n        })\n            .join('');\n        this.url.searchParams.set('select', cleanedColumns);\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Perform an INSERT into the table or view.\n     *\n     * By default, inserted rows are not returned. To return it, chain the call\n     * with `.select()`.\n     *\n     * @param values - The values to insert. Pass an object to insert a single row\n     * or an array to insert multiple rows.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.count - Count algorithm to use to count inserted rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     *\n     * @param options.defaultToNull - Make missing fields default to `null`.\n     * Otherwise, use the default value for the column. Only applies for bulk\n     * inserts.\n     */\n    insert(values, { count, defaultToNull = true, } = {}) {\n        var _a;\n        const method = 'POST';\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        if (!defaultToNull) {\n            this.headers.append('Prefer', `missing=default`);\n        }\n        if (Array.isArray(values)) {\n            const columns = values.reduce((acc, x) => acc.concat(Object.keys(x)), []);\n            if (columns.length > 0) {\n                const uniqueColumns = [...new Set(columns)].map((column) => `\"${column}\"`);\n                this.url.searchParams.set('columns', uniqueColumns.join(','));\n            }\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            body: values,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n    /**\n   * Perform an UPSERT on the table or view. Depending on the column(s) passed\n   * to `onConflict`, `.upsert()` allows you to perform the equivalent of\n   * `.insert()` if a row with the corresponding `onConflict` columns doesn't\n   * exist, or if it does exist, perform an alternative action depending on\n   * `ignoreDuplicates`.\n   *\n   * By default, upserted rows are not returned. To return it, chain the call\n   * with `.select()`.\n   *\n   * @param values - The values to upsert with. Pass an object to upsert a\n   * single row or an array to upsert multiple rows.\n   *\n   * @param options - Named parameters\n   *\n   * @param options.onConflict - Comma-separated UNIQUE column(s) to specify how\n   * duplicate rows are determined. Two rows are duplicates if all the\n   * `onConflict` columns are equal.\n   *\n   * @param options.ignoreDuplicates - If `true`, duplicate rows are ignored. If\n   * `false`, duplicate rows are merged with existing rows.\n   *\n   * @param options.count - Count algorithm to use to count upserted rows.\n   *\n   * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n   * hood.\n   *\n   * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n   * statistics under the hood.\n   *\n   * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n   * numbers.\n   *\n   * @param options.defaultToNull - Make missing fields default to `null`.\n   * Otherwise, use the default value for the column. This only applies when\n   * inserting new rows, not when merging with existing rows under\n   * `ignoreDuplicates: false`. This also only applies when doing bulk upserts.\n   *\n   * @example Upsert a single row using a unique key\n   * ```ts\n   * // Upserting a single row, overwriting based on the 'username' unique column\n   * const { data, error } = await supabase\n   *   .from('users')\n   *   .upsert({ username: 'supabot' }, { onConflict: 'username' })\n   *\n   * // Example response:\n   * // {\n   * //   data: [\n   * //     { id: 4, message: 'bar', username: 'supabot' }\n   * //   ],\n   * //   error: null\n   * // }\n   * ```\n   *\n   * @example Upsert with conflict resolution and exact row counting\n   * ```ts\n   * // Upserting and returning exact count\n   * const { data, error, count } = await supabase\n   *   .from('users')\n   *   .upsert(\n   *     {\n   *       id: 3,\n   *       message: 'foo',\n   *       username: 'supabot'\n   *     },\n   *     {\n   *       onConflict: 'username',\n   *       count: 'exact'\n   *     }\n   *   )\n   *\n   * // Example response:\n   * // {\n   * //   data: [\n   * //     {\n   * //       id: 42,\n   * //       handle: \"saoirse\",\n   * //       display_name: \"Saoirse\"\n   * //     }\n   * //   ],\n   * //   count: 1,\n   * //   error: null\n   * // }\n   * ```\n   */\n    upsert(values, { onConflict, ignoreDuplicates = false, count, defaultToNull = true, } = {}) {\n        var _a;\n        const method = 'POST';\n        this.headers.append('Prefer', `resolution=${ignoreDuplicates ? 'ignore' : 'merge'}-duplicates`);\n        if (onConflict !== undefined)\n            this.url.searchParams.set('on_conflict', onConflict);\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        if (!defaultToNull) {\n            this.headers.append('Prefer', 'missing=default');\n        }\n        if (Array.isArray(values)) {\n            const columns = values.reduce((acc, x) => acc.concat(Object.keys(x)), []);\n            if (columns.length > 0) {\n                const uniqueColumns = [...new Set(columns)].map((column) => `\"${column}\"`);\n                this.url.searchParams.set('columns', uniqueColumns.join(','));\n            }\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            body: values,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n    /**\n     * Perform an UPDATE on the table or view.\n     *\n     * By default, updated rows are not returned. To return it, chain the call\n     * with `.select()` after filters.\n     *\n     * @param values - The values to update with\n     *\n     * @param options - Named parameters\n     *\n     * @param options.count - Count algorithm to use to count updated rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    update(values, { count, } = {}) {\n        var _a;\n        const method = 'PATCH';\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            body: values,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n    /**\n     * Perform a DELETE on the table or view.\n     *\n     * By default, deleted rows are not returned. To return it, chain the call\n     * with `.select()` after filters.\n     *\n     * @param options - Named parameters\n     *\n     * @param options.count - Count algorithm to use to count deleted rows.\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    delete({ count, } = {}) {\n        var _a;\n        const method = 'DELETE';\n        if (count) {\n            this.headers.append('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url: this.url,\n            headers: this.headers,\n            schema: this.schema,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n}\nexports.default = PostgrestQueryBuilder;\n//# sourceMappingURL=PostgrestQueryBuilder.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst PostgrestQueryBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestQueryBuilder\"));\nconst PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestFilterBuilder\"));\n/**\n * PostgREST client.\n *\n * @typeParam Database - Types for the schema from the [type\n * generator](https://supabase.com/docs/reference/javascript/next/typescript-support)\n *\n * @typeParam SchemaName - Postgres schema to switch to. Must be a string\n * literal, the same one passed to the constructor. If the schema is not\n * `\"public\"`, this must be supplied manually.\n */\nclass PostgrestClient {\n    // TODO: Add back shouldThrowOnError once we figure out the typings\n    /**\n     * Creates a PostgREST client.\n     *\n     * @param url - URL of the PostgREST endpoint\n     * @param options - Named parameters\n     * @param options.headers - Custom headers\n     * @param options.schema - Postgres schema to switch to\n     * @param options.fetch - Custom fetch\n     * @example\n     * ```ts\n     * import PostgrestClient from '@supabase/postgrest-js'\n     *\n     * const postgrest = new PostgrestClient('https://xyzcompany.supabase.co/rest/v1', {\n     *   headers: { apikey: 'public-anon-key' },\n     *   schema: 'public',\n     * })\n     * ```\n     */\n    constructor(url, { headers = {}, schema, fetch, } = {}) {\n        this.url = url;\n        this.headers = new Headers(headers);\n        this.schemaName = schema;\n        this.fetch = fetch;\n    }\n    /**\n     * Perform a query on a table or a view.\n     *\n     * @param relation - The table or view name to query\n     */\n    from(relation) {\n        if (!relation || typeof relation !== 'string' || relation.trim() === '') {\n            throw new Error('Invalid relation name: relation must be a non-empty string.');\n        }\n        const url = new URL(`${this.url}/${relation}`);\n        return new PostgrestQueryBuilder_1.default(url, {\n            headers: new Headers(this.headers),\n            schema: this.schemaName,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Select a schema to query or perform an function (rpc) call.\n     *\n     * The schema needs to be on the list of exposed schemas inside Supabase.\n     *\n     * @param schema - The schema to query\n     */\n    schema(schema) {\n        return new PostgrestClient(this.url, {\n            headers: this.headers,\n            schema,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     * Perform a function call.\n     *\n     * @param fn - The function name to call\n     * @param args - The arguments to pass to the function call\n     * @param options - Named parameters\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     * @param options.get - When set to `true`, the function will be called with\n     * read-only access mode.\n     * @param options.count - Count algorithm to use to count rows returned by the\n     * function. Only applicable for [set-returning\n     * functions](https://www.postgresql.org/docs/current/functions-srf.html).\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    rpc(fn, args = {}, { head = false, get = false, count, } = {}) {\n        var _a;\n        let method;\n        const url = new URL(`${this.url}/rpc/${fn}`);\n        let body;\n        if (head || get) {\n            method = head ? 'HEAD' : 'GET';\n            Object.entries(args)\n                // params with undefined value needs to be filtered out, otherwise it'll\n                // show up as `?param=undefined`\n                .filter(([_, value]) => value !== undefined)\n                // array values need special syntax\n                .map(([name, value]) => [name, Array.isArray(value) ? `{${value.join(',')}}` : `${value}`])\n                .forEach(([name, value]) => {\n                url.searchParams.append(name, value);\n            });\n        }\n        else {\n            method = 'POST';\n            body = args;\n        }\n        const headers = new Headers(this.headers);\n        if (count) {\n            headers.set('Prefer', `count=${count}`);\n        }\n        return new PostgrestFilterBuilder_1.default({\n            method,\n            url,\n            headers,\n            schema: this.schemaName,\n            body,\n            fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch,\n        });\n    }\n}\nexports.default = PostgrestClient;\n//# sourceMappingURL=PostgrestClient.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PostgrestError = exports.PostgrestBuilder = exports.PostgrestTransformBuilder = exports.PostgrestFilterBuilder = exports.PostgrestQueryBuilder = exports.PostgrestClient = void 0;\nconst tslib_1 = require(\"tslib\");\n// Always update wrapper.mjs when updating this file.\nconst PostgrestClient_1 = tslib_1.__importDefault(require(\"./PostgrestClient\"));\nexports.PostgrestClient = PostgrestClient_1.default;\nconst PostgrestQueryBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestQueryBuilder\"));\nexports.PostgrestQueryBuilder = PostgrestQueryBuilder_1.default;\nconst PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestFilterBuilder\"));\nexports.PostgrestFilterBuilder = PostgrestFilterBuilder_1.default;\nconst PostgrestTransformBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestTransformBuilder\"));\nexports.PostgrestTransformBuilder = PostgrestTransformBuilder_1.default;\nconst PostgrestBuilder_1 = tslib_1.__importDefault(require(\"./PostgrestBuilder\"));\nexports.PostgrestBuilder = PostgrestBuilder_1.default;\nconst PostgrestError_1 = tslib_1.__importDefault(require(\"./PostgrestError\"));\nexports.PostgrestError = PostgrestError_1.default;\nexports.default = {\n    PostgrestClient: PostgrestClient_1.default,\n    PostgrestQueryBuilder: PostgrestQueryBuilder_1.default,\n    PostgrestFilterBuilder: PostgrestFilterBuilder_1.default,\n    PostgrestTransformBuilder: PostgrestTransformBuilder_1.default,\n    PostgrestBuilder: PostgrestBuilder_1.default,\n    PostgrestError: PostgrestError_1.default,\n};\n//# sourceMappingURL=index.js.map","import * as index from '../cjs/index.js'\nconst {\n  PostgrestClient,\n  PostgrestQueryBuilder,\n  PostgrestFilterBuilder,\n  PostgrestTransformBuilder,\n  PostgrestBuilder,\n  PostgrestError,\n} = index.default || index\n\nexport {\n  PostgrestBuilder,\n  PostgrestClient,\n  PostgrestFilterBuilder,\n  PostgrestQueryBuilder,\n  PostgrestTransformBuilder,\n  PostgrestError,\n}\n\n// compatibility with CJS output\nexport default {\n  PostgrestClient,\n  PostgrestQueryBuilder,\n  PostgrestFilterBuilder,\n  PostgrestTransformBuilder,\n  PostgrestBuilder,\n  PostgrestError,\n}\n","/**\n * Utilities for creating WebSocket instances across runtimes.\n */\nexport class WebSocketFactory {\n    /**\n     * Static-only utility  prevent instantiation.\n     */\n    constructor() { }\n    static detectEnvironment() {\n        var _a;\n        if (typeof WebSocket !== 'undefined') {\n            return { type: 'native', constructor: WebSocket };\n        }\n        if (typeof globalThis !== 'undefined' && typeof globalThis.WebSocket !== 'undefined') {\n            return { type: 'native', constructor: globalThis.WebSocket };\n        }\n        if (typeof global !== 'undefined' && typeof global.WebSocket !== 'undefined') {\n            return { type: 'native', constructor: global.WebSocket };\n        }\n        if (typeof globalThis !== 'undefined' &&\n            typeof globalThis.WebSocketPair !== 'undefined' &&\n            typeof globalThis.WebSocket === 'undefined') {\n            return {\n                type: 'cloudflare',\n                error: 'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',\n                workaround: 'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.',\n            };\n        }\n        if ((typeof globalThis !== 'undefined' && globalThis.EdgeRuntime) ||\n            (typeof navigator !== 'undefined' && ((_a = navigator.userAgent) === null || _a === void 0 ? void 0 : _a.includes('Vercel-Edge')))) {\n            return {\n                type: 'unsupported',\n                error: 'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',\n                workaround: 'Use serverless functions or a different deployment target for WebSocket functionality.',\n            };\n        }\n        if (typeof process !== 'undefined') {\n            // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\n            const processVersions = process['versions'];\n            if (processVersions && processVersions['node']) {\n                // Remove 'v' prefix if present and parse the major version\n                const versionString = processVersions['node'];\n                const nodeVersion = parseInt(versionString.replace(/^v/, '').split('.')[0]);\n                // Node.js 22+ should have native WebSocket\n                if (nodeVersion >= 22) {\n                    // Check if native WebSocket is available (should be in Node.js 22+)\n                    if (typeof globalThis.WebSocket !== 'undefined') {\n                        return { type: 'native', constructor: globalThis.WebSocket };\n                    }\n                    // If not available, user needs to provide it\n                    return {\n                        type: 'unsupported',\n                        error: `Node.js ${nodeVersion} detected but native WebSocket not found.`,\n                        workaround: 'Provide a WebSocket implementation via the transport option.',\n                    };\n                }\n                // Node.js < 22 doesn't have native WebSocket\n                return {\n                    type: 'unsupported',\n                    error: `Node.js ${nodeVersion} detected without native WebSocket support.`,\n                    workaround: 'For Node.js < 22, install \"ws\" package and provide it via the transport option:\\n' +\n                        'import ws from \"ws\"\\n' +\n                        'new RealtimeClient(url, { transport: ws })',\n                };\n            }\n        }\n        return {\n            type: 'unsupported',\n            error: 'Unknown JavaScript runtime without WebSocket support.',\n            workaround: \"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\",\n        };\n    }\n    /**\n     * Returns the best available WebSocket constructor for the current runtime.\n     *\n     * @example\n     * ```ts\n     * const WS = WebSocketFactory.getWebSocketConstructor()\n     * const socket = new WS('wss://realtime.supabase.co/socket')\n     * ```\n     */\n    static getWebSocketConstructor() {\n        const env = this.detectEnvironment();\n        if (env.constructor) {\n            return env.constructor;\n        }\n        let errorMessage = env.error || 'WebSocket not supported in this environment.';\n        if (env.workaround) {\n            errorMessage += `\\n\\nSuggested solution: ${env.workaround}`;\n        }\n        throw new Error(errorMessage);\n    }\n    /**\n     * Creates a WebSocket using the detected constructor.\n     *\n     * @example\n     * ```ts\n     * const socket = WebSocketFactory.createWebSocket('wss://realtime.supabase.co/socket')\n     * ```\n     */\n    static createWebSocket(url, protocols) {\n        const WS = this.getWebSocketConstructor();\n        return new WS(url, protocols);\n    }\n    /**\n     * Detects whether the runtime can establish WebSocket connections.\n     *\n     * @example\n     * ```ts\n     * if (!WebSocketFactory.isWebSocketSupported()) {\n     *   console.warn('Falling back to long polling')\n     * }\n     * ```\n     */\n    static isWebSocketSupported() {\n        try {\n            const env = this.detectEnvironment();\n            return env.type === 'native' || env.type === 'ws';\n        }\n        catch (_a) {\n            return false;\n        }\n    }\n}\nexport default WebSocketFactory;\n//# sourceMappingURL=websocket-factory.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.86.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\nexport const DEFAULT_VERSION = `realtime-js/${version}`;\nexport const VSN_1_0_0 = '1.0.0';\nexport const VSN_2_0_0 = '2.0.0';\nexport const DEFAULT_VSN = VSN_1_0_0;\nexport const VERSION = version;\nexport const DEFAULT_TIMEOUT = 10000;\nexport const WS_CLOSE_NORMAL = 1000;\nexport const MAX_PUSH_BUFFER_SIZE = 100;\nexport var SOCKET_STATES;\n(function (SOCKET_STATES) {\n    SOCKET_STATES[SOCKET_STATES[\"connecting\"] = 0] = \"connecting\";\n    SOCKET_STATES[SOCKET_STATES[\"open\"] = 1] = \"open\";\n    SOCKET_STATES[SOCKET_STATES[\"closing\"] = 2] = \"closing\";\n    SOCKET_STATES[SOCKET_STATES[\"closed\"] = 3] = \"closed\";\n})(SOCKET_STATES || (SOCKET_STATES = {}));\nexport var CHANNEL_STATES;\n(function (CHANNEL_STATES) {\n    CHANNEL_STATES[\"closed\"] = \"closed\";\n    CHANNEL_STATES[\"errored\"] = \"errored\";\n    CHANNEL_STATES[\"joined\"] = \"joined\";\n    CHANNEL_STATES[\"joining\"] = \"joining\";\n    CHANNEL_STATES[\"leaving\"] = \"leaving\";\n})(CHANNEL_STATES || (CHANNEL_STATES = {}));\nexport var CHANNEL_EVENTS;\n(function (CHANNEL_EVENTS) {\n    CHANNEL_EVENTS[\"close\"] = \"phx_close\";\n    CHANNEL_EVENTS[\"error\"] = \"phx_error\";\n    CHANNEL_EVENTS[\"join\"] = \"phx_join\";\n    CHANNEL_EVENTS[\"reply\"] = \"phx_reply\";\n    CHANNEL_EVENTS[\"leave\"] = \"phx_leave\";\n    CHANNEL_EVENTS[\"access_token\"] = \"access_token\";\n})(CHANNEL_EVENTS || (CHANNEL_EVENTS = {}));\nexport var TRANSPORTS;\n(function (TRANSPORTS) {\n    TRANSPORTS[\"websocket\"] = \"websocket\";\n})(TRANSPORTS || (TRANSPORTS = {}));\nexport var CONNECTION_STATE;\n(function (CONNECTION_STATE) {\n    CONNECTION_STATE[\"Connecting\"] = \"connecting\";\n    CONNECTION_STATE[\"Open\"] = \"open\";\n    CONNECTION_STATE[\"Closing\"] = \"closing\";\n    CONNECTION_STATE[\"Closed\"] = \"closed\";\n})(CONNECTION_STATE || (CONNECTION_STATE = {}));\n//# sourceMappingURL=constants.js.map","export default class Serializer {\n    constructor(allowedMetadataKeys) {\n        this.HEADER_LENGTH = 1;\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\n        this.BINARY_ENCODING = 0;\n        this.JSON_ENCODING = 1;\n        this.BROADCAST_EVENT = 'broadcast';\n        this.allowedMetadataKeys = [];\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\n    }\n    encode(msg, callback) {\n        if (msg.event === this.BROADCAST_EVENT &&\n            !(msg.payload instanceof ArrayBuffer) &&\n            typeof msg.payload.event === 'string') {\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\n        }\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\n        return callback(JSON.stringify(payload));\n    }\n    _binaryEncodeUserBroadcastPush(message) {\n        var _a;\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\n            return this._encodeBinaryUserBroadcastPush(message);\n        }\n        else {\n            return this._encodeJsonUserBroadcastPush(message);\n        }\n    }\n    _encodeBinaryUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\n    }\n    _encodeJsonUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\n        const encoder = new TextEncoder();\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\n    }\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\n        var _a, _b;\n        const topic = message.topic;\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\n        const userEvent = message.payload.event;\n        // Filter metadata based on allowed keys\n        const rest = this.allowedMetadataKeys\n            ? this._pick(message.payload, this.allowedMetadataKeys)\n            : {};\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\n        // Validate lengths don't exceed uint8 max value (255)\n        if (joinRef.length > 255) {\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\n        }\n        if (ref.length > 255) {\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\n        }\n        if (topic.length > 255) {\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\n        }\n        if (userEvent.length > 255) {\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\n        }\n        if (metadata.length > 255) {\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\n        }\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\n            joinRef.length +\n            ref.length +\n            topic.length +\n            userEvent.length +\n            metadata.length;\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\n        let view = new DataView(header);\n        let offset = 0;\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\n        view.setUint8(offset++, joinRef.length);\n        view.setUint8(offset++, ref.length);\n        view.setUint8(offset++, topic.length);\n        view.setUint8(offset++, userEvent.length);\n        view.setUint8(offset++, metadata.length);\n        view.setUint8(offset++, encodingType);\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\n        combined.set(new Uint8Array(header), 0);\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\n        return combined.buffer;\n    }\n    decode(rawPayload, callback) {\n        if (this._isArrayBuffer(rawPayload)) {\n            let result = this._binaryDecode(rawPayload);\n            return callback(result);\n        }\n        if (typeof rawPayload === 'string') {\n            const jsonPayload = JSON.parse(rawPayload);\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\n            return callback({ join_ref, ref, topic, event, payload });\n        }\n        return callback({});\n    }\n    _binaryDecode(buffer) {\n        const view = new DataView(buffer);\n        const kind = view.getUint8(0);\n        const decoder = new TextDecoder();\n        switch (kind) {\n            case this.KINDS.userBroadcast:\n                return this._decodeUserBroadcast(buffer, view, decoder);\n        }\n    }\n    _decodeUserBroadcast(buffer, view, decoder) {\n        const topicSize = view.getUint8(1);\n        const userEventSize = view.getUint8(2);\n        const metadataSize = view.getUint8(3);\n        const payloadEncoding = view.getUint8(4);\n        let offset = this.HEADER_LENGTH + 4;\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\n        offset = offset + userEventSize;\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\n        offset = offset + metadataSize;\n        const payload = buffer.slice(offset, buffer.byteLength);\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\n        const data = {\n            type: this.BROADCAST_EVENT,\n            event: userEvent,\n            payload: parsedPayload,\n        };\n        // Metadata is optional and always JSON encoded\n        if (metadataSize > 0) {\n            data['meta'] = JSON.parse(metadata);\n        }\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\n    }\n    _isArrayBuffer(buffer) {\n        var _a;\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\n    }\n    _pick(obj, keys) {\n        if (!obj || typeof obj !== 'object') {\n            return {};\n        }\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\n    }\n}\n//# sourceMappingURL=serializer.js.map","/**\n * Creates a timer that accepts a `timerCalc` function to perform calculated timeout retries, such as exponential backoff.\n *\n * @example\n *    let reconnectTimer = new Timer(() => this.connect(), function(tries){\n *      return [1000, 5000, 10000][tries - 1] || 10000\n *    })\n *    reconnectTimer.scheduleTimeout() // fires after 1000\n *    reconnectTimer.scheduleTimeout() // fires after 5000\n *    reconnectTimer.reset()\n *    reconnectTimer.scheduleTimeout() // fires after 1000\n */\nexport default class Timer {\n    constructor(callback, timerCalc) {\n        this.callback = callback;\n        this.timerCalc = timerCalc;\n        this.timer = undefined;\n        this.tries = 0;\n        this.callback = callback;\n        this.timerCalc = timerCalc;\n    }\n    reset() {\n        this.tries = 0;\n        clearTimeout(this.timer);\n        this.timer = undefined;\n    }\n    // Cancels any previous scheduleTimeout and schedules callback\n    scheduleTimeout() {\n        clearTimeout(this.timer);\n        this.timer = setTimeout(() => {\n            this.tries = this.tries + 1;\n            this.callback();\n        }, this.timerCalc(this.tries + 1));\n    }\n}\n//# sourceMappingURL=timer.js.map","/**\n * Helpers to convert the change Payload into native JS types.\n */\n// Adapted from epgsql (src/epgsql_binary.erl), this module licensed under\n// 3-clause BSD found here: https://raw.githubusercontent.com/epgsql/epgsql/devel/LICENSE\nexport var PostgresTypes;\n(function (PostgresTypes) {\n    PostgresTypes[\"abstime\"] = \"abstime\";\n    PostgresTypes[\"bool\"] = \"bool\";\n    PostgresTypes[\"date\"] = \"date\";\n    PostgresTypes[\"daterange\"] = \"daterange\";\n    PostgresTypes[\"float4\"] = \"float4\";\n    PostgresTypes[\"float8\"] = \"float8\";\n    PostgresTypes[\"int2\"] = \"int2\";\n    PostgresTypes[\"int4\"] = \"int4\";\n    PostgresTypes[\"int4range\"] = \"int4range\";\n    PostgresTypes[\"int8\"] = \"int8\";\n    PostgresTypes[\"int8range\"] = \"int8range\";\n    PostgresTypes[\"json\"] = \"json\";\n    PostgresTypes[\"jsonb\"] = \"jsonb\";\n    PostgresTypes[\"money\"] = \"money\";\n    PostgresTypes[\"numeric\"] = \"numeric\";\n    PostgresTypes[\"oid\"] = \"oid\";\n    PostgresTypes[\"reltime\"] = \"reltime\";\n    PostgresTypes[\"text\"] = \"text\";\n    PostgresTypes[\"time\"] = \"time\";\n    PostgresTypes[\"timestamp\"] = \"timestamp\";\n    PostgresTypes[\"timestamptz\"] = \"timestamptz\";\n    PostgresTypes[\"timetz\"] = \"timetz\";\n    PostgresTypes[\"tsrange\"] = \"tsrange\";\n    PostgresTypes[\"tstzrange\"] = \"tstzrange\";\n})(PostgresTypes || (PostgresTypes = {}));\n/**\n * Takes an array of columns and an object of string values then converts each string value\n * to its mapped type.\n *\n * @param {{name: String, type: String}[]} columns\n * @param {Object} record\n * @param {Object} options The map of various options that can be applied to the mapper\n * @param {Array} options.skipTypes The array of types that should not be converted\n *\n * @example convertChangeData([{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age:'33'}, {})\n * //=>{ first_name: 'Paul', age: 33 }\n */\nexport const convertChangeData = (columns, record, options = {}) => {\n    var _a;\n    const skipTypes = (_a = options.skipTypes) !== null && _a !== void 0 ? _a : [];\n    if (!record) {\n        return {};\n    }\n    return Object.keys(record).reduce((acc, rec_key) => {\n        acc[rec_key] = convertColumn(rec_key, columns, record, skipTypes);\n        return acc;\n    }, {});\n};\n/**\n * Converts the value of an individual column.\n *\n * @param {String} columnName The column that you want to convert\n * @param {{name: String, type: String}[]} columns All of the columns\n * @param {Object} record The map of string values\n * @param {Array} skipTypes An array of types that should not be converted\n * @return {object} Useless information\n *\n * @example convertColumn('age', [{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age: '33'}, [])\n * //=> 33\n * @example convertColumn('age', [{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age: '33'}, ['int4'])\n * //=> \"33\"\n */\nexport const convertColumn = (columnName, columns, record, skipTypes) => {\n    const column = columns.find((x) => x.name === columnName);\n    const colType = column === null || column === void 0 ? void 0 : column.type;\n    const value = record[columnName];\n    if (colType && !skipTypes.includes(colType)) {\n        return convertCell(colType, value);\n    }\n    return noop(value);\n};\n/**\n * If the value of the cell is `null`, returns null.\n * Otherwise converts the string value to the correct type.\n * @param {String} type A postgres column type\n * @param {String} value The cell value\n *\n * @example convertCell('bool', 't')\n * //=> true\n * @example convertCell('int8', '10')\n * //=> 10\n * @example convertCell('_int4', '{1,2,3,4}')\n * //=> [1,2,3,4]\n */\nexport const convertCell = (type, value) => {\n    // if data type is an array\n    if (type.charAt(0) === '_') {\n        const dataType = type.slice(1, type.length);\n        return toArray(value, dataType);\n    }\n    // If not null, convert to correct type.\n    switch (type) {\n        case PostgresTypes.bool:\n            return toBoolean(value);\n        case PostgresTypes.float4:\n        case PostgresTypes.float8:\n        case PostgresTypes.int2:\n        case PostgresTypes.int4:\n        case PostgresTypes.int8:\n        case PostgresTypes.numeric:\n        case PostgresTypes.oid:\n            return toNumber(value);\n        case PostgresTypes.json:\n        case PostgresTypes.jsonb:\n            return toJson(value);\n        case PostgresTypes.timestamp:\n            return toTimestampString(value); // Format to be consistent with PostgREST\n        case PostgresTypes.abstime: // To allow users to cast it based on Timezone\n        case PostgresTypes.date: // To allow users to cast it based on Timezone\n        case PostgresTypes.daterange:\n        case PostgresTypes.int4range:\n        case PostgresTypes.int8range:\n        case PostgresTypes.money:\n        case PostgresTypes.reltime: // To allow users to cast it based on Timezone\n        case PostgresTypes.text:\n        case PostgresTypes.time: // To allow users to cast it based on Timezone\n        case PostgresTypes.timestamptz: // To allow users to cast it based on Timezone\n        case PostgresTypes.timetz: // To allow users to cast it based on Timezone\n        case PostgresTypes.tsrange:\n        case PostgresTypes.tstzrange:\n            return noop(value);\n        default:\n            // Return the value for remaining types\n            return noop(value);\n    }\n};\nconst noop = (value) => {\n    return value;\n};\nexport const toBoolean = (value) => {\n    switch (value) {\n        case 't':\n            return true;\n        case 'f':\n            return false;\n        default:\n            return value;\n    }\n};\nexport const toNumber = (value) => {\n    if (typeof value === 'string') {\n        const parsedValue = parseFloat(value);\n        if (!Number.isNaN(parsedValue)) {\n            return parsedValue;\n        }\n    }\n    return value;\n};\nexport const toJson = (value) => {\n    if (typeof value === 'string') {\n        try {\n            return JSON.parse(value);\n        }\n        catch (error) {\n            console.log(`JSON parse error: ${error}`);\n            return value;\n        }\n    }\n    return value;\n};\n/**\n * Converts a Postgres Array into a native JS array\n *\n * @example toArray('{}', 'int4')\n * //=> []\n * @example toArray('{\"[2021-01-01,2021-12-31)\",\"(2021-01-01,2021-12-32]\"}', 'daterange')\n * //=> ['[2021-01-01,2021-12-31)', '(2021-01-01,2021-12-32]']\n * @example toArray([1,2,3,4], 'int4')\n * //=> [1,2,3,4]\n */\nexport const toArray = (value, type) => {\n    if (typeof value !== 'string') {\n        return value;\n    }\n    const lastIdx = value.length - 1;\n    const closeBrace = value[lastIdx];\n    const openBrace = value[0];\n    // Confirm value is a Postgres array by checking curly brackets\n    if (openBrace === '{' && closeBrace === '}') {\n        let arr;\n        const valTrim = value.slice(1, lastIdx);\n        // TODO: find a better solution to separate Postgres array data\n        try {\n            arr = JSON.parse('[' + valTrim + ']');\n        }\n        catch (_) {\n            // WARNING: splitting on comma does not cover all edge cases\n            arr = valTrim ? valTrim.split(',') : [];\n        }\n        return arr.map((val) => convertCell(type, val));\n    }\n    return value;\n};\n/**\n * Fixes timestamp to be ISO-8601. Swaps the space between the date and time for a 'T'\n * See https://github.com/supabase/supabase/issues/18\n *\n * @example toTimestampString('2019-09-10 00:00:00')\n * //=> '2019-09-10T00:00:00'\n */\nexport const toTimestampString = (value) => {\n    if (typeof value === 'string') {\n        return value.replace(' ', 'T');\n    }\n    return value;\n};\nexport const httpEndpointURL = (socketUrl) => {\n    const wsUrl = new URL(socketUrl);\n    wsUrl.protocol = wsUrl.protocol.replace(/^ws/i, 'http');\n    wsUrl.pathname = wsUrl.pathname\n        .replace(/\\/+$/, '') // remove all trailing slashes\n        .replace(/\\/socket\\/websocket$/i, '') // remove the socket/websocket path\n        .replace(/\\/socket$/i, '') // remove the socket path\n        .replace(/\\/websocket$/i, ''); // remove the websocket path\n    if (wsUrl.pathname === '' || wsUrl.pathname === '/') {\n        wsUrl.pathname = '/api/broadcast';\n    }\n    else {\n        wsUrl.pathname = wsUrl.pathname + '/api/broadcast';\n    }\n    return wsUrl.href;\n};\n//# sourceMappingURL=transformers.js.map","import { DEFAULT_TIMEOUT } from '../lib/constants';\nexport default class Push {\n    /**\n     * Initializes the Push\n     *\n     * @param channel The Channel\n     * @param event The event, for example `\"phx_join\"`\n     * @param payload The payload, for example `{user_id: 123}`\n     * @param timeout The push timeout in milliseconds\n     */\n    constructor(channel, event, payload = {}, timeout = DEFAULT_TIMEOUT) {\n        this.channel = channel;\n        this.event = event;\n        this.payload = payload;\n        this.timeout = timeout;\n        this.sent = false;\n        this.timeoutTimer = undefined;\n        this.ref = '';\n        this.receivedResp = null;\n        this.recHooks = [];\n        this.refEvent = null;\n    }\n    resend(timeout) {\n        this.timeout = timeout;\n        this._cancelRefEvent();\n        this.ref = '';\n        this.refEvent = null;\n        this.receivedResp = null;\n        this.sent = false;\n        this.send();\n    }\n    send() {\n        if (this._hasReceived('timeout')) {\n            return;\n        }\n        this.startTimeout();\n        this.sent = true;\n        this.channel.socket.push({\n            topic: this.channel.topic,\n            event: this.event,\n            payload: this.payload,\n            ref: this.ref,\n            join_ref: this.channel._joinRef(),\n        });\n    }\n    updatePayload(payload) {\n        this.payload = Object.assign(Object.assign({}, this.payload), payload);\n    }\n    receive(status, callback) {\n        var _a;\n        if (this._hasReceived(status)) {\n            callback((_a = this.receivedResp) === null || _a === void 0 ? void 0 : _a.response);\n        }\n        this.recHooks.push({ status, callback });\n        return this;\n    }\n    startTimeout() {\n        if (this.timeoutTimer) {\n            return;\n        }\n        this.ref = this.channel.socket._makeRef();\n        this.refEvent = this.channel._replyEventName(this.ref);\n        const callback = (payload) => {\n            this._cancelRefEvent();\n            this._cancelTimeout();\n            this.receivedResp = payload;\n            this._matchReceive(payload);\n        };\n        this.channel._on(this.refEvent, {}, callback);\n        this.timeoutTimer = setTimeout(() => {\n            this.trigger('timeout', {});\n        }, this.timeout);\n    }\n    trigger(status, response) {\n        if (this.refEvent)\n            this.channel._trigger(this.refEvent, { status, response });\n    }\n    destroy() {\n        this._cancelRefEvent();\n        this._cancelTimeout();\n    }\n    _cancelRefEvent() {\n        if (!this.refEvent) {\n            return;\n        }\n        this.channel._off(this.refEvent, {});\n    }\n    _cancelTimeout() {\n        clearTimeout(this.timeoutTimer);\n        this.timeoutTimer = undefined;\n    }\n    _matchReceive({ status, response }) {\n        this.recHooks.filter((h) => h.status === status).forEach((h) => h.callback(response));\n    }\n    _hasReceived(status) {\n        return this.receivedResp && this.receivedResp.status === status;\n    }\n}\n//# sourceMappingURL=push.js.map","/*\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n*/\nexport var REALTIME_PRESENCE_LISTEN_EVENTS;\n(function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n})(REALTIME_PRESENCE_LISTEN_EVENTS || (REALTIME_PRESENCE_LISTEN_EVENTS = {}));\nexport default class RealtimePresence {\n    /**\n     * Creates a Presence helper that keeps the local presence state in sync with the server.\n     *\n     * @param channel - The realtime channel to bind to.\n     * @param opts - Optional custom event names, e.g. `{ events: { state: 'state', diff: 'diff' } }`.\n     *\n     * @example\n     * ```ts\n     * const presence = new RealtimePresence(channel)\n     *\n     * channel.on('presence', ({ event, key }) => {\n     *   console.log(`Presence ${event} on ${key}`)\n     * })\n     * ```\n     */\n    constructor(channel, opts) {\n        this.channel = channel;\n        this.state = {};\n        this.pendingDiffs = [];\n        this.joinRef = null;\n        this.enabled = false;\n        this.caller = {\n            onJoin: () => { },\n            onLeave: () => { },\n            onSync: () => { },\n        };\n        const events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\n            state: 'presence_state',\n            diff: 'presence_diff',\n        };\n        this.channel._on(events.state, {}, (newState) => {\n            const { onJoin, onLeave, onSync } = this.caller;\n            this.joinRef = this.channel._joinRef();\n            this.state = RealtimePresence.syncState(this.state, newState, onJoin, onLeave);\n            this.pendingDiffs.forEach((diff) => {\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n            });\n            this.pendingDiffs = [];\n            onSync();\n        });\n        this.channel._on(events.diff, {}, (diff) => {\n            const { onJoin, onLeave, onSync } = this.caller;\n            if (this.inPendingSyncState()) {\n                this.pendingDiffs.push(diff);\n            }\n            else {\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n                onSync();\n            }\n        });\n        this.onJoin((key, currentPresences, newPresences) => {\n            this.channel._trigger('presence', {\n                event: 'join',\n                key,\n                currentPresences,\n                newPresences,\n            });\n        });\n        this.onLeave((key, currentPresences, leftPresences) => {\n            this.channel._trigger('presence', {\n                event: 'leave',\n                key,\n                currentPresences,\n                leftPresences,\n            });\n        });\n        this.onSync(() => {\n            this.channel._trigger('presence', { event: 'sync' });\n        });\n    }\n    /**\n     * Used to sync the list of presences on the server with the\n     * client's state.\n     *\n     * An optional `onJoin` and `onLeave` callback can be provided to\n     * react to changes in the client's local presences across\n     * disconnects and reconnects with the server.\n     *\n     * @internal\n     */\n    static syncState(currentState, newState, onJoin, onLeave) {\n        const state = this.cloneDeep(currentState);\n        const transformedState = this.transformState(newState);\n        const joins = {};\n        const leaves = {};\n        this.map(state, (key, presences) => {\n            if (!transformedState[key]) {\n                leaves[key] = presences;\n            }\n        });\n        this.map(transformedState, (key, newPresences) => {\n            const currentPresences = state[key];\n            if (currentPresences) {\n                const newPresenceRefs = newPresences.map((m) => m.presence_ref);\n                const curPresenceRefs = currentPresences.map((m) => m.presence_ref);\n                const joinedPresences = newPresences.filter((m) => curPresenceRefs.indexOf(m.presence_ref) < 0);\n                const leftPresences = currentPresences.filter((m) => newPresenceRefs.indexOf(m.presence_ref) < 0);\n                if (joinedPresences.length > 0) {\n                    joins[key] = joinedPresences;\n                }\n                if (leftPresences.length > 0) {\n                    leaves[key] = leftPresences;\n                }\n            }\n            else {\n                joins[key] = newPresences;\n            }\n        });\n        return this.syncDiff(state, { joins, leaves }, onJoin, onLeave);\n    }\n    /**\n     * Used to sync a diff of presence join and leave events from the\n     * server, as they happen.\n     *\n     * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n     * `onLeave` callbacks to react to a user joining or leaving from a\n     * device.\n     *\n     * @internal\n     */\n    static syncDiff(state, diff, onJoin, onLeave) {\n        const { joins, leaves } = {\n            joins: this.transformState(diff.joins),\n            leaves: this.transformState(diff.leaves),\n        };\n        if (!onJoin) {\n            onJoin = () => { };\n        }\n        if (!onLeave) {\n            onLeave = () => { };\n        }\n        this.map(joins, (key, newPresences) => {\n            var _a;\n            const currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\n            state[key] = this.cloneDeep(newPresences);\n            if (currentPresences.length > 0) {\n                const joinedPresenceRefs = state[key].map((m) => m.presence_ref);\n                const curPresences = currentPresences.filter((m) => joinedPresenceRefs.indexOf(m.presence_ref) < 0);\n                state[key].unshift(...curPresences);\n            }\n            onJoin(key, currentPresences, newPresences);\n        });\n        this.map(leaves, (key, leftPresences) => {\n            let currentPresences = state[key];\n            if (!currentPresences)\n                return;\n            const presenceRefsToRemove = leftPresences.map((m) => m.presence_ref);\n            currentPresences = currentPresences.filter((m) => presenceRefsToRemove.indexOf(m.presence_ref) < 0);\n            state[key] = currentPresences;\n            onLeave(key, currentPresences, leftPresences);\n            if (currentPresences.length === 0)\n                delete state[key];\n        });\n        return state;\n    }\n    /** @internal */\n    static map(obj, func) {\n        return Object.getOwnPropertyNames(obj).map((key) => func(key, obj[key]));\n    }\n    /**\n     * Remove 'metas' key\n     * Change 'phx_ref' to 'presence_ref'\n     * Remove 'phx_ref' and 'phx_ref_prev'\n     *\n     * @example\n     * // returns {\n     *  abc123: [\n     *    { presence_ref: '2', user_id: 1 },\n     *    { presence_ref: '3', user_id: 2 }\n     *  ]\n     * }\n     * RealtimePresence.transformState({\n     *  abc123: {\n     *    metas: [\n     *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n     *      { phx_ref: '3', user_id: 2 }\n     *    ]\n     *  }\n     * })\n     *\n     * @internal\n     */\n    static transformState(state) {\n        state = this.cloneDeep(state);\n        return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n            const presences = state[key];\n            if ('metas' in presences) {\n                newState[key] = presences.metas.map((presence) => {\n                    presence['presence_ref'] = presence['phx_ref'];\n                    delete presence['phx_ref'];\n                    delete presence['phx_ref_prev'];\n                    return presence;\n                });\n            }\n            else {\n                newState[key] = presences;\n            }\n            return newState;\n        }, {});\n    }\n    /** @internal */\n    static cloneDeep(obj) {\n        return JSON.parse(JSON.stringify(obj));\n    }\n    /** @internal */\n    onJoin(callback) {\n        this.caller.onJoin = callback;\n    }\n    /** @internal */\n    onLeave(callback) {\n        this.caller.onLeave = callback;\n    }\n    /** @internal */\n    onSync(callback) {\n        this.caller.onSync = callback;\n    }\n    /** @internal */\n    inPendingSyncState() {\n        return !this.joinRef || this.joinRef !== this.channel._joinRef();\n    }\n}\n//# sourceMappingURL=RealtimePresence.js.map","import { CHANNEL_EVENTS, CHANNEL_STATES, MAX_PUSH_BUFFER_SIZE } from './lib/constants';\nimport Push from './lib/push';\nimport Timer from './lib/timer';\nimport RealtimePresence from './RealtimePresence';\nimport * as Transformers from './lib/transformers';\nimport { httpEndpointURL } from './lib/transformers';\nexport var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;\n(function (REALTIME_POSTGRES_CHANGES_LISTEN_EVENT) {\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"ALL\"] = \"*\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"INSERT\"] = \"INSERT\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"UPDATE\"] = \"UPDATE\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"DELETE\"] = \"DELETE\";\n})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT || (REALTIME_POSTGRES_CHANGES_LISTEN_EVENT = {}));\nexport var REALTIME_LISTEN_TYPES;\n(function (REALTIME_LISTEN_TYPES) {\n    REALTIME_LISTEN_TYPES[\"BROADCAST\"] = \"broadcast\";\n    REALTIME_LISTEN_TYPES[\"PRESENCE\"] = \"presence\";\n    REALTIME_LISTEN_TYPES[\"POSTGRES_CHANGES\"] = \"postgres_changes\";\n    REALTIME_LISTEN_TYPES[\"SYSTEM\"] = \"system\";\n})(REALTIME_LISTEN_TYPES || (REALTIME_LISTEN_TYPES = {}));\nexport var REALTIME_SUBSCRIBE_STATES;\n(function (REALTIME_SUBSCRIBE_STATES) {\n    REALTIME_SUBSCRIBE_STATES[\"SUBSCRIBED\"] = \"SUBSCRIBED\";\n    REALTIME_SUBSCRIBE_STATES[\"TIMED_OUT\"] = \"TIMED_OUT\";\n    REALTIME_SUBSCRIBE_STATES[\"CLOSED\"] = \"CLOSED\";\n    REALTIME_SUBSCRIBE_STATES[\"CHANNEL_ERROR\"] = \"CHANNEL_ERROR\";\n})(REALTIME_SUBSCRIBE_STATES || (REALTIME_SUBSCRIBE_STATES = {}));\nexport const REALTIME_CHANNEL_STATES = CHANNEL_STATES;\n/** A channel is the basic building block of Realtime\n * and narrows the scope of data flow to subscribed clients.\n * You can think of a channel as a chatroom where participants are able to see who's online\n * and send and receive messages.\n */\nexport default class RealtimeChannel {\n    /**\n     * Creates a channel that can broadcast messages, sync presence, and listen to Postgres changes.\n     *\n     * The topic determines which realtime stream you are subscribing to. Config options let you\n     * enable acknowledgement for broadcasts, presence tracking, or private channels.\n     *\n     * @example\n     * ```ts\n     * import RealtimeClient from '@supabase/realtime-js'\n     *\n     * const client = new RealtimeClient('https://xyzcompany.supabase.co/realtime/v1', {\n     *   params: { apikey: 'public-anon-key' },\n     * })\n     * const channel = new RealtimeChannel('realtime:public:messages', { config: {} }, client)\n     * ```\n     */\n    constructor(\n    /** Topic name can be any string. */\n    topic, params = { config: {} }, socket) {\n        var _a, _b;\n        this.topic = topic;\n        this.params = params;\n        this.socket = socket;\n        this.bindings = {};\n        this.state = CHANNEL_STATES.closed;\n        this.joinedOnce = false;\n        this.pushBuffer = [];\n        this.subTopic = topic.replace(/^realtime:/i, '');\n        this.params.config = Object.assign({\n            broadcast: { ack: false, self: false },\n            presence: { key: '', enabled: false },\n            private: false,\n        }, params.config);\n        this.timeout = this.socket.timeout;\n        this.joinPush = new Push(this, CHANNEL_EVENTS.join, this.params, this.timeout);\n        this.rejoinTimer = new Timer(() => this._rejoinUntilConnected(), this.socket.reconnectAfterMs);\n        this.joinPush.receive('ok', () => {\n            this.state = CHANNEL_STATES.joined;\n            this.rejoinTimer.reset();\n            this.pushBuffer.forEach((pushEvent) => pushEvent.send());\n            this.pushBuffer = [];\n        });\n        this._onClose(() => {\n            this.rejoinTimer.reset();\n            this.socket.log('channel', `close ${this.topic} ${this._joinRef()}`);\n            this.state = CHANNEL_STATES.closed;\n            this.socket._remove(this);\n        });\n        this._onError((reason) => {\n            if (this._isLeaving() || this._isClosed()) {\n                return;\n            }\n            this.socket.log('channel', `error ${this.topic}`, reason);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this.joinPush.receive('timeout', () => {\n            if (!this._isJoining()) {\n                return;\n            }\n            this.socket.log('channel', `timeout ${this.topic}`, this.joinPush.timeout);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this.joinPush.receive('error', (reason) => {\n            if (this._isLeaving() || this._isClosed()) {\n                return;\n            }\n            this.socket.log('channel', `error ${this.topic}`, reason);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this._on(CHANNEL_EVENTS.reply, {}, (payload, ref) => {\n            this._trigger(this._replyEventName(ref), payload);\n        });\n        this.presence = new RealtimePresence(this);\n        this.broadcastEndpointURL = httpEndpointURL(this.socket.endPoint);\n        this.private = this.params.config.private || false;\n        if (!this.private && ((_b = (_a = this.params.config) === null || _a === void 0 ? void 0 : _a.broadcast) === null || _b === void 0 ? void 0 : _b.replay)) {\n            throw `tried to use replay on public channel '${this.topic}'. It must be a private channel.`;\n        }\n    }\n    /** Subscribe registers your client with the server */\n    subscribe(callback, timeout = this.timeout) {\n        var _a, _b, _c;\n        if (!this.socket.isConnected()) {\n            this.socket.connect();\n        }\n        if (this.state == CHANNEL_STATES.closed) {\n            const { config: { broadcast, presence, private: isPrivate }, } = this.params;\n            const postgres_changes = (_b = (_a = this.bindings.postgres_changes) === null || _a === void 0 ? void 0 : _a.map((r) => r.filter)) !== null && _b !== void 0 ? _b : [];\n            const presence_enabled = (!!this.bindings[REALTIME_LISTEN_TYPES.PRESENCE] &&\n                this.bindings[REALTIME_LISTEN_TYPES.PRESENCE].length > 0) ||\n                ((_c = this.params.config.presence) === null || _c === void 0 ? void 0 : _c.enabled) === true;\n            const accessTokenPayload = {};\n            const config = {\n                broadcast,\n                presence: Object.assign(Object.assign({}, presence), { enabled: presence_enabled }),\n                postgres_changes,\n                private: isPrivate,\n            };\n            if (this.socket.accessTokenValue) {\n                accessTokenPayload.access_token = this.socket.accessTokenValue;\n            }\n            this._onError((e) => callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, e));\n            this._onClose(() => callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CLOSED));\n            this.updateJoinPayload(Object.assign({ config }, accessTokenPayload));\n            this.joinedOnce = true;\n            this._rejoin(timeout);\n            this.joinPush\n                .receive('ok', async ({ postgres_changes }) => {\n                var _a;\n                this.socket.setAuth();\n                if (postgres_changes === undefined) {\n                    callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);\n                    return;\n                }\n                else {\n                    const clientPostgresBindings = this.bindings.postgres_changes;\n                    const bindingsLen = (_a = clientPostgresBindings === null || clientPostgresBindings === void 0 ? void 0 : clientPostgresBindings.length) !== null && _a !== void 0 ? _a : 0;\n                    const newPostgresBindings = [];\n                    for (let i = 0; i < bindingsLen; i++) {\n                        const clientPostgresBinding = clientPostgresBindings[i];\n                        const { filter: { event, schema, table, filter }, } = clientPostgresBinding;\n                        const serverPostgresFilter = postgres_changes && postgres_changes[i];\n                        if (serverPostgresFilter &&\n                            serverPostgresFilter.event === event &&\n                            serverPostgresFilter.schema === schema &&\n                            serverPostgresFilter.table === table &&\n                            serverPostgresFilter.filter === filter) {\n                            newPostgresBindings.push(Object.assign(Object.assign({}, clientPostgresBinding), { id: serverPostgresFilter.id }));\n                        }\n                        else {\n                            this.unsubscribe();\n                            this.state = CHANNEL_STATES.errored;\n                            callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, new Error('mismatch between server and client bindings for postgres changes'));\n                            return;\n                        }\n                    }\n                    this.bindings.postgres_changes = newPostgresBindings;\n                    callback && callback(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);\n                    return;\n                }\n            })\n                .receive('error', (error) => {\n                this.state = CHANNEL_STATES.errored;\n                callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, new Error(JSON.stringify(Object.values(error).join(', ') || 'error')));\n                return;\n            })\n                .receive('timeout', () => {\n                callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.TIMED_OUT);\n                return;\n            });\n        }\n        return this;\n    }\n    /**\n     * Returns the current presence state for this channel.\n     *\n     * The shape is a map keyed by presence key (for example a user id) where each entry contains the\n     * tracked metadata for that user.\n     */\n    presenceState() {\n        return this.presence.state;\n    }\n    /**\n     * Sends the supplied payload to the presence tracker so other subscribers can see that this\n     * client is online. Use `untrack` to stop broadcasting presence for the same key.\n     */\n    async track(payload, opts = {}) {\n        return await this.send({\n            type: 'presence',\n            event: 'track',\n            payload,\n        }, opts.timeout || this.timeout);\n    }\n    /**\n     * Removes the current presence state for this client.\n     */\n    async untrack(opts = {}) {\n        return await this.send({\n            type: 'presence',\n            event: 'untrack',\n        }, opts);\n    }\n    on(type, filter, callback) {\n        if (this.state === CHANNEL_STATES.joined && type === REALTIME_LISTEN_TYPES.PRESENCE) {\n            this.socket.log('channel', `resubscribe to ${this.topic} due to change in presence callbacks on joined channel`);\n            this.unsubscribe().then(() => this.subscribe());\n        }\n        return this._on(type, filter, callback);\n    }\n    /**\n     * Sends a broadcast message explicitly via REST API.\n     *\n     * This method always uses the REST API endpoint regardless of WebSocket connection state.\n     * Useful when you want to guarantee REST delivery or when gradually migrating from implicit REST fallback.\n     *\n     * @param event The name of the broadcast event\n     * @param payload Payload to be sent (required)\n     * @param opts Options including timeout\n     * @returns Promise resolving to object with success status, and error details if failed\n     */\n    async httpSend(event, payload, opts = {}) {\n        var _a;\n        const authorization = this.socket.accessTokenValue\n            ? `Bearer ${this.socket.accessTokenValue}`\n            : '';\n        if (payload === undefined || payload === null) {\n            return Promise.reject('Payload is required for httpSend()');\n        }\n        const options = {\n            method: 'POST',\n            headers: {\n                Authorization: authorization,\n                apikey: this.socket.apiKey ? this.socket.apiKey : '',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                messages: [\n                    {\n                        topic: this.subTopic,\n                        event,\n                        payload: payload,\n                        private: this.private,\n                    },\n                ],\n            }),\n        };\n        const response = await this._fetchWithTimeout(this.broadcastEndpointURL, options, (_a = opts.timeout) !== null && _a !== void 0 ? _a : this.timeout);\n        if (response.status === 202) {\n            return { success: true };\n        }\n        let errorMessage = response.statusText;\n        try {\n            const errorBody = await response.json();\n            errorMessage = errorBody.error || errorBody.message || errorMessage;\n        }\n        catch (_b) { }\n        return Promise.reject(new Error(errorMessage));\n    }\n    /**\n     * Sends a message into the channel.\n     *\n     * @param args Arguments to send to channel\n     * @param args.type The type of event to send\n     * @param args.event The name of the event being sent\n     * @param args.payload Payload to be sent\n     * @param opts Options to be used during the send process\n     */\n    async send(args, opts = {}) {\n        var _a, _b;\n        if (!this._canPush() && args.type === 'broadcast') {\n            console.warn('Realtime send() is automatically falling back to REST API. ' +\n                'This behavior will be deprecated in the future. ' +\n                'Please use httpSend() explicitly for REST delivery.');\n            const { event, payload: endpoint_payload } = args;\n            const authorization = this.socket.accessTokenValue\n                ? `Bearer ${this.socket.accessTokenValue}`\n                : '';\n            const options = {\n                method: 'POST',\n                headers: {\n                    Authorization: authorization,\n                    apikey: this.socket.apiKey ? this.socket.apiKey : '',\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    messages: [\n                        {\n                            topic: this.subTopic,\n                            event,\n                            payload: endpoint_payload,\n                            private: this.private,\n                        },\n                    ],\n                }),\n            };\n            try {\n                const response = await this._fetchWithTimeout(this.broadcastEndpointURL, options, (_a = opts.timeout) !== null && _a !== void 0 ? _a : this.timeout);\n                await ((_b = response.body) === null || _b === void 0 ? void 0 : _b.cancel());\n                return response.ok ? 'ok' : 'error';\n            }\n            catch (error) {\n                if (error.name === 'AbortError') {\n                    return 'timed out';\n                }\n                else {\n                    return 'error';\n                }\n            }\n        }\n        else {\n            return new Promise((resolve) => {\n                var _a, _b, _c;\n                const push = this._push(args.type, args, opts.timeout || this.timeout);\n                if (args.type === 'broadcast' && !((_c = (_b = (_a = this.params) === null || _a === void 0 ? void 0 : _a.config) === null || _b === void 0 ? void 0 : _b.broadcast) === null || _c === void 0 ? void 0 : _c.ack)) {\n                    resolve('ok');\n                }\n                push.receive('ok', () => resolve('ok'));\n                push.receive('error', () => resolve('error'));\n                push.receive('timeout', () => resolve('timed out'));\n            });\n        }\n    }\n    /**\n     * Updates the payload that will be sent the next time the channel joins (reconnects).\n     * Useful for rotating access tokens or updating config without re-creating the channel.\n     */\n    updateJoinPayload(payload) {\n        this.joinPush.updatePayload(payload);\n    }\n    /**\n     * Leaves the channel.\n     *\n     * Unsubscribes from server events, and instructs channel to terminate on server.\n     * Triggers onClose() hooks.\n     *\n     * To receive leave acknowledgements, use the a `receive` hook to bind to the server ack, ie:\n     * channel.unsubscribe().receive(\"ok\", () => alert(\"left!\") )\n     */\n    unsubscribe(timeout = this.timeout) {\n        this.state = CHANNEL_STATES.leaving;\n        const onClose = () => {\n            this.socket.log('channel', `leave ${this.topic}`);\n            this._trigger(CHANNEL_EVENTS.close, 'leave', this._joinRef());\n        };\n        this.joinPush.destroy();\n        let leavePush = null;\n        return new Promise((resolve) => {\n            leavePush = new Push(this, CHANNEL_EVENTS.leave, {}, timeout);\n            leavePush\n                .receive('ok', () => {\n                onClose();\n                resolve('ok');\n            })\n                .receive('timeout', () => {\n                onClose();\n                resolve('timed out');\n            })\n                .receive('error', () => {\n                resolve('error');\n            });\n            leavePush.send();\n            if (!this._canPush()) {\n                leavePush.trigger('ok', {});\n            }\n        }).finally(() => {\n            leavePush === null || leavePush === void 0 ? void 0 : leavePush.destroy();\n        });\n    }\n    /**\n     * Teardown the channel.\n     *\n     * Destroys and stops related timers.\n     */\n    teardown() {\n        this.pushBuffer.forEach((push) => push.destroy());\n        this.pushBuffer = [];\n        this.rejoinTimer.reset();\n        this.joinPush.destroy();\n        this.state = CHANNEL_STATES.closed;\n        this.bindings = {};\n    }\n    /** @internal */\n    async _fetchWithTimeout(url, options, timeout) {\n        const controller = new AbortController();\n        const id = setTimeout(() => controller.abort(), timeout);\n        const response = await this.socket.fetch(url, Object.assign(Object.assign({}, options), { signal: controller.signal }));\n        clearTimeout(id);\n        return response;\n    }\n    /** @internal */\n    _push(event, payload, timeout = this.timeout) {\n        if (!this.joinedOnce) {\n            throw `tried to push '${event}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;\n        }\n        let pushEvent = new Push(this, event, payload, timeout);\n        if (this._canPush()) {\n            pushEvent.send();\n        }\n        else {\n            this._addToPushBuffer(pushEvent);\n        }\n        return pushEvent;\n    }\n    /** @internal */\n    _addToPushBuffer(pushEvent) {\n        pushEvent.startTimeout();\n        this.pushBuffer.push(pushEvent);\n        // Enforce buffer size limit\n        if (this.pushBuffer.length > MAX_PUSH_BUFFER_SIZE) {\n            const removedPush = this.pushBuffer.shift();\n            if (removedPush) {\n                removedPush.destroy();\n                this.socket.log('channel', `discarded push due to buffer overflow: ${removedPush.event}`, removedPush.payload);\n            }\n        }\n    }\n    /**\n     * Overridable message hook\n     *\n     * Receives all events for specialized message handling before dispatching to the channel callbacks.\n     * Must return the payload, modified or unmodified.\n     *\n     * @internal\n     */\n    _onMessage(_event, payload, _ref) {\n        return payload;\n    }\n    /** @internal */\n    _isMember(topic) {\n        return this.topic === topic;\n    }\n    /** @internal */\n    _joinRef() {\n        return this.joinPush.ref;\n    }\n    /** @internal */\n    _trigger(type, payload, ref) {\n        var _a, _b;\n        const typeLower = type.toLocaleLowerCase();\n        const { close, error, leave, join } = CHANNEL_EVENTS;\n        const events = [close, error, leave, join];\n        if (ref && events.indexOf(typeLower) >= 0 && ref !== this._joinRef()) {\n            return;\n        }\n        let handledPayload = this._onMessage(typeLower, payload, ref);\n        if (payload && !handledPayload) {\n            throw 'channel onMessage callbacks must return the payload, modified or unmodified';\n        }\n        if (['insert', 'update', 'delete'].includes(typeLower)) {\n            (_a = this.bindings.postgres_changes) === null || _a === void 0 ? void 0 : _a.filter((bind) => {\n                var _a, _b, _c;\n                return ((_a = bind.filter) === null || _a === void 0 ? void 0 : _a.event) === '*' || ((_c = (_b = bind.filter) === null || _b === void 0 ? void 0 : _b.event) === null || _c === void 0 ? void 0 : _c.toLocaleLowerCase()) === typeLower;\n            }).map((bind) => bind.callback(handledPayload, ref));\n        }\n        else {\n            (_b = this.bindings[typeLower]) === null || _b === void 0 ? void 0 : _b.filter((bind) => {\n                var _a, _b, _c, _d, _e, _f;\n                if (['broadcast', 'presence', 'postgres_changes'].includes(typeLower)) {\n                    if ('id' in bind) {\n                        const bindId = bind.id;\n                        const bindEvent = (_a = bind.filter) === null || _a === void 0 ? void 0 : _a.event;\n                        return (bindId &&\n                            ((_b = payload.ids) === null || _b === void 0 ? void 0 : _b.includes(bindId)) &&\n                            (bindEvent === '*' ||\n                                (bindEvent === null || bindEvent === void 0 ? void 0 : bindEvent.toLocaleLowerCase()) === ((_c = payload.data) === null || _c === void 0 ? void 0 : _c.type.toLocaleLowerCase())));\n                    }\n                    else {\n                        const bindEvent = (_e = (_d = bind === null || bind === void 0 ? void 0 : bind.filter) === null || _d === void 0 ? void 0 : _d.event) === null || _e === void 0 ? void 0 : _e.toLocaleLowerCase();\n                        return bindEvent === '*' || bindEvent === ((_f = payload === null || payload === void 0 ? void 0 : payload.event) === null || _f === void 0 ? void 0 : _f.toLocaleLowerCase());\n                    }\n                }\n                else {\n                    return bind.type.toLocaleLowerCase() === typeLower;\n                }\n            }).map((bind) => {\n                if (typeof handledPayload === 'object' && 'ids' in handledPayload) {\n                    const postgresChanges = handledPayload.data;\n                    const { schema, table, commit_timestamp, type, errors } = postgresChanges;\n                    const enrichedPayload = {\n                        schema: schema,\n                        table: table,\n                        commit_timestamp: commit_timestamp,\n                        eventType: type,\n                        new: {},\n                        old: {},\n                        errors: errors,\n                    };\n                    handledPayload = Object.assign(Object.assign({}, enrichedPayload), this._getPayloadRecords(postgresChanges));\n                }\n                bind.callback(handledPayload, ref);\n            });\n        }\n    }\n    /** @internal */\n    _isClosed() {\n        return this.state === CHANNEL_STATES.closed;\n    }\n    /** @internal */\n    _isJoined() {\n        return this.state === CHANNEL_STATES.joined;\n    }\n    /** @internal */\n    _isJoining() {\n        return this.state === CHANNEL_STATES.joining;\n    }\n    /** @internal */\n    _isLeaving() {\n        return this.state === CHANNEL_STATES.leaving;\n    }\n    /** @internal */\n    _replyEventName(ref) {\n        return `chan_reply_${ref}`;\n    }\n    /** @internal */\n    _on(type, filter, callback) {\n        const typeLower = type.toLocaleLowerCase();\n        const binding = {\n            type: typeLower,\n            filter: filter,\n            callback: callback,\n        };\n        if (this.bindings[typeLower]) {\n            this.bindings[typeLower].push(binding);\n        }\n        else {\n            this.bindings[typeLower] = [binding];\n        }\n        return this;\n    }\n    /** @internal */\n    _off(type, filter) {\n        const typeLower = type.toLocaleLowerCase();\n        if (this.bindings[typeLower]) {\n            this.bindings[typeLower] = this.bindings[typeLower].filter((bind) => {\n                var _a;\n                return !(((_a = bind.type) === null || _a === void 0 ? void 0 : _a.toLocaleLowerCase()) === typeLower &&\n                    RealtimeChannel.isEqual(bind.filter, filter));\n            });\n        }\n        return this;\n    }\n    /** @internal */\n    static isEqual(obj1, obj2) {\n        if (Object.keys(obj1).length !== Object.keys(obj2).length) {\n            return false;\n        }\n        for (const k in obj1) {\n            if (obj1[k] !== obj2[k]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /** @internal */\n    _rejoinUntilConnected() {\n        this.rejoinTimer.scheduleTimeout();\n        if (this.socket.isConnected()) {\n            this._rejoin();\n        }\n    }\n    /**\n     * Registers a callback that will be executed when the channel closes.\n     *\n     * @internal\n     */\n    _onClose(callback) {\n        this._on(CHANNEL_EVENTS.close, {}, callback);\n    }\n    /**\n     * Registers a callback that will be executed when the channel encounteres an error.\n     *\n     * @internal\n     */\n    _onError(callback) {\n        this._on(CHANNEL_EVENTS.error, {}, (reason) => callback(reason));\n    }\n    /**\n     * Returns `true` if the socket is connected and the channel has been joined.\n     *\n     * @internal\n     */\n    _canPush() {\n        return this.socket.isConnected() && this._isJoined();\n    }\n    /** @internal */\n    _rejoin(timeout = this.timeout) {\n        if (this._isLeaving()) {\n            return;\n        }\n        this.socket._leaveOpenTopic(this.topic);\n        this.state = CHANNEL_STATES.joining;\n        this.joinPush.resend(timeout);\n    }\n    /** @internal */\n    _getPayloadRecords(payload) {\n        const records = {\n            new: {},\n            old: {},\n        };\n        if (payload.type === 'INSERT' || payload.type === 'UPDATE') {\n            records.new = Transformers.convertChangeData(payload.columns, payload.record);\n        }\n        if (payload.type === 'UPDATE' || payload.type === 'DELETE') {\n            records.old = Transformers.convertChangeData(payload.columns, payload.old_record);\n        }\n        return records;\n    }\n}\n//# sourceMappingURL=RealtimeChannel.js.map","import WebSocketFactory from './lib/websocket-factory';\nimport { CHANNEL_EVENTS, CONNECTION_STATE, DEFAULT_VERSION, DEFAULT_TIMEOUT, SOCKET_STATES, TRANSPORTS, DEFAULT_VSN, VSN_1_0_0, VSN_2_0_0, WS_CLOSE_NORMAL, } from './lib/constants';\nimport Serializer from './lib/serializer';\nimport Timer from './lib/timer';\nimport { httpEndpointURL } from './lib/transformers';\nimport RealtimeChannel from './RealtimeChannel';\nconst noop = () => { };\n// Connection-related constants\nconst CONNECTION_TIMEOUTS = {\n    HEARTBEAT_INTERVAL: 25000,\n    RECONNECT_DELAY: 10,\n    HEARTBEAT_TIMEOUT_FALLBACK: 100,\n};\nconst RECONNECT_INTERVALS = [1000, 2000, 5000, 10000];\nconst DEFAULT_RECONNECT_FALLBACK = 10000;\nconst WORKER_SCRIPT = `\n  addEventListener(\"message\", (e) => {\n    if (e.data.event === \"start\") {\n      setInterval(() => postMessage({ event: \"keepAlive\" }), e.data.interval);\n    }\n  });`;\nexport default class RealtimeClient {\n    /**\n     * Initializes the Socket.\n     *\n     * @param endPoint The string WebSocket endpoint, ie, \"ws://example.com/socket\", \"wss://example.com\", \"/socket\" (inherited host & protocol)\n     * @param httpEndpoint The string HTTP endpoint, ie, \"https://example.com\", \"/\" (inherited host & protocol)\n     * @param options.transport The Websocket Transport, for example WebSocket. This can be a custom implementation\n     * @param options.timeout The default timeout in milliseconds to trigger push timeouts.\n     * @param options.params The optional params to pass when connecting.\n     * @param options.headers Deprecated: headers cannot be set on websocket connections and this option will be removed in the future.\n     * @param options.heartbeatIntervalMs The millisec interval to send a heartbeat message.\n     * @param options.heartbeatCallback The optional function to handle heartbeat status.\n     * @param options.logger The optional function for specialized logging, ie: logger: (kind, msg, data) => { console.log(`${kind}: ${msg}`, data) }\n     * @param options.logLevel Sets the log level for Realtime\n     * @param options.encode The function to encode outgoing messages. Defaults to JSON: (payload, callback) => callback(JSON.stringify(payload))\n     * @param options.decode The function to decode incoming messages. Defaults to Serializer's decode.\n     * @param options.reconnectAfterMs he optional function that returns the millsec reconnect interval. Defaults to stepped backoff off.\n     * @param options.worker Use Web Worker to set a side flow. Defaults to false.\n     * @param options.workerUrl The URL of the worker script. Defaults to https://realtime.supabase.com/worker.js that includes a heartbeat event call to keep the connection alive.\n     * @example\n     * ```ts\n     * import RealtimeClient from '@supabase/realtime-js'\n     *\n     * const client = new RealtimeClient('https://xyzcompany.supabase.co/realtime/v1', {\n     *   params: { apikey: 'public-anon-key' },\n     * })\n     * client.connect()\n     * ```\n     */\n    constructor(endPoint, options) {\n        var _a;\n        this.accessTokenValue = null;\n        this.apiKey = null;\n        this.channels = new Array();\n        this.endPoint = '';\n        this.httpEndpoint = '';\n        /** @deprecated headers cannot be set on websocket connections */\n        this.headers = {};\n        this.params = {};\n        this.timeout = DEFAULT_TIMEOUT;\n        this.transport = null;\n        this.heartbeatIntervalMs = CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL;\n        this.heartbeatTimer = undefined;\n        this.pendingHeartbeatRef = null;\n        this.heartbeatCallback = noop;\n        this.ref = 0;\n        this.reconnectTimer = null;\n        this.vsn = DEFAULT_VSN;\n        this.logger = noop;\n        this.conn = null;\n        this.sendBuffer = [];\n        this.serializer = new Serializer();\n        this.stateChangeCallbacks = {\n            open: [],\n            close: [],\n            error: [],\n            message: [],\n        };\n        this.accessToken = null;\n        this._connectionState = 'disconnected';\n        this._wasManualDisconnect = false;\n        this._authPromise = null;\n        /**\n         * Use either custom fetch, if provided, or default fetch to make HTTP requests\n         *\n         * @internal\n         */\n        this._resolveFetch = (customFetch) => {\n            if (customFetch) {\n                return (...args) => customFetch(...args);\n            }\n            return (...args) => fetch(...args);\n        };\n        // Validate required parameters\n        if (!((_a = options === null || options === void 0 ? void 0 : options.params) === null || _a === void 0 ? void 0 : _a.apikey)) {\n            throw new Error('API key is required to connect to Realtime');\n        }\n        this.apiKey = options.params.apikey;\n        // Initialize endpoint URLs\n        this.endPoint = `${endPoint}/${TRANSPORTS.websocket}`;\n        this.httpEndpoint = httpEndpointURL(endPoint);\n        this._initializeOptions(options);\n        this._setupReconnectionTimer();\n        this.fetch = this._resolveFetch(options === null || options === void 0 ? void 0 : options.fetch);\n    }\n    /**\n     * Connects the socket, unless already connected.\n     */\n    connect() {\n        // Skip if already connecting, disconnecting, or connected\n        if (this.isConnecting() ||\n            this.isDisconnecting() ||\n            (this.conn !== null && this.isConnected())) {\n            return;\n        }\n        this._setConnectionState('connecting');\n        // Trigger auth if needed and not already in progress\n        // This ensures auth is called for standalone RealtimeClient usage\n        // while avoiding race conditions with SupabaseClient's immediate setAuth call\n        if (this.accessToken && !this._authPromise) {\n            this._setAuthSafely('connect');\n        }\n        // Establish WebSocket connection\n        if (this.transport) {\n            // Use custom transport if provided\n            this.conn = new this.transport(this.endpointURL());\n        }\n        else {\n            // Try to use native WebSocket\n            try {\n                this.conn = WebSocketFactory.createWebSocket(this.endpointURL());\n            }\n            catch (error) {\n                this._setConnectionState('disconnected');\n                const errorMessage = error.message;\n                // Provide helpful error message based on environment\n                if (errorMessage.includes('Node.js')) {\n                    throw new Error(`${errorMessage}\\n\\n` +\n                        'To use Realtime in Node.js, you need to provide a WebSocket implementation:\\n\\n' +\n                        'Option 1: Use Node.js 22+ which has native WebSocket support\\n' +\n                        'Option 2: Install and provide the \"ws\" package:\\n\\n' +\n                        '  npm install ws\\n\\n' +\n                        '  import ws from \"ws\"\\n' +\n                        '  const client = new RealtimeClient(url, {\\n' +\n                        '    ...options,\\n' +\n                        '    transport: ws\\n' +\n                        '  })');\n                }\n                throw new Error(`WebSocket not available: ${errorMessage}`);\n            }\n        }\n        this._setupConnectionHandlers();\n    }\n    /**\n     * Returns the URL of the websocket.\n     * @returns string The URL of the websocket.\n     */\n    endpointURL() {\n        return this._appendParams(this.endPoint, Object.assign({}, this.params, { vsn: this.vsn }));\n    }\n    /**\n     * Disconnects the socket.\n     *\n     * @param code A numeric status code to send on disconnect.\n     * @param reason A custom reason for the disconnect.\n     */\n    disconnect(code, reason) {\n        if (this.isDisconnecting()) {\n            return;\n        }\n        this._setConnectionState('disconnecting', true);\n        if (this.conn) {\n            // Setup fallback timer to prevent hanging in disconnecting state\n            const fallbackTimer = setTimeout(() => {\n                this._setConnectionState('disconnected');\n            }, 100);\n            this.conn.onclose = () => {\n                clearTimeout(fallbackTimer);\n                this._setConnectionState('disconnected');\n            };\n            // Close the WebSocket connection if close method exists\n            if (typeof this.conn.close === 'function') {\n                if (code) {\n                    this.conn.close(code, reason !== null && reason !== void 0 ? reason : '');\n                }\n                else {\n                    this.conn.close();\n                }\n            }\n            this._teardownConnection();\n        }\n        else {\n            this._setConnectionState('disconnected');\n        }\n    }\n    /**\n     * Returns all created channels\n     */\n    getChannels() {\n        return this.channels;\n    }\n    /**\n     * Unsubscribes and removes a single channel\n     * @param channel A RealtimeChannel instance\n     */\n    async removeChannel(channel) {\n        const status = await channel.unsubscribe();\n        if (this.channels.length === 0) {\n            this.disconnect();\n        }\n        return status;\n    }\n    /**\n     * Unsubscribes and removes all channels\n     */\n    async removeAllChannels() {\n        const values_1 = await Promise.all(this.channels.map((channel) => channel.unsubscribe()));\n        this.channels = [];\n        this.disconnect();\n        return values_1;\n    }\n    /**\n     * Logs the message.\n     *\n     * For customized logging, `this.logger` can be overridden.\n     */\n    log(kind, msg, data) {\n        this.logger(kind, msg, data);\n    }\n    /**\n     * Returns the current state of the socket.\n     */\n    connectionState() {\n        switch (this.conn && this.conn.readyState) {\n            case SOCKET_STATES.connecting:\n                return CONNECTION_STATE.Connecting;\n            case SOCKET_STATES.open:\n                return CONNECTION_STATE.Open;\n            case SOCKET_STATES.closing:\n                return CONNECTION_STATE.Closing;\n            default:\n                return CONNECTION_STATE.Closed;\n        }\n    }\n    /**\n     * Returns `true` is the connection is open.\n     */\n    isConnected() {\n        return this.connectionState() === CONNECTION_STATE.Open;\n    }\n    /**\n     * Returns `true` if the connection is currently connecting.\n     */\n    isConnecting() {\n        return this._connectionState === 'connecting';\n    }\n    /**\n     * Returns `true` if the connection is currently disconnecting.\n     */\n    isDisconnecting() {\n        return this._connectionState === 'disconnecting';\n    }\n    /**\n     * Creates (or reuses) a {@link RealtimeChannel} for the provided topic.\n     *\n     * Topics are automatically prefixed with `realtime:` to match the Realtime service.\n     * If a channel with the same topic already exists it will be returned instead of creating\n     * a duplicate connection.\n     */\n    channel(topic, params = { config: {} }) {\n        const realtimeTopic = `realtime:${topic}`;\n        const exists = this.getChannels().find((c) => c.topic === realtimeTopic);\n        if (!exists) {\n            const chan = new RealtimeChannel(`realtime:${topic}`, params, this);\n            this.channels.push(chan);\n            return chan;\n        }\n        else {\n            return exists;\n        }\n    }\n    /**\n     * Push out a message if the socket is connected.\n     *\n     * If the socket is not connected, the message gets enqueued within a local buffer, and sent out when a connection is next established.\n     */\n    push(data) {\n        const { topic, event, payload, ref } = data;\n        const callback = () => {\n            this.encode(data, (result) => {\n                var _a;\n                (_a = this.conn) === null || _a === void 0 ? void 0 : _a.send(result);\n            });\n        };\n        this.log('push', `${topic} ${event} (${ref})`, payload);\n        if (this.isConnected()) {\n            callback();\n        }\n        else {\n            this.sendBuffer.push(callback);\n        }\n    }\n    /**\n     * Sets the JWT access token used for channel subscription authorization and Realtime RLS.\n     *\n     * If param is null it will use the `accessToken` callback function or the token set on the client.\n     *\n     * On callback used, it will set the value of the token internal to the client.\n     *\n     * @param token A JWT string to override the token set on the client.\n     */\n    async setAuth(token = null) {\n        this._authPromise = this._performAuth(token);\n        try {\n            await this._authPromise;\n        }\n        finally {\n            this._authPromise = null;\n        }\n    }\n    /**\n     * Sends a heartbeat message if the socket is connected.\n     */\n    async sendHeartbeat() {\n        var _a;\n        if (!this.isConnected()) {\n            try {\n                this.heartbeatCallback('disconnected');\n            }\n            catch (e) {\n                this.log('error', 'error in heartbeat callback', e);\n            }\n            return;\n        }\n        // Handle heartbeat timeout and force reconnection if needed\n        if (this.pendingHeartbeatRef) {\n            this.pendingHeartbeatRef = null;\n            this.log('transport', 'heartbeat timeout. Attempting to re-establish connection');\n            try {\n                this.heartbeatCallback('timeout');\n            }\n            catch (e) {\n                this.log('error', 'error in heartbeat callback', e);\n            }\n            // Force reconnection after heartbeat timeout\n            this._wasManualDisconnect = false;\n            (_a = this.conn) === null || _a === void 0 ? void 0 : _a.close(WS_CLOSE_NORMAL, 'heartbeat timeout');\n            setTimeout(() => {\n                var _a;\n                if (!this.isConnected()) {\n                    (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.scheduleTimeout();\n                }\n            }, CONNECTION_TIMEOUTS.HEARTBEAT_TIMEOUT_FALLBACK);\n            return;\n        }\n        // Send heartbeat message to server\n        this.pendingHeartbeatRef = this._makeRef();\n        this.push({\n            topic: 'phoenix',\n            event: 'heartbeat',\n            payload: {},\n            ref: this.pendingHeartbeatRef,\n        });\n        try {\n            this.heartbeatCallback('sent');\n        }\n        catch (e) {\n            this.log('error', 'error in heartbeat callback', e);\n        }\n        this._setAuthSafely('heartbeat');\n    }\n    /**\n     * Sets a callback that receives lifecycle events for internal heartbeat messages.\n     * Useful for instrumenting connection health (e.g. sent/ok/timeout/disconnected).\n     */\n    onHeartbeat(callback) {\n        this.heartbeatCallback = callback;\n    }\n    /**\n     * Flushes send buffer\n     */\n    flushSendBuffer() {\n        if (this.isConnected() && this.sendBuffer.length > 0) {\n            this.sendBuffer.forEach((callback) => callback());\n            this.sendBuffer = [];\n        }\n    }\n    /**\n     * Return the next message ref, accounting for overflows\n     *\n     * @internal\n     */\n    _makeRef() {\n        let newRef = this.ref + 1;\n        if (newRef === this.ref) {\n            this.ref = 0;\n        }\n        else {\n            this.ref = newRef;\n        }\n        return this.ref.toString();\n    }\n    /**\n     * Unsubscribe from channels with the specified topic.\n     *\n     * @internal\n     */\n    _leaveOpenTopic(topic) {\n        let dupChannel = this.channels.find((c) => c.topic === topic && (c._isJoined() || c._isJoining()));\n        if (dupChannel) {\n            this.log('transport', `leaving duplicate topic \"${topic}\"`);\n            dupChannel.unsubscribe();\n        }\n    }\n    /**\n     * Removes a subscription from the socket.\n     *\n     * @param channel An open subscription.\n     *\n     * @internal\n     */\n    _remove(channel) {\n        this.channels = this.channels.filter((c) => c.topic !== channel.topic);\n    }\n    /** @internal */\n    _onConnMessage(rawMessage) {\n        this.decode(rawMessage.data, (msg) => {\n            // Handle heartbeat responses\n            if (msg.topic === 'phoenix' && msg.event === 'phx_reply') {\n                try {\n                    this.heartbeatCallback(msg.payload.status === 'ok' ? 'ok' : 'error');\n                }\n                catch (e) {\n                    this.log('error', 'error in heartbeat callback', e);\n                }\n            }\n            // Handle pending heartbeat reference cleanup\n            if (msg.ref && msg.ref === this.pendingHeartbeatRef) {\n                this.pendingHeartbeatRef = null;\n            }\n            // Log incoming message\n            const { topic, event, payload, ref } = msg;\n            const refString = ref ? `(${ref})` : '';\n            const status = payload.status || '';\n            this.log('receive', `${status} ${topic} ${event} ${refString}`.trim(), payload);\n            // Route message to appropriate channels\n            this.channels\n                .filter((channel) => channel._isMember(topic))\n                .forEach((channel) => channel._trigger(event, payload, ref));\n            this._triggerStateCallbacks('message', msg);\n        });\n    }\n    /**\n     * Clear specific timer\n     * @internal\n     */\n    _clearTimer(timer) {\n        var _a;\n        if (timer === 'heartbeat' && this.heartbeatTimer) {\n            clearInterval(this.heartbeatTimer);\n            this.heartbeatTimer = undefined;\n        }\n        else if (timer === 'reconnect') {\n            (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.reset();\n        }\n    }\n    /**\n     * Clear all timers\n     * @internal\n     */\n    _clearAllTimers() {\n        this._clearTimer('heartbeat');\n        this._clearTimer('reconnect');\n    }\n    /**\n     * Setup connection handlers for WebSocket events\n     * @internal\n     */\n    _setupConnectionHandlers() {\n        if (!this.conn)\n            return;\n        // Set binary type if supported (browsers and most WebSocket implementations)\n        if ('binaryType' in this.conn) {\n            ;\n            this.conn.binaryType = 'arraybuffer';\n        }\n        this.conn.onopen = () => this._onConnOpen();\n        this.conn.onerror = (error) => this._onConnError(error);\n        this.conn.onmessage = (event) => this._onConnMessage(event);\n        this.conn.onclose = (event) => this._onConnClose(event);\n    }\n    /**\n     * Teardown connection and cleanup resources\n     * @internal\n     */\n    _teardownConnection() {\n        if (this.conn) {\n            if (this.conn.readyState === SOCKET_STATES.open ||\n                this.conn.readyState === SOCKET_STATES.connecting) {\n                try {\n                    this.conn.close();\n                }\n                catch (e) {\n                    this.log('error', 'Error closing connection', e);\n                }\n            }\n            this.conn.onopen = null;\n            this.conn.onerror = null;\n            this.conn.onmessage = null;\n            this.conn.onclose = null;\n            this.conn = null;\n        }\n        this._clearAllTimers();\n        this.channels.forEach((channel) => channel.teardown());\n    }\n    /** @internal */\n    _onConnOpen() {\n        this._setConnectionState('connected');\n        this.log('transport', `connected to ${this.endpointURL()}`);\n        // Wait for any pending auth operations before flushing send buffer\n        // This ensures channel join messages include the correct access token\n        const authPromise = this._authPromise ||\n            (this.accessToken && !this.accessTokenValue ? this.setAuth() : Promise.resolve());\n        authPromise\n            .then(() => {\n            this.flushSendBuffer();\n        })\n            .catch((e) => {\n            this.log('error', 'error waiting for auth on connect', e);\n            // Proceed anyway to avoid hanging connections\n            this.flushSendBuffer();\n        });\n        this._clearTimer('reconnect');\n        if (!this.worker) {\n            this._startHeartbeat();\n        }\n        else {\n            if (!this.workerRef) {\n                this._startWorkerHeartbeat();\n            }\n        }\n        this._triggerStateCallbacks('open');\n    }\n    /** @internal */\n    _startHeartbeat() {\n        this.heartbeatTimer && clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = setInterval(() => this.sendHeartbeat(), this.heartbeatIntervalMs);\n    }\n    /** @internal */\n    _startWorkerHeartbeat() {\n        if (this.workerUrl) {\n            this.log('worker', `starting worker for from ${this.workerUrl}`);\n        }\n        else {\n            this.log('worker', `starting default worker`);\n        }\n        const objectUrl = this._workerObjectUrl(this.workerUrl);\n        this.workerRef = new Worker(objectUrl);\n        this.workerRef.onerror = (error) => {\n            this.log('worker', 'worker error', error.message);\n            this.workerRef.terminate();\n        };\n        this.workerRef.onmessage = (event) => {\n            if (event.data.event === 'keepAlive') {\n                this.sendHeartbeat();\n            }\n        };\n        this.workerRef.postMessage({\n            event: 'start',\n            interval: this.heartbeatIntervalMs,\n        });\n    }\n    /** @internal */\n    _onConnClose(event) {\n        var _a;\n        this._setConnectionState('disconnected');\n        this.log('transport', 'close', event);\n        this._triggerChanError();\n        this._clearTimer('heartbeat');\n        // Only schedule reconnection if it wasn't a manual disconnect\n        if (!this._wasManualDisconnect) {\n            (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.scheduleTimeout();\n        }\n        this._triggerStateCallbacks('close', event);\n    }\n    /** @internal */\n    _onConnError(error) {\n        this._setConnectionState('disconnected');\n        this.log('transport', `${error}`);\n        this._triggerChanError();\n        this._triggerStateCallbacks('error', error);\n    }\n    /** @internal */\n    _triggerChanError() {\n        this.channels.forEach((channel) => channel._trigger(CHANNEL_EVENTS.error));\n    }\n    /** @internal */\n    _appendParams(url, params) {\n        if (Object.keys(params).length === 0) {\n            return url;\n        }\n        const prefix = url.match(/\\?/) ? '&' : '?';\n        const query = new URLSearchParams(params);\n        return `${url}${prefix}${query}`;\n    }\n    _workerObjectUrl(url) {\n        let result_url;\n        if (url) {\n            result_url = url;\n        }\n        else {\n            const blob = new Blob([WORKER_SCRIPT], { type: 'application/javascript' });\n            result_url = URL.createObjectURL(blob);\n        }\n        return result_url;\n    }\n    /**\n     * Set connection state with proper state management\n     * @internal\n     */\n    _setConnectionState(state, manual = false) {\n        this._connectionState = state;\n        if (state === 'connecting') {\n            this._wasManualDisconnect = false;\n        }\n        else if (state === 'disconnecting') {\n            this._wasManualDisconnect = manual;\n        }\n    }\n    /**\n     * Perform the actual auth operation\n     * @internal\n     */\n    async _performAuth(token = null) {\n        let tokenToSend;\n        if (token) {\n            tokenToSend = token;\n        }\n        else if (this.accessToken) {\n            // Always call the accessToken callback to get fresh token\n            tokenToSend = await this.accessToken();\n        }\n        else {\n            tokenToSend = this.accessTokenValue;\n        }\n        if (this.accessTokenValue != tokenToSend) {\n            this.accessTokenValue = tokenToSend;\n            this.channels.forEach((channel) => {\n                const payload = {\n                    access_token: tokenToSend,\n                    version: DEFAULT_VERSION,\n                };\n                tokenToSend && channel.updateJoinPayload(payload);\n                if (channel.joinedOnce && channel._isJoined()) {\n                    channel._push(CHANNEL_EVENTS.access_token, {\n                        access_token: tokenToSend,\n                    });\n                }\n            });\n        }\n    }\n    /**\n     * Wait for any in-flight auth operations to complete\n     * @internal\n     */\n    async _waitForAuthIfNeeded() {\n        if (this._authPromise) {\n            await this._authPromise;\n        }\n    }\n    /**\n     * Safely call setAuth with standardized error handling\n     * @internal\n     */\n    _setAuthSafely(context = 'general') {\n        this.setAuth().catch((e) => {\n            this.log('error', `error setting auth in ${context}`, e);\n        });\n    }\n    /**\n     * Trigger state change callbacks with proper error handling\n     * @internal\n     */\n    _triggerStateCallbacks(event, data) {\n        try {\n            this.stateChangeCallbacks[event].forEach((callback) => {\n                try {\n                    callback(data);\n                }\n                catch (e) {\n                    this.log('error', `error in ${event} callback`, e);\n                }\n            });\n        }\n        catch (e) {\n            this.log('error', `error triggering ${event} callbacks`, e);\n        }\n    }\n    /**\n     * Setup reconnection timer with proper configuration\n     * @internal\n     */\n    _setupReconnectionTimer() {\n        this.reconnectTimer = new Timer(async () => {\n            setTimeout(async () => {\n                await this._waitForAuthIfNeeded();\n                if (!this.isConnected()) {\n                    this.connect();\n                }\n            }, CONNECTION_TIMEOUTS.RECONNECT_DELAY);\n        }, this.reconnectAfterMs);\n    }\n    /**\n     * Initialize client options with defaults\n     * @internal\n     */\n    _initializeOptions(options) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n        // Set defaults\n        this.transport = (_a = options === null || options === void 0 ? void 0 : options.transport) !== null && _a !== void 0 ? _a : null;\n        this.timeout = (_b = options === null || options === void 0 ? void 0 : options.timeout) !== null && _b !== void 0 ? _b : DEFAULT_TIMEOUT;\n        this.heartbeatIntervalMs =\n            (_c = options === null || options === void 0 ? void 0 : options.heartbeatIntervalMs) !== null && _c !== void 0 ? _c : CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL;\n        this.worker = (_d = options === null || options === void 0 ? void 0 : options.worker) !== null && _d !== void 0 ? _d : false;\n        this.accessToken = (_e = options === null || options === void 0 ? void 0 : options.accessToken) !== null && _e !== void 0 ? _e : null;\n        this.heartbeatCallback = (_f = options === null || options === void 0 ? void 0 : options.heartbeatCallback) !== null && _f !== void 0 ? _f : noop;\n        this.vsn = (_g = options === null || options === void 0 ? void 0 : options.vsn) !== null && _g !== void 0 ? _g : DEFAULT_VSN;\n        // Handle special cases\n        if (options === null || options === void 0 ? void 0 : options.params)\n            this.params = options.params;\n        if (options === null || options === void 0 ? void 0 : options.logger)\n            this.logger = options.logger;\n        if ((options === null || options === void 0 ? void 0 : options.logLevel) || (options === null || options === void 0 ? void 0 : options.log_level)) {\n            this.logLevel = options.logLevel || options.log_level;\n            this.params = Object.assign(Object.assign({}, this.params), { log_level: this.logLevel });\n        }\n        // Set up functions with defaults\n        this.reconnectAfterMs =\n            (_h = options === null || options === void 0 ? void 0 : options.reconnectAfterMs) !== null && _h !== void 0 ? _h : ((tries) => {\n                return RECONNECT_INTERVALS[tries - 1] || DEFAULT_RECONNECT_FALLBACK;\n            });\n        switch (this.vsn) {\n            case VSN_1_0_0:\n                this.encode =\n                    (_j = options === null || options === void 0 ? void 0 : options.encode) !== null && _j !== void 0 ? _j : ((payload, callback) => {\n                        return callback(JSON.stringify(payload));\n                    });\n                this.decode =\n                    (_k = options === null || options === void 0 ? void 0 : options.decode) !== null && _k !== void 0 ? _k : ((payload, callback) => {\n                        return callback(JSON.parse(payload));\n                    });\n                break;\n            case VSN_2_0_0:\n                this.encode = (_l = options === null || options === void 0 ? void 0 : options.encode) !== null && _l !== void 0 ? _l : this.serializer.encode.bind(this.serializer);\n                this.decode = (_m = options === null || options === void 0 ? void 0 : options.decode) !== null && _m !== void 0 ? _m : this.serializer.decode.bind(this.serializer);\n                break;\n            default:\n                throw new Error(`Unsupported serializer version: ${this.vsn}`);\n        }\n        // Handle worker setup\n        if (this.worker) {\n            if (typeof window !== 'undefined' && !window.Worker) {\n                throw new Error('Web Worker is not supported');\n            }\n            this.workerUrl = options === null || options === void 0 ? void 0 : options.workerUrl;\n        }\n    }\n}\n//# sourceMappingURL=RealtimeClient.js.map","export class StorageError extends Error {\n    constructor(message) {\n        super(message);\n        this.__isStorageError = true;\n        this.name = 'StorageError';\n    }\n}\nexport function isStorageError(error) {\n    return typeof error === 'object' && error !== null && '__isStorageError' in error;\n}\nexport class StorageApiError extends StorageError {\n    constructor(message, status, statusCode) {\n        super(message);\n        this.name = 'StorageApiError';\n        this.status = status;\n        this.statusCode = statusCode;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            statusCode: this.statusCode,\n        };\n    }\n}\nexport class StorageUnknownError extends StorageError {\n    constructor(message, originalError) {\n        super(message);\n        this.name = 'StorageUnknownError';\n        this.originalError = originalError;\n    }\n}\n//# sourceMappingURL=errors.js.map","export const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\nexport const resolveResponse = () => {\n    return Response;\n};\nexport const recursiveToCamel = (item) => {\n    if (Array.isArray(item)) {\n        return item.map((el) => recursiveToCamel(el));\n    }\n    else if (typeof item === 'function' || item !== Object(item)) {\n        return item;\n    }\n    const result = {};\n    Object.entries(item).forEach(([key, value]) => {\n        const newKey = key.replace(/([-_][a-z])/gi, (c) => c.toUpperCase().replace(/[-_]/g, ''));\n        result[newKey] = recursiveToCamel(value);\n    });\n    return result;\n};\n/**\n * Determine if input is a plain object\n * An object is plain if it's created by either {}, new Object(), or Object.create(null)\n * source: https://github.com/sindresorhus/is-plain-obj\n */\nexport const isPlainObject = (value) => {\n    if (typeof value !== 'object' || value === null) {\n        return false;\n    }\n    const prototype = Object.getPrototypeOf(value);\n    return ((prototype === null ||\n        prototype === Object.prototype ||\n        Object.getPrototypeOf(prototype) === null) &&\n        !(Symbol.toStringTag in value) &&\n        !(Symbol.iterator in value));\n};\n/**\n * Validates if a given bucket name is valid according to Supabase Storage API rules\n * Mirrors backend validation from: storage/src/storage/limits.ts:isValidBucketName()\n *\n * Rules:\n * - Length: 1-100 characters\n * - Allowed characters: alphanumeric (a-z, A-Z, 0-9), underscore (_), and safe special characters\n * - Safe special characters: ! - . * ' ( ) space & $ @ = ; : + , ?\n * - Forbidden: path separators (/, \\), path traversal (..), leading/trailing whitespace\n *\n * AWS S3 Reference: https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html\n *\n * @param bucketName - The bucket name to validate\n * @returns true if valid, false otherwise\n */\nexport const isValidBucketName = (bucketName) => {\n    if (!bucketName || typeof bucketName !== 'string') {\n        return false;\n    }\n    // Check length constraints (1-100 characters)\n    if (bucketName.length === 0 || bucketName.length > 100) {\n        return false;\n    }\n    // Check for leading/trailing whitespace\n    if (bucketName.trim() !== bucketName) {\n        return false;\n    }\n    // Explicitly reject path separators (security)\n    // Note: Consecutive periods (..) are allowed by backend - the AWS restriction\n    // on relative paths applies to object keys, not bucket names\n    if (bucketName.includes('/') || bucketName.includes('\\\\')) {\n        return false;\n    }\n    // Validate against allowed character set\n    // Pattern matches backend regex: /^(\\w|!|-|\\.|\\*|'|\\(|\\)| |&|\\$|@|=|;|:|\\+|,|\\?)*$/\n    // This explicitly excludes path separators (/, \\) and other problematic characters\n    const bucketNameRegex = /^[\\w!.\\*'() &$@=;:+,?-]+$/;\n    return bucketNameRegex.test(bucketName);\n};\n//# sourceMappingURL=helpers.js.map","import { __awaiter } from \"tslib\";\nimport { StorageApiError, StorageUnknownError } from './errors';\nimport { isPlainObject, resolveResponse } from './helpers';\nconst _getErrorMessage = (err) => {\n    var _a;\n    return err.msg ||\n        err.message ||\n        err.error_description ||\n        (typeof err.error === 'string' ? err.error : (_a = err.error) === null || _a === void 0 ? void 0 : _a.message) ||\n        JSON.stringify(err);\n};\nconst handleError = (error, reject, options) => __awaiter(void 0, void 0, void 0, function* () {\n    const Res = yield resolveResponse();\n    if (error instanceof Res && !(options === null || options === void 0 ? void 0 : options.noResolveJson)) {\n        error\n            .json()\n            .then((err) => {\n            const status = error.status || 500;\n            const statusCode = (err === null || err === void 0 ? void 0 : err.statusCode) || status + '';\n            reject(new StorageApiError(_getErrorMessage(err), status, statusCode));\n        })\n            .catch((err) => {\n            reject(new StorageUnknownError(_getErrorMessage(err), err));\n        });\n    }\n    else {\n        reject(new StorageUnknownError(_getErrorMessage(error), error));\n    }\n});\nconst _getRequestParams = (method, options, parameters, body) => {\n    const params = { method, headers: (options === null || options === void 0 ? void 0 : options.headers) || {} };\n    if (method === 'GET' || !body) {\n        return params;\n    }\n    if (isPlainObject(body)) {\n        params.headers = Object.assign({ 'Content-Type': 'application/json' }, options === null || options === void 0 ? void 0 : options.headers);\n        params.body = JSON.stringify(body);\n    }\n    else {\n        params.body = body;\n    }\n    if (options === null || options === void 0 ? void 0 : options.duplex) {\n        params.duplex = options.duplex;\n    }\n    return Object.assign(Object.assign({}, params), parameters);\n};\nfunction _handleRequest(fetcher, method, url, options, parameters, body) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            fetcher(url, _getRequestParams(method, options, parameters, body))\n                .then((result) => {\n                if (!result.ok)\n                    throw result;\n                if (options === null || options === void 0 ? void 0 : options.noResolveJson)\n                    return result;\n                return result.json();\n            })\n                .then((data) => resolve(data))\n                .catch((error) => handleError(error, reject, options));\n        });\n    });\n}\nexport function get(fetcher, url, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'GET', url, options, parameters);\n    });\n}\nexport function post(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'POST', url, options, parameters, body);\n    });\n}\nexport function put(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'PUT', url, options, parameters, body);\n    });\n}\nexport function head(fetcher, url, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'HEAD', url, Object.assign(Object.assign({}, options), { noResolveJson: true }), parameters);\n    });\n}\nexport function remove(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'DELETE', url, options, parameters, body);\n    });\n}\n//# sourceMappingURL=fetch.js.map","import { __awaiter } from \"tslib\";\nimport { isStorageError } from '../lib/errors';\nexport default class StreamDownloadBuilder {\n    constructor(downloadFn, shouldThrowOnError) {\n        this.downloadFn = downloadFn;\n        this.shouldThrowOnError = shouldThrowOnError;\n    }\n    then(onfulfilled, onrejected) {\n        return this.execute().then(onfulfilled, onrejected);\n    }\n    execute() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const result = yield this.downloadFn();\n                return {\n                    data: result.body,\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=StreamDownloadBuilder.js.map","var _a;\nimport { __awaiter } from \"tslib\";\nimport { isStorageError } from '../lib/errors';\nimport StreamDownloadBuilder from './StreamDownloadBuilder';\nclass BlobDownloadBuilder {\n    constructor(downloadFn, shouldThrowOnError) {\n        this.downloadFn = downloadFn;\n        this.shouldThrowOnError = shouldThrowOnError;\n        this[_a] = 'BlobDownloadBuilder';\n        this.promise = null;\n    }\n    asStream() {\n        return new StreamDownloadBuilder(this.downloadFn, this.shouldThrowOnError);\n    }\n    then(onfulfilled, onrejected) {\n        return this.getPromise().then(onfulfilled, onrejected);\n    }\n    catch(onrejected) {\n        return this.getPromise().catch(onrejected);\n    }\n    finally(onfinally) {\n        return this.getPromise().finally(onfinally);\n    }\n    getPromise() {\n        if (!this.promise) {\n            this.promise = this.execute();\n        }\n        return this.promise;\n    }\n    execute() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const result = yield this.downloadFn();\n                return {\n                    data: yield result.blob(),\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n_a = Symbol.toStringTag;\nexport default BlobDownloadBuilder;\n//# sourceMappingURL=BlobDownloadBuilder.js.map","import { __awaiter } from \"tslib\";\nimport { isStorageError, StorageError, StorageUnknownError } from '../lib/errors';\nimport { get, head, post, put, remove } from '../lib/fetch';\nimport { recursiveToCamel, resolveFetch } from '../lib/helpers';\nimport BlobDownloadBuilder from './BlobDownloadBuilder';\nconst DEFAULT_SEARCH_OPTIONS = {\n    limit: 100,\n    offset: 0,\n    sortBy: {\n        column: 'name',\n        order: 'asc',\n    },\n};\nconst DEFAULT_FILE_OPTIONS = {\n    cacheControl: '3600',\n    contentType: 'text/plain;charset=UTF-8',\n    upsert: false,\n};\nexport default class StorageFileApi {\n    constructor(url, headers = {}, bucketId, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url;\n        this.headers = headers;\n        this.bucketId = bucketId;\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them.\n     *\n     * @category File Buckets\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Uploads a file to an existing bucket or replaces an existing file at the specified path with a new one.\n     *\n     * @param method HTTP method.\n     * @param path The relative file path. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to upload.\n     * @param fileBody The body of the file to be stored in the bucket.\n     */\n    uploadOrUpdate(method, path, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let body;\n                const options = Object.assign(Object.assign({}, DEFAULT_FILE_OPTIONS), fileOptions);\n                let headers = Object.assign(Object.assign({}, this.headers), (method === 'POST' && { 'x-upsert': String(options.upsert) }));\n                const metadata = options.metadata;\n                if (typeof Blob !== 'undefined' && fileBody instanceof Blob) {\n                    body = new FormData();\n                    body.append('cacheControl', options.cacheControl);\n                    if (metadata) {\n                        body.append('metadata', this.encodeMetadata(metadata));\n                    }\n                    body.append('', fileBody);\n                }\n                else if (typeof FormData !== 'undefined' && fileBody instanceof FormData) {\n                    body = fileBody;\n                    // Only append if not already present\n                    if (!body.has('cacheControl')) {\n                        body.append('cacheControl', options.cacheControl);\n                    }\n                    if (metadata && !body.has('metadata')) {\n                        body.append('metadata', this.encodeMetadata(metadata));\n                    }\n                }\n                else {\n                    body = fileBody;\n                    headers['cache-control'] = `max-age=${options.cacheControl}`;\n                    headers['content-type'] = options.contentType;\n                    if (metadata) {\n                        headers['x-metadata'] = this.toBase64(this.encodeMetadata(metadata));\n                    }\n                    // Node.js streams require duplex option for fetch in Node 20+\n                    // Check for both web ReadableStream and Node.js streams\n                    const isStream = (typeof ReadableStream !== 'undefined' && body instanceof ReadableStream) ||\n                        (body && typeof body === 'object' && 'pipe' in body && typeof body.pipe === 'function');\n                    if (isStream && !options.duplex) {\n                        options.duplex = 'half';\n                    }\n                }\n                if (fileOptions === null || fileOptions === void 0 ? void 0 : fileOptions.headers) {\n                    headers = Object.assign(Object.assign({}, headers), fileOptions.headers);\n                }\n                const cleanPath = this._removeEmptyFolders(path);\n                const _path = this._getFinalPath(cleanPath);\n                const data = yield (method == 'PUT' ? put : post)(this.fetch, `${this.url}/object/${_path}`, body, Object.assign({ headers }, ((options === null || options === void 0 ? void 0 : options.duplex) ? { duplex: options.duplex } : {})));\n                return {\n                    data: { path: cleanPath, id: data.Id, fullPath: data.Key },\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Uploads a file to an existing bucket.\n     *\n     * @category File Buckets\n     * @param path The file path, including the file name. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to upload.\n     * @param fileBody The body of the file to be stored in the bucket.\n     * @param fileOptions Optional file upload options including cacheControl, contentType, upsert, and metadata.\n     * @returns Promise with response containing file path, id, and fullPath or error\n     *\n     * @example Upload file\n     * ```js\n     * const avatarFile = event.target.files[0]\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .upload('public/avatar1.png', avatarFile, {\n     *     cacheControl: '3600',\n     *     upsert: false\n     *   })\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"path\": \"public/avatar1.png\",\n     *     \"fullPath\": \"avatars/public/avatar1.png\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     *\n     * @example Upload file using `ArrayBuffer` from base64 file data\n     * ```js\n     * import { decode } from 'base64-arraybuffer'\n     *\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .upload('public/avatar1.png', decode('base64FileData'), {\n     *     contentType: 'image/png'\n     *   })\n     * ```\n     */\n    upload(path, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.uploadOrUpdate('POST', path, fileBody, fileOptions);\n        });\n    }\n    /**\n     * Upload a file with a token generated from `createSignedUploadUrl`.\n     *\n     * @category File Buckets\n     * @param path The file path, including the file name. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to upload.\n     * @param token The token generated from `createSignedUploadUrl`\n     * @param fileBody The body of the file to be stored in the bucket.\n     * @param fileOptions Optional file upload options including cacheControl and contentType.\n     * @returns Promise with response containing file path and fullPath or error\n     *\n     * @example Upload to a signed URL\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .uploadToSignedUrl('folder/cat.jpg', 'token-from-createSignedUploadUrl', file)\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"path\": \"folder/cat.jpg\",\n     *     \"fullPath\": \"avatars/folder/cat.jpg\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    uploadToSignedUrl(path, token, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cleanPath = this._removeEmptyFolders(path);\n            const _path = this._getFinalPath(cleanPath);\n            const url = new URL(this.url + `/object/upload/sign/${_path}`);\n            url.searchParams.set('token', token);\n            try {\n                let body;\n                const options = Object.assign({ upsert: DEFAULT_FILE_OPTIONS.upsert }, fileOptions);\n                const headers = Object.assign(Object.assign({}, this.headers), { 'x-upsert': String(options.upsert) });\n                if (typeof Blob !== 'undefined' && fileBody instanceof Blob) {\n                    body = new FormData();\n                    body.append('cacheControl', options.cacheControl);\n                    body.append('', fileBody);\n                }\n                else if (typeof FormData !== 'undefined' && fileBody instanceof FormData) {\n                    body = fileBody;\n                    body.append('cacheControl', options.cacheControl);\n                }\n                else {\n                    body = fileBody;\n                    headers['cache-control'] = `max-age=${options.cacheControl}`;\n                    headers['content-type'] = options.contentType;\n                }\n                const data = yield put(this.fetch, url.toString(), body, { headers });\n                return {\n                    data: { path: cleanPath, fullPath: data.Key },\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates a signed upload URL.\n     * Signed upload URLs can be used to upload files to the bucket without further authentication.\n     * They are valid for 2 hours.\n     *\n     * @category File Buckets\n     * @param path The file path, including the current file name. For example `folder/image.png`.\n     * @param options.upsert If set to true, allows the file to be overwritten if it already exists.\n     * @returns Promise with response containing signed upload URL, token, and path or error\n     *\n     * @example Create Signed Upload URL\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .createSignedUploadUrl('folder/cat.jpg')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"signedUrl\": \"https://example.supabase.co/storage/v1/object/upload/sign/avatars/folder/cat.jpg?token=<TOKEN>\",\n     *     \"path\": \"folder/cat.jpg\",\n     *     \"token\": \"<TOKEN>\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    createSignedUploadUrl(path, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let _path = this._getFinalPath(path);\n                const headers = Object.assign({}, this.headers);\n                if (options === null || options === void 0 ? void 0 : options.upsert) {\n                    headers['x-upsert'] = 'true';\n                }\n                const data = yield post(this.fetch, `${this.url}/object/upload/sign/${_path}`, {}, { headers });\n                const url = new URL(this.url + data.url);\n                const token = url.searchParams.get('token');\n                if (!token) {\n                    throw new StorageError('No token returned by API');\n                }\n                return { data: { signedUrl: url.toString(), path, token }, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Replaces an existing file at the specified path with a new one.\n     *\n     * @category File Buckets\n     * @param path The relative file path. Should be of the format `folder/subfolder/filename.png`. The bucket must already exist before attempting to update.\n     * @param fileBody The body of the file to be stored in the bucket.\n     * @param fileOptions Optional file upload options including cacheControl, contentType, upsert, and metadata.\n     * @returns Promise with response containing file path, id, and fullPath or error\n     *\n     * @example Update file\n     * ```js\n     * const avatarFile = event.target.files[0]\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .update('public/avatar1.png', avatarFile, {\n     *     cacheControl: '3600',\n     *     upsert: true\n     *   })\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"path\": \"public/avatar1.png\",\n     *     \"fullPath\": \"avatars/public/avatar1.png\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     *\n     * @example Update file using `ArrayBuffer` from base64 file data\n     * ```js\n     * import {decode} from 'base64-arraybuffer'\n     *\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .update('public/avatar1.png', decode('base64FileData'), {\n     *     contentType: 'image/png'\n     *   })\n     * ```\n     */\n    update(path, fileBody, fileOptions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.uploadOrUpdate('PUT', path, fileBody, fileOptions);\n        });\n    }\n    /**\n     * Moves an existing file to a new path in the same bucket.\n     *\n     * @category File Buckets\n     * @param fromPath The original file path, including the current file name. For example `folder/image.png`.\n     * @param toPath The new file path, including the new file name. For example `folder/image-new.png`.\n     * @param options The destination options.\n     * @returns Promise with response containing success message or error\n     *\n     * @example Move file\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .move('public/avatar1.png', 'private/avatar2.png')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"message\": \"Successfully moved\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    move(fromPath, toPath, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/object/move`, {\n                    bucketId: this.bucketId,\n                    sourceKey: fromPath,\n                    destinationKey: toPath,\n                    destinationBucket: options === null || options === void 0 ? void 0 : options.destinationBucket,\n                }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Copies an existing file to a new path in the same bucket.\n     *\n     * @category File Buckets\n     * @param fromPath The original file path, including the current file name. For example `folder/image.png`.\n     * @param toPath The new file path, including the new file name. For example `folder/image-copy.png`.\n     * @param options The destination options.\n     * @returns Promise with response containing copied file path or error\n     *\n     * @example Copy file\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .copy('public/avatar1.png', 'private/avatar2.png')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"path\": \"avatars/private/avatar2.png\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    copy(fromPath, toPath, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/object/copy`, {\n                    bucketId: this.bucketId,\n                    sourceKey: fromPath,\n                    destinationKey: toPath,\n                    destinationBucket: options === null || options === void 0 ? void 0 : options.destinationBucket,\n                }, { headers: this.headers });\n                return { data: { path: data.Key }, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates a signed URL. Use a signed URL to share a file for a fixed amount of time.\n     *\n     * @category File Buckets\n     * @param path The file path, including the current file name. For example `folder/image.png`.\n     * @param expiresIn The number of seconds until the signed URL expires. For example, `60` for a URL which is valid for one minute.\n     * @param options.download triggers the file as a download if set to true. Set this parameter as the name of the file if you want to trigger the download with a different filename.\n     * @param options.transform Transform the asset before serving it to the client.\n     * @returns Promise with response containing signed URL or error\n     *\n     * @example Create Signed URL\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .createSignedUrl('folder/avatar1.png', 60)\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"signedUrl\": \"https://example.supabase.co/storage/v1/object/sign/avatars/folder/avatar1.png?token=<TOKEN>\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     *\n     * @example Create a signed URL for an asset with transformations\n     * ```js\n     * const { data } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .createSignedUrl('folder/avatar1.png', 60, {\n     *     transform: {\n     *       width: 100,\n     *       height: 100,\n     *     }\n     *   })\n     * ```\n     *\n     * @example Create a signed URL which triggers the download of the asset\n     * ```js\n     * const { data } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .createSignedUrl('folder/avatar1.png', 60, {\n     *     download: true,\n     *   })\n     * ```\n     */\n    createSignedUrl(path, expiresIn, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let _path = this._getFinalPath(path);\n                let data = yield post(this.fetch, `${this.url}/object/sign/${_path}`, Object.assign({ expiresIn }, ((options === null || options === void 0 ? void 0 : options.transform) ? { transform: options.transform } : {})), { headers: this.headers });\n                const downloadQueryParam = (options === null || options === void 0 ? void 0 : options.download)\n                    ? `&download=${options.download === true ? '' : options.download}`\n                    : '';\n                const signedUrl = encodeURI(`${this.url}${data.signedURL}${downloadQueryParam}`);\n                data = { signedUrl };\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates multiple signed URLs. Use a signed URL to share a file for a fixed amount of time.\n     *\n     * @category File Buckets\n     * @param paths The file paths to be downloaded, including the current file names. For example `['folder/image.png', 'folder2/image2.png']`.\n     * @param expiresIn The number of seconds until the signed URLs expire. For example, `60` for URLs which are valid for one minute.\n     * @param options.download triggers the file as a download if set to true. Set this parameter as the name of the file if you want to trigger the download with a different filename.\n     * @returns Promise with response containing array of objects with signedUrl, path, and error or error\n     *\n     * @example Create Signed URLs\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .createSignedUrls(['folder/avatar1.png', 'folder/avatar2.png'], 60)\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": [\n     *     {\n     *       \"error\": null,\n     *       \"path\": \"folder/avatar1.png\",\n     *       \"signedURL\": \"/object/sign/avatars/folder/avatar1.png?token=<TOKEN>\",\n     *       \"signedUrl\": \"https://example.supabase.co/storage/v1/object/sign/avatars/folder/avatar1.png?token=<TOKEN>\"\n     *     },\n     *     {\n     *       \"error\": null,\n     *       \"path\": \"folder/avatar2.png\",\n     *       \"signedURL\": \"/object/sign/avatars/folder/avatar2.png?token=<TOKEN>\",\n     *       \"signedUrl\": \"https://example.supabase.co/storage/v1/object/sign/avatars/folder/avatar2.png?token=<TOKEN>\"\n     *     }\n     *   ],\n     *   \"error\": null\n     * }\n     * ```\n     */\n    createSignedUrls(paths, expiresIn, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/object/sign/${this.bucketId}`, { expiresIn, paths }, { headers: this.headers });\n                const downloadQueryParam = (options === null || options === void 0 ? void 0 : options.download)\n                    ? `&download=${options.download === true ? '' : options.download}`\n                    : '';\n                return {\n                    data: data.map((datum) => (Object.assign(Object.assign({}, datum), { signedUrl: datum.signedURL\n                            ? encodeURI(`${this.url}${datum.signedURL}${downloadQueryParam}`)\n                            : null }))),\n                    error: null,\n                };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Downloads a file from a private bucket. For public buckets, make a request to the URL returned from `getPublicUrl` instead.\n     *\n     * @category File Buckets\n     * @param path The full path and file name of the file to be downloaded. For example `folder/image.png`.\n     * @param options.transform Transform the asset before serving it to the client.\n     * @returns BlobDownloadBuilder instance for downloading the file\n     *\n     * @example Download file\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .download('folder/avatar1.png')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": <BLOB>,\n     *   \"error\": null\n     * }\n     * ```\n     *\n     * @example Download file with transformations\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .download('folder/avatar1.png', {\n     *     transform: {\n     *       width: 100,\n     *       height: 100,\n     *       quality: 80\n     *     }\n     *   })\n     * ```\n     */\n    download(path, options) {\n        const wantsTransformation = typeof (options === null || options === void 0 ? void 0 : options.transform) !== 'undefined';\n        const renderPath = wantsTransformation ? 'render/image/authenticated' : 'object';\n        const transformationQuery = this.transformOptsToQueryString((options === null || options === void 0 ? void 0 : options.transform) || {});\n        const queryString = transformationQuery ? `?${transformationQuery}` : '';\n        const _path = this._getFinalPath(path);\n        const downloadFn = () => get(this.fetch, `${this.url}/${renderPath}/${_path}${queryString}`, {\n            headers: this.headers,\n            noResolveJson: true,\n        });\n        return new BlobDownloadBuilder(downloadFn, this.shouldThrowOnError);\n    }\n    /**\n     * Retrieves the details of an existing file.\n     *\n     * @category File Buckets\n     * @param path The file path, including the file name. For example `folder/image.png`.\n     * @returns Promise with response containing file metadata or error\n     *\n     * @example Get file info\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .info('folder/avatar1.png')\n     * ```\n     */\n    info(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const _path = this._getFinalPath(path);\n            try {\n                const data = yield get(this.fetch, `${this.url}/object/info/${_path}`, {\n                    headers: this.headers,\n                });\n                return { data: recursiveToCamel(data), error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Checks the existence of a file.\n     *\n     * @category File Buckets\n     * @param path The file path, including the file name. For example `folder/image.png`.\n     * @returns Promise with response containing boolean indicating file existence or error\n     *\n     * @example Check file existence\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .exists('folder/avatar1.png')\n     * ```\n     */\n    exists(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const _path = this._getFinalPath(path);\n            try {\n                yield head(this.fetch, `${this.url}/object/${_path}`, {\n                    headers: this.headers,\n                });\n                return { data: true, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error) && error instanceof StorageUnknownError) {\n                    const originalError = error.originalError;\n                    if ([400, 404].includes(originalError === null || originalError === void 0 ? void 0 : originalError.status)) {\n                        return { data: false, error };\n                    }\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * A simple convenience function to get the URL for an asset in a public bucket. If you do not want to use this function, you can construct the public URL by concatenating the bucket URL with the path to the asset.\n     * This function does not verify if the bucket is public. If a public URL is created for a bucket which is not public, you will not be able to download the asset.\n     *\n     * @category File Buckets\n     * @param path The path and name of the file to generate the public URL for. For example `folder/image.png`.\n     * @param options.download Triggers the file as a download if set to true. Set this parameter as the name of the file if you want to trigger the download with a different filename.\n     * @param options.transform Transform the asset before serving it to the client.\n     * @returns Object with public URL\n     *\n     * @example Returns the URL for an asset in a public bucket\n     * ```js\n     * const { data } = supabase\n     *   .storage\n     *   .from('public-bucket')\n     *   .getPublicUrl('folder/avatar1.png')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"publicUrl\": \"https://example.supabase.co/storage/v1/object/public/public-bucket/folder/avatar1.png\"\n     *   }\n     * }\n     * ```\n     *\n     * @example Returns the URL for an asset in a public bucket with transformations\n     * ```js\n     * const { data } = supabase\n     *   .storage\n     *   .from('public-bucket')\n     *   .getPublicUrl('folder/avatar1.png', {\n     *     transform: {\n     *       width: 100,\n     *       height: 100,\n     *     }\n     *   })\n     * ```\n     *\n     * @example Returns the URL which triggers the download of an asset in a public bucket\n     * ```js\n     * const { data } = supabase\n     *   .storage\n     *   .from('public-bucket')\n     *   .getPublicUrl('folder/avatar1.png', {\n     *     download: true,\n     *   })\n     * ```\n     */\n    getPublicUrl(path, options) {\n        const _path = this._getFinalPath(path);\n        const _queryString = [];\n        const downloadQueryParam = (options === null || options === void 0 ? void 0 : options.download)\n            ? `download=${options.download === true ? '' : options.download}`\n            : '';\n        if (downloadQueryParam !== '') {\n            _queryString.push(downloadQueryParam);\n        }\n        const wantsTransformation = typeof (options === null || options === void 0 ? void 0 : options.transform) !== 'undefined';\n        const renderPath = wantsTransformation ? 'render/image' : 'object';\n        const transformationQuery = this.transformOptsToQueryString((options === null || options === void 0 ? void 0 : options.transform) || {});\n        if (transformationQuery !== '') {\n            _queryString.push(transformationQuery);\n        }\n        let queryString = _queryString.join('&');\n        if (queryString !== '') {\n            queryString = `?${queryString}`;\n        }\n        return {\n            data: { publicUrl: encodeURI(`${this.url}/${renderPath}/public/${_path}${queryString}`) },\n        };\n    }\n    /**\n     * Deletes files within the same bucket\n     *\n     * @category File Buckets\n     * @param paths An array of files to delete, including the path and file name. For example [`'folder/image.png'`].\n     * @returns Promise with response containing array of deleted file objects or error\n     *\n     * @example Delete file\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .remove(['folder/avatar1.png'])\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": [],\n     *   \"error\": null\n     * }\n     * ```\n     */\n    remove(paths) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield remove(this.fetch, `${this.url}/object/${this.bucketId}`, { prefixes: paths }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Get file metadata\n     * @param id the file id to retrieve metadata\n     */\n    // async getMetadata(\n    //   id: string\n    // ): Promise<\n    //   | {\n    //       data: Metadata\n    //       error: null\n    //     }\n    //   | {\n    //       data: null\n    //       error: StorageError\n    //     }\n    // > {\n    //   try {\n    //     const data = await get(this.fetch, `${this.url}/metadata/${id}`, { headers: this.headers })\n    //     return { data, error: null }\n    //   } catch (error) {\n    //     if (isStorageError(error)) {\n    //       return { data: null, error }\n    //     }\n    //     throw error\n    //   }\n    // }\n    /**\n     * Update file metadata\n     * @param id the file id to update metadata\n     * @param meta the new file metadata\n     */\n    // async updateMetadata(\n    //   id: string,\n    //   meta: Metadata\n    // ): Promise<\n    //   | {\n    //       data: Metadata\n    //       error: null\n    //     }\n    //   | {\n    //       data: null\n    //       error: StorageError\n    //     }\n    // > {\n    //   try {\n    //     const data = await post(\n    //       this.fetch,\n    //       `${this.url}/metadata/${id}`,\n    //       { ...meta },\n    //       { headers: this.headers }\n    //     )\n    //     return { data, error: null }\n    //   } catch (error) {\n    //     if (isStorageError(error)) {\n    //       return { data: null, error }\n    //     }\n    //     throw error\n    //   }\n    // }\n    /**\n     * Lists all the files and folders within a path of the bucket.\n     *\n     * @category File Buckets\n     * @param path The folder path.\n     * @param options Search options including limit (defaults to 100), offset, sortBy, and search\n     * @param parameters Optional fetch parameters including signal for cancellation\n     * @returns Promise with response containing array of files or error\n     *\n     * @example List files in a bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .list('folder', {\n     *     limit: 100,\n     *     offset: 0,\n     *     sortBy: { column: 'name', order: 'asc' },\n     *   })\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": [\n     *     {\n     *       \"name\": \"avatar1.png\",\n     *       \"id\": \"e668cf7f-821b-4a2f-9dce-7dfa5dd1cfd2\",\n     *       \"updated_at\": \"2024-05-22T23:06:05.580Z\",\n     *       \"created_at\": \"2024-05-22T23:04:34.443Z\",\n     *       \"last_accessed_at\": \"2024-05-22T23:04:34.443Z\",\n     *       \"metadata\": {\n     *         \"eTag\": \"\\\"c5e8c553235d9af30ef4f6e280790b92\\\"\",\n     *         \"size\": 32175,\n     *         \"mimetype\": \"image/png\",\n     *         \"cacheControl\": \"max-age=3600\",\n     *         \"lastModified\": \"2024-05-22T23:06:05.574Z\",\n     *         \"contentLength\": 32175,\n     *         \"httpStatusCode\": 200\n     *       }\n     *     }\n     *   ],\n     *   \"error\": null\n     * }\n     * ```\n     *\n     * @example Search files in a bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .from('avatars')\n     *   .list('folder', {\n     *     limit: 100,\n     *     offset: 0,\n     *     sortBy: { column: 'name', order: 'asc' },\n     *     search: 'jon'\n     *   })\n     * ```\n     */\n    list(path, options, parameters) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const body = Object.assign(Object.assign(Object.assign({}, DEFAULT_SEARCH_OPTIONS), options), { prefix: path || '' });\n                const data = yield post(this.fetch, `${this.url}/object/list/${this.bucketId}`, body, { headers: this.headers }, parameters);\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * @experimental this method signature might change in the future\n     *\n     * @category File Buckets\n     * @param options search options\n     * @param parameters\n     */\n    listV2(options, parameters) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const body = Object.assign({}, options);\n                const data = yield post(this.fetch, `${this.url}/object/list-v2/${this.bucketId}`, body, { headers: this.headers }, parameters);\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    encodeMetadata(metadata) {\n        return JSON.stringify(metadata);\n    }\n    toBase64(data) {\n        if (typeof Buffer !== 'undefined') {\n            return Buffer.from(data).toString('base64');\n        }\n        return btoa(data);\n    }\n    _getFinalPath(path) {\n        return `${this.bucketId}/${path.replace(/^\\/+/, '')}`;\n    }\n    _removeEmptyFolders(path) {\n        return path.replace(/^\\/|\\/$/g, '').replace(/\\/+/g, '/');\n    }\n    transformOptsToQueryString(transform) {\n        const params = [];\n        if (transform.width) {\n            params.push(`width=${transform.width}`);\n        }\n        if (transform.height) {\n            params.push(`height=${transform.height}`);\n        }\n        if (transform.resize) {\n            params.push(`resize=${transform.resize}`);\n        }\n        if (transform.format) {\n            params.push(`format=${transform.format}`);\n        }\n        if (transform.quality) {\n            params.push(`quality=${transform.quality}`);\n        }\n        return params.join('&');\n    }\n}\n//# sourceMappingURL=StorageFileApi.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.86.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\nexport const DEFAULT_HEADERS = {\n    'X-Client-Info': `storage-js/${version}`,\n};\n//# sourceMappingURL=constants.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from '../lib/constants';\nimport { isStorageError } from '../lib/errors';\nimport { get, post, put, remove } from '../lib/fetch';\nimport { resolveFetch } from '../lib/helpers';\nexport default class StorageBucketApi {\n    constructor(url, headers = {}, fetch, opts) {\n        this.shouldThrowOnError = false;\n        const baseUrl = new URL(url);\n        // if legacy uri is used, replace with new storage host (disables request buffering to allow > 50GB uploads)\n        // \"project-ref.supabase.co\" becomes \"project-ref.storage.supabase.co\"\n        if (opts === null || opts === void 0 ? void 0 : opts.useNewHostname) {\n            const isSupabaseHost = /supabase\\.(co|in|red)$/.test(baseUrl.hostname);\n            if (isSupabaseHost && !baseUrl.hostname.includes('storage.supabase.')) {\n                baseUrl.hostname = baseUrl.hostname.replace('supabase.', 'storage.supabase.');\n            }\n        }\n        this.url = baseUrl.href.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * Enable throwing errors instead of returning them.\n     *\n     * @category File Buckets\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * Retrieves the details of all Storage buckets within an existing project.\n     *\n     * @category File Buckets\n     * @param options Query parameters for listing buckets\n     * @param options.limit Maximum number of buckets to return\n     * @param options.offset Number of buckets to skip\n     * @param options.sortColumn Column to sort by ('id', 'name', 'created_at', 'updated_at')\n     * @param options.sortOrder Sort order ('asc' or 'desc')\n     * @param options.search Search term to filter bucket names\n     * @returns Promise with response containing array of buckets or error\n     *\n     * @example List buckets\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .listBuckets()\n     * ```\n     *\n     * @example List buckets with options\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .listBuckets({\n     *     limit: 10,\n     *     offset: 0,\n     *     sortColumn: 'created_at',\n     *     sortOrder: 'desc',\n     *     search: 'prod'\n     *   })\n     * ```\n     */\n    listBuckets(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const queryString = this.listBucketOptionsToQueryString(options);\n                const data = yield get(this.fetch, `${this.url}/bucket${queryString}`, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Retrieves the details of an existing Storage bucket.\n     *\n     * @category File Buckets\n     * @param id The unique identifier of the bucket you would like to retrieve.\n     * @returns Promise with response containing bucket details or error\n     *\n     * @example Get bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .getBucket('avatars')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"id\": \"avatars\",\n     *     \"name\": \"avatars\",\n     *     \"owner\": \"\",\n     *     \"public\": false,\n     *     \"file_size_limit\": 1024,\n     *     \"allowed_mime_types\": [\n     *       \"image/png\"\n     *     ],\n     *     \"created_at\": \"2024-05-22T22:26:05.100Z\",\n     *     \"updated_at\": \"2024-05-22T22:26:05.100Z\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    getBucket(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield get(this.fetch, `${this.url}/bucket/${id}`, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Creates a new Storage bucket\n     *\n     * @category File Buckets\n     * @param id A unique identifier for the bucket you are creating.\n     * @param options.public The visibility of the bucket. Public buckets don't require an authorization token to download objects, but still require a valid token for all other operations. By default, buckets are private.\n     * @param options.fileSizeLimit specifies the max file size in bytes that can be uploaded to this bucket.\n     * The global file size limit takes precedence over this value.\n     * The default value is null, which doesn't set a per bucket file size limit.\n     * @param options.allowedMimeTypes specifies the allowed mime types that this bucket can accept during upload.\n     * The default value is null, which allows files with all mime types to be uploaded.\n     * Each mime type specified can be a wildcard, e.g. image/*, or a specific mime type, e.g. image/png.\n     * @param options.type (private-beta) specifies the bucket type. see `BucketType` for more details.\n     *   - default bucket type is `STANDARD`\n     * @returns Promise with response containing newly created bucket name or error\n     *\n     * @example Create bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .createBucket('avatars', {\n     *     public: false,\n     *     allowedMimeTypes: ['image/png'],\n     *     fileSizeLimit: 1024\n     *   })\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"name\": \"avatars\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    createBucket(id_1) {\n        return __awaiter(this, arguments, void 0, function* (id, options = {\n            public: false,\n        }) {\n            try {\n                const data = yield post(this.fetch, `${this.url}/bucket`, {\n                    id,\n                    name: id,\n                    type: options.type,\n                    public: options.public,\n                    file_size_limit: options.fileSizeLimit,\n                    allowed_mime_types: options.allowedMimeTypes,\n                }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Updates a Storage bucket\n     *\n     * @category File Buckets\n     * @param id A unique identifier for the bucket you are updating.\n     * @param options.public The visibility of the bucket. Public buckets don't require an authorization token to download objects, but still require a valid token for all other operations.\n     * @param options.fileSizeLimit specifies the max file size in bytes that can be uploaded to this bucket.\n     * The global file size limit takes precedence over this value.\n     * The default value is null, which doesn't set a per bucket file size limit.\n     * @param options.allowedMimeTypes specifies the allowed mime types that this bucket can accept during upload.\n     * The default value is null, which allows files with all mime types to be uploaded.\n     * Each mime type specified can be a wildcard, e.g. image/*, or a specific mime type, e.g. image/png.\n     * @returns Promise with response containing success message or error\n     *\n     * @example Update bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .updateBucket('avatars', {\n     *     public: false,\n     *     allowedMimeTypes: ['image/png'],\n     *     fileSizeLimit: 1024\n     *   })\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"message\": \"Successfully updated\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    updateBucket(id, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield put(this.fetch, `${this.url}/bucket/${id}`, {\n                    id,\n                    name: id,\n                    public: options.public,\n                    file_size_limit: options.fileSizeLimit,\n                    allowed_mime_types: options.allowedMimeTypes,\n                }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Removes all objects inside a single bucket.\n     *\n     * @category File Buckets\n     * @param id The unique identifier of the bucket you would like to empty.\n     * @returns Promise with success message or error\n     *\n     * @example Empty bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .emptyBucket('avatars')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"message\": \"Successfully emptied\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    emptyBucket(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/bucket/${id}/empty`, {}, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Deletes an existing bucket. A bucket can't be deleted with existing objects inside it.\n     * You must first `empty()` the bucket.\n     *\n     * @category File Buckets\n     * @param id The unique identifier of the bucket you would like to delete.\n     * @returns Promise with success message or error\n     *\n     * @example Delete bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .deleteBucket('avatars')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"message\": \"Successfully deleted\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    deleteBucket(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield remove(this.fetch, `${this.url}/bucket/${id}`, {}, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    listBucketOptionsToQueryString(options) {\n        const params = {};\n        if (options) {\n            if ('limit' in options) {\n                params.limit = String(options.limit);\n            }\n            if ('offset' in options) {\n                params.offset = String(options.offset);\n            }\n            if (options.search) {\n                params.search = options.search;\n            }\n            if (options.sortColumn) {\n                params.sortColumn = options.sortColumn;\n            }\n            if (options.sortOrder) {\n                params.sortOrder = options.sortOrder;\n            }\n        }\n        return Object.keys(params).length > 0 ? '?' + new URLSearchParams(params).toString() : '';\n    }\n}\n//# sourceMappingURL=StorageBucketApi.js.map","// src/errors/IcebergError.ts\nvar IcebergError = class extends Error {\n  constructor(message, opts) {\n    super(message);\n    this.name = \"IcebergError\";\n    this.status = opts.status;\n    this.icebergType = opts.icebergType;\n    this.icebergCode = opts.icebergCode;\n    this.details = opts.details;\n    this.isCommitStateUnknown = opts.icebergType === \"CommitStateUnknownException\" || [500, 502, 504].includes(opts.status) && opts.icebergType?.includes(\"CommitState\") === true;\n  }\n  /**\n   * Returns true if the error is a 404 Not Found error.\n   */\n  isNotFound() {\n    return this.status === 404;\n  }\n  /**\n   * Returns true if the error is a 409 Conflict error.\n   */\n  isConflict() {\n    return this.status === 409;\n  }\n  /**\n   * Returns true if the error is a 419 Authentication Timeout error.\n   */\n  isAuthenticationTimeout() {\n    return this.status === 419;\n  }\n};\n\n// src/utils/url.ts\nfunction buildUrl(baseUrl, path, query) {\n  const url = new URL(path, baseUrl);\n  if (query) {\n    for (const [key, value] of Object.entries(query)) {\n      if (value !== void 0) {\n        url.searchParams.set(key, value);\n      }\n    }\n  }\n  return url.toString();\n}\n\n// src/http/createFetchClient.ts\nasync function buildAuthHeaders(auth) {\n  if (!auth || auth.type === \"none\") {\n    return {};\n  }\n  if (auth.type === \"bearer\") {\n    return { Authorization: `Bearer ${auth.token}` };\n  }\n  if (auth.type === \"header\") {\n    return { [auth.name]: auth.value };\n  }\n  if (auth.type === \"custom\") {\n    return await auth.getHeaders();\n  }\n  return {};\n}\nfunction createFetchClient(options) {\n  const fetchFn = options.fetchImpl ?? globalThis.fetch;\n  return {\n    async request({\n      method,\n      path,\n      query,\n      body,\n      headers\n    }) {\n      const url = buildUrl(options.baseUrl, path, query);\n      const authHeaders = await buildAuthHeaders(options.auth);\n      const res = await fetchFn(url, {\n        method,\n        headers: {\n          ...body ? { \"Content-Type\": \"application/json\" } : {},\n          ...authHeaders,\n          ...headers\n        },\n        body: body ? JSON.stringify(body) : void 0\n      });\n      const text = await res.text();\n      const isJson = (res.headers.get(\"content-type\") || \"\").includes(\"application/json\");\n      const data = isJson && text ? JSON.parse(text) : text;\n      if (!res.ok) {\n        const errBody = isJson ? data : void 0;\n        const errorDetail = errBody?.error;\n        throw new IcebergError(\n          errorDetail?.message ?? `Request failed with status ${res.status}`,\n          {\n            status: res.status,\n            icebergType: errorDetail?.type,\n            icebergCode: errorDetail?.code,\n            details: errBody\n          }\n        );\n      }\n      return { status: res.status, headers: res.headers, data };\n    }\n  };\n}\n\n// src/catalog/namespaces.ts\nfunction namespaceToPath(namespace) {\n  return namespace.join(\"\u001f\");\n}\nvar NamespaceOperations = class {\n  constructor(client, prefix = \"\") {\n    this.client = client;\n    this.prefix = prefix;\n  }\n  async listNamespaces(parent) {\n    const query = parent ? { parent: namespaceToPath(parent.namespace) } : void 0;\n    const response = await this.client.request({\n      method: \"GET\",\n      path: `${this.prefix}/namespaces`,\n      query\n    });\n    return response.data.namespaces.map((ns) => ({ namespace: ns }));\n  }\n  async createNamespace(id, metadata) {\n    const request = {\n      namespace: id.namespace,\n      properties: metadata?.properties\n    };\n    const response = await this.client.request({\n      method: \"POST\",\n      path: `${this.prefix}/namespaces`,\n      body: request\n    });\n    return response.data;\n  }\n  async dropNamespace(id) {\n    await this.client.request({\n      method: \"DELETE\",\n      path: `${this.prefix}/namespaces/${namespaceToPath(id.namespace)}`\n    });\n  }\n  async loadNamespaceMetadata(id) {\n    const response = await this.client.request({\n      method: \"GET\",\n      path: `${this.prefix}/namespaces/${namespaceToPath(id.namespace)}`\n    });\n    return {\n      properties: response.data.properties\n    };\n  }\n  async namespaceExists(id) {\n    try {\n      await this.client.request({\n        method: \"HEAD\",\n        path: `${this.prefix}/namespaces/${namespaceToPath(id.namespace)}`\n      });\n      return true;\n    } catch (error) {\n      if (error instanceof IcebergError && error.status === 404) {\n        return false;\n      }\n      throw error;\n    }\n  }\n  async createNamespaceIfNotExists(id, metadata) {\n    try {\n      return await this.createNamespace(id, metadata);\n    } catch (error) {\n      if (error instanceof IcebergError && error.status === 409) {\n        return;\n      }\n      throw error;\n    }\n  }\n};\n\n// src/catalog/tables.ts\nfunction namespaceToPath2(namespace) {\n  return namespace.join(\"\u001f\");\n}\nvar TableOperations = class {\n  constructor(client, prefix = \"\", accessDelegation) {\n    this.client = client;\n    this.prefix = prefix;\n    this.accessDelegation = accessDelegation;\n  }\n  async listTables(namespace) {\n    const response = await this.client.request({\n      method: \"GET\",\n      path: `${this.prefix}/namespaces/${namespaceToPath2(namespace.namespace)}/tables`\n    });\n    return response.data.identifiers;\n  }\n  async createTable(namespace, request) {\n    const headers = {};\n    if (this.accessDelegation) {\n      headers[\"X-Iceberg-Access-Delegation\"] = this.accessDelegation;\n    }\n    const response = await this.client.request({\n      method: \"POST\",\n      path: `${this.prefix}/namespaces/${namespaceToPath2(namespace.namespace)}/tables`,\n      body: request,\n      headers\n    });\n    return response.data.metadata;\n  }\n  async updateTable(id, request) {\n    const response = await this.client.request({\n      method: \"POST\",\n      path: `${this.prefix}/namespaces/${namespaceToPath2(id.namespace)}/tables/${id.name}`,\n      body: request\n    });\n    return {\n      \"metadata-location\": response.data[\"metadata-location\"],\n      metadata: response.data.metadata\n    };\n  }\n  async dropTable(id, options) {\n    await this.client.request({\n      method: \"DELETE\",\n      path: `${this.prefix}/namespaces/${namespaceToPath2(id.namespace)}/tables/${id.name}`,\n      query: { purgeRequested: String(options?.purge ?? false) }\n    });\n  }\n  async loadTable(id) {\n    const headers = {};\n    if (this.accessDelegation) {\n      headers[\"X-Iceberg-Access-Delegation\"] = this.accessDelegation;\n    }\n    const response = await this.client.request({\n      method: \"GET\",\n      path: `${this.prefix}/namespaces/${namespaceToPath2(id.namespace)}/tables/${id.name}`,\n      headers\n    });\n    return response.data.metadata;\n  }\n  async tableExists(id) {\n    const headers = {};\n    if (this.accessDelegation) {\n      headers[\"X-Iceberg-Access-Delegation\"] = this.accessDelegation;\n    }\n    try {\n      await this.client.request({\n        method: \"HEAD\",\n        path: `${this.prefix}/namespaces/${namespaceToPath2(id.namespace)}/tables/${id.name}`,\n        headers\n      });\n      return true;\n    } catch (error) {\n      if (error instanceof IcebergError && error.status === 404) {\n        return false;\n      }\n      throw error;\n    }\n  }\n  async createTableIfNotExists(namespace, request) {\n    try {\n      return await this.createTable(namespace, request);\n    } catch (error) {\n      if (error instanceof IcebergError && error.status === 409) {\n        return await this.loadTable({ namespace: namespace.namespace, name: request.name });\n      }\n      throw error;\n    }\n  }\n};\n\n// src/catalog/IcebergRestCatalog.ts\nvar IcebergRestCatalog = class {\n  /**\n   * Creates a new Iceberg REST Catalog client.\n   *\n   * @param options - Configuration options for the catalog client\n   */\n  constructor(options) {\n    let prefix = \"v1\";\n    if (options.catalogName) {\n      prefix += `/${options.catalogName}`;\n    }\n    const baseUrl = options.baseUrl.endsWith(\"/\") ? options.baseUrl : `${options.baseUrl}/`;\n    this.client = createFetchClient({\n      baseUrl,\n      auth: options.auth,\n      fetchImpl: options.fetch\n    });\n    this.accessDelegation = options.accessDelegation?.join(\",\");\n    this.namespaceOps = new NamespaceOperations(this.client, prefix);\n    this.tableOps = new TableOperations(this.client, prefix, this.accessDelegation);\n  }\n  /**\n   * Lists all namespaces in the catalog.\n   *\n   * @param parent - Optional parent namespace to list children under\n   * @returns Array of namespace identifiers\n   *\n   * @example\n   * ```typescript\n   * // List all top-level namespaces\n   * const namespaces = await catalog.listNamespaces();\n   *\n   * // List namespaces under a parent\n   * const children = await catalog.listNamespaces({ namespace: ['analytics'] });\n   * ```\n   */\n  async listNamespaces(parent) {\n    return this.namespaceOps.listNamespaces(parent);\n  }\n  /**\n   * Creates a new namespace in the catalog.\n   *\n   * @param id - Namespace identifier to create\n   * @param metadata - Optional metadata properties for the namespace\n   * @returns Response containing the created namespace and its properties\n   *\n   * @example\n   * ```typescript\n   * const response = await catalog.createNamespace(\n   *   { namespace: ['analytics'] },\n   *   { properties: { owner: 'data-team' } }\n   * );\n   * console.log(response.namespace); // ['analytics']\n   * console.log(response.properties); // { owner: 'data-team', ... }\n   * ```\n   */\n  async createNamespace(id, metadata) {\n    return this.namespaceOps.createNamespace(id, metadata);\n  }\n  /**\n   * Drops a namespace from the catalog.\n   *\n   * The namespace must be empty (contain no tables) before it can be dropped.\n   *\n   * @param id - Namespace identifier to drop\n   *\n   * @example\n   * ```typescript\n   * await catalog.dropNamespace({ namespace: ['analytics'] });\n   * ```\n   */\n  async dropNamespace(id) {\n    await this.namespaceOps.dropNamespace(id);\n  }\n  /**\n   * Loads metadata for a namespace.\n   *\n   * @param id - Namespace identifier to load\n   * @returns Namespace metadata including properties\n   *\n   * @example\n   * ```typescript\n   * const metadata = await catalog.loadNamespaceMetadata({ namespace: ['analytics'] });\n   * console.log(metadata.properties);\n   * ```\n   */\n  async loadNamespaceMetadata(id) {\n    return this.namespaceOps.loadNamespaceMetadata(id);\n  }\n  /**\n   * Lists all tables in a namespace.\n   *\n   * @param namespace - Namespace identifier to list tables from\n   * @returns Array of table identifiers\n   *\n   * @example\n   * ```typescript\n   * const tables = await catalog.listTables({ namespace: ['analytics'] });\n   * console.log(tables); // [{ namespace: ['analytics'], name: 'events' }, ...]\n   * ```\n   */\n  async listTables(namespace) {\n    return this.tableOps.listTables(namespace);\n  }\n  /**\n   * Creates a new table in the catalog.\n   *\n   * @param namespace - Namespace to create the table in\n   * @param request - Table creation request including name, schema, partition spec, etc.\n   * @returns Table metadata for the created table\n   *\n   * @example\n   * ```typescript\n   * const metadata = await catalog.createTable(\n   *   { namespace: ['analytics'] },\n   *   {\n   *     name: 'events',\n   *     schema: {\n   *       type: 'struct',\n   *       fields: [\n   *         { id: 1, name: 'id', type: 'long', required: true },\n   *         { id: 2, name: 'timestamp', type: 'timestamp', required: true }\n   *       ],\n   *       'schema-id': 0\n   *     },\n   *     'partition-spec': {\n   *       'spec-id': 0,\n   *       fields: [\n   *         { source_id: 2, field_id: 1000, name: 'ts_day', transform: 'day' }\n   *       ]\n   *     }\n   *   }\n   * );\n   * ```\n   */\n  async createTable(namespace, request) {\n    return this.tableOps.createTable(namespace, request);\n  }\n  /**\n   * Updates an existing table's metadata.\n   *\n   * Can update the schema, partition spec, or properties of a table.\n   *\n   * @param id - Table identifier to update\n   * @param request - Update request with fields to modify\n   * @returns Response containing the metadata location and updated table metadata\n   *\n   * @example\n   * ```typescript\n   * const response = await catalog.updateTable(\n   *   { namespace: ['analytics'], name: 'events' },\n   *   {\n   *     properties: { 'read.split.target-size': '134217728' }\n   *   }\n   * );\n   * console.log(response['metadata-location']); // s3://...\n   * console.log(response.metadata); // TableMetadata object\n   * ```\n   */\n  async updateTable(id, request) {\n    return this.tableOps.updateTable(id, request);\n  }\n  /**\n   * Drops a table from the catalog.\n   *\n   * @param id - Table identifier to drop\n   *\n   * @example\n   * ```typescript\n   * await catalog.dropTable({ namespace: ['analytics'], name: 'events' });\n   * ```\n   */\n  async dropTable(id, options) {\n    await this.tableOps.dropTable(id, options);\n  }\n  /**\n   * Loads metadata for a table.\n   *\n   * @param id - Table identifier to load\n   * @returns Table metadata including schema, partition spec, location, etc.\n   *\n   * @example\n   * ```typescript\n   * const metadata = await catalog.loadTable({ namespace: ['analytics'], name: 'events' });\n   * console.log(metadata.schema);\n   * console.log(metadata.location);\n   * ```\n   */\n  async loadTable(id) {\n    return this.tableOps.loadTable(id);\n  }\n  /**\n   * Checks if a namespace exists in the catalog.\n   *\n   * @param id - Namespace identifier to check\n   * @returns True if the namespace exists, false otherwise\n   *\n   * @example\n   * ```typescript\n   * const exists = await catalog.namespaceExists({ namespace: ['analytics'] });\n   * console.log(exists); // true or false\n   * ```\n   */\n  async namespaceExists(id) {\n    return this.namespaceOps.namespaceExists(id);\n  }\n  /**\n   * Checks if a table exists in the catalog.\n   *\n   * @param id - Table identifier to check\n   * @returns True if the table exists, false otherwise\n   *\n   * @example\n   * ```typescript\n   * const exists = await catalog.tableExists({ namespace: ['analytics'], name: 'events' });\n   * console.log(exists); // true or false\n   * ```\n   */\n  async tableExists(id) {\n    return this.tableOps.tableExists(id);\n  }\n  /**\n   * Creates a namespace if it does not exist.\n   *\n   * If the namespace already exists, returns void. If created, returns the response.\n   *\n   * @param id - Namespace identifier to create\n   * @param metadata - Optional metadata properties for the namespace\n   * @returns Response containing the created namespace and its properties, or void if it already exists\n   *\n   * @example\n   * ```typescript\n   * const response = await catalog.createNamespaceIfNotExists(\n   *   { namespace: ['analytics'] },\n   *   { properties: { owner: 'data-team' } }\n   * );\n   * if (response) {\n   *   console.log('Created:', response.namespace);\n   * } else {\n   *   console.log('Already exists');\n   * }\n   * ```\n   */\n  async createNamespaceIfNotExists(id, metadata) {\n    return this.namespaceOps.createNamespaceIfNotExists(id, metadata);\n  }\n  /**\n   * Creates a table if it does not exist.\n   *\n   * If the table already exists, returns its metadata instead.\n   *\n   * @param namespace - Namespace to create the table in\n   * @param request - Table creation request including name, schema, partition spec, etc.\n   * @returns Table metadata for the created or existing table\n   *\n   * @example\n   * ```typescript\n   * const metadata = await catalog.createTableIfNotExists(\n   *   { namespace: ['analytics'] },\n   *   {\n   *     name: 'events',\n   *     schema: {\n   *       type: 'struct',\n   *       fields: [\n   *         { id: 1, name: 'id', type: 'long', required: true },\n   *         { id: 2, name: 'timestamp', type: 'timestamp', required: true }\n   *       ],\n   *       'schema-id': 0\n   *     }\n   *   }\n   * );\n   * ```\n   */\n  async createTableIfNotExists(namespace, request) {\n    return this.tableOps.createTableIfNotExists(namespace, request);\n  }\n};\n\n// src/catalog/types.ts\nfunction getCurrentSchema(metadata) {\n  return metadata.schemas.find((s) => s[\"schema-id\"] === metadata[\"current-schema-id\"]);\n}\n\nexport { IcebergError, IcebergRestCatalog, getCurrentSchema };\n//# sourceMappingURL=index.mjs.map\n//# sourceMappingURL=index.mjs.map","import { __awaiter } from \"tslib\";\nimport { IcebergRestCatalog } from 'iceberg-js';\nimport { DEFAULT_HEADERS } from '../lib/constants';\nimport { isStorageError, StorageError } from '../lib/errors';\nimport { get, post, remove } from '../lib/fetch';\nimport { isValidBucketName, resolveFetch } from '../lib/helpers';\n/**\n * Client class for managing Analytics Buckets using Iceberg tables\n * Provides methods for creating, listing, and deleting analytics buckets\n */\nexport default class StorageAnalyticsClient {\n    /**\n     * @alpha\n     *\n     * Creates a new StorageAnalyticsClient instance\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @param url - The base URL for the storage API\n     * @param headers - HTTP headers to include in requests\n     * @param fetch - Optional custom fetch implementation\n     *\n     * @example\n     * ```typescript\n     * const client = new StorageAnalyticsClient(url, headers)\n     * ```\n     */\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /**\n     * @alpha\n     *\n     * Enable throwing errors instead of returning them in the response\n     * When enabled, failed operations will throw instead of returning { data: null, error }\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @returns This instance for method chaining\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /**\n     * @alpha\n     *\n     * Creates a new analytics bucket using Iceberg tables\n     * Analytics buckets are optimized for analytical queries and data processing\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @param name A unique name for the bucket you are creating\n     * @returns Promise with response containing newly created analytics bucket or error\n     *\n     * @example Create analytics bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .analytics\n     *   .createBucket('analytics-data')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"name\": \"analytics-data\",\n     *     \"type\": \"ANALYTICS\",\n     *     \"format\": \"iceberg\",\n     *     \"created_at\": \"2024-05-22T22:26:05.100Z\",\n     *     \"updated_at\": \"2024-05-22T22:26:05.100Z\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    createBucket(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/bucket`, { name }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * @alpha\n     *\n     * Retrieves the details of all Analytics Storage buckets within an existing project\n     * Only returns buckets of type 'ANALYTICS'\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @param options Query parameters for listing buckets\n     * @param options.limit Maximum number of buckets to return\n     * @param options.offset Number of buckets to skip\n     * @param options.sortColumn Column to sort by ('name', 'created_at', 'updated_at')\n     * @param options.sortOrder Sort order ('asc' or 'desc')\n     * @param options.search Search term to filter bucket names\n     * @returns Promise with response containing array of analytics buckets or error\n     *\n     * @example List analytics buckets\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .analytics\n     *   .listBuckets({\n     *     limit: 10,\n     *     offset: 0,\n     *     sortColumn: 'created_at',\n     *     sortOrder: 'desc'\n     *   })\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": [\n     *     {\n     *       \"name\": \"analytics-data\",\n     *       \"type\": \"ANALYTICS\",\n     *       \"format\": \"iceberg\",\n     *       \"created_at\": \"2024-05-22T22:26:05.100Z\",\n     *       \"updated_at\": \"2024-05-22T22:26:05.100Z\"\n     *     }\n     *   ],\n     *   \"error\": null\n     * }\n     * ```\n     */\n    listBuckets(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Build query string from options\n                const queryParams = new URLSearchParams();\n                if ((options === null || options === void 0 ? void 0 : options.limit) !== undefined)\n                    queryParams.set('limit', options.limit.toString());\n                if ((options === null || options === void 0 ? void 0 : options.offset) !== undefined)\n                    queryParams.set('offset', options.offset.toString());\n                if (options === null || options === void 0 ? void 0 : options.sortColumn)\n                    queryParams.set('sortColumn', options.sortColumn);\n                if (options === null || options === void 0 ? void 0 : options.sortOrder)\n                    queryParams.set('sortOrder', options.sortOrder);\n                if (options === null || options === void 0 ? void 0 : options.search)\n                    queryParams.set('search', options.search);\n                const queryString = queryParams.toString();\n                const url = queryString ? `${this.url}/bucket?${queryString}` : `${this.url}/bucket`;\n                const data = yield get(this.fetch, url, { headers: this.headers });\n                return { data: data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * @alpha\n     *\n     * Deletes an existing analytics bucket\n     * A bucket can't be deleted with existing objects inside it\n     * You must first empty the bucket before deletion\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @param bucketName The unique identifier of the bucket you would like to delete\n     * @returns Promise with response containing success message or error\n     *\n     * @example Delete analytics bucket\n     * ```js\n     * const { data, error } = await supabase\n     *   .storage\n     *   .analytics\n     *   .deleteBucket('analytics-data')\n     * ```\n     *\n     * Response:\n     * ```json\n     * {\n     *   \"data\": {\n     *     \"message\": \"Successfully deleted\"\n     *   },\n     *   \"error\": null\n     * }\n     * ```\n     */\n    deleteBucket(bucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield remove(this.fetch, `${this.url}/bucket/${bucketName}`, {}, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * @alpha\n     *\n     * Get an Iceberg REST Catalog client configured for a specific analytics bucket\n     * Use this to perform advanced table and namespace operations within the bucket\n     * The returned client provides full access to the Apache Iceberg REST Catalog API\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @param bucketName - The name of the analytics bucket (warehouse) to connect to\n     * @returns Configured IcebergRestCatalog instance for advanced Iceberg operations\n     *\n     * @example Get catalog and create table\n     * ```js\n     * // First, create an analytics bucket\n     * const { data: bucket, error: bucketError } = await supabase\n     *   .storage\n     *   .analytics\n     *   .createBucket('analytics-data')\n     *\n     * // Get the Iceberg catalog for that bucket\n     * const catalog = supabase.storage.analytics.from('analytics-data')\n     *\n     * // Create a namespace\n     * await catalog.createNamespace({ namespace: ['default'] })\n     *\n     * // Create a table with schema\n     * await catalog.createTable(\n     *   { namespace: ['default'] },\n     *   {\n     *     name: 'events',\n     *     schema: {\n     *       type: 'struct',\n     *       fields: [\n     *         { id: 1, name: 'id', type: 'long', required: true },\n     *         { id: 2, name: 'timestamp', type: 'timestamp', required: true },\n     *         { id: 3, name: 'user_id', type: 'string', required: false }\n     *       ],\n     *       'schema-id': 0,\n     *       'identifier-field-ids': [1]\n     *     },\n     *     'partition-spec': {\n     *       'spec-id': 0,\n     *       fields: []\n     *     },\n     *     'write-order': {\n     *       'order-id': 0,\n     *       fields: []\n     *     },\n     *     properties: {\n     *       'write.format.default': 'parquet'\n     *     }\n     *   }\n     * )\n     * ```\n     *\n     * @example List tables in namespace\n     * ```js\n     * const catalog = supabase.storage.analytics.from('analytics-data')\n     *\n     * // List all tables in the default namespace\n     * const tables = await catalog.listTables({ namespace: ['default'] })\n     * console.log(tables) // [{ namespace: ['default'], name: 'events' }]\n     * ```\n     *\n     * @example Working with namespaces\n     * ```js\n     * const catalog = supabase.storage.analytics.from('analytics-data')\n     *\n     * // List all namespaces\n     * const namespaces = await catalog.listNamespaces()\n     *\n     * // Create namespace with properties\n     * await catalog.createNamespace(\n     *   { namespace: ['production'] },\n     *   { properties: { owner: 'data-team', env: 'prod' } }\n     * )\n     * ```\n     *\n     * @example Cleanup operations\n     * ```js\n     * const catalog = supabase.storage.analytics.from('analytics-data')\n     *\n     * // Drop table with purge option (removes all data)\n     * await catalog.dropTable(\n     *   { namespace: ['default'], name: 'events' },\n     *   { purge: true }\n     * )\n     *\n     * // Drop namespace (must be empty)\n     * await catalog.dropNamespace({ namespace: ['default'] })\n     * ```\n     *\n     * @example Error handling with catalog operations\n     * ```js\n     * import { IcebergError } from 'iceberg-js'\n     *\n     * const catalog = supabase.storage.analytics.from('analytics-data')\n     *\n     * try {\n     *   await catalog.dropTable({ namespace: ['default'], name: 'events' }, { purge: true })\n     * } catch (error) {\n     *   // Handle 404 errors (resource not found)\n     *   const is404 =\n     *     (error instanceof IcebergError && error.status === 404) ||\n     *     error?.status === 404 ||\n     *     error?.details?.error?.code === 404\n     *\n     *   if (is404) {\n     *     console.log('Table does not exist')\n     *   } else {\n     *     throw error // Re-throw other errors\n     *   }\n     * }\n     * ```\n     *\n     * @remarks\n     * This method provides a bridge between Supabase's bucket management and the standard\n     * Apache Iceberg REST Catalog API. The bucket name maps to the Iceberg warehouse parameter.\n     * All authentication and configuration is handled automatically using your Supabase credentials.\n     *\n     * **Error Handling**: Operations may throw `IcebergError` from the iceberg-js library.\n     * Always handle 404 errors gracefully when checking for resource existence.\n     *\n     * **Cleanup Operations**: When using `dropTable`, the `purge: true` option permanently\n     * deletes all table data. Without it, the table is marked as deleted but data remains.\n     *\n     * **Library Dependency**: The returned catalog is an instance of `IcebergRestCatalog`\n     * from iceberg-js. For complete API documentation and advanced usage, refer to the\n     * [iceberg-js documentation](https://supabase.github.io/iceberg-js/).\n     *\n     * For advanced Iceberg operations beyond bucket management, you can also install and use\n     * the `iceberg-js` package directly with manual configuration.\n     */\n    from(bucketName) {\n        // Validate bucket name using same rules as Supabase Storage API backend\n        if (!isValidBucketName(bucketName)) {\n            throw new StorageError('Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines ' +\n                'and should avoid the use of any other characters.');\n        }\n        // Construct the Iceberg REST Catalog URL\n        // The base URL is /storage/v1/iceberg\n        // Note: IcebergRestCatalog from iceberg-js automatically adds /v1/ prefix to API paths\n        // so we should NOT append /v1 here (it would cause double /v1/v1/ in the URL)\n        return new IcebergRestCatalog({\n            baseUrl: this.url,\n            catalogName: bucketName, // Maps to the warehouse parameter in Supabase's implementation\n            auth: {\n                type: 'custom',\n                getHeaders: () => __awaiter(this, void 0, void 0, function* () { return this.headers; }),\n            },\n            fetch: this.fetch,\n        });\n    }\n}\n//# sourceMappingURL=StorageAnalyticsClient.js.map","import { version } from '../version';\nexport const DEFAULT_HEADERS = {\n    'X-Client-Info': `storage-js/${version}`,\n    'Content-Type': 'application/json',\n};\n//# sourceMappingURL=constants.js.map","/**\n * Base error class for all Storage Vectors errors\n */\nexport class StorageVectorsError extends Error {\n    constructor(message) {\n        super(message);\n        this.__isStorageVectorsError = true;\n        this.name = 'StorageVectorsError';\n    }\n}\n/**\n * Type guard to check if an error is a StorageVectorsError\n * @param error - The error to check\n * @returns True if the error is a StorageVectorsError\n */\nexport function isStorageVectorsError(error) {\n    return typeof error === 'object' && error !== null && '__isStorageVectorsError' in error;\n}\n/**\n * API error returned from S3 Vectors service\n * Includes HTTP status code and service-specific error code\n */\nexport class StorageVectorsApiError extends StorageVectorsError {\n    constructor(message, status, statusCode) {\n        super(message);\n        this.name = 'StorageVectorsApiError';\n        this.status = status;\n        this.statusCode = statusCode;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            statusCode: this.statusCode,\n        };\n    }\n}\n/**\n * Unknown error that doesn't match expected error patterns\n * Wraps the original error for debugging\n */\nexport class StorageVectorsUnknownError extends StorageVectorsError {\n    constructor(message, originalError) {\n        super(message);\n        this.name = 'StorageVectorsUnknownError';\n        this.originalError = originalError;\n    }\n}\n/**\n * Error codes specific to S3 Vectors API\n * Maps AWS service errors to application-friendly error codes\n */\nexport var StorageVectorsErrorCode;\n(function (StorageVectorsErrorCode) {\n    /** Internal server fault (HTTP 500) */\n    StorageVectorsErrorCode[\"InternalError\"] = \"InternalError\";\n    /** Resource already exists / conflict (HTTP 409) */\n    StorageVectorsErrorCode[\"S3VectorConflictException\"] = \"S3VectorConflictException\";\n    /** Resource not found (HTTP 404) */\n    StorageVectorsErrorCode[\"S3VectorNotFoundException\"] = \"S3VectorNotFoundException\";\n    /** Delete bucket while not empty (HTTP 400) */\n    StorageVectorsErrorCode[\"S3VectorBucketNotEmpty\"] = \"S3VectorBucketNotEmpty\";\n    /** Exceeds bucket quota/limit (HTTP 400) */\n    StorageVectorsErrorCode[\"S3VectorMaxBucketsExceeded\"] = \"S3VectorMaxBucketsExceeded\";\n    /** Exceeds index quota/limit (HTTP 400) */\n    StorageVectorsErrorCode[\"S3VectorMaxIndexesExceeded\"] = \"S3VectorMaxIndexesExceeded\";\n})(StorageVectorsErrorCode || (StorageVectorsErrorCode = {}));\n//# sourceMappingURL=errors.js.map","/**\n * Resolves the fetch implementation to use\n * Uses custom fetch if provided, otherwise uses native fetch\n *\n * @param customFetch - Optional custom fetch implementation\n * @returns Resolved fetch function\n */\nexport const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\n/**\n * Resolves the Response constructor to use\n * Returns native Response constructor\n *\n * @returns Response constructor\n */\nexport const resolveResponse = () => {\n    return Response;\n};\n/**\n * Determine if input is a plain object\n * An object is plain if it's created by either {}, new Object(), or Object.create(null)\n *\n * @param value - Value to check\n * @returns True if value is a plain object\n * @source https://github.com/sindresorhus/is-plain-obj\n */\nexport const isPlainObject = (value) => {\n    if (typeof value !== 'object' || value === null) {\n        return false;\n    }\n    const prototype = Object.getPrototypeOf(value);\n    return ((prototype === null ||\n        prototype === Object.prototype ||\n        Object.getPrototypeOf(prototype) === null) &&\n        !(Symbol.toStringTag in value) &&\n        !(Symbol.iterator in value));\n};\n/**\n * Normalizes a number array to float32 format\n * Ensures all vector values are valid 32-bit floats\n *\n * @param values - Array of numbers to normalize\n * @returns Normalized float32 array\n */\nexport const normalizeToFloat32 = (values) => {\n    // Use Float32Array to ensure proper precision\n    return Array.from(new Float32Array(values));\n};\n/**\n * Validates vector dimensions match expected dimension\n * Throws error if dimensions don't match\n *\n * @param vector - Vector data to validate\n * @param expectedDimension - Expected vector dimension\n * @throws Error if dimensions don't match\n */\nexport const validateVectorDimension = (vector, expectedDimension) => {\n    if (expectedDimension !== undefined && vector.float32.length !== expectedDimension) {\n        throw new Error(`Vector dimension mismatch: expected ${expectedDimension}, got ${vector.float32.length}`);\n    }\n};\n//# sourceMappingURL=helpers.js.map","import { __awaiter } from \"tslib\";\nimport { StorageVectorsApiError, StorageVectorsUnknownError } from './errors';\nimport { isPlainObject } from './helpers';\n/**\n * Extracts error message from various error response formats\n * @param err - Error object from API\n * @returns Human-readable error message\n */\nconst _getErrorMessage = (err) => err.msg || err.message || err.error_description || err.error || JSON.stringify(err);\n/**\n * Handles fetch errors and converts them to StorageVectors error types\n * @param error - The error caught from fetch\n * @param reject - Promise rejection function\n * @param options - Fetch options that may affect error handling\n */\nconst handleError = (error, reject, options) => __awaiter(void 0, void 0, void 0, function* () {\n    // Check if error is a Response-like object (has status and ok properties)\n    // This is more reliable than instanceof which can fail across realms\n    const isResponseLike = error &&\n        typeof error === 'object' &&\n        'status' in error &&\n        'ok' in error &&\n        typeof error.status === 'number';\n    if (isResponseLike && !(options === null || options === void 0 ? void 0 : options.noResolveJson)) {\n        const status = error.status || 500;\n        const responseError = error;\n        // Try to parse JSON body if available\n        if (typeof responseError.json === 'function') {\n            responseError\n                .json()\n                .then((err) => {\n                const statusCode = (err === null || err === void 0 ? void 0 : err.statusCode) || (err === null || err === void 0 ? void 0 : err.code) || status + '';\n                reject(new StorageVectorsApiError(_getErrorMessage(err), status, statusCode));\n            })\n                .catch(() => {\n                // If JSON parsing fails, create an ApiError with the HTTP status code\n                const statusCode = status + '';\n                const message = responseError.statusText || `HTTP ${status} error`;\n                reject(new StorageVectorsApiError(message, status, statusCode));\n            });\n        }\n        else {\n            // No json() method available, create error from status\n            const statusCode = status + '';\n            const message = responseError.statusText || `HTTP ${status} error`;\n            reject(new StorageVectorsApiError(message, status, statusCode));\n        }\n    }\n    else {\n        reject(new StorageVectorsUnknownError(_getErrorMessage(error), error));\n    }\n});\n/**\n * Builds request parameters for fetch calls\n * @param method - HTTP method\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters like AbortSignal\n * @param body - Request body (will be JSON stringified if plain object)\n * @returns Complete fetch request parameters\n */\nconst _getRequestParams = (method, options, parameters, body) => {\n    const params = { method, headers: (options === null || options === void 0 ? void 0 : options.headers) || {} };\n    if (method === 'GET' || !body) {\n        return params;\n    }\n    if (isPlainObject(body)) {\n        params.headers = Object.assign({ 'Content-Type': 'application/json' }, options === null || options === void 0 ? void 0 : options.headers);\n        params.body = JSON.stringify(body);\n    }\n    else {\n        params.body = body;\n    }\n    return Object.assign(Object.assign({}, params), parameters);\n};\n/**\n * Internal request handler that wraps fetch with error handling\n * @param fetcher - Fetch function to use\n * @param method - HTTP method\n * @param url - Request URL\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @param body - Request body\n * @returns Promise with parsed response or error\n */\nfunction _handleRequest(fetcher, method, url, options, parameters, body) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            fetcher(url, _getRequestParams(method, options, parameters, body))\n                .then((result) => {\n                if (!result.ok)\n                    throw result;\n                if (options === null || options === void 0 ? void 0 : options.noResolveJson)\n                    return result;\n                // Handle empty responses (204, empty body)\n                const contentType = result.headers.get('content-type');\n                if (!contentType || !contentType.includes('application/json')) {\n                    return {};\n                }\n                return result.json();\n            })\n                .then((data) => resolve(data))\n                .catch((error) => handleError(error, reject, options));\n        });\n    });\n}\n/**\n * Performs a GET request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function get(fetcher, url, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'GET', url, options, parameters);\n    });\n}\n/**\n * Performs a POST request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param body - Request body to be JSON stringified\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function post(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'POST', url, options, parameters, body);\n    });\n}\n/**\n * Performs a PUT request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param body - Request body to be JSON stringified\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function put(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'PUT', url, options, parameters, body);\n    });\n}\n/**\n * Performs a DELETE request\n * @param fetcher - Fetch function to use\n * @param url - Request URL\n * @param body - Request body to be JSON stringified\n * @param options - Custom fetch options\n * @param parameters - Additional fetch parameters\n * @returns Promise with parsed response\n */\nexport function remove(fetcher, url, body, options, parameters) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return _handleRequest(fetcher, 'DELETE', url, options, parameters, body);\n    });\n}\n//# sourceMappingURL=fetch.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\n * @hidden\n * Base implementation for vector index operations.\n * Use {@link VectorBucketScope} via `supabase.storage.vectors.from('bucket')` instead.\n */\nexport default class VectorIndexApi {\n    /** Creates a new VectorIndexApi instance */\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /** Enable throwing errors instead of returning them in the response */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /** Creates a new vector index within a bucket */\n    createIndex(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/CreateIndex`, options, {\n                    headers: this.headers,\n                });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Retrieves metadata for a specific vector index */\n    getIndex(vectorBucketName, indexName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/GetIndex`, { vectorBucketName, indexName }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Lists vector indexes within a bucket with optional filtering and pagination */\n    listIndexes(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/ListIndexes`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Deletes a vector index and all its data */\n    deleteIndex(vectorBucketName, indexName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/DeleteIndex`, { vectorBucketName, indexName }, { headers: this.headers });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=VectorIndexApi.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\n * @hidden\n * Base implementation for vector data operations.\n * Use {@link VectorIndexScope} via `supabase.storage.vectors.from('bucket').index('idx')` instead.\n */\nexport default class VectorDataApi {\n    /** Creates a new VectorDataApi instance */\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /** Enable throwing errors instead of returning them in the response */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /** Inserts or updates vectors in batch (1-500 per request) */\n    putVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Validate batch size\n                if (options.vectors.length < 1 || options.vectors.length > 500) {\n                    throw new Error('Vector batch size must be between 1 and 500 items');\n                }\n                const data = yield post(this.fetch, `${this.url}/PutVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Retrieves vectors by their keys in batch */\n    getVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/GetVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Lists vectors in an index with pagination */\n    listVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Validate segment configuration\n                if (options.segmentCount !== undefined) {\n                    if (options.segmentCount < 1 || options.segmentCount > 16) {\n                        throw new Error('segmentCount must be between 1 and 16');\n                    }\n                    if (options.segmentIndex !== undefined) {\n                        if (options.segmentIndex < 0 || options.segmentIndex >= options.segmentCount) {\n                            throw new Error(`segmentIndex must be between 0 and ${options.segmentCount - 1}`);\n                        }\n                    }\n                }\n                const data = yield post(this.fetch, `${this.url}/ListVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Queries for similar vectors using approximate nearest neighbor search */\n    queryVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/QueryVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Deletes vectors by their keys in batch (1-500 per request) */\n    deleteVectors(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // Validate batch size\n                if (options.keys.length < 1 || options.keys.length > 500) {\n                    throw new Error('Keys batch size must be between 1 and 500 items');\n                }\n                const data = yield post(this.fetch, `${this.url}/DeleteVectors`, options, {\n                    headers: this.headers,\n                });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=VectorDataApi.js.map","import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\n * @hidden\n * Base implementation for vector bucket operations.\n * Use {@link StorageVectorsClient} via `supabase.storage.vectors` instead.\n */\nexport default class VectorBucketApi {\n    /** Creates a new VectorBucketApi instance */\n    constructor(url, headers = {}, fetch) {\n        this.shouldThrowOnError = false;\n        this.url = url.replace(/\\/$/, '');\n        this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n        this.fetch = resolveFetch(fetch);\n    }\n    /** Enable throwing errors instead of returning them in the response */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    /** Creates a new vector bucket */\n    createBucket(vectorBucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/CreateVectorBucket`, { vectorBucketName }, { headers: this.headers });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Retrieves metadata for a specific vector bucket */\n    getBucket(vectorBucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/GetVectorBucket`, { vectorBucketName }, { headers: this.headers });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Lists vector buckets with optional filtering and pagination */\n    listBuckets() {\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            try {\n                const data = yield post(this.fetch, `${this.url}/ListVectorBuckets`, options, {\n                    headers: this.headers,\n                });\n                return { data, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n    /** Deletes a vector bucket (must be empty first) */\n    deleteBucket(vectorBucketName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield post(this.fetch, `${this.url}/DeleteVectorBucket`, { vectorBucketName }, { headers: this.headers });\n                return { data: data || {}, error: null };\n            }\n            catch (error) {\n                if (this.shouldThrowOnError) {\n                    throw error;\n                }\n                if (isStorageVectorsError(error)) {\n                    return { data: null, error };\n                }\n                throw error;\n            }\n        });\n    }\n}\n//# sourceMappingURL=VectorBucketApi.js.map","import { __awaiter } from \"tslib\";\nimport VectorIndexApi from './VectorIndexApi';\nimport VectorDataApi from './VectorDataApi';\nimport VectorBucketApi from './VectorBucketApi';\n/**\n *\n * @alpha\n *\n * Main client for interacting with S3 Vectors API\n * Provides access to bucket, index, and vector data operations\n *\n * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n *\n * **Usage Patterns:**\n *\n * ```typescript\n * const { data, error } = await supabase\n *  .storage\n *  .vectors\n *  .createBucket('embeddings-prod')\n *\n * // Access index operations via buckets\n * const bucket = supabase.storage.vectors.from('embeddings-prod')\n * await bucket.createIndex({\n *   indexName: 'documents',\n *   dataType: 'float32',\n *   dimension: 1536,\n *   distanceMetric: 'cosine'\n * })\n *\n * // Access vector operations via index\n * const index = bucket.index('documents')\n * await index.putVectors({\n *   vectors: [\n *     { key: 'doc-1', data: { float32: [...] }, metadata: { title: 'Intro' } }\n *   ]\n * })\n *\n * // Query similar vectors\n * const { data } = await index.queryVectors({\n *   queryVector: { float32: [...] },\n *   topK: 5,\n *   returnDistance: true\n * })\n * ```\n */\nexport class StorageVectorsClient extends VectorBucketApi {\n    /**\n     * @alpha\n     *\n     * Creates a StorageVectorsClient that can manage buckets, indexes, and vectors.\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param url - Base URL of the Storage Vectors REST API.\n     * @param options.headers - Optional headers (for example `Authorization`) applied to every request.\n     * @param options.fetch - Optional custom `fetch` implementation for non-browser runtimes.\n     *\n     * @example\n     * ```typescript\n     * const client = new StorageVectorsClient(url, options)\n     * ```\n     */\n    constructor(url, options = {}) {\n        super(url, options.headers || {}, options.fetch);\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Access operations for a specific vector bucket\n     * Returns a scoped client for index and vector operations within the bucket\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param vectorBucketName - Name of the vector bucket\n     * @returns Bucket-scoped client with index and vector operations\n     *\n     * @example\n     * ```typescript\n     * const bucket = supabase.storage.vectors.from('embeddings-prod')\n     * ```\n     */\n    from(vectorBucketName) {\n        return new VectorBucketScope(this.url, this.headers, vectorBucketName, this.fetch);\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Creates a new vector bucket\n     * Vector buckets are containers for vector indexes and their data\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param vectorBucketName - Unique name for the vector bucket\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await supabase\n     *   .storage\n     *   .vectors\n     *   .createBucket('embeddings-prod')\n     * ```\n     */\n    createBucket(vectorBucketName) {\n        const _super = Object.create(null, {\n            createBucket: { get: () => super.createBucket }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.createBucket.call(this, vectorBucketName);\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Retrieves metadata for a specific vector bucket\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param vectorBucketName - Name of the vector bucket\n     * @returns Promise with bucket metadata or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await supabase\n     *   .storage\n     *   .vectors\n     *   .getBucket('embeddings-prod')\n     *\n     * console.log('Bucket created:', data?.vectorBucket.creationTime)\n     * ```\n     */\n    getBucket(vectorBucketName) {\n        const _super = Object.create(null, {\n            getBucket: { get: () => super.getBucket }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.getBucket.call(this, vectorBucketName);\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Lists all vector buckets with optional filtering and pagination\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Optional filters (prefix, maxResults, nextToken)\n     * @returns Promise with list of buckets or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await supabase\n     *   .storage\n     *   .vectors\n     *   .listBuckets({ prefix: 'embeddings-' })\n     *\n     * data?.vectorBuckets.forEach(bucket => {\n     *   console.log(bucket.vectorBucketName)\n     * })\n     * ```\n     */\n    listBuckets() {\n        const _super = Object.create(null, {\n            listBuckets: { get: () => super.listBuckets }\n        });\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            return _super.listBuckets.call(this, options);\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Deletes a vector bucket (bucket must be empty)\n     * All indexes must be deleted before deleting the bucket\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param vectorBucketName - Name of the vector bucket to delete\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const { data, error } = await supabase\n     *   .storage\n     *   .vectors\n     *   .deleteBucket('embeddings-old')\n     * ```\n     */\n    deleteBucket(vectorBucketName) {\n        const _super = Object.create(null, {\n            deleteBucket: { get: () => super.deleteBucket }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.deleteBucket.call(this, vectorBucketName);\n        });\n    }\n}\n/**\n *\n * @alpha\n *\n * Scoped client for operations within a specific vector bucket\n * Provides index management and access to vector operations\n *\n * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n */\nexport class VectorBucketScope extends VectorIndexApi {\n    /**\n     * @alpha\n     *\n     * Creates a helper that automatically scopes all index operations to the provided bucket.\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @example\n     * ```typescript\n     * const bucket = supabase.storage.vectors.from('embeddings-prod')\n     * ```\n     */\n    constructor(url, headers, vectorBucketName, fetch) {\n        super(url, headers, fetch);\n        this.vectorBucketName = vectorBucketName;\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Creates a new vector index in this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Index configuration (vectorBucketName is automatically set)\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = supabase.storage.vectors.from('embeddings-prod')\n     * await bucket.createIndex({\n     *   indexName: 'documents-openai',\n     *   dataType: 'float32',\n     *   dimension: 1536,\n     *   distanceMetric: 'cosine',\n     *   metadataConfiguration: {\n     *     nonFilterableMetadataKeys: ['raw_text']\n     *   }\n     * })\n     * ```\n     */\n    createIndex(options) {\n        const _super = Object.create(null, {\n            createIndex: { get: () => super.createIndex }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.createIndex.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName }));\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Lists indexes in this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Listing options (vectorBucketName is automatically set)\n     * @returns Promise with response containing indexes array and pagination token or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = supabase.storage.vectors.from('embeddings-prod')\n     * const { data } = await bucket.listIndexes({ prefix: 'documents-' })\n     * ```\n     */\n    listIndexes() {\n        const _super = Object.create(null, {\n            listIndexes: { get: () => super.listIndexes }\n        });\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            return _super.listIndexes.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName }));\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Retrieves metadata for a specific index in this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param indexName - Name of the index to retrieve\n     * @returns Promise with index metadata or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = supabase.storage.vectors.from('embeddings-prod')\n     * const { data } = await bucket.getIndex('documents-openai')\n     * console.log('Dimension:', data?.index.dimension)\n     * ```\n     */\n    getIndex(indexName) {\n        const _super = Object.create(null, {\n            getIndex: { get: () => super.getIndex }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.getIndex.call(this, this.vectorBucketName, indexName);\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Deletes an index from this bucket\n     * Convenience method that automatically includes the bucket name\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param indexName - Name of the index to delete\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const bucket = supabase.storage.vectors.from('embeddings-prod')\n     * await bucket.deleteIndex('old-index')\n     * ```\n     */\n    deleteIndex(indexName) {\n        const _super = Object.create(null, {\n            deleteIndex: { get: () => super.deleteIndex }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.deleteIndex.call(this, this.vectorBucketName, indexName);\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Access operations for a specific index within this bucket\n     * Returns a scoped client for vector data operations\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param indexName - Name of the index\n     * @returns Index-scoped client with vector data operations\n     *\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     *\n     * // Insert vectors\n     * await index.putVectors({\n     *   vectors: [\n     *     { key: 'doc-1', data: { float32: [...] }, metadata: { title: 'Intro' } }\n     *   ]\n     * })\n     *\n     * // Query similar vectors\n     * const { data } = await index.queryVectors({\n     *   queryVector: { float32: [...] },\n     *   topK: 5\n     * })\n     * ```\n     */\n    index(indexName) {\n        return new VectorIndexScope(this.url, this.headers, this.vectorBucketName, indexName, this.fetch);\n    }\n}\n/**\n *\n * @alpha\n *\n * Scoped client for operations within a specific vector index\n * Provides vector data operations (put, get, list, query, delete)\n *\n * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n */\nexport class VectorIndexScope extends VectorDataApi {\n    /**\n     *\n     * @alpha\n     *\n     * Creates a helper that automatically scopes all vector operations to the provided bucket/index names.\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     * ```\n     */\n    constructor(url, headers, vectorBucketName, indexName, fetch) {\n        super(url, headers, fetch);\n        this.vectorBucketName = vectorBucketName;\n        this.indexName = indexName;\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Inserts or updates vectors in this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Vector insertion options (bucket and index names automatically set)\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     * await index.putVectors({\n     *   vectors: [\n     *     {\n     *       key: 'doc-1',\n     *       data: { float32: [0.1, 0.2, ...] },\n     *       metadata: { title: 'Introduction', page: 1 }\n     *     }\n     *   ]\n     * })\n     * ```\n     */\n    putVectors(options) {\n        const _super = Object.create(null, {\n            putVectors: { get: () => super.putVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.putVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Retrieves vectors by keys from this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Vector retrieval options (bucket and index names automatically set)\n     * @returns Promise with response containing vectors array or error\n     *\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     * const { data } = await index.getVectors({\n     *   keys: ['doc-1', 'doc-2'],\n     *   returnMetadata: true\n     * })\n     * ```\n     */\n    getVectors(options) {\n        const _super = Object.create(null, {\n            getVectors: { get: () => super.getVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.getVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Lists vectors in this index with pagination\n     * Convenience method that automatically includes bucket and index names\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Listing options (bucket and index names automatically set)\n     * @returns Promise with response containing vectors array and pagination token or error\n     *\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     * const { data } = await index.listVectors({\n     *   maxResults: 500,\n     *   returnMetadata: true\n     * })\n     * ```\n     */\n    listVectors() {\n        const _super = Object.create(null, {\n            listVectors: { get: () => super.listVectors }\n        });\n        return __awaiter(this, arguments, void 0, function* (options = {}) {\n            return _super.listVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Queries for similar vectors in this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Query options (bucket and index names automatically set)\n     * @returns Promise with response containing matches array of similar vectors ordered by distance or error\n     *\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     * const { data } = await index.queryVectors({\n     *   queryVector: { float32: [0.1, 0.2, ...] },\n     *   topK: 5,\n     *   filter: { category: 'technical' },\n     *   returnDistance: true,\n     *   returnMetadata: true\n     * })\n     * ```\n     */\n    queryVectors(options) {\n        const _super = Object.create(null, {\n            queryVectors: { get: () => super.queryVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.queryVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Deletes vectors by keys from this index\n     * Convenience method that automatically includes bucket and index names\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @param options - Deletion options (bucket and index names automatically set)\n     * @returns Promise with empty response on success or error\n     *\n     * @example\n     * ```typescript\n     * const index = supabase.storage.vectors.from('embeddings-prod').index('documents-openai')\n     * await index.deleteVectors({\n     *   keys: ['doc-1', 'doc-2', 'doc-3']\n     * })\n     * ```\n     */\n    deleteVectors(options) {\n        const _super = Object.create(null, {\n            deleteVectors: { get: () => super.deleteVectors }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            return _super.deleteVectors.call(this, Object.assign(Object.assign({}, options), { vectorBucketName: this.vectorBucketName, indexName: this.indexName }));\n        });\n    }\n}\n//# sourceMappingURL=StorageVectorsClient.js.map","import StorageFileApi from './packages/StorageFileApi';\nimport StorageBucketApi from './packages/StorageBucketApi';\nimport StorageAnalyticsClient from './packages/StorageAnalyticsClient';\nimport { StorageVectorsClient } from './lib/vectors';\nexport class StorageClient extends StorageBucketApi {\n    /**\n     * Creates a client for Storage buckets, files, analytics, and vectors.\n     *\n     * @category File Buckets\n     * @example\n     * ```ts\n     * import { StorageClient } from '@supabase/storage-js'\n     *\n     * const storage = new StorageClient('https://xyzcompany.supabase.co/storage/v1', {\n     *   apikey: 'public-anon-key',\n     * })\n     * const avatars = storage.from('avatars')\n     * ```\n     */\n    constructor(url, headers = {}, fetch, opts) {\n        super(url, headers, fetch, opts);\n    }\n    /**\n     * Perform file operation in a bucket.\n     *\n     * @category File Buckets\n     * @param id The bucket id to operate on.\n     *\n     * @example\n     * ```typescript\n     * const avatars = supabase.storage.from('avatars')\n     * ```\n     */\n    from(id) {\n        return new StorageFileApi(this.url, this.headers, id, this.fetch);\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Access vector storage operations.\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Vector Buckets\n     * @returns A StorageVectorsClient instance configured with the current storage settings.\n     */\n    get vectors() {\n        return new StorageVectorsClient(this.url + '/vector', {\n            headers: this.headers,\n            fetch: this.fetch,\n        });\n    }\n    /**\n     *\n     * @alpha\n     *\n     * Access analytics storage operations using Iceberg tables.\n     *\n     * **Public alpha:** This API is part of a public alpha release and may not be available to your account type.\n     *\n     * @category Analytics Buckets\n     * @returns A StorageAnalyticsClient instance configured with the current storage settings.\n     */\n    get analytics() {\n        return new StorageAnalyticsClient(this.url + '/iceberg', this.headers, this.fetch);\n    }\n}\n//# sourceMappingURL=StorageClient.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.86.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\nlet JS_ENV = '';\n// @ts-ignore\nif (typeof Deno !== 'undefined') {\n    JS_ENV = 'deno';\n}\nelse if (typeof document !== 'undefined') {\n    JS_ENV = 'web';\n}\nelse if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    JS_ENV = 'react-native';\n}\nelse {\n    JS_ENV = 'node';\n}\nexport const DEFAULT_HEADERS = { 'X-Client-Info': `supabase-js-${JS_ENV}/${version}` };\nexport const DEFAULT_GLOBAL_OPTIONS = {\n    headers: DEFAULT_HEADERS,\n};\nexport const DEFAULT_DB_OPTIONS = {\n    schema: 'public',\n};\nexport const DEFAULT_AUTH_OPTIONS = {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n    flowType: 'implicit',\n};\nexport const DEFAULT_REALTIME_OPTIONS = {};\n//# sourceMappingURL=constants.js.map","export const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\nexport const resolveHeadersConstructor = () => {\n    return Headers;\n};\nexport const fetchWithAuth = (supabaseKey, getAccessToken, customFetch) => {\n    const fetch = resolveFetch(customFetch);\n    const HeadersConstructor = resolveHeadersConstructor();\n    return async (input, init) => {\n        var _a;\n        const accessToken = (_a = (await getAccessToken())) !== null && _a !== void 0 ? _a : supabaseKey;\n        let headers = new HeadersConstructor(init === null || init === void 0 ? void 0 : init.headers);\n        if (!headers.has('apikey')) {\n            headers.set('apikey', supabaseKey);\n        }\n        if (!headers.has('Authorization')) {\n            headers.set('Authorization', `Bearer ${accessToken}`);\n        }\n        return fetch(input, Object.assign(Object.assign({}, init), { headers }));\n    };\n};\n//# sourceMappingURL=fetch.js.map","export function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\nexport function ensureTrailingSlash(url) {\n    return url.endsWith('/') ? url : url + '/';\n}\nexport const isBrowser = () => typeof window !== 'undefined';\nexport function applySettingDefaults(options, defaults) {\n    var _a, _b;\n    const { db: dbOptions, auth: authOptions, realtime: realtimeOptions, global: globalOptions, } = options;\n    const { db: DEFAULT_DB_OPTIONS, auth: DEFAULT_AUTH_OPTIONS, realtime: DEFAULT_REALTIME_OPTIONS, global: DEFAULT_GLOBAL_OPTIONS, } = defaults;\n    const result = {\n        db: Object.assign(Object.assign({}, DEFAULT_DB_OPTIONS), dbOptions),\n        auth: Object.assign(Object.assign({}, DEFAULT_AUTH_OPTIONS), authOptions),\n        realtime: Object.assign(Object.assign({}, DEFAULT_REALTIME_OPTIONS), realtimeOptions),\n        storage: {},\n        global: Object.assign(Object.assign(Object.assign({}, DEFAULT_GLOBAL_OPTIONS), globalOptions), { headers: Object.assign(Object.assign({}, ((_a = DEFAULT_GLOBAL_OPTIONS === null || DEFAULT_GLOBAL_OPTIONS === void 0 ? void 0 : DEFAULT_GLOBAL_OPTIONS.headers) !== null && _a !== void 0 ? _a : {})), ((_b = globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.headers) !== null && _b !== void 0 ? _b : {})) }),\n        accessToken: async () => '',\n    };\n    if (options.accessToken) {\n        result.accessToken = options.accessToken;\n    }\n    else {\n        // hack around Required<>\n        delete result.accessToken;\n    }\n    return result;\n}\n/**\n * Validates a Supabase client URL\n *\n * @param {string} supabaseUrl - The Supabase client URL string.\n * @returns {URL} - The validated base URL.\n * @throws {Error}\n */\nexport function validateSupabaseUrl(supabaseUrl) {\n    const trimmedUrl = supabaseUrl === null || supabaseUrl === void 0 ? void 0 : supabaseUrl.trim();\n    if (!trimmedUrl) {\n        throw new Error('supabaseUrl is required.');\n    }\n    if (!trimmedUrl.match(/^https?:\\/\\//i)) {\n        throw new Error('Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.');\n    }\n    try {\n        return new URL(ensureTrailingSlash(trimmedUrl));\n    }\n    catch (_a) {\n        throw Error('Invalid supabaseUrl: Provided URL is malformed.');\n    }\n}\n//# sourceMappingURL=helpers.js.map","// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.86.0';\n//# sourceMappingURL=version.js.map","import { version } from './version';\n/** Current session will be checked for refresh at this interval. */\nexport const AUTO_REFRESH_TICK_DURATION_MS = 30 * 1000;\n/**\n * A token refresh will be attempted this many ticks before the current session expires. */\nexport const AUTO_REFRESH_TICK_THRESHOLD = 3;\n/*\n * Earliest time before an access token expires that the session should be refreshed.\n */\nexport const EXPIRY_MARGIN_MS = AUTO_REFRESH_TICK_THRESHOLD * AUTO_REFRESH_TICK_DURATION_MS;\nexport const GOTRUE_URL = 'http://localhost:9999';\nexport const STORAGE_KEY = 'supabase.auth.token';\nexport const AUDIENCE = '';\nexport const DEFAULT_HEADERS = { 'X-Client-Info': `gotrue-js/${version}` };\nexport const NETWORK_FAILURE = {\n    MAX_RETRIES: 10,\n    RETRY_INTERVAL: 2, // in deciseconds\n};\nexport const API_VERSION_HEADER_NAME = 'X-Supabase-Api-Version';\nexport const API_VERSIONS = {\n    '2024-01-01': {\n        timestamp: Date.parse('2024-01-01T00:00:00.0Z'),\n        name: '2024-01-01',\n    },\n};\nexport const BASE64URL_REGEX = /^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;\nexport const JWKS_TTL = 10 * 60 * 1000; // 10 minutes\n//# sourceMappingURL=constants.js.map","/**\n * Base error thrown by Supabase Auth helpers.\n *\n * @example\n * ```ts\n * import { AuthError } from '@supabase/auth-js'\n *\n * throw new AuthError('Unexpected auth error', 500, 'unexpected')\n * ```\n */\nexport class AuthError extends Error {\n    constructor(message, status, code) {\n        super(message);\n        this.__isAuthError = true;\n        this.name = 'AuthError';\n        this.status = status;\n        this.code = code;\n    }\n}\nexport function isAuthError(error) {\n    return typeof error === 'object' && error !== null && '__isAuthError' in error;\n}\n/**\n * Error returned directly from the GoTrue REST API.\n *\n * @example\n * ```ts\n * import { AuthApiError } from '@supabase/auth-js'\n *\n * throw new AuthApiError('Invalid credentials', 400, 'invalid_credentials')\n * ```\n */\nexport class AuthApiError extends AuthError {\n    constructor(message, status, code) {\n        super(message, status, code);\n        this.name = 'AuthApiError';\n        this.status = status;\n        this.code = code;\n    }\n}\nexport function isAuthApiError(error) {\n    return isAuthError(error) && error.name === 'AuthApiError';\n}\n/**\n * Wraps non-standard errors so callers can inspect the root cause.\n *\n * @example\n * ```ts\n * import { AuthUnknownError } from '@supabase/auth-js'\n *\n * try {\n *   await someAuthCall()\n * } catch (err) {\n *   throw new AuthUnknownError('Auth failed', err)\n * }\n * ```\n */\nexport class AuthUnknownError extends AuthError {\n    constructor(message, originalError) {\n        super(message);\n        this.name = 'AuthUnknownError';\n        this.originalError = originalError;\n    }\n}\n/**\n * Flexible error class used to create named auth errors at runtime.\n *\n * @example\n * ```ts\n * import { CustomAuthError } from '@supabase/auth-js'\n *\n * throw new CustomAuthError('My custom auth error', 'MyAuthError', 400, 'custom_code')\n * ```\n */\nexport class CustomAuthError extends AuthError {\n    constructor(message, name, status, code) {\n        super(message, status, code);\n        this.name = name;\n        this.status = status;\n    }\n}\n/**\n * Error thrown when an operation requires a session but none is present.\n *\n * @example\n * ```ts\n * import { AuthSessionMissingError } from '@supabase/auth-js'\n *\n * throw new AuthSessionMissingError()\n * ```\n */\nexport class AuthSessionMissingError extends CustomAuthError {\n    constructor() {\n        super('Auth session missing!', 'AuthSessionMissingError', 400, undefined);\n    }\n}\nexport function isAuthSessionMissingError(error) {\n    return isAuthError(error) && error.name === 'AuthSessionMissingError';\n}\n/**\n * Error thrown when the token response is malformed.\n *\n * @example\n * ```ts\n * import { AuthInvalidTokenResponseError } from '@supabase/auth-js'\n *\n * throw new AuthInvalidTokenResponseError()\n * ```\n */\nexport class AuthInvalidTokenResponseError extends CustomAuthError {\n    constructor() {\n        super('Auth session or user missing', 'AuthInvalidTokenResponseError', 500, undefined);\n    }\n}\n/**\n * Error thrown when email/password credentials are invalid.\n *\n * @example\n * ```ts\n * import { AuthInvalidCredentialsError } from '@supabase/auth-js'\n *\n * throw new AuthInvalidCredentialsError('Email or password is incorrect')\n * ```\n */\nexport class AuthInvalidCredentialsError extends CustomAuthError {\n    constructor(message) {\n        super(message, 'AuthInvalidCredentialsError', 400, undefined);\n    }\n}\n/**\n * Error thrown when implicit grant redirects contain an error.\n *\n * @example\n * ```ts\n * import { AuthImplicitGrantRedirectError } from '@supabase/auth-js'\n *\n * throw new AuthImplicitGrantRedirectError('OAuth redirect failed', {\n *   error: 'access_denied',\n *   code: 'oauth_error',\n * })\n * ```\n */\nexport class AuthImplicitGrantRedirectError extends CustomAuthError {\n    constructor(message, details = null) {\n        super(message, 'AuthImplicitGrantRedirectError', 500, undefined);\n        this.details = null;\n        this.details = details;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            details: this.details,\n        };\n    }\n}\nexport function isAuthImplicitGrantRedirectError(error) {\n    return isAuthError(error) && error.name === 'AuthImplicitGrantRedirectError';\n}\n/**\n * Error thrown during PKCE code exchanges.\n *\n * @example\n * ```ts\n * import { AuthPKCEGrantCodeExchangeError } from '@supabase/auth-js'\n *\n * throw new AuthPKCEGrantCodeExchangeError('PKCE exchange failed')\n * ```\n */\nexport class AuthPKCEGrantCodeExchangeError extends CustomAuthError {\n    constructor(message, details = null) {\n        super(message, 'AuthPKCEGrantCodeExchangeError', 500, undefined);\n        this.details = null;\n        this.details = details;\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            message: this.message,\n            status: this.status,\n            details: this.details,\n        };\n    }\n}\n/**\n * Error thrown when a transient fetch issue occurs.\n *\n * @example\n * ```ts\n * import { AuthRetryableFetchError } from '@supabase/auth-js'\n *\n * throw new AuthRetryableFetchError('Service temporarily unavailable', 503)\n * ```\n */\nexport class AuthRetryableFetchError extends CustomAuthError {\n    constructor(message, status) {\n        super(message, 'AuthRetryableFetchError', status, undefined);\n    }\n}\nexport function isAuthRetryableFetchError(error) {\n    return isAuthError(error) && error.name === 'AuthRetryableFetchError';\n}\n/**\n * This error is thrown on certain methods when the password used is deemed\n * weak. Inspect the reasons to identify what password strength rules are\n * inadequate.\n */\n/**\n * Error thrown when a supplied password is considered weak.\n *\n * @example\n * ```ts\n * import { AuthWeakPasswordError } from '@supabase/auth-js'\n *\n * throw new AuthWeakPasswordError('Password too short', 400, ['min_length'])\n * ```\n */\nexport class AuthWeakPasswordError extends CustomAuthError {\n    constructor(message, status, reasons) {\n        super(message, 'AuthWeakPasswordError', status, 'weak_password');\n        this.reasons = reasons;\n    }\n}\nexport function isAuthWeakPasswordError(error) {\n    return isAuthError(error) && error.name === 'AuthWeakPasswordError';\n}\n/**\n * Error thrown when a JWT cannot be verified or parsed.\n *\n * @example\n * ```ts\n * import { AuthInvalidJwtError } from '@supabase/auth-js'\n *\n * throw new AuthInvalidJwtError('Token signature is invalid')\n * ```\n */\nexport class AuthInvalidJwtError extends CustomAuthError {\n    constructor(message) {\n        super(message, 'AuthInvalidJwtError', 400, 'invalid_jwt');\n    }\n}\n//# sourceMappingURL=errors.js.map","/**\n * Avoid modifying this file. It's part of\n * https://github.com/supabase-community/base64url-js.  Submit all fixes on\n * that repo!\n */\n/**\n * An array of characters that encode 6 bits into a Base64-URL alphabet\n * character.\n */\nconst TO_BASE64URL = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'.split('');\n/**\n * An array of characters that can appear in a Base64-URL encoded string but\n * should be ignored.\n */\nconst IGNORE_BASE64URL = ' \\t\\n\\r='.split('');\n/**\n * An array of 128 numbers that map a Base64-URL character to 6 bits, or if -2\n * used to skip the character, or if -1 used to error out.\n */\nconst FROM_BASE64URL = (() => {\n    const charMap = new Array(128);\n    for (let i = 0; i < charMap.length; i += 1) {\n        charMap[i] = -1;\n    }\n    for (let i = 0; i < IGNORE_BASE64URL.length; i += 1) {\n        charMap[IGNORE_BASE64URL[i].charCodeAt(0)] = -2;\n    }\n    for (let i = 0; i < TO_BASE64URL.length; i += 1) {\n        charMap[TO_BASE64URL[i].charCodeAt(0)] = i;\n    }\n    return charMap;\n})();\n/**\n * Converts a byte to a Base64-URL string.\n *\n * @param byte The byte to convert, or null to flush at the end of the byte sequence.\n * @param state The Base64 conversion state. Pass an initial value of `{ queue: 0, queuedBits: 0 }`.\n * @param emit A function called with the next Base64 character when ready.\n */\nexport function byteToBase64URL(byte, state, emit) {\n    if (byte !== null) {\n        state.queue = (state.queue << 8) | byte;\n        state.queuedBits += 8;\n        while (state.queuedBits >= 6) {\n            const pos = (state.queue >> (state.queuedBits - 6)) & 63;\n            emit(TO_BASE64URL[pos]);\n            state.queuedBits -= 6;\n        }\n    }\n    else if (state.queuedBits > 0) {\n        state.queue = state.queue << (6 - state.queuedBits);\n        state.queuedBits = 6;\n        while (state.queuedBits >= 6) {\n            const pos = (state.queue >> (state.queuedBits - 6)) & 63;\n            emit(TO_BASE64URL[pos]);\n            state.queuedBits -= 6;\n        }\n    }\n}\n/**\n * Converts a String char code (extracted using `string.charCodeAt(position)`) to a sequence of Base64-URL characters.\n *\n * @param charCode The char code of the JavaScript string.\n * @param state The Base64 state. Pass an initial value of `{ queue: 0, queuedBits: 0 }`.\n * @param emit A function called with the next byte.\n */\nexport function byteFromBase64URL(charCode, state, emit) {\n    const bits = FROM_BASE64URL[charCode];\n    if (bits > -1) {\n        // valid Base64-URL character\n        state.queue = (state.queue << 6) | bits;\n        state.queuedBits += 6;\n        while (state.queuedBits >= 8) {\n            emit((state.queue >> (state.queuedBits - 8)) & 0xff);\n            state.queuedBits -= 8;\n        }\n    }\n    else if (bits === -2) {\n        // ignore spaces, tabs, newlines, =\n        return;\n    }\n    else {\n        throw new Error(`Invalid Base64-URL character \"${String.fromCharCode(charCode)}\"`);\n    }\n}\n/**\n * Converts a JavaScript string (which may include any valid character) into a\n * Base64-URL encoded string. The string is first encoded in UTF-8 which is\n * then encoded as Base64-URL.\n *\n * @param str The string to convert.\n */\nexport function stringToBase64URL(str) {\n    const base64 = [];\n    const emitter = (char) => {\n        base64.push(char);\n    };\n    const state = { queue: 0, queuedBits: 0 };\n    stringToUTF8(str, (byte) => {\n        byteToBase64URL(byte, state, emitter);\n    });\n    byteToBase64URL(null, state, emitter);\n    return base64.join('');\n}\n/**\n * Converts a Base64-URL encoded string into a JavaScript string. It is assumed\n * that the underlying string has been encoded as UTF-8.\n *\n * @param str The Base64-URL encoded string.\n */\nexport function stringFromBase64URL(str) {\n    const conv = [];\n    const utf8Emit = (codepoint) => {\n        conv.push(String.fromCodePoint(codepoint));\n    };\n    const utf8State = {\n        utf8seq: 0,\n        codepoint: 0,\n    };\n    const b64State = { queue: 0, queuedBits: 0 };\n    const byteEmit = (byte) => {\n        stringFromUTF8(byte, utf8State, utf8Emit);\n    };\n    for (let i = 0; i < str.length; i += 1) {\n        byteFromBase64URL(str.charCodeAt(i), b64State, byteEmit);\n    }\n    return conv.join('');\n}\n/**\n * Converts a Unicode codepoint to a multi-byte UTF-8 sequence.\n *\n * @param codepoint The Unicode codepoint.\n * @param emit      Function which will be called for each UTF-8 byte that represents the codepoint.\n */\nexport function codepointToUTF8(codepoint, emit) {\n    if (codepoint <= 0x7f) {\n        emit(codepoint);\n        return;\n    }\n    else if (codepoint <= 0x7ff) {\n        emit(0xc0 | (codepoint >> 6));\n        emit(0x80 | (codepoint & 0x3f));\n        return;\n    }\n    else if (codepoint <= 0xffff) {\n        emit(0xe0 | (codepoint >> 12));\n        emit(0x80 | ((codepoint >> 6) & 0x3f));\n        emit(0x80 | (codepoint & 0x3f));\n        return;\n    }\n    else if (codepoint <= 0x10ffff) {\n        emit(0xf0 | (codepoint >> 18));\n        emit(0x80 | ((codepoint >> 12) & 0x3f));\n        emit(0x80 | ((codepoint >> 6) & 0x3f));\n        emit(0x80 | (codepoint & 0x3f));\n        return;\n    }\n    throw new Error(`Unrecognized Unicode codepoint: ${codepoint.toString(16)}`);\n}\n/**\n * Converts a JavaScript string to a sequence of UTF-8 bytes.\n *\n * @param str  The string to convert to UTF-8.\n * @param emit Function which will be called for each UTF-8 byte of the string.\n */\nexport function stringToUTF8(str, emit) {\n    for (let i = 0; i < str.length; i += 1) {\n        let codepoint = str.charCodeAt(i);\n        if (codepoint > 0xd7ff && codepoint <= 0xdbff) {\n            // most UTF-16 codepoints are Unicode codepoints, except values in this\n            // range where the next UTF-16 codepoint needs to be combined with the\n            // current one to get the Unicode codepoint\n            const highSurrogate = ((codepoint - 0xd800) * 0x400) & 0xffff;\n            const lowSurrogate = (str.charCodeAt(i + 1) - 0xdc00) & 0xffff;\n            codepoint = (lowSurrogate | highSurrogate) + 0x10000;\n            i += 1;\n        }\n        codepointToUTF8(codepoint, emit);\n    }\n}\n/**\n * Converts a UTF-8 byte to a Unicode codepoint.\n *\n * @param byte  The UTF-8 byte next in the sequence.\n * @param state The shared state between consecutive UTF-8 bytes in the\n *              sequence, an object with the shape `{ utf8seq: 0, codepoint: 0 }`.\n * @param emit  Function which will be called for each codepoint.\n */\nexport function stringFromUTF8(byte, state, emit) {\n    if (state.utf8seq === 0) {\n        if (byte <= 0x7f) {\n            emit(byte);\n            return;\n        }\n        // count the number of 1 leading bits until you reach 0\n        for (let leadingBit = 1; leadingBit < 6; leadingBit += 1) {\n            if (((byte >> (7 - leadingBit)) & 1) === 0) {\n                state.utf8seq = leadingBit;\n                break;\n            }\n        }\n        if (state.utf8seq === 2) {\n            state.codepoint = byte & 31;\n        }\n        else if (state.utf8seq === 3) {\n            state.codepoint = byte & 15;\n        }\n        else if (state.utf8seq === 4) {\n            state.codepoint = byte & 7;\n        }\n        else {\n            throw new Error('Invalid UTF-8 sequence');\n        }\n        state.utf8seq -= 1;\n    }\n    else if (state.utf8seq > 0) {\n        if (byte <= 0x7f) {\n            throw new Error('Invalid UTF-8 sequence');\n        }\n        state.codepoint = (state.codepoint << 6) | (byte & 63);\n        state.utf8seq -= 1;\n        if (state.utf8seq === 0) {\n            emit(state.codepoint);\n        }\n    }\n}\n/**\n * Helper functions to convert different types of strings to Uint8Array\n */\nexport function base64UrlToUint8Array(str) {\n    const result = [];\n    const state = { queue: 0, queuedBits: 0 };\n    const onByte = (byte) => {\n        result.push(byte);\n    };\n    for (let i = 0; i < str.length; i += 1) {\n        byteFromBase64URL(str.charCodeAt(i), state, onByte);\n    }\n    return new Uint8Array(result);\n}\nexport function stringToUint8Array(str) {\n    const result = [];\n    stringToUTF8(str, (byte) => result.push(byte));\n    return new Uint8Array(result);\n}\nexport function bytesToBase64URL(bytes) {\n    const result = [];\n    const state = { queue: 0, queuedBits: 0 };\n    const onChar = (char) => {\n        result.push(char);\n    };\n    bytes.forEach((byte) => byteToBase64URL(byte, state, onChar));\n    // always call with `null` after processing all bytes\n    byteToBase64URL(null, state, onChar);\n    return result.join('');\n}\n//# sourceMappingURL=base64url.js.map","import { API_VERSION_HEADER_NAME, BASE64URL_REGEX } from './constants';\nimport { AuthInvalidJwtError } from './errors';\nimport { base64UrlToUint8Array, stringFromBase64URL } from './base64url';\nexport function expiresAt(expiresIn) {\n    const timeNow = Math.round(Date.now() / 1000);\n    return timeNow + expiresIn;\n}\n/**\n * Generates a unique identifier for internal callback subscriptions.\n *\n * This function uses JavaScript Symbols to create guaranteed-unique identifiers\n * for auth state change callbacks. Symbols are ideal for this use case because:\n * - They are guaranteed unique by the JavaScript runtime\n * - They work in all environments (browser, SSR, Node.js)\n * - They avoid issues with Next.js 16 deterministic rendering requirements\n * - They are perfect for internal, non-serializable identifiers\n *\n * Note: This function is only used for internal subscription management,\n * not for security-critical operations like session tokens.\n */\nexport function generateCallbackId() {\n    return Symbol('auth-callback');\n}\nexport const isBrowser = () => typeof window !== 'undefined' && typeof document !== 'undefined';\nconst localStorageWriteTests = {\n    tested: false,\n    writable: false,\n};\n/**\n * Checks whether localStorage is supported on this browser.\n */\nexport const supportsLocalStorage = () => {\n    if (!isBrowser()) {\n        return false;\n    }\n    try {\n        if (typeof globalThis.localStorage !== 'object') {\n            return false;\n        }\n    }\n    catch (e) {\n        // DOM exception when accessing `localStorage`\n        return false;\n    }\n    if (localStorageWriteTests.tested) {\n        return localStorageWriteTests.writable;\n    }\n    const randomKey = `lswt-${Math.random()}${Math.random()}`;\n    try {\n        globalThis.localStorage.setItem(randomKey, randomKey);\n        globalThis.localStorage.removeItem(randomKey);\n        localStorageWriteTests.tested = true;\n        localStorageWriteTests.writable = true;\n    }\n    catch (e) {\n        // localStorage can't be written to\n        // https://www.chromium.org/for-testers/bug-reporting-guidelines/uncaught-securityerror-failed-to-read-the-localstorage-property-from-window-access-is-denied-for-this-document\n        localStorageWriteTests.tested = true;\n        localStorageWriteTests.writable = false;\n    }\n    return localStorageWriteTests.writable;\n};\n/**\n * Extracts parameters encoded in the URL both in the query and fragment.\n */\nexport function parseParametersFromURL(href) {\n    const result = {};\n    const url = new URL(href);\n    if (url.hash && url.hash[0] === '#') {\n        try {\n            const hashSearchParams = new URLSearchParams(url.hash.substring(1));\n            hashSearchParams.forEach((value, key) => {\n                result[key] = value;\n            });\n        }\n        catch (e) {\n            // hash is not a query string\n        }\n    }\n    // search parameters take precedence over hash parameters\n    url.searchParams.forEach((value, key) => {\n        result[key] = value;\n    });\n    return result;\n}\nexport const resolveFetch = (customFetch) => {\n    if (customFetch) {\n        return (...args) => customFetch(...args);\n    }\n    return (...args) => fetch(...args);\n};\nexport const looksLikeFetchResponse = (maybeResponse) => {\n    return (typeof maybeResponse === 'object' &&\n        maybeResponse !== null &&\n        'status' in maybeResponse &&\n        'ok' in maybeResponse &&\n        'json' in maybeResponse &&\n        typeof maybeResponse.json === 'function');\n};\n// Storage helpers\nexport const setItemAsync = async (storage, key, data) => {\n    await storage.setItem(key, JSON.stringify(data));\n};\nexport const getItemAsync = async (storage, key) => {\n    const value = await storage.getItem(key);\n    if (!value) {\n        return null;\n    }\n    try {\n        return JSON.parse(value);\n    }\n    catch (_a) {\n        return value;\n    }\n};\nexport const removeItemAsync = async (storage, key) => {\n    await storage.removeItem(key);\n};\n/**\n * A deferred represents some asynchronous work that is not yet finished, which\n * may or may not culminate in a value.\n * Taken from: https://github.com/mike-north/types/blob/master/src/async.ts\n */\nexport class Deferred {\n    constructor() {\n        // eslint-disable-next-line @typescript-eslint/no-extra-semi\n        ;\n        this.promise = new Deferred.promiseConstructor((res, rej) => {\n            // eslint-disable-next-line @typescript-eslint/no-extra-semi\n            ;\n            this.resolve = res;\n            this.reject = rej;\n        });\n    }\n}\nDeferred.promiseConstructor = Promise;\nexport function decodeJWT(token) {\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n        throw new AuthInvalidJwtError('Invalid JWT structure');\n    }\n    // Regex checks for base64url format\n    for (let i = 0; i < parts.length; i++) {\n        if (!BASE64URL_REGEX.test(parts[i])) {\n            throw new AuthInvalidJwtError('JWT not in base64url format');\n        }\n    }\n    const data = {\n        // using base64url lib\n        header: JSON.parse(stringFromBase64URL(parts[0])),\n        payload: JSON.parse(stringFromBase64URL(parts[1])),\n        signature: base64UrlToUint8Array(parts[2]),\n        raw: {\n            header: parts[0],\n            payload: parts[1],\n        },\n    };\n    return data;\n}\n/**\n * Creates a promise that resolves to null after some time.\n */\nexport async function sleep(time) {\n    return await new Promise((accept) => {\n        setTimeout(() => accept(null), time);\n    });\n}\n/**\n * Converts the provided async function into a retryable function. Each result\n * or thrown error is sent to the isRetryable function which should return true\n * if the function should run again.\n */\nexport function retryable(fn, isRetryable) {\n    const promise = new Promise((accept, reject) => {\n        // eslint-disable-next-line @typescript-eslint/no-extra-semi\n        ;\n        (async () => {\n            for (let attempt = 0; attempt < Infinity; attempt++) {\n                try {\n                    const result = await fn(attempt);\n                    if (!isRetryable(attempt, null, result)) {\n                        accept(result);\n                        return;\n                    }\n                }\n                catch (e) {\n                    if (!isRetryable(attempt, e)) {\n                        reject(e);\n                        return;\n                    }\n                }\n            }\n        })();\n    });\n    return promise;\n}\nfunction dec2hex(dec) {\n    return ('0' + dec.toString(16)).substr(-2);\n}\n// Functions below taken from: https://stackoverflow.com/questions/63309409/creating-a-code-verifier-and-challenge-for-pkce-auth-on-spotify-api-in-reactjs\nexport function generatePKCEVerifier() {\n    const verifierLength = 56;\n    const array = new Uint32Array(verifierLength);\n    if (typeof crypto === 'undefined') {\n        const charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';\n        const charSetLen = charSet.length;\n        let verifier = '';\n        for (let i = 0; i < verifierLength; i++) {\n            verifier += charSet.charAt(Math.floor(Math.random() * charSetLen));\n        }\n        return verifier;\n    }\n    crypto.getRandomValues(array);\n    return Array.from(array, dec2hex).join('');\n}\nasync function sha256(randomString) {\n    const encoder = new TextEncoder();\n    const encodedData = encoder.encode(randomString);\n    const hash = await crypto.subtle.digest('SHA-256', encodedData);\n    const bytes = new Uint8Array(hash);\n    return Array.from(bytes)\n        .map((c) => String.fromCharCode(c))\n        .join('');\n}\nexport async function generatePKCEChallenge(verifier) {\n    const hasCryptoSupport = typeof crypto !== 'undefined' &&\n        typeof crypto.subtle !== 'undefined' &&\n        typeof TextEncoder !== 'undefined';\n    if (!hasCryptoSupport) {\n        console.warn('WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256.');\n        return verifier;\n    }\n    const hashed = await sha256(verifier);\n    return btoa(hashed).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\nexport async function getCodeChallengeAndMethod(storage, storageKey, isPasswordRecovery = false) {\n    const codeVerifier = generatePKCEVerifier();\n    let storedCodeVerifier = codeVerifier;\n    if (isPasswordRecovery) {\n        storedCodeVerifier += '/PASSWORD_RECOVERY';\n    }\n    await setItemAsync(storage, `${storageKey}-code-verifier`, storedCodeVerifier);\n    const codeChallenge = await generatePKCEChallenge(codeVerifier);\n    const codeChallengeMethod = codeVerifier === codeChallenge ? 'plain' : 's256';\n    return [codeChallenge, codeChallengeMethod];\n}\n/** Parses the API version which is 2YYY-MM-DD. */\nconst API_VERSION_REGEX = /^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;\nexport function parseResponseAPIVersion(response) {\n    const apiVersion = response.headers.get(API_VERSION_HEADER_NAME);\n    if (!apiVersion) {\n        return null;\n    }\n    if (!apiVersion.match(API_VERSION_REGEX)) {\n        return null;\n    }\n    try {\n        const date = new Date(`${apiVersion}T00:00:00.0Z`);\n        return date;\n    }\n    catch (e) {\n        return null;\n    }\n}\nexport function validateExp(exp) {\n    if (!exp) {\n        throw new Error('Missing exp claim');\n    }\n    const timeNow = Math.floor(Date.now() / 1000);\n    if (exp <= timeNow) {\n        throw new Error('JWT has expired');\n    }\n}\nexport function getAlgorithm(alg) {\n    switch (alg) {\n        case 'RS256':\n            return {\n                name: 'RSASSA-PKCS1-v1_5',\n                hash: { name: 'SHA-256' },\n            };\n        case 'ES256':\n            return {\n                name: 'ECDSA',\n                namedCurve: 'P-256',\n                hash: { name: 'SHA-256' },\n            };\n        default:\n            throw new Error('Invalid alg claim');\n    }\n}\nconst UUID_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;\nexport function validateUUID(str) {\n    if (!UUID_REGEX.test(str)) {\n        throw new Error('@supabase/auth-js: Expected parameter to be UUID but is not');\n    }\n}\nexport function userNotAvailableProxy() {\n    const proxyTarget = {};\n    return new Proxy(proxyTarget, {\n        get: (target, prop) => {\n            if (prop === '__isUserNotAvailableProxy') {\n                return true;\n            }\n            // Preventative check for common problematic symbols during cloning/inspection\n            // These symbols might be accessed by structuredClone or other internal mechanisms.\n            if (typeof prop === 'symbol') {\n                const sProp = prop.toString();\n                if (sProp === 'Symbol(Symbol.toPrimitive)' ||\n                    sProp === 'Symbol(Symbol.toStringTag)' ||\n                    sProp === 'Symbol(util.inspect.custom)') {\n                    // Node.js util.inspect\n                    return undefined;\n                }\n            }\n            throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the \"${prop}\" property of the session object is not supported. Please use getUser() instead.`);\n        },\n        set: (_target, prop) => {\n            throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the \"${prop}\" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`);\n        },\n        deleteProperty: (_target, prop) => {\n            throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the \"${prop}\" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`);\n        },\n    });\n}\n/**\n * Creates a proxy around a user object that warns when properties are accessed on the server.\n * This is used to alert developers that using user data from getSession() on the server is insecure.\n *\n * @param user The actual user object to wrap\n * @param suppressWarningRef An object with a 'value' property that controls warning suppression\n * @returns A proxied user object that warns on property access\n */\nexport function insecureUserWarningProxy(user, suppressWarningRef) {\n    return new Proxy(user, {\n        get: (target, prop, receiver) => {\n            // Allow internal checks without warning\n            if (prop === '__isInsecureUserWarningProxy') {\n                return true;\n            }\n            // Preventative check for common problematic symbols during cloning/inspection\n            // These symbols might be accessed by structuredClone or other internal mechanisms\n            if (typeof prop === 'symbol') {\n                const sProp = prop.toString();\n                if (sProp === 'Symbol(Symbol.toPrimitive)' ||\n                    sProp === 'Symbol(Symbol.toStringTag)' ||\n                    sProp === 'Symbol(util.inspect.custom)' ||\n                    sProp === 'Symbol(nodejs.util.inspect.custom)') {\n                    // Return the actual value for these symbols to allow proper inspection\n                    return Reflect.get(target, prop, receiver);\n                }\n            }\n            // Emit warning on first property access\n            if (!suppressWarningRef.value && typeof prop === 'string') {\n                console.warn('Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.');\n                suppressWarningRef.value = true;\n            }\n            return Reflect.get(target, prop, receiver);\n        },\n    });\n}\n/**\n * Deep clones a JSON-serializable object using JSON.parse(JSON.stringify(obj)).\n * Note: Only works for JSON-safe data.\n */\nexport function deepClone(obj) {\n    return JSON.parse(JSON.stringify(obj));\n}\n//# sourceMappingURL=helpers.js.map","import { __rest } from \"tslib\";\nimport { API_VERSIONS, API_VERSION_HEADER_NAME } from './constants';\nimport { expiresAt, looksLikeFetchResponse, parseResponseAPIVersion } from './helpers';\nimport { AuthApiError, AuthRetryableFetchError, AuthWeakPasswordError, AuthUnknownError, AuthSessionMissingError, } from './errors';\nconst _getErrorMessage = (err) => err.msg || err.message || err.error_description || err.error || JSON.stringify(err);\nconst NETWORK_ERROR_CODES = [502, 503, 504];\nexport async function handleError(error) {\n    var _a;\n    if (!looksLikeFetchResponse(error)) {\n        throw new AuthRetryableFetchError(_getErrorMessage(error), 0);\n    }\n    if (NETWORK_ERROR_CODES.includes(error.status)) {\n        // status in 500...599 range - server had an error, request might be retryed.\n        throw new AuthRetryableFetchError(_getErrorMessage(error), error.status);\n    }\n    let data;\n    try {\n        data = await error.json();\n    }\n    catch (e) {\n        throw new AuthUnknownError(_getErrorMessage(e), e);\n    }\n    let errorCode = undefined;\n    const responseAPIVersion = parseResponseAPIVersion(error);\n    if (responseAPIVersion &&\n        responseAPIVersion.getTime() >= API_VERSIONS['2024-01-01'].timestamp &&\n        typeof data === 'object' &&\n        data &&\n        typeof data.code === 'string') {\n        errorCode = data.code;\n    }\n    else if (typeof data === 'object' && data && typeof data.error_code === 'string') {\n        errorCode = data.error_code;\n    }\n    if (!errorCode) {\n        // Legacy support for weak password errors, when there were no error codes\n        if (typeof data === 'object' &&\n            data &&\n            typeof data.weak_password === 'object' &&\n            data.weak_password &&\n            Array.isArray(data.weak_password.reasons) &&\n            data.weak_password.reasons.length &&\n            data.weak_password.reasons.reduce((a, i) => a && typeof i === 'string', true)) {\n            throw new AuthWeakPasswordError(_getErrorMessage(data), error.status, data.weak_password.reasons);\n        }\n    }\n    else if (errorCode === 'weak_password') {\n        throw new AuthWeakPasswordError(_getErrorMessage(data), error.status, ((_a = data.weak_password) === null || _a === void 0 ? void 0 : _a.reasons) || []);\n    }\n    else if (errorCode === 'session_not_found') {\n        // The `session_id` inside the JWT does not correspond to a row in the\n        // `sessions` table. This usually means the user has signed out, has been\n        // deleted, or their session has somehow been terminated.\n        throw new AuthSessionMissingError();\n    }\n    throw new AuthApiError(_getErrorMessage(data), error.status || 500, errorCode);\n}\nconst _getRequestParams = (method, options, parameters, body) => {\n    const params = { method, headers: (options === null || options === void 0 ? void 0 : options.headers) || {} };\n    if (method === 'GET') {\n        return params;\n    }\n    params.headers = Object.assign({ 'Content-Type': 'application/json;charset=UTF-8' }, options === null || options === void 0 ? void 0 : options.headers);\n    params.body = JSON.stringify(body);\n    return Object.assign(Object.assign({}, params), parameters);\n};\nexport async function _request(fetcher, method, url, options) {\n    var _a;\n    const headers = Object.assign({}, options === null || options === void 0 ? void 0 : options.headers);\n    if (!headers[API_VERSION_HEADER_NAME]) {\n        headers[API_VERSION_HEADER_NAME] = API_VERSIONS['2024-01-01'].name;\n    }\n    if (options === null || options === void 0 ? void 0 : options.jwt) {\n        headers['Authorization'] = `Bearer ${options.jwt}`;\n    }\n    const qs = (_a = options === null || options === void 0 ? void 0 : options.query) !== null && _a !== void 0 ? _a : {};\n    if (options === null || options === void 0 ? void 0 : options.redirectTo) {\n        qs['redirect_to'] = options.redirectTo;\n    }\n    const queryString = Object.keys(qs).length ? '?' + new URLSearchParams(qs).toString() : '';\n    const data = await _handleRequest(fetcher, method, url + queryString, {\n        headers,\n        noResolveJson: options === null || options === void 0 ? void 0 : options.noResolveJson,\n    }, {}, options === null || options === void 0 ? void 0 : options.body);\n    return (options === null || options === void 0 ? void 0 : options.xform) ? options === null || options === void 0 ? void 0 : options.xform(data) : { data: Object.assign({}, data), error: null };\n}\nasync function _handleRequest(fetcher, method, url, options, parameters, body) {\n    const requestParams = _getRequestParams(method, options, parameters, body);\n    let result;\n    try {\n        result = await fetcher(url, Object.assign({}, requestParams));\n    }\n    catch (e) {\n        console.error(e);\n        // fetch failed, likely due to a network or CORS error\n        throw new AuthRetryableFetchError(_getErrorMessage(e), 0);\n    }\n    if (!result.ok) {\n        await handleError(result);\n    }\n    if (options === null || options === void 0 ? void 0 : options.noResolveJson) {\n        return result;\n    }\n    try {\n        return await result.json();\n    }\n    catch (e) {\n        await handleError(e);\n    }\n}\nexport function _sessionResponse(data) {\n    var _a;\n    let session = null;\n    if (hasSession(data)) {\n        session = Object.assign({}, data);\n        if (!data.expires_at) {\n            session.expires_at = expiresAt(data.expires_in);\n        }\n    }\n    const user = (_a = data.user) !== null && _a !== void 0 ? _a : data;\n    return { data: { session, user }, error: null };\n}\nexport function _sessionResponsePassword(data) {\n    const response = _sessionResponse(data);\n    if (!response.error &&\n        data.weak_password &&\n        typeof data.weak_password === 'object' &&\n        Array.isArray(data.weak_password.reasons) &&\n        data.weak_password.reasons.length &&\n        data.weak_password.message &&\n        typeof data.weak_password.message === 'string' &&\n        data.weak_password.reasons.reduce((a, i) => a && typeof i === 'string', true)) {\n        response.data.weak_password = data.weak_password;\n    }\n    return response;\n}\nexport function _userResponse(data) {\n    var _a;\n    const user = (_a = data.user) !== null && _a !== void 0 ? _a : data;\n    return { data: { user }, error: null };\n}\nexport function _ssoResponse(data) {\n    return { data, error: null };\n}\nexport function _generateLinkResponse(data) {\n    const { action_link, email_otp, hashed_token, redirect_to, verification_type } = data, rest = __rest(data, [\"action_link\", \"email_otp\", \"hashed_token\", \"redirect_to\", \"verification_type\"]);\n    const properties = {\n        action_link,\n        email_otp,\n        hashed_token,\n        redirect_to,\n        verification_type,\n    };\n    const user = Object.assign({}, rest);\n    return {\n        data: {\n            properties,\n            user,\n        },\n        error: null,\n    };\n}\nexport function _noResolveJsonResponse(data) {\n    return data;\n}\n/**\n * hasSession checks if the response object contains a valid session\n * @param data A response object\n * @returns true if a session is in the response\n */\nfunction hasSession(data) {\n    return data.access_token && data.refresh_token && data.expires_in;\n}\n//# sourceMappingURL=fetch.js.map","const WeakPasswordReasons = ['length', 'characters', 'pwned'];\nconst AMRMethods = [\n    'password',\n    'otp',\n    'oauth',\n    'totp',\n    'mfa/totp',\n    'mfa/phone',\n    'mfa/webauthn',\n    'anonymous',\n    'sso/saml',\n    'magiclink',\n    'web3',\n];\nconst FactorTypes = ['totp', 'phone', 'webauthn'];\nconst FactorVerificationStatuses = ['verified', 'unverified'];\nconst MFATOTPChannels = ['sms', 'whatsapp'];\nexport const SIGN_OUT_SCOPES = ['global', 'local', 'others'];\n//# sourceMappingURL=types.js.map","import { __rest } from \"tslib\";\nimport { _generateLinkResponse, _noResolveJsonResponse, _request, _userResponse, } from './lib/fetch';\nimport { resolveFetch, validateUUID } from './lib/helpers';\nimport { SIGN_OUT_SCOPES, } from './lib/types';\nimport { isAuthError } from './lib/errors';\nexport default class GoTrueAdminApi {\n    /**\n     * Creates an admin API client that can be used to manage users and OAuth clients.\n     *\n     * @example\n     * ```ts\n     * import { GoTrueAdminApi } from '@supabase/auth-js'\n     *\n     * const admin = new GoTrueAdminApi({\n     *   url: 'https://xyzcompany.supabase.co/auth/v1',\n     *   headers: { Authorization: `Bearer ${process.env.SUPABASE_SERVICE_ROLE_KEY}` },\n     * })\n     * ```\n     */\n    constructor({ url = '', headers = {}, fetch, }) {\n        this.url = url;\n        this.headers = headers;\n        this.fetch = resolveFetch(fetch);\n        this.mfa = {\n            listFactors: this._listFactors.bind(this),\n            deleteFactor: this._deleteFactor.bind(this),\n        };\n        this.oauth = {\n            listClients: this._listOAuthClients.bind(this),\n            createClient: this._createOAuthClient.bind(this),\n            getClient: this._getOAuthClient.bind(this),\n            updateClient: this._updateOAuthClient.bind(this),\n            deleteClient: this._deleteOAuthClient.bind(this),\n            regenerateClientSecret: this._regenerateOAuthClientSecret.bind(this),\n        };\n    }\n    /**\n     * Removes a logged-in session.\n     * @param jwt A valid, logged-in JWT.\n     * @param scope The logout sope.\n     */\n    async signOut(jwt, scope = SIGN_OUT_SCOPES[0]) {\n        if (SIGN_OUT_SCOPES.indexOf(scope) < 0) {\n            throw new Error(`@supabase/auth-js: Parameter scope must be one of ${SIGN_OUT_SCOPES.join(', ')}`);\n        }\n        try {\n            await _request(this.fetch, 'POST', `${this.url}/logout?scope=${scope}`, {\n                headers: this.headers,\n                jwt,\n                noResolveJson: true,\n            });\n            return { data: null, error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sends an invite link to an email address.\n     * @param email The email address of the user.\n     * @param options Additional options to be included when inviting.\n     */\n    async inviteUserByEmail(email, options = {}) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/invite`, {\n                body: { email, data: options.data },\n                headers: this.headers,\n                redirectTo: options.redirectTo,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Generates email links and OTPs to be sent via a custom email provider.\n     * @param email The user's email.\n     * @param options.password User password. For signup only.\n     * @param options.data Optional user metadata. For signup only.\n     * @param options.redirectTo The redirect url which should be appended to the generated link\n     */\n    async generateLink(params) {\n        try {\n            const { options } = params, rest = __rest(params, [\"options\"]);\n            const body = Object.assign(Object.assign({}, rest), options);\n            if ('newEmail' in rest) {\n                // replace newEmail with new_email in request body\n                body.new_email = rest === null || rest === void 0 ? void 0 : rest.newEmail;\n                delete body['newEmail'];\n            }\n            return await _request(this.fetch, 'POST', `${this.url}/admin/generate_link`, {\n                body: body,\n                headers: this.headers,\n                xform: _generateLinkResponse,\n                redirectTo: options === null || options === void 0 ? void 0 : options.redirectTo,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return {\n                    data: {\n                        properties: null,\n                        user: null,\n                    },\n                    error,\n                };\n            }\n            throw error;\n        }\n    }\n    // User Admin API\n    /**\n     * Creates a new user.\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async createUser(attributes) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/admin/users`, {\n                body: attributes,\n                headers: this.headers,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Get a list of users.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     * @param params An object which supports `page` and `perPage` as numbers, to alter the paginated results.\n     */\n    async listUsers(params) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        try {\n            const pagination = { nextPage: null, lastPage: 0, total: 0 };\n            const response = await _request(this.fetch, 'GET', `${this.url}/admin/users`, {\n                headers: this.headers,\n                noResolveJson: true,\n                query: {\n                    page: (_b = (_a = params === null || params === void 0 ? void 0 : params.page) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : '',\n                    per_page: (_d = (_c = params === null || params === void 0 ? void 0 : params.perPage) === null || _c === void 0 ? void 0 : _c.toString()) !== null && _d !== void 0 ? _d : '',\n                },\n                xform: _noResolveJsonResponse,\n            });\n            if (response.error)\n                throw response.error;\n            const users = await response.json();\n            const total = (_e = response.headers.get('x-total-count')) !== null && _e !== void 0 ? _e : 0;\n            const links = (_g = (_f = response.headers.get('link')) === null || _f === void 0 ? void 0 : _f.split(',')) !== null && _g !== void 0 ? _g : [];\n            if (links.length > 0) {\n                links.forEach((link) => {\n                    const page = parseInt(link.split(';')[0].split('=')[1].substring(0, 1));\n                    const rel = JSON.parse(link.split(';')[1].split('=')[1]);\n                    pagination[`${rel}Page`] = page;\n                });\n                pagination.total = parseInt(total);\n            }\n            return { data: Object.assign(Object.assign({}, users), pagination), error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { users: [] }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Get user by id.\n     *\n     * @param uid The user's unique identifier\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async getUserById(uid) {\n        validateUUID(uid);\n        try {\n            return await _request(this.fetch, 'GET', `${this.url}/admin/users/${uid}`, {\n                headers: this.headers,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Updates the user data.\n     *\n     * @param attributes The data you want to update.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async updateUserById(uid, attributes) {\n        validateUUID(uid);\n        try {\n            return await _request(this.fetch, 'PUT', `${this.url}/admin/users/${uid}`, {\n                body: attributes,\n                headers: this.headers,\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Delete a user. Requires a `service_role` key.\n     *\n     * @param id The user id you want to remove.\n     * @param shouldSoftDelete If true, then the user will be soft-deleted from the auth schema. Soft deletion allows user identification from the hashed user ID but is not reversible.\n     * Defaults to false for backward compatibility.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async deleteUser(id, shouldSoftDelete = false) {\n        validateUUID(id);\n        try {\n            return await _request(this.fetch, 'DELETE', `${this.url}/admin/users/${id}`, {\n                headers: this.headers,\n                body: {\n                    should_soft_delete: shouldSoftDelete,\n                },\n                xform: _userResponse,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { user: null }, error };\n            }\n            throw error;\n        }\n    }\n    async _listFactors(params) {\n        validateUUID(params.userId);\n        try {\n            const { data, error } = await _request(this.fetch, 'GET', `${this.url}/admin/users/${params.userId}/factors`, {\n                headers: this.headers,\n                xform: (factors) => {\n                    return { data: { factors }, error: null };\n                },\n            });\n            return { data, error };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    async _deleteFactor(params) {\n        validateUUID(params.userId);\n        validateUUID(params.id);\n        try {\n            const data = await _request(this.fetch, 'DELETE', `${this.url}/admin/users/${params.userId}/factors/${params.id}`, {\n                headers: this.headers,\n            });\n            return { data, error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Lists all OAuth clients with optional pagination.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _listOAuthClients(params) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        try {\n            const pagination = { nextPage: null, lastPage: 0, total: 0 };\n            const response = await _request(this.fetch, 'GET', `${this.url}/admin/oauth/clients`, {\n                headers: this.headers,\n                noResolveJson: true,\n                query: {\n                    page: (_b = (_a = params === null || params === void 0 ? void 0 : params.page) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : '',\n                    per_page: (_d = (_c = params === null || params === void 0 ? void 0 : params.perPage) === null || _c === void 0 ? void 0 : _c.toString()) !== null && _d !== void 0 ? _d : '',\n                },\n                xform: _noResolveJsonResponse,\n            });\n            if (response.error)\n                throw response.error;\n            const clients = await response.json();\n            const total = (_e = response.headers.get('x-total-count')) !== null && _e !== void 0 ? _e : 0;\n            const links = (_g = (_f = response.headers.get('link')) === null || _f === void 0 ? void 0 : _f.split(',')) !== null && _g !== void 0 ? _g : [];\n            if (links.length > 0) {\n                links.forEach((link) => {\n                    const page = parseInt(link.split(';')[0].split('=')[1].substring(0, 1));\n                    const rel = JSON.parse(link.split(';')[1].split('=')[1]);\n                    pagination[`${rel}Page`] = page;\n                });\n                pagination.total = parseInt(total);\n            }\n            return { data: Object.assign(Object.assign({}, clients), pagination), error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: { clients: [] }, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Creates a new OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _createOAuthClient(params) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/admin/oauth/clients`, {\n                body: params,\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Gets details of a specific OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _getOAuthClient(clientId) {\n        try {\n            return await _request(this.fetch, 'GET', `${this.url}/admin/oauth/clients/${clientId}`, {\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Updates an existing OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _updateOAuthClient(clientId, params) {\n        try {\n            return await _request(this.fetch, 'PUT', `${this.url}/admin/oauth/clients/${clientId}`, {\n                body: params,\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Deletes an OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _deleteOAuthClient(clientId) {\n        try {\n            await _request(this.fetch, 'DELETE', `${this.url}/admin/oauth/clients/${clientId}`, {\n                headers: this.headers,\n                noResolveJson: true,\n            });\n            return { data: null, error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n    /**\n     * Regenerates the secret for an OAuth client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * This function should only be called on a server. Never expose your `service_role` key in the browser.\n     */\n    async _regenerateOAuthClientSecret(clientId) {\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/admin/oauth/clients/${clientId}/regenerate_secret`, {\n                headers: this.headers,\n                xform: (client) => {\n                    return { data: client, error: null };\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            throw error;\n        }\n    }\n}\n//# sourceMappingURL=GoTrueAdminApi.js.map","/**\n * Returns a localStorage-like object that stores the key-value pairs in\n * memory.\n */\nexport function memoryLocalStorageAdapter(store = {}) {\n    return {\n        getItem: (key) => {\n            return store[key] || null;\n        },\n        setItem: (key, value) => {\n            store[key] = value;\n        },\n        removeItem: (key) => {\n            delete store[key];\n        },\n    };\n}\n//# sourceMappingURL=local-storage.js.map","import { supportsLocalStorage } from './helpers';\n/**\n * @experimental\n */\nexport const internals = {\n    /**\n     * @experimental\n     */\n    debug: !!(globalThis &&\n        supportsLocalStorage() &&\n        globalThis.localStorage &&\n        globalThis.localStorage.getItem('supabase.gotrue-js.locks.debug') === 'true'),\n};\n/**\n * An error thrown when a lock cannot be acquired after some amount of time.\n *\n * Use the {@link #isAcquireTimeout} property instead of checking with `instanceof`.\n *\n * @example\n * ```ts\n * import { LockAcquireTimeoutError } from '@supabase/auth-js'\n *\n * class CustomLockError extends LockAcquireTimeoutError {\n *   constructor() {\n *     super('Lock timed out')\n *   }\n * }\n * ```\n */\nexport class LockAcquireTimeoutError extends Error {\n    constructor(message) {\n        super(message);\n        this.isAcquireTimeout = true;\n    }\n}\n/**\n * Error thrown when the browser Navigator Lock API fails to acquire a lock.\n *\n * @example\n * ```ts\n * import { NavigatorLockAcquireTimeoutError } from '@supabase/auth-js'\n *\n * throw new NavigatorLockAcquireTimeoutError('Lock timed out')\n * ```\n */\nexport class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError {\n}\n/**\n * Error thrown when the process-level lock helper cannot acquire a lock.\n *\n * @example\n * ```ts\n * import { ProcessLockAcquireTimeoutError } from '@supabase/auth-js'\n *\n * throw new ProcessLockAcquireTimeoutError('Lock timed out')\n * ```\n */\nexport class ProcessLockAcquireTimeoutError extends LockAcquireTimeoutError {\n}\n/**\n * Implements a global exclusive lock using the Navigator LockManager API. It\n * is available on all browsers released after 2022-03-15 with Safari being the\n * last one to release support. If the API is not available, this function will\n * throw. Make sure you check availablility before configuring {@link\n * GoTrueClient}.\n *\n * You can turn on debugging by setting the `supabase.gotrue-js.locks.debug`\n * local storage item to `true`.\n *\n * Internals:\n *\n * Since the LockManager API does not preserve stack traces for the async\n * function passed in the `request` method, a trick is used where acquiring the\n * lock releases a previously started promise to run the operation in the `fn`\n * function. The lock waits for that promise to finish (with or without error),\n * while the function will finally wait for the result anyway.\n *\n * @param name Name of the lock to be acquired.\n * @param acquireTimeout If negative, no timeout. If 0 an error is thrown if\n *                       the lock can't be acquired without waiting. If positive, the lock acquire\n *                       will time out after so many milliseconds. An error is\n *                       a timeout if it has `isAcquireTimeout` set to true.\n * @param fn The operation to run once the lock is acquired.\n * @example\n * ```ts\n * await navigatorLock('sync-user', 1000, async () => {\n *   await refreshSession()\n * })\n * ```\n */\nexport async function navigatorLock(name, acquireTimeout, fn) {\n    if (internals.debug) {\n        console.log('@supabase/gotrue-js: navigatorLock: acquire lock', name, acquireTimeout);\n    }\n    const abortController = new globalThis.AbortController();\n    if (acquireTimeout > 0) {\n        setTimeout(() => {\n            abortController.abort();\n            if (internals.debug) {\n                console.log('@supabase/gotrue-js: navigatorLock acquire timed out', name);\n            }\n        }, acquireTimeout);\n    }\n    // MDN article: https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request\n    // Wrapping navigator.locks.request() with a plain Promise is done as some\n    // libraries like zone.js patch the Promise object to track the execution\n    // context. However, it appears that most browsers use an internal promise\n    // implementation when using the navigator.locks.request() API causing them\n    // to lose context and emit confusing log messages or break certain features.\n    // This wrapping is believed to help zone.js track the execution context\n    // better.\n    return await Promise.resolve().then(() => globalThis.navigator.locks.request(name, acquireTimeout === 0\n        ? {\n            mode: 'exclusive',\n            ifAvailable: true,\n        }\n        : {\n            mode: 'exclusive',\n            signal: abortController.signal,\n        }, async (lock) => {\n        if (lock) {\n            if (internals.debug) {\n                console.log('@supabase/gotrue-js: navigatorLock: acquired', name, lock.name);\n            }\n            try {\n                return await fn();\n            }\n            finally {\n                if (internals.debug) {\n                    console.log('@supabase/gotrue-js: navigatorLock: released', name, lock.name);\n                }\n            }\n        }\n        else {\n            if (acquireTimeout === 0) {\n                if (internals.debug) {\n                    console.log('@supabase/gotrue-js: navigatorLock: not immediately available', name);\n                }\n                throw new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock \"${name}\" immediately failed`);\n            }\n            else {\n                if (internals.debug) {\n                    try {\n                        const result = await globalThis.navigator.locks.query();\n                        console.log('@supabase/gotrue-js: Navigator LockManager state', JSON.stringify(result, null, '  '));\n                    }\n                    catch (e) {\n                        console.warn('@supabase/gotrue-js: Error when querying Navigator LockManager state', e);\n                    }\n                }\n                // Browser is not following the Navigator LockManager spec, it\n                // returned a null lock when we didn't use ifAvailable. So we can\n                // pretend the lock is acquired in the name of backward compatibility\n                // and user experience and just run the function.\n                console.warn('@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request');\n                return await fn();\n            }\n        }\n    }));\n}\nconst PROCESS_LOCKS = {};\n/**\n * Implements a global exclusive lock that works only in the current process.\n * Useful for environments like React Native or other non-browser\n * single-process (i.e. no concept of \"tabs\") environments.\n *\n * Use {@link #navigatorLock} in browser environments.\n *\n * @param name Name of the lock to be acquired.\n * @param acquireTimeout If negative, no timeout. If 0 an error is thrown if\n *                       the lock can't be acquired without waiting. If positive, the lock acquire\n *                       will time out after so many milliseconds. An error is\n *                       a timeout if it has `isAcquireTimeout` set to true.\n * @param fn The operation to run once the lock is acquired.\n * @example\n * ```ts\n * await processLock('migrate', 5000, async () => {\n *   await runMigration()\n * })\n * ```\n */\nexport async function processLock(name, acquireTimeout, fn) {\n    var _a;\n    const previousOperation = (_a = PROCESS_LOCKS[name]) !== null && _a !== void 0 ? _a : Promise.resolve();\n    const currentOperation = Promise.race([\n        previousOperation.catch(() => {\n            // ignore error of previous operation that we're waiting to finish\n            return null;\n        }),\n        acquireTimeout >= 0\n            ? new Promise((_, reject) => {\n                setTimeout(() => {\n                    reject(new ProcessLockAcquireTimeoutError(`Acquring process lock with name \"${name}\" timed out`));\n                }, acquireTimeout);\n            })\n            : null,\n    ].filter((x) => x))\n        .catch((e) => {\n        if (e && e.isAcquireTimeout) {\n            throw e;\n        }\n        return null;\n    })\n        .then(async () => {\n        // previous operations finished and we didn't get a race on the acquire\n        // timeout, so the current operation can finally start\n        return await fn();\n    });\n    PROCESS_LOCKS[name] = currentOperation.catch(async (e) => {\n        if (e && e.isAcquireTimeout) {\n            // if the current operation timed out, it doesn't mean that the previous\n            // operation finished, so we need contnue waiting for it to finish\n            await previousOperation;\n            return null;\n        }\n        throw e;\n    });\n    // finally wait for the current operation to finish successfully, with an\n    // error or with an acquire timeout error\n    return await currentOperation;\n}\n//# sourceMappingURL=locks.js.map","/**\n * https://mathiasbynens.be/notes/globalthis\n */\nexport function polyfillGlobalThis() {\n    if (typeof globalThis === 'object')\n        return;\n    try {\n        Object.defineProperty(Object.prototype, '__magic__', {\n            get: function () {\n                return this;\n            },\n            configurable: true,\n        });\n        // @ts-expect-error 'Allow access to magic'\n        __magic__.globalThis = __magic__;\n        // @ts-expect-error 'Allow access to magic'\n        delete Object.prototype.__magic__;\n    }\n    catch (e) {\n        if (typeof self !== 'undefined') {\n            // @ts-expect-error 'Allow access to globals'\n            self.globalThis = self;\n        }\n    }\n}\n//# sourceMappingURL=polyfills.js.map","// types and functions copied over from viem so this library doesn't depend on it\nexport function getAddress(address) {\n    if (!/^0x[a-fA-F0-9]{40}$/.test(address)) {\n        throw new Error(`@supabase/auth-js: Address \"${address}\" is invalid.`);\n    }\n    return address.toLowerCase();\n}\nexport function fromHex(hex) {\n    return parseInt(hex, 16);\n}\nexport function toHex(value) {\n    const bytes = new TextEncoder().encode(value);\n    const hex = Array.from(bytes, (byte) => byte.toString(16).padStart(2, '0')).join('');\n    return ('0x' + hex);\n}\n/**\n * Creates EIP-4361 formatted message.\n */\nexport function createSiweMessage(parameters) {\n    var _a;\n    const { chainId, domain, expirationTime, issuedAt = new Date(), nonce, notBefore, requestId, resources, scheme, uri, version, } = parameters;\n    // Validate fields\n    {\n        if (!Number.isInteger(chainId))\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"chainId\". Chain ID must be a EIP-155 chain ID. Provided value: ${chainId}`);\n        if (!domain)\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"domain\". Domain must be provided.`);\n        if (nonce && nonce.length < 8)\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"nonce\". Nonce must be at least 8 characters. Provided value: ${nonce}`);\n        if (!uri)\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"uri\". URI must be provided.`);\n        if (version !== '1')\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ${version}`);\n        if ((_a = parameters.statement) === null || _a === void 0 ? void 0 : _a.includes('\\n'))\n            throw new Error(`@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\\\n'. Provided value: ${parameters.statement}`);\n    }\n    // Construct message\n    const address = getAddress(parameters.address);\n    const origin = scheme ? `${scheme}://${domain}` : domain;\n    const statement = parameters.statement ? `${parameters.statement}\\n` : '';\n    const prefix = `${origin} wants you to sign in with your Ethereum account:\\n${address}\\n\\n${statement}`;\n    let suffix = `URI: ${uri}\\nVersion: ${version}\\nChain ID: ${chainId}${nonce ? `\\nNonce: ${nonce}` : ''}\\nIssued At: ${issuedAt.toISOString()}`;\n    if (expirationTime)\n        suffix += `\\nExpiration Time: ${expirationTime.toISOString()}`;\n    if (notBefore)\n        suffix += `\\nNot Before: ${notBefore.toISOString()}`;\n    if (requestId)\n        suffix += `\\nRequest ID: ${requestId}`;\n    if (resources) {\n        let content = '\\nResources:';\n        for (const resource of resources) {\n            if (!resource || typeof resource !== 'string')\n                throw new Error(`@supabase/auth-js: Invalid SIWE message field \"resources\". Every resource must be a valid string. Provided value: ${resource}`);\n            content += `\\n- ${resource}`;\n        }\n        suffix += content;\n    }\n    return `${prefix}\\n${suffix}`;\n}\n//# sourceMappingURL=ethereum.js.map","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { isValidDomain } from './webauthn';\n/**\n * A custom Error used to return a more nuanced error detailing _why_ one of the eight documented\n * errors in the spec was raised after calling `navigator.credentials.create()` or\n * `navigator.credentials.get()`:\n *\n * - `AbortError`\n * - `ConstraintError`\n * - `InvalidStateError`\n * - `NotAllowedError`\n * - `NotSupportedError`\n * - `SecurityError`\n * - `TypeError`\n * - `UnknownError`\n *\n * Error messages were determined through investigation of the spec to determine under which\n * scenarios a given error would be raised.\n */\nexport class WebAuthnError extends Error {\n    constructor({ message, code, cause, name, }) {\n        var _a;\n        // @ts-ignore: help Rollup understand that `cause` is okay to set\n        super(message, { cause });\n        this.__isWebAuthnError = true;\n        this.name = (_a = name !== null && name !== void 0 ? name : (cause instanceof Error ? cause.name : undefined)) !== null && _a !== void 0 ? _a : 'Unknown Error';\n        this.code = code;\n    }\n}\n/**\n * Error class for unknown WebAuthn errors.\n * Wraps unexpected errors that don't match known WebAuthn error conditions.\n */\nexport class WebAuthnUnknownError extends WebAuthnError {\n    constructor(message, originalError) {\n        super({\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: originalError,\n            message,\n        });\n        this.name = 'WebAuthnUnknownError';\n        this.originalError = originalError;\n    }\n}\n/**\n * Type guard to check if an error is a WebAuthnError.\n * @param {unknown} error - The error to check\n * @returns {boolean} True if the error is a WebAuthnError\n */\nexport function isWebAuthnError(error) {\n    return typeof error === 'object' && error !== null && '__isWebAuthnError' in error;\n}\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.create()`.\n * Maps browser errors to specific WebAuthn error codes for better debugging.\n * @param {Object} params - Error identification parameters\n * @param {Error} params.error - The error thrown by the browser\n * @param {CredentialCreationOptions} params.options - The options passed to credentials.create()\n * @returns {WebAuthnError} A WebAuthnError with a specific error code\n * @see {@link https://w3c.github.io/webauthn/#sctn-createCredential W3C WebAuthn Spec - Create Credential}\n */\nexport function identifyRegistrationError({ error, options, }) {\n    var _a, _b, _c;\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n            return new WebAuthnError({\n                message: 'Registration ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'ConstraintError') {\n        if (((_a = publicKey.authenticatorSelection) === null || _a === void 0 ? void 0 : _a.requireResidentKey) === true) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 4)\n            return new WebAuthnError({\n                message: 'Discoverable credentials were required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',\n                cause: error,\n            });\n        }\n        else if (\n        // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024\n        options.mediation === 'conditional' &&\n            ((_b = publicKey.authenticatorSelection) === null || _b === void 0 ? void 0 : _b.userVerification) === 'required') {\n            // https://w3c.github.io/webauthn/#sctn-createCredential (Step 22.4)\n            return new WebAuthnError({\n                message: 'User verification was required during automatic registration but it could not be performed',\n                code: 'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',\n                cause: error,\n            });\n        }\n        else if (((_c = publicKey.authenticatorSelection) === null || _c === void 0 ? void 0 : _c.userVerification) === 'required') {\n            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 5)\n            return new WebAuthnError({\n                message: 'User verification was required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'InvalidStateError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 20)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 3)\n        return new WebAuthnError({\n            message: 'The authenticator was previously registered',\n            code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotAllowedError') {\n        /**\n         * Pass the error directly through. Platforms are overloading this error beyond what the spec\n         * defines and we don't want to overwrite potentially useful error messages.\n         */\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotSupportedError') {\n        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter((param) => param.type === 'public-key');\n        if (validPubKeyCredParams.length === 0) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 10)\n            return new WebAuthnError({\n                message: 'No entry in pubKeyCredParams was of type \"public-key\"',\n                code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',\n                cause: error,\n            });\n        }\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 2)\n        return new WebAuthnError({\n            message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',\n            code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 7)\n            return new WebAuthnError({\n                message: `${window.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rp.id !== effectiveDomain) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 8)\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rp.id}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'TypeError') {\n        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 5)\n            return new WebAuthnError({\n                message: 'User ID was not between 1 and 64 characters',\n                code: 'ERROR_INVALID_USER_ID_LENGTH',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 1)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 8)\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new credential',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return new WebAuthnError({\n        message: 'a Non-Webauthn related error has occurred',\n        code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n        cause: error,\n    });\n}\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.get()`.\n * Maps browser errors to specific WebAuthn error codes for better debugging.\n * @param {Object} params - Error identification parameters\n * @param {Error} params.error - The error thrown by the browser\n * @param {CredentialRequestOptions} params.options - The options passed to credentials.get()\n * @returns {WebAuthnError} A WebAuthnError with a specific error code\n * @see {@link https://w3c.github.io/webauthn/#sctn-getAssertion W3C WebAuthn Spec - Get Assertion}\n */\nexport function identifyAuthenticationError({ error, options, }) {\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n            return new WebAuthnError({\n                message: 'Authentication ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'NotAllowedError') {\n        /**\n         * Pass the error directly through. Platforms are overloading this error beyond what the spec\n         * defines and we don't want to overwrite potentially useful error messages.\n         */\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 5)\n            return new WebAuthnError({\n                message: `${window.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rpId !== effectiveDomain) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 6)\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rpId}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 1)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 12)\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new assertion signature',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return new WebAuthnError({\n        message: 'a Non-Webauthn related error has occurred',\n        code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n        cause: error,\n    });\n}\n//# sourceMappingURL=webauthn.errors.js.map","import { __rest } from \"tslib\";\nimport { base64UrlToUint8Array, bytesToBase64URL } from './base64url';\nimport { AuthError, AuthUnknownError, isAuthError } from './errors';\nimport { isBrowser } from './helpers';\nimport { identifyAuthenticationError, identifyRegistrationError, isWebAuthnError, WebAuthnError, WebAuthnUnknownError, } from './webauthn.errors';\nexport { WebAuthnError, isWebAuthnError, identifyRegistrationError, identifyAuthenticationError };\n/**\n * WebAuthn abort service to manage ceremony cancellation.\n * Ensures only one WebAuthn ceremony is active at a time to prevent \"operation already in progress\" errors.\n *\n * @experimental This class is experimental and may change in future releases\n * @see {@link https://w3c.github.io/webauthn/#sctn-automation-webdriver-capability W3C WebAuthn Spec - Aborting Ceremonies}\n */\nexport class WebAuthnAbortService {\n    /**\n     * Create an abort signal for a new WebAuthn operation.\n     * Automatically cancels any existing operation.\n     *\n     * @returns {AbortSignal} Signal to pass to navigator.credentials.create() or .get()\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal MDN - AbortSignal}\n     */\n    createNewAbortSignal() {\n        // Abort any existing calls to navigator.credentials.create() or navigator.credentials.get()\n        if (this.controller) {\n            const abortError = new Error('Cancelling existing WebAuthn API call for new one');\n            abortError.name = 'AbortError';\n            this.controller.abort(abortError);\n        }\n        const newController = new AbortController();\n        this.controller = newController;\n        return newController.signal;\n    }\n    /**\n     * Manually cancel the current WebAuthn operation.\n     * Useful for cleaning up when user cancels or navigates away.\n     *\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort MDN - AbortController.abort}\n     */\n    cancelCeremony() {\n        if (this.controller) {\n            const abortError = new Error('Manually cancelling existing WebAuthn API call');\n            abortError.name = 'AbortError';\n            this.controller.abort(abortError);\n            this.controller = undefined;\n        }\n    }\n}\n/**\n * Singleton instance to ensure only one WebAuthn ceremony is active at a time.\n * This prevents \"operation already in progress\" errors when retrying WebAuthn operations.\n *\n * @experimental This instance is experimental and may change in future releases\n */\nexport const webAuthnAbortService = new WebAuthnAbortService();\n/**\n * Convert base64url encoded strings in WebAuthn credential creation options to ArrayBuffers\n * as required by the WebAuthn browser API.\n * Supports both native WebAuthn Level 3 parseCreationOptionsFromJSON and manual fallback.\n *\n * @param {ServerCredentialCreationOptions} options - JSON options from server with base64url encoded fields\n * @returns {PublicKeyCredentialCreationOptionsFuture} Options ready for navigator.credentials.create()\n * @see {@link https://w3c.github.io/webauthn/#sctn-parseCreationOptionsFromJSON W3C WebAuthn Spec - parseCreationOptionsFromJSON}\n */\nexport function deserializeCredentialCreationOptions(options) {\n    if (!options) {\n        throw new Error('Credential creation options are required');\n    }\n    // Check if the native parseCreationOptionsFromJSON method is available\n    if (typeof PublicKeyCredential !== 'undefined' &&\n        'parseCreationOptionsFromJSON' in PublicKeyCredential &&\n        typeof PublicKeyCredential\n            .parseCreationOptionsFromJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return PublicKeyCredential.parseCreationOptionsFromJSON(\n        /** we assert the options here as typescript still doesn't know about future webauthn types */\n        options);\n    }\n    // Fallback to manual parsing for browsers that don't support the native method\n    // Destructure to separate fields that need transformation\n    const { challenge: challengeStr, user: userOpts, excludeCredentials } = options, restOptions = __rest(options\n    // Convert challenge from base64url to ArrayBuffer\n    , [\"challenge\", \"user\", \"excludeCredentials\"]);\n    // Convert challenge from base64url to ArrayBuffer\n    const challenge = base64UrlToUint8Array(challengeStr).buffer;\n    // Convert user.id from base64url to ArrayBuffer\n    const user = Object.assign(Object.assign({}, userOpts), { id: base64UrlToUint8Array(userOpts.id).buffer });\n    // Build the result object\n    const result = Object.assign(Object.assign({}, restOptions), { challenge,\n        user });\n    // Only add excludeCredentials if it exists\n    if (excludeCredentials && excludeCredentials.length > 0) {\n        result.excludeCredentials = new Array(excludeCredentials.length);\n        for (let i = 0; i < excludeCredentials.length; i++) {\n            const cred = excludeCredentials[i];\n            result.excludeCredentials[i] = Object.assign(Object.assign({}, cred), { id: base64UrlToUint8Array(cred.id).buffer, type: cred.type || 'public-key', \n                // Cast transports to handle future transport types like \"cable\"\n                transports: cred.transports });\n        }\n    }\n    return result;\n}\n/**\n * Convert base64url encoded strings in WebAuthn credential request options to ArrayBuffers\n * as required by the WebAuthn browser API.\n * Supports both native WebAuthn Level 3 parseRequestOptionsFromJSON and manual fallback.\n *\n * @param {ServerCredentialRequestOptions} options - JSON options from server with base64url encoded fields\n * @returns {PublicKeyCredentialRequestOptionsFuture} Options ready for navigator.credentials.get()\n * @see {@link https://w3c.github.io/webauthn/#sctn-parseRequestOptionsFromJSON W3C WebAuthn Spec - parseRequestOptionsFromJSON}\n */\nexport function deserializeCredentialRequestOptions(options) {\n    if (!options) {\n        throw new Error('Credential request options are required');\n    }\n    // Check if the native parseRequestOptionsFromJSON method is available\n    if (typeof PublicKeyCredential !== 'undefined' &&\n        'parseRequestOptionsFromJSON' in PublicKeyCredential &&\n        typeof PublicKeyCredential\n            .parseRequestOptionsFromJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return PublicKeyCredential.parseRequestOptionsFromJSON(options);\n    }\n    // Fallback to manual parsing for browsers that don't support the native method\n    // Destructure to separate fields that need transformation\n    const { challenge: challengeStr, allowCredentials } = options, restOptions = __rest(options\n    // Convert challenge from base64url to ArrayBuffer\n    , [\"challenge\", \"allowCredentials\"]);\n    // Convert challenge from base64url to ArrayBuffer\n    const challenge = base64UrlToUint8Array(challengeStr).buffer;\n    // Build the result object\n    const result = Object.assign(Object.assign({}, restOptions), { challenge });\n    // Only add allowCredentials if it exists\n    if (allowCredentials && allowCredentials.length > 0) {\n        result.allowCredentials = new Array(allowCredentials.length);\n        for (let i = 0; i < allowCredentials.length; i++) {\n            const cred = allowCredentials[i];\n            result.allowCredentials[i] = Object.assign(Object.assign({}, cred), { id: base64UrlToUint8Array(cred.id).buffer, type: cred.type || 'public-key', \n                // Cast transports to handle future transport types like \"cable\"\n                transports: cred.transports });\n        }\n    }\n    return result;\n}\n/**\n * Convert a registration/enrollment credential response to server format.\n * Serializes binary fields to base64url for JSON transmission.\n * Supports both native WebAuthn Level 3 toJSON and manual fallback.\n *\n * @param {RegistrationCredential} credential - Credential from navigator.credentials.create()\n * @returns {RegistrationResponseJSON} JSON-serializable credential for server\n * @see {@link https://w3c.github.io/webauthn/#dom-publickeycredential-tojson W3C WebAuthn Spec - toJSON}\n */\nexport function serializeCredentialCreationResponse(credential) {\n    var _a;\n    // Check if the credential instance has the toJSON method\n    if ('toJSON' in credential && typeof credential.toJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return credential.toJSON();\n    }\n    const credentialWithAttachment = credential;\n    return {\n        id: credential.id,\n        rawId: credential.id,\n        response: {\n            attestationObject: bytesToBase64URL(new Uint8Array(credential.response.attestationObject)),\n            clientDataJSON: bytesToBase64URL(new Uint8Array(credential.response.clientDataJSON)),\n        },\n        type: 'public-key',\n        clientExtensionResults: credential.getClientExtensionResults(),\n        // Convert null to undefined and cast to AuthenticatorAttachment type\n        authenticatorAttachment: ((_a = credentialWithAttachment.authenticatorAttachment) !== null && _a !== void 0 ? _a : undefined),\n    };\n}\n/**\n * Convert an authentication/verification credential response to server format.\n * Serializes binary fields to base64url for JSON transmission.\n * Supports both native WebAuthn Level 3 toJSON and manual fallback.\n *\n * @param {AuthenticationCredential} credential - Credential from navigator.credentials.get()\n * @returns {AuthenticationResponseJSON} JSON-serializable credential for server\n * @see {@link https://w3c.github.io/webauthn/#dom-publickeycredential-tojson W3C WebAuthn Spec - toJSON}\n */\nexport function serializeCredentialRequestResponse(credential) {\n    var _a;\n    // Check if the credential instance has the toJSON method\n    if ('toJSON' in credential && typeof credential.toJSON === 'function') {\n        // Use the native WebAuthn Level 3 method\n        return credential.toJSON();\n    }\n    // Fallback to manual conversion for browsers that don't support toJSON\n    // Access authenticatorAttachment via type assertion to handle TypeScript version differences\n    // @simplewebauthn/types includes this property but base TypeScript 4.7.4 doesn't\n    const credentialWithAttachment = credential;\n    const clientExtensionResults = credential.getClientExtensionResults();\n    const assertionResponse = credential.response;\n    return {\n        id: credential.id,\n        rawId: credential.id, // W3C spec expects rawId to match id for JSON format\n        response: {\n            authenticatorData: bytesToBase64URL(new Uint8Array(assertionResponse.authenticatorData)),\n            clientDataJSON: bytesToBase64URL(new Uint8Array(assertionResponse.clientDataJSON)),\n            signature: bytesToBase64URL(new Uint8Array(assertionResponse.signature)),\n            userHandle: assertionResponse.userHandle\n                ? bytesToBase64URL(new Uint8Array(assertionResponse.userHandle))\n                : undefined,\n        },\n        type: 'public-key',\n        clientExtensionResults,\n        // Convert null to undefined and cast to AuthenticatorAttachment type\n        authenticatorAttachment: ((_a = credentialWithAttachment.authenticatorAttachment) !== null && _a !== void 0 ? _a : undefined),\n    };\n}\n/**\n * A simple test to determine if a hostname is a properly-formatted domain name.\n * Considers localhost valid for development environments.\n *\n * A \"valid domain\" is defined here: https://url.spec.whatwg.org/#valid-domain\n *\n * Regex sourced from here:\n * https://www.oreilly.com/library/view/regular-expressions-cookbook/9781449327453/ch08s15.html\n *\n * @param {string} hostname - The hostname to validate\n * @returns {boolean} True if valid domain or localhost\n * @see {@link https://url.spec.whatwg.org/#valid-domain WHATWG URL Spec - Valid Domain}\n */\nexport function isValidDomain(hostname) {\n    return (\n    // Consider localhost valid as well since it's okay wrt Secure Contexts\n    hostname === 'localhost' || /^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$/i.test(hostname));\n}\n/**\n * Determine if the browser is capable of WebAuthn.\n * Checks for necessary Web APIs: PublicKeyCredential and Credential Management.\n *\n * @returns {boolean} True if browser supports WebAuthn\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredential#browser_compatibility MDN - PublicKeyCredential Browser Compatibility}\n */\nfunction browserSupportsWebAuthn() {\n    var _a, _b;\n    return !!(isBrowser() &&\n        'PublicKeyCredential' in window &&\n        window.PublicKeyCredential &&\n        'credentials' in navigator &&\n        typeof ((_a = navigator === null || navigator === void 0 ? void 0 : navigator.credentials) === null || _a === void 0 ? void 0 : _a.create) === 'function' &&\n        typeof ((_b = navigator === null || navigator === void 0 ? void 0 : navigator.credentials) === null || _b === void 0 ? void 0 : _b.get) === 'function');\n}\n/**\n * Create a WebAuthn credential using the browser's credentials API.\n * Wraps navigator.credentials.create() with error handling.\n *\n * @param {CredentialCreationOptions} options - Options including publicKey parameters\n * @returns {Promise<RequestResult<RegistrationCredential, WebAuthnError>>} Created credential or error\n * @see {@link https://w3c.github.io/webauthn/#sctn-createCredential W3C WebAuthn Spec - Create Credential}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/create MDN - credentials.create}\n */\nexport async function createCredential(options) {\n    try {\n        const response = await navigator.credentials.create(\n        /** we assert the type here until typescript types are updated */\n        options);\n        if (!response) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Empty credential response', response),\n            };\n        }\n        if (!(response instanceof PublicKeyCredential)) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Browser returned unexpected credential type', response),\n            };\n        }\n        return { data: response, error: null };\n    }\n    catch (err) {\n        return {\n            data: null,\n            error: identifyRegistrationError({\n                error: err,\n                options,\n            }),\n        };\n    }\n}\n/**\n * Get a WebAuthn credential using the browser's credentials API.\n * Wraps navigator.credentials.get() with error handling.\n *\n * @param {CredentialRequestOptions} options - Options including publicKey parameters\n * @returns {Promise<RequestResult<AuthenticationCredential, WebAuthnError>>} Retrieved credential or error\n * @see {@link https://w3c.github.io/webauthn/#sctn-getAssertion W3C WebAuthn Spec - Get Assertion}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/get MDN - credentials.get}\n */\nexport async function getCredential(options) {\n    try {\n        const response = await navigator.credentials.get(\n        /** we assert the type here until typescript types are updated */\n        options);\n        if (!response) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Empty credential response', response),\n            };\n        }\n        if (!(response instanceof PublicKeyCredential)) {\n            return {\n                data: null,\n                error: new WebAuthnUnknownError('Browser returned unexpected credential type', response),\n            };\n        }\n        return { data: response, error: null };\n    }\n    catch (err) {\n        return {\n            data: null,\n            error: identifyAuthenticationError({\n                error: err,\n                options,\n            }),\n        };\n    }\n}\nexport const DEFAULT_CREATION_OPTIONS = {\n    hints: ['security-key'],\n    authenticatorSelection: {\n        authenticatorAttachment: 'cross-platform',\n        requireResidentKey: false,\n        /** set to preferred because older yubikeys don't have PIN/Biometric */\n        userVerification: 'preferred',\n        residentKey: 'discouraged',\n    },\n    attestation: 'direct',\n};\nexport const DEFAULT_REQUEST_OPTIONS = {\n    /** set to preferred because older yubikeys don't have PIN/Biometric */\n    userVerification: 'preferred',\n    hints: ['security-key'],\n    attestation: 'direct',\n};\nfunction deepMerge(...sources) {\n    const isObject = (val) => val !== null && typeof val === 'object' && !Array.isArray(val);\n    const isArrayBufferLike = (val) => val instanceof ArrayBuffer || ArrayBuffer.isView(val);\n    const result = {};\n    for (const source of sources) {\n        if (!source)\n            continue;\n        for (const key in source) {\n            const value = source[key];\n            if (value === undefined)\n                continue;\n            if (Array.isArray(value)) {\n                // preserve array reference, including unions like AuthenticatorTransport[]\n                result[key] = value;\n            }\n            else if (isArrayBufferLike(value)) {\n                result[key] = value;\n            }\n            else if (isObject(value)) {\n                const existing = result[key];\n                if (isObject(existing)) {\n                    result[key] = deepMerge(existing, value);\n                }\n                else {\n                    result[key] = deepMerge(value);\n                }\n            }\n            else {\n                result[key] = value;\n            }\n        }\n    }\n    return result;\n}\n/**\n * Merges WebAuthn credential creation options with overrides.\n * Sets sensible defaults for authenticator selection and extensions.\n *\n * @param {PublicKeyCredentialCreationOptionsFuture} baseOptions - The base options from the server\n * @param {PublicKeyCredentialCreationOptionsFuture} overrides - Optional overrides to apply\n * @param {string} friendlyName - Optional friendly name for the credential\n * @returns {PublicKeyCredentialCreationOptionsFuture} Merged credential creation options\n * @see {@link https://w3c.github.io/webauthn/#dictdef-authenticatorselectioncriteria W3C WebAuthn Spec - AuthenticatorSelectionCriteria}\n */\nexport function mergeCredentialCreationOptions(baseOptions, overrides) {\n    return deepMerge(DEFAULT_CREATION_OPTIONS, baseOptions, overrides || {});\n}\n/**\n * Merges WebAuthn credential request options with overrides.\n * Sets sensible defaults for user verification and hints.\n *\n * @param {PublicKeyCredentialRequestOptionsFuture} baseOptions - The base options from the server\n * @param {PublicKeyCredentialRequestOptionsFuture} overrides - Optional overrides to apply\n * @returns {PublicKeyCredentialRequestOptionsFuture} Merged credential request options\n * @see {@link https://w3c.github.io/webauthn/#dictdef-publickeycredentialrequestoptions W3C WebAuthn Spec - PublicKeyCredentialRequestOptions}\n */\nexport function mergeCredentialRequestOptions(baseOptions, overrides) {\n    return deepMerge(DEFAULT_REQUEST_OPTIONS, baseOptions, overrides || {});\n}\n/**\n * WebAuthn API wrapper for Supabase Auth.\n * Provides methods for enrolling, challenging, verifying, authenticating, and registering WebAuthn credentials.\n *\n * @experimental This API is experimental and may change in future releases\n * @see {@link https://w3c.github.io/webauthn/ W3C WebAuthn Specification}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API MDN - Web Authentication API}\n */\nexport class WebAuthnApi {\n    constructor(client) {\n        this.client = client;\n        // Bind all methods so they can be destructured\n        this.enroll = this._enroll.bind(this);\n        this.challenge = this._challenge.bind(this);\n        this.verify = this._verify.bind(this);\n        this.authenticate = this._authenticate.bind(this);\n        this.register = this._register.bind(this);\n    }\n    /**\n     * Enroll a new WebAuthn factor.\n     * Creates an unverified WebAuthn factor that must be verified with a credential.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Omit<MFAEnrollWebauthnParams, 'factorType'>} params - Enrollment parameters (friendlyName required)\n     * @returns {Promise<AuthMFAEnrollWebauthnResponse>} Enrolled factor details or error\n     * @see {@link https://w3c.github.io/webauthn/#sctn-registering-a-new-credential W3C WebAuthn Spec - Registering a New Credential}\n     */\n    async _enroll(params) {\n        return this.client.mfa.enroll(Object.assign(Object.assign({}, params), { factorType: 'webauthn' }));\n    }\n    /**\n     * Challenge for WebAuthn credential creation or authentication.\n     * Combines server challenge with browser credential operations.\n     * Handles both registration (create) and authentication (request) flows.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {MFAChallengeWebauthnParams & { friendlyName?: string; signal?: AbortSignal }} params - Challenge parameters including factorId\n     * @param {Object} overrides - Allows you to override the parameters passed to navigator.credentials\n     * @param {PublicKeyCredentialCreationOptionsFuture} overrides.create - Override options for credential creation\n     * @param {PublicKeyCredentialRequestOptionsFuture} overrides.request - Override options for credential request\n     * @returns {Promise<RequestResult>} Challenge response with credential or error\n     * @see {@link https://w3c.github.io/webauthn/#sctn-credential-creation W3C WebAuthn Spec - Credential Creation}\n     * @see {@link https://w3c.github.io/webauthn/#sctn-verifying-assertion W3C WebAuthn Spec - Verifying Assertion}\n     */\n    async _challenge({ factorId, webauthn, friendlyName, signal, }, overrides) {\n        try {\n            // Get challenge from server using the client's MFA methods\n            const { data: challengeResponse, error: challengeError } = await this.client.mfa.challenge({\n                factorId,\n                webauthn,\n            });\n            if (!challengeResponse) {\n                return { data: null, error: challengeError };\n            }\n            const abortSignal = signal !== null && signal !== void 0 ? signal : webAuthnAbortService.createNewAbortSignal();\n            /** webauthn will fail if either of the name/displayname are blank */\n            if (challengeResponse.webauthn.type === 'create') {\n                const { user } = challengeResponse.webauthn.credential_options.publicKey;\n                if (!user.name) {\n                    user.name = `${user.id}:${friendlyName}`;\n                }\n                if (!user.displayName) {\n                    user.displayName = user.name;\n                }\n            }\n            switch (challengeResponse.webauthn.type) {\n                case 'create': {\n                    const options = mergeCredentialCreationOptions(challengeResponse.webauthn.credential_options.publicKey, overrides === null || overrides === void 0 ? void 0 : overrides.create);\n                    const { data, error } = await createCredential({\n                        publicKey: options,\n                        signal: abortSignal,\n                    });\n                    if (data) {\n                        return {\n                            data: {\n                                factorId,\n                                challengeId: challengeResponse.id,\n                                webauthn: {\n                                    type: challengeResponse.webauthn.type,\n                                    credential_response: data,\n                                },\n                            },\n                            error: null,\n                        };\n                    }\n                    return { data: null, error };\n                }\n                case 'request': {\n                    const options = mergeCredentialRequestOptions(challengeResponse.webauthn.credential_options.publicKey, overrides === null || overrides === void 0 ? void 0 : overrides.request);\n                    const { data, error } = await getCredential(Object.assign(Object.assign({}, challengeResponse.webauthn.credential_options), { publicKey: options, signal: abortSignal }));\n                    if (data) {\n                        return {\n                            data: {\n                                factorId,\n                                challengeId: challengeResponse.id,\n                                webauthn: {\n                                    type: challengeResponse.webauthn.type,\n                                    credential_response: data,\n                                },\n                            },\n                            error: null,\n                        };\n                    }\n                    return { data: null, error };\n                }\n            }\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            return {\n                data: null,\n                error: new AuthUnknownError('Unexpected error in challenge', error),\n            };\n        }\n    }\n    /**\n     * Verify a WebAuthn credential with the server.\n     * Completes the WebAuthn ceremony by sending the credential to the server for verification.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Object} params - Verification parameters\n     * @param {string} params.challengeId - ID of the challenge being verified\n     * @param {string} params.factorId - ID of the WebAuthn factor\n     * @param {MFAVerifyWebauthnParams<T>['webauthn']} params.webauthn - WebAuthn credential response\n     * @returns {Promise<AuthMFAVerifyResponse>} Verification result with session or error\n     * @see {@link https://w3c.github.io/webauthn/#sctn-verifying-assertion W3C WebAuthn Spec - Verifying an Authentication Assertion}\n     * */\n    async _verify({ challengeId, factorId, webauthn, }) {\n        return this.client.mfa.verify({\n            factorId,\n            challengeId,\n            webauthn: webauthn,\n        });\n    }\n    /**\n     * Complete WebAuthn authentication flow.\n     * Performs challenge and verification in a single operation for existing credentials.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Object} params - Authentication parameters\n     * @param {string} params.factorId - ID of the WebAuthn factor to authenticate with\n     * @param {Object} params.webauthn - WebAuthn configuration\n     * @param {string} params.webauthn.rpId - Relying Party ID (defaults to current hostname)\n     * @param {string[]} params.webauthn.rpOrigins - Allowed origins (defaults to current origin)\n     * @param {AbortSignal} params.webauthn.signal - Optional abort signal\n     * @param {PublicKeyCredentialRequestOptionsFuture} overrides - Override options for navigator.credentials.get\n     * @returns {Promise<RequestResult<AuthMFAVerifyResponseData, WebAuthnError | AuthError>>} Authentication result\n     * @see {@link https://w3c.github.io/webauthn/#sctn-authentication W3C WebAuthn Spec - Authentication Ceremony}\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialRequestOptions MDN - PublicKeyCredentialRequestOptions}\n     */\n    async _authenticate({ factorId, webauthn: { rpId = typeof window !== 'undefined' ? window.location.hostname : undefined, rpOrigins = typeof window !== 'undefined' ? [window.location.origin] : undefined, signal, } = {}, }, overrides) {\n        if (!rpId) {\n            return {\n                data: null,\n                error: new AuthError('rpId is required for WebAuthn authentication'),\n            };\n        }\n        try {\n            if (!browserSupportsWebAuthn()) {\n                return {\n                    data: null,\n                    error: new AuthUnknownError('Browser does not support WebAuthn', null),\n                };\n            }\n            // Get challenge and credential\n            const { data: challengeResponse, error: challengeError } = await this.challenge({\n                factorId,\n                webauthn: { rpId, rpOrigins },\n                signal,\n            }, { request: overrides });\n            if (!challengeResponse) {\n                return { data: null, error: challengeError };\n            }\n            const { webauthn } = challengeResponse;\n            // Verify credential\n            return this._verify({\n                factorId,\n                challengeId: challengeResponse.challengeId,\n                webauthn: {\n                    type: webauthn.type,\n                    rpId,\n                    rpOrigins,\n                    credential_response: webauthn.credential_response,\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            return {\n                data: null,\n                error: new AuthUnknownError('Unexpected error in authenticate', error),\n            };\n        }\n    }\n    /**\n     * Complete WebAuthn registration flow.\n     * Performs enrollment, challenge, and verification in a single operation for new credentials.\n     *\n     * @experimental This method is experimental and may change in future releases\n     * @param {Object} params - Registration parameters\n     * @param {string} params.friendlyName - User-friendly name for the credential\n     * @param {string} params.rpId - Relying Party ID (defaults to current hostname)\n     * @param {string[]} params.rpOrigins - Allowed origins (defaults to current origin)\n     * @param {AbortSignal} params.signal - Optional abort signal\n     * @param {PublicKeyCredentialCreationOptionsFuture} overrides - Override options for navigator.credentials.create\n     * @returns {Promise<RequestResult<AuthMFAVerifyResponseData, WebAuthnError | AuthError>>} Registration result\n     * @see {@link https://w3c.github.io/webauthn/#sctn-registering-a-new-credential W3C WebAuthn Spec - Registration Ceremony}\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialCreationOptions MDN - PublicKeyCredentialCreationOptions}\n     */\n    async _register({ friendlyName, webauthn: { rpId = typeof window !== 'undefined' ? window.location.hostname : undefined, rpOrigins = typeof window !== 'undefined' ? [window.location.origin] : undefined, signal, } = {}, }, overrides) {\n        if (!rpId) {\n            return {\n                data: null,\n                error: new AuthError('rpId is required for WebAuthn registration'),\n            };\n        }\n        try {\n            if (!browserSupportsWebAuthn()) {\n                return {\n                    data: null,\n                    error: new AuthUnknownError('Browser does not support WebAuthn', null),\n                };\n            }\n            // Enroll factor\n            const { data: factor, error: enrollError } = await this._enroll({\n                friendlyName,\n            });\n            if (!factor) {\n                await this.client.mfa\n                    .listFactors()\n                    .then((factors) => {\n                    var _a;\n                    return (_a = factors.data) === null || _a === void 0 ? void 0 : _a.all.find((v) => v.factor_type === 'webauthn' &&\n                        v.friendly_name === friendlyName &&\n                        v.status !== 'unverified');\n                })\n                    .then((factor) => (factor ? this.client.mfa.unenroll({ factorId: factor === null || factor === void 0 ? void 0 : factor.id }) : void 0));\n                return { data: null, error: enrollError };\n            }\n            // Get challenge and create credential\n            const { data: challengeResponse, error: challengeError } = await this._challenge({\n                factorId: factor.id,\n                friendlyName: factor.friendly_name,\n                webauthn: { rpId, rpOrigins },\n                signal,\n            }, {\n                create: overrides,\n            });\n            if (!challengeResponse) {\n                return { data: null, error: challengeError };\n            }\n            return this._verify({\n                factorId: factor.id,\n                challengeId: challengeResponse.challengeId,\n                webauthn: {\n                    rpId,\n                    rpOrigins,\n                    type: challengeResponse.webauthn.type,\n                    credential_response: challengeResponse.webauthn.credential_response,\n                },\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return { data: null, error };\n            }\n            return {\n                data: null,\n                error: new AuthUnknownError('Unexpected error in register', error),\n            };\n        }\n    }\n}\n//# sourceMappingURL=webauthn.js.map","import GoTrueAdminApi from './GoTrueAdminApi';\nimport { AUTO_REFRESH_TICK_DURATION_MS, AUTO_REFRESH_TICK_THRESHOLD, DEFAULT_HEADERS, EXPIRY_MARGIN_MS, GOTRUE_URL, JWKS_TTL, STORAGE_KEY, } from './lib/constants';\nimport { AuthImplicitGrantRedirectError, AuthInvalidCredentialsError, AuthInvalidJwtError, AuthInvalidTokenResponseError, AuthPKCEGrantCodeExchangeError, AuthSessionMissingError, AuthUnknownError, isAuthApiError, isAuthError, isAuthImplicitGrantRedirectError, isAuthRetryableFetchError, isAuthSessionMissingError, } from './lib/errors';\nimport { _request, _sessionResponse, _sessionResponsePassword, _ssoResponse, _userResponse, } from './lib/fetch';\nimport { decodeJWT, deepClone, Deferred, generateCallbackId, getAlgorithm, getCodeChallengeAndMethod, getItemAsync, insecureUserWarningProxy, isBrowser, parseParametersFromURL, removeItemAsync, resolveFetch, retryable, setItemAsync, sleep, supportsLocalStorage, userNotAvailableProxy, validateExp, } from './lib/helpers';\nimport { memoryLocalStorageAdapter } from './lib/local-storage';\nimport { LockAcquireTimeoutError, navigatorLock } from './lib/locks';\nimport { polyfillGlobalThis } from './lib/polyfills';\nimport { version } from './lib/version';\nimport { bytesToBase64URL, stringToUint8Array } from './lib/base64url';\nimport { createSiweMessage, fromHex, getAddress, toHex, } from './lib/web3/ethereum';\nimport { deserializeCredentialCreationOptions, deserializeCredentialRequestOptions, serializeCredentialCreationResponse, serializeCredentialRequestResponse, WebAuthnApi, } from './lib/webauthn';\npolyfillGlobalThis(); // Make \"globalThis\" available\nconst DEFAULT_OPTIONS = {\n    url: GOTRUE_URL,\n    storageKey: STORAGE_KEY,\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n    headers: DEFAULT_HEADERS,\n    flowType: 'implicit',\n    debug: false,\n    hasCustomAuthorizationHeader: false,\n    throwOnError: false,\n};\nasync function lockNoOp(name, acquireTimeout, fn) {\n    return await fn();\n}\n/**\n * Caches JWKS values for all clients created in the same environment. This is\n * especially useful for shared-memory execution environments such as Vercel's\n * Fluid Compute, AWS Lambda or Supabase's Edge Functions. Regardless of how\n * many clients are created, if they share the same storage key they will use\n * the same JWKS cache, significantly speeding up getClaims() with asymmetric\n * JWTs.\n */\nconst GLOBAL_JWKS = {};\nclass GoTrueClient {\n    /**\n     * The JWKS used for verifying asymmetric JWTs\n     */\n    get jwks() {\n        var _a, _b;\n        return (_b = (_a = GLOBAL_JWKS[this.storageKey]) === null || _a === void 0 ? void 0 : _a.jwks) !== null && _b !== void 0 ? _b : { keys: [] };\n    }\n    set jwks(value) {\n        GLOBAL_JWKS[this.storageKey] = Object.assign(Object.assign({}, GLOBAL_JWKS[this.storageKey]), { jwks: value });\n    }\n    get jwks_cached_at() {\n        var _a, _b;\n        return (_b = (_a = GLOBAL_JWKS[this.storageKey]) === null || _a === void 0 ? void 0 : _a.cachedAt) !== null && _b !== void 0 ? _b : Number.MIN_SAFE_INTEGER;\n    }\n    set jwks_cached_at(value) {\n        GLOBAL_JWKS[this.storageKey] = Object.assign(Object.assign({}, GLOBAL_JWKS[this.storageKey]), { cachedAt: value });\n    }\n    /**\n     * Create a new client for use in the browser.\n     *\n     * @example\n     * ```ts\n     * import { GoTrueClient } from '@supabase/auth-js'\n     *\n     * const auth = new GoTrueClient({\n     *   url: 'https://xyzcompany.supabase.co/auth/v1',\n     *   headers: { apikey: 'public-anon-key' },\n     *   storageKey: 'supabase-auth',\n     * })\n     * ```\n     */\n    constructor(options) {\n        var _a, _b, _c;\n        /**\n         * @experimental\n         */\n        this.userStorage = null;\n        this.memoryStorage = null;\n        this.stateChangeEmitters = new Map();\n        this.autoRefreshTicker = null;\n        this.visibilityChangedCallback = null;\n        this.refreshingDeferred = null;\n        /**\n         * Keeps track of the async client initialization.\n         * When null or not yet resolved the auth state is `unknown`\n         * Once resolved the auth state is known and it's safe to call any further client methods.\n         * Keep extra care to never reject or throw uncaught errors\n         */\n        this.initializePromise = null;\n        this.detectSessionInUrl = true;\n        this.hasCustomAuthorizationHeader = false;\n        this.suppressGetSessionWarning = false;\n        this.lockAcquired = false;\n        this.pendingInLock = [];\n        /**\n         * Used to broadcast state change events to other tabs listening.\n         */\n        this.broadcastChannel = null;\n        this.logger = console.log;\n        const settings = Object.assign(Object.assign({}, DEFAULT_OPTIONS), options);\n        this.storageKey = settings.storageKey;\n        this.instanceID = (_a = GoTrueClient.nextInstanceID[this.storageKey]) !== null && _a !== void 0 ? _a : 0;\n        GoTrueClient.nextInstanceID[this.storageKey] = this.instanceID + 1;\n        this.logDebugMessages = !!settings.debug;\n        if (typeof settings.debug === 'function') {\n            this.logger = settings.debug;\n        }\n        if (this.instanceID > 0 && isBrowser()) {\n            const message = `${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;\n            console.warn(message);\n            if (this.logDebugMessages) {\n                console.trace(message);\n            }\n        }\n        this.persistSession = settings.persistSession;\n        this.autoRefreshToken = settings.autoRefreshToken;\n        this.admin = new GoTrueAdminApi({\n            url: settings.url,\n            headers: settings.headers,\n            fetch: settings.fetch,\n        });\n        this.url = settings.url;\n        this.headers = settings.headers;\n        this.fetch = resolveFetch(settings.fetch);\n        this.lock = settings.lock || lockNoOp;\n        this.detectSessionInUrl = settings.detectSessionInUrl;\n        this.flowType = settings.flowType;\n        this.hasCustomAuthorizationHeader = settings.hasCustomAuthorizationHeader;\n        this.throwOnError = settings.throwOnError;\n        if (settings.lock) {\n            this.lock = settings.lock;\n        }\n        else if (isBrowser() && ((_b = globalThis === null || globalThis === void 0 ? void 0 : globalThis.navigator) === null || _b === void 0 ? void 0 : _b.locks)) {\n            this.lock = navigatorLock;\n        }\n        else {\n            this.lock = lockNoOp;\n        }\n        if (!this.jwks) {\n            this.jwks = { keys: [] };\n            this.jwks_cached_at = Number.MIN_SAFE_INTEGER;\n        }\n        this.mfa = {\n            verify: this._verify.bind(this),\n            enroll: this._enroll.bind(this),\n            unenroll: this._unenroll.bind(this),\n            challenge: this._challenge.bind(this),\n            listFactors: this._listFactors.bind(this),\n            challengeAndVerify: this._challengeAndVerify.bind(this),\n            getAuthenticatorAssuranceLevel: this._getAuthenticatorAssuranceLevel.bind(this),\n            webauthn: new WebAuthnApi(this),\n        };\n        this.oauth = {\n            getAuthorizationDetails: this._getAuthorizationDetails.bind(this),\n            approveAuthorization: this._approveAuthorization.bind(this),\n            denyAuthorization: this._denyAuthorization.bind(this),\n            listGrants: this._listOAuthGrants.bind(this),\n            revokeGrant: this._revokeOAuthGrant.bind(this),\n        };\n        if (this.persistSession) {\n            if (settings.storage) {\n                this.storage = settings.storage;\n            }\n            else {\n                if (supportsLocalStorage()) {\n                    this.storage = globalThis.localStorage;\n                }\n                else {\n                    this.memoryStorage = {};\n                    this.storage = memoryLocalStorageAdapter(this.memoryStorage);\n                }\n            }\n            if (settings.userStorage) {\n                this.userStorage = settings.userStorage;\n            }\n        }\n        else {\n            this.memoryStorage = {};\n            this.storage = memoryLocalStorageAdapter(this.memoryStorage);\n        }\n        if (isBrowser() && globalThis.BroadcastChannel && this.persistSession && this.storageKey) {\n            try {\n                this.broadcastChannel = new globalThis.BroadcastChannel(this.storageKey);\n            }\n            catch (e) {\n                console.error('Failed to create a new BroadcastChannel, multi-tab state changes will not be available', e);\n            }\n            (_c = this.broadcastChannel) === null || _c === void 0 ? void 0 : _c.addEventListener('message', async (event) => {\n                this._debug('received broadcast notification from other tab or client', event);\n                await this._notifyAllSubscribers(event.data.event, event.data.session, false); // broadcast = false so we don't get an endless loop of messages\n            });\n        }\n        this.initialize();\n    }\n    /**\n     * Returns whether error throwing mode is enabled for this client.\n     */\n    isThrowOnErrorEnabled() {\n        return this.throwOnError;\n    }\n    /**\n     * Centralizes return handling with optional error throwing. When `throwOnError` is enabled\n     * and the provided result contains a non-nullish error, the error is thrown instead of\n     * being returned. This ensures consistent behavior across all public API methods.\n     */\n    _returnResult(result) {\n        if (this.throwOnError && result && result.error) {\n            throw result.error;\n        }\n        return result;\n    }\n    _logPrefix() {\n        return ('GoTrueClient@' +\n            `${this.storageKey}:${this.instanceID} (${version}) ${new Date().toISOString()}`);\n    }\n    _debug(...args) {\n        if (this.logDebugMessages) {\n            this.logger(this._logPrefix(), ...args);\n        }\n        return this;\n    }\n    /**\n     * Initializes the client session either from the url or from storage.\n     * This method is automatically called when instantiating the client, but should also be called\n     * manually when checking for an error from an auth redirect (oauth, magiclink, password recovery, etc).\n     */\n    async initialize() {\n        if (this.initializePromise) {\n            return await this.initializePromise;\n        }\n        this.initializePromise = (async () => {\n            return await this._acquireLock(-1, async () => {\n                return await this._initialize();\n            });\n        })();\n        return await this.initializePromise;\n    }\n    /**\n     * IMPORTANT:\n     * 1. Never throw in this method, as it is called from the constructor\n     * 2. Never return a session from this method as it would be cached over\n     *    the whole lifetime of the client\n     */\n    async _initialize() {\n        var _a;\n        try {\n            let params = {};\n            let callbackUrlType = 'none';\n            if (isBrowser()) {\n                params = parseParametersFromURL(window.location.href);\n                if (this._isImplicitGrantCallback(params)) {\n                    callbackUrlType = 'implicit';\n                }\n                else if (await this._isPKCECallback(params)) {\n                    callbackUrlType = 'pkce';\n                }\n            }\n            /**\n             * Attempt to get the session from the URL only if these conditions are fulfilled\n             *\n             * Note: If the URL isn't one of the callback url types (implicit or pkce),\n             * then there could be an existing session so we don't want to prematurely remove it\n             */\n            if (isBrowser() && this.detectSessionInUrl && callbackUrlType !== 'none') {\n                const { data, error } = await this._getSessionFromURL(params, callbackUrlType);\n                if (error) {\n                    this._debug('#_initialize()', 'error detecting session from URL', error);\n                    if (isAuthImplicitGrantRedirectError(error)) {\n                        const errorCode = (_a = error.details) === null || _a === void 0 ? void 0 : _a.code;\n                        if (errorCode === 'identity_already_exists' ||\n                            errorCode === 'identity_not_found' ||\n                            errorCode === 'single_identity_not_deletable') {\n                            return { error };\n                        }\n                    }\n                    // failed login attempt via url,\n                    // remove old session as in verifyOtp, signUp and signInWith*\n                    await this._removeSession();\n                    return { error };\n                }\n                const { session, redirectType } = data;\n                this._debug('#_initialize()', 'detected session in URL', session, 'redirect type', redirectType);\n                await this._saveSession(session);\n                setTimeout(async () => {\n                    if (redirectType === 'recovery') {\n                        await this._notifyAllSubscribers('PASSWORD_RECOVERY', session);\n                    }\n                    else {\n                        await this._notifyAllSubscribers('SIGNED_IN', session);\n                    }\n                }, 0);\n                return { error: null };\n            }\n            // no login attempt via callback url try to recover session from storage\n            await this._recoverAndRefresh();\n            return { error: null };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ error });\n            }\n            return this._returnResult({\n                error: new AuthUnknownError('Unexpected error during initialization', error),\n            });\n        }\n        finally {\n            await this._handleVisibilityChange();\n            this._debug('#_initialize()', 'end');\n        }\n    }\n    /**\n     * Creates a new anonymous user.\n     *\n     * @returns A session where the is_anonymous claim in the access token JWT set to true\n     */\n    async signInAnonymously(credentials) {\n        var _a, _b, _c;\n        try {\n            const res = await _request(this.fetch, 'POST', `${this.url}/signup`, {\n                headers: this.headers,\n                body: {\n                    data: (_b = (_a = credentials === null || credentials === void 0 ? void 0 : credentials.options) === null || _a === void 0 ? void 0 : _a.data) !== null && _b !== void 0 ? _b : {},\n                    gotrue_meta_security: { captcha_token: (_c = credentials === null || credentials === void 0 ? void 0 : credentials.options) === null || _c === void 0 ? void 0 : _c.captchaToken },\n                },\n                xform: _sessionResponse,\n            });\n            const { data, error } = res;\n            if (error || !data) {\n                return this._returnResult({ data: { user: null, session: null }, error: error });\n            }\n            const session = data.session;\n            const user = data.user;\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Creates a new user.\n     *\n     * Be aware that if a user account exists in the system you may get back an\n     * error message that attempts to hide this information from the user.\n     * This method has support for PKCE via email signups. The PKCE flow cannot be used when autoconfirm is enabled.\n     *\n     * @returns A logged-in session if the server has \"autoconfirm\" ON\n     * @returns A user if the server has \"autoconfirm\" OFF\n     */\n    async signUp(credentials) {\n        var _a, _b, _c;\n        try {\n            let res;\n            if ('email' in credentials) {\n                const { email, password, options } = credentials;\n                let codeChallenge = null;\n                let codeChallengeMethod = null;\n                if (this.flowType === 'pkce') {\n                    ;\n                    [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n                }\n                res = await _request(this.fetch, 'POST', `${this.url}/signup`, {\n                    headers: this.headers,\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                    body: {\n                        email,\n                        password,\n                        data: (_a = options === null || options === void 0 ? void 0 : options.data) !== null && _a !== void 0 ? _a : {},\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                        code_challenge: codeChallenge,\n                        code_challenge_method: codeChallengeMethod,\n                    },\n                    xform: _sessionResponse,\n                });\n            }\n            else if ('phone' in credentials) {\n                const { phone, password, options } = credentials;\n                res = await _request(this.fetch, 'POST', `${this.url}/signup`, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        password,\n                        data: (_b = options === null || options === void 0 ? void 0 : options.data) !== null && _b !== void 0 ? _b : {},\n                        channel: (_c = options === null || options === void 0 ? void 0 : options.channel) !== null && _c !== void 0 ? _c : 'sms',\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponse,\n                });\n            }\n            else {\n                throw new AuthInvalidCredentialsError('You must provide either an email or phone number and a password');\n            }\n            const { data, error } = res;\n            if (error || !data) {\n                return this._returnResult({ data: { user: null, session: null }, error: error });\n            }\n            const session = data.session;\n            const user = data.user;\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in an existing user with an email and password or phone and password.\n     *\n     * Be aware that you may get back an error message that will not distinguish\n     * between the cases where the account does not exist or that the\n     * email/phone and password combination is wrong or that the account can only\n     * be accessed via social login.\n     */\n    async signInWithPassword(credentials) {\n        try {\n            let res;\n            if ('email' in credentials) {\n                const { email, password, options } = credentials;\n                res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=password`, {\n                    headers: this.headers,\n                    body: {\n                        email,\n                        password,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponsePassword,\n                });\n            }\n            else if ('phone' in credentials) {\n                const { phone, password, options } = credentials;\n                res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=password`, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        password,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponsePassword,\n                });\n            }\n            else {\n                throw new AuthInvalidCredentialsError('You must provide either an email or phone number and a password');\n            }\n            const { data, error } = res;\n            if (error) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            else if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({\n                data: Object.assign({ user: data.user, session: data.session }, (data.weak_password ? { weakPassword: data.weak_password } : null)),\n                error,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in an existing user via a third-party provider.\n     * This method supports the PKCE flow.\n     */\n    async signInWithOAuth(credentials) {\n        var _a, _b, _c, _d;\n        return await this._handleProviderSignIn(credentials.provider, {\n            redirectTo: (_a = credentials.options) === null || _a === void 0 ? void 0 : _a.redirectTo,\n            scopes: (_b = credentials.options) === null || _b === void 0 ? void 0 : _b.scopes,\n            queryParams: (_c = credentials.options) === null || _c === void 0 ? void 0 : _c.queryParams,\n            skipBrowserRedirect: (_d = credentials.options) === null || _d === void 0 ? void 0 : _d.skipBrowserRedirect,\n        });\n    }\n    /**\n     * Log in an existing user by exchanging an Auth Code issued during the PKCE flow.\n     */\n    async exchangeCodeForSession(authCode) {\n        await this.initializePromise;\n        return this._acquireLock(-1, async () => {\n            return this._exchangeCodeForSession(authCode);\n        });\n    }\n    /**\n     * Signs in a user by verifying a message signed by the user's private key.\n     * Supports Ethereum (via Sign-In-With-Ethereum) & Solana (Sign-In-With-Solana) standards,\n     * both of which derive from the EIP-4361 standard\n     * With slight variation on Solana's side.\n     * @reference https://eips.ethereum.org/EIPS/eip-4361\n     */\n    async signInWithWeb3(credentials) {\n        const { chain } = credentials;\n        switch (chain) {\n            case 'ethereum':\n                return await this.signInWithEthereum(credentials);\n            case 'solana':\n                return await this.signInWithSolana(credentials);\n            default:\n                throw new Error(`@supabase/auth-js: Unsupported chain \"${chain}\"`);\n        }\n    }\n    async signInWithEthereum(credentials) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n        // TODO: flatten type\n        let message;\n        let signature;\n        if ('message' in credentials) {\n            message = credentials.message;\n            signature = credentials.signature;\n        }\n        else {\n            const { chain, wallet, statement, options } = credentials;\n            let resolvedWallet;\n            if (!isBrowser()) {\n                if (typeof wallet !== 'object' || !(options === null || options === void 0 ? void 0 : options.url)) {\n                    throw new Error('@supabase/auth-js: Both wallet and url must be specified in non-browser environments.');\n                }\n                resolvedWallet = wallet;\n            }\n            else if (typeof wallet === 'object') {\n                resolvedWallet = wallet;\n            }\n            else {\n                const windowAny = window;\n                if ('ethereum' in windowAny &&\n                    typeof windowAny.ethereum === 'object' &&\n                    'request' in windowAny.ethereum &&\n                    typeof windowAny.ethereum.request === 'function') {\n                    resolvedWallet = windowAny.ethereum;\n                }\n                else {\n                    throw new Error(`@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.`);\n                }\n            }\n            const url = new URL((_a = options === null || options === void 0 ? void 0 : options.url) !== null && _a !== void 0 ? _a : window.location.href);\n            const accounts = await resolvedWallet\n                .request({\n                method: 'eth_requestAccounts',\n            })\n                .then((accs) => accs)\n                .catch(() => {\n                throw new Error(`@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid`);\n            });\n            if (!accounts || accounts.length === 0) {\n                throw new Error(`@supabase/auth-js: No accounts available. Please ensure the wallet is connected.`);\n            }\n            const address = getAddress(accounts[0]);\n            let chainId = (_b = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _b === void 0 ? void 0 : _b.chainId;\n            if (!chainId) {\n                const chainIdHex = await resolvedWallet.request({\n                    method: 'eth_chainId',\n                });\n                chainId = fromHex(chainIdHex);\n            }\n            const siweMessage = {\n                domain: url.host,\n                address: address,\n                statement: statement,\n                uri: url.href,\n                version: '1',\n                chainId: chainId,\n                nonce: (_c = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _c === void 0 ? void 0 : _c.nonce,\n                issuedAt: (_e = (_d = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _d === void 0 ? void 0 : _d.issuedAt) !== null && _e !== void 0 ? _e : new Date(),\n                expirationTime: (_f = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _f === void 0 ? void 0 : _f.expirationTime,\n                notBefore: (_g = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _g === void 0 ? void 0 : _g.notBefore,\n                requestId: (_h = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _h === void 0 ? void 0 : _h.requestId,\n                resources: (_j = options === null || options === void 0 ? void 0 : options.signInWithEthereum) === null || _j === void 0 ? void 0 : _j.resources,\n            };\n            message = createSiweMessage(siweMessage);\n            // Sign message\n            signature = (await resolvedWallet.request({\n                method: 'personal_sign',\n                params: [toHex(message), address],\n            }));\n        }\n        try {\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=web3`, {\n                headers: this.headers,\n                body: Object.assign({ chain: 'ethereum', message,\n                    signature }, (((_k = credentials.options) === null || _k === void 0 ? void 0 : _k.captchaToken)\n                    ? { gotrue_meta_security: { captcha_token: (_l = credentials.options) === null || _l === void 0 ? void 0 : _l.captchaToken } }\n                    : null)),\n                xform: _sessionResponse,\n            });\n            if (error) {\n                throw error;\n            }\n            if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data: Object.assign({}, data), error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    async signInWithSolana(credentials) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n        let message;\n        let signature;\n        if ('message' in credentials) {\n            message = credentials.message;\n            signature = credentials.signature;\n        }\n        else {\n            const { chain, wallet, statement, options } = credentials;\n            let resolvedWallet;\n            if (!isBrowser()) {\n                if (typeof wallet !== 'object' || !(options === null || options === void 0 ? void 0 : options.url)) {\n                    throw new Error('@supabase/auth-js: Both wallet and url must be specified in non-browser environments.');\n                }\n                resolvedWallet = wallet;\n            }\n            else if (typeof wallet === 'object') {\n                resolvedWallet = wallet;\n            }\n            else {\n                const windowAny = window;\n                if ('solana' in windowAny &&\n                    typeof windowAny.solana === 'object' &&\n                    (('signIn' in windowAny.solana && typeof windowAny.solana.signIn === 'function') ||\n                        ('signMessage' in windowAny.solana &&\n                            typeof windowAny.solana.signMessage === 'function'))) {\n                    resolvedWallet = windowAny.solana;\n                }\n                else {\n                    throw new Error(`@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.`);\n                }\n            }\n            const url = new URL((_a = options === null || options === void 0 ? void 0 : options.url) !== null && _a !== void 0 ? _a : window.location.href);\n            if ('signIn' in resolvedWallet && resolvedWallet.signIn) {\n                const output = await resolvedWallet.signIn(Object.assign(Object.assign(Object.assign({ issuedAt: new Date().toISOString() }, options === null || options === void 0 ? void 0 : options.signInWithSolana), { \n                    // non-overridable properties\n                    version: '1', domain: url.host, uri: url.href }), (statement ? { statement } : null)));\n                let outputToProcess;\n                if (Array.isArray(output) && output[0] && typeof output[0] === 'object') {\n                    outputToProcess = output[0];\n                }\n                else if (output &&\n                    typeof output === 'object' &&\n                    'signedMessage' in output &&\n                    'signature' in output) {\n                    outputToProcess = output;\n                }\n                else {\n                    throw new Error('@supabase/auth-js: Wallet method signIn() returned unrecognized value');\n                }\n                if ('signedMessage' in outputToProcess &&\n                    'signature' in outputToProcess &&\n                    (typeof outputToProcess.signedMessage === 'string' ||\n                        outputToProcess.signedMessage instanceof Uint8Array) &&\n                    outputToProcess.signature instanceof Uint8Array) {\n                    message =\n                        typeof outputToProcess.signedMessage === 'string'\n                            ? outputToProcess.signedMessage\n                            : new TextDecoder().decode(outputToProcess.signedMessage);\n                    signature = outputToProcess.signature;\n                }\n                else {\n                    throw new Error('@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields');\n                }\n            }\n            else {\n                if (!('signMessage' in resolvedWallet) ||\n                    typeof resolvedWallet.signMessage !== 'function' ||\n                    !('publicKey' in resolvedWallet) ||\n                    typeof resolvedWallet !== 'object' ||\n                    !resolvedWallet.publicKey ||\n                    !('toBase58' in resolvedWallet.publicKey) ||\n                    typeof resolvedWallet.publicKey.toBase58 !== 'function') {\n                    throw new Error('@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API');\n                }\n                message = [\n                    `${url.host} wants you to sign in with your Solana account:`,\n                    resolvedWallet.publicKey.toBase58(),\n                    ...(statement ? ['', statement, ''] : ['']),\n                    'Version: 1',\n                    `URI: ${url.href}`,\n                    `Issued At: ${(_c = (_b = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _b === void 0 ? void 0 : _b.issuedAt) !== null && _c !== void 0 ? _c : new Date().toISOString()}`,\n                    ...(((_d = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _d === void 0 ? void 0 : _d.notBefore)\n                        ? [`Not Before: ${options.signInWithSolana.notBefore}`]\n                        : []),\n                    ...(((_e = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _e === void 0 ? void 0 : _e.expirationTime)\n                        ? [`Expiration Time: ${options.signInWithSolana.expirationTime}`]\n                        : []),\n                    ...(((_f = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _f === void 0 ? void 0 : _f.chainId)\n                        ? [`Chain ID: ${options.signInWithSolana.chainId}`]\n                        : []),\n                    ...(((_g = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _g === void 0 ? void 0 : _g.nonce) ? [`Nonce: ${options.signInWithSolana.nonce}`] : []),\n                    ...(((_h = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _h === void 0 ? void 0 : _h.requestId)\n                        ? [`Request ID: ${options.signInWithSolana.requestId}`]\n                        : []),\n                    ...(((_k = (_j = options === null || options === void 0 ? void 0 : options.signInWithSolana) === null || _j === void 0 ? void 0 : _j.resources) === null || _k === void 0 ? void 0 : _k.length)\n                        ? [\n                            'Resources',\n                            ...options.signInWithSolana.resources.map((resource) => `- ${resource}`),\n                        ]\n                        : []),\n                ].join('\\n');\n                const maybeSignature = await resolvedWallet.signMessage(new TextEncoder().encode(message), 'utf8');\n                if (!maybeSignature || !(maybeSignature instanceof Uint8Array)) {\n                    throw new Error('@supabase/auth-js: Wallet signMessage() API returned an recognized value');\n                }\n                signature = maybeSignature;\n            }\n        }\n        try {\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=web3`, {\n                headers: this.headers,\n                body: Object.assign({ chain: 'solana', message, signature: bytesToBase64URL(signature) }, (((_l = credentials.options) === null || _l === void 0 ? void 0 : _l.captchaToken)\n                    ? { gotrue_meta_security: { captcha_token: (_m = credentials.options) === null || _m === void 0 ? void 0 : _m.captchaToken } }\n                    : null)),\n                xform: _sessionResponse,\n            });\n            if (error) {\n                throw error;\n            }\n            if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data: Object.assign({}, data), error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    async _exchangeCodeForSession(authCode) {\n        const storageItem = await getItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n        const [codeVerifier, redirectType] = (storageItem !== null && storageItem !== void 0 ? storageItem : '').split('/');\n        try {\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=pkce`, {\n                headers: this.headers,\n                body: {\n                    auth_code: authCode,\n                    code_verifier: codeVerifier,\n                },\n                xform: _sessionResponse,\n            });\n            await removeItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n            if (error) {\n                throw error;\n            }\n            if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({\n                    data: { user: null, session: null, redirectType: null },\n                    error: invalidTokenError,\n                });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data: Object.assign(Object.assign({}, data), { redirectType: redirectType !== null && redirectType !== void 0 ? redirectType : null }), error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({\n                    data: { user: null, session: null, redirectType: null },\n                    error,\n                });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Allows signing in with an OIDC ID token. The authentication provider used\n     * should be enabled and configured.\n     */\n    async signInWithIdToken(credentials) {\n        try {\n            const { options, provider, token, access_token, nonce } = credentials;\n            const res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=id_token`, {\n                headers: this.headers,\n                body: {\n                    provider,\n                    id_token: token,\n                    access_token,\n                    nonce,\n                    gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                },\n                xform: _sessionResponse,\n            });\n            const { data, error } = res;\n            if (error) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            else if (!data || !data.session || !data.user) {\n                const invalidTokenError = new AuthInvalidTokenResponseError();\n                return this._returnResult({ data: { user: null, session: null }, error: invalidTokenError });\n            }\n            if (data.session) {\n                await this._saveSession(data.session);\n                await this._notifyAllSubscribers('SIGNED_IN', data.session);\n            }\n            return this._returnResult({ data, error });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in a user using magiclink or a one-time password (OTP).\n     *\n     * If the `{{ .ConfirmationURL }}` variable is specified in the email template, a magiclink will be sent.\n     * If the `{{ .Token }}` variable is specified in the email template, an OTP will be sent.\n     * If you're using phone sign-ins, only an OTP will be sent. You won't be able to send a magiclink for phone sign-ins.\n     *\n     * Be aware that you may get back an error message that will not distinguish\n     * between the cases where the account does not exist or, that the account\n     * can only be accessed via social login.\n     *\n     * Do note that you will need to configure a Whatsapp sender on Twilio\n     * if you are using phone sign in with the 'whatsapp' channel. The whatsapp\n     * channel is not supported on other providers\n     * at this time.\n     * This method supports PKCE when an email is passed.\n     */\n    async signInWithOtp(credentials) {\n        var _a, _b, _c, _d, _e;\n        try {\n            if ('email' in credentials) {\n                const { email, options } = credentials;\n                let codeChallenge = null;\n                let codeChallengeMethod = null;\n                if (this.flowType === 'pkce') {\n                    ;\n                    [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n                }\n                const { error } = await _request(this.fetch, 'POST', `${this.url}/otp`, {\n                    headers: this.headers,\n                    body: {\n                        email,\n                        data: (_a = options === null || options === void 0 ? void 0 : options.data) !== null && _a !== void 0 ? _a : {},\n                        create_user: (_b = options === null || options === void 0 ? void 0 : options.shouldCreateUser) !== null && _b !== void 0 ? _b : true,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                        code_challenge: codeChallenge,\n                        code_challenge_method: codeChallengeMethod,\n                    },\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                });\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            if ('phone' in credentials) {\n                const { phone, options } = credentials;\n                const { data, error } = await _request(this.fetch, 'POST', `${this.url}/otp`, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        data: (_c = options === null || options === void 0 ? void 0 : options.data) !== null && _c !== void 0 ? _c : {},\n                        create_user: (_d = options === null || options === void 0 ? void 0 : options.shouldCreateUser) !== null && _d !== void 0 ? _d : true,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                        channel: (_e = options === null || options === void 0 ? void 0 : options.channel) !== null && _e !== void 0 ? _e : 'sms',\n                    },\n                });\n                return this._returnResult({\n                    data: { user: null, session: null, messageId: data === null || data === void 0 ? void 0 : data.message_id },\n                    error,\n                });\n            }\n            throw new AuthInvalidCredentialsError('You must provide either an email or phone number.');\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Log in a user given a User supplied OTP or TokenHash received through mobile or email.\n     */\n    async verifyOtp(params) {\n        var _a, _b;\n        try {\n            let redirectTo = undefined;\n            let captchaToken = undefined;\n            if ('options' in params) {\n                redirectTo = (_a = params.options) === null || _a === void 0 ? void 0 : _a.redirectTo;\n                captchaToken = (_b = params.options) === null || _b === void 0 ? void 0 : _b.captchaToken;\n            }\n            const { data, error } = await _request(this.fetch, 'POST', `${this.url}/verify`, {\n                headers: this.headers,\n                body: Object.assign(Object.assign({}, params), { gotrue_meta_security: { captcha_token: captchaToken } }),\n                redirectTo,\n                xform: _sessionResponse,\n            });\n            if (error) {\n                throw error;\n            }\n            if (!data) {\n                const tokenVerificationError = new Error('An error occurred on token verification.');\n                throw tokenVerificationError;\n            }\n            const session = data.session;\n            const user = data.user;\n            if (session === null || session === void 0 ? void 0 : session.access_token) {\n                await this._saveSession(session);\n                await this._notifyAllSubscribers(params.type == 'recovery' ? 'PASSWORD_RECOVERY' : 'SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Attempts a single-sign on using an enterprise Identity Provider. A\n     * successful SSO attempt will redirect the current page to the identity\n     * provider authorization page. The redirect URL is implementation and SSO\n     * protocol specific.\n     *\n     * You can use it by providing a SSO domain. Typically you can extract this\n     * domain by asking users for their email address. If this domain is\n     * registered on the Auth instance the redirect will use that organization's\n     * currently active SSO Identity Provider for the login.\n     *\n     * If you have built an organization-specific login page, you can use the\n     * organization's SSO Identity Provider UUID directly instead.\n     */\n    async signInWithSSO(params) {\n        var _a, _b, _c, _d, _e;\n        try {\n            let codeChallenge = null;\n            let codeChallengeMethod = null;\n            if (this.flowType === 'pkce') {\n                ;\n                [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n            }\n            const result = await _request(this.fetch, 'POST', `${this.url}/sso`, {\n                body: Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, ('providerId' in params ? { provider_id: params.providerId } : null)), ('domain' in params ? { domain: params.domain } : null)), { redirect_to: (_b = (_a = params.options) === null || _a === void 0 ? void 0 : _a.redirectTo) !== null && _b !== void 0 ? _b : undefined }), (((_c = params === null || params === void 0 ? void 0 : params.options) === null || _c === void 0 ? void 0 : _c.captchaToken)\n                    ? { gotrue_meta_security: { captcha_token: params.options.captchaToken } }\n                    : null)), { skip_http_redirect: true, code_challenge: codeChallenge, code_challenge_method: codeChallengeMethod }),\n                headers: this.headers,\n                xform: _ssoResponse,\n            });\n            // Automatically redirect in browser unless skipBrowserRedirect is true\n            if (((_d = result.data) === null || _d === void 0 ? void 0 : _d.url) && isBrowser() && !((_e = params.options) === null || _e === void 0 ? void 0 : _e.skipBrowserRedirect)) {\n                window.location.assign(result.data.url);\n            }\n            return this._returnResult(result);\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sends a reauthentication OTP to the user's email or phone number.\n     * Requires the user to be signed-in.\n     */\n    async reauthenticate() {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._reauthenticate();\n        });\n    }\n    async _reauthenticate() {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError)\n                    throw sessionError;\n                if (!session)\n                    throw new AuthSessionMissingError();\n                const { error } = await _request(this.fetch, 'GET', `${this.url}/reauthenticate`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                });\n                return this._returnResult({ data: { user: null, session: null }, error });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Resends an existing signup confirmation email, email change email, SMS OTP or phone change OTP.\n     */\n    async resend(credentials) {\n        try {\n            const endpoint = `${this.url}/resend`;\n            if ('email' in credentials) {\n                const { email, type, options } = credentials;\n                const { error } = await _request(this.fetch, 'POST', endpoint, {\n                    headers: this.headers,\n                    body: {\n                        email,\n                        type,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                });\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            else if ('phone' in credentials) {\n                const { phone, type, options } = credentials;\n                const { data, error } = await _request(this.fetch, 'POST', endpoint, {\n                    headers: this.headers,\n                    body: {\n                        phone,\n                        type,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                });\n                return this._returnResult({\n                    data: { user: null, session: null, messageId: data === null || data === void 0 ? void 0 : data.message_id },\n                    error,\n                });\n            }\n            throw new AuthInvalidCredentialsError('You must provide either an email or phone number and a type');\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Returns the session, refreshing it if necessary.\n     *\n     * The session returned can be null if the session is not detected which can happen in the event a user is not signed-in or has logged out.\n     *\n     * **IMPORTANT:** This method loads values directly from the storage attached\n     * to the client. If that storage is based on request cookies for example,\n     * the values in it may not be authentic and therefore it's strongly advised\n     * against using this method and its results in such circumstances. A warning\n     * will be emitted if this is detected. Use {@link #getUser()} instead.\n     */\n    async getSession() {\n        await this.initializePromise;\n        const result = await this._acquireLock(-1, async () => {\n            return this._useSession(async (result) => {\n                return result;\n            });\n        });\n        return result;\n    }\n    /**\n     * Acquires a global lock based on the storage key.\n     */\n    async _acquireLock(acquireTimeout, fn) {\n        this._debug('#_acquireLock', 'begin', acquireTimeout);\n        try {\n            if (this.lockAcquired) {\n                const last = this.pendingInLock.length\n                    ? this.pendingInLock[this.pendingInLock.length - 1]\n                    : Promise.resolve();\n                const result = (async () => {\n                    await last;\n                    return await fn();\n                })();\n                this.pendingInLock.push((async () => {\n                    try {\n                        await result;\n                    }\n                    catch (e) {\n                        // we just care if it finished\n                    }\n                })());\n                return result;\n            }\n            return await this.lock(`lock:${this.storageKey}`, acquireTimeout, async () => {\n                this._debug('#_acquireLock', 'lock acquired for storage key', this.storageKey);\n                try {\n                    this.lockAcquired = true;\n                    const result = fn();\n                    this.pendingInLock.push((async () => {\n                        try {\n                            await result;\n                        }\n                        catch (e) {\n                            // we just care if it finished\n                        }\n                    })());\n                    await result;\n                    // keep draining the queue until there's nothing to wait on\n                    while (this.pendingInLock.length) {\n                        const waitOn = [...this.pendingInLock];\n                        await Promise.all(waitOn);\n                        this.pendingInLock.splice(0, waitOn.length);\n                    }\n                    return await result;\n                }\n                finally {\n                    this._debug('#_acquireLock', 'lock released for storage key', this.storageKey);\n                    this.lockAcquired = false;\n                }\n            });\n        }\n        finally {\n            this._debug('#_acquireLock', 'end');\n        }\n    }\n    /**\n     * Use instead of {@link #getSession} inside the library. It is\n     * semantically usually what you want, as getting a session involves some\n     * processing afterwards that requires only one client operating on the\n     * session at once across multiple tabs or processes.\n     */\n    async _useSession(fn) {\n        this._debug('#_useSession', 'begin');\n        try {\n            // the use of __loadSession here is the only correct use of the function!\n            const result = await this.__loadSession();\n            return await fn(result);\n        }\n        finally {\n            this._debug('#_useSession', 'end');\n        }\n    }\n    /**\n     * NEVER USE DIRECTLY!\n     *\n     * Always use {@link #_useSession}.\n     */\n    async __loadSession() {\n        this._debug('#__loadSession()', 'begin');\n        if (!this.lockAcquired) {\n            this._debug('#__loadSession()', 'used outside of an acquired lock!', new Error().stack);\n        }\n        try {\n            let currentSession = null;\n            const maybeSession = await getItemAsync(this.storage, this.storageKey);\n            this._debug('#getSession()', 'session from storage', maybeSession);\n            if (maybeSession !== null) {\n                if (this._isValidSession(maybeSession)) {\n                    currentSession = maybeSession;\n                }\n                else {\n                    this._debug('#getSession()', 'session from storage is not valid');\n                    await this._removeSession();\n                }\n            }\n            if (!currentSession) {\n                return { data: { session: null }, error: null };\n            }\n            // A session is considered expired before the access token _actually_\n            // expires. When the autoRefreshToken option is off (or when the tab is\n            // in the background), very eager users of getSession() -- like\n            // realtime-js -- might send a valid JWT which will expire by the time it\n            // reaches the server.\n            const hasExpired = currentSession.expires_at\n                ? currentSession.expires_at * 1000 - Date.now() < EXPIRY_MARGIN_MS\n                : false;\n            this._debug('#__loadSession()', `session has${hasExpired ? '' : ' not'} expired`, 'expires_at', currentSession.expires_at);\n            if (!hasExpired) {\n                if (this.userStorage) {\n                    const maybeUser = (await getItemAsync(this.userStorage, this.storageKey + '-user'));\n                    if (maybeUser === null || maybeUser === void 0 ? void 0 : maybeUser.user) {\n                        currentSession.user = maybeUser.user;\n                    }\n                    else {\n                        currentSession.user = userNotAvailableProxy();\n                    }\n                }\n                // Wrap the user object with a warning proxy on the server\n                // This warns when properties of the user are accessed, not when session.user itself is accessed\n                if (this.storage.isServer &&\n                    currentSession.user &&\n                    !currentSession.user.__isUserNotAvailableProxy) {\n                    const suppressWarningRef = { value: this.suppressGetSessionWarning };\n                    currentSession.user = insecureUserWarningProxy(currentSession.user, suppressWarningRef);\n                    // Update the client-level suppression flag when the proxy suppresses the warning\n                    if (suppressWarningRef.value) {\n                        this.suppressGetSessionWarning = true;\n                    }\n                }\n                return { data: { session: currentSession }, error: null };\n            }\n            const { data: session, error } = await this._callRefreshToken(currentSession.refresh_token);\n            if (error) {\n                return this._returnResult({ data: { session: null }, error });\n            }\n            return this._returnResult({ data: { session }, error: null });\n        }\n        finally {\n            this._debug('#__loadSession()', 'end');\n        }\n    }\n    /**\n     * Gets the current user details if there is an existing session. This method\n     * performs a network request to the Supabase Auth server, so the returned\n     * value is authentic and can be used to base authorization rules on.\n     *\n     * @param jwt Takes in an optional access token JWT. If no JWT is provided, the JWT from the current session is used.\n     */\n    async getUser(jwt) {\n        if (jwt) {\n            return await this._getUser(jwt);\n        }\n        await this.initializePromise;\n        const result = await this._acquireLock(-1, async () => {\n            return await this._getUser();\n        });\n        return result;\n    }\n    async _getUser(jwt) {\n        try {\n            if (jwt) {\n                return await _request(this.fetch, 'GET', `${this.url}/user`, {\n                    headers: this.headers,\n                    jwt: jwt,\n                    xform: _userResponse,\n                });\n            }\n            return await this._useSession(async (result) => {\n                var _a, _b, _c;\n                const { data, error } = result;\n                if (error) {\n                    throw error;\n                }\n                // returns an error if there is no access_token or custom authorization header\n                if (!((_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token) && !this.hasCustomAuthorizationHeader) {\n                    return { data: { user: null }, error: new AuthSessionMissingError() };\n                }\n                return await _request(this.fetch, 'GET', `${this.url}/user`, {\n                    headers: this.headers,\n                    jwt: (_c = (_b = data.session) === null || _b === void 0 ? void 0 : _b.access_token) !== null && _c !== void 0 ? _c : undefined,\n                    xform: _userResponse,\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                if (isAuthSessionMissingError(error)) {\n                    // JWT contains a `session_id` which does not correspond to an active\n                    // session in the database, indicating the user is signed out.\n                    await this._removeSession();\n                    await removeItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n                }\n                return this._returnResult({ data: { user: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Updates user data for a logged in user.\n     */\n    async updateUser(attributes, options = {}) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._updateUser(attributes, options);\n        });\n    }\n    async _updateUser(attributes, options = {}) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: sessionData, error: sessionError } = result;\n                if (sessionError) {\n                    throw sessionError;\n                }\n                if (!sessionData.session) {\n                    throw new AuthSessionMissingError();\n                }\n                const session = sessionData.session;\n                let codeChallenge = null;\n                let codeChallengeMethod = null;\n                if (this.flowType === 'pkce' && attributes.email != null) {\n                    ;\n                    [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n                }\n                const { data, error: userError } = await _request(this.fetch, 'PUT', `${this.url}/user`, {\n                    headers: this.headers,\n                    redirectTo: options === null || options === void 0 ? void 0 : options.emailRedirectTo,\n                    body: Object.assign(Object.assign({}, attributes), { code_challenge: codeChallenge, code_challenge_method: codeChallengeMethod }),\n                    jwt: session.access_token,\n                    xform: _userResponse,\n                });\n                if (userError) {\n                    throw userError;\n                }\n                session.user = data.user;\n                await this._saveSession(session);\n                await this._notifyAllSubscribers('USER_UPDATED', session);\n                return this._returnResult({ data: { user: session.user }, error: null });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sets the session data from the current session. If the current session is expired, setSession will take care of refreshing it to obtain a new session.\n     * If the refresh token or access token in the current session is invalid, an error will be thrown.\n     * @param currentSession The current session that minimally contains an access token and refresh token.\n     */\n    async setSession(currentSession) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._setSession(currentSession);\n        });\n    }\n    async _setSession(currentSession) {\n        try {\n            if (!currentSession.access_token || !currentSession.refresh_token) {\n                throw new AuthSessionMissingError();\n            }\n            const timeNow = Date.now() / 1000;\n            let expiresAt = timeNow;\n            let hasExpired = true;\n            let session = null;\n            const { payload } = decodeJWT(currentSession.access_token);\n            if (payload.exp) {\n                expiresAt = payload.exp;\n                hasExpired = expiresAt <= timeNow;\n            }\n            if (hasExpired) {\n                const { data: refreshedSession, error } = await this._callRefreshToken(currentSession.refresh_token);\n                if (error) {\n                    return this._returnResult({ data: { user: null, session: null }, error: error });\n                }\n                if (!refreshedSession) {\n                    return { data: { user: null, session: null }, error: null };\n                }\n                session = refreshedSession;\n            }\n            else {\n                const { data, error } = await this._getUser(currentSession.access_token);\n                if (error) {\n                    throw error;\n                }\n                session = {\n                    access_token: currentSession.access_token,\n                    refresh_token: currentSession.refresh_token,\n                    user: data.user,\n                    token_type: 'bearer',\n                    expires_in: expiresAt - timeNow,\n                    expires_at: expiresAt,\n                };\n                await this._saveSession(session);\n                await this._notifyAllSubscribers('SIGNED_IN', session);\n            }\n            return this._returnResult({ data: { user: session.user, session }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { session: null, user: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Returns a new session, regardless of expiry status.\n     * Takes in an optional current session. If not passed in, then refreshSession() will attempt to retrieve it from getSession().\n     * If the current session's refresh token is invalid, an error will be thrown.\n     * @param currentSession The current session. If passed in, it must contain a refresh token.\n     */\n    async refreshSession(currentSession) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._refreshSession(currentSession);\n        });\n    }\n    async _refreshSession(currentSession) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a;\n                if (!currentSession) {\n                    const { data, error } = result;\n                    if (error) {\n                        throw error;\n                    }\n                    currentSession = (_a = data.session) !== null && _a !== void 0 ? _a : undefined;\n                }\n                if (!(currentSession === null || currentSession === void 0 ? void 0 : currentSession.refresh_token)) {\n                    throw new AuthSessionMissingError();\n                }\n                const { data: session, error } = await this._callRefreshToken(currentSession.refresh_token);\n                if (error) {\n                    return this._returnResult({ data: { user: null, session: null }, error: error });\n                }\n                if (!session) {\n                    return this._returnResult({ data: { user: null, session: null }, error: null });\n                }\n                return this._returnResult({ data: { user: session.user, session }, error: null });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { user: null, session: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Gets the session data from a URL string\n     */\n    async _getSessionFromURL(params, callbackUrlType) {\n        try {\n            if (!isBrowser())\n                throw new AuthImplicitGrantRedirectError('No browser detected.');\n            // If there's an error in the URL, it doesn't matter what flow it is, we just return the error.\n            if (params.error || params.error_description || params.error_code) {\n                // The error class returned implies that the redirect is from an implicit grant flow\n                // but it could also be from a redirect error from a PKCE flow.\n                throw new AuthImplicitGrantRedirectError(params.error_description || 'Error in URL with unspecified error_description', {\n                    error: params.error || 'unspecified_error',\n                    code: params.error_code || 'unspecified_code',\n                });\n            }\n            // Checks for mismatches between the flowType initialised in the client and the URL parameters\n            switch (callbackUrlType) {\n                case 'implicit':\n                    if (this.flowType === 'pkce') {\n                        throw new AuthPKCEGrantCodeExchangeError('Not a valid PKCE flow url.');\n                    }\n                    break;\n                case 'pkce':\n                    if (this.flowType === 'implicit') {\n                        throw new AuthImplicitGrantRedirectError('Not a valid implicit grant flow url.');\n                    }\n                    break;\n                default:\n                // there's no mismatch so we continue\n            }\n            // Since this is a redirect for PKCE, we attempt to retrieve the code from the URL for the code exchange\n            if (callbackUrlType === 'pkce') {\n                this._debug('#_initialize()', 'begin', 'is PKCE flow', true);\n                if (!params.code)\n                    throw new AuthPKCEGrantCodeExchangeError('No code detected.');\n                const { data, error } = await this._exchangeCodeForSession(params.code);\n                if (error)\n                    throw error;\n                const url = new URL(window.location.href);\n                url.searchParams.delete('code');\n                window.history.replaceState(window.history.state, '', url.toString());\n                return { data: { session: data.session, redirectType: null }, error: null };\n            }\n            const { provider_token, provider_refresh_token, access_token, refresh_token, expires_in, expires_at, token_type, } = params;\n            if (!access_token || !expires_in || !refresh_token || !token_type) {\n                throw new AuthImplicitGrantRedirectError('No session defined in URL');\n            }\n            const timeNow = Math.round(Date.now() / 1000);\n            const expiresIn = parseInt(expires_in);\n            let expiresAt = timeNow + expiresIn;\n            if (expires_at) {\n                expiresAt = parseInt(expires_at);\n            }\n            const actuallyExpiresIn = expiresAt - timeNow;\n            if (actuallyExpiresIn * 1000 <= AUTO_REFRESH_TICK_DURATION_MS) {\n                console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${actuallyExpiresIn}s, should have been closer to ${expiresIn}s`);\n            }\n            const issuedAt = expiresAt - expiresIn;\n            if (timeNow - issuedAt >= 120) {\n                console.warn('@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale', issuedAt, expiresAt, timeNow);\n            }\n            else if (timeNow - issuedAt < 0) {\n                console.warn('@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew', issuedAt, expiresAt, timeNow);\n            }\n            const { data, error } = await this._getUser(access_token);\n            if (error)\n                throw error;\n            const session = {\n                provider_token,\n                provider_refresh_token,\n                access_token,\n                expires_in: expiresIn,\n                expires_at: expiresAt,\n                refresh_token,\n                token_type: token_type,\n                user: data.user,\n            };\n            // Remove tokens from URL\n            window.location.hash = '';\n            this._debug('#_getSessionFromURL()', 'clearing window.location.hash');\n            return this._returnResult({ data: { session, redirectType: params.type }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { session: null, redirectType: null }, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Checks if the current URL contains parameters given by an implicit oauth grant flow (https://www.rfc-editor.org/rfc/rfc6749.html#section-4.2)\n     */\n    _isImplicitGrantCallback(params) {\n        return Boolean(params.access_token || params.error_description);\n    }\n    /**\n     * Checks if the current URL and backing storage contain parameters given by a PKCE flow\n     */\n    async _isPKCECallback(params) {\n        const currentStorageContent = await getItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n        return !!(params.code && currentStorageContent);\n    }\n    /**\n     * Inside a browser context, `signOut()` will remove the logged in user from the browser session and log them out - removing all items from localstorage and then trigger a `\"SIGNED_OUT\"` event.\n     *\n     * For server-side management, you can revoke all refresh tokens for a user by passing a user's JWT through to `auth.api.signOut(JWT: string)`.\n     * There is no way to revoke a user's access token jwt until it expires. It is recommended to set a shorter expiry on the jwt for this reason.\n     *\n     * If using `others` scope, no `SIGNED_OUT` event is fired!\n     */\n    async signOut(options = { scope: 'global' }) {\n        await this.initializePromise;\n        return await this._acquireLock(-1, async () => {\n            return await this._signOut(options);\n        });\n    }\n    async _signOut({ scope } = { scope: 'global' }) {\n        return await this._useSession(async (result) => {\n            var _a;\n            const { data, error: sessionError } = result;\n            if (sessionError) {\n                return this._returnResult({ error: sessionError });\n            }\n            const accessToken = (_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token;\n            if (accessToken) {\n                const { error } = await this.admin.signOut(accessToken, scope);\n                if (error) {\n                    // ignore 404s since user might not exist anymore\n                    // ignore 401s since an invalid or expired JWT should sign out the current session\n                    if (!(isAuthApiError(error) &&\n                        (error.status === 404 || error.status === 401 || error.status === 403))) {\n                        return this._returnResult({ error });\n                    }\n                }\n            }\n            if (scope !== 'others') {\n                await this._removeSession();\n                await removeItemAsync(this.storage, `${this.storageKey}-code-verifier`);\n            }\n            return this._returnResult({ error: null });\n        });\n    }\n    onAuthStateChange(callback) {\n        const id = generateCallbackId();\n        const subscription = {\n            id,\n            callback,\n            unsubscribe: () => {\n                this._debug('#unsubscribe()', 'state change callback with id removed', id);\n                this.stateChangeEmitters.delete(id);\n            },\n        };\n        this._debug('#onAuthStateChange()', 'registered callback with id', id);\n        this.stateChangeEmitters.set(id, subscription);\n        (async () => {\n            await this.initializePromise;\n            await this._acquireLock(-1, async () => {\n                this._emitInitialSession(id);\n            });\n        })();\n        return { data: { subscription } };\n    }\n    async _emitInitialSession(id) {\n        return await this._useSession(async (result) => {\n            var _a, _b;\n            try {\n                const { data: { session }, error, } = result;\n                if (error)\n                    throw error;\n                await ((_a = this.stateChangeEmitters.get(id)) === null || _a === void 0 ? void 0 : _a.callback('INITIAL_SESSION', session));\n                this._debug('INITIAL_SESSION', 'callback id', id, 'session', session);\n            }\n            catch (err) {\n                await ((_b = this.stateChangeEmitters.get(id)) === null || _b === void 0 ? void 0 : _b.callback('INITIAL_SESSION', null));\n                this._debug('INITIAL_SESSION', 'callback id', id, 'error', err);\n                console.error(err);\n            }\n        });\n    }\n    /**\n     * Sends a password reset request to an email address. This method supports the PKCE flow.\n     *\n     * @param email The email address of the user.\n     * @param options.redirectTo The URL to send the user to after they click the password reset link.\n     * @param options.captchaToken Verification token received when the user completes the captcha on the site.\n     */\n    async resetPasswordForEmail(email, options = {}) {\n        let codeChallenge = null;\n        let codeChallengeMethod = null;\n        if (this.flowType === 'pkce') {\n            ;\n            [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey, true // isPasswordRecovery\n            );\n        }\n        try {\n            return await _request(this.fetch, 'POST', `${this.url}/recover`, {\n                body: {\n                    email,\n                    code_challenge: codeChallenge,\n                    code_challenge_method: codeChallengeMethod,\n                    gotrue_meta_security: { captcha_token: options.captchaToken },\n                },\n                headers: this.headers,\n                redirectTo: options.redirectTo,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Gets all the identities linked to a user.\n     */\n    async getUserIdentities() {\n        var _a;\n        try {\n            const { data, error } = await this.getUser();\n            if (error)\n                throw error;\n            return this._returnResult({ data: { identities: (_a = data.user.identities) !== null && _a !== void 0 ? _a : [] }, error: null });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async linkIdentity(credentials) {\n        if ('token' in credentials) {\n            return this.linkIdentityIdToken(credentials);\n        }\n        return this.linkIdentityOAuth(credentials);\n    }\n    async linkIdentityOAuth(credentials) {\n        var _a;\n        try {\n            const { data, error } = await this._useSession(async (result) => {\n                var _a, _b, _c, _d, _e;\n                const { data, error } = result;\n                if (error)\n                    throw error;\n                const url = await this._getUrlForProvider(`${this.url}/user/identities/authorize`, credentials.provider, {\n                    redirectTo: (_a = credentials.options) === null || _a === void 0 ? void 0 : _a.redirectTo,\n                    scopes: (_b = credentials.options) === null || _b === void 0 ? void 0 : _b.scopes,\n                    queryParams: (_c = credentials.options) === null || _c === void 0 ? void 0 : _c.queryParams,\n                    skipBrowserRedirect: true,\n                });\n                return await _request(this.fetch, 'GET', url, {\n                    headers: this.headers,\n                    jwt: (_e = (_d = data.session) === null || _d === void 0 ? void 0 : _d.access_token) !== null && _e !== void 0 ? _e : undefined,\n                });\n            });\n            if (error)\n                throw error;\n            if (isBrowser() && !((_a = credentials.options) === null || _a === void 0 ? void 0 : _a.skipBrowserRedirect)) {\n                window.location.assign(data === null || data === void 0 ? void 0 : data.url);\n            }\n            return this._returnResult({\n                data: { provider: credentials.provider, url: data === null || data === void 0 ? void 0 : data.url },\n                error: null,\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { provider: credentials.provider, url: null }, error });\n            }\n            throw error;\n        }\n    }\n    async linkIdentityIdToken(credentials) {\n        return await this._useSession(async (result) => {\n            var _a;\n            try {\n                const { error: sessionError, data: { session }, } = result;\n                if (sessionError)\n                    throw sessionError;\n                const { options, provider, token, access_token, nonce } = credentials;\n                const res = await _request(this.fetch, 'POST', `${this.url}/token?grant_type=id_token`, {\n                    headers: this.headers,\n                    jwt: (_a = session === null || session === void 0 ? void 0 : session.access_token) !== null && _a !== void 0 ? _a : undefined,\n                    body: {\n                        provider,\n                        id_token: token,\n                        access_token,\n                        nonce,\n                        link_identity: true,\n                        gotrue_meta_security: { captcha_token: options === null || options === void 0 ? void 0 : options.captchaToken },\n                    },\n                    xform: _sessionResponse,\n                });\n                const { data, error } = res;\n                if (error) {\n                    return this._returnResult({ data: { user: null, session: null }, error });\n                }\n                else if (!data || !data.session || !data.user) {\n                    return this._returnResult({\n                        data: { user: null, session: null },\n                        error: new AuthInvalidTokenResponseError(),\n                    });\n                }\n                if (data.session) {\n                    await this._saveSession(data.session);\n                    await this._notifyAllSubscribers('USER_UPDATED', data.session);\n                }\n                return this._returnResult({ data, error });\n            }\n            catch (error) {\n                if (isAuthError(error)) {\n                    return this._returnResult({ data: { user: null, session: null }, error });\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * Unlinks an identity from a user by deleting it. The user will no longer be able to sign in with that identity once it's unlinked.\n     */\n    async unlinkIdentity(identity) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a, _b;\n                const { data, error } = result;\n                if (error) {\n                    throw error;\n                }\n                return await _request(this.fetch, 'DELETE', `${this.url}/user/identities/${identity.identity_id}`, {\n                    headers: this.headers,\n                    jwt: (_b = (_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token) !== null && _b !== void 0 ? _b : undefined,\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Generates a new JWT.\n     * @param refreshToken A valid refresh token that was returned on login.\n     */\n    async _refreshAccessToken(refreshToken) {\n        const debugName = `#_refreshAccessToken(${refreshToken.substring(0, 5)}...)`;\n        this._debug(debugName, 'begin');\n        try {\n            const startedAt = Date.now();\n            // will attempt to refresh the token with exponential backoff\n            return await retryable(async (attempt) => {\n                if (attempt > 0) {\n                    await sleep(200 * Math.pow(2, attempt - 1)); // 200, 400, 800, ...\n                }\n                this._debug(debugName, 'refreshing attempt', attempt);\n                return await _request(this.fetch, 'POST', `${this.url}/token?grant_type=refresh_token`, {\n                    body: { refresh_token: refreshToken },\n                    headers: this.headers,\n                    xform: _sessionResponse,\n                });\n            }, (attempt, error) => {\n                const nextBackOffInterval = 200 * Math.pow(2, attempt);\n                return (error &&\n                    isAuthRetryableFetchError(error) &&\n                    // retryable only if the request can be sent before the backoff overflows the tick duration\n                    Date.now() + nextBackOffInterval - startedAt < AUTO_REFRESH_TICK_DURATION_MS);\n            });\n        }\n        catch (error) {\n            this._debug(debugName, 'error', error);\n            if (isAuthError(error)) {\n                return this._returnResult({ data: { session: null, user: null }, error });\n            }\n            throw error;\n        }\n        finally {\n            this._debug(debugName, 'end');\n        }\n    }\n    _isValidSession(maybeSession) {\n        const isValidSession = typeof maybeSession === 'object' &&\n            maybeSession !== null &&\n            'access_token' in maybeSession &&\n            'refresh_token' in maybeSession &&\n            'expires_at' in maybeSession;\n        return isValidSession;\n    }\n    async _handleProviderSignIn(provider, options) {\n        const url = await this._getUrlForProvider(`${this.url}/authorize`, provider, {\n            redirectTo: options.redirectTo,\n            scopes: options.scopes,\n            queryParams: options.queryParams,\n        });\n        this._debug('#_handleProviderSignIn()', 'provider', provider, 'options', options, 'url', url);\n        // try to open on the browser\n        if (isBrowser() && !options.skipBrowserRedirect) {\n            window.location.assign(url);\n        }\n        return { data: { provider, url }, error: null };\n    }\n    /**\n     * Recovers the session from LocalStorage and refreshes the token\n     * Note: this method is async to accommodate for AsyncStorage e.g. in React native.\n     */\n    async _recoverAndRefresh() {\n        var _a, _b;\n        const debugName = '#_recoverAndRefresh()';\n        this._debug(debugName, 'begin');\n        try {\n            const currentSession = (await getItemAsync(this.storage, this.storageKey));\n            if (currentSession && this.userStorage) {\n                let maybeUser = (await getItemAsync(this.userStorage, this.storageKey + '-user'));\n                if (!this.storage.isServer && Object.is(this.storage, this.userStorage) && !maybeUser) {\n                    // storage and userStorage are the same storage medium, for example\n                    // window.localStorage if userStorage does not have the user from\n                    // storage stored, store it first thereby migrating the user object\n                    // from storage -> userStorage\n                    maybeUser = { user: currentSession.user };\n                    await setItemAsync(this.userStorage, this.storageKey + '-user', maybeUser);\n                }\n                currentSession.user = (_a = maybeUser === null || maybeUser === void 0 ? void 0 : maybeUser.user) !== null && _a !== void 0 ? _a : userNotAvailableProxy();\n            }\n            else if (currentSession && !currentSession.user) {\n                // user storage is not set, let's check if it was previously enabled so\n                // we bring back the storage as it should be\n                if (!currentSession.user) {\n                    // test if userStorage was previously enabled and the storage medium was the same, to move the user back under the same key\n                    const separateUser = (await getItemAsync(this.storage, this.storageKey + '-user'));\n                    if (separateUser && (separateUser === null || separateUser === void 0 ? void 0 : separateUser.user)) {\n                        currentSession.user = separateUser.user;\n                        await removeItemAsync(this.storage, this.storageKey + '-user');\n                        await setItemAsync(this.storage, this.storageKey, currentSession);\n                    }\n                    else {\n                        currentSession.user = userNotAvailableProxy();\n                    }\n                }\n            }\n            this._debug(debugName, 'session from storage', currentSession);\n            if (!this._isValidSession(currentSession)) {\n                this._debug(debugName, 'session is not valid');\n                if (currentSession !== null) {\n                    await this._removeSession();\n                }\n                return;\n            }\n            const expiresWithMargin = ((_b = currentSession.expires_at) !== null && _b !== void 0 ? _b : Infinity) * 1000 - Date.now() < EXPIRY_MARGIN_MS;\n            this._debug(debugName, `session has${expiresWithMargin ? '' : ' not'} expired with margin of ${EXPIRY_MARGIN_MS}s`);\n            if (expiresWithMargin) {\n                if (this.autoRefreshToken && currentSession.refresh_token) {\n                    const { error } = await this._callRefreshToken(currentSession.refresh_token);\n                    if (error) {\n                        console.error(error);\n                        if (!isAuthRetryableFetchError(error)) {\n                            this._debug(debugName, 'refresh failed with a non-retryable error, removing the session', error);\n                            await this._removeSession();\n                        }\n                    }\n                }\n            }\n            else if (currentSession.user &&\n                currentSession.user.__isUserNotAvailableProxy === true) {\n                // If we have a proxy user, try to get the real user data\n                try {\n                    const { data, error: userError } = await this._getUser(currentSession.access_token);\n                    if (!userError && (data === null || data === void 0 ? void 0 : data.user)) {\n                        currentSession.user = data.user;\n                        await this._saveSession(currentSession);\n                        await this._notifyAllSubscribers('SIGNED_IN', currentSession);\n                    }\n                    else {\n                        this._debug(debugName, 'could not get user data, skipping SIGNED_IN notification');\n                    }\n                }\n                catch (getUserError) {\n                    console.error('Error getting user data:', getUserError);\n                    this._debug(debugName, 'error getting user data, skipping SIGNED_IN notification', getUserError);\n                }\n            }\n            else {\n                // no need to persist currentSession again, as we just loaded it from\n                // local storage; persisting it again may overwrite a value saved by\n                // another client with access to the same local storage\n                await this._notifyAllSubscribers('SIGNED_IN', currentSession);\n            }\n        }\n        catch (err) {\n            this._debug(debugName, 'error', err);\n            console.error(err);\n            return;\n        }\n        finally {\n            this._debug(debugName, 'end');\n        }\n    }\n    async _callRefreshToken(refreshToken) {\n        var _a, _b;\n        if (!refreshToken) {\n            throw new AuthSessionMissingError();\n        }\n        // refreshing is already in progress\n        if (this.refreshingDeferred) {\n            return this.refreshingDeferred.promise;\n        }\n        const debugName = `#_callRefreshToken(${refreshToken.substring(0, 5)}...)`;\n        this._debug(debugName, 'begin');\n        try {\n            this.refreshingDeferred = new Deferred();\n            const { data, error } = await this._refreshAccessToken(refreshToken);\n            if (error)\n                throw error;\n            if (!data.session)\n                throw new AuthSessionMissingError();\n            await this._saveSession(data.session);\n            await this._notifyAllSubscribers('TOKEN_REFRESHED', data.session);\n            const result = { data: data.session, error: null };\n            this.refreshingDeferred.resolve(result);\n            return result;\n        }\n        catch (error) {\n            this._debug(debugName, 'error', error);\n            if (isAuthError(error)) {\n                const result = { data: null, error };\n                if (!isAuthRetryableFetchError(error)) {\n                    await this._removeSession();\n                }\n                (_a = this.refreshingDeferred) === null || _a === void 0 ? void 0 : _a.resolve(result);\n                return result;\n            }\n            (_b = this.refreshingDeferred) === null || _b === void 0 ? void 0 : _b.reject(error);\n            throw error;\n        }\n        finally {\n            this.refreshingDeferred = null;\n            this._debug(debugName, 'end');\n        }\n    }\n    async _notifyAllSubscribers(event, session, broadcast = true) {\n        const debugName = `#_notifyAllSubscribers(${event})`;\n        this._debug(debugName, 'begin', session, `broadcast = ${broadcast}`);\n        try {\n            if (this.broadcastChannel && broadcast) {\n                this.broadcastChannel.postMessage({ event, session });\n            }\n            const errors = [];\n            const promises = Array.from(this.stateChangeEmitters.values()).map(async (x) => {\n                try {\n                    await x.callback(event, session);\n                }\n                catch (e) {\n                    errors.push(e);\n                }\n            });\n            await Promise.all(promises);\n            if (errors.length > 0) {\n                for (let i = 0; i < errors.length; i += 1) {\n                    console.error(errors[i]);\n                }\n                throw errors[0];\n            }\n        }\n        finally {\n            this._debug(debugName, 'end');\n        }\n    }\n    /**\n     * set currentSession and currentUser\n     * process to _startAutoRefreshToken if possible\n     */\n    async _saveSession(session) {\n        this._debug('#_saveSession()', session);\n        // _saveSession is always called whenever a new session has been acquired\n        // so we can safely suppress the warning returned by future getSession calls\n        this.suppressGetSessionWarning = true;\n        // Create a shallow copy to work with, to avoid mutating the original session object if it's used elsewhere\n        const sessionToProcess = Object.assign({}, session);\n        const userIsProxy = sessionToProcess.user && sessionToProcess.user.__isUserNotAvailableProxy === true;\n        if (this.userStorage) {\n            if (!userIsProxy && sessionToProcess.user) {\n                // If it's a real user object, save it to userStorage.\n                await setItemAsync(this.userStorage, this.storageKey + '-user', {\n                    user: sessionToProcess.user,\n                });\n            }\n            else if (userIsProxy) {\n                // If it's the proxy, it means user was not found in userStorage.\n                // We should ensure no stale user data for this key exists in userStorage if we were to save null,\n                // or simply not save the proxy. For now, we don't save the proxy here.\n                // If there's a need to clear userStorage if user becomes proxy, that logic would go here.\n            }\n            // Prepare the main session data for primary storage: remove the user property before cloning\n            // This is important because the original session.user might be the proxy\n            const mainSessionData = Object.assign({}, sessionToProcess);\n            delete mainSessionData.user; // Remove user (real or proxy) before cloning for main storage\n            const clonedMainSessionData = deepClone(mainSessionData);\n            await setItemAsync(this.storage, this.storageKey, clonedMainSessionData);\n        }\n        else {\n            // No userStorage is configured.\n            // In this case, session.user should ideally not be a proxy.\n            // If it were, structuredClone would fail. This implies an issue elsewhere if user is a proxy here\n            const clonedSession = deepClone(sessionToProcess); // sessionToProcess still has its original user property\n            await setItemAsync(this.storage, this.storageKey, clonedSession);\n        }\n    }\n    async _removeSession() {\n        this._debug('#_removeSession()');\n        await removeItemAsync(this.storage, this.storageKey);\n        await removeItemAsync(this.storage, this.storageKey + '-code-verifier');\n        await removeItemAsync(this.storage, this.storageKey + '-user');\n        if (this.userStorage) {\n            await removeItemAsync(this.userStorage, this.storageKey + '-user');\n        }\n        await this._notifyAllSubscribers('SIGNED_OUT', null);\n    }\n    /**\n     * Removes any registered visibilitychange callback.\n     *\n     * {@see #startAutoRefresh}\n     * {@see #stopAutoRefresh}\n     */\n    _removeVisibilityChangedCallback() {\n        this._debug('#_removeVisibilityChangedCallback()');\n        const callback = this.visibilityChangedCallback;\n        this.visibilityChangedCallback = null;\n        try {\n            if (callback && isBrowser() && (window === null || window === void 0 ? void 0 : window.removeEventListener)) {\n                window.removeEventListener('visibilitychange', callback);\n            }\n        }\n        catch (e) {\n            console.error('removing visibilitychange callback failed', e);\n        }\n    }\n    /**\n     * This is the private implementation of {@link #startAutoRefresh}. Use this\n     * within the library.\n     */\n    async _startAutoRefresh() {\n        await this._stopAutoRefresh();\n        this._debug('#_startAutoRefresh()');\n        const ticker = setInterval(() => this._autoRefreshTokenTick(), AUTO_REFRESH_TICK_DURATION_MS);\n        this.autoRefreshTicker = ticker;\n        if (ticker && typeof ticker === 'object' && typeof ticker.unref === 'function') {\n            // ticker is a NodeJS Timeout object that has an `unref` method\n            // https://nodejs.org/api/timers.html#timeoutunref\n            // When auto refresh is used in NodeJS (like for testing) the\n            // `setInterval` is preventing the process from being marked as\n            // finished and tests run endlessly. This can be prevented by calling\n            // `unref()` on the returned object.\n            ticker.unref();\n            // @ts-expect-error TS has no context of Deno\n        }\n        else if (typeof Deno !== 'undefined' && typeof Deno.unrefTimer === 'function') {\n            // similar like for NodeJS, but with the Deno API\n            // https://deno.land/api@latest?unstable&s=Deno.unrefTimer\n            // @ts-expect-error TS has no context of Deno\n            Deno.unrefTimer(ticker);\n        }\n        // run the tick immediately, but in the next pass of the event loop so that\n        // #_initialize can be allowed to complete without recursively waiting on\n        // itself\n        setTimeout(async () => {\n            await this.initializePromise;\n            await this._autoRefreshTokenTick();\n        }, 0);\n    }\n    /**\n     * This is the private implementation of {@link #stopAutoRefresh}. Use this\n     * within the library.\n     */\n    async _stopAutoRefresh() {\n        this._debug('#_stopAutoRefresh()');\n        const ticker = this.autoRefreshTicker;\n        this.autoRefreshTicker = null;\n        if (ticker) {\n            clearInterval(ticker);\n        }\n    }\n    /**\n     * Starts an auto-refresh process in the background. The session is checked\n     * every few seconds. Close to the time of expiration a process is started to\n     * refresh the session. If refreshing fails it will be retried for as long as\n     * necessary.\n     *\n     * If you set the {@link GoTrueClientOptions#autoRefreshToken} you don't need\n     * to call this function, it will be called for you.\n     *\n     * On browsers the refresh process works only when the tab/window is in the\n     * foreground to conserve resources as well as prevent race conditions and\n     * flooding auth with requests. If you call this method any managed\n     * visibility change callback will be removed and you must manage visibility\n     * changes on your own.\n     *\n     * On non-browser platforms the refresh process works *continuously* in the\n     * background, which may not be desirable. You should hook into your\n     * platform's foreground indication mechanism and call these methods\n     * appropriately to conserve resources.\n     *\n     * {@see #stopAutoRefresh}\n     */\n    async startAutoRefresh() {\n        this._removeVisibilityChangedCallback();\n        await this._startAutoRefresh();\n    }\n    /**\n     * Stops an active auto refresh process running in the background (if any).\n     *\n     * If you call this method any managed visibility change callback will be\n     * removed and you must manage visibility changes on your own.\n     *\n     * See {@link #startAutoRefresh} for more details.\n     */\n    async stopAutoRefresh() {\n        this._removeVisibilityChangedCallback();\n        await this._stopAutoRefresh();\n    }\n    /**\n     * Runs the auto refresh token tick.\n     */\n    async _autoRefreshTokenTick() {\n        this._debug('#_autoRefreshTokenTick()', 'begin');\n        try {\n            await this._acquireLock(0, async () => {\n                try {\n                    const now = Date.now();\n                    try {\n                        return await this._useSession(async (result) => {\n                            const { data: { session }, } = result;\n                            if (!session || !session.refresh_token || !session.expires_at) {\n                                this._debug('#_autoRefreshTokenTick()', 'no session');\n                                return;\n                            }\n                            // session will expire in this many ticks (or has already expired if <= 0)\n                            const expiresInTicks = Math.floor((session.expires_at * 1000 - now) / AUTO_REFRESH_TICK_DURATION_MS);\n                            this._debug('#_autoRefreshTokenTick()', `access token expires in ${expiresInTicks} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`);\n                            if (expiresInTicks <= AUTO_REFRESH_TICK_THRESHOLD) {\n                                await this._callRefreshToken(session.refresh_token);\n                            }\n                        });\n                    }\n                    catch (e) {\n                        console.error('Auto refresh tick failed with error. This is likely a transient error.', e);\n                    }\n                }\n                finally {\n                    this._debug('#_autoRefreshTokenTick()', 'end');\n                }\n            });\n        }\n        catch (e) {\n            if (e.isAcquireTimeout || e instanceof LockAcquireTimeoutError) {\n                this._debug('auto refresh token tick lock not available');\n            }\n            else {\n                throw e;\n            }\n        }\n    }\n    /**\n     * Registers callbacks on the browser / platform, which in-turn run\n     * algorithms when the browser window/tab are in foreground. On non-browser\n     * platforms it assumes always foreground.\n     */\n    async _handleVisibilityChange() {\n        this._debug('#_handleVisibilityChange()');\n        if (!isBrowser() || !(window === null || window === void 0 ? void 0 : window.addEventListener)) {\n            if (this.autoRefreshToken) {\n                // in non-browser environments the refresh token ticker runs always\n                this.startAutoRefresh();\n            }\n            return false;\n        }\n        try {\n            this.visibilityChangedCallback = async () => await this._onVisibilityChanged(false);\n            window === null || window === void 0 ? void 0 : window.addEventListener('visibilitychange', this.visibilityChangedCallback);\n            // now immediately call the visbility changed callback to setup with the\n            // current visbility state\n            await this._onVisibilityChanged(true); // initial call\n        }\n        catch (error) {\n            console.error('_handleVisibilityChange', error);\n        }\n    }\n    /**\n     * Callback registered with `window.addEventListener('visibilitychange')`.\n     */\n    async _onVisibilityChanged(calledFromInitialize) {\n        const methodName = `#_onVisibilityChanged(${calledFromInitialize})`;\n        this._debug(methodName, 'visibilityState', document.visibilityState);\n        if (document.visibilityState === 'visible') {\n            if (this.autoRefreshToken) {\n                // in browser environments the refresh token ticker runs only on focused tabs\n                // which prevents race conditions\n                this._startAutoRefresh();\n            }\n            if (!calledFromInitialize) {\n                // called when the visibility has changed, i.e. the browser\n                // transitioned from hidden -> visible so we need to see if the session\n                // should be recovered immediately... but to do that we need to acquire\n                // the lock first asynchronously\n                await this.initializePromise;\n                await this._acquireLock(-1, async () => {\n                    if (document.visibilityState !== 'visible') {\n                        this._debug(methodName, 'acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting');\n                        // visibility has changed while waiting for the lock, abort\n                        return;\n                    }\n                    // recover the session\n                    await this._recoverAndRefresh();\n                });\n            }\n        }\n        else if (document.visibilityState === 'hidden') {\n            if (this.autoRefreshToken) {\n                this._stopAutoRefresh();\n            }\n        }\n    }\n    /**\n     * Generates the relevant login URL for a third-party provider.\n     * @param options.redirectTo A URL or mobile address to send the user to after they are confirmed.\n     * @param options.scopes A space-separated list of scopes granted to the OAuth application.\n     * @param options.queryParams An object of key-value pairs containing query parameters granted to the OAuth application.\n     */\n    async _getUrlForProvider(url, provider, options) {\n        const urlParams = [`provider=${encodeURIComponent(provider)}`];\n        if (options === null || options === void 0 ? void 0 : options.redirectTo) {\n            urlParams.push(`redirect_to=${encodeURIComponent(options.redirectTo)}`);\n        }\n        if (options === null || options === void 0 ? void 0 : options.scopes) {\n            urlParams.push(`scopes=${encodeURIComponent(options.scopes)}`);\n        }\n        if (this.flowType === 'pkce') {\n            const [codeChallenge, codeChallengeMethod] = await getCodeChallengeAndMethod(this.storage, this.storageKey);\n            const flowParams = new URLSearchParams({\n                code_challenge: `${encodeURIComponent(codeChallenge)}`,\n                code_challenge_method: `${encodeURIComponent(codeChallengeMethod)}`,\n            });\n            urlParams.push(flowParams.toString());\n        }\n        if (options === null || options === void 0 ? void 0 : options.queryParams) {\n            const query = new URLSearchParams(options.queryParams);\n            urlParams.push(query.toString());\n        }\n        if (options === null || options === void 0 ? void 0 : options.skipBrowserRedirect) {\n            urlParams.push(`skip_http_redirect=${options.skipBrowserRedirect}`);\n        }\n        return `${url}?${urlParams.join('&')}`;\n    }\n    async _unenroll(params) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a;\n                const { data: sessionData, error: sessionError } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                return await _request(this.fetch, 'DELETE', `${this.url}/factors/${params.factorId}`, {\n                    headers: this.headers,\n                    jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async _enroll(params) {\n        try {\n            return await this._useSession(async (result) => {\n                var _a, _b;\n                const { data: sessionData, error: sessionError } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                const body = Object.assign({ friendly_name: params.friendlyName, factor_type: params.factorType }, (params.factorType === 'phone'\n                    ? { phone: params.phone }\n                    : params.factorType === 'totp'\n                        ? { issuer: params.issuer }\n                        : {}));\n                const { data, error } = (await _request(this.fetch, 'POST', `${this.url}/factors`, {\n                    body,\n                    headers: this.headers,\n                    jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                }));\n                if (error) {\n                    return this._returnResult({ data: null, error });\n                }\n                if (params.factorType === 'totp' && data.type === 'totp' && ((_b = data === null || data === void 0 ? void 0 : data.totp) === null || _b === void 0 ? void 0 : _b.qr_code)) {\n                    data.totp.qr_code = `data:image/svg+xml;utf-8,${data.totp.qr_code}`;\n                }\n                return this._returnResult({ data, error: null });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async _verify(params) {\n        return this._acquireLock(-1, async () => {\n            try {\n                return await this._useSession(async (result) => {\n                    var _a;\n                    const { data: sessionData, error: sessionError } = result;\n                    if (sessionError) {\n                        return this._returnResult({ data: null, error: sessionError });\n                    }\n                    const body = Object.assign({ challenge_id: params.challengeId }, ('webauthn' in params\n                        ? {\n                            webauthn: Object.assign(Object.assign({}, params.webauthn), { credential_response: params.webauthn.type === 'create'\n                                    ? serializeCredentialCreationResponse(params.webauthn.credential_response)\n                                    : serializeCredentialRequestResponse(params.webauthn.credential_response) }),\n                        }\n                        : { code: params.code }));\n                    const { data, error } = await _request(this.fetch, 'POST', `${this.url}/factors/${params.factorId}/verify`, {\n                        body,\n                        headers: this.headers,\n                        jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                    });\n                    if (error) {\n                        return this._returnResult({ data: null, error });\n                    }\n                    await this._saveSession(Object.assign({ expires_at: Math.round(Date.now() / 1000) + data.expires_in }, data));\n                    await this._notifyAllSubscribers('MFA_CHALLENGE_VERIFIED', data);\n                    return this._returnResult({ data, error });\n                });\n            }\n            catch (error) {\n                if (isAuthError(error)) {\n                    return this._returnResult({ data: null, error });\n                }\n                throw error;\n            }\n        });\n    }\n    async _challenge(params) {\n        return this._acquireLock(-1, async () => {\n            try {\n                return await this._useSession(async (result) => {\n                    var _a;\n                    const { data: sessionData, error: sessionError } = result;\n                    if (sessionError) {\n                        return this._returnResult({ data: null, error: sessionError });\n                    }\n                    const response = (await _request(this.fetch, 'POST', `${this.url}/factors/${params.factorId}/challenge`, {\n                        body: params,\n                        headers: this.headers,\n                        jwt: (_a = sessionData === null || sessionData === void 0 ? void 0 : sessionData.session) === null || _a === void 0 ? void 0 : _a.access_token,\n                    }));\n                    if (response.error) {\n                        return response;\n                    }\n                    const { data } = response;\n                    if (data.type !== 'webauthn') {\n                        return { data, error: null };\n                    }\n                    switch (data.webauthn.type) {\n                        case 'create':\n                            return {\n                                data: Object.assign(Object.assign({}, data), { webauthn: Object.assign(Object.assign({}, data.webauthn), { credential_options: Object.assign(Object.assign({}, data.webauthn.credential_options), { publicKey: deserializeCredentialCreationOptions(data.webauthn.credential_options.publicKey) }) }) }),\n                                error: null,\n                            };\n                        case 'request':\n                            return {\n                                data: Object.assign(Object.assign({}, data), { webauthn: Object.assign(Object.assign({}, data.webauthn), { credential_options: Object.assign(Object.assign({}, data.webauthn.credential_options), { publicKey: deserializeCredentialRequestOptions(data.webauthn.credential_options.publicKey) }) }) }),\n                                error: null,\n                            };\n                    }\n                });\n            }\n            catch (error) {\n                if (isAuthError(error)) {\n                    return this._returnResult({ data: null, error });\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * {@see GoTrueMFAApi#challengeAndVerify}\n     */\n    async _challengeAndVerify(params) {\n        // both _challenge and _verify independently acquire the lock, so no need\n        // to acquire it here\n        const { data: challengeData, error: challengeError } = await this._challenge({\n            factorId: params.factorId,\n        });\n        if (challengeError) {\n            return this._returnResult({ data: null, error: challengeError });\n        }\n        return await this._verify({\n            factorId: params.factorId,\n            challengeId: challengeData.id,\n            code: params.code,\n        });\n    }\n    /**\n     * {@see GoTrueMFAApi#listFactors}\n     */\n    async _listFactors() {\n        var _a;\n        // use #getUser instead of #_getUser as the former acquires a lock\n        const { data: { user }, error: userError, } = await this.getUser();\n        if (userError) {\n            return { data: null, error: userError };\n        }\n        const data = {\n            all: [],\n            phone: [],\n            totp: [],\n            webauthn: [],\n        };\n        // loop over the factors ONCE\n        for (const factor of (_a = user === null || user === void 0 ? void 0 : user.factors) !== null && _a !== void 0 ? _a : []) {\n            data.all.push(factor);\n            if (factor.status === 'verified') {\n                ;\n                data[factor.factor_type].push(factor);\n            }\n        }\n        return {\n            data,\n            error: null,\n        };\n    }\n    /**\n     * {@see GoTrueMFAApi#getAuthenticatorAssuranceLevel}\n     */\n    async _getAuthenticatorAssuranceLevel() {\n        var _a, _b;\n        const { data: { session }, error: sessionError, } = await this.getSession();\n        if (sessionError) {\n            return this._returnResult({ data: null, error: sessionError });\n        }\n        if (!session) {\n            return {\n                data: { currentLevel: null, nextLevel: null, currentAuthenticationMethods: [] },\n                error: null,\n            };\n        }\n        const { payload } = decodeJWT(session.access_token);\n        let currentLevel = null;\n        if (payload.aal) {\n            currentLevel = payload.aal;\n        }\n        let nextLevel = currentLevel;\n        const verifiedFactors = (_b = (_a = session.user.factors) === null || _a === void 0 ? void 0 : _a.filter((factor) => factor.status === 'verified')) !== null && _b !== void 0 ? _b : [];\n        if (verifiedFactors.length > 0) {\n            nextLevel = 'aal2';\n        }\n        const currentAuthenticationMethods = payload.amr || [];\n        return { data: { currentLevel, nextLevel, currentAuthenticationMethods }, error: null };\n    }\n    /**\n     * Retrieves details about an OAuth authorization request.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     *\n     * Returns authorization details including client info, scopes, and user information.\n     * If the API returns a redirect_uri, it means consent was already given - the caller\n     * should handle the redirect manually if needed.\n     */\n    async _getAuthorizationDetails(authorizationId) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                return await _request(this.fetch, 'GET', `${this.url}/oauth/authorizations/${authorizationId}`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    xform: (data) => ({ data, error: null }),\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Approves an OAuth authorization request.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     */\n    async _approveAuthorization(authorizationId, options) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                const response = await _request(this.fetch, 'POST', `${this.url}/oauth/authorizations/${authorizationId}/consent`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    body: { action: 'approve' },\n                    xform: (data) => ({ data, error: null }),\n                });\n                if (response.data && response.data.redirect_url) {\n                    // Automatically redirect in browser unless skipBrowserRedirect is true\n                    if (isBrowser() && !(options === null || options === void 0 ? void 0 : options.skipBrowserRedirect)) {\n                        window.location.assign(response.data.redirect_url);\n                    }\n                }\n                return response;\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Denies an OAuth authorization request.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     */\n    async _denyAuthorization(authorizationId, options) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                const response = await _request(this.fetch, 'POST', `${this.url}/oauth/authorizations/${authorizationId}/consent`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    body: { action: 'deny' },\n                    xform: (data) => ({ data, error: null }),\n                });\n                if (response.data && response.data.redirect_url) {\n                    // Automatically redirect in browser unless skipBrowserRedirect is true\n                    if (isBrowser() && !(options === null || options === void 0 ? void 0 : options.skipBrowserRedirect)) {\n                        window.location.assign(response.data.redirect_url);\n                    }\n                }\n                return response;\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Lists all OAuth grants that the authenticated user has authorized.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     */\n    async _listOAuthGrants() {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                return await _request(this.fetch, 'GET', `${this.url}/user/oauth/grants`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    xform: (data) => ({ data, error: null }),\n                });\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    /**\n     * Revokes a user's OAuth grant for a specific client.\n     * Only relevant when the OAuth 2.1 server is enabled in Supabase Auth.\n     */\n    async _revokeOAuthGrant(options) {\n        try {\n            return await this._useSession(async (result) => {\n                const { data: { session }, error: sessionError, } = result;\n                if (sessionError) {\n                    return this._returnResult({ data: null, error: sessionError });\n                }\n                if (!session) {\n                    return this._returnResult({ data: null, error: new AuthSessionMissingError() });\n                }\n                await _request(this.fetch, 'DELETE', `${this.url}/user/oauth/grants`, {\n                    headers: this.headers,\n                    jwt: session.access_token,\n                    query: { client_id: options.clientId },\n                    noResolveJson: true,\n                });\n                return { data: {}, error: null };\n            });\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n    async fetchJwk(kid, jwks = { keys: [] }) {\n        // try fetching from the supplied jwks\n        let jwk = jwks.keys.find((key) => key.kid === kid);\n        if (jwk) {\n            return jwk;\n        }\n        const now = Date.now();\n        // try fetching from cache\n        jwk = this.jwks.keys.find((key) => key.kid === kid);\n        // jwk exists and jwks isn't stale\n        if (jwk && this.jwks_cached_at + JWKS_TTL > now) {\n            return jwk;\n        }\n        // jwk isn't cached in memory so we need to fetch it from the well-known endpoint\n        const { data, error } = await _request(this.fetch, 'GET', `${this.url}/.well-known/jwks.json`, {\n            headers: this.headers,\n        });\n        if (error) {\n            throw error;\n        }\n        if (!data.keys || data.keys.length === 0) {\n            return null;\n        }\n        this.jwks = data;\n        this.jwks_cached_at = now;\n        // Find the signing key\n        jwk = data.keys.find((key) => key.kid === kid);\n        if (!jwk) {\n            return null;\n        }\n        return jwk;\n    }\n    /**\n     * Extracts the JWT claims present in the access token by first verifying the\n     * JWT against the server's JSON Web Key Set endpoint\n     * `/.well-known/jwks.json` which is often cached, resulting in significantly\n     * faster responses. Prefer this method over {@link #getUser} which always\n     * sends a request to the Auth server for each JWT.\n     *\n     * If the project is not using an asymmetric JWT signing key (like ECC or\n     * RSA) it always sends a request to the Auth server (similar to {@link\n     * #getUser}) to verify the JWT.\n     *\n     * @param jwt An optional specific JWT you wish to verify, not the one you\n     *            can obtain from {@link #getSession}.\n     * @param options Various additional options that allow you to customize the\n     *                behavior of this method.\n     */\n    async getClaims(jwt, options = {}) {\n        try {\n            let token = jwt;\n            if (!token) {\n                const { data, error } = await this.getSession();\n                if (error || !data.session) {\n                    return this._returnResult({ data: null, error });\n                }\n                token = data.session.access_token;\n            }\n            const { header, payload, signature, raw: { header: rawHeader, payload: rawPayload }, } = decodeJWT(token);\n            if (!(options === null || options === void 0 ? void 0 : options.allowExpired)) {\n                // Reject expired JWTs should only happen if jwt argument was passed\n                validateExp(payload.exp);\n            }\n            const signingKey = !header.alg ||\n                header.alg.startsWith('HS') ||\n                !header.kid ||\n                !('crypto' in globalThis && 'subtle' in globalThis.crypto)\n                ? null\n                : await this.fetchJwk(header.kid, (options === null || options === void 0 ? void 0 : options.keys) ? { keys: options.keys } : options === null || options === void 0 ? void 0 : options.jwks);\n            // If symmetric algorithm or WebCrypto API is unavailable, fallback to getUser()\n            if (!signingKey) {\n                const { error } = await this.getUser(token);\n                if (error) {\n                    throw error;\n                }\n                // getUser succeeds so the claims in the JWT can be trusted\n                return {\n                    data: {\n                        claims: payload,\n                        header,\n                        signature,\n                    },\n                    error: null,\n                };\n            }\n            const algorithm = getAlgorithm(header.alg);\n            // Convert JWK to CryptoKey\n            const publicKey = await crypto.subtle.importKey('jwk', signingKey, algorithm, true, [\n                'verify',\n            ]);\n            // Verify the signature\n            const isValid = await crypto.subtle.verify(algorithm, publicKey, signature, stringToUint8Array(`${rawHeader}.${rawPayload}`));\n            if (!isValid) {\n                throw new AuthInvalidJwtError('Invalid JWT signature');\n            }\n            // If verification succeeds, decode and return claims\n            return {\n                data: {\n                    claims: payload,\n                    header,\n                    signature,\n                },\n                error: null,\n            };\n        }\n        catch (error) {\n            if (isAuthError(error)) {\n                return this._returnResult({ data: null, error });\n            }\n            throw error;\n        }\n    }\n}\nGoTrueClient.nextInstanceID = {};\nexport default GoTrueClient;\n//# sourceMappingURL=GoTrueClient.js.map","import GoTrueClient from './GoTrueClient';\nconst AuthClient = GoTrueClient;\nexport default AuthClient;\n//# sourceMappingURL=AuthClient.js.map","import { AuthClient } from '@supabase/auth-js';\nexport class SupabaseAuthClient extends AuthClient {\n    constructor(options) {\n        super(options);\n    }\n}\n//# sourceMappingURL=SupabaseAuthClient.js.map","import { FunctionsClient } from '@supabase/functions-js';\nimport { PostgrestClient, } from '@supabase/postgrest-js';\nimport { RealtimeClient, } from '@supabase/realtime-js';\nimport { StorageClient as SupabaseStorageClient } from '@supabase/storage-js';\nimport { DEFAULT_AUTH_OPTIONS, DEFAULT_DB_OPTIONS, DEFAULT_GLOBAL_OPTIONS, DEFAULT_REALTIME_OPTIONS, } from './lib/constants';\nimport { fetchWithAuth } from './lib/fetch';\nimport { applySettingDefaults, validateSupabaseUrl } from './lib/helpers';\nimport { SupabaseAuthClient } from './lib/SupabaseAuthClient';\n/**\n * Supabase Client.\n *\n * An isomorphic Javascript client for interacting with Postgres.\n */\nexport default class SupabaseClient {\n    /**\n     * Create a new client for use in the browser.\n     * @param supabaseUrl The unique Supabase URL which is supplied when you create a new project in your project dashboard.\n     * @param supabaseKey The unique Supabase Key which is supplied when you create a new project in your project dashboard.\n     * @param options.db.schema You can switch in between schemas. The schema needs to be on the list of exposed schemas inside Supabase.\n     * @param options.auth.autoRefreshToken Set to \"true\" if you want to automatically refresh the token before expiring.\n     * @param options.auth.persistSession Set to \"true\" if you want to automatically save the user session into local storage.\n     * @param options.auth.detectSessionInUrl Set to \"true\" if you want to automatically detects OAuth grants in the URL and signs in the user.\n     * @param options.realtime Options passed along to realtime-js constructor.\n     * @param options.storage Options passed along to the storage-js constructor.\n     * @param options.global.fetch A custom fetch implementation.\n     * @param options.global.headers Any additional headers to send with each network request.\n     * @example\n     * ```ts\n     * import { createClient } from '@supabase/supabase-js'\n     *\n     * const supabase = createClient('https://xyzcompany.supabase.co', 'public-anon-key')\n     * const { data } = await supabase.from('profiles').select('*')\n     * ```\n     */\n    constructor(supabaseUrl, supabaseKey, options) {\n        var _a, _b, _c;\n        this.supabaseUrl = supabaseUrl;\n        this.supabaseKey = supabaseKey;\n        const baseUrl = validateSupabaseUrl(supabaseUrl);\n        if (!supabaseKey)\n            throw new Error('supabaseKey is required.');\n        this.realtimeUrl = new URL('realtime/v1', baseUrl);\n        this.realtimeUrl.protocol = this.realtimeUrl.protocol.replace('http', 'ws');\n        this.authUrl = new URL('auth/v1', baseUrl);\n        this.storageUrl = new URL('storage/v1', baseUrl);\n        this.functionsUrl = new URL('functions/v1', baseUrl);\n        // default storage key uses the supabase project ref as a namespace\n        const defaultStorageKey = `sb-${baseUrl.hostname.split('.')[0]}-auth-token`;\n        const DEFAULTS = {\n            db: DEFAULT_DB_OPTIONS,\n            realtime: DEFAULT_REALTIME_OPTIONS,\n            auth: Object.assign(Object.assign({}, DEFAULT_AUTH_OPTIONS), { storageKey: defaultStorageKey }),\n            global: DEFAULT_GLOBAL_OPTIONS,\n        };\n        const settings = applySettingDefaults(options !== null && options !== void 0 ? options : {}, DEFAULTS);\n        this.storageKey = (_a = settings.auth.storageKey) !== null && _a !== void 0 ? _a : '';\n        this.headers = (_b = settings.global.headers) !== null && _b !== void 0 ? _b : {};\n        if (!settings.accessToken) {\n            this.auth = this._initSupabaseAuthClient((_c = settings.auth) !== null && _c !== void 0 ? _c : {}, this.headers, settings.global.fetch);\n        }\n        else {\n            this.accessToken = settings.accessToken;\n            this.auth = new Proxy({}, {\n                get: (_, prop) => {\n                    throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(prop)} is not possible`);\n                },\n            });\n        }\n        this.fetch = fetchWithAuth(supabaseKey, this._getAccessToken.bind(this), settings.global.fetch);\n        this.realtime = this._initRealtimeClient(Object.assign({ headers: this.headers, accessToken: this._getAccessToken.bind(this) }, settings.realtime));\n        if (this.accessToken) {\n            // Start auth immediately to avoid race condition with channel subscriptions\n            this.accessToken()\n                .then((token) => this.realtime.setAuth(token))\n                .catch((e) => console.warn('Failed to set initial Realtime auth token:', e));\n        }\n        this.rest = new PostgrestClient(new URL('rest/v1', baseUrl).href, {\n            headers: this.headers,\n            schema: settings.db.schema,\n            fetch: this.fetch,\n        });\n        this.storage = new SupabaseStorageClient(this.storageUrl.href, this.headers, this.fetch, options === null || options === void 0 ? void 0 : options.storage);\n        if (!settings.accessToken) {\n            this._listenForAuthEvents();\n        }\n    }\n    /**\n     * Supabase Functions allows you to deploy and invoke edge functions.\n     */\n    get functions() {\n        return new FunctionsClient(this.functionsUrl.href, {\n            headers: this.headers,\n            customFetch: this.fetch,\n        });\n    }\n    /**\n     * Perform a query on a table or a view.\n     *\n     * @param relation - The table or view name to query\n     */\n    from(relation) {\n        return this.rest.from(relation);\n    }\n    // NOTE: signatures must be kept in sync with PostgrestClient.schema\n    /**\n     * Select a schema to query or perform an function (rpc) call.\n     *\n     * The schema needs to be on the list of exposed schemas inside Supabase.\n     *\n     * @param schema - The schema to query\n     */\n    schema(schema) {\n        return this.rest.schema(schema);\n    }\n    // NOTE: signatures must be kept in sync with PostgrestClient.rpc\n    /**\n     * Perform a function call.\n     *\n     * @param fn - The function name to call\n     * @param args - The arguments to pass to the function call\n     * @param options - Named parameters\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     * @param options.get - When set to `true`, the function will be called with\n     * read-only access mode.\n     * @param options.count - Count algorithm to use to count rows returned by the\n     * function. Only applicable for [set-returning\n     * functions](https://www.postgresql.org/docs/current/functions-srf.html).\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     */\n    rpc(fn, args = {}, options = {\n        head: false,\n        get: false,\n        count: undefined,\n    }) {\n        return this.rest.rpc(fn, args, options);\n    }\n    /**\n     * Creates a Realtime channel with Broadcast, Presence, and Postgres Changes.\n     *\n     * @param {string} name - The name of the Realtime channel.\n     * @param {Object} opts - The options to pass to the Realtime channel.\n     *\n     */\n    channel(name, opts = { config: {} }) {\n        return this.realtime.channel(name, opts);\n    }\n    /**\n     * Returns all Realtime channels.\n     */\n    getChannels() {\n        return this.realtime.getChannels();\n    }\n    /**\n     * Unsubscribes and removes Realtime channel from Realtime client.\n     *\n     * @param {RealtimeChannel} channel - The name of the Realtime channel.\n     *\n     */\n    removeChannel(channel) {\n        return this.realtime.removeChannel(channel);\n    }\n    /**\n     * Unsubscribes and removes all Realtime channels from Realtime client.\n     */\n    removeAllChannels() {\n        return this.realtime.removeAllChannels();\n    }\n    async _getAccessToken() {\n        var _a, _b;\n        if (this.accessToken) {\n            return await this.accessToken();\n        }\n        const { data } = await this.auth.getSession();\n        return (_b = (_a = data.session) === null || _a === void 0 ? void 0 : _a.access_token) !== null && _b !== void 0 ? _b : this.supabaseKey;\n    }\n    _initSupabaseAuthClient({ autoRefreshToken, persistSession, detectSessionInUrl, storage, userStorage, storageKey, flowType, lock, debug, throwOnError, }, headers, fetch) {\n        const authHeaders = {\n            Authorization: `Bearer ${this.supabaseKey}`,\n            apikey: `${this.supabaseKey}`,\n        };\n        return new SupabaseAuthClient({\n            url: this.authUrl.href,\n            headers: Object.assign(Object.assign({}, authHeaders), headers),\n            storageKey: storageKey,\n            autoRefreshToken,\n            persistSession,\n            detectSessionInUrl,\n            storage,\n            userStorage,\n            flowType,\n            lock,\n            debug,\n            throwOnError,\n            fetch,\n            // auth checks if there is a custom authorizaiton header using this flag\n            // so it knows whether to return an error when getUser is called with no session\n            hasCustomAuthorizationHeader: Object.keys(this.headers).some((key) => key.toLowerCase() === 'authorization'),\n        });\n    }\n    _initRealtimeClient(options) {\n        return new RealtimeClient(this.realtimeUrl.href, Object.assign(Object.assign({}, options), { params: Object.assign({ apikey: this.supabaseKey }, options === null || options === void 0 ? void 0 : options.params) }));\n    }\n    _listenForAuthEvents() {\n        const data = this.auth.onAuthStateChange((event, session) => {\n            this._handleTokenChanged(event, 'CLIENT', session === null || session === void 0 ? void 0 : session.access_token);\n        });\n        return data;\n    }\n    _handleTokenChanged(event, source, token) {\n        if ((event === 'TOKEN_REFRESHED' || event === 'SIGNED_IN') &&\n            this.changedAccessToken !== token) {\n            this.changedAccessToken = token;\n            this.realtime.setAuth(token);\n        }\n        else if (event === 'SIGNED_OUT') {\n            this.realtime.setAuth();\n            if (source == 'STORAGE')\n                this.auth.signOut();\n            this.changedAccessToken = undefined;\n        }\n    }\n}\n//# sourceMappingURL=SupabaseClient.js.map","import SupabaseClient from './SupabaseClient';\nexport * from '@supabase/auth-js';\nexport { PostgrestError, } from '@supabase/postgrest-js';\nexport { FunctionsHttpError, FunctionsFetchError, FunctionsRelayError, FunctionsError, FunctionRegion, } from '@supabase/functions-js';\nexport * from '@supabase/realtime-js';\nexport { default as SupabaseClient } from './SupabaseClient';\n/**\n * Creates a new Supabase Client.\n *\n * @example\n * ```ts\n * import { createClient } from '@supabase/supabase-js'\n *\n * const supabase = createClient('https://xyzcompany.supabase.co', 'public-anon-key')\n * const { data, error } = await supabase.from('profiles').select('*')\n * ```\n */\nexport const createClient = (supabaseUrl, supabaseKey, options) => {\n    return new SupabaseClient(supabaseUrl, supabaseKey, options);\n};\n// Check for Node.js <= 18 deprecation\nfunction shouldShowDeprecationWarning() {\n    // Skip in browser environments\n    if (typeof window !== 'undefined') {\n        return false;\n    }\n    // Skip if process is not available (e.g., Edge Runtime)\n    if (typeof process === 'undefined') {\n        return false;\n    }\n    // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\n    const processVersion = process['version'];\n    if (processVersion === undefined || processVersion === null) {\n        return false;\n    }\n    const versionMatch = processVersion.match(/^v(\\d+)\\./);\n    if (!versionMatch) {\n        return false;\n    }\n    const majorVersion = parseInt(versionMatch[1], 10);\n    return majorVersion <= 18;\n}\nif (shouldShowDeprecationWarning()) {\n    console.warn(`  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. ` +\n        `Please upgrade to Node.js 20 or later. ` +\n        `For more information, visit: https://github.com/orgs/supabase/discussions/37217`);\n}\n//# sourceMappingURL=index.js.map","/*! Capacitor: https://capacitorjs.com/ - MIT License */\nvar ExceptionCode;\n(function (ExceptionCode) {\n    /**\n     * API is not implemented.\n     *\n     * This usually means the API can't be used because it is not implemented for\n     * the current platform.\n     */\n    ExceptionCode[\"Unimplemented\"] = \"UNIMPLEMENTED\";\n    /**\n     * API is not available.\n     *\n     * This means the API can't be used right now because:\n     *   - it is currently missing a prerequisite, such as network connectivity\n     *   - it requires a particular platform or browser version\n     */\n    ExceptionCode[\"Unavailable\"] = \"UNAVAILABLE\";\n})(ExceptionCode || (ExceptionCode = {}));\nclass CapacitorException extends Error {\n    constructor(message, code, data) {\n        super(message);\n        this.message = message;\n        this.code = code;\n        this.data = data;\n    }\n}\nconst getPlatformId = (win) => {\n    var _a, _b;\n    if (win === null || win === void 0 ? void 0 : win.androidBridge) {\n        return 'android';\n    }\n    else if ((_b = (_a = win === null || win === void 0 ? void 0 : win.webkit) === null || _a === void 0 ? void 0 : _a.messageHandlers) === null || _b === void 0 ? void 0 : _b.bridge) {\n        return 'ios';\n    }\n    else {\n        return 'web';\n    }\n};\n\nconst createCapacitor = (win) => {\n    const capCustomPlatform = win.CapacitorCustomPlatform || null;\n    const cap = win.Capacitor || {};\n    const Plugins = (cap.Plugins = cap.Plugins || {});\n    const getPlatform = () => {\n        return capCustomPlatform !== null ? capCustomPlatform.name : getPlatformId(win);\n    };\n    const isNativePlatform = () => getPlatform() !== 'web';\n    const isPluginAvailable = (pluginName) => {\n        const plugin = registeredPlugins.get(pluginName);\n        if (plugin === null || plugin === void 0 ? void 0 : plugin.platforms.has(getPlatform())) {\n            // JS implementation available for the current platform.\n            return true;\n        }\n        if (getPluginHeader(pluginName)) {\n            // Native implementation available.\n            return true;\n        }\n        return false;\n    };\n    const getPluginHeader = (pluginName) => { var _a; return (_a = cap.PluginHeaders) === null || _a === void 0 ? void 0 : _a.find((h) => h.name === pluginName); };\n    const handleError = (err) => win.console.error(err);\n    const registeredPlugins = new Map();\n    const registerPlugin = (pluginName, jsImplementations = {}) => {\n        const registeredPlugin = registeredPlugins.get(pluginName);\n        if (registeredPlugin) {\n            console.warn(`Capacitor plugin \"${pluginName}\" already registered. Cannot register plugins twice.`);\n            return registeredPlugin.proxy;\n        }\n        const platform = getPlatform();\n        const pluginHeader = getPluginHeader(pluginName);\n        let jsImplementation;\n        const loadPluginImplementation = async () => {\n            if (!jsImplementation && platform in jsImplementations) {\n                jsImplementation =\n                    typeof jsImplementations[platform] === 'function'\n                        ? (jsImplementation = await jsImplementations[platform]())\n                        : (jsImplementation = jsImplementations[platform]);\n            }\n            else if (capCustomPlatform !== null && !jsImplementation && 'web' in jsImplementations) {\n                jsImplementation =\n                    typeof jsImplementations['web'] === 'function'\n                        ? (jsImplementation = await jsImplementations['web']())\n                        : (jsImplementation = jsImplementations['web']);\n            }\n            return jsImplementation;\n        };\n        const createPluginMethod = (impl, prop) => {\n            var _a, _b;\n            if (pluginHeader) {\n                const methodHeader = pluginHeader === null || pluginHeader === void 0 ? void 0 : pluginHeader.methods.find((m) => prop === m.name);\n                if (methodHeader) {\n                    if (methodHeader.rtype === 'promise') {\n                        return (options) => cap.nativePromise(pluginName, prop.toString(), options);\n                    }\n                    else {\n                        return (options, callback) => cap.nativeCallback(pluginName, prop.toString(), options, callback);\n                    }\n                }\n                else if (impl) {\n                    return (_a = impl[prop]) === null || _a === void 0 ? void 0 : _a.bind(impl);\n                }\n            }\n            else if (impl) {\n                return (_b = impl[prop]) === null || _b === void 0 ? void 0 : _b.bind(impl);\n            }\n            else {\n                throw new CapacitorException(`\"${pluginName}\" plugin is not implemented on ${platform}`, ExceptionCode.Unimplemented);\n            }\n        };\n        const createPluginMethodWrapper = (prop) => {\n            let remove;\n            const wrapper = (...args) => {\n                const p = loadPluginImplementation().then((impl) => {\n                    const fn = createPluginMethod(impl, prop);\n                    if (fn) {\n                        const p = fn(...args);\n                        remove = p === null || p === void 0 ? void 0 : p.remove;\n                        return p;\n                    }\n                    else {\n                        throw new CapacitorException(`\"${pluginName}.${prop}()\" is not implemented on ${platform}`, ExceptionCode.Unimplemented);\n                    }\n                });\n                if (prop === 'addListener') {\n                    p.remove = async () => remove();\n                }\n                return p;\n            };\n            // Some flair \n            wrapper.toString = () => `${prop.toString()}() { [capacitor code] }`;\n            Object.defineProperty(wrapper, 'name', {\n                value: prop,\n                writable: false,\n                configurable: false,\n            });\n            return wrapper;\n        };\n        const addListener = createPluginMethodWrapper('addListener');\n        const removeListener = createPluginMethodWrapper('removeListener');\n        const addListenerNative = (eventName, callback) => {\n            const call = addListener({ eventName }, callback);\n            const remove = async () => {\n                const callbackId = await call;\n                removeListener({\n                    eventName,\n                    callbackId,\n                }, callback);\n            };\n            const p = new Promise((resolve) => call.then(() => resolve({ remove })));\n            p.remove = async () => {\n                console.warn(`Using addListener() without 'await' is deprecated.`);\n                await remove();\n            };\n            return p;\n        };\n        const proxy = new Proxy({}, {\n            get(_, prop) {\n                switch (prop) {\n                    // https://github.com/facebook/react/issues/20030\n                    case '$$typeof':\n                        return undefined;\n                    case 'toJSON':\n                        return () => ({});\n                    case 'addListener':\n                        return pluginHeader ? addListenerNative : addListener;\n                    case 'removeListener':\n                        return removeListener;\n                    default:\n                        return createPluginMethodWrapper(prop);\n                }\n            },\n        });\n        Plugins[pluginName] = proxy;\n        registeredPlugins.set(pluginName, {\n            name: pluginName,\n            proxy,\n            platforms: new Set([...Object.keys(jsImplementations), ...(pluginHeader ? [platform] : [])]),\n        });\n        return proxy;\n    };\n    // Add in convertFileSrc for web, it will already be available in native context\n    if (!cap.convertFileSrc) {\n        cap.convertFileSrc = (filePath) => filePath;\n    }\n    cap.getPlatform = getPlatform;\n    cap.handleError = handleError;\n    cap.isNativePlatform = isNativePlatform;\n    cap.isPluginAvailable = isPluginAvailable;\n    cap.registerPlugin = registerPlugin;\n    cap.Exception = CapacitorException;\n    cap.DEBUG = !!cap.DEBUG;\n    cap.isLoggingEnabled = !!cap.isLoggingEnabled;\n    return cap;\n};\nconst initCapacitorGlobal = (win) => (win.Capacitor = createCapacitor(win));\n\nconst Capacitor = /*#__PURE__*/ initCapacitorGlobal(typeof globalThis !== 'undefined'\n    ? globalThis\n    : typeof self !== 'undefined'\n        ? self\n        : typeof window !== 'undefined'\n            ? window\n            : typeof global !== 'undefined'\n                ? global\n                : {});\nconst registerPlugin = Capacitor.registerPlugin;\n\n/**\n * Base class web plugins should extend.\n */\nclass WebPlugin {\n    constructor() {\n        this.listeners = {};\n        this.retainedEventArguments = {};\n        this.windowListeners = {};\n    }\n    addListener(eventName, listenerFunc) {\n        let firstListener = false;\n        const listeners = this.listeners[eventName];\n        if (!listeners) {\n            this.listeners[eventName] = [];\n            firstListener = true;\n        }\n        this.listeners[eventName].push(listenerFunc);\n        // If we haven't added a window listener for this event and it requires one,\n        // go ahead and add it\n        const windowListener = this.windowListeners[eventName];\n        if (windowListener && !windowListener.registered) {\n            this.addWindowListener(windowListener);\n        }\n        if (firstListener) {\n            this.sendRetainedArgumentsForEvent(eventName);\n        }\n        const remove = async () => this.removeListener(eventName, listenerFunc);\n        const p = Promise.resolve({ remove });\n        return p;\n    }\n    async removeAllListeners() {\n        this.listeners = {};\n        for (const listener in this.windowListeners) {\n            this.removeWindowListener(this.windowListeners[listener]);\n        }\n        this.windowListeners = {};\n    }\n    notifyListeners(eventName, data, retainUntilConsumed) {\n        const listeners = this.listeners[eventName];\n        if (!listeners) {\n            if (retainUntilConsumed) {\n                let args = this.retainedEventArguments[eventName];\n                if (!args) {\n                    args = [];\n                }\n                args.push(data);\n                this.retainedEventArguments[eventName] = args;\n            }\n            return;\n        }\n        listeners.forEach((listener) => listener(data));\n    }\n    hasListeners(eventName) {\n        var _a;\n        return !!((_a = this.listeners[eventName]) === null || _a === void 0 ? void 0 : _a.length);\n    }\n    registerWindowListener(windowEventName, pluginEventName) {\n        this.windowListeners[pluginEventName] = {\n            registered: false,\n            windowEventName,\n            pluginEventName,\n            handler: (event) => {\n                this.notifyListeners(pluginEventName, event);\n            },\n        };\n    }\n    unimplemented(msg = 'not implemented') {\n        return new Capacitor.Exception(msg, ExceptionCode.Unimplemented);\n    }\n    unavailable(msg = 'not available') {\n        return new Capacitor.Exception(msg, ExceptionCode.Unavailable);\n    }\n    async removeListener(eventName, listenerFunc) {\n        const listeners = this.listeners[eventName];\n        if (!listeners) {\n            return;\n        }\n        const index = listeners.indexOf(listenerFunc);\n        this.listeners[eventName].splice(index, 1);\n        // If there are no more listeners for this type of event,\n        // remove the window listener\n        if (!this.listeners[eventName].length) {\n            this.removeWindowListener(this.windowListeners[eventName]);\n        }\n    }\n    addWindowListener(handle) {\n        window.addEventListener(handle.windowEventName, handle.handler);\n        handle.registered = true;\n    }\n    removeWindowListener(handle) {\n        if (!handle) {\n            return;\n        }\n        window.removeEventListener(handle.windowEventName, handle.handler);\n        handle.registered = false;\n    }\n    sendRetainedArgumentsForEvent(eventName) {\n        const args = this.retainedEventArguments[eventName];\n        if (!args) {\n            return;\n        }\n        delete this.retainedEventArguments[eventName];\n        args.forEach((arg) => {\n            this.notifyListeners(eventName, arg);\n        });\n    }\n}\n\nconst WebView = /*#__PURE__*/ registerPlugin('WebView');\n/******** END WEB VIEW PLUGIN ********/\n/******** COOKIES PLUGIN ********/\n/**\n * Safely web encode a string value (inspired by js-cookie)\n * @param str The string value to encode\n */\nconst encode = (str) => encodeURIComponent(str)\n    .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n    .replace(/[()]/g, escape);\n/**\n * Safely web decode a string value (inspired by js-cookie)\n * @param str The string value to decode\n */\nconst decode = (str) => str.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent);\nclass CapacitorCookiesPluginWeb extends WebPlugin {\n    async getCookies() {\n        const cookies = document.cookie;\n        const cookieMap = {};\n        cookies.split(';').forEach((cookie) => {\n            if (cookie.length <= 0)\n                return;\n            // Replace first \"=\" with CAP_COOKIE to prevent splitting on additional \"=\"\n            let [key, value] = cookie.replace(/=/, 'CAP_COOKIE').split('CAP_COOKIE');\n            key = decode(key).trim();\n            value = decode(value).trim();\n            cookieMap[key] = value;\n        });\n        return cookieMap;\n    }\n    async setCookie(options) {\n        try {\n            // Safely Encoded Key/Value\n            const encodedKey = encode(options.key);\n            const encodedValue = encode(options.value);\n            // Clean & sanitize options\n            const expires = `; expires=${(options.expires || '').replace('expires=', '')}`; // Default is \"; expires=\"\n            const path = (options.path || '/').replace('path=', ''); // Default is \"path=/\"\n            const domain = options.url != null && options.url.length > 0 ? `domain=${options.url}` : '';\n            document.cookie = `${encodedKey}=${encodedValue || ''}${expires}; path=${path}; ${domain};`;\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n    async deleteCookie(options) {\n        try {\n            document.cookie = `${options.key}=; Max-Age=0`;\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n    async clearCookies() {\n        try {\n            const cookies = document.cookie.split(';') || [];\n            for (const cookie of cookies) {\n                document.cookie = cookie.replace(/^ +/, '').replace(/=.*/, `=;expires=${new Date().toUTCString()};path=/`);\n            }\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n    async clearAllCookies() {\n        try {\n            await this.clearCookies();\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n}\nconst CapacitorCookies = registerPlugin('CapacitorCookies', {\n    web: () => new CapacitorCookiesPluginWeb(),\n});\n// UTILITY FUNCTIONS\n/**\n * Read in a Blob value and return it as a base64 string\n * @param blob The blob value to convert to a base64 string\n */\nconst readBlobAsBase64 = async (blob) => new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n        const base64String = reader.result;\n        // remove prefix \"data:application/pdf;base64,\"\n        resolve(base64String.indexOf(',') >= 0 ? base64String.split(',')[1] : base64String);\n    };\n    reader.onerror = (error) => reject(error);\n    reader.readAsDataURL(blob);\n});\n/**\n * Normalize an HttpHeaders map by lowercasing all of the values\n * @param headers The HttpHeaders object to normalize\n */\nconst normalizeHttpHeaders = (headers = {}) => {\n    const originalKeys = Object.keys(headers);\n    const loweredKeys = Object.keys(headers).map((k) => k.toLocaleLowerCase());\n    const normalized = loweredKeys.reduce((acc, key, index) => {\n        acc[key] = headers[originalKeys[index]];\n        return acc;\n    }, {});\n    return normalized;\n};\n/**\n * Builds a string of url parameters that\n * @param params A map of url parameters\n * @param shouldEncode true if you should encodeURIComponent() the values (true by default)\n */\nconst buildUrlParams = (params, shouldEncode = true) => {\n    if (!params)\n        return null;\n    const output = Object.entries(params).reduce((accumulator, entry) => {\n        const [key, value] = entry;\n        let encodedValue;\n        let item;\n        if (Array.isArray(value)) {\n            item = '';\n            value.forEach((str) => {\n                encodedValue = shouldEncode ? encodeURIComponent(str) : str;\n                item += `${key}=${encodedValue}&`;\n            });\n            // last character will always be \"&\" so slice it off\n            item.slice(0, -1);\n        }\n        else {\n            encodedValue = shouldEncode ? encodeURIComponent(value) : value;\n            item = `${key}=${encodedValue}`;\n        }\n        return `${accumulator}&${item}`;\n    }, '');\n    // Remove initial \"&\" from the reduce\n    return output.substr(1);\n};\n/**\n * Build the RequestInit object based on the options passed into the initial request\n * @param options The Http plugin options\n * @param extra Any extra RequestInit values\n */\nconst buildRequestInit = (options, extra = {}) => {\n    const output = Object.assign({ method: options.method || 'GET', headers: options.headers }, extra);\n    // Get the content-type\n    const headers = normalizeHttpHeaders(options.headers);\n    const type = headers['content-type'] || '';\n    // If body is already a string, then pass it through as-is.\n    if (typeof options.data === 'string') {\n        output.body = options.data;\n    }\n    // Build request initializers based off of content-type\n    else if (type.includes('application/x-www-form-urlencoded')) {\n        const params = new URLSearchParams();\n        for (const [key, value] of Object.entries(options.data || {})) {\n            params.set(key, value);\n        }\n        output.body = params.toString();\n    }\n    else if (type.includes('multipart/form-data') || options.data instanceof FormData) {\n        const form = new FormData();\n        if (options.data instanceof FormData) {\n            options.data.forEach((value, key) => {\n                form.append(key, value);\n            });\n        }\n        else {\n            for (const key of Object.keys(options.data)) {\n                form.append(key, options.data[key]);\n            }\n        }\n        output.body = form;\n        const headers = new Headers(output.headers);\n        headers.delete('content-type'); // content-type will be set by `window.fetch` to includy boundary\n        output.headers = headers;\n    }\n    else if (type.includes('application/json') || typeof options.data === 'object') {\n        output.body = JSON.stringify(options.data);\n    }\n    return output;\n};\n// WEB IMPLEMENTATION\nclass CapacitorHttpPluginWeb extends WebPlugin {\n    /**\n     * Perform an Http request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async request(options) {\n        const requestInit = buildRequestInit(options, options.webFetchExtra);\n        const urlParams = buildUrlParams(options.params, options.shouldEncodeUrlParams);\n        const url = urlParams ? `${options.url}?${urlParams}` : options.url;\n        const response = await fetch(url, requestInit);\n        const contentType = response.headers.get('content-type') || '';\n        // Default to 'text' responseType so no parsing happens\n        let { responseType = 'text' } = response.ok ? options : {};\n        // If the response content-type is json, force the response to be json\n        if (contentType.includes('application/json')) {\n            responseType = 'json';\n        }\n        let data;\n        let blob;\n        switch (responseType) {\n            case 'arraybuffer':\n            case 'blob':\n                blob = await response.blob();\n                data = await readBlobAsBase64(blob);\n                break;\n            case 'json':\n                data = await response.json();\n                break;\n            case 'document':\n            case 'text':\n            default:\n                data = await response.text();\n        }\n        // Convert fetch headers to Capacitor HttpHeaders\n        const headers = {};\n        response.headers.forEach((value, key) => {\n            headers[key] = value;\n        });\n        return {\n            data,\n            headers,\n            status: response.status,\n            url: response.url,\n        };\n    }\n    /**\n     * Perform an Http GET request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async get(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'GET' }));\n    }\n    /**\n     * Perform an Http POST request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async post(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'POST' }));\n    }\n    /**\n     * Perform an Http PUT request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async put(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'PUT' }));\n    }\n    /**\n     * Perform an Http PATCH request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async patch(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'PATCH' }));\n    }\n    /**\n     * Perform an Http DELETE request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async delete(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'DELETE' }));\n    }\n}\nconst CapacitorHttp = registerPlugin('CapacitorHttp', {\n    web: () => new CapacitorHttpPluginWeb(),\n});\n/******** END HTTP PLUGIN ********/\n/******** SYSTEM BARS PLUGIN ********/\n/**\n * Available status bar styles.\n */\nvar SystemBarsStyle;\n(function (SystemBarsStyle) {\n    /**\n     * Light system bar content on a dark background.\n     *\n     * @since 8.0.0\n     */\n    SystemBarsStyle[\"Dark\"] = \"DARK\";\n    /**\n     * For dark system bar content on a light background.\n     *\n     * @since 8.0.0\n     */\n    SystemBarsStyle[\"Light\"] = \"LIGHT\";\n    /**\n     * The style is based on the device appearance or the underlying content.\n     * If the device is using Dark mode, the system bars content will be light.\n     * If the device is using Light mode, the system bars content will be dark.\n     *\n     * @since 8.0.0\n     */\n    SystemBarsStyle[\"Default\"] = \"DEFAULT\";\n})(SystemBarsStyle || (SystemBarsStyle = {}));\n/**\n * Available system bar types.\n */\nvar SystemBarType;\n(function (SystemBarType) {\n    /**\n     * The top status bar on both Android and iOS.\n     *\n     * @since 8.0.0\n     */\n    SystemBarType[\"StatusBar\"] = \"StatusBar\";\n    /**\n     * The navigation bar (or gesture bar on iOS) on both Android and iOS.\n     *\n     * @since 8.0.0\n     */\n    SystemBarType[\"NavigationBar\"] = \"NavigationBar\";\n})(SystemBarType || (SystemBarType = {}));\nclass SystemBarsPluginWeb extends WebPlugin {\n    async setStyle() {\n        this.unavailable('not available for web');\n    }\n    async setAnimation() {\n        this.unavailable('not available for web');\n    }\n    async show() {\n        this.unavailable('not available for web');\n    }\n    async hide() {\n        this.unavailable('not available for web');\n    }\n}\nconst SystemBars = registerPlugin('SystemBars', {\n    web: () => new SystemBarsPluginWeb(),\n});\n/******** END SYSTEM BARS PLUGIN ********/\n\nexport { Capacitor, CapacitorCookies, CapacitorException, CapacitorHttp, ExceptionCode, SystemBarType, SystemBars, SystemBarsStyle, WebPlugin, WebView, buildRequestInit, registerPlugin };\n//# sourceMappingURL=index.js.map\n","import { registerPlugin } from '@capacitor/core';\nconst App = registerPlugin('App', {\n    web: () => import('./web').then(m => new m.AppWeb()),\n});\nexport * from './definitions';\nexport { App };\n//# sourceMappingURL=index.js.map","import { registerPlugin } from '@capacitor/core';\nconst Browser = registerPlugin('Browser', {\n    web: () => import('./web').then(m => new m.BrowserWeb()),\n});\nexport * from './definitions';\nexport { Browser };\n//# sourceMappingURL=index.js.map","export var util;\n(function (util) {\n    util.assertEqual = (_) => { };\n    function assertIs(_arg) { }\n    util.assertIs = assertIs;\n    function assertNever(_x) {\n        throw new Error();\n    }\n    util.assertNever = assertNever;\n    util.arrayToEnum = (items) => {\n        const obj = {};\n        for (const item of items) {\n            obj[item] = item;\n        }\n        return obj;\n    };\n    util.getValidEnumValues = (obj) => {\n        const validKeys = util.objectKeys(obj).filter((k) => typeof obj[obj[k]] !== \"number\");\n        const filtered = {};\n        for (const k of validKeys) {\n            filtered[k] = obj[k];\n        }\n        return util.objectValues(filtered);\n    };\n    util.objectValues = (obj) => {\n        return util.objectKeys(obj).map(function (e) {\n            return obj[e];\n        });\n    };\n    util.objectKeys = typeof Object.keys === \"function\" // eslint-disable-line ban/ban\n        ? (obj) => Object.keys(obj) // eslint-disable-line ban/ban\n        : (object) => {\n            const keys = [];\n            for (const key in object) {\n                if (Object.prototype.hasOwnProperty.call(object, key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        };\n    util.find = (arr, checker) => {\n        for (const item of arr) {\n            if (checker(item))\n                return item;\n        }\n        return undefined;\n    };\n    util.isInteger = typeof Number.isInteger === \"function\"\n        ? (val) => Number.isInteger(val) // eslint-disable-line ban/ban\n        : (val) => typeof val === \"number\" && Number.isFinite(val) && Math.floor(val) === val;\n    function joinValues(array, separator = \" | \") {\n        return array.map((val) => (typeof val === \"string\" ? `'${val}'` : val)).join(separator);\n    }\n    util.joinValues = joinValues;\n    util.jsonStringifyReplacer = (_, value) => {\n        if (typeof value === \"bigint\") {\n            return value.toString();\n        }\n        return value;\n    };\n})(util || (util = {}));\nexport var objectUtil;\n(function (objectUtil) {\n    objectUtil.mergeShapes = (first, second) => {\n        return {\n            ...first,\n            ...second, // second overwrites first\n        };\n    };\n})(objectUtil || (objectUtil = {}));\nexport const ZodParsedType = util.arrayToEnum([\n    \"string\",\n    \"nan\",\n    \"number\",\n    \"integer\",\n    \"float\",\n    \"boolean\",\n    \"date\",\n    \"bigint\",\n    \"symbol\",\n    \"function\",\n    \"undefined\",\n    \"null\",\n    \"array\",\n    \"object\",\n    \"unknown\",\n    \"promise\",\n    \"void\",\n    \"never\",\n    \"map\",\n    \"set\",\n]);\nexport const getParsedType = (data) => {\n    const t = typeof data;\n    switch (t) {\n        case \"undefined\":\n            return ZodParsedType.undefined;\n        case \"string\":\n            return ZodParsedType.string;\n        case \"number\":\n            return Number.isNaN(data) ? ZodParsedType.nan : ZodParsedType.number;\n        case \"boolean\":\n            return ZodParsedType.boolean;\n        case \"function\":\n            return ZodParsedType.function;\n        case \"bigint\":\n            return ZodParsedType.bigint;\n        case \"symbol\":\n            return ZodParsedType.symbol;\n        case \"object\":\n            if (Array.isArray(data)) {\n                return ZodParsedType.array;\n            }\n            if (data === null) {\n                return ZodParsedType.null;\n            }\n            if (data.then && typeof data.then === \"function\" && data.catch && typeof data.catch === \"function\") {\n                return ZodParsedType.promise;\n            }\n            if (typeof Map !== \"undefined\" && data instanceof Map) {\n                return ZodParsedType.map;\n            }\n            if (typeof Set !== \"undefined\" && data instanceof Set) {\n                return ZodParsedType.set;\n            }\n            if (typeof Date !== \"undefined\" && data instanceof Date) {\n                return ZodParsedType.date;\n            }\n            return ZodParsedType.object;\n        default:\n            return ZodParsedType.unknown;\n    }\n};\n","import { util } from \"./helpers/util.js\";\nexport const ZodIssueCode = util.arrayToEnum([\n    \"invalid_type\",\n    \"invalid_literal\",\n    \"custom\",\n    \"invalid_union\",\n    \"invalid_union_discriminator\",\n    \"invalid_enum_value\",\n    \"unrecognized_keys\",\n    \"invalid_arguments\",\n    \"invalid_return_type\",\n    \"invalid_date\",\n    \"invalid_string\",\n    \"too_small\",\n    \"too_big\",\n    \"invalid_intersection_types\",\n    \"not_multiple_of\",\n    \"not_finite\",\n]);\nexport const quotelessJson = (obj) => {\n    const json = JSON.stringify(obj, null, 2);\n    return json.replace(/\"([^\"]+)\":/g, \"$1:\");\n};\nexport class ZodError extends Error {\n    get errors() {\n        return this.issues;\n    }\n    constructor(issues) {\n        super();\n        this.issues = [];\n        this.addIssue = (sub) => {\n            this.issues = [...this.issues, sub];\n        };\n        this.addIssues = (subs = []) => {\n            this.issues = [...this.issues, ...subs];\n        };\n        const actualProto = new.target.prototype;\n        if (Object.setPrototypeOf) {\n            // eslint-disable-next-line ban/ban\n            Object.setPrototypeOf(this, actualProto);\n        }\n        else {\n            this.__proto__ = actualProto;\n        }\n        this.name = \"ZodError\";\n        this.issues = issues;\n    }\n    format(_mapper) {\n        const mapper = _mapper ||\n            function (issue) {\n                return issue.message;\n            };\n        const fieldErrors = { _errors: [] };\n        const processError = (error) => {\n            for (const issue of error.issues) {\n                if (issue.code === \"invalid_union\") {\n                    issue.unionErrors.map(processError);\n                }\n                else if (issue.code === \"invalid_return_type\") {\n                    processError(issue.returnTypeError);\n                }\n                else if (issue.code === \"invalid_arguments\") {\n                    processError(issue.argumentsError);\n                }\n                else if (issue.path.length === 0) {\n                    fieldErrors._errors.push(mapper(issue));\n                }\n                else {\n                    let curr = fieldErrors;\n                    let i = 0;\n                    while (i < issue.path.length) {\n                        const el = issue.path[i];\n                        const terminal = i === issue.path.length - 1;\n                        if (!terminal) {\n                            curr[el] = curr[el] || { _errors: [] };\n                            // if (typeof el === \"string\") {\n                            //   curr[el] = curr[el] || { _errors: [] };\n                            // } else if (typeof el === \"number\") {\n                            //   const errorArray: any = [];\n                            //   errorArray._errors = [];\n                            //   curr[el] = curr[el] || errorArray;\n                            // }\n                        }\n                        else {\n                            curr[el] = curr[el] || { _errors: [] };\n                            curr[el]._errors.push(mapper(issue));\n                        }\n                        curr = curr[el];\n                        i++;\n                    }\n                }\n            }\n        };\n        processError(this);\n        return fieldErrors;\n    }\n    static assert(value) {\n        if (!(value instanceof ZodError)) {\n            throw new Error(`Not a ZodError: ${value}`);\n        }\n    }\n    toString() {\n        return this.message;\n    }\n    get message() {\n        return JSON.stringify(this.issues, util.jsonStringifyReplacer, 2);\n    }\n    get isEmpty() {\n        return this.issues.length === 0;\n    }\n    flatten(mapper = (issue) => issue.message) {\n        const fieldErrors = {};\n        const formErrors = [];\n        for (const sub of this.issues) {\n            if (sub.path.length > 0) {\n                const firstEl = sub.path[0];\n                fieldErrors[firstEl] = fieldErrors[firstEl] || [];\n                fieldErrors[firstEl].push(mapper(sub));\n            }\n            else {\n                formErrors.push(mapper(sub));\n            }\n        }\n        return { formErrors, fieldErrors };\n    }\n    get formErrors() {\n        return this.flatten();\n    }\n}\nZodError.create = (issues) => {\n    const error = new ZodError(issues);\n    return error;\n};\n","import { ZodIssueCode } from \"../ZodError.js\";\nimport { util, ZodParsedType } from \"../helpers/util.js\";\nconst errorMap = (issue, _ctx) => {\n    let message;\n    switch (issue.code) {\n        case ZodIssueCode.invalid_type:\n            if (issue.received === ZodParsedType.undefined) {\n                message = \"Required\";\n            }\n            else {\n                message = `Expected ${issue.expected}, received ${issue.received}`;\n            }\n            break;\n        case ZodIssueCode.invalid_literal:\n            message = `Invalid literal value, expected ${JSON.stringify(issue.expected, util.jsonStringifyReplacer)}`;\n            break;\n        case ZodIssueCode.unrecognized_keys:\n            message = `Unrecognized key(s) in object: ${util.joinValues(issue.keys, \", \")}`;\n            break;\n        case ZodIssueCode.invalid_union:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_union_discriminator:\n            message = `Invalid discriminator value. Expected ${util.joinValues(issue.options)}`;\n            break;\n        case ZodIssueCode.invalid_enum_value:\n            message = `Invalid enum value. Expected ${util.joinValues(issue.options)}, received '${issue.received}'`;\n            break;\n        case ZodIssueCode.invalid_arguments:\n            message = `Invalid function arguments`;\n            break;\n        case ZodIssueCode.invalid_return_type:\n            message = `Invalid function return type`;\n            break;\n        case ZodIssueCode.invalid_date:\n            message = `Invalid date`;\n            break;\n        case ZodIssueCode.invalid_string:\n            if (typeof issue.validation === \"object\") {\n                if (\"includes\" in issue.validation) {\n                    message = `Invalid input: must include \"${issue.validation.includes}\"`;\n                    if (typeof issue.validation.position === \"number\") {\n                        message = `${message} at one or more positions greater than or equal to ${issue.validation.position}`;\n                    }\n                }\n                else if (\"startsWith\" in issue.validation) {\n                    message = `Invalid input: must start with \"${issue.validation.startsWith}\"`;\n                }\n                else if (\"endsWith\" in issue.validation) {\n                    message = `Invalid input: must end with \"${issue.validation.endsWith}\"`;\n                }\n                else {\n                    util.assertNever(issue.validation);\n                }\n            }\n            else if (issue.validation !== \"regex\") {\n                message = `Invalid ${issue.validation}`;\n            }\n            else {\n                message = \"Invalid\";\n            }\n            break;\n        case ZodIssueCode.too_small:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `more than`} ${issue.minimum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `over`} ${issue.minimum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"bigint\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${new Date(Number(issue.minimum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.too_big:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `less than`} ${issue.maximum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `under`} ${issue.maximum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"bigint\")\n                message = `BigInt must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly` : issue.inclusive ? `smaller than or equal to` : `smaller than`} ${new Date(Number(issue.maximum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.custom:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_intersection_types:\n            message = `Intersection results could not be merged`;\n            break;\n        case ZodIssueCode.not_multiple_of:\n            message = `Number must be a multiple of ${issue.multipleOf}`;\n            break;\n        case ZodIssueCode.not_finite:\n            message = \"Number must be finite\";\n            break;\n        default:\n            message = _ctx.defaultError;\n            util.assertNever(issue);\n    }\n    return { message };\n};\nexport default errorMap;\n","import defaultErrorMap from \"./locales/en.js\";\nlet overrideErrorMap = defaultErrorMap;\nexport { defaultErrorMap };\nexport function setErrorMap(map) {\n    overrideErrorMap = map;\n}\nexport function getErrorMap() {\n    return overrideErrorMap;\n}\n","import { getErrorMap } from \"../errors.js\";\nimport defaultErrorMap from \"../locales/en.js\";\nexport const makeIssue = (params) => {\n    const { data, path, errorMaps, issueData } = params;\n    const fullPath = [...path, ...(issueData.path || [])];\n    const fullIssue = {\n        ...issueData,\n        path: fullPath,\n    };\n    if (issueData.message !== undefined) {\n        return {\n            ...issueData,\n            path: fullPath,\n            message: issueData.message,\n        };\n    }\n    let errorMessage = \"\";\n    const maps = errorMaps\n        .filter((m) => !!m)\n        .slice()\n        .reverse();\n    for (const map of maps) {\n        errorMessage = map(fullIssue, { data, defaultError: errorMessage }).message;\n    }\n    return {\n        ...issueData,\n        path: fullPath,\n        message: errorMessage,\n    };\n};\nexport const EMPTY_PATH = [];\nexport function addIssueToContext(ctx, issueData) {\n    const overrideMap = getErrorMap();\n    const issue = makeIssue({\n        issueData: issueData,\n        data: ctx.data,\n        path: ctx.path,\n        errorMaps: [\n            ctx.common.contextualErrorMap, // contextual error map is first priority\n            ctx.schemaErrorMap, // then schema-bound map if available\n            overrideMap, // then global override map\n            overrideMap === defaultErrorMap ? undefined : defaultErrorMap, // then global default map\n        ].filter((x) => !!x),\n    });\n    ctx.common.issues.push(issue);\n}\nexport class ParseStatus {\n    constructor() {\n        this.value = \"valid\";\n    }\n    dirty() {\n        if (this.value === \"valid\")\n            this.value = \"dirty\";\n    }\n    abort() {\n        if (this.value !== \"aborted\")\n            this.value = \"aborted\";\n    }\n    static mergeArray(status, results) {\n        const arrayValue = [];\n        for (const s of results) {\n            if (s.status === \"aborted\")\n                return INVALID;\n            if (s.status === \"dirty\")\n                status.dirty();\n            arrayValue.push(s.value);\n        }\n        return { status: status.value, value: arrayValue };\n    }\n    static async mergeObjectAsync(status, pairs) {\n        const syncPairs = [];\n        for (const pair of pairs) {\n            const key = await pair.key;\n            const value = await pair.value;\n            syncPairs.push({\n                key,\n                value,\n            });\n        }\n        return ParseStatus.mergeObjectSync(status, syncPairs);\n    }\n    static mergeObjectSync(status, pairs) {\n        const finalObject = {};\n        for (const pair of pairs) {\n            const { key, value } = pair;\n            if (key.status === \"aborted\")\n                return INVALID;\n            if (value.status === \"aborted\")\n                return INVALID;\n            if (key.status === \"dirty\")\n                status.dirty();\n            if (value.status === \"dirty\")\n                status.dirty();\n            if (key.value !== \"__proto__\" && (typeof value.value !== \"undefined\" || pair.alwaysSet)) {\n                finalObject[key.value] = value.value;\n            }\n        }\n        return { status: status.value, value: finalObject };\n    }\n}\nexport const INVALID = Object.freeze({\n    status: \"aborted\",\n});\nexport const DIRTY = (value) => ({ status: \"dirty\", value });\nexport const OK = (value) => ({ status: \"valid\", value });\nexport const isAborted = (x) => x.status === \"aborted\";\nexport const isDirty = (x) => x.status === \"dirty\";\nexport const isValid = (x) => x.status === \"valid\";\nexport const isAsync = (x) => typeof Promise !== \"undefined\" && x instanceof Promise;\n","export var errorUtil;\n(function (errorUtil) {\n    errorUtil.errToObj = (message) => typeof message === \"string\" ? { message } : message || {};\n    // biome-ignore lint:\n    errorUtil.toString = (message) => typeof message === \"string\" ? message : message?.message;\n})(errorUtil || (errorUtil = {}));\n","import { ZodError, ZodIssueCode, } from \"./ZodError.js\";\nimport { defaultErrorMap, getErrorMap } from \"./errors.js\";\nimport { errorUtil } from \"./helpers/errorUtil.js\";\nimport { DIRTY, INVALID, OK, ParseStatus, addIssueToContext, isAborted, isAsync, isDirty, isValid, makeIssue, } from \"./helpers/parseUtil.js\";\nimport { util, ZodParsedType, getParsedType } from \"./helpers/util.js\";\nclass ParseInputLazyPath {\n    constructor(parent, value, path, key) {\n        this._cachedPath = [];\n        this.parent = parent;\n        this.data = value;\n        this._path = path;\n        this._key = key;\n    }\n    get path() {\n        if (!this._cachedPath.length) {\n            if (Array.isArray(this._key)) {\n                this._cachedPath.push(...this._path, ...this._key);\n            }\n            else {\n                this._cachedPath.push(...this._path, this._key);\n            }\n        }\n        return this._cachedPath;\n    }\n}\nconst handleResult = (ctx, result) => {\n    if (isValid(result)) {\n        return { success: true, data: result.value };\n    }\n    else {\n        if (!ctx.common.issues.length) {\n            throw new Error(\"Validation failed but no issues detected.\");\n        }\n        return {\n            success: false,\n            get error() {\n                if (this._error)\n                    return this._error;\n                const error = new ZodError(ctx.common.issues);\n                this._error = error;\n                return this._error;\n            },\n        };\n    }\n};\nfunction processCreateParams(params) {\n    if (!params)\n        return {};\n    const { errorMap, invalid_type_error, required_error, description } = params;\n    if (errorMap && (invalid_type_error || required_error)) {\n        throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);\n    }\n    if (errorMap)\n        return { errorMap: errorMap, description };\n    const customMap = (iss, ctx) => {\n        const { message } = params;\n        if (iss.code === \"invalid_enum_value\") {\n            return { message: message ?? ctx.defaultError };\n        }\n        if (typeof ctx.data === \"undefined\") {\n            return { message: message ?? required_error ?? ctx.defaultError };\n        }\n        if (iss.code !== \"invalid_type\")\n            return { message: ctx.defaultError };\n        return { message: message ?? invalid_type_error ?? ctx.defaultError };\n    };\n    return { errorMap: customMap, description };\n}\nexport class ZodType {\n    get description() {\n        return this._def.description;\n    }\n    _getType(input) {\n        return getParsedType(input.data);\n    }\n    _getOrReturnCtx(input, ctx) {\n        return (ctx || {\n            common: input.parent.common,\n            data: input.data,\n            parsedType: getParsedType(input.data),\n            schemaErrorMap: this._def.errorMap,\n            path: input.path,\n            parent: input.parent,\n        });\n    }\n    _processInputParams(input) {\n        return {\n            status: new ParseStatus(),\n            ctx: {\n                common: input.parent.common,\n                data: input.data,\n                parsedType: getParsedType(input.data),\n                schemaErrorMap: this._def.errorMap,\n                path: input.path,\n                parent: input.parent,\n            },\n        };\n    }\n    _parseSync(input) {\n        const result = this._parse(input);\n        if (isAsync(result)) {\n            throw new Error(\"Synchronous parse encountered promise.\");\n        }\n        return result;\n    }\n    _parseAsync(input) {\n        const result = this._parse(input);\n        return Promise.resolve(result);\n    }\n    parse(data, params) {\n        const result = this.safeParse(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    safeParse(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: params?.async ?? false,\n                contextualErrorMap: params?.errorMap,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const result = this._parseSync({ data, path: ctx.path, parent: ctx });\n        return handleResult(ctx, result);\n    }\n    \"~validate\"(data) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: !!this[\"~standard\"].async,\n            },\n            path: [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        if (!this[\"~standard\"].async) {\n            try {\n                const result = this._parseSync({ data, path: [], parent: ctx });\n                return isValid(result)\n                    ? {\n                        value: result.value,\n                    }\n                    : {\n                        issues: ctx.common.issues,\n                    };\n            }\n            catch (err) {\n                if (err?.message?.toLowerCase()?.includes(\"encountered\")) {\n                    this[\"~standard\"].async = true;\n                }\n                ctx.common = {\n                    issues: [],\n                    async: true,\n                };\n            }\n        }\n        return this._parseAsync({ data, path: [], parent: ctx }).then((result) => isValid(result)\n            ? {\n                value: result.value,\n            }\n            : {\n                issues: ctx.common.issues,\n            });\n    }\n    async parseAsync(data, params) {\n        const result = await this.safeParseAsync(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    async safeParseAsync(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                contextualErrorMap: params?.errorMap,\n                async: true,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const maybeAsyncResult = this._parse({ data, path: ctx.path, parent: ctx });\n        const result = await (isAsync(maybeAsyncResult) ? maybeAsyncResult : Promise.resolve(maybeAsyncResult));\n        return handleResult(ctx, result);\n    }\n    refine(check, message) {\n        const getIssueProperties = (val) => {\n            if (typeof message === \"string\" || typeof message === \"undefined\") {\n                return { message };\n            }\n            else if (typeof message === \"function\") {\n                return message(val);\n            }\n            else {\n                return message;\n            }\n        };\n        return this._refinement((val, ctx) => {\n            const result = check(val);\n            const setError = () => ctx.addIssue({\n                code: ZodIssueCode.custom,\n                ...getIssueProperties(val),\n            });\n            if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n                return result.then((data) => {\n                    if (!data) {\n                        setError();\n                        return false;\n                    }\n                    else {\n                        return true;\n                    }\n                });\n            }\n            if (!result) {\n                setError();\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    refinement(check, refinementData) {\n        return this._refinement((val, ctx) => {\n            if (!check(val)) {\n                ctx.addIssue(typeof refinementData === \"function\" ? refinementData(val, ctx) : refinementData);\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    _refinement(refinement) {\n        return new ZodEffects({\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"refinement\", refinement },\n        });\n    }\n    superRefine(refinement) {\n        return this._refinement(refinement);\n    }\n    constructor(def) {\n        /** Alias of safeParseAsync */\n        this.spa = this.safeParseAsync;\n        this._def = def;\n        this.parse = this.parse.bind(this);\n        this.safeParse = this.safeParse.bind(this);\n        this.parseAsync = this.parseAsync.bind(this);\n        this.safeParseAsync = this.safeParseAsync.bind(this);\n        this.spa = this.spa.bind(this);\n        this.refine = this.refine.bind(this);\n        this.refinement = this.refinement.bind(this);\n        this.superRefine = this.superRefine.bind(this);\n        this.optional = this.optional.bind(this);\n        this.nullable = this.nullable.bind(this);\n        this.nullish = this.nullish.bind(this);\n        this.array = this.array.bind(this);\n        this.promise = this.promise.bind(this);\n        this.or = this.or.bind(this);\n        this.and = this.and.bind(this);\n        this.transform = this.transform.bind(this);\n        this.brand = this.brand.bind(this);\n        this.default = this.default.bind(this);\n        this.catch = this.catch.bind(this);\n        this.describe = this.describe.bind(this);\n        this.pipe = this.pipe.bind(this);\n        this.readonly = this.readonly.bind(this);\n        this.isNullable = this.isNullable.bind(this);\n        this.isOptional = this.isOptional.bind(this);\n        this[\"~standard\"] = {\n            version: 1,\n            vendor: \"zod\",\n            validate: (data) => this[\"~validate\"](data),\n        };\n    }\n    optional() {\n        return ZodOptional.create(this, this._def);\n    }\n    nullable() {\n        return ZodNullable.create(this, this._def);\n    }\n    nullish() {\n        return this.nullable().optional();\n    }\n    array() {\n        return ZodArray.create(this);\n    }\n    promise() {\n        return ZodPromise.create(this, this._def);\n    }\n    or(option) {\n        return ZodUnion.create([this, option], this._def);\n    }\n    and(incoming) {\n        return ZodIntersection.create(this, incoming, this._def);\n    }\n    transform(transform) {\n        return new ZodEffects({\n            ...processCreateParams(this._def),\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"transform\", transform },\n        });\n    }\n    default(def) {\n        const defaultValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodDefault({\n            ...processCreateParams(this._def),\n            innerType: this,\n            defaultValue: defaultValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodDefault,\n        });\n    }\n    brand() {\n        return new ZodBranded({\n            typeName: ZodFirstPartyTypeKind.ZodBranded,\n            type: this,\n            ...processCreateParams(this._def),\n        });\n    }\n    catch(def) {\n        const catchValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodCatch({\n            ...processCreateParams(this._def),\n            innerType: this,\n            catchValue: catchValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodCatch,\n        });\n    }\n    describe(description) {\n        const This = this.constructor;\n        return new This({\n            ...this._def,\n            description,\n        });\n    }\n    pipe(target) {\n        return ZodPipeline.create(this, target);\n    }\n    readonly() {\n        return ZodReadonly.create(this);\n    }\n    isOptional() {\n        return this.safeParse(undefined).success;\n    }\n    isNullable() {\n        return this.safeParse(null).success;\n    }\n}\nconst cuidRegex = /^c[^\\s-]{8,}$/i;\nconst cuid2Regex = /^[0-9a-z]+$/;\nconst ulidRegex = /^[0-9A-HJKMNP-TV-Z]{26}$/i;\n// const uuidRegex =\n//   /^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i;\nconst uuidRegex = /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i;\nconst nanoidRegex = /^[a-z0-9_-]{21}$/i;\nconst jwtRegex = /^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/;\nconst durationRegex = /^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/;\n// from https://stackoverflow.com/a/46181/1550155\n// old version: too slow, didn't support unicode\n// const emailRegex = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i;\n//old email regex\n// const emailRegex = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@((?!-)([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{1,})[^-<>()[\\].,;:\\s@\"]$/i;\n// eslint-disable-next-line\n// const emailRegex =\n//   /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$/;\n// const emailRegex =\n//   /^[a-zA-Z0-9\\.\\!\\#\\$\\%\\&\\'\\*\\+\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~\\-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n// const emailRegex =\n//   /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/i;\nconst emailRegex = /^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i;\n// const emailRegex =\n//   /^[a-z0-9.!#$%&*+/=?^_`{|}~-]+@[a-z0-9-]+(?:\\.[a-z0-9\\-]+)*$/i;\n// from https://thekevinscott.com/emojis-in-javascript/#writing-a-regular-expression\nconst _emojiRegex = `^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$`;\nlet emojiRegex;\n// faster, simpler, safer\nconst ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/;\nconst ipv4CidrRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/;\n// const ipv6Regex =\n// /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;\nconst ipv6Regex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;\nconst ipv6CidrRegex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/;\n// https://stackoverflow.com/questions/7860392/determine-if-string-is-in-base64-using-javascript\nconst base64Regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;\n// https://base64.guru/standards/base64url\nconst base64urlRegex = /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/;\n// simple\n// const dateRegexSource = `\\\\d{4}-\\\\d{2}-\\\\d{2}`;\n// no leap year validation\n// const dateRegexSource = `\\\\d{4}-((0[13578]|10|12)-31|(0[13-9]|1[0-2])-30|(0[1-9]|1[0-2])-(0[1-9]|1\\\\d|2\\\\d))`;\n// with leap year validation\nconst dateRegexSource = `((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))`;\nconst dateRegex = new RegExp(`^${dateRegexSource}$`);\nfunction timeRegexSource(args) {\n    let secondsRegexSource = `[0-5]\\\\d`;\n    if (args.precision) {\n        secondsRegexSource = `${secondsRegexSource}\\\\.\\\\d{${args.precision}}`;\n    }\n    else if (args.precision == null) {\n        secondsRegexSource = `${secondsRegexSource}(\\\\.\\\\d+)?`;\n    }\n    const secondsQuantifier = args.precision ? \"+\" : \"?\"; // require seconds if precision is nonzero\n    return `([01]\\\\d|2[0-3]):[0-5]\\\\d(:${secondsRegexSource})${secondsQuantifier}`;\n}\nfunction timeRegex(args) {\n    return new RegExp(`^${timeRegexSource(args)}$`);\n}\n// Adapted from https://stackoverflow.com/a/3143231\nexport function datetimeRegex(args) {\n    let regex = `${dateRegexSource}T${timeRegexSource(args)}`;\n    const opts = [];\n    opts.push(args.local ? `Z?` : `Z`);\n    if (args.offset)\n        opts.push(`([+-]\\\\d{2}:?\\\\d{2})`);\n    regex = `${regex}(${opts.join(\"|\")})`;\n    return new RegExp(`^${regex}$`);\n}\nfunction isValidIP(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4Regex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6Regex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nfunction isValidJWT(jwt, alg) {\n    if (!jwtRegex.test(jwt))\n        return false;\n    try {\n        const [header] = jwt.split(\".\");\n        if (!header)\n            return false;\n        // Convert base64url to base64\n        const base64 = header\n            .replace(/-/g, \"+\")\n            .replace(/_/g, \"/\")\n            .padEnd(header.length + ((4 - (header.length % 4)) % 4), \"=\");\n        const decoded = JSON.parse(atob(base64));\n        if (typeof decoded !== \"object\" || decoded === null)\n            return false;\n        if (\"typ\" in decoded && decoded?.typ !== \"JWT\")\n            return false;\n        if (!decoded.alg)\n            return false;\n        if (alg && decoded.alg !== alg)\n            return false;\n        return true;\n    }\n    catch {\n        return false;\n    }\n}\nfunction isValidCidr(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4CidrRegex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6CidrRegex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nexport class ZodString extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = String(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.string) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.string,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.length < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.length > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"length\") {\n                const tooBig = input.data.length > check.value;\n                const tooSmall = input.data.length < check.value;\n                if (tooBig || tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    if (tooBig) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_big,\n                            maximum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    else if (tooSmall) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_small,\n                            minimum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"email\") {\n                if (!emailRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"email\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"emoji\") {\n                if (!emojiRegex) {\n                    emojiRegex = new RegExp(_emojiRegex, \"u\");\n                }\n                if (!emojiRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"emoji\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"uuid\") {\n                if (!uuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"uuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"nanoid\") {\n                if (!nanoidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"nanoid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid\") {\n                if (!cuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid2\") {\n                if (!cuid2Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid2\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ulid\") {\n                if (!ulidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ulid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"url\") {\n                try {\n                    new URL(input.data);\n                }\n                catch {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"regex\") {\n                check.regex.lastIndex = 0;\n                const testResult = check.regex.test(input.data);\n                if (!testResult) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"regex\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"trim\") {\n                input.data = input.data.trim();\n            }\n            else if (check.kind === \"includes\") {\n                if (!input.data.includes(check.value, check.position)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { includes: check.value, position: check.position },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"toLowerCase\") {\n                input.data = input.data.toLowerCase();\n            }\n            else if (check.kind === \"toUpperCase\") {\n                input.data = input.data.toUpperCase();\n            }\n            else if (check.kind === \"startsWith\") {\n                if (!input.data.startsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { startsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"endsWith\") {\n                if (!input.data.endsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { endsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"datetime\") {\n                const regex = datetimeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"datetime\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"date\") {\n                const regex = dateRegex;\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"date\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"time\") {\n                const regex = timeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"time\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"duration\") {\n                if (!durationRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"duration\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ip\") {\n                if (!isValidIP(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ip\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"jwt\") {\n                if (!isValidJWT(input.data, check.alg)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"jwt\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cidr\") {\n                if (!isValidCidr(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cidr\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64\") {\n                if (!base64Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64url\") {\n                if (!base64urlRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _regex(regex, validation, message) {\n        return this.refinement((data) => regex.test(data), {\n            validation,\n            code: ZodIssueCode.invalid_string,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    _addCheck(check) {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    email(message) {\n        return this._addCheck({ kind: \"email\", ...errorUtil.errToObj(message) });\n    }\n    url(message) {\n        return this._addCheck({ kind: \"url\", ...errorUtil.errToObj(message) });\n    }\n    emoji(message) {\n        return this._addCheck({ kind: \"emoji\", ...errorUtil.errToObj(message) });\n    }\n    uuid(message) {\n        return this._addCheck({ kind: \"uuid\", ...errorUtil.errToObj(message) });\n    }\n    nanoid(message) {\n        return this._addCheck({ kind: \"nanoid\", ...errorUtil.errToObj(message) });\n    }\n    cuid(message) {\n        return this._addCheck({ kind: \"cuid\", ...errorUtil.errToObj(message) });\n    }\n    cuid2(message) {\n        return this._addCheck({ kind: \"cuid2\", ...errorUtil.errToObj(message) });\n    }\n    ulid(message) {\n        return this._addCheck({ kind: \"ulid\", ...errorUtil.errToObj(message) });\n    }\n    base64(message) {\n        return this._addCheck({ kind: \"base64\", ...errorUtil.errToObj(message) });\n    }\n    base64url(message) {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return this._addCheck({\n            kind: \"base64url\",\n            ...errorUtil.errToObj(message),\n        });\n    }\n    jwt(options) {\n        return this._addCheck({ kind: \"jwt\", ...errorUtil.errToObj(options) });\n    }\n    ip(options) {\n        return this._addCheck({ kind: \"ip\", ...errorUtil.errToObj(options) });\n    }\n    cidr(options) {\n        return this._addCheck({ kind: \"cidr\", ...errorUtil.errToObj(options) });\n    }\n    datetime(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"datetime\",\n                precision: null,\n                offset: false,\n                local: false,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"datetime\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            offset: options?.offset ?? false,\n            local: options?.local ?? false,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    date(message) {\n        return this._addCheck({ kind: \"date\", message });\n    }\n    time(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"time\",\n                precision: null,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"time\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    duration(message) {\n        return this._addCheck({ kind: \"duration\", ...errorUtil.errToObj(message) });\n    }\n    regex(regex, message) {\n        return this._addCheck({\n            kind: \"regex\",\n            regex: regex,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    includes(value, options) {\n        return this._addCheck({\n            kind: \"includes\",\n            value: value,\n            position: options?.position,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    startsWith(value, message) {\n        return this._addCheck({\n            kind: \"startsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    endsWith(value, message) {\n        return this._addCheck({\n            kind: \"endsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    min(minLength, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    max(maxLength, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    length(len, message) {\n        return this._addCheck({\n            kind: \"length\",\n            value: len,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    /**\n     * Equivalent to `.min(1)`\n     */\n    nonempty(message) {\n        return this.min(1, errorUtil.errToObj(message));\n    }\n    trim() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"trim\" }],\n        });\n    }\n    toLowerCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toLowerCase\" }],\n        });\n    }\n    toUpperCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toUpperCase\" }],\n        });\n    }\n    get isDatetime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"datetime\");\n    }\n    get isDate() {\n        return !!this._def.checks.find((ch) => ch.kind === \"date\");\n    }\n    get isTime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"time\");\n    }\n    get isDuration() {\n        return !!this._def.checks.find((ch) => ch.kind === \"duration\");\n    }\n    get isEmail() {\n        return !!this._def.checks.find((ch) => ch.kind === \"email\");\n    }\n    get isURL() {\n        return !!this._def.checks.find((ch) => ch.kind === \"url\");\n    }\n    get isEmoji() {\n        return !!this._def.checks.find((ch) => ch.kind === \"emoji\");\n    }\n    get isUUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"uuid\");\n    }\n    get isNANOID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"nanoid\");\n    }\n    get isCUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid\");\n    }\n    get isCUID2() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid2\");\n    }\n    get isULID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ulid\");\n    }\n    get isIP() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ip\");\n    }\n    get isCIDR() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cidr\");\n    }\n    get isBase64() {\n        return !!this._def.checks.find((ch) => ch.kind === \"base64\");\n    }\n    get isBase64url() {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return !!this._def.checks.find((ch) => ch.kind === \"base64url\");\n    }\n    get minLength() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxLength() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodString.create = (params) => {\n    return new ZodString({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodString,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\n// https://stackoverflow.com/questions/3966484/why-does-modulus-operator-return-fractional-number-in-javascript/31711034#31711034\nfunction floatSafeRemainder(val, step) {\n    const valDecCount = (val.toString().split(\".\")[1] || \"\").length;\n    const stepDecCount = (step.toString().split(\".\")[1] || \"\").length;\n    const decCount = valDecCount > stepDecCount ? valDecCount : stepDecCount;\n    const valInt = Number.parseInt(val.toFixed(decCount).replace(\".\", \"\"));\n    const stepInt = Number.parseInt(step.toFixed(decCount).replace(\".\", \"\"));\n    return (valInt % stepInt) / 10 ** decCount;\n}\nexport class ZodNumber extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n        this.step = this.multipleOf;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Number(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.number) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.number,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"int\") {\n                if (!util.isInteger(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_type,\n                        expected: \"integer\",\n                        received: \"float\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (floatSafeRemainder(input.data, check.value) !== 0) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"finite\") {\n                if (!Number.isFinite(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_finite,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    int(message) {\n        return this._addCheck({\n            kind: \"int\",\n            message: errorUtil.toString(message),\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value: value,\n            message: errorUtil.toString(message),\n        });\n    }\n    finite(message) {\n        return this._addCheck({\n            kind: \"finite\",\n            message: errorUtil.toString(message),\n        });\n    }\n    safe(message) {\n        return this._addCheck({\n            kind: \"min\",\n            inclusive: true,\n            value: Number.MIN_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        })._addCheck({\n            kind: \"max\",\n            inclusive: true,\n            value: Number.MAX_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n    get isInt() {\n        return !!this._def.checks.find((ch) => ch.kind === \"int\" || (ch.kind === \"multipleOf\" && util.isInteger(ch.value)));\n    }\n    get isFinite() {\n        let max = null;\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"finite\" || ch.kind === \"int\" || ch.kind === \"multipleOf\") {\n                return true;\n            }\n            else if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n            else if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return Number.isFinite(min) && Number.isFinite(max);\n    }\n}\nZodNumber.create = (params) => {\n    return new ZodNumber({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodNumber,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBigInt extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            try {\n                input.data = BigInt(input.data);\n            }\n            catch {\n                return this._getInvalidInput(input);\n            }\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.bigint) {\n            return this._getInvalidInput(input);\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        type: \"bigint\",\n                        minimum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        type: \"bigint\",\n                        maximum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (input.data % check.value !== BigInt(0)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _getInvalidInput(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.bigint,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodBigInt.create = (params) => {\n    return new ZodBigInt({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodBigInt,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBoolean extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Boolean(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.boolean) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.boolean,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodBoolean.create = (params) => {\n    return new ZodBoolean({\n        typeName: ZodFirstPartyTypeKind.ZodBoolean,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDate extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = new Date(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.date) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.date,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (Number.isNaN(input.data.getTime())) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_date,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.getTime() < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        minimum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.getTime() > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        maximum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return {\n            status: status.value,\n            value: new Date(input.data.getTime()),\n        };\n    }\n    _addCheck(check) {\n        return new ZodDate({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    min(minDate, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    max(maxDate, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    get minDate() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min != null ? new Date(min) : null;\n    }\n    get maxDate() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max != null ? new Date(max) : null;\n    }\n}\nZodDate.create = (params) => {\n    return new ZodDate({\n        checks: [],\n        coerce: params?.coerce || false,\n        typeName: ZodFirstPartyTypeKind.ZodDate,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSymbol extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.symbol) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.symbol,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodSymbol.create = (params) => {\n    return new ZodSymbol({\n        typeName: ZodFirstPartyTypeKind.ZodSymbol,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUndefined extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.undefined,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodUndefined.create = (params) => {\n    return new ZodUndefined({\n        typeName: ZodFirstPartyTypeKind.ZodUndefined,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNull extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.null) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.null,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodNull.create = (params) => {\n    return new ZodNull({\n        typeName: ZodFirstPartyTypeKind.ZodNull,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodAny extends ZodType {\n    constructor() {\n        super(...arguments);\n        // to prevent instances of other classes from extending ZodAny. this causes issues with catchall in ZodObject.\n        this._any = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodAny.create = (params) => {\n    return new ZodAny({\n        typeName: ZodFirstPartyTypeKind.ZodAny,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnknown extends ZodType {\n    constructor() {\n        super(...arguments);\n        // required\n        this._unknown = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodUnknown.create = (params) => {\n    return new ZodUnknown({\n        typeName: ZodFirstPartyTypeKind.ZodUnknown,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNever extends ZodType {\n    _parse(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.never,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n}\nZodNever.create = (params) => {\n    return new ZodNever({\n        typeName: ZodFirstPartyTypeKind.ZodNever,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodVoid extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.void,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodVoid.create = (params) => {\n    return new ZodVoid({\n        typeName: ZodFirstPartyTypeKind.ZodVoid,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodArray extends ZodType {\n    _parse(input) {\n        const { ctx, status } = this._processInputParams(input);\n        const def = this._def;\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (def.exactLength !== null) {\n            const tooBig = ctx.data.length > def.exactLength.value;\n            const tooSmall = ctx.data.length < def.exactLength.value;\n            if (tooBig || tooSmall) {\n                addIssueToContext(ctx, {\n                    code: tooBig ? ZodIssueCode.too_big : ZodIssueCode.too_small,\n                    minimum: (tooSmall ? def.exactLength.value : undefined),\n                    maximum: (tooBig ? def.exactLength.value : undefined),\n                    type: \"array\",\n                    inclusive: true,\n                    exact: true,\n                    message: def.exactLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.minLength !== null) {\n            if (ctx.data.length < def.minLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxLength !== null) {\n            if (ctx.data.length > def.maxLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.all([...ctx.data].map((item, i) => {\n                return def.type._parseAsync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n            })).then((result) => {\n                return ParseStatus.mergeArray(status, result);\n            });\n        }\n        const result = [...ctx.data].map((item, i) => {\n            return def.type._parseSync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n        });\n        return ParseStatus.mergeArray(status, result);\n    }\n    get element() {\n        return this._def.type;\n    }\n    min(minLength, message) {\n        return new ZodArray({\n            ...this._def,\n            minLength: { value: minLength, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxLength, message) {\n        return new ZodArray({\n            ...this._def,\n            maxLength: { value: maxLength, message: errorUtil.toString(message) },\n        });\n    }\n    length(len, message) {\n        return new ZodArray({\n            ...this._def,\n            exactLength: { value: len, message: errorUtil.toString(message) },\n        });\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodArray.create = (schema, params) => {\n    return new ZodArray({\n        type: schema,\n        minLength: null,\n        maxLength: null,\n        exactLength: null,\n        typeName: ZodFirstPartyTypeKind.ZodArray,\n        ...processCreateParams(params),\n    });\n};\nfunction deepPartialify(schema) {\n    if (schema instanceof ZodObject) {\n        const newShape = {};\n        for (const key in schema.shape) {\n            const fieldSchema = schema.shape[key];\n            newShape[key] = ZodOptional.create(deepPartialify(fieldSchema));\n        }\n        return new ZodObject({\n            ...schema._def,\n            shape: () => newShape,\n        });\n    }\n    else if (schema instanceof ZodArray) {\n        return new ZodArray({\n            ...schema._def,\n            type: deepPartialify(schema.element),\n        });\n    }\n    else if (schema instanceof ZodOptional) {\n        return ZodOptional.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodNullable) {\n        return ZodNullable.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodTuple) {\n        return ZodTuple.create(schema.items.map((item) => deepPartialify(item)));\n    }\n    else {\n        return schema;\n    }\n}\nexport class ZodObject extends ZodType {\n    constructor() {\n        super(...arguments);\n        this._cached = null;\n        /**\n         * @deprecated In most cases, this is no longer needed - unknown properties are now silently stripped.\n         * If you want to pass through unknown properties, use `.passthrough()` instead.\n         */\n        this.nonstrict = this.passthrough;\n        // extend<\n        //   Augmentation extends ZodRawShape,\n        //   NewOutput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_output\"]\n        //       : k extends keyof Output\n        //       ? Output[k]\n        //       : never;\n        //   }>,\n        //   NewInput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_input\"]\n        //       : k extends keyof Input\n        //       ? Input[k]\n        //       : never;\n        //   }>\n        // >(\n        //   augmentation: Augmentation\n        // ): ZodObject<\n        //   extendShape<T, Augmentation>,\n        //   UnknownKeys,\n        //   Catchall,\n        //   NewOutput,\n        //   NewInput\n        // > {\n        //   return new ZodObject({\n        //     ...this._def,\n        //     shape: () => ({\n        //       ...this._def.shape(),\n        //       ...augmentation,\n        //     }),\n        //   }) as any;\n        // }\n        /**\n         * @deprecated Use `.extend` instead\n         *  */\n        this.augment = this.extend;\n    }\n    _getCached() {\n        if (this._cached !== null)\n            return this._cached;\n        const shape = this._def.shape();\n        const keys = util.objectKeys(shape);\n        this._cached = { shape, keys };\n        return this._cached;\n    }\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.object) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const { status, ctx } = this._processInputParams(input);\n        const { shape, keys: shapeKeys } = this._getCached();\n        const extraKeys = [];\n        if (!(this._def.catchall instanceof ZodNever && this._def.unknownKeys === \"strip\")) {\n            for (const key in ctx.data) {\n                if (!shapeKeys.includes(key)) {\n                    extraKeys.push(key);\n                }\n            }\n        }\n        const pairs = [];\n        for (const key of shapeKeys) {\n            const keyValidator = shape[key];\n            const value = ctx.data[key];\n            pairs.push({\n                key: { status: \"valid\", value: key },\n                value: keyValidator._parse(new ParseInputLazyPath(ctx, value, ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (this._def.catchall instanceof ZodNever) {\n            const unknownKeys = this._def.unknownKeys;\n            if (unknownKeys === \"passthrough\") {\n                for (const key of extraKeys) {\n                    pairs.push({\n                        key: { status: \"valid\", value: key },\n                        value: { status: \"valid\", value: ctx.data[key] },\n                    });\n                }\n            }\n            else if (unknownKeys === \"strict\") {\n                if (extraKeys.length > 0) {\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.unrecognized_keys,\n                        keys: extraKeys,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (unknownKeys === \"strip\") {\n            }\n            else {\n                throw new Error(`Internal ZodObject error: invalid unknownKeys value.`);\n            }\n        }\n        else {\n            // run catchall validation\n            const catchall = this._def.catchall;\n            for (const key of extraKeys) {\n                const value = ctx.data[key];\n                pairs.push({\n                    key: { status: \"valid\", value: key },\n                    value: catchall._parse(new ParseInputLazyPath(ctx, value, ctx.path, key) //, ctx.child(key), value, getParsedType(value)\n                    ),\n                    alwaysSet: key in ctx.data,\n                });\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.resolve()\n                .then(async () => {\n                const syncPairs = [];\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    syncPairs.push({\n                        key,\n                        value,\n                        alwaysSet: pair.alwaysSet,\n                    });\n                }\n                return syncPairs;\n            })\n                .then((syncPairs) => {\n                return ParseStatus.mergeObjectSync(status, syncPairs);\n            });\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get shape() {\n        return this._def.shape();\n    }\n    strict(message) {\n        errorUtil.errToObj;\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strict\",\n            ...(message !== undefined\n                ? {\n                    errorMap: (issue, ctx) => {\n                        const defaultError = this._def.errorMap?.(issue, ctx).message ?? ctx.defaultError;\n                        if (issue.code === \"unrecognized_keys\")\n                            return {\n                                message: errorUtil.errToObj(message).message ?? defaultError,\n                            };\n                        return {\n                            message: defaultError,\n                        };\n                    },\n                }\n                : {}),\n        });\n    }\n    strip() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strip\",\n        });\n    }\n    passthrough() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"passthrough\",\n        });\n    }\n    // const AugmentFactory =\n    //   <Def extends ZodObjectDef>(def: Def) =>\n    //   <Augmentation extends ZodRawShape>(\n    //     augmentation: Augmentation\n    //   ): ZodObject<\n    //     extendShape<ReturnType<Def[\"shape\"]>, Augmentation>,\n    //     Def[\"unknownKeys\"],\n    //     Def[\"catchall\"]\n    //   > => {\n    //     return new ZodObject({\n    //       ...def,\n    //       shape: () => ({\n    //         ...def.shape(),\n    //         ...augmentation,\n    //       }),\n    //     }) as any;\n    //   };\n    extend(augmentation) {\n        return new ZodObject({\n            ...this._def,\n            shape: () => ({\n                ...this._def.shape(),\n                ...augmentation,\n            }),\n        });\n    }\n    /**\n     * Prior to zod@1.0.12 there was a bug in the\n     * inferred type of merged objects. Please\n     * upgrade if you are experiencing issues.\n     */\n    merge(merging) {\n        const merged = new ZodObject({\n            unknownKeys: merging._def.unknownKeys,\n            catchall: merging._def.catchall,\n            shape: () => ({\n                ...this._def.shape(),\n                ...merging._def.shape(),\n            }),\n            typeName: ZodFirstPartyTypeKind.ZodObject,\n        });\n        return merged;\n    }\n    // merge<\n    //   Incoming extends AnyZodObject,\n    //   Augmentation extends Incoming[\"shape\"],\n    //   NewOutput extends {\n    //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_output\"]\n    //       : k extends keyof Output\n    //       ? Output[k]\n    //       : never;\n    //   },\n    //   NewInput extends {\n    //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_input\"]\n    //       : k extends keyof Input\n    //       ? Input[k]\n    //       : never;\n    //   }\n    // >(\n    //   merging: Incoming\n    // ): ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"],\n    //   NewOutput,\n    //   NewInput\n    // > {\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    setKey(key, schema) {\n        return this.augment({ [key]: schema });\n    }\n    // merge<Incoming extends AnyZodObject>(\n    //   merging: Incoming\n    // ): //ZodObject<T & Incoming[\"_shape\"], UnknownKeys, Catchall> = (merging) => {\n    // ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"]\n    // > {\n    //   // const mergedShape = objectUtil.mergeShapes(\n    //   //   this._def.shape(),\n    //   //   merging._def.shape()\n    //   // );\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    catchall(index) {\n        return new ZodObject({\n            ...this._def,\n            catchall: index,\n        });\n    }\n    pick(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(mask)) {\n            if (mask[key] && this.shape[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    omit(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (!mask[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    /**\n     * @deprecated\n     */\n    deepPartial() {\n        return deepPartialify(this);\n    }\n    partial(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            const fieldSchema = this.shape[key];\n            if (mask && !mask[key]) {\n                newShape[key] = fieldSchema;\n            }\n            else {\n                newShape[key] = fieldSchema.optional();\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    required(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (mask && !mask[key]) {\n                newShape[key] = this.shape[key];\n            }\n            else {\n                const fieldSchema = this.shape[key];\n                let newField = fieldSchema;\n                while (newField instanceof ZodOptional) {\n                    newField = newField._def.innerType;\n                }\n                newShape[key] = newField;\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    keyof() {\n        return createZodEnum(util.objectKeys(this.shape));\n    }\n}\nZodObject.create = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.strictCreate = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strict\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.lazycreate = (shape, params) => {\n    return new ZodObject({\n        shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const options = this._def.options;\n        function handleResults(results) {\n            // return first issue-free validation if it exists\n            for (const result of results) {\n                if (result.result.status === \"valid\") {\n                    return result.result;\n                }\n            }\n            for (const result of results) {\n                if (result.result.status === \"dirty\") {\n                    // add issues from dirty option\n                    ctx.common.issues.push(...result.ctx.common.issues);\n                    return result.result;\n                }\n            }\n            // return invalid\n            const unionErrors = results.map((result) => new ZodError(result.ctx.common.issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return Promise.all(options.map(async (option) => {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                return {\n                    result: await option._parseAsync({\n                        data: ctx.data,\n                        path: ctx.path,\n                        parent: childCtx,\n                    }),\n                    ctx: childCtx,\n                };\n            })).then(handleResults);\n        }\n        else {\n            let dirty = undefined;\n            const issues = [];\n            for (const option of options) {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                const result = option._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: childCtx,\n                });\n                if (result.status === \"valid\") {\n                    return result;\n                }\n                else if (result.status === \"dirty\" && !dirty) {\n                    dirty = { result, ctx: childCtx };\n                }\n                if (childCtx.common.issues.length) {\n                    issues.push(childCtx.common.issues);\n                }\n            }\n            if (dirty) {\n                ctx.common.issues.push(...dirty.ctx.common.issues);\n                return dirty.result;\n            }\n            const unionErrors = issues.map((issues) => new ZodError(issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n    }\n    get options() {\n        return this._def.options;\n    }\n}\nZodUnion.create = (types, params) => {\n    return new ZodUnion({\n        options: types,\n        typeName: ZodFirstPartyTypeKind.ZodUnion,\n        ...processCreateParams(params),\n    });\n};\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\n//////////                                 //////////\n//////////      ZodDiscriminatedUnion      //////////\n//////////                                 //////////\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\nconst getDiscriminator = (type) => {\n    if (type instanceof ZodLazy) {\n        return getDiscriminator(type.schema);\n    }\n    else if (type instanceof ZodEffects) {\n        return getDiscriminator(type.innerType());\n    }\n    else if (type instanceof ZodLiteral) {\n        return [type.value];\n    }\n    else if (type instanceof ZodEnum) {\n        return type.options;\n    }\n    else if (type instanceof ZodNativeEnum) {\n        // eslint-disable-next-line ban/ban\n        return util.objectValues(type.enum);\n    }\n    else if (type instanceof ZodDefault) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else if (type instanceof ZodUndefined) {\n        return [undefined];\n    }\n    else if (type instanceof ZodNull) {\n        return [null];\n    }\n    else if (type instanceof ZodOptional) {\n        return [undefined, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodNullable) {\n        return [null, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodBranded) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodReadonly) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodCatch) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else {\n        return [];\n    }\n};\nexport class ZodDiscriminatedUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const discriminator = this.discriminator;\n        const discriminatorValue = ctx.data[discriminator];\n        const option = this.optionsMap.get(discriminatorValue);\n        if (!option) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union_discriminator,\n                options: Array.from(this.optionsMap.keys()),\n                path: [discriminator],\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return option._parseAsync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n        else {\n            return option._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n    }\n    get discriminator() {\n        return this._def.discriminator;\n    }\n    get options() {\n        return this._def.options;\n    }\n    get optionsMap() {\n        return this._def.optionsMap;\n    }\n    /**\n     * The constructor of the discriminated union schema. Its behaviour is very similar to that of the normal z.union() constructor.\n     * However, it only allows a union of objects, all of which need to share a discriminator property. This property must\n     * have a different value for each object in the union.\n     * @param discriminator the name of the discriminator property\n     * @param types an array of object schemas\n     * @param params\n     */\n    static create(discriminator, options, params) {\n        // Get all the valid discriminator values\n        const optionsMap = new Map();\n        // try {\n        for (const type of options) {\n            const discriminatorValues = getDiscriminator(type.shape[discriminator]);\n            if (!discriminatorValues.length) {\n                throw new Error(`A discriminator value for key \\`${discriminator}\\` could not be extracted from all schema options`);\n            }\n            for (const value of discriminatorValues) {\n                if (optionsMap.has(value)) {\n                    throw new Error(`Discriminator property ${String(discriminator)} has duplicate value ${String(value)}`);\n                }\n                optionsMap.set(value, type);\n            }\n        }\n        return new ZodDiscriminatedUnion({\n            typeName: ZodFirstPartyTypeKind.ZodDiscriminatedUnion,\n            discriminator,\n            options,\n            optionsMap,\n            ...processCreateParams(params),\n        });\n    }\n}\nfunction mergeValues(a, b) {\n    const aType = getParsedType(a);\n    const bType = getParsedType(b);\n    if (a === b) {\n        return { valid: true, data: a };\n    }\n    else if (aType === ZodParsedType.object && bType === ZodParsedType.object) {\n        const bKeys = util.objectKeys(b);\n        const sharedKeys = util.objectKeys(a).filter((key) => bKeys.indexOf(key) !== -1);\n        const newObj = { ...a, ...b };\n        for (const key of sharedKeys) {\n            const sharedValue = mergeValues(a[key], b[key]);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newObj[key] = sharedValue.data;\n        }\n        return { valid: true, data: newObj };\n    }\n    else if (aType === ZodParsedType.array && bType === ZodParsedType.array) {\n        if (a.length !== b.length) {\n            return { valid: false };\n        }\n        const newArray = [];\n        for (let index = 0; index < a.length; index++) {\n            const itemA = a[index];\n            const itemB = b[index];\n            const sharedValue = mergeValues(itemA, itemB);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newArray.push(sharedValue.data);\n        }\n        return { valid: true, data: newArray };\n    }\n    else if (aType === ZodParsedType.date && bType === ZodParsedType.date && +a === +b) {\n        return { valid: true, data: a };\n    }\n    else {\n        return { valid: false };\n    }\n}\nexport class ZodIntersection extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const handleParsed = (parsedLeft, parsedRight) => {\n            if (isAborted(parsedLeft) || isAborted(parsedRight)) {\n                return INVALID;\n            }\n            const merged = mergeValues(parsedLeft.value, parsedRight.value);\n            if (!merged.valid) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.invalid_intersection_types,\n                });\n                return INVALID;\n            }\n            if (isDirty(parsedLeft) || isDirty(parsedRight)) {\n                status.dirty();\n            }\n            return { status: status.value, value: merged.data };\n        };\n        if (ctx.common.async) {\n            return Promise.all([\n                this._def.left._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n                this._def.right._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n            ]).then(([left, right]) => handleParsed(left, right));\n        }\n        else {\n            return handleParsed(this._def.left._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }), this._def.right._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }));\n        }\n    }\n}\nZodIntersection.create = (left, right, params) => {\n    return new ZodIntersection({\n        left: left,\n        right: right,\n        typeName: ZodFirstPartyTypeKind.ZodIntersection,\n        ...processCreateParams(params),\n    });\n};\n// type ZodTupleItems = [ZodTypeAny, ...ZodTypeAny[]];\nexport class ZodTuple extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (ctx.data.length < this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_small,\n                minimum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            return INVALID;\n        }\n        const rest = this._def.rest;\n        if (!rest && ctx.data.length > this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_big,\n                maximum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            status.dirty();\n        }\n        const items = [...ctx.data]\n            .map((item, itemIndex) => {\n            const schema = this._def.items[itemIndex] || this._def.rest;\n            if (!schema)\n                return null;\n            return schema._parse(new ParseInputLazyPath(ctx, item, ctx.path, itemIndex));\n        })\n            .filter((x) => !!x); // filter nulls\n        if (ctx.common.async) {\n            return Promise.all(items).then((results) => {\n                return ParseStatus.mergeArray(status, results);\n            });\n        }\n        else {\n            return ParseStatus.mergeArray(status, items);\n        }\n    }\n    get items() {\n        return this._def.items;\n    }\n    rest(rest) {\n        return new ZodTuple({\n            ...this._def,\n            rest,\n        });\n    }\n}\nZodTuple.create = (schemas, params) => {\n    if (!Array.isArray(schemas)) {\n        throw new Error(\"You must pass an array of schemas to z.tuple([ ... ])\");\n    }\n    return new ZodTuple({\n        items: schemas,\n        typeName: ZodFirstPartyTypeKind.ZodTuple,\n        rest: null,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodRecord extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const pairs = [];\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        for (const key in ctx.data) {\n            pairs.push({\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, key)),\n                value: valueType._parse(new ParseInputLazyPath(ctx, ctx.data[key], ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (ctx.common.async) {\n            return ParseStatus.mergeObjectAsync(status, pairs);\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get element() {\n        return this._def.valueType;\n    }\n    static create(first, second, third) {\n        if (second instanceof ZodType) {\n            return new ZodRecord({\n                keyType: first,\n                valueType: second,\n                typeName: ZodFirstPartyTypeKind.ZodRecord,\n                ...processCreateParams(third),\n            });\n        }\n        return new ZodRecord({\n            keyType: ZodString.create(),\n            valueType: first,\n            typeName: ZodFirstPartyTypeKind.ZodRecord,\n            ...processCreateParams(second),\n        });\n    }\n}\nexport class ZodMap extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.map) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.map,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        const pairs = [...ctx.data.entries()].map(([key, value], index) => {\n            return {\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, [index, \"key\"])),\n                value: valueType._parse(new ParseInputLazyPath(ctx, value, ctx.path, [index, \"value\"])),\n            };\n        });\n        if (ctx.common.async) {\n            const finalMap = new Map();\n            return Promise.resolve().then(async () => {\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    if (key.status === \"aborted\" || value.status === \"aborted\") {\n                        return INVALID;\n                    }\n                    if (key.status === \"dirty\" || value.status === \"dirty\") {\n                        status.dirty();\n                    }\n                    finalMap.set(key.value, value.value);\n                }\n                return { status: status.value, value: finalMap };\n            });\n        }\n        else {\n            const finalMap = new Map();\n            for (const pair of pairs) {\n                const key = pair.key;\n                const value = pair.value;\n                if (key.status === \"aborted\" || value.status === \"aborted\") {\n                    return INVALID;\n                }\n                if (key.status === \"dirty\" || value.status === \"dirty\") {\n                    status.dirty();\n                }\n                finalMap.set(key.value, value.value);\n            }\n            return { status: status.value, value: finalMap };\n        }\n    }\n}\nZodMap.create = (keyType, valueType, params) => {\n    return new ZodMap({\n        valueType,\n        keyType,\n        typeName: ZodFirstPartyTypeKind.ZodMap,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSet extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.set) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.set,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const def = this._def;\n        if (def.minSize !== null) {\n            if (ctx.data.size < def.minSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minSize.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxSize !== null) {\n            if (ctx.data.size > def.maxSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxSize.message,\n                });\n                status.dirty();\n            }\n        }\n        const valueType = this._def.valueType;\n        function finalizeSet(elements) {\n            const parsedSet = new Set();\n            for (const element of elements) {\n                if (element.status === \"aborted\")\n                    return INVALID;\n                if (element.status === \"dirty\")\n                    status.dirty();\n                parsedSet.add(element.value);\n            }\n            return { status: status.value, value: parsedSet };\n        }\n        const elements = [...ctx.data.values()].map((item, i) => valueType._parse(new ParseInputLazyPath(ctx, item, ctx.path, i)));\n        if (ctx.common.async) {\n            return Promise.all(elements).then((elements) => finalizeSet(elements));\n        }\n        else {\n            return finalizeSet(elements);\n        }\n    }\n    min(minSize, message) {\n        return new ZodSet({\n            ...this._def,\n            minSize: { value: minSize, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxSize, message) {\n        return new ZodSet({\n            ...this._def,\n            maxSize: { value: maxSize, message: errorUtil.toString(message) },\n        });\n    }\n    size(size, message) {\n        return this.min(size, message).max(size, message);\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodSet.create = (valueType, params) => {\n    return new ZodSet({\n        valueType,\n        minSize: null,\n        maxSize: null,\n        typeName: ZodFirstPartyTypeKind.ZodSet,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodFunction extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.validate = this.implement;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.function) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.function,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        function makeArgsIssue(args, error) {\n            return makeIssue({\n                data: args,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_arguments,\n                    argumentsError: error,\n                },\n            });\n        }\n        function makeReturnsIssue(returns, error) {\n            return makeIssue({\n                data: returns,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_return_type,\n                    returnTypeError: error,\n                },\n            });\n        }\n        const params = { errorMap: ctx.common.contextualErrorMap };\n        const fn = ctx.data;\n        if (this._def.returns instanceof ZodPromise) {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(async function (...args) {\n                const error = new ZodError([]);\n                const parsedArgs = await me._def.args.parseAsync(args, params).catch((e) => {\n                    error.addIssue(makeArgsIssue(args, e));\n                    throw error;\n                });\n                const result = await Reflect.apply(fn, this, parsedArgs);\n                const parsedReturns = await me._def.returns._def.type\n                    .parseAsync(result, params)\n                    .catch((e) => {\n                    error.addIssue(makeReturnsIssue(result, e));\n                    throw error;\n                });\n                return parsedReturns;\n            });\n        }\n        else {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(function (...args) {\n                const parsedArgs = me._def.args.safeParse(args, params);\n                if (!parsedArgs.success) {\n                    throw new ZodError([makeArgsIssue(args, parsedArgs.error)]);\n                }\n                const result = Reflect.apply(fn, this, parsedArgs.data);\n                const parsedReturns = me._def.returns.safeParse(result, params);\n                if (!parsedReturns.success) {\n                    throw new ZodError([makeReturnsIssue(result, parsedReturns.error)]);\n                }\n                return parsedReturns.data;\n            });\n        }\n    }\n    parameters() {\n        return this._def.args;\n    }\n    returnType() {\n        return this._def.returns;\n    }\n    args(...items) {\n        return new ZodFunction({\n            ...this._def,\n            args: ZodTuple.create(items).rest(ZodUnknown.create()),\n        });\n    }\n    returns(returnType) {\n        return new ZodFunction({\n            ...this._def,\n            returns: returnType,\n        });\n    }\n    implement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    strictImplement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    static create(args, returns, params) {\n        return new ZodFunction({\n            args: (args ? args : ZodTuple.create([]).rest(ZodUnknown.create())),\n            returns: returns || ZodUnknown.create(),\n            typeName: ZodFirstPartyTypeKind.ZodFunction,\n            ...processCreateParams(params),\n        });\n    }\n}\nexport class ZodLazy extends ZodType {\n    get schema() {\n        return this._def.getter();\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const lazySchema = this._def.getter();\n        return lazySchema._parse({ data: ctx.data, path: ctx.path, parent: ctx });\n    }\n}\nZodLazy.create = (getter, params) => {\n    return new ZodLazy({\n        getter: getter,\n        typeName: ZodFirstPartyTypeKind.ZodLazy,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodLiteral extends ZodType {\n    _parse(input) {\n        if (input.data !== this._def.value) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_literal,\n                expected: this._def.value,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n    get value() {\n        return this._def.value;\n    }\n}\nZodLiteral.create = (value, params) => {\n    return new ZodLiteral({\n        value: value,\n        typeName: ZodFirstPartyTypeKind.ZodLiteral,\n        ...processCreateParams(params),\n    });\n};\nfunction createZodEnum(values, params) {\n    return new ZodEnum({\n        values,\n        typeName: ZodFirstPartyTypeKind.ZodEnum,\n        ...processCreateParams(params),\n    });\n}\nexport class ZodEnum extends ZodType {\n    _parse(input) {\n        if (typeof input.data !== \"string\") {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(this._def.values);\n        }\n        if (!this._cache.has(input.data)) {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get options() {\n        return this._def.values;\n    }\n    get enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Values() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    extract(values, newDef = this._def) {\n        return ZodEnum.create(values, {\n            ...this._def,\n            ...newDef,\n        });\n    }\n    exclude(values, newDef = this._def) {\n        return ZodEnum.create(this.options.filter((opt) => !values.includes(opt)), {\n            ...this._def,\n            ...newDef,\n        });\n    }\n}\nZodEnum.create = createZodEnum;\nexport class ZodNativeEnum extends ZodType {\n    _parse(input) {\n        const nativeEnumValues = util.getValidEnumValues(this._def.values);\n        const ctx = this._getOrReturnCtx(input);\n        if (ctx.parsedType !== ZodParsedType.string && ctx.parsedType !== ZodParsedType.number) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(util.getValidEnumValues(this._def.values));\n        }\n        if (!this._cache.has(input.data)) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get enum() {\n        return this._def.values;\n    }\n}\nZodNativeEnum.create = (values, params) => {\n    return new ZodNativeEnum({\n        values: values,\n        typeName: ZodFirstPartyTypeKind.ZodNativeEnum,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodPromise extends ZodType {\n    unwrap() {\n        return this._def.type;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.promise && ctx.common.async === false) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.promise,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const promisified = ctx.parsedType === ZodParsedType.promise ? ctx.data : Promise.resolve(ctx.data);\n        return OK(promisified.then((data) => {\n            return this._def.type.parseAsync(data, {\n                path: ctx.path,\n                errorMap: ctx.common.contextualErrorMap,\n            });\n        }));\n    }\n}\nZodPromise.create = (schema, params) => {\n    return new ZodPromise({\n        type: schema,\n        typeName: ZodFirstPartyTypeKind.ZodPromise,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodEffects extends ZodType {\n    innerType() {\n        return this._def.schema;\n    }\n    sourceType() {\n        return this._def.schema._def.typeName === ZodFirstPartyTypeKind.ZodEffects\n            ? this._def.schema.sourceType()\n            : this._def.schema;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const effect = this._def.effect || null;\n        const checkCtx = {\n            addIssue: (arg) => {\n                addIssueToContext(ctx, arg);\n                if (arg.fatal) {\n                    status.abort();\n                }\n                else {\n                    status.dirty();\n                }\n            },\n            get path() {\n                return ctx.path;\n            },\n        };\n        checkCtx.addIssue = checkCtx.addIssue.bind(checkCtx);\n        if (effect.type === \"preprocess\") {\n            const processed = effect.transform(ctx.data, checkCtx);\n            if (ctx.common.async) {\n                return Promise.resolve(processed).then(async (processed) => {\n                    if (status.value === \"aborted\")\n                        return INVALID;\n                    const result = await this._def.schema._parseAsync({\n                        data: processed,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                    if (result.status === \"aborted\")\n                        return INVALID;\n                    if (result.status === \"dirty\")\n                        return DIRTY(result.value);\n                    if (status.value === \"dirty\")\n                        return DIRTY(result.value);\n                    return result;\n                });\n            }\n            else {\n                if (status.value === \"aborted\")\n                    return INVALID;\n                const result = this._def.schema._parseSync({\n                    data: processed,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (result.status === \"aborted\")\n                    return INVALID;\n                if (result.status === \"dirty\")\n                    return DIRTY(result.value);\n                if (status.value === \"dirty\")\n                    return DIRTY(result.value);\n                return result;\n            }\n        }\n        if (effect.type === \"refinement\") {\n            const executeRefinement = (acc) => {\n                const result = effect.refinement(acc, checkCtx);\n                if (ctx.common.async) {\n                    return Promise.resolve(result);\n                }\n                if (result instanceof Promise) {\n                    throw new Error(\"Async refinement encountered during synchronous parse operation. Use .parseAsync instead.\");\n                }\n                return acc;\n            };\n            if (ctx.common.async === false) {\n                const inner = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inner.status === \"aborted\")\n                    return INVALID;\n                if (inner.status === \"dirty\")\n                    status.dirty();\n                // return value is ignored\n                executeRefinement(inner.value);\n                return { status: status.value, value: inner.value };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((inner) => {\n                    if (inner.status === \"aborted\")\n                        return INVALID;\n                    if (inner.status === \"dirty\")\n                        status.dirty();\n                    return executeRefinement(inner.value).then(() => {\n                        return { status: status.value, value: inner.value };\n                    });\n                });\n            }\n        }\n        if (effect.type === \"transform\") {\n            if (ctx.common.async === false) {\n                const base = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (!isValid(base))\n                    return INVALID;\n                const result = effect.transform(base.value, checkCtx);\n                if (result instanceof Promise) {\n                    throw new Error(`Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.`);\n                }\n                return { status: status.value, value: result };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((base) => {\n                    if (!isValid(base))\n                        return INVALID;\n                    return Promise.resolve(effect.transform(base.value, checkCtx)).then((result) => ({\n                        status: status.value,\n                        value: result,\n                    }));\n                });\n            }\n        }\n        util.assertNever(effect);\n    }\n}\nZodEffects.create = (schema, effect, params) => {\n    return new ZodEffects({\n        schema,\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        effect,\n        ...processCreateParams(params),\n    });\n};\nZodEffects.createWithPreprocess = (preprocess, schema, params) => {\n    return new ZodEffects({\n        schema,\n        effect: { type: \"preprocess\", transform: preprocess },\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        ...processCreateParams(params),\n    });\n};\nexport { ZodEffects as ZodTransformer };\nexport class ZodOptional extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.undefined) {\n            return OK(undefined);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodOptional.create = (type, params) => {\n    return new ZodOptional({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodOptional,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNullable extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.null) {\n            return OK(null);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodNullable.create = (type, params) => {\n    return new ZodNullable({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodNullable,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDefault extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        let data = ctx.data;\n        if (ctx.parsedType === ZodParsedType.undefined) {\n            data = this._def.defaultValue();\n        }\n        return this._def.innerType._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    removeDefault() {\n        return this._def.innerType;\n    }\n}\nZodDefault.create = (type, params) => {\n    return new ZodDefault({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodDefault,\n        defaultValue: typeof params.default === \"function\" ? params.default : () => params.default,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodCatch extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        // newCtx is used to not collect issues from inner types in ctx\n        const newCtx = {\n            ...ctx,\n            common: {\n                ...ctx.common,\n                issues: [],\n            },\n        };\n        const result = this._def.innerType._parse({\n            data: newCtx.data,\n            path: newCtx.path,\n            parent: {\n                ...newCtx,\n            },\n        });\n        if (isAsync(result)) {\n            return result.then((result) => {\n                return {\n                    status: \"valid\",\n                    value: result.status === \"valid\"\n                        ? result.value\n                        : this._def.catchValue({\n                            get error() {\n                                return new ZodError(newCtx.common.issues);\n                            },\n                            input: newCtx.data,\n                        }),\n                };\n            });\n        }\n        else {\n            return {\n                status: \"valid\",\n                value: result.status === \"valid\"\n                    ? result.value\n                    : this._def.catchValue({\n                        get error() {\n                            return new ZodError(newCtx.common.issues);\n                        },\n                        input: newCtx.data,\n                    }),\n            };\n        }\n    }\n    removeCatch() {\n        return this._def.innerType;\n    }\n}\nZodCatch.create = (type, params) => {\n    return new ZodCatch({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodCatch,\n        catchValue: typeof params.catch === \"function\" ? params.catch : () => params.catch,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNaN extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.nan) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.nan,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n}\nZodNaN.create = (params) => {\n    return new ZodNaN({\n        typeName: ZodFirstPartyTypeKind.ZodNaN,\n        ...processCreateParams(params),\n    });\n};\nexport const BRAND = Symbol(\"zod_brand\");\nexport class ZodBranded extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const data = ctx.data;\n        return this._def.type._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    unwrap() {\n        return this._def.type;\n    }\n}\nexport class ZodPipeline extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.common.async) {\n            const handleAsync = async () => {\n                const inResult = await this._def.in._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inResult.status === \"aborted\")\n                    return INVALID;\n                if (inResult.status === \"dirty\") {\n                    status.dirty();\n                    return DIRTY(inResult.value);\n                }\n                else {\n                    return this._def.out._parseAsync({\n                        data: inResult.value,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                }\n            };\n            return handleAsync();\n        }\n        else {\n            const inResult = this._def.in._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n            if (inResult.status === \"aborted\")\n                return INVALID;\n            if (inResult.status === \"dirty\") {\n                status.dirty();\n                return {\n                    status: \"dirty\",\n                    value: inResult.value,\n                };\n            }\n            else {\n                return this._def.out._parseSync({\n                    data: inResult.value,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n            }\n        }\n    }\n    static create(a, b) {\n        return new ZodPipeline({\n            in: a,\n            out: b,\n            typeName: ZodFirstPartyTypeKind.ZodPipeline,\n        });\n    }\n}\nexport class ZodReadonly extends ZodType {\n    _parse(input) {\n        const result = this._def.innerType._parse(input);\n        const freeze = (data) => {\n            if (isValid(data)) {\n                data.value = Object.freeze(data.value);\n            }\n            return data;\n        };\n        return isAsync(result) ? result.then((data) => freeze(data)) : freeze(result);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodReadonly.create = (type, params) => {\n    return new ZodReadonly({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodReadonly,\n        ...processCreateParams(params),\n    });\n};\n////////////////////////////////////////\n////////////////////////////////////////\n//////////                    //////////\n//////////      z.custom      //////////\n//////////                    //////////\n////////////////////////////////////////\n////////////////////////////////////////\nfunction cleanParams(params, data) {\n    const p = typeof params === \"function\" ? params(data) : typeof params === \"string\" ? { message: params } : params;\n    const p2 = typeof p === \"string\" ? { message: p } : p;\n    return p2;\n}\nexport function custom(check, _params = {}, \n/**\n * @deprecated\n *\n * Pass `fatal` into the params object instead:\n *\n * ```ts\n * z.string().custom((val) => val.length > 5, { fatal: false })\n * ```\n *\n */\nfatal) {\n    if (check)\n        return ZodAny.create().superRefine((data, ctx) => {\n            const r = check(data);\n            if (r instanceof Promise) {\n                return r.then((r) => {\n                    if (!r) {\n                        const params = cleanParams(_params, data);\n                        const _fatal = params.fatal ?? fatal ?? true;\n                        ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n                    }\n                });\n            }\n            if (!r) {\n                const params = cleanParams(_params, data);\n                const _fatal = params.fatal ?? fatal ?? true;\n                ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n            }\n            return;\n        });\n    return ZodAny.create();\n}\nexport { ZodType as Schema, ZodType as ZodSchema };\nexport const late = {\n    object: ZodObject.lazycreate,\n};\nexport var ZodFirstPartyTypeKind;\n(function (ZodFirstPartyTypeKind) {\n    ZodFirstPartyTypeKind[\"ZodString\"] = \"ZodString\";\n    ZodFirstPartyTypeKind[\"ZodNumber\"] = \"ZodNumber\";\n    ZodFirstPartyTypeKind[\"ZodNaN\"] = \"ZodNaN\";\n    ZodFirstPartyTypeKind[\"ZodBigInt\"] = \"ZodBigInt\";\n    ZodFirstPartyTypeKind[\"ZodBoolean\"] = \"ZodBoolean\";\n    ZodFirstPartyTypeKind[\"ZodDate\"] = \"ZodDate\";\n    ZodFirstPartyTypeKind[\"ZodSymbol\"] = \"ZodSymbol\";\n    ZodFirstPartyTypeKind[\"ZodUndefined\"] = \"ZodUndefined\";\n    ZodFirstPartyTypeKind[\"ZodNull\"] = \"ZodNull\";\n    ZodFirstPartyTypeKind[\"ZodAny\"] = \"ZodAny\";\n    ZodFirstPartyTypeKind[\"ZodUnknown\"] = \"ZodUnknown\";\n    ZodFirstPartyTypeKind[\"ZodNever\"] = \"ZodNever\";\n    ZodFirstPartyTypeKind[\"ZodVoid\"] = \"ZodVoid\";\n    ZodFirstPartyTypeKind[\"ZodArray\"] = \"ZodArray\";\n    ZodFirstPartyTypeKind[\"ZodObject\"] = \"ZodObject\";\n    ZodFirstPartyTypeKind[\"ZodUnion\"] = \"ZodUnion\";\n    ZodFirstPartyTypeKind[\"ZodDiscriminatedUnion\"] = \"ZodDiscriminatedUnion\";\n    ZodFirstPartyTypeKind[\"ZodIntersection\"] = \"ZodIntersection\";\n    ZodFirstPartyTypeKind[\"ZodTuple\"] = \"ZodTuple\";\n    ZodFirstPartyTypeKind[\"ZodRecord\"] = \"ZodRecord\";\n    ZodFirstPartyTypeKind[\"ZodMap\"] = \"ZodMap\";\n    ZodFirstPartyTypeKind[\"ZodSet\"] = \"ZodSet\";\n    ZodFirstPartyTypeKind[\"ZodFunction\"] = \"ZodFunction\";\n    ZodFirstPartyTypeKind[\"ZodLazy\"] = \"ZodLazy\";\n    ZodFirstPartyTypeKind[\"ZodLiteral\"] = \"ZodLiteral\";\n    ZodFirstPartyTypeKind[\"ZodEnum\"] = \"ZodEnum\";\n    ZodFirstPartyTypeKind[\"ZodEffects\"] = \"ZodEffects\";\n    ZodFirstPartyTypeKind[\"ZodNativeEnum\"] = \"ZodNativeEnum\";\n    ZodFirstPartyTypeKind[\"ZodOptional\"] = \"ZodOptional\";\n    ZodFirstPartyTypeKind[\"ZodNullable\"] = \"ZodNullable\";\n    ZodFirstPartyTypeKind[\"ZodDefault\"] = \"ZodDefault\";\n    ZodFirstPartyTypeKind[\"ZodCatch\"] = \"ZodCatch\";\n    ZodFirstPartyTypeKind[\"ZodPromise\"] = \"ZodPromise\";\n    ZodFirstPartyTypeKind[\"ZodBranded\"] = \"ZodBranded\";\n    ZodFirstPartyTypeKind[\"ZodPipeline\"] = \"ZodPipeline\";\n    ZodFirstPartyTypeKind[\"ZodReadonly\"] = \"ZodReadonly\";\n})(ZodFirstPartyTypeKind || (ZodFirstPartyTypeKind = {}));\n// requires TS 4.4+\nclass Class {\n    constructor(..._) { }\n}\nconst instanceOfType = (\n// const instanceOfType = <T extends new (...args: any[]) => any>(\ncls, params = {\n    message: `Input not instance of ${cls.name}`,\n}) => custom((data) => data instanceof cls, params);\nconst stringType = ZodString.create;\nconst numberType = ZodNumber.create;\nconst nanType = ZodNaN.create;\nconst bigIntType = ZodBigInt.create;\nconst booleanType = ZodBoolean.create;\nconst dateType = ZodDate.create;\nconst symbolType = ZodSymbol.create;\nconst undefinedType = ZodUndefined.create;\nconst nullType = ZodNull.create;\nconst anyType = ZodAny.create;\nconst unknownType = ZodUnknown.create;\nconst neverType = ZodNever.create;\nconst voidType = ZodVoid.create;\nconst arrayType = ZodArray.create;\nconst objectType = ZodObject.create;\nconst strictObjectType = ZodObject.strictCreate;\nconst unionType = ZodUnion.create;\nconst discriminatedUnionType = ZodDiscriminatedUnion.create;\nconst intersectionType = ZodIntersection.create;\nconst tupleType = ZodTuple.create;\nconst recordType = ZodRecord.create;\nconst mapType = ZodMap.create;\nconst setType = ZodSet.create;\nconst functionType = ZodFunction.create;\nconst lazyType = ZodLazy.create;\nconst literalType = ZodLiteral.create;\nconst enumType = ZodEnum.create;\nconst nativeEnumType = ZodNativeEnum.create;\nconst promiseType = ZodPromise.create;\nconst effectsType = ZodEffects.create;\nconst optionalType = ZodOptional.create;\nconst nullableType = ZodNullable.create;\nconst preprocessType = ZodEffects.createWithPreprocess;\nconst pipelineType = ZodPipeline.create;\nconst ostring = () => stringType().optional();\nconst onumber = () => numberType().optional();\nconst oboolean = () => booleanType().optional();\nexport const coerce = {\n    string: ((arg) => ZodString.create({ ...arg, coerce: true })),\n    number: ((arg) => ZodNumber.create({ ...arg, coerce: true })),\n    boolean: ((arg) => ZodBoolean.create({\n        ...arg,\n        coerce: true,\n    })),\n    bigint: ((arg) => ZodBigInt.create({ ...arg, coerce: true })),\n    date: ((arg) => ZodDate.create({ ...arg, coerce: true })),\n};\nexport { anyType as any, arrayType as array, bigIntType as bigint, booleanType as boolean, dateType as date, discriminatedUnionType as discriminatedUnion, effectsType as effect, enumType as enum, functionType as function, instanceOfType as instanceof, intersectionType as intersection, lazyType as lazy, literalType as literal, mapType as map, nanType as nan, nativeEnumType as nativeEnum, neverType as never, nullType as null, nullableType as nullable, numberType as number, objectType as object, oboolean, onumber, optionalType as optional, ostring, pipelineType as pipeline, preprocessType as preprocess, promiseType as promise, recordType as record, setType as set, strictObjectType as strictObject, stringType as string, symbolType as symbol, effectsType as transformer, tupleType as tuple, undefinedType as undefined, unionType as union, unknownType as unknown, voidType as void, };\nexport const NEVER = INVALID;\n","import { z } from 'zod';\n\nexport const EnvSchema = z.object({\n  MODE: z.enum(['development', 'production', 'test']),\n  VITE_API_BASE: z.string().optional(), // explicit override only when provided\n  VITE_IMAGES_FEATURE_FLAG: z.string().optional(), // \"true\"/\"false\"\n  VITE_IMAGES_PROVIDER: z.enum(['none', 'pexels', 'unsplash']).default('none'),\n});\n\nexport type Env = z.infer<typeof EnvSchema>;\n","import { EnvSchema } from './env.schema';\n\nexport const env = EnvSchema.parse({\n  MODE: import.meta.env.MODE,\n  VITE_API_BASE: import.meta.env.VITE_API_BASE,\n  VITE_IMAGES_FEATURE_FLAG: import.meta.env.VITE_IMAGES_FEATURE_FLAG,\n  VITE_IMAGES_PROVIDER: import.meta.env.VITE_IMAGES_PROVIDER,\n});\n","// Client environment configuration with runtime validation\nimport { env } from './env';\n\n// Re-export the validated environment for new imports\nexport { env };\n\n// Named export for @/utils/environment.ts compatibility\nexport const envClient = {\n  ...env,\n  DEV: import.meta.env.DEV,\n  PROD: import.meta.env.PROD,\n  SSR: import.meta.env.SSR,\n  // Additional environment variables that may be needed\n  VITE_SUPABASE_URL: import.meta.env.VITE_SUPABASE_URL,\n  VITE_SUPABASE_ANON_KEY: import.meta.env.VITE_SUPABASE_ANON_KEY,\n  VITE_FRONTEND_URL: import.meta.env.VITE_FRONTEND_URL,\n  VITE_FCZ_UNIFIED_HEADER: import.meta.env.VITE_FCZ_UNIFIED_HEADER,\n  VITE_FCZ_DISCOVER_V2: import.meta.env.VITE_FCZ_DISCOVER_V2,\n  VITE_FCZ_PREDICTION_DETAILS_V2: import.meta.env.VITE_FCZ_PREDICTION_DETAILS_V2,\n  VITE_FCZ_SHARED_CARDS: import.meta.env.VITE_FCZ_SHARED_CARDS,\n  VITE_FCZ_AUTH_GATE: import.meta.env.VITE_FCZ_AUTH_GATE,\n  VITE_FCZ_COMMENTS_V2: import.meta.env.VITE_FCZ_COMMENTS_V2,\n  VITE_FCZ_UNIFIED_CARDS: import.meta.env.VITE_FCZ_UNIFIED_CARDS,\n  VITE_FCZ_COMMENTS_SORT: import.meta.env.VITE_FCZ_COMMENTS_SORT,\n  VITE_DEBUG: import.meta.env.VITE_DEBUG,\n  VITE_VAPID_PUBLIC_KEY: import.meta.env.VITE_VAPID_PUBLIC_KEY,\n  VITE_ESCROW_CONTRACT_ADDRESS: import.meta.env.VITE_ESCROW_CONTRACT_ADDRESS,\n  VITE_GOOGLE_ANALYTICS_ID: import.meta.env.VITE_GOOGLE_ANALYTICS_ID,\n};","import { envClient } from \"@/config/env.client\";\nimport { Capacitor } from '@capacitor/core';\n// NB: do NOT import envServer into client bundles\n\nexport const isDev = envClient.DEV;\nexport const isProd = envClient.PROD;\nexport const mode = envClient.MODE;\n\n// API Configuration\nexport const API_BASE = envClient.VITE_API_BASE;\nexport const SUPABASE_URL = envClient.VITE_SUPABASE_URL;\nexport const SUPABASE_ANON_KEY = envClient.VITE_SUPABASE_ANON_KEY;\nexport const FRONTEND_URL = envClient.VITE_FRONTEND_URL;\n\n// Feature Flags\nexport const FCZ_UNIFIED_HEADER = envClient.VITE_FCZ_UNIFIED_HEADER === '1';\nexport const FCZ_DISCOVER_V2 = envClient.VITE_FCZ_DISCOVER_V2 === '1';\nexport const FCZ_PREDICTION_DETAILS_V2 = envClient.VITE_FCZ_PREDICTION_DETAILS_V2 === '1';\nexport const FCZ_SHARED_CARDS = envClient.VITE_FCZ_SHARED_CARDS === '1';\nexport const FCZ_AUTH_GATE = envClient.VITE_FCZ_AUTH_GATE === '1';\nexport const FCZ_COMMENTS_V2 = envClient.VITE_FCZ_COMMENTS_V2 === '1';\nexport const FCZ_UNIFIED_CARDS = envClient.VITE_FCZ_UNIFIED_CARDS === '1';\nexport const FCZ_COMMENTS_SORT = envClient.VITE_FCZ_COMMENTS_SORT === '1';\n\n// Debug and Development\nexport const DEBUG_ENABLED = envClient.VITE_DEBUG === 'true';\n\n// Optional Services\nexport const VAPID_PUBLIC_KEY = envClient.VITE_VAPID_PUBLIC_KEY;\nexport const ESCROW_CONTRACT_ADDRESS = envClient.VITE_ESCROW_CONTRACT_ADDRESS;\nexport const GOOGLE_ANALYTICS_ID = envClient.VITE_GOOGLE_ANALYTICS_ID;\n\n/**\n * Environment detection and configuration for Fan Club Z\n * Handles dev, staging, and production environments with dynamic LAN support\n */\n\nexport interface EnvironmentConfig {\n  apiUrl: string;\n  socketUrl: string;\n  environment: 'development' | 'staging' | 'production';\n  isDevelopment: boolean;\n  isProduction: boolean;\n}\n\nexport function getEnvironmentConfig(): EnvironmentConfig {\n  const hostname = window.location.hostname;\n  const protocol = window.location.protocol;\n  const runningInNativeApp = typeof window !== 'undefined' && Boolean(Capacitor?.isNativePlatform?.());\n  const productionApi = 'https://fan-club-z.onrender.com';\n  \n  if (DEBUG_ENABLED) {\n    console.log(' Environment Detection:');\n    console.log('  - Hostname:', hostname);\n    console.log('  - Protocol:', protocol);\n    console.log('  - VITE_API_BASE:', API_BASE);\n    console.log('  - MODE:', mode);\n  }\n  \n  // Production environment\n  if (hostname === 'app.fanclubz.app' || hostname === 'fanclubz.app' || hostname === 'www.fanclubz.app') {\n    const config: EnvironmentConfig = {\n      apiUrl: productionApi,\n      socketUrl: productionApi,\n      environment: 'production',\n      isDevelopment: false,\n      isProduction: true\n    };\n    if (DEBUG_ENABLED) console.log(' Production environment detected (single service):', config);\n    return config;\n  }\n  \n  // Development environment\n  if (hostname === 'dev.fanclubz.app') {\n    const config: EnvironmentConfig = {\n      apiUrl: 'https://fan-club-z.onrender.com',\n      socketUrl: 'https://fan-club-z.onrender.com',\n      environment: 'staging',\n      isDevelopment: false,\n      isProduction: false\n    };\n    if (DEBUG_ENABLED) console.log(' Development environment detected (single service):', config);\n    return config;\n  }\n  \n  // Vercel deployments (default to production)\n  if (hostname.includes('vercel.app')) {\n    const config: EnvironmentConfig = {\n      apiUrl: productionApi,\n      socketUrl: productionApi,\n      environment: 'production',\n      isDevelopment: false,\n      isProduction: true\n    };\n    if (DEBUG_ENABLED) console.log(' Vercel deployment detected, using single service:', config);\n    return config;\n  }\n\n  // Capacitor / native shell builds always target production API\n  if (runningInNativeApp && !isDev) {\n    const config: EnvironmentConfig = {\n      apiUrl: productionApi,\n      socketUrl: productionApi,\n      environment: 'production',\n      isDevelopment: false,\n      isProduction: true,\n    };\n    if (DEBUG_ENABLED) console.log(' Native shell detected -> using production API:', config);\n    return config;\n  }\n  \n  // Check if local development server is running (regardless of hostname)\n  // Prefer the current hostname for LAN access so other devices can reach the API\n  if (isDev || mode === 'development') {\n    const isLoopback = hostname === 'localhost' || hostname.startsWith('127.');\n    const apiHost = isLoopback ? 'localhost' : hostname; // e.g., 172.20.x.x\n    const devApiUrl = `${protocol}//${apiHost}:3001`;\n    const config: EnvironmentConfig = {\n      apiUrl: devApiUrl,\n      socketUrl: devApiUrl,\n      environment: 'development',\n      isDevelopment: true,\n      isProduction: false\n    };\n    if (DEBUG_ENABLED) console.log(' Development mode detected (dynamic host for LAN):', config);\n    return config;\n  }\n  \n  // Check environment variable override\n  if (API_BASE) {\n    const config: EnvironmentConfig = {\n      apiUrl: API_BASE,\n      socketUrl: API_BASE,\n      environment: isProd ? 'production' : 'development',\n      isDevelopment: !isProd,\n      isProduction: isProd\n    };\n    if (DEBUG_ENABLED) console.log(' Using VITE_API_BASE:', config);\n    return config;\n  }\n  \n  // Local development\n  if (!runningInNativeApp && (hostname === 'localhost' || hostname.startsWith('127.0.0.1') || hostname.startsWith('192.168.'))) {\n    const config: EnvironmentConfig = {\n      apiUrl: 'http://localhost:3001',\n      socketUrl: 'http://localhost:3001',\n      environment: 'development',\n      isDevelopment: true,\n      isProduction: false\n    };\n    if (DEBUG_ENABLED) console.log(' Local development detected:', config);\n    return config;\n  }\n  \n  // Fallback to production\n  const config: EnvironmentConfig = {\n    apiUrl: productionApi,\n    socketUrl: productionApi,\n    environment: 'production',\n    isDevelopment: false,\n    isProduction: true\n  };\n  if (DEBUG_ENABLED) console.log(' Unknown hostname, falling back to single service:', config);\n  return config;\n}\n\nexport function getApiUrl(): string {\n  return getEnvironmentConfig().apiUrl;\n}\n\nexport function getSocketUrl(): string {\n  const config = getEnvironmentConfig();\n  if (DEBUG_ENABLED) {\n    console.log(' Socket URL configuration:', {\n      hostname: window.location.hostname,\n      configuredUrl: config.socketUrl,\n      environment: config.environment,\n      isDevelopment: config.isDevelopment,\n      isProduction: config.isProduction\n    });\n  }\n  return config.socketUrl;\n}\n\nexport function isDevelopment(): boolean {\n  return getEnvironmentConfig().isDevelopment;\n}\n\nexport function isProduction(): boolean {\n  return getEnvironmentConfig().isProduction;\n}\n","import { createClient, type SupabaseClient } from '@supabase/supabase-js';\nimport { Capacitor } from '@capacitor/core';\nimport { App as CapacitorApp } from '@capacitor/app';\nimport { Browser } from '@capacitor/browser';\nimport type { PluginListenerHandle } from '@capacitor/core';\nimport { SUPABASE_URL, SUPABASE_ANON_KEY } from '@/utils/environment';\nimport { captureReturnTo } from '@/lib/returnTo';\n\n// Environment variables from centralized config\nconst supabaseUrl = SUPABASE_URL;\nconst supabaseAnonKey = SUPABASE_ANON_KEY;\n\nconsole.log(' Supabase Config Check:');\nconsole.log('URL:', supabaseUrl ? ' Present' : ' Missing');\nconsole.log('Anon Key:', supabaseAnonKey ? ' Present' : ' Missing');\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  const missingVars = [];\n  if (!supabaseUrl) missingVars.push('VITE_SUPABASE_URL');\n  if (!supabaseAnonKey) missingVars.push('VITE_SUPABASE_ANON_KEY');\n  \n  throw new Error(\n    ` Missing Supabase environment variables: ${missingVars.join(', ')}.\\n` +\n    'Please check your .env.development.local file and ensure these variables are set:\\n' +\n    '- VITE_SUPABASE_URL=https://your-project-ref.supabase.co\\n' +\n    '- VITE_SUPABASE_ANON_KEY=your-anon-public-key-here'\n  );\n}\n\n// Check if running in native Capacitor shell\nconst isNativePlatform = () => {\n  if (typeof window === 'undefined') return false;\n  \n  // Primary check: Capacitor.isNativePlatform()\n  const capacitorNative = Boolean(Capacitor?.isNativePlatform?.());\n  \n  // Secondary check: platform is not 'web'\n  const platformCheck = Capacitor?.getPlatform?.() !== 'web';\n  \n  // Tertiary check: user agent contains Capacitor or native indicators\n  const uaCheck = typeof navigator !== 'undefined' && /Capacitor|ionic/i.test(navigator.userAgent || '');\n  \n  const isNative = capacitorNative || platformCheck;\n  \n  // Log for debugging (always log this in production too for iOS troubleshooting)\n  console.log(' isNativePlatform check:', {\n    capacitorNative,\n    platform: Capacitor?.getPlatform?.(),\n    platformCheck,\n    uaCheck,\n    result: isNative\n  });\n  \n  return isNative;\n};\n\n// Helper to get the proper redirect URL for any environment\n// Native builds use deep link scheme (fanclubz://), web uses HTTPS\nfunction getRedirectUrl(next?: string) {\n  const appendNext = (base: string) => {\n    if (!next) return base;\n    const separator = base.includes('?') ? '&' : '?';\n    return `${base}${separator}next=${encodeURIComponent(next)}`;\n  };\n\n  const native = isNativePlatform();\n  \n  // Log for debugging\n  console.log(' getRedirectUrl called:', { native, next });\n\n  // CRITICAL: Native builds MUST use deep link scheme for OAuth callback\n  // This allows the app to receive the callback and close the Browser sheet\n  if (native) {\n    const deepLinkUrl = 'fanclubz://auth/callback';\n    console.log(' Auth redirect URL (native deep link):', deepLinkUrl);\n    return appendNext(deepLinkUrl);\n  }\n\n  // Check for explicit dev/local environment first\n  const isLocalDev = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';\n  \n  // In local development, always use current origin\n  if (isLocalDev) {\n    const currentOrigin = window.location.origin;\n    const fallback = `${currentOrigin}/auth/callback`;\n    if (import.meta.env.DEV) {\n      console.log(' Auth redirect URL (local dev):', fallback);\n    }\n    return appendNext(fallback);\n  }\n  \n  // Check if we have a custom redirect URL override (highest priority)\n  if (import.meta.env.VITE_AUTH_REDIRECT_URL) {\n    if (import.meta.env.DEV) {\n      console.log(' Auth redirect URL (override):', import.meta.env.VITE_AUTH_REDIRECT_URL);\n    }\n    return appendNext(import.meta.env.VITE_AUTH_REDIRECT_URL);\n  }\n  \n  // In production web, always use the production URL (never localhost)\n  const prodUrl = 'https://app.fanclubz.app/auth/callback';\n  if (import.meta.env.DEV) {\n    console.log(' Auth redirect URL (production web):', prodUrl);\n  }\n  return appendNext(prodUrl);\n}\n\nexport const buildAuthRedirectUrl = (next?: string) => getRedirectUrl(next);\n\nlet nativeAuthListener: PluginListenerHandle | null = null;\n\nconst ensureNativeAuthListener = async () => {\n  if (!isNativePlatform() || nativeAuthListener) return;\n\n  const handle = await CapacitorApp.addListener('appUrlOpen', async ({ url }) => {\n    try {\n      console.log('');\n      console.log(' Native appUrlOpen received:', url);\n      console.log('');\n      \n      // Handle deep link callback: fanclubz://auth/callback?code=...&state=...\n      const isDeepLinkCallback = url && url.startsWith('fanclubz://auth/callback');\n      \n      // Also handle HTTPS fallback (if somehow we get HTTPS in native)\n      const isHttpsCallback = url && (\n        url.includes('app.fanclubz.app/auth/callback') ||\n        url.includes('localhost/auth/callback') ||\n        url.includes('127.0.0.1/auth/callback')\n      );\n\n      if (!isDeepLinkCallback && !isHttpsCallback) {\n        console.log(' Not an auth callback URL, ignoring');\n        return;\n      }\n\n      console.log(' Auth callback detected, processing...');\n\n      // Close the browser immediately (critical for UX)\n      await Browser.close().catch((err) => {\n        console.warn(' Browser.close() failed (may already be closed):', err);\n      });\n\n      // For deep link (fanclubz://auth/callback?code=...), Supabase needs the full URL\n      // Extract code and state from the deep link URL\n      if (isDeepLinkCallback) {\n        console.log(' Processing deep link callback...');\n        \n        // Parse the deep link URL to extract query params\n        let code: string | null = null;\n        let state: string | null = null;\n        \n        try {\n          // Deep link format: fanclubz://auth/callback?code=xxx&state=yyy\n          const urlObj = new URL(url.replace('fanclubz://', 'https://'));\n          code = urlObj.searchParams.get('code');\n          state = urlObj.searchParams.get('state');\n          \n          console.log(' Extracted from deep link:', { code: code ? 'present' : 'missing', state: state ? 'present' : 'missing' });\n        } catch (err) {\n          console.error(' Failed to parse deep link URL:', err);\n        }\n\n        // Exchange the code for a session using Supabase PKCE flow\n        if (code) {\n          try {\n            console.log(' Exchanging code for session...');\n            const { data, error } = await supabase.auth.exchangeCodeForSession(code);\n            \n            if (error) {\n              console.error(' Code exchange failed:', error);\n              // Fall through to route handling - AuthCallback will show error\n            } else if (data?.session) {\n              console.log(' Session established:', data.session.user.email);\n            }\n          } catch (err) {\n            console.error(' Code exchange exception:', err);\n          }\n        }\n      }\n\n      // Emit auth completed event (overlay will hide)\n      window.dispatchEvent(new CustomEvent('auth-in-progress', { detail: { started: false, completed: true } }));\n\n      // Navigate to the callback route in the app\n      // AuthCallback component will handle final session verification and redirect\n      const callbackPath = '/auth/callback' + (url.includes('?') ? url.substring(url.indexOf('?')) : '');\n      console.log(' Navigating to callback route:', callbackPath);\n      console.log('');\n      \n      // Use window.location to trigger full navigation (ensures AuthCallback runs)\n      window.location.href = callbackPath;\n    } catch (err) {\n      console.error(' Native auth listener exception:', err);\n    }\n  });\n  nativeAuthListener = handle;\n  \n  console.log(' Native auth listener registered for deep link: fanclubz://auth/callback');\n};\n\nconst getAuthStorage = () => {\n  if (typeof window === 'undefined') return undefined;\n  try {\n    return window.localStorage;\n  } catch (error) {\n    console.warn(' Unable to access localStorage for Supabase auth storage:', error);\n    return undefined;\n  }\n};\n\nconst supabaseOptions: any = {\n  auth: {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n    flowType: 'pkce',\n  },\n  db: {\n    schema: 'public',\n  },\n  global: {\n    headers: {\n      'X-Client-Info': 'fanclubz-web@1.0.0',\n    },\n  },\n};\n\nconst authStorage = getAuthStorage();\nif (authStorage) {\n  supabaseOptions.auth = {\n    ...supabaseOptions.auth,\n    storage: authStorage,\n    storageKey: 'fcz-auth-storage',\n  };\n}\n\ntype TypedSupabaseClient = SupabaseClient<any, any, any>;\n\ntype GlobalWithSupabase = typeof globalThis & {\n  __fanclubzSupabase?: TypedSupabaseClient;\n};\n\nconst globalWithSupabase = globalThis as GlobalWithSupabase;\n\n// Create Supabase client with proper OAuth configuration\nexport const supabase: TypedSupabaseClient =\n  globalWithSupabase.__fanclubzSupabase ??\n  (createClient(supabaseUrl, supabaseAnonKey, supabaseOptions) as TypedSupabaseClient);\n\nif (!globalWithSupabase.__fanclubzSupabase) {\n  globalWithSupabase.__fanclubzSupabase = supabase;\n}\n\n// Test the connection on initialization\nconst testConnection = async () => {\n  try {\n    // Simple auth check instead of table access\n    const { data: { session }, error } = await supabase.auth.getSession();\n    if (error) {\n      console.warn(' Supabase auth check failed:', error.message);\n    } else {\n      console.log(' Supabase connection successful');\n    }\n  } catch (error: any) {\n    console.warn(' Supabase connection test failed:', error.message);\n    // Don't throw error - let the app continue to work\n  }\n};\n\n// Run connection test in development\nimport { isDev } from '@/utils/environment';\nif (isDev) {\n  testConnection();\n}\n\n// Auth helpers with better error handling and dynamic redirect URLs\ntype OAuthProvider = 'google' | 'github' | 'discord' | 'apple';\n\nexport const auth = {\n  signUp: async (email: string, password: string, userData: any = {}) => {\n    try {\n      const { data, error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: userData,\n          emailRedirectTo: getRedirectUrl(),\n        },\n      });\n      \n      if (error) {\n        console.error('Auth signUp error:', error);\n      }\n      \n      return { data, error };\n    } catch (error: any) {\n      console.error('Auth signUp exception:', error);\n      return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  },\n\n  signIn: async (email: string, password: string) => {\n    try {\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n      \n      if (error) {\n        console.error('Auth signIn error:', error);\n      }\n      \n      return { data, error };\n    } catch (error: any) {\n      console.error('Auth signIn exception:', error);\n      return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  },\n\n      signInWithOAuth: async (provider: OAuthProvider, options?: { next?: string }) => {\n        const native = isNativePlatform();\n        if (native) {\n          await ensureNativeAuthListener();\n        }\n\n        try {\n          console.log('');\n          console.log(' OAUTH SIGN IN STARTED');\n          console.log('  Provider:', provider);\n          console.log('  Is Native:', native);\n          console.log('  Capacitor Platform:', Capacitor?.getPlatform?.());\n          console.log('  Next param:', options?.next);\n          console.log('  Current hostname:', window.location.hostname);\n          console.log('  Current origin:', window.location.origin);\n          console.log('');\n          \n          const redirectUrl = getRedirectUrl(options?.next);\n          console.log(' Final OAuth redirect URL:', redirectUrl);\n          console.log(' Expected for native: fanclubz://auth/callback');\n          console.log('');\n\n          // Emit auth started event for overlay\n          if (native) {\n            window.dispatchEvent(new CustomEvent('auth-in-progress', { detail: { started: true } }));\n          }\n\n          const { data, error} = await supabase.auth.signInWithOAuth({\n            provider,\n            options: {\n              redirectTo: redirectUrl,\n              skipBrowserRedirect: native,\n              queryParams: {\n                access_type: 'offline',\n                prompt: 'consent',\n              },\n            },\n          });\n          \n          if (error) {\n            console.error('Auth signInWithOAuth error:', error);\n            if (native) {\n              window.dispatchEvent(new CustomEvent('auth-in-progress', { detail: { started: false, error: true } }));\n            }\n          } else if (native && data?.url) {\n            // Log the EXACT URL being opened (user requested this)\n            console.log('');\n            console.log(' EXACT Browser.open URL:');\n            console.log(data.url);\n            console.log('');\n            console.log(' URL contains redirect_to=fanclubz:', data.url.includes('redirect_to=fanclubz'));\n            console.log(' URL contains redirect_to=fanclubz%3A%2F%2Fauth%2Fcallback:', data.url.includes('redirect_to=fanclubz%3A%2F%2Fauth%2Fcallback'));\n            console.log('');\n            \n            await Browser.open({\n              url: data.url,\n              presentationStyle: 'fullscreen',\n            });\n          }\n          \n          return { data, error };\n        } catch (error: any) {\n          console.error('Auth signInWithOAuth exception:', error);\n          if (native) {\n            window.dispatchEvent(new CustomEvent('auth-in-progress', { detail: { started: false, error: true } }));\n          }\n          return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n        }\n      },\n\n  signOut: async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      \n      if (error) {\n        console.error('Auth signOut error:', error);\n      }\n      \n      return { error };\n    } catch (error: any) {\n      console.error('Auth signOut exception:', error);\n      return { error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  },\n\n  getCurrentUser: async () => {\n    try {\n      const { data: { user }, error } = await supabase.auth.getUser();\n      \n      if (error) {\n        console.error('Auth getCurrentUser error:', error);\n      }\n      \n      return { user, error };\n    } catch (error: any) {\n      console.error('Auth getCurrentUser exception:', error);\n      return { user: null, error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  },\n\n  onAuthStateChange: (callback: (event: string, session: any) => void) => {\n    return supabase.auth.onAuthStateChange(callback);\n  },\n};\n\n// Database helpers for client-side operations\nexport const clientDb = {\n  predictions: {\n    async getAll(filters: any = {}) {\n      try {\n        let query = supabase\n          .from('predictions')\n          .select(`\n            *,\n            creator:users!creator_id(id, username, full_name, avatar_url),\n            options:prediction_options!prediction_options_prediction_id_fkey(*),\n          `);\n\n        if (filters.category) {\n          query = query.eq('category', filters.category);\n        }\n\n        if (filters.status) {\n          query = query.eq('status', filters.status);\n        }\n\n        if (filters.search) {\n          query = query.or(`title.ilike.%${filters.search}%,description.ilike.%${filters.search}%`);\n        }\n\n        const { data, error } = await query\n          .order('created_at', { ascending: false })\n          .limit(filters.limit || 20);\n\n        if (error && !error.message.includes('relation') && !error.message.includes('does not exist')) {\n          console.error('Database error in predictions.getAll:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in predictions.getAll:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n\n    async getById(id: string) {\n      try {\n        const { data, error } = await supabase\n          .from('predictions')\n          .select(`\n            *,\n            creator:users!creator_id(id, username, full_name, avatar_url),\n            options:prediction_options!prediction_options_prediction_id_fkey(*),\n          `)\n          .eq('id', id)\n          .single();\n\n        if (error && !error.message.includes('relation') && !error.message.includes('does not exist')) {\n          console.error('Database error in predictions.getById:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in predictions.getById:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n\n    async create(predictionData: any) {\n      try {\n        const { data, error } = await supabase\n          .from('predictions')\n          .insert(predictionData)\n          .select()\n          .single();\n\n        if (error) {\n          console.error('Database error in predictions.create:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in predictions.create:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n  },\n\n  users: {\n    async getProfile(userId: string) {\n      try {\n        const { data, error } = await supabase\n          .from('users')\n          .select('*')\n          .eq('id', userId)\n          .single();\n\n        if (error && !error.message.includes('relation') && !error.message.includes('does not exist')) {\n          console.error('Database error in users.getProfile:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in users.getProfile:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n\n    async updateProfile(userId: string, updates: any) {\n      try {\n        const { data, error } = await supabase\n          .from('users')\n          .update(updates)\n          .eq('id', userId)\n          .select()\n          .single();\n\n        if (error) {\n          console.error('Database error in users.updateProfile:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in users.updateProfile:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n  },\n\n  wallets: {\n    async getBalance(userId: string, currency: string = 'NGN') {\n      try {\n        const { data, error } = await supabase\n          .from('wallets')\n          .select('*')\n          .eq('user_id', userId)\n          .eq('currency', currency)\n          .single();\n\n        if (error && !error.message.includes('relation') && !error.message.includes('does not exist')) {\n          console.error('Database error in wallets.getBalance:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in wallets.getBalance:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n\n    async getTransactions(userId: string, limit: number = 20) {\n      try {\n        const { data, error } = await supabase\n          .from('wallet_transactions')\n          .select('*')\n          .eq('user_id', userId)\n          .order('created_at', { ascending: false })\n          .limit(limit);\n\n        if (error && !error.message.includes('relation') && !error.message.includes('does not exist')) {\n          console.error('Database error in wallets.getTransactions:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in wallets.getTransactions:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n  },\n\n\n  comments: {\n    async getByPredictionId(predictionId: string, limit: number = 20) {\n      try {\n        const { data, error } = await supabase\n          .from('comments')\n          .select(`\n            *,\n            user:users(id, username, full_name, avatar_url)\n          `)\n          .eq('prediction_id', predictionId)\n          .is('parent_comment_id', null)\n          .order('created_at', { ascending: false })\n          .limit(limit);\n\n        if (error && !error.message.includes('relation') && !error.message.includes('does not exist')) {\n          console.error('Database error in comments.getByPredictionId:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in comments.getByPredictionId:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n\n    async create(commentData: any) {\n      try {\n        const { data, error } = await supabase\n          .from('comments')\n          .insert(commentData)\n          .select(`\n            *,\n            user:users(id, username, full_name, avatar_url)\n          `)\n          .single();\n\n        if (error) {\n          console.error('Database error in comments.create:', error);\n        }\n\n        return { data, error };\n      } catch (error: any) {\n        console.error('Exception in comments.create:', error);\n        return { data: null, error: { message: error.message || 'An unexpected error occurred' } };\n      }\n    },\n  },\n};\n\nif (isNativePlatform()) {\n  ensureNativeAuthListener();\n}\n\n// Real-time subscriptions\nexport const realtime = {\n  subscribeToComments: (predictionId: string, callback: (payload: any) => void) => {\n    return supabase\n      .channel(`comments:${predictionId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'comments',\n          filter: `prediction_id=eq.${predictionId}`,\n        },\n        callback\n      )\n      .subscribe();\n  },\n\n  subscribeToReactions: (predictionId: string, callback: (payload: any) => void) => {\n    return supabase\n      .channel(`reactions:${predictionId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'reactions',\n          filter: `prediction_id=eq.${predictionId}`,\n        },\n        callback\n      )\n      .subscribe();\n  },\n\n  subscribeToPredictionUpdates: (callback: (payload: any) => void) => {\n    return supabase\n      .channel('predictions')\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'predictions',\n        },\n        callback\n      )\n      .subscribe();\n  },\n};\n\nexport default supabase;\n","import { create } from 'zustand';\nimport { supabase } from '../lib/supabase';\n\nexport interface Transaction {\n  id: string;\n  type: 'deposit' | 'withdraw' | 'prediction' | 'prediction_lock' | 'prediction_release' | 'win' | 'loss' | 'refund' | 'transfer_in' | 'transfer_out' | 'bet_lock' | 'bet_release';\n  amount: number;\n  description: string;\n  date: Date;\n  status: 'completed' | 'pending' | 'failed';\n  reference?: string;\n  currency: 'USD';\n  fee?: number;\n  fromUser?: string;\n  toUser?: string;\n  predictionId?: string;\n}\n\ninterface WalletBalance {\n  currency: 'USD';\n  available: number;\n  reserved: number;\n  total: number;\n}\n\nexport interface WalletState {\n  balances: WalletBalance[];\n  transactions: Transaction[];\n  isLoading: boolean;\n  error: string | null;\n  walletSummary?: {\n    available_balance?: number;\n    reserved_balance?: number;\n    total_balance?: number;\n  } | null;\n  \n  // Computed properties for easy access\n  balance: number; // Available USD balance\n  totalBalance: number; // Total USD balance (available + reserved)\n  reservedBalance: number; // Reserved USD balance\n  \n  // Actions\n  initializeWallet: () => Promise<void>;\n  addFunds: (amount: number, currency?: 'USD', method?: string) => Promise<Transaction>;\n  withdraw: (amount: number, currency?: 'USD', destination?: string) => Promise<Transaction>;\n  makePrediction: (amount: number, description: string, predictionId: string, currency?: 'USD') => Promise<Transaction>;\n  lockFunds: (amount: number, currency?: 'USD') => Promise<void>; // Added this method\n  recordWin: (amount: number, description: string, predictionId: string, currency?: 'USD') => Promise<Transaction>;\n  recordLoss: (amount: number, description: string, predictionId: string, currency?: 'USD') => Promise<Transaction>;\n  transferFunds: (amount: number, toUser: string, description?: string, currency?: 'USD') => Promise<Transaction>;\n  getBalance: (currency?: 'USD') => number;\n  getTransactionHistory: (filters?: { type?: string; currency?: string; limit?: number }) => Transaction[];\n  clearError: () => void;\n  refreshWalletData: () => Promise<void>;\n}\n\nexport const useWalletStore = create<WalletState>()(\n    (set, get) => ({\n      balances: [],\n      transactions: [],\n      isLoading: false,\n      error: null,\n      walletSummary: null,\n      \n      // Computed properties\n      get balance() {\n        const state = get();\n        const usdBalance = state.balances.find(b => b.currency === 'USD');\n        return usdBalance?.available || 0;\n      },\n      \n      get totalBalance() {\n        const state = get();\n        const usdBalance = state.balances.find(b => b.currency === 'USD');\n        return usdBalance?.total || 0;\n      },\n      \n      get reservedBalance() {\n        const state = get();\n        const usdBalance = state.balances.find(b => b.currency === 'USD');\n        return usdBalance?.reserved || 0;\n      },\n\n      initializeWallet: async () => {\n        // DISABLED: This function reads from wallets table (demo/mock data)\n        // Wallet balance must come from on-chain data via useUSDCBalance hook\n        // Escrow data comes from useWalletSummary hook\n        console.log('[FCZ-PAY] initializeWallet() called but disabled - use on-chain hooks instead');\n        set({ \n          balances: [],\n          transactions: [],\n          isLoading: false,\n          error: null\n        });\n      },\n\n      refreshWalletData: async () => {\n        await get().initializeWallet();\n      },\n\n      // Lock funds method for predictions (creates bet_lock transaction)\n      lockFunds: async (amount: number, currency: 'USD' = 'USD') => {\n        try {\n          // Validate amount\n          if (isNaN(amount) || amount <= 0) {\n            throw new Error('Please enter a valid amount');\n          }\n\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          \n          if (!currentBalance || currentBalance.available < amount) {\n            throw new Error('Insufficient funds');\n          }\n\n          // Update local state immediately\n          const newAvailable = currentBalance.available - amount;\n          const newReserved = currentBalance.reserved + amount;\n\n          // Create transaction record for locking funds\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'bet_lock',\n            amount: amount,\n            description: 'Funds locked for prediction',\n            date: new Date(),\n            status: 'completed',\n            reference: `LOCK_${Date.now()}`,\n            currency: currency,\n            fee: 0\n          };\n\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, available: newAvailable, reserved: newReserved, total: newAvailable + newReserved }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            error: null\n          }));\n\n          console.log(' Funds locked successfully with transaction record:', amount, currency);\n\n          // Persist to database if user is authenticated\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: newAvailable,\n                  reserved_balance: newReserved,\n                  updated_at: new Date().toISOString()\n                }, {\n                  onConflict: 'user_id,currency'\n                });\n\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: transaction.type,\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  created_at: new Date().toISOString()\n                });\n            }\n          } catch (dbError) {\n            console.log(' Could not update database, using local state only');\n          }\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to lock funds';\n          set({ error: errorMessage });\n          throw error;\n        }\n      },\n\n      addFunds: async (amount: number, currency: 'USD' = 'USD', method: string = 'Bank Transfer') => {\n        set({ isLoading: true, error: null });\n        \n        try {\n          // Validate amount\n          if (isNaN(amount) || amount <= 0) {\n            throw new Error('Please enter a valid amount');\n          }\n\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          const newAvailable = (currentBalance?.available || 0) + amount;\n          const newTotal = newAvailable + (currentBalance?.reserved || 0);\n\n          // Create transaction\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'deposit',\n            amount: amount,\n            description: `${method} Deposit`,\n            date: new Date(),\n            status: 'completed',\n            reference: `DEP_${Date.now()}`,\n            currency: currency,\n            fee: 0\n          };\n\n          // Update state\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, available: newAvailable, total: newTotal }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            isLoading: false,\n            error: null\n          }));\n\n          // CRITICAL: Save to database for persistence\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              // Update wallet balance in database\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: newAvailable,\n                  reserved_balance: currentBalance?.reserved || 0,\n                  total_deposited: (currentBalance?.available || 0) + amount,\n                  updated_at: new Date().toISOString()\n                }, {\n                  onConflict: 'user_id,currency'\n                });\n\n              // Create transaction record in database\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: transaction.type,\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  created_at: new Date().toISOString()\n                });\n\n              console.log(' Funds added and saved to database:', amount, currency);\n            }\n          } catch (dbError) {\n            console.error(' Failed to save to database:', dbError);\n            // Don't throw error here - local state is updated, just log the issue\n          }\n\n          return transaction;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to add funds';\n          set({ isLoading: false, error: errorMessage });\n          throw error;\n        }\n      },\n\n      withdraw: async (amount: number, currency: 'USD' = 'USD', destination: string = 'Bank Account') => {\n        set({ isLoading: true, error: null });\n        \n        try {\n          // Validate amount\n          if (isNaN(amount) || amount <= 0) {\n            throw new Error('Please enter a valid amount');\n          }\n\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          \n          if (!currentBalance || currentBalance.available < amount) {\n            throw new Error('Insufficient funds');\n          }\n\n          const newAvailable = currentBalance.available - amount;\n          const newTotal = newAvailable + currentBalance.reserved;\n\n          // Create transaction\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'withdraw',\n            amount: amount,\n            description: `Withdrawal to ${destination}`,\n            date: new Date(),\n            status: 'completed',\n            reference: `WTH_${Date.now()}`,\n            currency: currency,\n            fee: 0\n          };\n\n          // Update state\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, available: newAvailable, total: newTotal }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            isLoading: false,\n            error: null\n          }));\n\n          // Persist to database\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: newAvailable,\n                  reserved_balance: currentBalance.reserved,\n                  updated_at: new Date().toISOString()\n                }, { onConflict: 'user_id,currency' });\n\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: transaction.type,\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  created_at: new Date().toISOString()\n                });\n            }\n          } catch (dbError) {\n            console.error(' Failed to persist withdrawal:', dbError);\n          }\n\n          console.log(' Withdrawal successful:', amount, currency);\n          return transaction;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to withdraw funds';\n          set({ isLoading: false, error: errorMessage });\n          throw error;\n        }\n      },\n\n      makePrediction: async (amount: number, description: string, predictionId: string, currency: 'USD' = 'USD') => {\n        set({ isLoading: true, error: null });\n        \n        try {\n          // Validate amount\n          if (isNaN(amount) || amount <= 0) {\n            throw new Error('Please enter a valid amount');\n          }\n\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          \n          if (!currentBalance || currentBalance.available < amount) {\n            throw new Error('Insufficient funds');\n          }\n\n          const newAvailable = currentBalance.available - amount;\n          const newReserved = currentBalance.reserved + amount;\n          const newTotal = newAvailable + newReserved;\n\n          // Create transaction (lock)\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'bet_lock',\n            amount: amount,\n            description: description,\n            date: new Date(),\n            status: 'completed',\n            reference: `PRED_${Date.now()}`,\n            currency: currency,\n            fee: 0,\n            predictionId: predictionId\n          };\n\n          // Update state\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, available: newAvailable, reserved: newReserved, total: newTotal }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            isLoading: false,\n            error: null\n          }));\n\n          // Persist to database\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: newAvailable,\n                  reserved_balance: newReserved,\n                  updated_at: new Date().toISOString()\n                }, { onConflict: 'user_id,currency' });\n\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: transaction.type,\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  created_at: new Date().toISOString()\n                });\n            }\n          } catch (dbError) {\n            console.error(' Failed to persist prediction lock:', dbError);\n          }\n\n          console.log(' Prediction made successfully:', amount, currency);\n          return transaction;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to make prediction';\n          set({ isLoading: false, error: errorMessage });\n          throw error;\n        }\n      },\n\n      recordWin: async (amount: number, description: string, predictionId: string, currency: 'USD' = 'USD') => {\n        set({ isLoading: true, error: null });\n        \n        try {\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          const newAvailable = (currentBalance?.available || 0) + amount;\n          const newReserved = Math.max(0, (currentBalance?.reserved || 0) - amount);\n          const newTotal = newAvailable + newReserved;\n\n          // Create transaction\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'win',\n            amount: amount,\n            description: description,\n            date: new Date(),\n            status: 'completed',\n            reference: `WIN_${Date.now()}`,\n            currency: currency,\n            fee: 0,\n            predictionId: predictionId\n          };\n\n          // Update state\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, available: newAvailable, reserved: newReserved, total: newTotal }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            isLoading: false,\n            error: null\n          }));\n\n          // Persist to database\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: newAvailable,\n                  reserved_balance: newReserved,\n                  updated_at: new Date().toISOString()\n                }, { onConflict: 'user_id,currency' });\n\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: 'bet_release',\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  prediction_id: predictionId,\n                  created_at: new Date().toISOString()\n                });\n            }\n          } catch (dbError) {\n            console.error(' Failed to persist win:', dbError);\n          }\n\n          console.log(' Win recorded successfully:', amount, currency);\n          return transaction;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to record win';\n          set({ isLoading: false, error: errorMessage });\n          throw error;\n        }\n      },\n\n      recordLoss: async (amount: number, description: string, predictionId: string, currency: 'USD' = 'USD') => {\n        set({ isLoading: true, error: null });\n        \n        try {\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          const newReserved = Math.max(0, (currentBalance?.reserved || 0) - amount);\n          const newTotal = (currentBalance?.available || 0) + newReserved;\n\n          // Create transaction\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'loss',\n            amount: amount,\n            description: description,\n            date: new Date(),\n            status: 'completed',\n            reference: `LOSS_${Date.now()}`,\n            currency: currency,\n            fee: 0,\n            predictionId: predictionId\n          };\n\n          // Update state\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, reserved: newReserved, total: newTotal }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            isLoading: false,\n            error: null\n          }));\n\n          // Persist to database\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: currentBalance?.available || 0,\n                  reserved_balance: newReserved,\n                  updated_at: new Date().toISOString()\n                }, { onConflict: 'user_id,currency' });\n\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: 'loss',\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  prediction_id: predictionId,\n                  created_at: new Date().toISOString()\n                });\n            }\n          } catch (dbError) {\n            console.error(' Failed to persist loss:', dbError);\n          }\n\n          console.log(' Loss recorded successfully:', amount, currency);\n          return transaction;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to record loss';\n          set({ isLoading: false, error: errorMessage });\n          throw error;\n        }\n      },\n\n      transferFunds: async (amount: number, toUser: string, description?: string, currency: 'USD' = 'USD') => {\n        set({ isLoading: true, error: null });\n        \n        try {\n          // Validate amount\n          if (isNaN(amount) || amount <= 0) {\n            throw new Error('Please enter a valid amount');\n          }\n\n          const state = get();\n          const currentBalance = state.balances.find(b => b.currency === currency);\n          \n          if (!currentBalance || currentBalance.available < amount) {\n            throw new Error('Insufficient funds');\n          }\n\n          const newAvailable = currentBalance.available - amount;\n          const newTotal = newAvailable + currentBalance.reserved;\n\n          // Create transaction\n          const transaction: Transaction = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            type: 'transfer_out',\n            amount: amount,\n            description: description || `Transfer to ${toUser}`,\n            date: new Date(),\n            status: 'completed',\n            reference: `TRF_${Date.now()}`,\n            currency: currency,\n            fee: 0,\n            toUser: toUser\n          };\n\n          // Update state\n          set(state => ({\n            balances: state.balances.map(balance => \n              balance.currency === currency \n                ? { ...balance, available: newAvailable, total: newTotal }\n                : balance\n            ),\n            transactions: [transaction, ...state.transactions],\n            isLoading: false,\n            error: null\n          }));\n\n          // Persist to database\n          try {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from('wallets')\n                .upsert({\n                  user_id: user.id,\n                  currency: currency,\n                  available_balance: newAvailable,\n                  reserved_balance: currentBalance.reserved,\n                  updated_at: new Date().toISOString()\n                }, { onConflict: 'user_id,currency' });\n\n              await supabase\n                .from('wallet_transactions')\n                .insert({\n                  user_id: user.id,\n                  type: transaction.type,\n                  currency: transaction.currency,\n                  amount: transaction.amount,\n                  status: transaction.status,\n                  reference: transaction.reference,\n                  description: transaction.description,\n                  to_user: toUser,\n                  created_at: new Date().toISOString()\n                });\n            }\n          } catch (dbError) {\n            console.error(' Failed to persist transfer:', dbError);\n          }\n\n          console.log(' Transfer successful:', amount, currency);\n          return transaction;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : 'Failed to transfer funds';\n          set({ isLoading: false, error: errorMessage });\n          throw error;\n        }\n      },\n\n      getBalance: (currency: 'USD' = 'USD') => {\n        const state = get();\n        const balance = state.balances.find(b => b.currency === currency);\n        return balance?.available || 0;\n      },\n\n      getTransactionHistory: (filters?: { type?: string; currency?: string; limit?: number }) => {\n        const state = get();\n        let transactions = [...state.transactions];\n\n        if (filters?.type) {\n          transactions = transactions.filter(tx => tx.type === filters.type);\n        }\n\n        if (filters?.currency) {\n          transactions = transactions.filter(tx => tx.currency === filters.currency);\n        }\n\n        if (filters?.limit) {\n          transactions = transactions.slice(0, filters.limit);\n        }\n\n        return transactions;\n      },\n\n      clearError: () => {\n        set({ error: null });\n      }\n    })\n  );","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n","import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nexport interface Notification {\n  id: string;\n  type: 'prediction_outcome' | 'comment' | 'payout' | 'market_close' | 'like' | 'follow' | 'general' | 'settlement_ready' | 'settlement_completed';\n  title: string;\n  message: string;\n  read: boolean;\n  createdAt: string;\n  data?: any; // Additional data for navigation/actions\n}\n\nexport interface NotificationSettings {\n  predictionOutcomes: boolean;\n  comments: boolean;\n  marketClosing: boolean;\n  payouts: boolean;\n  pushNotifications: boolean;\n  emailNotifications: boolean;\n  frequency: 'immediate' | 'hourly' | 'daily';\n}\n\nexport interface ToastNotification {\n  id: string;\n  type: 'success' | 'error' | 'info' | 'warning';\n  title: string;\n  message: string;\n  duration?: number;\n}\n\ninterface NotificationStore {\n  notifications: Notification[];\n  unreadCount: number;\n  settings: NotificationSettings;\n  toasts: ToastNotification[];\n  \n  // Actions\n  addNotification: (notification: Omit<Notification, 'id' | 'createdAt' | 'read'>) => void;\n  markAsRead: (id: string) => void;\n  markAllAsRead: () => void;\n  deleteNotification: (id: string) => void;\n  clearAllNotifications: () => void;\n  updateSettings: (settings: Partial<NotificationSettings>) => void;\n  \n  // Toast actions\n  addToast: (toast: Omit<ToastNotification, 'id'>) => void;\n  removeToast: (id: string) => void;\n  clearToasts: () => void;\n  \n  // Push notification actions\n  requestPermission: () => Promise<boolean>;\n  subscribeToPush: () => Promise<void>;\n  unsubscribeFromPush: () => Promise<void>;\n  sendPushNotification: (notification: Notification) => void;\n  \n  // Utility functions\n  showSuccess: (message: string, title?: string) => void;\n  showError: (message: string, title?: string) => void;\n  \n  // Settlement notification helpers\n  notifySettlementReady: (predictionId: string, predictionTitle: string) => void;\n  notifySettlementCompleted: (predictionId: string, predictionTitle: string, outcome: 'won' | 'lost', payout?: number) => void;\n}\n\nexport const useNotificationStore = create<NotificationStore>()(\n  persist(\n    (set, get) => ({\n      notifications: [],\n      unreadCount: 0,\n      toasts: [],\n      settings: {\n        predictionOutcomes: true,\n        comments: true,\n        marketClosing: true,\n        payouts: true,\n        pushNotifications: true,\n        emailNotifications: false,\n        frequency: 'immediate',\n      },\n\n      addNotification: (notificationData) => {\n        const notification: Notification = {\n          ...notificationData,\n          id: crypto.randomUUID(),\n          createdAt: new Date().toISOString(),\n          read: false,\n        };\n\n        set((state) => ({\n          notifications: [notification, ...state.notifications],\n          unreadCount: state.unreadCount + 1,\n        }));\n\n        // Show toast for important notifications\n        if (['prediction_outcome', 'payout'].includes(notification.type)) {\n          get().addToast({\n            type: 'success',\n            title: notification.title,\n            message: notification.message,\n            duration: 5000,\n          });\n        }\n\n        // Send push notification if enabled\n        if (get().settings.pushNotifications) {\n          get().sendPushNotification(notification);\n        }\n      },\n\n      markAsRead: (id) => {\n        set((state) => ({\n          notifications: state.notifications.map((n) =>\n            n.id === id ? { ...n, read: true } : n\n          ),\n          unreadCount: Math.max(0, state.unreadCount - 1),\n        }));\n      },\n\n      markAllAsRead: () => {\n        set((state) => ({\n          notifications: state.notifications.map((n) => ({ ...n, read: true })),\n          unreadCount: 0,\n        }));\n      },\n\n      deleteNotification: (id) => {\n        set((state) => {\n          const notification = state.notifications.find(n => n.id === id);\n          const wasUnread = notification && !notification.read;\n          \n          return {\n            notifications: state.notifications.filter((n) => n.id !== id),\n            unreadCount: wasUnread ? Math.max(0, state.unreadCount - 1) : state.unreadCount,\n          };\n        });\n      },\n\n      clearAllNotifications: () => {\n        set({ notifications: [], unreadCount: 0 });\n      },\n\n      updateSettings: (newSettings) => {\n        set((state) => ({\n          settings: { ...state.settings, ...newSettings },\n        }));\n      },\n\n      addToast: (toastData) => {\n        const toast: ToastNotification = {\n          ...toastData,\n          id: crypto.randomUUID(),\n        };\n\n        set((state) => ({\n          toasts: [...state.toasts, toast],\n        }));\n      },\n\n      removeToast: (id) => {\n        set((state) => ({\n          toasts: state.toasts.filter((t) => t.id !== id),\n        }));\n      },\n\n      clearToasts: () => {\n        set({ toasts: [] });\n      },\n\n      requestPermission: async () => {\n        if (!('Notification' in window)) {\n          console.warn('This browser does not support notifications');\n          return false;\n        }\n\n        if (Notification.permission === 'granted') {\n          return true;\n        }\n\n        if (Notification.permission !== 'denied') {\n          const permission = await Notification.requestPermission();\n          return permission === 'granted';\n        }\n\n        return false;\n      },\n\n      subscribeToPush: async () => {\n        const hasPermission = await get().requestPermission();\n        if (!hasPermission) {\n          throw new Error('Notification permission denied');\n        }\n\n        // TODO: Implement actual push subscription with service worker\n        console.log('Push notifications subscribed');\n        \n        set((state) => ({\n          settings: { ...state.settings, pushNotifications: true },\n        }));\n      },\n\n      unsubscribeFromPush: async () => {\n        // TODO: Implement actual push unsubscription\n        console.log('Push notifications unsubscribed');\n        \n        set((state) => ({\n          settings: { ...state.settings, pushNotifications: false },\n        }));\n      },\n\n      // Helper method to send push notifications\n      sendPushNotification: (notification: Notification) => {\n        if (!('Notification' in window) || Notification.permission !== 'granted') {\n          return;\n        }\n\n        const pushOptions: NotificationOptions & { renotify?: boolean } = {\n          body: notification.message,\n          icon: '/icon-192x192.png',\n          badge: '/icon-badge.png',\n          tag: notification.id,\n          renotify: false,\n        };\n\n        const pushNotification = new Notification(notification.title, pushOptions);\n\n        pushNotification.onclick = () => {\n          window.focus();\n          pushNotification.close();\n          \n          // Handle navigation based on notification type\n          if (notification.data?.predictionId) {\n            // Navigate to prediction detail\n            window.location.href = `/predictions/${notification.data.predictionId}`;\n          }\n        };\n\n        // Auto-close after 5 seconds\n        setTimeout(() => {\n          pushNotification.close();\n        }, 5000);\n      },\n\n      // Settlement notification helpers\n      notifySettlementReady: (predictionId: string, predictionTitle: string) => {\n        const { addNotification, addToast } = get();\n        \n        // Add persistent notification\n        addNotification({\n          type: 'settlement_ready',\n          title: 'Settlement Required',\n          message: `\"${predictionTitle}\" needs your validation. Tap to review the outcome.`,\n          data: { predictionId, action: 'validate_settlement' }\n        });\n        \n        // Show toast notification\n        addToast({\n          type: 'info',\n          title: ' Settlement Ready',\n          message: `Tap to validate the outcome of \"${predictionTitle}\"`,\n          duration: 8000,\n        });\n      },\n\n      notifySettlementCompleted: (predictionId: string, predictionTitle: string, outcome: 'won' | 'lost', payout?: number) => {\n        const { addNotification, addToast } = get();\n        \n        const message = outcome === 'won' \n          ? `You won ${payout ? `$${payout}` : ''} on \"${predictionTitle}\"!`\n          : `Settlement completed for \"${predictionTitle}\". Better luck next time!`;\n          \n        // Add persistent notification\n        addNotification({\n          type: 'settlement_completed',\n          title: outcome === 'won' ? 'You Won!' : 'Settlement Complete',\n          message,\n          data: { predictionId, outcome, payout }\n        });\n        \n        // Show toast notification\n        addToast({\n          type: outcome === 'won' ? 'success' : 'info',\n          title: outcome === 'won' ? ' You Won!' : ' Settlement Complete',\n          message,\n          duration: outcome === 'won' ? 10000 : 6000,\n        });\n      },\n\n      showSuccess: (message: string, title?: string) => {\n        get().addToast({\n          type: 'success',\n          title: title || 'Success',\n          message,\n          duration: 3000,\n        });\n      },\n\n      showError: (message: string, title?: string) => {\n        get().addToast({\n          type: 'error',\n          title: title || 'Error',\n          message,\n          duration: 5000,\n        });\n      },\n    }),\n    {\n      name: 'fanclubz-notifications',\n      partialize: (state) => ({\n        notifications: state.notifications,\n        settings: state.settings,\n      }),\n    }\n  )\n);\n\n// Helper functions for common notification types\nexport const notificationHelpers = {\n  predictionWin: (predictionTitle: string, amount: number, predictionId: string) =>\n    useNotificationStore.getState().addNotification({\n      type: 'prediction_outcome',\n      title: ' You won!',\n      message: `Your prediction \"${predictionTitle}\" was correct! You earned $${amount.toFixed(2)}.`,\n      data: { predictionId, amount },\n    }),\n\n  predictionLoss: (predictionTitle: string, predictionId: string) =>\n    useNotificationStore.getState().addNotification({\n      type: 'prediction_outcome',\n      title: 'Prediction resolved',\n      message: `Your prediction \"${predictionTitle}\" didn't win this time. Better luck next time!`,\n      data: { predictionId },\n    }),\n\n  newComment: (predictionTitle: string, commenterName: string, predictionId: string) =>\n    useNotificationStore.getState().addNotification({\n      type: 'comment',\n      title: 'New comment',\n      message: `${commenterName} commented on \"${predictionTitle}\"`,\n      data: { predictionId, commenterName },\n    }),\n\n  marketClosingSoon: (predictionTitle: string, timeLeft: string, predictionId: string) =>\n    useNotificationStore.getState().addNotification({\n      type: 'market_close',\n      title: 'Market closing soon',\n      message: `\"${predictionTitle}\" closes in ${timeLeft}. Make your final predictions!`,\n      data: { predictionId, timeLeft },\n    }),\n\n  payoutReceived: (amount: number, transactionId: string) =>\n    useNotificationStore.getState().addNotification({\n      type: 'payout',\n      title: 'Payout received',\n      message: `$${amount.toFixed(2)} has been added to your wallet.`,\n      data: { amount, transactionId },\n    }),\n\n  showSuccessToast: (message: string) =>\n    useNotificationStore.getState().addToast({\n      type: 'success',\n      title: 'Success',\n      message,\n      duration: 3000,\n    }),\n\n  showErrorToast: (message: string) =>\n    useNotificationStore.getState().addToast({\n      type: 'error',\n      title: 'Error',\n      message,\n      duration: 5000,\n    }),\n\n  showInfoToast: (message: string) =>\n    useNotificationStore.getState().addToast({\n      type: 'info',\n      title: 'Info',\n      message,\n      duration: 4000,\n    }),\n};\n\n// Export the missing functions\nexport const showSuccess = (message: string, title?: string) => {\n  useNotificationStore.getState().addToast({\n    type: 'success',\n    title: title || 'Success',\n    message,\n    duration: 3000,\n  });\n};\n\nexport const showError = (message: string, title?: string) => {\n  useNotificationStore.getState().addToast({\n    type: 'error',\n    title: title || 'Error',\n    message,\n    duration: 5000,\n  });\n};\n\n// Settlement notification helpers\nexport const notifySettlementReady = (predictionId: string, predictionTitle: string) => {\n  const store = useNotificationStore.getState();\n  \n  // Add persistent notification\n  store.addNotification({\n    type: 'settlement_ready',\n    title: 'Settlement Required',\n    message: `\"${predictionTitle}\" needs your validation. Tap to review the outcome.`,\n    data: { predictionId, action: 'validate_settlement' }\n  });\n  \n  // Show toast notification\n  store.addToast({\n    type: 'info',\n    title: ' Settlement Ready',\n    message: `Tap to validate the outcome of \"${predictionTitle}\"`,\n    duration: 8000,\n  });\n};\n\nexport const notifySettlementCompleted = (predictionId: string, predictionTitle: string, outcome: 'won' | 'lost', payout?: number) => {\n  const store = useNotificationStore.getState();\n  \n  const message = outcome === 'won' \n    ? `You won ${payout ? `$${payout}` : ''} on \"${predictionTitle}\"!`\n    : `Settlement completed for \"${predictionTitle}\". Better luck next time!`;\n    \n  // Add persistent notification\n  store.addNotification({\n    type: 'settlement_completed',\n    title: outcome === 'won' ? 'You Won!' : 'Settlement Complete',\n    message,\n    data: { predictionId, outcome, payout }\n  });\n  \n  // Show toast notification\n  store.addToast({\n    type: outcome === 'won' ? 'success' : 'info',\n    title: outcome === 'won' ? ' You Won!' : ' Settlement Complete',\n    message,\n    duration: outcome === 'won' ? 10000 : 6000,\n  });\n};\n","// Stores the current path so we can get back to it after auth\nconst KEY = \"auth:returnTo\";\n\nexport const captureReturnTo = (path?: string) => {\n  try {\n    const val =\n      path ??\n      `${window.location.pathname}${window.location.search}${window.location.hash}`;\n    sessionStorage.setItem(KEY, val);\n    console.log(' Captured return URL:', val);\n  } catch (error) {\n    console.warn('Failed to capture return URL:', error);\n  }\n};\n\nexport const consumeReturnTo = (): string | null => {\n  try {\n    const v = sessionStorage.getItem(KEY);\n    sessionStorage.removeItem(KEY);\n    console.log(' Consumed return URL:', v);\n    return v;\n  } catch {\n    return null;\n  }\n};\n\nexport const sanitizeInternalPath = (p?: string | null): string => {\n  if (!p) return \"/\";\n  \n  // If it's a full URL, extract just the path\n  try {\n    const url = new URL(p, window.location.origin);\n    // Only allow same-origin URLs\n    if (url.origin !== window.location.origin) {\n      console.warn(' Blocked external redirect:', p);\n      return \"/\";\n    }\n    return url.pathname + url.search + url.hash;\n  } catch {\n    // Not a valid URL, treat as path\n  }\n  \n  // Prevent open-redirects: only allow same-site absolute paths\n  if (!p.startsWith(\"/\")) {\n    console.warn(' Blocked non-absolute path:', p);\n    return \"/\";\n  }\n  \n  return p;\n};\n","import { create } from 'zustand';\nimport { persist, createJSONStorage } from 'zustand/middleware';\nimport { supabase, auth, clientDb } from '../lib/supabase';\nimport toast from 'react-hot-toast';\nimport { showSuccess, showError } from './notificationStore';\nimport { captureReturnTo } from '@/lib/returnTo';\n\ninterface User {\n  id: string;\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone?: string;\n  avatar?: string;\n  bio?: string;\n  provider?: string; // Added provider tracking\n  totalEarnings?: number;\n  totalInvested?: number;\n  winRate?: number;\n  activePredictions?: number;\n  totalPredictions?: number;\n  rank?: number;\n  level?: string;\n  createdAt?: string;\n  username?: string;\n  full_name?: string;\n  avatar_url?: string;\n  is_verified?: boolean;\n  // OG Badge fields from users table\n  og_badge?: 'gold' | 'silver' | 'bronze' | null;\n  og_badge_assigned_at?: string | null;\n  og_badge_member_number?: number | null;\n  referral_code?: string | null;\n}\n\ninterface AuthState {\n  isAuthenticated: boolean;\n  user: User | null;\n  token: string | null;\n  loading: boolean;\n  initialized: boolean;\n  lastAuthCheck: number;\n  login: (email: string, password: string) => Promise<void>;\n  register: (email: string, password: string, firstName: string, lastName: string) => Promise<void>;\n  loginWithOAuth: (provider: 'google' | 'apple') => Promise<void>;\n  logout: () => Promise<void>;\n  updateProfile: (profileData: any) => Promise<void>;\n  uploadAvatar: (file: File) => Promise<string>;\n  initializeAuth: () => Promise<void>;\n  handleOAuthCallback: () => Promise<User | null | void>;\n}\n\n// Fetch extended profile data from users table (includes OG badges)\nconst fetchExtendedProfile = async (userId: string): Promise<Partial<User>> => {\n  try {\n    const { data, error } = await supabase\n      .from('users')\n      .select('og_badge, og_badge_assigned_at, og_badge_member_number, referral_code, username, full_name, avatar_url')\n      .eq('id', userId)\n      .single();\n    \n    if (error || !data) {\n      return {};\n    }\n    \n    return {\n      og_badge: data.og_badge as User['og_badge'],\n      og_badge_assigned_at: data.og_badge_assigned_at,\n      og_badge_member_number: data.og_badge_member_number,\n      referral_code: data.referral_code,\n      // Also get username/avatar from users table if available\n      username: data.username || undefined,\n      full_name: data.full_name || undefined,\n      avatar_url: data.avatar_url || undefined,\n    };\n  } catch (err) {\n    console.warn('Failed to fetch extended profile:', err);\n    return {};\n  }\n};\n\n// Convert Supabase user to our User interface\nconst convertSupabaseUser = (supabaseUser: any, extendedProfile?: Partial<User>): User | null => {\n  if (!supabaseUser) return null;\n  \n  const metadata = supabaseUser.user_metadata || {};\n  const appMetadata = supabaseUser.app_metadata || {};\n  \n  // Handle different OAuth providers\n  let firstName = '';\n  let lastName = '';\n  let avatar = '';\n  \n  if (metadata.full_name) {\n    const nameParts = metadata.full_name.split(' ');\n    firstName = nameParts[0] || '';\n    lastName = nameParts.slice(1).join(' ') || '';\n  } else {\n    firstName = metadata.firstName || metadata.first_name || metadata.given_name || 'User';\n    lastName = metadata.lastName || metadata.last_name || metadata.family_name || '';\n  }\n  \n  // Handle avatar from different providers\n  if (metadata.avatar_url) {\n    avatar = metadata.avatar_url;\n  } else if (metadata.picture) {\n    avatar = metadata.picture; // Google\n  } else if (metadata.photo) {\n    avatar = metadata.photo; // Apple\n  }\n  const username = metadata.username || metadata.preferred_username || metadata.full_name || supabaseUser.email?.split('@')[0] || '';\n  const fullName = metadata.full_name || `${firstName} ${lastName}`.trim();\n  \n  return {\n    id: supabaseUser.id,\n    email: supabaseUser.email || '',\n    firstName,\n    lastName,\n    phone: supabaseUser.phone,\n    avatar: extendedProfile?.avatar_url || avatar,\n    avatar_url: extendedProfile?.avatar_url || avatar,\n    provider: appMetadata.provider || 'email',\n    bio: metadata.bio,\n    totalEarnings: metadata.totalEarnings || 0,\n    totalInvested: metadata.totalInvested || 0,\n    winRate: metadata.winRate || 0,\n    activePredictions: metadata.activePredictions || 0,\n    totalPredictions: metadata.totalPredictions || 0,\n    rank: metadata.rank || 0,\n    level: metadata.level || 'New Predictor',\n    createdAt: supabaseUser.created_at || new Date().toISOString(),\n    username: extendedProfile?.username || username,\n    full_name: extendedProfile?.full_name || fullName,\n    is_verified: Boolean(metadata.is_verified || metadata.verified),\n    // OG Badge fields from extended profile\n    og_badge: extendedProfile?.og_badge || null,\n    og_badge_assigned_at: extendedProfile?.og_badge_assigned_at || null,\n    og_badge_member_number: extendedProfile?.og_badge_member_number || null,\n    referral_code: extendedProfile?.referral_code || null,\n  };\n};\n\n// Flags to prevent multiple auth state listeners and initializations\nlet authStateChangeListenerSet = false;\nlet initializationInProgress = false;\n\n// ENHANCED: Better debouncing with event + userId tracking\nlet lastProcessedEvent = '';\nlet lastProcessedUserId = '';\nlet lastEventTime = 0;\nconst AUTH_EVENT_DEBOUNCE_MS = 5000; // Increased from 2000ms to 5000ms\n\nexport const useAuthStore = create<AuthState>()(\n  persist(\n    (set, get) => ({\n      isAuthenticated: false,\n      user: null,\n      token: null,\n      loading: false,\n      initialized: false,\n      lastAuthCheck: 0,\n\n      initializeAuth: async () => {\n        const state = get();\n        const now = Date.now();\n        \n        // Prevent multiple concurrent initializations\n        if (initializationInProgress) {\n          return;\n        }\n\n        // Prevent frequent re-initialization (max once per 30 seconds)\n        if (state.initialized && (now - state.lastAuthCheck < 30000)) {\n          return;\n        }\n\n        // If we have valid persisted data and it's recent, use it\n        if (state.isAuthenticated && state.user && state.token && (now - state.lastAuthCheck < 300000)) { // 5 minutes\n          set({ \n            loading: false, \n            initialized: true,\n            lastAuthCheck: now\n          });\n          return;\n        }\n\n        // Prevent concurrent initialization attempts\n        if (state.loading) {\n          return;\n        }\n\n        initializationInProgress = true;\n        set({ loading: true, lastAuthCheck: now });\n\n        try {\n          // Get current session without triggering auth state change\n          const { data: { session }, error } = await supabase.auth.getSession();\n\n          if (error) {\n            set({ \n              isAuthenticated: false, \n              user: null, \n              token: null, \n              loading: false,\n              initialized: true,\n              lastAuthCheck: now\n            });\n            return;\n          }\n\n          if (session?.user) {\n            // Fetch extended profile data (including OG badges) from users table\n            const extendedProfile = await fetchExtendedProfile(session.user.id);\n            const convertedUser = convertSupabaseUser(session.user, extendedProfile);\n            \n            set({ \n              isAuthenticated: true, \n              user: convertedUser,\n              token: session.access_token,\n              loading: false,\n              initialized: true,\n              lastAuthCheck: now\n            });\n          } else {\n            set({ \n              isAuthenticated: false, \n              user: null, \n              token: null, \n              loading: false,\n              initialized: true,\n              lastAuthCheck: now\n            });\n          }\n\n        } catch (error: any) {\n          console.error(' Auth initialization error:', error.message);\n          set({ \n            isAuthenticated: false, \n            user: null, \n            token: null, \n            loading: false,\n            initialized: true,\n            lastAuthCheck: now\n          });\n        } finally {\n          initializationInProgress = false;\n        }\n      },\n\n      login: async (email: string, password: string) => {\n        set({ loading: true });\n        \n        try {\n          const { data, error } = await auth.signIn(email, password);\n\n          if (error) {\n            let userMessage = 'Login failed. Please check your credentials.';\n            \n            if (error.message.includes('Invalid login credentials')) {\n              userMessage = 'Invalid email or password. Please try again.';\n            } else if (error.message.includes('Email not confirmed')) {\n              userMessage = 'Please check your email and click the confirmation link.';\n            }\n            \n            set({ loading: false });\n            showError(userMessage);\n            throw new Error(userMessage);\n          }\n\n          const authUser = data?.user;\n          const session = data?.session;\n\n          if (authUser && session) {\n            // Fetch extended profile data (including OG badges) from users table\n            const extendedProfile = await fetchExtendedProfile(authUser.id);\n            const convertedUser = convertSupabaseUser(authUser, extendedProfile);\n            \n            set({ \n              isAuthenticated: true, \n              user: convertedUser,\n              token: session.access_token,\n              loading: false,\n              initialized: true,\n              lastAuthCheck: Date.now()\n            });\n            \n            showSuccess(`Welcome back, ${convertedUser?.firstName}!`);\n          }\n\n        } catch (error: any) {\n          set({ loading: false });\n          throw error;\n        }\n      },\n\n      register: async (email: string, password: string, firstName: string, lastName: string) => {\n        set({ loading: true });\n        \n        try {\n          if (password.length < 6) {\n            throw new Error('Password must be at least 6 characters long');\n          }\n\n          const userData = {\n            data: {\n              firstName,\n              lastName,\n              first_name: firstName,\n              last_name: lastName,\n              full_name: `${firstName} ${lastName}`,\n            }\n          };\n\n          const { data, error } = await auth.signUp(email, password, userData);\n\n          if (error) {\n            let userMessage = 'Registration failed. Please try again.';\n            \n            if (error.message.includes('User already registered')) {\n              userMessage = 'An account with this email already exists. Please sign in instead.';\n            } else if (error.message.includes('Password should be at least')) {\n              userMessage = 'Password must be at least 6 characters long.';\n            }\n            \n            set({ loading: false });\n            showError(userMessage);\n            throw new Error(userMessage);\n          }\n\n          const authUser = data?.user;\n\n          if (authUser) {\n            // Fetch extended profile data (including OG badges) from users table\n            const extendedProfile = await fetchExtendedProfile(authUser.id);\n            const convertedUser = convertSupabaseUser(authUser, extendedProfile);\n            \n            // If we have a session, log them in immediately\n            if (data?.session) {\n              set({ \n                isAuthenticated: true,\n                user: convertedUser,\n                token: data.session.access_token,\n                loading: false,\n                initialized: true,\n                lastAuthCheck: Date.now()\n              });\n              showSuccess(`Welcome to Fan Club Z, ${convertedUser?.firstName}!`);\n            } else {\n              // No immediate session, but allow app access\n              set({ \n                isAuthenticated: true,\n                user: convertedUser,\n                token: null,\n                loading: false,\n                initialized: true,\n                lastAuthCheck: Date.now()\n              });\n              showSuccess(`Welcome to Fan Club Z, ${convertedUser?.firstName}! Please check your email to verify your account.`);\n            }\n          }\n\n        } catch (error: any) {\n          set({ loading: false });\n          throw error;\n        }\n      },\n\n      loginWithOAuth: async (provider: 'google' | 'apple') => {\n        set({ loading: true });\n        \n        try {\n          const currentPath = `${window.location.pathname}${window.location.search}${window.location.hash}`;\n          captureReturnTo(currentPath);\n          \n          const { data, error } = await auth.signInWithOAuth(provider, { next: currentPath });\n\n          if (error) {\n            set({ loading: false });\n            showError(`${provider} sign-in failed. Please try again.`);\n            throw new Error(error.message);\n          }\n\n          // OAuth redirect will handle the rest\n          \n        } catch (error: any) {\n          set({ loading: false });\n          throw error;\n        }\n      },\n\n      handleOAuthCallback: async () => {\n        try {\n          const { data, error } = await supabase.auth.getSession();\n          \n          if (error) {\n            showError('Authentication failed. Please try again.');\n            throw new Error(error.message);\n          }\n\n          if (data.session?.user) {\n            // Fetch extended profile data (including OG badges) from users table\n            const extendedProfile = await fetchExtendedProfile(data.session.user.id);\n            const convertedUser = convertSupabaseUser(data.session.user, extendedProfile);\n            \n            set({ \n              isAuthenticated: true, \n              user: convertedUser,\n              token: data.session.access_token,\n              loading: false,\n              initialized: true,\n              lastAuthCheck: Date.now()\n            });\n            \n            const providerId = convertedUser?.provider || 'email';\n            const providerName = providerId.charAt(0).toUpperCase() + providerId.slice(1);\n            showSuccess(`Welcome ${convertedUser?.firstName}! Signed in with ${providerName}.`);\n            \n            return convertedUser;\n          } else {\n            throw new Error('No user session found after OAuth callback');\n          }\n          \n        } catch (error: any) {\n          set({ loading: false });\n          throw error;\n        }\n      },\n\n      logout: async () => {\n        set({ loading: true });\n        \n        try {\n          const { error } = await auth.signOut();\n          \n          if (error) {\n            console.error(' Logout error:', error.message);\n          }\n          \n          set({ \n            isAuthenticated: false, \n            user: null,\n            token: null,\n            loading: false,\n            initialized: true,\n            lastAuthCheck: 0\n          });\n          \n          showSuccess('Signed out successfully');\n          \n        } catch (error: any) {\n          // Force logout regardless of error\n          set({ \n            isAuthenticated: false, \n            user: null,\n            token: null,\n            loading: false,\n            initialized: true,\n            lastAuthCheck: 0\n          });\n        }\n      },\n\n      updateProfile: async (profileData: any) => {\n        set({ loading: true });\n        \n        try {\n          const currentUser = get().user;\n          if (!currentUser) {\n            throw new Error('No user logged in');\n          }\n\n          const { data, error } = await supabase.auth.updateUser({\n            data: {\n              firstName: profileData.firstName || currentUser.firstName,\n              lastName: profileData.lastName || currentUser.lastName,\n              bio: profileData.bio !== undefined ? profileData.bio : currentUser.bio\n            }\n          });\n\n          if (error) {\n            throw new Error(error.message || 'Failed to update profile');\n          }\n\n          if (data?.user) {\n            // Fetch extended profile to preserve OG badge data\n            const extendedProfile = await fetchExtendedProfile(data.user.id);\n            const updatedUser = convertSupabaseUser(data.user, extendedProfile);\n\n            // Mirror name changes into the public users table via backend API\n            // (uses service role key to bypass RLS)\n            try {\n              const fullName = `${updatedUser?.firstName || ''} ${updatedUser?.lastName || ''}`.trim();\n              if (fullName) {\n                const { getApiUrl } = await import('@/config');\n                const apiUrl = getApiUrl();\n                const response = await fetch(`${apiUrl}/api/v2/users/${data.user.id}/profile`, {\n                  method: 'PATCH',\n                  headers: { 'Content-Type': 'application/json' },\n                  body: JSON.stringify({ full_name: fullName }),\n                });\n                if (!response.ok) {\n                  const errData = await response.json().catch(() => ({}));\n                  console.warn('Failed to mirror profile name to users table:', errData);\n                } else {\n                  console.log(' Profile name mirrored to users table via API:', fullName);\n                }\n              }\n            } catch (mirrorError) {\n              console.warn('Failed to mirror profile name to users table:', mirrorError);\n            }\n\n            set({ \n              user: updatedUser,\n              loading: false,\n              lastAuthCheck: Date.now()\n            });\n            showSuccess('Profile updated successfully!');\n          }\n\n        } catch (error: any) {\n          set({ loading: false });\n          const msg = typeof error?.message === 'string' ? error.message : '';\n          const isNetworkError = msg.toLowerCase().includes('failed to fetch') || msg.toLowerCase().includes('network error');\n          \n          if (isNetworkError) {\n            showError('Network error while saving your profile. Please check your connection and try again.');\n          } else {\n            showError(msg || 'Failed to update profile. Please try again.');\n          }\n          throw error;\n        }\n      },\n\n      // Upload profile avatar to Supabase Storage and persist URL in both auth metadata and users table\n      uploadAvatar: async (file: File) => {\n        const state = get();\n        if (!state.user) throw new Error('No user logged in');\n        const userId = state.user.id;\n\n        const ext = file.name.split('.').pop()?.toLowerCase() || 'jpg';\n        // Path must NOT include the bucket name; the SDK prefixes it.\n        const path = `${userId}/${Date.now()}.${ext}`;\n\n        // 1) Upload to storage (public bucket configured: avatars)\n        const { data: uploadData, error: uploadError } = await supabase.storage\n          .from('avatars')\n          .upload(path, file, { cacheControl: '3600', upsert: true, contentType: file.type });\n\n        if (uploadError) {\n          const raw = uploadError.message || '';\n          const lower = raw.toLowerCase();\n          \n          if (lower.includes('file size') || lower.includes('too large') || lower.includes('maximum allowed size')) {\n            showError('Image is too large. Please choose a file under 10 MB.');\n          } else if (lower.includes('mime') || lower.includes('content-type') || lower.includes('invalid file type')) {\n            showError('Invalid image type. Please upload a JPG, PNG, or GIF image.');\n          } else {\n            showError('Failed to upload image. Please try again.');\n          }\n          throw uploadError;\n        }\n\n        // 2) Get public URL\n        const { data: publicUrlData } = supabase.storage.from('avatars').getPublicUrl(uploadData.path);\n        const publicUrl = publicUrlData.publicUrl;\n\n        // 3) Save to auth user metadata\n        const { data: authUpdate, error: authErr } = await supabase.auth.updateUser({ data: { avatar_url: publicUrl } });\n        if (authErr) {\n          showError('Failed to save avatar to profile.');\n          throw authErr;\n        }\n\n        // 4) Mirror to public users table for fast reads\n        await clientDb.users.updateProfile(userId, { avatar_url: publicUrl });\n\n        // 5) Update local state - preserve OG badge data\n        const extendedProfile = await fetchExtendedProfile(userId);\n        const updatedUser = authUpdate?.user ? convertSupabaseUser(authUpdate.user, extendedProfile) : null;\n        if (updatedUser) {\n          set({ user: updatedUser, lastAuthCheck: Date.now() });\n        }\n        showSuccess('Profile photo updated.');\n        return publicUrl;\n      },\n    }),\n    {\n      name: 'fanclubz-auth-storage',\n      storage: createJSONStorage(() => localStorage),\n      partialize: (state) => ({\n        isAuthenticated: state.isAuthenticated,\n        user: state.user,\n        token: state.token,\n        initialized: state.initialized,\n        lastAuthCheck: state.lastAuthCheck\n      }),\n      version: 6, // Increment version for OG badge support\n    }\n  )\n);\n\n// Set up auth state change listener only once per session with ENHANCED event filtering\nif (typeof window !== 'undefined' && !authStateChangeListenerSet) {\n  authStateChangeListenerSet = true;\n  \n  supabase.auth.onAuthStateChange((event, session) => {\n    const now = Date.now();\n    const userId = session?.user?.id || '';\n    \n    // ENHANCED: Create a unique key combining event + userId\n    const eventKey = `${event}:${userId}`;\n    \n    // Skip if this exact event+user combo was processed recently\n    if (eventKey === `${lastProcessedEvent}:${lastProcessedUserId}` && \n        (now - lastEventTime) < AUTH_EVENT_DEBOUNCE_MS) {\n      return;\n    }\n    \n    // Update tracking\n    lastProcessedEvent = event;\n    lastProcessedUserId = userId;\n    lastEventTime = now;\n    \n    const currentState = useAuthStore.getState();\n    \n    // Handle SIGNED_IN - critical for OAuth flows\n    if (event === 'SIGNED_IN' && session?.user) {\n      // Only update if we don't already have this user authenticated\n      if (!currentState.isAuthenticated || currentState.user?.id !== session.user.id) {\n        const convertedUser = convertSupabaseUser(session.user);\n        if (import.meta.env.DEV) {\n          console.log(' Auth state change: SIGNED_IN', convertedUser?.email);\n        }\n        useAuthStore.setState({\n          isAuthenticated: true,\n          user: convertedUser,\n          token: session.access_token,\n          loading: false,\n          initialized: true,\n          lastAuthCheck: now\n        });\n      }\n    }\n    // Handle SIGNED_OUT\n    else if (event === 'SIGNED_OUT') {\n      if (import.meta.env.DEV) {\n        console.log(' Auth state change: SIGNED_OUT');\n      }\n      useAuthStore.setState({\n        isAuthenticated: false,\n        user: null,\n        token: null,\n        lastAuthCheck: 0\n      });\n    }\n    // Handle TOKEN_REFRESHED - only update token, not full state\n    else if (event === 'TOKEN_REFRESHED' && session?.user) {\n      // Only update if we're already authenticated as this user\n      if (currentState.isAuthenticated && currentState.user?.id === session.user.id) {\n        useAuthStore.setState({\n          token: session.access_token,\n          lastAuthCheck: now\n        });\n      }\n    }\n    // INITIAL_SESSION is handled by initializeAuth and AuthSessionProvider, skip it\n  });\n}\n","/**\n * Placeholder exports for removed social/club features\n * Use during refactoring to satisfy imports\n */\n\nexport const noop = () => {};\nexport const noopAsync = async () => {};\nexport const emptyArray = [] as const;\nexport const emptyObject = {} as const;\n\n// TODO(clarify): Remove this file once all references are cleaned\n","import { noop, emptyArray } from '../lib/void';\n\ntype LikeStore = {\n  initializeLikes: () => void;\n  toggleLike: (predictionId: string) => void;\n  checkIfLiked: (predictionId: string) => boolean;\n  getLikeCount: (predictionId: string) => number;\n  likes: readonly string[];\n};\n\nexport const useLikeStore = (): LikeStore => ({\n  initializeLikes: noop,\n  toggleLike: noop,\n  checkIfLiked: () => false,\n  getLikeCount: () => 0,\n  likes: emptyArray,\n});\n\n","// Updated auth intents to match specification\nexport type AuthIntent =\n  | 'view_wallet'\n  | 'view_my_bets'\n  | 'edit_profile'\n  | 'place_prediction'\n  | 'create_prediction'\n  | 'comment_prediction'\n  | 'like_prediction'\n  | 'add_funds'\n  | 'withdraw_funds'\n  | 'follow_creator'\n  | 'share_private'\n  | 'view_settlements';\n\nexport type IntentMeta = {\n  title: string;\n  description: string;\n  primaryCta: string;   // \"Continue with Google\"\n  secondaryCta: string; // \"Continue with Email\"\n  analyticsKey: string; // for logging\n};\n\nexport const INTENT_MAP: Record<AuthIntent, IntentMeta> = {\n  view_wallet: {\n    title: 'Sign in to FanClubZ',\n    description: 'See your balance, deposits, and transactions.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.view_wallet',\n  },\n  view_my_bets: {\n    title: 'Sign in to FanClubZ',\n    description: 'Track your predictions and manage your portfolio.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.view_my_bets',\n  },\n  edit_profile: {\n    title: 'Sign in to FanClubZ',\n    description: 'Customize your handle and avatar.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.edit_profile',\n  },\n  place_prediction: {\n    title: 'Sign in to FanClubZ',\n    description: 'Stake, share, and compete on the leaderboard.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.place_prediction',\n  },\n  create_prediction: {\n    title: 'Sign in to FanClubZ',\n    description: 'Create your own prediction and invite others to participate.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.create_prediction',\n  },\n  comment_prediction: {\n    title: 'Sign in to comment',\n    description: 'Join the discussion and share your take.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.comment_prediction',\n  },\n  like_prediction: {\n    title: 'Sign in to like predictions',\n    description: 'Save your favorites and get better recommendations.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.like_prediction',\n  },\n  add_funds: {\n    title: 'Sign in to add funds',\n    description: 'Securely top up your balance to start predicting.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.add_funds',\n  },\n  withdraw_funds: {\n    title: 'Sign in to withdraw funds',\n    description: 'For your security, we need to verify your account.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.withdraw_funds',\n  },\n  follow_creator: {\n    title: 'Follow creators you like',\n    description: 'Get alerts when your favorites make a move.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.follow_creator',\n  },\n  share_private: {\n    title: 'Share privately',\n    description: 'Keep your insights within your circle.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.share_private',\n  },\n  view_settlements: {\n    title: 'Sign in to view settlements',\n    description: 'See outcomes and claim rewards on resolved markets.',\n    primaryCta: 'Continue with Google',\n    secondaryCta: 'Continue with Email',\n    analyticsKey: 'auth.view_settlements',\n  },\n};\n\nexport const FALLBACK_INTENT: IntentMeta = {\n  title: 'Sign in',\n  description: 'Continue to unlock this action.',\n  primaryCta: 'Continue with Google',\n  secondaryCta: 'Continue with Email',\n  analyticsKey: 'auth.fallback',\n};\n\n// Legacy type mapping for backward compatibility\nexport type AuthIntentKey = AuthIntent;\n\n// Legacy export for backward compatibility  \nexport interface AuthIntentMeta {\n  key: AuthIntentKey;\n  title: string;\n  description: string;\n  primaryCta: 'google' | 'email_link';\n  secondaryCta?: 'google' | 'email_link';\n  analyticsEvent: string;\n}\n\n// Convert new format to legacy format for backward compatibility\nexport const AUTH_INTENTS: Record<AuthIntentKey, AuthIntentMeta> = Object.entries(INTENT_MAP).reduce(\n  (acc, [key, meta]) => ({\n    ...acc,\n    [key]: {\n      key: key as AuthIntentKey,\n      title: meta.title,\n      description: meta.description,\n      primaryCta: 'google' as const,\n      secondaryCta: 'email_link' as const,\n      analyticsEvent: meta.analyticsKey,\n    },\n  }),\n  {} as Record<AuthIntentKey, AuthIntentMeta>\n);\n\nexport default AUTH_INTENTS;\n","import { useState, useCallback, useEffect } from 'react';\nimport { AuthIntent, IntentMeta, INTENT_MAP } from './authIntents';\n\n// Types for the new API\nexport interface OpenOptions {\n  intent: AuthIntent;\n  metaOverride?: Partial<IntentMeta>;\n  payload?: Record<string, unknown>; // e.g., predictionId\n}\n\nexport interface AuthGateResult {\n  status: 'success' | 'cancel' | 'error';\n  reason?: string;\n}\n\n// Internal state interface\ninterface AuthGateState {\n  isOpen: boolean;\n  pendingIntent: AuthIntent | null;\n  intentMeta: IntentMeta | null;\n  payload?: Record<string, unknown>;\n  resolver: ((result: AuthGateResult) => void) | null;\n}\n\n// Session storage keys\nconst STORAGE_KEY = 'fcz.pendingAuth';\nconst RETURN_URL_KEY = 'fcz.returnUrl';\n\n// Global auth gate state\nlet authGateState: AuthGateState = {\n  isOpen: false,\n  pendingIntent: null,\n  intentMeta: null,\n  payload: undefined,\n  resolver: null,\n};\n\n// Subscribers to auth gate state changes\nconst subscribers = new Set<() => void>();\n\n// Notify all subscribers of state changes\nconst notifySubscribers = () => {\n  subscribers.forEach(callback => callback());\n};\n\n// Update global auth gate state\nconst updateAuthGateState = (updates: Partial<AuthGateState>) => {\n  authGateState = { ...authGateState, ...updates };\n  notifySubscribers();\n};\n\n// Session storage helpers\nconst persistPendingAuth = (intent: AuthIntent, payload?: Record<string, unknown>) => {\n  try {\n    sessionStorage.setItem(STORAGE_KEY, JSON.stringify({ intent, payload }));\n    // Store the current URL for redirect after auth\n    const currentUrl = window.location.pathname + window.location.search;\n    console.log(' Storing return URL:', currentUrl);\n    sessionStorage.setItem(RETURN_URL_KEY, currentUrl);\n    console.log(' Return URL stored successfully');\n  } catch (error) {\n    console.warn('Failed to persist pending auth:', error);\n  }\n};\n\nconst clearPersistedAuth = () => {\n  try {\n    sessionStorage.removeItem(STORAGE_KEY);\n    sessionStorage.removeItem(RETURN_URL_KEY);\n  } catch (error) {\n    console.warn('Failed to clear persisted auth:', error);\n  }\n};\n\nconst getPersistedAuth = (): { intent: AuthIntent; payload?: Record<string, unknown> } | null => {\n  try {\n    const stored = sessionStorage.getItem(STORAGE_KEY);\n    if (stored) {\n      return JSON.parse(stored);\n    }\n  } catch (error) {\n    console.warn('Failed to get persisted auth:', error);\n  }\n  return null;\n};\n\n/**\n * Get the stored return URL (where user should be redirected after auth)\n */\nexport const getReturnUrl = (): string => {\n  try {\n    const returnUrl = sessionStorage.getItem(RETURN_URL_KEY);\n    console.log(' getReturnUrl called - stored value:', returnUrl);\n    const finalUrl = returnUrl || '/';\n    console.log(' Returning URL:', finalUrl);\n    return finalUrl;\n  } catch (error) {\n    console.warn('Failed to get return URL:', error);\n    return '/';\n  }\n};\n\n/**\n * Hook to access auth gate state\n */\nexport const useAuthGate = () => {\n  const [, forceUpdate] = useState({});\n\n  useEffect(() => {\n    const callback = () => forceUpdate({});\n    subscribers.add(callback);\n    return () => {\n      subscribers.delete(callback);\n    };\n  }, []);\n\n  return {\n    isOpen: authGateState.isOpen,\n    pendingIntent: authGateState.pendingIntent,\n    intentMeta: authGateState.intentMeta,\n    payload: authGateState.payload,\n  };\n};\n\n/**\n * Open the auth gate modal for a specific intent\n * Returns a promise that resolves when the user completes or cancels auth\n */\nexport const openAuthGate = (opts: OpenOptions): Promise<AuthGateResult> => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.log('[FCZ-QA] openAuthGate called with:', opts);\n  }\n\n  return new Promise<AuthGateResult>((resolve) => {\n    const baseIntentMeta = INTENT_MAP[opts.intent];\n    const intentMeta: IntentMeta = opts.metaOverride \n      ? { ...baseIntentMeta, ...opts.metaOverride }\n      : baseIntentMeta;\n    \n    // Persist to sessionStorage for refresh recovery\n    persistPendingAuth(opts.intent, opts.payload);\n    \n    updateAuthGateState({\n      isOpen: true,\n      pendingIntent: opts.intent,\n      intentMeta,\n      payload: opts.payload,\n      resolver: resolve,\n    });\n  });\n};\n\n/**\n * Resolve the current auth gate with a result\n */\nexport const resolveAuthGate = (result: AuthGateResult): void => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.log('[FCZ-QA] resolveAuthGate called with:', result);\n  }\n\n  const { resolver, pendingIntent, payload } = authGateState;\n  \n  // Don't clear return URL yet - it will be cleared by AuthCallback after redirect\n  try {\n    sessionStorage.removeItem(STORAGE_KEY);\n  } catch (error) {\n    console.warn('Failed to clear auth intent:', error);\n  }\n  \n  updateAuthGateState({\n    isOpen: false,\n    pendingIntent: null,\n    intentMeta: null,\n    payload: undefined,\n    resolver: null,\n  });\n\n  // If successful auth, handle the resume action\n  if (result.status === 'success' && pendingIntent && pendingIntent !== 'edit_profile') {\n    handleResumeAfterAuth(pendingIntent, payload);\n  }\n\n  if (resolver) {\n    resolver(result);\n  }\n};\n\n/**\n * Handle resume-after-auth actions based on the intent\n */\nconst handleResumeAfterAuth = (intent: AuthIntent, payload?: Record<string, unknown>) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.log('[FCZ-QA] Handling resume after auth for intent:', intent, 'with payload:', payload);\n  }\n\n  switch (intent) {\n    case 'view_wallet':\n      // Wallet will automatically reload its data when user becomes authenticated\n      break;\n      \n    case 'view_my_bets':\n      // BetsTab will automatically load user bets when user becomes authenticated\n      break;\n      \n    case 'comment_prediction':\n      // Focus the comment composer after auth\n      setTimeout(() => {\n        const textarea = document.querySelector('.comment-textarea') as HTMLTextAreaElement;\n        if (textarea) {\n          textarea.focus();\n        }\n      }, 100);\n      break;\n      \n    case 'place_prediction':\n      // Navigate to create prediction or focus the bet amount input\n      if (payload?.predictionId) {\n        // If there's a specific prediction, focus the bet input\n        setTimeout(() => {\n          const betInput = document.querySelector('[data-qa=\"bet-amount\"]') as HTMLInputElement;\n          if (betInput) {\n            betInput.focus();\n          }\n        }, 100);\n      }\n      break;\n      \n    default:\n      // No specific resume action needed\n      break;\n  }\n};\n\n/**\n * Close the auth gate (same as resolving with cancel)\n */\nexport const closeAuthGate = () => {\n  resolveAuthGate({ status: 'cancel' });\n};\n\n/**\n * Get current pending intent and payload for resume-after-auth\n */\nexport const getPendingIntent = (): { intent?: AuthIntent; payload?: any } => {\n  return {\n    intent: authGateState.pendingIntent || undefined,\n    payload: authGateState.payload,\n  };\n};\n\n/**\n * Check if auth gate is currently open\n */\nexport const isAuthGateOpen = () => {\n  return authGateState.isOpen;\n};\n\n/**\n * Get current auth gate state (read-only)\n */\nexport const getAuthGateState = (): Readonly<AuthGateState> => {\n  return { ...authGateState };\n};\n\n/**\n * Restore pending auth state from sessionStorage (called on app init)\n */\nexport const restorePendingAuth = (): { intent: AuthIntent; payload?: Record<string, unknown> } | null => {\n  const persisted = getPersistedAuth();\n  if (persisted) {\n    if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n      console.log('[FCZ-QA] Restored pending auth from sessionStorage:', persisted);\n    }\n    \n    // Don't auto-open the modal, just restore the state for potential resumption\n    updateAuthGateState({\n      pendingIntent: persisted.intent,\n      payload: persisted.payload,\n      // Don't set isOpen or resolver - let the app decide when to re-open\n    });\n    \n    return persisted;\n  }\n  return null;\n};\n\n// Legacy compatibility - keep the old useAuthGate export name for backward compatibility\nexport { useAuthGate as useAuthGateAdapter };\n","import React, { createContext, useContext, ReactNode } from 'react';\nimport { supabase } from '@/lib/supabase';\n\ninterface SupabaseContextType {\n  supabase: typeof supabase;\n}\n\nconst SupabaseContext = createContext<SupabaseContextType | undefined>(undefined);\n\nexport const useSupabase = () => {\n  const context = useContext(SupabaseContext);\n  if (context === undefined) {\n    throw new Error('useSupabase must be used within a SupabaseProvider');\n  }\n  return context;\n};\n\ninterface SupabaseProviderProps {\n  children: ReactNode;\n}\n\nexport const SupabaseProvider: React.FC<SupabaseProviderProps> = ({ children }) => {\n  const value: SupabaseContextType = {\n    supabase,\n  };\n\n  return (\n    <SupabaseContext.Provider value={value}>\n      {children}\n    </SupabaseContext.Provider>\n  );\n};\n","import React, { createContext, useContext, useState, useEffect, ReactNode, useRef } from 'react';\nimport { useSupabase } from './SupabaseProvider';\nimport { User, Session, AuthChangeEvent } from '@supabase/supabase-js';\nimport { captureReturnTo } from '../lib/returnTo';\nimport { auth as authHelpers, buildAuthRedirectUrl } from '@/lib/supabase';\n\ninterface AuthSessionContextType {\n  user: User | null;\n  session: Session | null;\n  loading: boolean;\n  initialized: boolean;\n  isAuthenticated: boolean;\n  signIn: (email: string, password: string) => Promise<{ error: any }>;\n  signUp: (email: string, password: string, userData?: any) => Promise<{ error: any }>;\n  signOut: () => Promise<{ error: any }>;\n  signInWithGoogle: () => Promise<{ error: any }>;\n  signInWithEmailLink: (email: string) => Promise<{ error: any }>;\n}\n\nconst AuthSessionContext = createContext<AuthSessionContextType | undefined>(undefined);\n\nexport const useAuthSession = () => {\n  const context = useContext(AuthSessionContext);\n  if (context === undefined) {\n    throw new Error('useAuthSession must be used within an AuthSessionProvider');\n  }\n  return context;\n};\n\ninterface AuthSessionProviderProps {\n  children: ReactNode;\n}\n\n// PERFORMANCE FIX: Debounce time for auth state changes\nconst AUTH_DEBOUNCE_MS = 3000;\n\nexport const AuthSessionProvider: React.FC<AuthSessionProviderProps> = ({ children }) => {\n  const { supabase } = useSupabase();\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [initialized, setInitialized] = useState(false);\n  \n  // PERFORMANCE FIX: Track last processed event to avoid duplicates\n  const lastEventRef = useRef<{ event: AuthChangeEvent; userId: string; time: number } | null>(null);\n\n  useEffect(() => {\n    let mounted = true;\n    \n    const restorePendingSession = async () => {\n      try {\n        const cached = sessionStorage.getItem('fcz:update:session');\n        if (!cached) return;\n\n        sessionStorage.removeItem('fcz:update:session');\n        const parsed = JSON.parse(cached);\n        if (parsed?.access_token && parsed?.refresh_token) {\n          await supabase.auth.setSession({\n            access_token: parsed.access_token,\n            refresh_token: parsed.refresh_token,\n          });\n        }\n      } catch (error) {\n        console.warn('[Auth] Failed to restore session after update:', error);\n      }\n    };\n\n    // Get initial session\n    const getInitialSession = async () => {\n      try {\n        await restorePendingSession();\n        const { data: { session }, error } = await supabase.auth.getSession();\n        if (!mounted) return;\n        \n        if (error) {\n          console.error('Error getting initial session:', error);\n        } else {\n          setSession(session);\n          setUser(session?.user ?? null);\n        }\n      } catch (error) {\n        console.error('Exception getting initial session:', error);\n      } finally {\n        if (mounted) {\n          setLoading(false);\n          setInitialized(true);\n        }\n      }\n    };\n\n    getInitialSession();\n\n    // Listen for auth changes with better deduplication\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event, session) => {\n        if (!mounted) return;\n        \n        const now = Date.now();\n        const userId = session?.user?.id || '';\n        const lastEvent = lastEventRef.current;\n        \n        // PERFORMANCE FIX: Skip duplicate events within debounce window\n        if (lastEvent && \n            lastEvent.event === event && \n            lastEvent.userId === userId && \n            (now - lastEvent.time) < AUTH_DEBOUNCE_MS) {\n          return;\n        }\n        \n        // Update tracking\n        lastEventRef.current = { event, userId, time: now };\n        \n        // Only log significant events in development\n        if (import.meta.env.DEV && (event === 'SIGNED_IN' || event === 'SIGNED_OUT')) {\n          console.log(' Auth:', event, session?.user?.email || '');\n        }\n        \n        setSession(session);\n        setUser(session?.user ?? null);\n        setLoading(false);\n      }\n    );\n\n    return () => {\n      mounted = false;\n      subscription.unsubscribe();\n    };\n  }, [supabase]);\n\n  const signIn = async (email: string, password: string) => {\n    try {\n      const { error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n      return { error };\n    } catch (error: any) {\n      return { error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  };\n\n  const signUp = async (email: string, password: string, userData: any = {}) => {\n    try {\n      const { error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: userData,\n          emailRedirectTo: import.meta.env.PROD \n            ? 'https://app.fanclubz.app/'\n            : `${window.location.origin}/`,\n        },\n      });\n      return { error };\n    } catch (error: any) {\n      return { error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  };\n\n  const signOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      return { error };\n    } catch (error: any) {\n      return { error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  };\n\n  const signInWithGoogle = async () => {\n    try {\n      // Capture current location\n      captureReturnTo();\n      \n      // Build redirect URL with next parameter\n      const currentPath = `${window.location.pathname}${window.location.search}${window.location.hash}`;\n      const next = currentPath;\n      const redirectUrl = buildAuthRedirectUrl(next);\n      \n      if (import.meta.env.DEV) {\n        console.log(' Google OAuth redirect URL:', redirectUrl);\n      }\n      \n      const { error } = await authHelpers.signInWithOAuth('google', { next });\n      \n      if (error) {\n        console.error(' Google OAuth error:', error);\n      }\n      \n      return { error };\n    } catch (error: any) {\n      console.error(' Google OAuth exception:', error);\n      return { error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  };\n\n  const signInWithEmailLink = async (email: string) => {\n    try {\n      // Capture current location\n      captureReturnTo();\n      \n      // Build redirect URL with next parameter\n      const currentPath = `${window.location.pathname}${window.location.search}${window.location.hash}`;\n      const next = currentPath;\n      const emailRedirectTo = buildAuthRedirectUrl(next);\n        \n      const { error } = await supabase.auth.signInWithOtp({\n        email,\n        options: {\n          emailRedirectTo,\n        },\n      });\n      return { error };\n    } catch (error: any) {\n      return { error: { message: error.message || 'An unexpected error occurred' } };\n    }\n  };\n\n  const value: AuthSessionContextType = {\n    user,\n    session,\n    loading,\n    initialized,\n    isAuthenticated: Boolean(user),\n    signIn,\n    signUp,\n    signOut,\n    signInWithGoogle,\n    signInWithEmailLink,\n  };\n\n  return (\n    <AuthSessionContext.Provider value={value}>\n      {children}\n    </AuthSessionContext.Provider>\n  );\n};\n","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\nexport { Fetch, NodeXHR, XHR, NodeWebSocket, WebSocket, WebTransport, } from \"engine.io-client\";\n","/**\n * Shared React Query keys for consistent cache invalidation\n * All wallet-related queries use these keys for predictable refresh\n */\n\nexport const QK = {\n  walletSummary: (userId: string, walletAddress?: string | null) =>\n    ['wallet', 'summary', userId, (walletAddress ?? '').toLowerCase()] as const,\n  \n  walletActivity: (userId: string, limit = 25) => ['wallet', 'activity', userId, limit] as const,\n  \n  escrowBalance: (userId: string) => ['escrow-balance', userId] as const,\n  \n  onchainUSDC: (address: `0x${string}` | undefined, chainId: number) =>\n    ['onchain-usdc', address ?? '0x0', chainId] as const,\n  \n  predictionEntries: (predictionId: string) => ['prediction-entries', predictionId] as const,\n  \n  prediction: (predictionId: string) => ['prediction', predictionId] as const,\n  \n  readContract: (address: string, functionName: string, args?: any[]) => \n    ['readContract', address, functionName, args ?? []] as const,\n  \n  onchainActivity: (userId: string, limit = 20) => ['onchain-activity', userId, limit] as const,\n  \n  // Image queries (for React Query if needed in future)\n  predictionImage: (predictionId: string, query: string, seed: string, provider: 'pexels' | 'unsplash') =>\n    ['prediction-image', predictionId, query, seed, provider] as const,\n} as const;\n\n","// Centralized configuration for Fan Club Z\n// Single source of truth for all configuration values\n// Production-compatible version import\nimport pkg from '../../package.json';\nconst VERSION: string = (pkg as any).version || '0.0.0';\nimport { getEnvironmentConfig } from '@/utils/environment';\nimport { FRONTEND_URL, isDev, isProd } from '@/utils/environment';\n\nexport const APP_CONFIG = {\n  version: VERSION,\n  name: 'Fan Club Z',\n  description: 'Social Prediction Platform',\n  \n  api: {\n    // Use dynamic environment detection so LAN access (e.g., 172.x) targets the same host:3001\n    url: getEnvironmentConfig().apiUrl,\n    timeout: 15000,\n    retries: 3\n  },\n  \n  frontend: {\n    url: FRONTEND_URL || 'https://app.fanclubz.app'\n  },\n  \n  features: {\n    realTimeUpdates: true,\n    socialEngagement: true,\n    walletIntegration: true,\n    settlementSystem: true,\n  },\n  \n  limits: {\n    maxStakeAmount: 10000,\n    minStakeAmount: 1,\n    maxDescriptionLength: 500,\n    maxCommentLength: 280\n  },\n  \n  ui: {\n    theme: {\n      primaryColor: '#22c55e',\n      brandColors: {\n        green: {\n          50: '#f0fdf4',\n          500: '#22c55e',\n          600: '#16a34a',\n          700: '#15803d'\n        }\n      }\n    },\n    animations: {\n      duration: {\n        fast: 200,\n        normal: 300,\n        slow: 500\n      }\n    }\n  }\n} as const;\n\n// Environment helpers\nexport const isDevelopment = () => isDev;\nexport const isProduction = () => isProd;\n\n// API helpers\nexport const getApiUrl = () => APP_CONFIG.api.url;\nexport const getFrontendUrl = () => APP_CONFIG.frontend.url;\n\n// Version helpers\nexport const getVersion = () => APP_CONFIG.version;\nexport const getFullVersion = () => `${APP_CONFIG.name} v${APP_CONFIG.version}`;\n\n// Feature flags\nexport const isFeatureEnabled = (feature: keyof typeof APP_CONFIG.features): boolean => {\n  return APP_CONFIG.features[feature];\n};\n\nexport default APP_CONFIG;","/**\n * API Utilities with Retry Logic\n * Handles common production issues like 502 errors, timeouts, and CORS issues\n */\n\nimport { getApiUrl } from '../config';\n\ninterface RetryOptions {\n  maxRetries?: number;\n  initialDelay?: number;\n  maxDelay?: number;\n  backoffFactor?: number;\n}\n\ninterface FetchOptions extends RequestInit {\n  timeout?: number;\n  retryOptions?: RetryOptions;\n  abortController?: AbortController;\n}\n\nconst DEFAULT_RETRY_OPTIONS: RetryOptions = {\n  maxRetries: 3,\n  initialDelay: 1000, // 1 second\n  maxDelay: 10000,    // 10 seconds\n  backoffFactor: 2\n};\n\n/**\n * Sleep utility for retry delays\n */\nconst sleep = (ms: number): Promise<void> => \n  new Promise(resolve => setTimeout(resolve, ms));\n\n/**\n * Check if an error should trigger a retry\n */\nconst shouldRetry = (error: any, attemptNumber: number, maxRetries: number): boolean => {\n  if (attemptNumber >= maxRetries) return false;\n  \n  // Retry on network errors\n  if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {\n    return true;\n  }\n  \n  // Retry on server errors (5xx)\n  if (error.name === 'HTTPError' && error.status >= 500) {\n    return true;\n  }\n  \n  // Retry on timeout\n  if (error.name === 'AbortError' || error.name === 'TimeoutError') {\n    return true;\n  }\n  \n  return false;\n};\n\n/**\n * Calculate delay for exponential backoff\n */\nconst calculateDelay = (attemptNumber: number, options: RetryOptions): number => {\n  const delay = options.initialDelay! * Math.pow(options.backoffFactor!, attemptNumber - 1);\n  return Math.min(delay, options.maxDelay!);\n};\n\n/**\n * Enhanced fetch with retry logic, timeout, and better error handling\n */\nexport const fetchWithRetry = async (\n  url: string, \n  options: FetchOptions = {}\n): Promise<Response> => {\n  const { \n    timeout = 15000,\n    retryOptions = DEFAULT_RETRY_OPTIONS,\n    ...fetchOptions \n  } = options;\n  \n  const retryConfig = { ...DEFAULT_RETRY_OPTIONS, ...retryOptions };\n  let lastError: any;\n  \n  for (let attempt = 1; attempt <= retryConfig.maxRetries! + 1; attempt++) {\n    try {\n      console.log(` API Request (attempt ${attempt}/${retryConfig.maxRetries! + 1}): ${url}`);\n      \n      // Create abort controller for timeout\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n      const method = String(fetchOptions.method || 'GET').toUpperCase();\n      const isGetLike = method === 'GET' || method === 'HEAD';\n\n      // IMPORTANT: Avoid forcing preflight on GET/HEAD by NOT setting Content-Type.\n      // Only set Content-Type when we actually send a JSON body.\n      const headers: Record<string, string> = {\n        Accept: 'application/json',\n        ...(fetchOptions.headers as any),\n      };\n\n      const hasBody = typeof fetchOptions.body !== 'undefined' && fetchOptions.body !== null;\n      if (!isGetLike && hasBody && !('Content-Type' in headers) && !('content-type' in headers)) {\n        headers['Content-Type'] = 'application/json';\n      }\n\n      const response = await fetch(url, {\n        ...fetchOptions,\n        signal: controller.signal,\n        headers,\n      });\n      \n      clearTimeout(timeoutId);\n      \n      // Check for HTTP errors\n      if (!response.ok) {\n        const error = new Error(`HTTP error! status: ${response.status} ${response.statusText}`);\n        (error as any).name = 'HTTPError';\n        (error as any).status = response.status;\n        (error as any).response = response;\n        throw error;\n      }\n      \n      console.log(` API Success (attempt ${attempt}): ${response.status} ${response.statusText}`);\n      return response;\n      \n    } catch (error: any) {\n      lastError = error;\n      console.warn(` API Error (attempt ${attempt}):`, error.message);\n      \n      // Check if we should retry\n      if (shouldRetry(error, attempt, retryConfig.maxRetries!)) {\n        const delay = calculateDelay(attempt, retryConfig);\n        console.log(` Retrying in ${delay}ms...`);\n        await sleep(delay);\n        continue;\n      }\n      \n      // No more retries, throw the last error\n      break;\n    }\n  }\n  \n  console.error(` API Failed after ${retryConfig.maxRetries! + 1} attempts:`, lastError);\n  throw lastError;\n};\n\n/**\n * API client with retry logic and consistent error handling\n */\nexport const apiClient = {\n  get: async (endpoint: string, options: FetchOptions = {}) => {\n    const url = `${getApiUrl()}${endpoint}`;\n    const response = await fetchWithRetry(url, {\n      method: 'GET',\n      ...options,\n    });\n    return response.json();\n  },\n  \n  post: async (endpoint: string, data?: any, options: FetchOptions = {}) => {\n    const url = `${getApiUrl()}${endpoint}`;\n    const response = await fetchWithRetry(url, {\n      method: 'POST',\n      body: data ? JSON.stringify(data) : undefined,\n      ...options,\n    });\n    return response.json();\n  },\n  \n  put: async (endpoint: string, data?: any, options: FetchOptions = {}) => {\n    const url = `${getApiUrl()}${endpoint}`;\n    const response = await fetchWithRetry(url, {\n      method: 'PUT',\n      body: data ? JSON.stringify(data) : undefined,\n      ...options,\n    });\n    return response.json();\n  },\n  \n  delete: async (endpoint: string, options: FetchOptions = {}) => {\n    const url = `${getApiUrl()}${endpoint}`;\n    const response = await fetchWithRetry(url, {\n      method: 'DELETE',\n      ...options,\n    });\n    return response.json();\n  }\n};\n\n/**\n * Test API connectivity with retry\n */\nexport const testApiConnectivity = async (): Promise<boolean> => {\n  try {\n    const response = await fetchWithRetry(`${getApiUrl()}/api/health`, {\n      timeout: 5000,\n      retryOptions: { maxRetries: 2 }\n    });\n    return response.ok;\n  } catch (error) {\n    console.error('API connectivity test failed:', error);\n    return false;\n  }\n};\n\n/**\n * Get cache-busted URL for static assets\n */\nexport const getCacheBustedUrl = (url: string): string => {\n  const separator = url.includes('?') ? '&' : '?';\n  return `${url}${separator}_t=${Date.now()}`;\n};\n","import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nexport type FundingMode = 'crypto' | 'demo' | 'fiat';\n\nconst DEMO_ENABLED = import.meta.env.VITE_FCZ_ENABLE_DEMO === '1';\n\ntype FundingModeState = {\n  mode: FundingMode;\n  isDemoEnabled: boolean;\n  // Fiat enabled is determined at runtime via API, not build-time env\n  isFiatEnabled: boolean;\n  setMode: (mode: FundingMode) => void;\n  setFiatEnabled: (enabled: boolean) => void;\n};\n\nexport const useFundingModeStore = create<FundingModeState>()(\n  persist(\n    (set, get) => ({\n      // Default to 'demo' if enabled, otherwise 'crypto'\n      mode: DEMO_ENABLED ? 'demo' : 'crypto',\n      isDemoEnabled: DEMO_ENABLED,\n      isFiatEnabled: false,\n      setMode: (mode) => {\n        const state = get();\n        // Validate mode is allowed\n        if (mode === 'demo' && !DEMO_ENABLED) {\n          set({ mode: 'crypto' });\n          return;\n        }\n        if (mode === 'fiat' && !state.isFiatEnabled) {\n          // Fallback to demo if available, else crypto\n          set({ mode: DEMO_ENABLED ? 'demo' : 'crypto' });\n          return;\n        }\n        set({ mode });\n      },\n      setFiatEnabled: (enabled) => {\n        set({ isFiatEnabled: enabled });\n        // If fiat was selected but is now disabled, switch to fallback\n        const state = get();\n        if (!enabled && state.mode === 'fiat') {\n          set({ mode: DEMO_ENABLED ? 'demo' : 'crypto' });\n        }\n      },\n    }),\n    {\n      name: 'fcz:fundingMode',\n      version: 2,\n      partialize: (s) => ({ mode: s.mode }),\n      // If demo is disabled at runtime, always force crypto\n      onRehydrateStorage: () => (state) => {\n        if (!state) return;\n        if (!DEMO_ENABLED && state.mode === 'demo') {\n          state.setMode('crypto');\n        }\n        // Fiat enablement is checked at runtime, don't persist it\n      },\n    }\n  )\n);\n\n\n","import { create } from 'zustand';\nimport { supabase } from '../lib/supabase';\nimport { getApiUrl } from '../config';\nimport { useAuthStore } from './authStore';\nimport { apiClient } from '../lib/apiUtils';\nimport { useFundingModeStore } from './fundingModeStore';\n\n// ---- Idempotency helpers for bet placement ----\nfunction computeBetKey(userId: string | undefined, predictionId: string, optionId: string, amount: number) {\n  return `bet:${userId || 'anon'}:${predictionId}:${optionId}:${amount}`;\n}\n\nfunction getOrCreateRequestId(compositeKey: string, ttlMs = 2 * 60 * 1000): string {\n  try {\n    const raw = sessionStorage.getItem(compositeKey);\n    const now = Date.now();\n    if (raw) {\n      const parsed = JSON.parse(raw) as { id: string; ts: number };\n      if (parsed && parsed.id && now - parsed.ts < ttlMs) {\n        return parsed.id;\n      }\n    }\n    const id = (typeof crypto !== 'undefined' && 'randomUUID' in crypto)\n      ? (crypto as any).randomUUID()\n      : `${now}-${Math.random().toString(16).slice(2)}`;\n    sessionStorage.setItem(compositeKey, JSON.stringify({ id, ts: now }));\n    return id;\n  } catch {\n    // Fallback if storage fails\n    return `${Date.now()}-${Math.random().toString(16).slice(2)}`;\n  }\n}\n\nexport interface Prediction {\n  id: string;\n  creator_id: string;\n  title: string;\n  question?: string;\n  description?: string;\n  category: 'sports' | 'pop_culture' | 'custom' | 'esports' | 'celebrity_gossip' | 'politics';\n  type: 'binary' | 'multi_outcome' | 'pool';\n  status: 'pending' | 'open' | 'closed' | 'settled' | 'disputed' | 'cancelled' | 'awaiting_settlement' | 'ended' | 'refunded';\n  stake_min: number;\n  stake_max?: number;\n  pool_total: number;\n  entry_deadline: string;\n  settlement_method: 'auto' | 'manual';\n  is_private: boolean;\n  creator_fee_percentage: number;\n  platform_fee_percentage: number;\n  club_id?: string;\n  image_url?: string;\n  tags: string[];\n  created_at: string;\n  updated_at: string;\n  options: PredictionOption[];\n  creator: {\n    id: string;\n    username: string;\n    avatar_url?: string;\n    is_verified: boolean;\n    full_name?: string;\n  };\n  participant_count: number;\n  likes_count: number;\n  comments_count: number;\n  stakeMin: number;\n  settlementMethod: 'auto' | 'manual';\n  participantCount: number;\n  likeCount: number;\n  commentCount: number;\n  user_entry?: {\n    option_id: string;\n    amount: number;\n    potential_payout: number;\n  };\n  // Additional properties for compatibility\n  poolTotal?: number;\n  entryDeadline?: string;\n  entries?: any[];\n  likes?: number;\n  comments?: number;\n  settledAt?: string;\n  settled_at?: string;\n  participants?: number;\n  settlement_criteria?: string;\n  total_volume?: number;\n}\n\nexport interface PredictionOption {\n  id: string;\n  prediction_id: string;\n  label: string;\n  total_staked: number;\n  current_odds: number;\n  percentage: number;\n  totalStaked?: number; // Compatibility alias\n  currentOdds?: number; // Compatibility alias\n  title?: string;\n  text?: string;\n}\n\nexport interface PredictionEntry {\n  id: string;\n  prediction_id: string;\n  user_id: string;\n  option_id: string;\n  amount: number;\n  potential_payout: number;\n  actual_payout?: number;\n  status: 'active' | 'won' | 'lost' | 'refunded';\n  created_at: string;\n  updated_at: string;\n  selected_option?: string;\n  odds?: number;\n  prediction?: Partial<Prediction> & { question?: string; title?: string };\n  option?: { id?: string; label?: string };\n  metadata?: Record<string, unknown>;\n}\n\nexport interface ActivityItem {\n  id: string;\n  type: 'participant_joined' | 'prediction_placed' | 'multiple_participants';\n  description: string;\n  amount?: number;\n  participantCount?: number;\n  timestamp: string;\n  timeAgo: string;\n  kind?: 'deposit' | 'withdraw' | 'lock' | 'unlock' | 'bet_refund' | 'payout' | 'creator_fee' | 'platform_fee' | 'entry' | 'release' | 'claim';\n  createdAt?: string;\n  txHash?: string;\n}\n\nexport interface Participant {\n  id: string;\n  username: string;\n  avatar_url?: string;\n  amount: number;\n  option: string;\n  joinedAt: string;\n  timeAgo: string;\n}\n\nexport interface PlatformStats {\n  totalVolume: string;\n  activePredictions: number;\n  totalUsers: string;\n  rawVolume: number;\n  rawUsers: number;\n}\n\ntype OptionLike = Partial<PredictionOption> & Record<string, any>;\ntype PredictionLike = Partial<Prediction> & Record<string, any>;\n\nconst normalizePredictionOption = (option: OptionLike = {}): PredictionOption => {\n  const totalStaked = option.totalStaked ?? option.total_staked ?? 0;\n  const currentOdds = option.currentOdds ?? option.current_odds ?? option.odds ?? 1;\n\n  return {\n    id: option.id ?? '',\n    prediction_id: option.prediction_id ?? option.predictionId ?? '',\n    label: option.label ?? option.text ?? 'Option',\n    total_staked: option.total_staked ?? totalStaked,\n    current_odds: option.current_odds ?? currentOdds,\n    percentage: option.percentage ?? option.share ?? 0,\n    totalStaked,\n    currentOdds,\n  };\n};\n\nconst normalizePrediction = (prediction: PredictionLike = {}): Prediction => {\n  const options = Array.isArray(prediction.options)\n    ? prediction.options.map(normalizePredictionOption)\n    : [];\n\n  const poolTotal = prediction.pool_total ?? prediction.poolTotal ?? prediction.totalPool ?? 0;\n  const stakeMin = prediction.stake_min ?? prediction.stakeMin ?? prediction.minimum_stake ?? 0;\n  const entryDeadline = prediction.entry_deadline ?? prediction.entryDeadline ?? prediction.deadline;\n  const settlementMethod = prediction.settlement_method ?? prediction.settlementMethod ?? 'manual';\n  const participantCount =\n    prediction.participant_count ??\n    prediction.participantCount ??\n    prediction.participants ??\n    0;\n  const likeCount =\n    prediction.likes_count ??\n    prediction.likeCount ??\n    (Array.isArray((prediction as any).likes) ? (prediction as any).likes.length : Number((prediction as any).likes ?? 0));\n  const commentCount =\n    prediction.comments_count ??\n    prediction.commentCount ??\n    (Array.isArray((prediction as any).comments)\n      ? (prediction as any).comments.length\n      : Number((prediction as any).comments ?? 0));\n\n  return {\n    ...prediction,\n    options,\n    pool_total: prediction.pool_total ?? poolTotal,\n    poolTotal,\n    stake_min: prediction.stake_min ?? stakeMin,\n    stakeMin,\n    entry_deadline: prediction.entry_deadline ?? entryDeadline,\n    entryDeadline,\n    settlement_method: prediction.settlement_method ?? settlementMethod,\n    settlementMethod,\n    participant_count: prediction.participant_count ?? participantCount,\n    participantCount,\n    likes_count: prediction.likes_count ?? likeCount,\n    likeCount,\n    comments_count: prediction.comments_count ?? commentCount,\n    commentCount,\n  } as Prediction;\n};\n\nconst normalizePredictions = (items: PredictionLike[] = []): Prediction[] =>\n  items.map(normalizePrediction);\n\ninterface PredictionState {\n  predictions: Prediction[];\n  trendingPredictions: Prediction[];\n  userPredictions: Prediction[];\n  createdPredictions: Prediction[];\n  completedPredictions: Prediction[];\n  userPredictionEntries: PredictionEntry[];\n  userCreatedPredictions: Prediction[];\n  loading: boolean;\n  loadingMore: boolean;\n  error: string | null;\n  initialized: boolean;\n  lastFetchTime: number;\n  platformStats: PlatformStats | null;\n  statsLoading: boolean;\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    hasNext: boolean;\n    hasPrev: boolean;\n  };\n  filters: {\n    category: string;\n    search: string;\n  };\n  // Prevent duplicate concurrent bet submissions per composite key\n  inFlightBets?: Record<string, boolean>;\n}\n\ninterface PredictionActions {\n  // Core prediction actions\n  fetchPredictions: (params?: { page?: number; category?: string; search?: string; append?: boolean }) => Promise<void>;\n  loadMorePredictions: () => Promise<void>;\n  refreshPredictions: (force?: boolean) => Promise<void>; // Added this method\n  setFilters: (filters: Partial<{ category: string; search: string }>) => void;\n  resetPagination: () => void;\n  fetchTrendingPredictions: () => Promise<void>;\n  fetchUserPredictions: (userId: string) => Promise<void>;\n  fetchCreatedPredictions: (userId: string) => Promise<void>;\n  fetchPredictionById: (id: string) => Promise<Prediction | null>;\n  createPrediction: (predictionData: any) => Promise<Prediction>;\n  placePrediction: (predictionId: string, optionId: string, amount: number, userId?: string, walletAddress?: string | null) => Promise<void>;\n  placeFiatPrediction: (predictionId: string, optionId: string, amountNgn: number, userId: string) => Promise<void>;\n  \n  // User-specific data fetching\n  fetchUserPredictionEntries: (userId: string) => Promise<void>;\n  fetchUserCreatedPredictions: (userId: string) => Promise<void>;\n  \n  // Utility methods for accessing user data\n  getUserPredictionEntries: (userId: string) => PredictionEntry[];\n  getUserCreatedPredictions: (userId: string) => Prediction[];\n  \n\n  \n  // Prediction management methods\n  updatePrediction: (predictionId: string, updates: any) => Promise<void>;\n  deletePrediction: (predictionId: string) => Promise<void>;\n  closePrediction: (predictionId: string) => Promise<void>;\n  fetchPredictionActivity: (predictionId: string) => Promise<ActivityItem[]>;\n  fetchPredictionParticipants: (predictionId: string) => Promise<Participant[]>;\n  \n  // Platform stats\n  fetchPlatformStats: () => Promise<void>;\n  \n  // Utility methods - REMOVED MOCK DATA\n  getActivityForPrediction: (predictionId: string) => ActivityItem[];\n  getParticipantsForPrediction: (predictionId: string) => Participant[];\n  \n  // State management\n  clearError: () => void;\n  reset: () => void;\n}\n\nconst initialState: PredictionState = {\n  predictions: [],\n  trendingPredictions: [],\n  userPredictions: [],\n  createdPredictions: [],\n  completedPredictions: [],\n  userPredictionEntries: [],\n  userCreatedPredictions: [],\n  loading: false,\n  loadingMore: false,\n  error: null,\n  initialized: false,\n  lastFetchTime: 0,\n  platformStats: null,\n  statsLoading: false,\n  pagination: {\n    page: 1,\n    limit: 20,\n    total: 0,\n    hasNext: false,\n    hasPrev: false,\n  },\n  filters: {\n    category: 'all',\n    search: '',\n  },\n  inFlightBets: {},\n};\n\nexport const usePredictionStore = create<PredictionState & PredictionActions>((set, get) => ({\n  ...initialState,\n\n  fetchPredictions: async (params = {}) => {\n    const { \n      page = 1, \n      category = get().filters.category, \n      search = get().filters.search, \n      append = false \n    } = params;\n    \n    const currentTime = Date.now();\n    const { lastFetchTime, predictions: currentPredictions } = get();\n    \n    // Cache for 30 seconds for first page only\n    if (!append && page === 1 && currentTime - lastFetchTime < 30000 && currentPredictions.length > 0) {\n      console.log(' Using cached predictions');\n      return;\n    }\n    \n    const isLoadingMore = append && page > 1;\n    set({ \n      [isLoadingMore ? 'loadingMore' : 'loading']: true, \n      error: null \n    });\n    \n    try {\n      console.log(` Fetching predictions: page=${page}, category=${category}, search=${search}, append=${append}`);\n      \n      const queryParams = new URLSearchParams({\n        page: page.toString(),\n        limit: '20',\n        ...(category !== 'all' && { category }),\n        ...(search.trim() && { search: search.trim() })\n      });\n      \n      const data = await apiClient.get(`/api/v2/predictions?${queryParams}`, {\n        timeout: 10000,\n        retryOptions: { maxRetries: 3 }\n      });\n\n      const newPredictions = normalizePredictions(data.data || []);\n      const pagination = data.pagination || {};\n      \n      console.log(` Predictions fetched successfully: ${newPredictions.length} items (${pagination.total} total)`);\n\n      set(state => ({ \n        predictions: append ? [...state.predictions, ...newPredictions] : newPredictions,\n        loading: false,\n        loadingMore: false,\n        error: null,\n        initialized: true,\n        lastFetchTime: currentTime,\n        pagination: {\n          page: pagination.page || page,\n          limit: pagination.limit || 20,\n          total: pagination.total || 0,\n          hasNext: pagination.hasNext || false,\n          hasPrev: pagination.hasPrev || false,\n        },\n        filters: { category, search }\n      }));\n\n    } catch (error) {\n      console.error(' Error fetching predictions:', error);\n      set({\n        loading: false,\n        loadingMore: false,\n        error: error instanceof Error ? error.message : 'Failed to fetch predictions',\n        // Don't clear predictions on error, keep existing data\n      });\n    }\n  },\n\n  // Load more predictions for infinite scroll\n  loadMorePredictions: async () => {\n    const { pagination, loadingMore } = get();\n    \n    if (loadingMore || !pagination.hasNext) {\n      console.log(' Load more skipped:', { loadingMore, hasNext: pagination.hasNext });\n      return;\n    }\n    \n    console.log(` Loading more predictions: page ${pagination.page + 1}`);\n    await get().fetchPredictions({ \n      page: pagination.page + 1, \n      append: true \n    });\n  },\n\n  // Set filters and reset pagination\n  setFilters: (newFilters) => {\n    const currentFilters = get().filters;\n    const updatedFilters = { ...currentFilters, ...newFilters };\n    \n    console.log(' Setting filters:', updatedFilters);\n    \n    set(state => ({\n      filters: updatedFilters,\n      pagination: { ...state.pagination, page: 1 },\n      predictions: [] // Clear current predictions\n    }));\n    \n    // Fetch with new filters\n    get().fetchPredictions({ \n      category: updatedFilters.category, \n      search: updatedFilters.search \n    });\n  },\n\n  // Reset pagination to initial state\n  resetPagination: () => {\n    console.log(' Resetting pagination');\n    set(state => ({\n      pagination: { ...initialState.pagination },\n      filters: { ...initialState.filters },\n      predictions: []\n    }));\n  },\n\n  // NEW: refreshPredictions method that was missing\n  refreshPredictions: async (force = false) => {\n    const { lastFetchTime } = get();\n    const currentTime = Date.now();\n    \n    // If not forced and we've fetched recently, use cache\n    if (!force && currentTime - lastFetchTime < 10000) {\n      console.log(' Using cached predictions (refresh)');\n      return;\n    }\n    \n    // Reset to first page and fetch\n    set(state => ({\n      lastFetchTime: 0,\n      pagination: { ...state.pagination, page: 1 },\n      predictions: []\n    }));\n    \n    try {\n      await get().fetchPredictions();\n      console.log(' Predictions refreshed successfully');\n    } catch (error) {\n      console.error(' Error refreshing predictions:', error);\n      throw error;\n    }\n  },\n\n  fetchTrendingPredictions: async () => {\n    set({ loading: true });\n    \n    try {\n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/trending`);\n      \n      if (!response.ok) {\n        throw new Error(`Failed to fetch trending predictions: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      const trendingPredictions = normalizePredictions(data.data || []);\n      \n      set({ \n        trendingPredictions,\n        loading: false,\n        error: null\n      });\n      \n      console.log(' Trending predictions fetched:', trendingPredictions.length);\n\n    } catch (error) {\n      console.error(' Error fetching trending predictions:', error);\n        set({ \n          loading: false,\n        error: error instanceof Error ? error.message : 'Failed to fetch trending predictions'\n      });\n    }\n  },\n\n  fetchUserPredictions: async (userId: string) => {\n    set({ loading: true });\n    \n    try {\n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/user/${userId}`);\n      \n      if (!response.ok) {\n        throw new Error(`Failed to fetch user predictions: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      const userPredictions = normalizePredictions(data.data || []);\n      \n      set({ \n        userPredictions,\n        loading: false,\n        error: null\n      });\n\n    } catch (error) {\n      console.error(' Error fetching user predictions:', error);\n      set({ \n        loading: false,\n        error: error instanceof Error ? error.message : 'Failed to fetch user predictions'\n      });\n    }\n  },\n\n  fetchCreatedPredictions: async (userId: string) => {\n    set({ loading: true });\n    \n    try {\n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/created/${userId}`);\n      \n      if (!response.ok) {\n        throw new Error(`Failed to fetch created predictions: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      const createdPredictions = normalizePredictions(data.data || []);\n\n      set({\n        createdPredictions,\n        loading: false,\n        error: null\n      });\n\n    } catch (error) {\n      console.error(' Error fetching created predictions:', error);\n      set({\n        loading: false,\n        error: error instanceof Error ? error.message : 'Failed to fetch created predictions'\n      });\n    }\n  },\n\n  fetchPredictionById: async (id: string) => {\n    try {\n      console.log(` Fetching prediction by ID: ${id}`);\n      const { predictions } = get();\n      const existing = predictions.find(p => p.id === id) || null;\n\n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/${id}`);\n\n      if (!response.ok) {\n        // Suppress 404 errors for archived/deleted predictions\n        if (response.status === 404) {\n          console.log(` Prediction ${id} not found (archived or deleted)`);\n        } else {\n          console.error(` Failed to fetch prediction ${id}:`, response.status);\n        }\n        return existing;\n      }\n\n      const data = await response.json();\n      const freshPrediction = normalizePrediction(data.data);\n\n      if (!freshPrediction) {\n        return existing;\n      }\n\n      console.log(' Fetched prediction from API:', freshPrediction.title);\n      console.log(' Prediction options:', freshPrediction.options?.length || 0);\n\n      set(state => {\n        const merge = (pred: any) =>\n          pred.id === id ? { ...pred, ...freshPrediction } : pred;\n\n        const ensurePredictionList = (list: any[]) =>\n          list.some(pred => pred.id === id)\n            ? list.map(merge)\n            : [...list, freshPrediction];\n\n        return {\n          predictions: ensurePredictionList(state.predictions),\n          userPredictions: state.userPredictions.map(merge),\n          createdPredictions: state.createdPredictions.map(merge),\n          userCreatedPredictions: state.userCreatedPredictions.map(merge),\n          trendingPredictions: state.trendingPredictions.map(merge),\n          completedPredictions: state.completedPredictions.map(merge),\n        };\n      });\n\n      return freshPrediction;\n    } catch (error) {\n      // Suppress console errors for network issues (likely 404s for archived predictions)\n      console.log(` Could not fetch prediction ${id}`);\n      const { predictions } = get();\n      return predictions.find(p => p.id === id) || null;\n    }\n  },\n\n  createPrediction: async (predictionData: any) => {\n    set({ loading: true, error: null });\n    \n    try {\n      const response = await fetch(`${getApiUrl()}/api/v2/predictions`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(predictionData),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to create prediction: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      \n      if (!data.data) {\n        throw new Error('Invalid response: no prediction data returned');\n      }\n      \n      const newPrediction = normalizePrediction(data.data);\n\n      // Validate the prediction has required fields\n      if (!newPrediction || !newPrediction.id) {\n        throw new Error('Invalid prediction data: missing required fields');\n      }\n\n      // Add to predictions list\n      set(state => ({\n        predictions: [newPrediction, ...state.predictions],\n        loading: false,\n        error: null\n      }));\n\n      // Force refresh predictions to ensure options are displayed correctly (fast refresh)\n      setTimeout(() => {\n        get().fetchPredictions();\n      }, 100);\n\n      // Add to user created predictions immediately for instant UI update\n      set(state => ({\n        userCreatedPredictions: [newPrediction, ...state.userCreatedPredictions]\n      }));\n\n      // Also refresh user's created predictions from server after a delay\n      try {\n        const { user } = useAuthStore.getState();\n        if (user?.id) {\n          // Wait a bit for database to be consistent, then refresh\n          setTimeout(() => {\n            get().fetchUserCreatedPredictions(user.id);\n          }, 1000);\n        }\n    } catch (error) {\n        console.warn(' Failed to refresh user created predictions:', error);\n      }\n\n      console.log(' Prediction created successfully:', newPrediction.id);\n      return newPrediction;\n\n    } catch (error) {\n      console.error(' Error creating prediction:', error);\n      set({ \n        loading: false,\n        error: error instanceof Error ? error.message : 'Failed to create prediction'\n      });\n      throw error;\n    }\n  },\n\n  placePrediction: async (predictionId: string, optionId: string, amount: number, userId?: string, walletAddress?: string | null) => {\n    set({ loading: true, error: null });\n    \n    try {\n      const FLAG_BASE_BETS = import.meta.env.VITE_FCZ_BASE_BETS === '1' || \n                              import.meta.env.ENABLE_BASE_BETS === '1' ||\n                              import.meta.env.FCZ_ENABLE_BASE_BETS === '1' ||\n                              import.meta.env.VITE_FCZ_BASE_ENABLE === '1';\n      const funding = useFundingModeStore.getState();\n      const selectedMode = funding.mode;\n      const isCryptoMode = selectedMode === 'crypto';\n      const isFiatMode = selectedMode === 'fiat' && funding.isFiatEnabled;\n\n      console.log('[FCZ-BET] mode detection', { FLAG_BASE_BETS, selectedMode, isCryptoMode, predictionId, optionId, amount, userId });\n\n      // FIAT MODE: Use unified endpoint with fundingMode='fiat' and amountNgn\n      if (isFiatMode) {\n        console.log('[FCZ-BET] Placing bet via unified endpoint (fiat)...', { predictionId, optionId, amountNgn: amount, userId });\n\n        const compositeKey = computeBetKey(userId, predictionId, optionId, amount);\n        const inFlight = get().inFlightBets || {};\n        if (inFlight[compositeKey]) {\n          console.log('[FCZ-BET] Duplicate click prevented (in-flight):', compositeKey);\n          set({ loading: false });\n          return;\n        }\n        set(state => ({ inFlightBets: { ...(state.inFlightBets || {}), [compositeKey]: true } }));\n        const requestId = getOrCreateRequestId(compositeKey);\n\n        const response = await fetch(`${getApiUrl()}/api/predictions/${predictionId}/place-bet`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            optionId,\n            amountNgn: amount,\n            userId,\n            fundingMode: 'fiat',\n            requestId,\n          }),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          if (errorData.error === 'INSUFFICIENT_FUNDS') {\n            throw new Error('INSUFFICIENT_FUNDS');\n          }\n          if (errorData.error === 'FIAT_DISABLED') {\n            throw new Error('FIAT_DISABLED');\n          }\n          if (errorData.error === 'BETTING_DISABLED') {\n            throw new Error('Betting is temporarily unavailable. Please try again later.');\n          }\n          throw new Error(errorData.message || `Unable to place bet. Please try again.`);\n        }\n\n        const result = await response.json();\n        console.log('[FCZ-BET] Fiat bet placed successfully:', result);\n\n        const updatedPrediction = result?.data?.prediction;\n        const newEntry = result?.data?.entry;\n\n        set(state => {\n          const mergePrediction = (pred: any) => {\n            if (!pred || pred.id !== predictionId) return pred;\n            return updatedPrediction ? { ...pred, ...updatedPrediction } : pred;\n          };\n\n          return {\n            predictions: state.predictions.map(mergePrediction),\n            userPredictions: state.userPredictions.map(mergePrediction),\n            createdPredictions: state.createdPredictions.map(mergePrediction),\n            userCreatedPredictions: state.userCreatedPredictions.map(mergePrediction),\n            userPredictionEntries: newEntry\n              ? [\n                  ...state.userPredictionEntries.filter(entry => entry.id !== newEntry.id),\n                  newEntry\n                ]\n              : state.userPredictionEntries,\n            loading: false,\n            error: null\n          };\n        });\n\n        // clear in-flight\n        set(state => {\n          const next = { ...(state.inFlightBets || {}) };\n          delete next[compositeKey];\n          return { inFlightBets: next } as any;\n        });\n\n        return result;\n      }\n\n      // Use new unified place-bet endpoint if crypto mode is enabled\n      if (isCryptoMode) {\n        console.log('[FCZ-BET] Placing bet via unified endpoint...', { predictionId, optionId, amount, userId });\n        \n        // Generate stable idempotency key + requestId (reused within TTL)\n        const compositeKey = computeBetKey(userId, predictionId, optionId, amount);\n        const inFlight = get().inFlightBets || {};\n        if (inFlight[compositeKey]) {\n          console.log('[FCZ-BET] Duplicate click prevented (in-flight):', compositeKey);\n          set({ loading: false });\n          return; // Ignore duplicate concurrent submissions\n        }\n        // mark in-flight\n        set(state => ({ inFlightBets: { ...(state.inFlightBets || {}), [compositeKey]: true } }));\n        const requestId = getOrCreateRequestId(compositeKey);\n        \n        const response = await fetch(`${getApiUrl()}/api/predictions/${predictionId}/place-bet`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            optionId,\n            amountUSD: amount,\n            userId,\n            walletAddress: walletAddress || undefined,\n            requestId\n          }),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          \n          // Handle specific error codes\n          if (errorData.error === 'INSUFFICIENT_ESCROW') {\n            throw new Error('INSUFFICIENT_ESCROW');\n          }\n          \n          if (errorData.error === 'BETTING_DISABLED') {\n            throw new Error('Betting is temporarily unavailable. Please try again later.');\n          }\n          \n          throw new Error(errorData.message || `Unable to place bet. Please try again.`);\n        }\n\n        const result = await response.json();\n        console.log('[FCZ-BET] Bet placed successfully:', result);\n\n        const updatedPrediction = result?.data?.prediction;\n        const newEntry = result?.data?.entry;\n\n        set(state => {\n          const mergePrediction = (pred: any) => {\n            if (!pred || pred.id !== predictionId) return pred;\n            return updatedPrediction\n              ? { ...pred, ...updatedPrediction }\n              : { \n                  ...pred, \n                  pool_total: (pred.pool_total || 0) + amount,\n                  participant_count: (pred.participant_count || 0) + 1\n                };\n          };\n\n          return {\n            predictions: state.predictions.map(mergePrediction),\n            userPredictions: state.userPredictions.map(mergePrediction),\n            createdPredictions: state.createdPredictions.map(mergePrediction),\n            userCreatedPredictions: state.userCreatedPredictions.map(mergePrediction),\n            userPredictionEntries: newEntry\n              ? [\n                  ...state.userPredictionEntries.filter(entry => entry.id !== newEntry.id),\n                  newEntry\n                ]\n              : state.userPredictionEntries,\n            loading: false,\n            error: null\n          };\n        });\n\n        // Ensure derived lists (like created predictions) stay fresh\n        try {\n          const { user } = useAuthStore.getState();\n          if (user?.id) {\n            await Promise.all([\n              get().fetchUserCreatedPredictions(user.id),\n              get().fetchUserPredictionEntries(user.id)\n            ]);\n          }\n        } catch (refreshErr) {\n          console.warn('[FCZ-BET] Post-bet refresh encountered an issue:', refreshErr);\n        }\n        // clear in-flight\n        set(state => {\n          const next = { ...(state.inFlightBets || {}) };\n          delete next[compositeKey];\n          return { inFlightBets: next } as any;\n        });\n\n        return result;\n      } else {\n        // DEMO MODE: Use the SAME unified endpoint with fundingMode='demo'\n        console.log('[FCZ-BET] Placing bet via unified endpoint (demo)...', { predictionId, optionId, amount, userId });\n\n        const compositeKey = computeBetKey(userId, predictionId, optionId, amount);\n        const inFlight = get().inFlightBets || {};\n        if (inFlight[compositeKey]) {\n          console.log('[FCZ-BET] Duplicate click prevented (in-flight):', compositeKey);\n          set({ loading: false });\n          return;\n        }\n        set(state => ({ inFlightBets: { ...(state.inFlightBets || {}), [compositeKey]: true } }));\n        const requestId = getOrCreateRequestId(compositeKey);\n\n        const response = await fetch(`${getApiUrl()}/api/predictions/${predictionId}/place-bet`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            optionId,\n            amountUSD: amount,\n            userId,\n            fundingMode: 'demo',\n            requestId\n          }),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          if (errorData.error === 'INSUFFICIENT_FUNDS') {\n            throw new Error('INSUFFICIENT_FUNDS');\n          }\n          if (errorData.error === 'BETTING_DISABLED') {\n            throw new Error('Betting is temporarily unavailable. Please try again later.');\n          }\n          throw new Error(errorData.message || `Unable to place bet. Please try again.`);\n        }\n\n        const result = await response.json();\n        console.log('[FCZ-BET] Demo bet placed successfully:', result);\n\n        const updatedPrediction = result?.data?.prediction;\n        const newEntry = result?.data?.entry;\n\n        set(state => {\n          const mergePrediction = (pred: any) => {\n            if (!pred || pred.id !== predictionId) return pred;\n            return updatedPrediction ? { ...pred, ...updatedPrediction } : pred;\n          };\n\n          return {\n            predictions: state.predictions.map(mergePrediction),\n            userPredictions: state.userPredictions.map(mergePrediction),\n            createdPredictions: state.createdPredictions.map(mergePrediction),\n            userCreatedPredictions: state.userCreatedPredictions.map(mergePrediction),\n            userPredictionEntries: newEntry\n              ? [\n                  ...state.userPredictionEntries.filter(entry => entry.id !== newEntry.id),\n                  newEntry\n                ]\n              : state.userPredictionEntries,\n            loading: false,\n            error: null\n          };\n        });\n\n        try {\n          const { user } = useAuthStore.getState();\n          if (user?.id) {\n            await Promise.all([\n              get().fetchUserCreatedPredictions(user.id),\n              get().fetchUserPredictionEntries(user.id)\n            ]);\n          }\n        } catch (refreshErr) {\n          console.warn('[FCZ-BET] Post-bet refresh encountered an issue:', refreshErr);\n        }\n\n        set(state => {\n          const next = { ...(state.inFlightBets || {}) };\n          delete next[compositeKey];\n          return { inFlightBets: next } as any;\n        });\n\n        return result;\n      }\n\n    } catch (error) {\n      console.error(' Error placing prediction:', error);\n      \n      // Provide helpful error messages\n      let errorMessage = 'Failed to place prediction';\n      if (error instanceof Error) {\n        if (error.message.includes('already been used') || error.message.includes('already been consumed')) {\n          errorMessage = 'Previous bet attempt was not completed. Please refresh the page and try again.';\n        } else {\n          errorMessage = error.message;\n        }\n      }\n      \n      set({\n        loading: false,\n        error: errorMessage\n      });\n      throw error;\n    } finally {\n      // Always clear in-flight guard after attempt window for this composite key\n      try {\n        const compositeKey = computeBetKey(userId, predictionId, optionId, amount);\n        set(state => {\n          const next = { ...(state.inFlightBets || {}) };\n          delete next[compositeKey];\n          return { inFlightBets: next } as any;\n        });\n      } catch {}\n    }\n  },\n\n  /**\n   * Place a prediction bet using fiat (NGN) balance\n   * Phase 7B: Fiat staking\n   */\n  placeFiatPrediction: async (predictionId: string, optionId: string, amountNgn: number, userId: string) => {\n    set({ loading: true, error: null });\n\n    try {\n      console.log('[FCZ-BET] Placing fiat bet...', { predictionId, optionId, amountNgn, userId });\n\n      // Generate stable idempotency key\n      const compositeKey = computeBetKey(userId, predictionId, optionId, amountNgn);\n      const inFlight = get().inFlightBets || {};\n      if (inFlight[compositeKey]) {\n        console.log('[FCZ-BET] Duplicate click prevented (in-flight):', compositeKey);\n        set({ loading: false });\n        return;\n      }\n      set(state => ({ inFlightBets: { ...(state.inFlightBets || {}), [compositeKey]: true } }));\n      const requestId = getOrCreateRequestId(compositeKey);\n\n      const response = await fetch(`${getApiUrl()}/api/predictions/${predictionId}/place-bet`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          optionId,\n          amountNgn,\n          userId,\n          fundingMode: 'fiat',\n          requestId,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        if (errorData.error === 'INSUFFICIENT_FUNDS') {\n          throw new Error('Insufficient fiat balance. Please deposit more NGN.');\n        }\n        if (errorData.error === 'FIAT_DISABLED') {\n          throw new Error('Fiat betting is currently disabled.');\n        }\n        if (errorData.error === 'BETTING_DISABLED') {\n          throw new Error('Betting is temporarily unavailable. Please try again later.');\n        }\n        throw new Error(errorData.message || 'Unable to place bet. Please try again.');\n      }\n\n      const result = await response.json();\n      console.log('[FCZ-BET] Fiat bet placed successfully:', result);\n\n      const updatedPrediction = result?.data?.prediction;\n      const newEntry = result?.data?.entry;\n\n      set(state => {\n        const mergePrediction = (pred: any) => {\n          if (!pred || pred.id !== predictionId) return pred;\n          return updatedPrediction ? { ...pred, ...updatedPrediction } : pred;\n        };\n\n        return {\n          predictions: state.predictions.map(mergePrediction),\n          userPredictions: state.userPredictions.map(mergePrediction),\n          createdPredictions: state.createdPredictions.map(mergePrediction),\n          userCreatedPredictions: state.userCreatedPredictions.map(mergePrediction),\n          userPredictionEntries: newEntry\n            ? [\n                ...state.userPredictionEntries.filter(entry => entry.id !== newEntry.id),\n                newEntry\n              ]\n            : state.userPredictionEntries,\n          loading: false,\n          error: null\n        };\n      });\n\n      try {\n        const { user } = useAuthStore.getState();\n        if (user?.id) {\n          await Promise.all([\n            get().fetchUserCreatedPredictions(user.id),\n            get().fetchUserPredictionEntries(user.id)\n          ]);\n        }\n      } catch (refreshErr) {\n        console.warn('[FCZ-BET] Post-bet refresh encountered an issue:', refreshErr);\n      }\n\n      // Clear in-flight\n      set(state => {\n        const next = { ...(state.inFlightBets || {}) };\n        delete next[compositeKey];\n        return { inFlightBets: next } as any;\n      });\n\n      return result;\n    } catch (error) {\n      console.error(' Error placing fiat prediction:', error);\n      let errorMessage = 'Failed to place prediction';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      }\n      set({ loading: false, error: errorMessage });\n      throw error;\n    }\n  },\n\n  fetchPlatformStats: async () => {\n    set({ statsLoading: true });\n    \n    try {\n      console.log(' Fetching platform stats with retry logic...');\n      \n      const data = await apiClient.get('/api/v2/predictions/stats/platform', {\n        timeout: 8000,\n        retryOptions: { maxRetries: 3 }\n      });\n      \n      if (data.success && data.data) {\n        set({\n          platformStats: data.data,\n          statsLoading: false\n        });\n        \n        console.log(' Platform stats fetched:', data.data);\n      } else {\n        throw new Error('Invalid stats response format');\n      }\n\n    } catch (error) {\n      console.error(' Error fetching platform stats:', error);\n      \n      // Set fallback stats based on current predictions\n      const { predictions } = get();\n      const fallbackStats: PlatformStats = {\n        totalVolume: predictions.reduce((sum, pred) => sum + (pred.pool_total || 0), 0).toFixed(2),\n        activePredictions: predictions.filter(pred => pred.status === 'open').length,\n        totalUsers: predictions.length > 0 ? '5' : '0', // Fallback user count\n        rawVolume: predictions.reduce((sum, pred) => sum + (pred.pool_total || 0), 0),\n        rawUsers: predictions.length > 0 ? 5 : 0\n      };\n      \n      set({\n        platformStats: fallbackStats,\n        statsLoading: false\n      });\n      \n      console.log(' Using fallback stats:', fallbackStats);\n    }\n  },\n\n  // REMOVED MOCK DATA - Returns empty arrays if no real data\n  getActivityForPrediction: (predictionId: string) => {\n    // Real implementation would fetch from database\n    // For now, return empty array until real activity tracking is implemented\n    return [];\n  },\n\n  getParticipantsForPrediction: (predictionId: string) => {\n    // Real implementation would fetch from database\n    // For now, return empty array until real participant tracking is implemented\n    return [];\n  },\n\n  clearError: () => {\n    set({ error: null });\n  },\n\n  // User-specific data fetching methods\n  fetchUserPredictionEntries: async (userId: string) => {\n    try {\n      console.log(' Fetching user prediction entries with retry logic for:', userId);\n      \n      const data = await apiClient.get(`/api/v2/prediction-entries/user/${userId}`, {\n        timeout: 10000,\n        retryOptions: { maxRetries: 3 }\n      });\n\n      const userPredictionEntries = data.data || [];\n\n      set({ userPredictionEntries });\n      console.log(' User prediction entries fetched:', userPredictionEntries.length);\n\n    } catch (error) {\n      console.error(' Error fetching user prediction entries:', error);\n      // Don't set error state for this, just log it\n    }\n  },\n\n  fetchUserCreatedPredictions: async (userId: string) => {\n    try {\n      console.log(' Fetching user created predictions with retry logic for:', userId);\n      \n      const data = await apiClient.get(`/api/v2/predictions/created/${userId}`, {\n        timeout: 10000,\n        retryOptions: { maxRetries: 3 }\n      });\n\n      const userCreatedPredictions = data.data || [];\n\n      set({ userCreatedPredictions });\n      console.log(' User created predictions fetched:', userCreatedPredictions.length);\n      \n    } catch (error) {\n      console.error(' Error fetching user created predictions:', error);\n      // Don't set error state for this, just log it\n    }\n  },\n\n  // Utility methods for accessing user data\n  getUserPredictionEntries: (userId: string) => {\n    const { userPredictionEntries } = get();\n    return userPredictionEntries.filter(entry => entry.user_id === userId);\n  },\n\n  getUserCreatedPredictions: (userId: string) => {\n    const { userCreatedPredictions } = get();\n    return userCreatedPredictions.filter(prediction => prediction.creator_id === userId);\n  },\n\n\n\n  // Prediction management methods\n  updatePrediction: async (predictionId: string, updates: any) => {\n    try {\n      console.log(' Updating prediction:', predictionId, updates);\n      \n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/${predictionId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify(updates)\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to update prediction: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      const updatedPrediction = data.data;\n\n      // Update prediction in all relevant state arrays\n      set(state => ({\n        predictions: state.predictions.map(pred => \n          pred.id === predictionId ? { ...pred, ...updatedPrediction } : pred\n        ),\n        userCreatedPredictions: state.userCreatedPredictions.map(pred => \n          pred.id === predictionId ? { ...pred, ...updatedPrediction } : pred\n        )\n      }));\n\n      console.log(' Prediction updated successfully');\n      \n    } catch (error) {\n      console.error(' Error updating prediction:', error);\n      throw error;\n    }\n  },\n\n  deletePrediction: async (predictionId: string) => {\n    try {\n      console.log(' Deleting prediction:', predictionId);\n      \n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/${predictionId}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to delete prediction: ${response.statusText}`);\n      }\n\n      // Optimistically remove prediction from all relevant state arrays\n      set(state => ({\n        predictions: state.predictions.filter(pred => pred.id !== predictionId),\n        createdPredictions: state.createdPredictions.filter(pred => pred.id !== predictionId),\n        userCreatedPredictions: state.userCreatedPredictions.filter(pred => pred.id !== predictionId),\n        trendingPredictions: state.trendingPredictions.filter(pred => pred.id !== predictionId),\n        completedPredictions: state.completedPredictions.filter(pred => pred.id !== predictionId),\n      }));\n\n      // Proactively refresh lists to avoid any stale interactions\n      try {\n        const { user } = useAuthStore.getState();\n        // Force-refresh main feeds (bypass cache)\n        await get().refreshPredictions(true);\n        await get().fetchTrendingPredictions();\n        if (user?.id) {\n          await get().fetchUserCreatedPredictions(user.id);\n          await get().fetchUserPredictionEntries(user.id);\n        }\n      } catch (refreshError) {\n        console.warn(' Post-delete refresh had an issue:', refreshError);\n      }\n\n      console.log(' Prediction deleted successfully');\n\n    } catch (error) {\n      console.error(' Error deleting prediction:', error);\n      throw error;\n    }\n  },\n\n  closePrediction: async (predictionId: string) => {\n    try {\n      console.log(' Closing prediction:', predictionId);\n      \n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/${predictionId}/close`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to close prediction: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      const updatedPrediction = data.data;\n\n      // Update prediction status in state\n      set(state => {\n        const mergePrediction = (pred: any) =>\n          pred.id === predictionId\n            ? { ...pred, ...updatedPrediction, status: 'closed' }\n            : pred;\n\n        return {\n          predictions: state.predictions.map(mergePrediction),\n          userCreatedPredictions: state.userCreatedPredictions.map(mergePrediction),\n          createdPredictions: state.createdPredictions.map(mergePrediction),\n          userPredictions: state.userPredictions.map(mergePrediction),\n          trendingPredictions: state.trendingPredictions.map(mergePrediction),\n          completedPredictions: state.completedPredictions.map(mergePrediction),\n        };\n      });\n\n      console.log(' Prediction closed successfully');\n\n    } catch (error) {\n      console.error(' Error closing prediction:', error);\n      throw error;\n    }\n  },\n\n  fetchPredictionActivity: async (predictionId: string) => {\n    try {\n      console.log(' Fetching prediction activity:', predictionId);\n      \n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/${predictionId}/activity`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        console.warn(`Activity endpoint not available: ${response.statusText}`);\n        return []; // Return empty array if endpoint doesn't exist yet\n      }\n\n      const data = await response.json();\n      return data.data || [];\n\n    } catch (error) {\n      console.warn('Activity endpoint not implemented yet:', error);\n      return []; // Return empty array for now\n    }\n  },\n\n  fetchPredictionParticipants: async (predictionId: string) => {\n    try {\n      console.log(' Fetching prediction participants:', predictionId);\n      \n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/${predictionId}/participants`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        console.warn(`Participants endpoint not available: ${response.statusText}`);\n        return []; // Return empty array if endpoint doesn't exist yet\n      }\n\n      const data = await response.json();\n      return data.data || [];\n      \n    } catch (error) {\n      console.warn('Participants endpoint not implemented yet:', error);\n      return []; // Return empty array for now\n    }\n  },\n\n  reset: () => {\n    set(initialState);\n  }\n}));","import React, { useEffect, useRef } from 'react';\nimport { io, Socket } from 'socket.io-client';\nimport { useQueryClient } from '@tanstack/react-query';\nimport { getSocketUrl } from '@/utils/environment';\nimport { useAuthSession } from './AuthSessionProvider';\nimport { QK } from '@/lib/queryKeys';\nimport { usePredictionStore } from '@/store/predictionStore';\n\ntype Props = { children: React.ReactNode };\n\nconst refreshActivePredictions = async () => {\n  const { refreshPredictions } = usePredictionStore.getState();\n  if (typeof refreshPredictions !== 'function') return;\n  try {\n    console.log('[REALTIME] Refreshing prediction store (forced)');\n    await refreshPredictions(true);\n  } catch (error) {\n    console.warn('[REALTIME] Failed to refresh predictions after realtime update:', error);\n  }\n};\n\nexport const RealtimeProvider: React.FC<Props> = ({ children }) => {\n  const { user } = useAuthSession();\n  const queryClient = useQueryClient();\n  const socketRef = useRef<Socket | null>(null);\n\n  useEffect(() => {\n    const url = getSocketUrl().replace(/\\/$/, '');\n    console.log('[REALTIME] Connecting to Socket.io:', url);\n    const socket = io(url, {\n      transports: ['websocket', 'polling'], // Add polling fallback for Render compatibility\n      withCredentials: true,\n      autoConnect: true,\n      reconnection: true,\n      reconnectionAttempts: 10,\n      reconnectionDelay: 500,\n      timeout: 20000,\n    });\n    socketRef.current = socket;\n\n    socket.on('connect', () => {\n      console.log('[REALTIME]  Connected to Socket.io server');\n      console.log('[REALTIME] Transport:', socket.io.engine?.transport?.name || 'unknown');\n    });\n\n    socket.on('connect_error', (error) => {\n      console.error('[REALTIME]  Connection error:', error.message);\n    });\n\n    socket.on('disconnect', (reason) => {\n      console.warn('[REALTIME]  Disconnected:', reason);\n    });\n\n    const onWalletUpdate = (payload: { userId: string }) => {\n      if (!user?.id || payload.userId !== user.id) return;\n      // Invalidate wallet data aggressively\n      queryClient.invalidateQueries({ queryKey: QK.walletSummary(user.id) });\n      queryClient.invalidateQueries({ queryKey: QK.walletActivity(user.id) });\n      queryClient.invalidateQueries({ queryKey: QK.escrowBalance(user.id) });\n      queryClient.invalidateQueries({ queryKey: ['readContract'] });\n    };\n\n    const onPredictionUpdate = (payload: { predictionId: string }) => {\n      if (payload.predictionId) {\n        queryClient.invalidateQueries({ queryKey: QK.prediction(payload.predictionId) });\n        queryClient.invalidateQueries({ queryKey: QK.predictionEntries(payload.predictionId) });\n        void refreshActivePredictions();\n      }\n    };\n\n    const onSettlementComplete = (payload: { predictionId: string }) => {\n      if (payload.predictionId) {\n        queryClient.invalidateQueries({ queryKey: QK.prediction(payload.predictionId) });\n        queryClient.invalidateQueries({ queryKey: QK.predictionEntries(payload.predictionId) });\n        if (user?.id) {\n          queryClient.invalidateQueries({ queryKey: QK.walletSummary(user.id) });\n        }\n        void refreshActivePredictions();\n      }\n    };\n\n    socket.on('wallet:update', onWalletUpdate);\n    socket.on('prediction:update', onPredictionUpdate);\n    socket.on('settlement:complete', onSettlementComplete);\n\n    return () => {\n      socket.off('wallet:update', onWalletUpdate);\n      socket.off('prediction:update', onPredictionUpdate);\n      socket.off('settlement:complete', onSettlementComplete);\n      socket.close();\n    };\n  }, [user?.id, queryClient]);\n\n  return <>{children}</>;\n};\n\n\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase().trim();\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ color = \"currentColor\", size = 24, strokeWidth = 2, absoluteStrokeWidth, className = \"\", children, ...rest }, ref) => createElement(\n      \"svg\",\n      {\n        ref,\n        ...defaultAttributes,\n        width: size,\n        height: size,\n        stroke: color,\n        strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n        className: [\"lucide\", `lucide-${toKebabCase(iconName)}`, className].join(\" \"),\n        ...rest\n      },\n      [\n        ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n        ...Array.isArray(children) ? children : [children]\n      ]\n    )\n  );\n  Component.displayName = `${iconName}`;\n  return Component;\n};\n\nexport { createLucideIcon as default, toKebabCase };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Activity = createLucideIcon(\"Activity\", [\n  [\"path\", { d: \"M22 12h-4l-3 9L9 3l-3 9H2\", key: \"d5dnw9\" }]\n]);\n\nexport { Activity as default };\n//# sourceMappingURL=activity.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst AlertCircle = createLucideIcon(\"AlertCircle\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"12\", key: \"1pkeuh\" }],\n  [\"line\", { x1: \"12\", x2: \"12.01\", y1: \"16\", y2: \"16\", key: \"4dfq90\" }]\n]);\n\nexport { AlertCircle as default };\n//# sourceMappingURL=alert-circle.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst AlertTriangle = createLucideIcon(\"AlertTriangle\", [\n  [\n    \"path\",\n    {\n      d: \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\",\n      key: \"c3ski4\"\n    }\n  ],\n  [\"path\", { d: \"M12 9v4\", key: \"juzpu7\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n]);\n\nexport { AlertTriangle as default };\n//# sourceMappingURL=alert-triangle.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ArrowLeft = createLucideIcon(\"ArrowLeft\", [\n  [\"path\", { d: \"m12 19-7-7 7-7\", key: \"1l729n\" }],\n  [\"path\", { d: \"M19 12H5\", key: \"x3x0zl\" }]\n]);\n\nexport { ArrowLeft as default };\n//# sourceMappingURL=arrow-left.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ArrowRight = createLucideIcon(\"ArrowRight\", [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"m12 5 7 7-7 7\", key: \"xquz4c\" }]\n]);\n\nexport { ArrowRight as default };\n//# sourceMappingURL=arrow-right.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst BadgeCheck = createLucideIcon(\"BadgeCheck\", [\n  [\n    \"path\",\n    {\n      d: \"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z\",\n      key: \"3c2336\"\n    }\n  ],\n  [\"path\", { d: \"m9 12 2 2 4-4\", key: \"dzmm74\" }]\n]);\n\nexport { BadgeCheck as default };\n//# sourceMappingURL=badge-check.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Ban = createLucideIcon(\"Ban\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m4.9 4.9 14.2 14.2\", key: \"1m5liu\" }]\n]);\n\nexport { Ban as default };\n//# sourceMappingURL=ban.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst BarChart3 = createLucideIcon(\"BarChart3\", [\n  [\"path\", { d: \"M3 3v18h18\", key: \"1s2lah\" }],\n  [\"path\", { d: \"M18 17V9\", key: \"2bz60n\" }],\n  [\"path\", { d: \"M13 17V5\", key: \"1frdt8\" }],\n  [\"path\", { d: \"M8 17v-3\", key: \"17ska0\" }]\n]);\n\nexport { BarChart3 as default };\n//# sourceMappingURL=bar-chart-3.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Bell = createLucideIcon(\"Bell\", [\n  [\"path\", { d: \"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9\", key: \"1qo2s2\" }],\n  [\"path\", { d: \"M10.3 21a1.94 1.94 0 0 0 3.4 0\", key: \"qgo35s\" }]\n]);\n\nexport { Bell as default };\n//# sourceMappingURL=bell.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Calendar = createLucideIcon(\"Calendar\", [\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"4\", rx: \"2\", ry: \"2\", key: \"eu3xkr\" }],\n  [\"line\", { x1: \"16\", x2: \"16\", y1: \"2\", y2: \"6\", key: \"m3sa8f\" }],\n  [\"line\", { x1: \"8\", x2: \"8\", y1: \"2\", y2: \"6\", key: \"18kwsl\" }],\n  [\"line\", { x1: \"3\", x2: \"21\", y1: \"10\", y2: \"10\", key: \"xt86sb\" }]\n]);\n\nexport { Calendar as default };\n//# sourceMappingURL=calendar.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst CheckCircle = createLucideIcon(\"CheckCircle\", [\n  [\"path\", { d: \"M22 11.08V12a10 10 0 1 1-5.93-9.14\", key: \"g774vq\" }],\n  [\"path\", { d: \"m9 11 3 3L22 4\", key: \"1pflzl\" }]\n]);\n\nexport { CheckCircle as default };\n//# sourceMappingURL=check-circle.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Check = createLucideIcon(\"Check\", [[\"path\", { d: \"M20 6 9 17l-5-5\", key: \"1gmf2c\" }]]);\n\nexport { Check as default };\n//# sourceMappingURL=check.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronDown = createLucideIcon(\"ChevronDown\", [\n  [\"path\", { d: \"m6 9 6 6 6-6\", key: \"qrunsl\" }]\n]);\n\nexport { ChevronDown as default };\n//# sourceMappingURL=chevron-down.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronLeft = createLucideIcon(\"ChevronLeft\", [\n  [\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]\n]);\n\nexport { ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronRight = createLucideIcon(\"ChevronRight\", [\n  [\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]\n]);\n\nexport { ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronUp = createLucideIcon(\"ChevronUp\", [[\"path\", { d: \"m18 15-6-6-6 6\", key: \"153udz\" }]]);\n\nexport { ChevronUp as default };\n//# sourceMappingURL=chevron-up.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronsRight = createLucideIcon(\"ChevronsRight\", [\n  [\"path\", { d: \"m6 17 5-5-5-5\", key: \"xnjwq\" }],\n  [\"path\", { d: \"m13 17 5-5-5-5\", key: \"17xmmf\" }]\n]);\n\nexport { ChevronsRight as default };\n//# sourceMappingURL=chevrons-right.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Chrome = createLucideIcon(\"Chrome\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"4\", key: \"4exip2\" }],\n  [\"line\", { x1: \"21.17\", x2: \"12\", y1: \"8\", y2: \"8\", key: \"a0cw5f\" }],\n  [\"line\", { x1: \"3.95\", x2: \"8.54\", y1: \"6.06\", y2: \"14\", key: \"1kftof\" }],\n  [\"line\", { x1: \"10.88\", x2: \"15.46\", y1: \"21.94\", y2: \"14\", key: \"1ymyh8\" }]\n]);\n\nexport { Chrome as default };\n//# sourceMappingURL=chrome.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Clock = createLucideIcon(\"Clock\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"polyline\", { points: \"12 6 12 12 16 14\", key: \"68esgv\" }]\n]);\n\nexport { Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Coins = createLucideIcon(\"Coins\", [\n  [\"circle\", { cx: \"8\", cy: \"8\", r: \"6\", key: \"3yglwk\" }],\n  [\"path\", { d: \"M18.09 10.37A6 6 0 1 1 10.34 18\", key: \"t5s6rm\" }],\n  [\"path\", { d: \"M7 6h1v4\", key: \"1obek4\" }],\n  [\"path\", { d: \"m16.71 13.88.7.71-2.82 2.82\", key: \"1rbuyh\" }]\n]);\n\nexport { Coins as default };\n//# sourceMappingURL=coins.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Compass = createLucideIcon(\"Compass\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"polygon\", { points: \"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76\", key: \"m9r19z\" }]\n]);\n\nexport { Compass as default };\n//# sourceMappingURL=compass.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Copy = createLucideIcon(\"Copy\", [\n  [\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\", key: \"17jyea\" }],\n  [\"path\", { d: \"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\", key: \"zix9uf\" }]\n]);\n\nexport { Copy as default };\n//# sourceMappingURL=copy.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst DollarSign = createLucideIcon(\"DollarSign\", [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n]);\n\nexport { DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Download = createLucideIcon(\"Download\", [\n  [\"path\", { d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\", key: \"ih7n3h\" }],\n  [\"polyline\", { points: \"7 10 12 15 17 10\", key: \"2ggqvy\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"15\", y2: \"3\", key: \"1vk2je\" }]\n]);\n\nexport { Download as default };\n//# sourceMappingURL=download.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ExternalLink = createLucideIcon(\"ExternalLink\", [\n  [\"path\", { d: \"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\", key: \"a6xqqp\" }],\n  [\"polyline\", { points: \"15 3 21 3 21 9\", key: \"mznyad\" }],\n  [\"line\", { x1: \"10\", x2: \"21\", y1: \"14\", y2: \"3\", key: \"18c3s4\" }]\n]);\n\nexport { ExternalLink as default };\n//# sourceMappingURL=external-link.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Eye = createLucideIcon(\"Eye\", [\n  [\"path\", { d: \"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z\", key: \"rwhkz3\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n]);\n\nexport { Eye as default };\n//# sourceMappingURL=eye.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Filter = createLucideIcon(\"Filter\", [\n  [\"polygon\", { points: \"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\", key: \"1yg77f\" }]\n]);\n\nexport { Filter as default };\n//# sourceMappingURL=filter.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Flag = createLucideIcon(\"Flag\", [\n  [\"path\", { d: \"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z\", key: \"i9b6wo\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"22\", y2: \"15\", key: \"1cm3nv\" }]\n]);\n\nexport { Flag as default };\n//# sourceMappingURL=flag.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Fuel = createLucideIcon(\"Fuel\", [\n  [\"line\", { x1: \"3\", x2: \"15\", y1: \"22\", y2: \"22\", key: \"xegly4\" }],\n  [\"line\", { x1: \"4\", x2: \"14\", y1: \"9\", y2: \"9\", key: \"xcnuvu\" }],\n  [\"path\", { d: \"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18\", key: \"16j0yd\" }],\n  [\n    \"path\",\n    {\n      d: \"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5\",\n      key: \"8ur5zv\"\n    }\n  ]\n]);\n\nexport { Fuel as default };\n//# sourceMappingURL=fuel.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Gavel = createLucideIcon(\"Gavel\", [\n  [\"path\", { d: \"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8\", key: \"15492f\" }],\n  [\"path\", { d: \"m16 16 6-6\", key: \"vzrcl6\" }],\n  [\"path\", { d: \"m8 8 6-6\", key: \"18bi4p\" }],\n  [\"path\", { d: \"m9 7 8 8\", key: \"5jnvq1\" }],\n  [\"path\", { d: \"m21 11-8-8\", key: \"z4y7zo\" }]\n]);\n\nexport { Gavel as default };\n//# sourceMappingURL=gavel.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Headphones = createLucideIcon(\"Headphones\", [\n  [\n    \"path\",\n    {\n      d: \"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3\",\n      key: \"1xhozi\"\n    }\n  ]\n]);\n\nexport { Headphones as default };\n//# sourceMappingURL=headphones.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst HelpCircle = createLucideIcon(\"HelpCircle\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\", key: \"1u773s\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n]);\n\nexport { HelpCircle as default };\n//# sourceMappingURL=help-circle.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Home = createLucideIcon(\"Home\", [\n  [\"path\", { d: \"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\", key: \"y5dka4\" }],\n  [\"polyline\", { points: \"9 22 9 12 15 12 15 22\", key: \"e2us08\" }]\n]);\n\nexport { Home as default };\n//# sourceMappingURL=home.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst LayoutDashboard = createLucideIcon(\"LayoutDashboard\", [\n  [\"rect\", { width: \"7\", height: \"9\", x: \"3\", y: \"3\", rx: \"1\", key: \"10lvy0\" }],\n  [\"rect\", { width: \"7\", height: \"5\", x: \"14\", y: \"3\", rx: \"1\", key: \"16une8\" }],\n  [\"rect\", { width: \"7\", height: \"9\", x: \"14\", y: \"12\", rx: \"1\", key: \"1hutg5\" }],\n  [\"rect\", { width: \"7\", height: \"5\", x: \"3\", y: \"16\", rx: \"1\", key: \"ldoo1y\" }]\n]);\n\nexport { LayoutDashboard as default };\n//# sourceMappingURL=layout-dashboard.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Loader2 = createLucideIcon(\"Loader2\", [\n  [\"path\", { d: \"M21 12a9 9 0 1 1-6.219-8.56\", key: \"13zald\" }]\n]);\n\nexport { Loader2 as default };\n//# sourceMappingURL=loader-2.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Lock = createLucideIcon(\"Lock\", [\n  [\"rect\", { width: \"18\", height: \"11\", x: \"3\", y: \"11\", rx: \"2\", ry: \"2\", key: \"1w4ew1\" }],\n  [\"path\", { d: \"M7 11V7a5 5 0 0 1 10 0v4\", key: \"fwvmzm\" }]\n]);\n\nexport { Lock as default };\n//# sourceMappingURL=lock.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Mail = createLucideIcon(\"Mail\", [\n  [\"rect\", { width: \"20\", height: \"16\", x: \"2\", y: \"4\", rx: \"2\", key: \"18n3k1\" }],\n  [\"path\", { d: \"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\", key: \"1ocrg3\" }]\n]);\n\nexport { Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Percent = createLucideIcon(\"Percent\", [\n  [\"line\", { x1: \"19\", x2: \"5\", y1: \"5\", y2: \"19\", key: \"1x9vlm\" }],\n  [\"circle\", { cx: \"6.5\", cy: \"6.5\", r: \"2.5\", key: \"4mh3h7\" }],\n  [\"circle\", { cx: \"17.5\", cy: \"17.5\", r: \"2.5\", key: \"1mdrzq\" }]\n]);\n\nexport { Percent as default };\n//# sourceMappingURL=percent.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Play = createLucideIcon(\"Play\", [\n  [\"polygon\", { points: \"5 3 19 12 5 21 5 3\", key: \"191637\" }]\n]);\n\nexport { Play as default };\n//# sourceMappingURL=play.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Plus = createLucideIcon(\"Plus\", [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"M12 5v14\", key: \"s699le\" }]\n]);\n\nexport { Plus as default };\n//# sourceMappingURL=plus.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Power = createLucideIcon(\"Power\", [\n  [\"path\", { d: \"M12 2v10\", key: \"mnfbl\" }],\n  [\"path\", { d: \"M18.4 6.6a9 9 0 1 1-12.77.04\", key: \"obofu9\" }]\n]);\n\nexport { Power as default };\n//# sourceMappingURL=power.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Receipt = createLucideIcon(\"Receipt\", [\n  [\n    \"path\",\n    {\n      d: \"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z\",\n      key: \"wqdwcb\"\n    }\n  ],\n  [\"path\", { d: \"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8\", key: \"1h4pet\" }],\n  [\"path\", { d: \"M12 17V7\", key: \"pyj7ub\" }]\n]);\n\nexport { Receipt as default };\n//# sourceMappingURL=receipt.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst RefreshCcw = createLucideIcon(\"RefreshCcw\", [\n  [\"path\", { d: \"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\", key: \"14sxne\" }],\n  [\"path\", { d: \"M3 3v5h5\", key: \"1xhq8a\" }],\n  [\"path\", { d: \"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16\", key: \"1hlbsb\" }],\n  [\"path\", { d: \"M16 16h5v5\", key: \"ccwih5\" }]\n]);\n\nexport { RefreshCcw as default };\n//# sourceMappingURL=refresh-ccw.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst RefreshCw = createLucideIcon(\"RefreshCw\", [\n  [\"path\", { d: \"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\", key: \"v9h5vc\" }],\n  [\"path\", { d: \"M21 3v5h-5\", key: \"1q7to0\" }],\n  [\"path\", { d: \"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\", key: \"3uifl3\" }],\n  [\"path\", { d: \"M8 16H3v5\", key: \"1cv678\" }]\n]);\n\nexport { RefreshCw as default };\n//# sourceMappingURL=refresh-cw.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst RotateCcw = createLucideIcon(\"RotateCcw\", [\n  [\"path\", { d: \"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\", key: \"1357e3\" }],\n  [\"path\", { d: \"M3 3v5h5\", key: \"1xhq8a\" }]\n]);\n\nexport { RotateCcw as default };\n//# sourceMappingURL=rotate-ccw.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Save = createLucideIcon(\"Save\", [\n  [\"path\", { d: \"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\", key: \"1owoqh\" }],\n  [\"polyline\", { points: \"17 21 17 13 7 13 7 21\", key: \"1md35c\" }],\n  [\"polyline\", { points: \"7 3 7 8 15 8\", key: \"8nz8an\" }]\n]);\n\nexport { Save as default };\n//# sourceMappingURL=save.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ScrollText = createLucideIcon(\"ScrollText\", [\n  [\n    \"path\",\n    { d: \"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4\", key: \"13a6an\" }\n  ],\n  [\"path\", { d: \"M19 17V5a2 2 0 0 0-2-2H4\", key: \"zz82l3\" }],\n  [\"path\", { d: \"M15 8h-5\", key: \"1khuty\" }],\n  [\"path\", { d: \"M15 12h-5\", key: \"r7krc0\" }]\n]);\n\nexport { ScrollText as default };\n//# sourceMappingURL=scroll-text.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Search = createLucideIcon(\"Search\", [\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }],\n  [\"path\", { d: \"m21 21-4.3-4.3\", key: \"1qie3q\" }]\n]);\n\nexport { Search as default };\n//# sourceMappingURL=search.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Settings = createLucideIcon(\"Settings\", [\n  [\n    \"path\",\n    {\n      d: \"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\",\n      key: \"1qme2f\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n]);\n\nexport { Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Share = createLucideIcon(\"Share\", [\n  [\"path\", { d: \"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8\", key: \"1b2hhj\" }],\n  [\"polyline\", { points: \"16 6 12 2 8 6\", key: \"m901s6\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"15\", key: \"1p0rca\" }]\n]);\n\nexport { Share as default };\n//# sourceMappingURL=share.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Shield = createLucideIcon(\"Shield\", [\n  [\"path\", { d: \"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10\", key: \"1irkt0\" }]\n]);\n\nexport { Shield as default };\n//# sourceMappingURL=shield.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Smartphone = createLucideIcon(\"Smartphone\", [\n  [\"rect\", { width: \"14\", height: \"20\", x: \"5\", y: \"2\", rx: \"2\", ry: \"2\", key: \"1yt0o3\" }],\n  [\"path\", { d: \"M12 18h.01\", key: \"mhygvu\" }]\n]);\n\nexport { Smartphone as default };\n//# sourceMappingURL=smartphone.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Sparkles = createLucideIcon(\"Sparkles\", [\n  [\n    \"path\",\n    {\n      d: \"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z\",\n      key: \"17u4zn\"\n    }\n  ],\n  [\"path\", { d: \"M5 3v4\", key: \"bklmnn\" }],\n  [\"path\", { d: \"M19 17v4\", key: \"iiml17\" }],\n  [\"path\", { d: \"M3 5h4\", key: \"nem4j1\" }],\n  [\"path\", { d: \"M17 19h4\", key: \"lbex7p\" }]\n]);\n\nexport { Sparkles as default };\n//# sourceMappingURL=sparkles.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Tag = createLucideIcon(\"Tag\", [\n  [\n    \"path\",\n    {\n      d: \"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z\",\n      key: \"14b2ls\"\n    }\n  ],\n  [\"path\", { d: \"M7 7h.01\", key: \"7u93v4\" }]\n]);\n\nexport { Tag as default };\n//# sourceMappingURL=tag.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Target = createLucideIcon(\"Target\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"6\", key: \"1vlfrh\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"2\", key: \"1c9p78\" }]\n]);\n\nexport { Target as default };\n//# sourceMappingURL=target.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ToggleLeft = createLucideIcon(\"ToggleLeft\", [\n  [\"rect\", { width: \"20\", height: \"12\", x: \"2\", y: \"6\", rx: \"6\", ry: \"6\", key: \"f2vt7d\" }],\n  [\"circle\", { cx: \"8\", cy: \"12\", r: \"2\", key: \"1nvbw3\" }]\n]);\n\nexport { ToggleLeft as default };\n//# sourceMappingURL=toggle-left.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ToggleRight = createLucideIcon(\"ToggleRight\", [\n  [\"rect\", { width: \"20\", height: \"12\", x: \"2\", y: \"6\", rx: \"6\", ry: \"6\", key: \"f2vt7d\" }],\n  [\"circle\", { cx: \"16\", cy: \"12\", r: \"2\", key: \"4ma0v8\" }]\n]);\n\nexport { ToggleRight as default };\n//# sourceMappingURL=toggle-right.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst TrendingDown = createLucideIcon(\"TrendingDown\", [\n  [\"polyline\", { points: \"22 17 13.5 8.5 8.5 13.5 2 7\", key: \"1r2t7k\" }],\n  [\"polyline\", { points: \"16 17 22 17 22 11\", key: \"11uiuu\" }]\n]);\n\nexport { TrendingDown as default };\n//# sourceMappingURL=trending-down.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst TrendingUp = createLucideIcon(\"TrendingUp\", [\n  [\"polyline\", { points: \"22 7 13.5 15.5 8.5 10.5 2 17\", key: \"126l90\" }],\n  [\"polyline\", { points: \"16 7 22 7 22 13\", key: \"kwv8wd\" }]\n]);\n\nexport { TrendingUp as default };\n//# sourceMappingURL=trending-up.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Trophy = createLucideIcon(\"Trophy\", [\n  [\"path\", { d: \"M6 9H4.5a2.5 2.5 0 0 1 0-5H6\", key: \"17hqa7\" }],\n  [\"path\", { d: \"M18 9h1.5a2.5 2.5 0 0 0 0-5H18\", key: \"lmptdp\" }],\n  [\"path\", { d: \"M4 22h16\", key: \"57wxv0\" }],\n  [\"path\", { d: \"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22\", key: \"1nw9bq\" }],\n  [\"path\", { d: \"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22\", key: \"1np0yb\" }],\n  [\"path\", { d: \"M18 2H6v7a6 6 0 0 0 12 0V2Z\", key: \"u46fv3\" }]\n]);\n\nexport { Trophy as default };\n//# sourceMappingURL=trophy.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst User = createLucideIcon(\"User\", [\n  [\"path\", { d: \"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\", key: \"975kel\" }],\n  [\"circle\", { cx: \"12\", cy: \"7\", r: \"4\", key: \"17ys0d\" }]\n]);\n\nexport { User as default };\n//# sourceMappingURL=user.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Users = createLucideIcon(\"Users\", [\n  [\"path\", { d: \"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\", key: \"1yyitq\" }],\n  [\"circle\", { cx: \"9\", cy: \"7\", r: \"4\", key: \"nufk8\" }],\n  [\"path\", { d: \"M22 21v-2a4 4 0 0 0-3-3.87\", key: \"kshegd\" }],\n  [\"path\", { d: \"M16 3.13a4 4 0 0 1 0 7.75\", key: \"1da9ce\" }]\n]);\n\nexport { Users as default };\n//# sourceMappingURL=users.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Wallet = createLucideIcon(\"Wallet\", [\n  [\"path\", { d: \"M21 12V7H5a2 2 0 0 1 0-4h14v4\", key: \"195gfw\" }],\n  [\"path\", { d: \"M3 5v14a2 2 0 0 0 2 2h16v-5\", key: \"195n9w\" }],\n  [\"path\", { d: \"M18 12a2 2 0 0 0 0 4h4v-4Z\", key: \"vllfpd\" }]\n]);\n\nexport { Wallet as default };\n//# sourceMappingURL=wallet.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Wrench = createLucideIcon(\"Wrench\", [\n  [\n    \"path\",\n    {\n      d: \"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\",\n      key: \"cbrjhi\"\n    }\n  ]\n]);\n\nexport { Wrench as default };\n//# sourceMappingURL=wrench.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst XCircle = createLucideIcon(\"XCircle\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m15 9-6 6\", key: \"1uzhvr\" }],\n  [\"path\", { d: \"m9 9 6 6\", key: \"z0biqf\" }]\n]);\n\nexport { XCircle as default };\n//# sourceMappingURL=x-circle.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst X = createLucideIcon(\"X\", [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n]);\n\nexport { X as default };\n//# sourceMappingURL=x.js.map\n","/**\n * @license lucide-react v0.303.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Zap = createLucideIcon(\"Zap\", [\n  [\"polygon\", { points: \"13 2 3 14 12 14 11 22 21 10 12 10 13 2\", key: \"45s27k\" }]\n]);\n\nexport { Zap as default };\n//# sourceMappingURL=zap.js.map\n","/**\n * Accessibility utilities for FCZ application\n * Implements WCAG 2.1 AA standards for focus management, keyboard navigation, and ARIA\n */\n\nexport type FocusableElement = HTMLElement | HTMLInputElement | HTMLButtonElement | HTMLSelectElement | HTMLTextAreaElement;\n\n/**\n * Focus trap utility for modals and dialogs\n */\nexport class FocusTrap {\n  private element: HTMLElement;\n  private focusableElements: FocusableElement[];\n  private firstFocusableElement: FocusableElement | null = null;\n  private lastFocusableElement: FocusableElement | null = null;\n  private previousActiveElement: Element | null = null;\n\n  constructor(element: HTMLElement) {\n    this.element = element;\n    this.focusableElements = [];\n    this.updateFocusableElements();\n  }\n\n  private updateFocusableElements() {\n    const focusableSelector = [\n      'button:not([disabled])',\n      'input:not([disabled])',\n      'select:not([disabled])',\n      'textarea:not([disabled])',\n      'a[href]',\n      '[tabindex]:not([tabindex=\"-1\"])',\n      '[contenteditable=\"true\"]'\n    ].join(',');\n\n    this.focusableElements = Array.from(\n      this.element.querySelectorAll(focusableSelector)\n    ) as FocusableElement[];\n\n    this.firstFocusableElement = this.focusableElements[0] || null;\n    this.lastFocusableElement = this.focusableElements[this.focusableElements.length - 1] || null;\n  }\n\n  activate() {\n    this.previousActiveElement = document.activeElement;\n    this.updateFocusableElements();\n    \n    // Focus first element with a small delay to ensure modal is rendered\n    setTimeout(() => {\n      if (this.firstFocusableElement) {\n        this.firstFocusableElement.focus();\n      }\n    }, 50);\n\n    document.addEventListener('keydown', this.handleKeyDown);\n  }\n\n  deactivate() {\n    document.removeEventListener('keydown', this.handleKeyDown);\n    \n    // Restore focus to previous element\n    if (this.previousActiveElement && 'focus' in this.previousActiveElement) {\n      (this.previousActiveElement as HTMLElement).focus();\n    }\n  }\n\n  private handleKeyDown = (event: KeyboardEvent) => {\n    if (event.key !== 'Tab') return;\n\n    this.updateFocusableElements();\n\n    if (this.focusableElements.length === 0) {\n      event.preventDefault();\n      return;\n    }\n\n    if (this.focusableElements.length === 1) {\n      event.preventDefault();\n      this.firstFocusableElement?.focus();\n      return;\n    }\n\n    if (event.shiftKey) {\n      // Shift + Tab (moving backwards)\n      if (document.activeElement === this.firstFocusableElement) {\n        event.preventDefault();\n        this.lastFocusableElement?.focus();\n      }\n    } else {\n      // Tab (moving forwards)\n      if (document.activeElement === this.lastFocusableElement) {\n        event.preventDefault();\n        this.firstFocusableElement?.focus();\n      }\n    }\n  };\n}\n\n/**\n * Keyboard navigation utilities\n */\nexport const KeyboardNavigation = {\n  /**\n   * Handle arrow key navigation in lists\n   */\n  handleArrowKeys: (\n    event: KeyboardEvent,\n    currentIndex: number,\n    totalItems: number,\n    onIndexChange: (newIndex: number) => void,\n    orientation: 'horizontal' | 'vertical' = 'vertical'\n  ) => {\n    const isVertical = orientation === 'vertical';\n    const upKey = isVertical ? 'ArrowUp' : 'ArrowLeft';\n    const downKey = isVertical ? 'ArrowDown' : 'ArrowRight';\n\n    switch (event.key) {\n      case upKey:\n        event.preventDefault();\n        onIndexChange(currentIndex > 0 ? currentIndex - 1 : totalItems - 1);\n        break;\n      case downKey:\n        event.preventDefault();\n        onIndexChange(currentIndex < totalItems - 1 ? currentIndex + 1 : 0);\n        break;\n      case 'Home':\n        event.preventDefault();\n        onIndexChange(0);\n        break;\n      case 'End':\n        event.preventDefault();\n        onIndexChange(totalItems - 1);\n        break;\n    }\n  },\n\n  /**\n   * Handle escape key for closing modals/dropdowns\n   */\n  handleEscape: (event: KeyboardEvent, onEscape: () => void) => {\n    if (event.key === 'Escape') {\n      event.preventDefault();\n      onEscape();\n    }\n  },\n\n  /**\n   * Handle Enter and Space for button-like elements\n   */\n  handleActivation: (event: KeyboardEvent, onActivate: () => void) => {\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      onActivate();\n    }\n  }\n};\n\n/**\n * ARIA utilities for screen readers\n */\nexport const AriaUtils = {\n  /**\n   * Generate unique IDs for ARIA relationships\n   */\n  generateId: (prefix: string = 'fcz'): string => {\n    return `${prefix}-${Math.random().toString(36).substr(2, 9)}`;\n  },\n\n  /**\n   * Create ARIA live region announcements\n   */\n  announce: (message: string, priority: 'polite' | 'assertive' = 'polite') => {\n    const announcement = document.createElement('div');\n    announcement.setAttribute('aria-live', priority);\n    announcement.setAttribute('aria-atomic', 'true');\n    announcement.className = 'sr-only';\n    announcement.textContent = message;\n    \n    document.body.appendChild(announcement);\n    \n    // Remove after announcement is made\n    setTimeout(() => {\n      if (announcement.parentNode) {\n        document.body.removeChild(announcement);\n      }\n    }, 1000);\n  },\n\n  /**\n   * Set expanded state for collapsible elements\n   */\n  setExpanded: (element: HTMLElement, expanded: boolean) => {\n    element.setAttribute('aria-expanded', expanded.toString());\n  },\n\n  /**\n   * Set selected state for selectable elements\n   */\n  setSelected: (element: HTMLElement, selected: boolean) => {\n    element.setAttribute('aria-selected', selected.toString());\n  },\n\n  /**\n   * Set pressed state for toggle buttons\n   */\n  setPressed: (element: HTMLElement, pressed: boolean) => {\n    element.setAttribute('aria-pressed', pressed.toString());\n  }\n};\n\n/**\n * Focus restoration utility for SPAs\n */\nexport class FocusManager {\n  private static focusStack: Element[] = [];\n\n  static saveFocus() {\n    const activeElement = document.activeElement;\n    if (activeElement) {\n      this.focusStack.push(activeElement);\n    }\n  }\n\n  static restoreFocus() {\n    const previousFocus = this.focusStack.pop();\n    if (previousFocus && 'focus' in previousFocus) {\n      setTimeout(() => {\n        (previousFocus as HTMLElement).focus();\n      }, 50);\n    }\n  }\n\n  static clearStack() {\n    this.focusStack = [];\n  }\n}\n\n/**\n * Skip link utility for keyboard navigation\n */\nexport const createSkipLink = (targetId: string, text: string = 'Skip to main content') => {\n  const skipLink = document.createElement('a');\n  skipLink.href = `#${targetId}`;\n  skipLink.textContent = text;\n  skipLink.className = 'sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:rounded-md';\n  \n  skipLink.addEventListener('click', (event) => {\n    event.preventDefault();\n    const target = document.getElementById(targetId);\n    if (target) {\n      target.focus();\n      target.scrollIntoView({ behavior: 'smooth' });\n    }\n  });\n\n  return skipLink;\n};\n\n/**\n * High contrast mode detection\n */\nexport const isHighContrastMode = (): boolean => {\n  return window.matchMedia('(prefers-contrast: high)').matches;\n};\n\n/**\n * Reduced motion detection\n */\nexport const prefersReducedMotion = (): boolean => {\n  return window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n};\n\n/**\n * Screen reader detection (heuristic)\n */\nexport const isScreenReaderActive = (): boolean => {\n  // Check for common screen reader indicators\n  return !!(\n    (window as any).speechSynthesis ||\n    (window as any).navigator?.userAgent?.includes('NVDA') ||\n    (window as any).navigator?.userAgent?.includes('JAWS') ||\n    document.querySelector('[role=\"region\"][aria-live]')\n  );\n};\n\nexport default {\n  FocusTrap,\n  KeyboardNavigation,\n  AriaUtils,\n  FocusManager,\n  createSkipLink,\n  isHighContrastMode,\n  prefersReducedMotion,\n  isScreenReaderActive\n};\n","import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\n\ninterface NetworkStatusContextType {\n  isOnline: boolean;\n  isSlowConnection: boolean;\n}\n\nconst NetworkStatusContext = createContext<NetworkStatusContextType | undefined>(undefined);\n\nexport const useNetworkStatus = () => {\n  const context = useContext(NetworkStatusContext);\n  if (context === undefined) {\n    throw new Error('useNetworkStatus must be used within a NetworkStatusProvider');\n  }\n  return context;\n};\n\ninterface NetworkStatusProviderProps {\n  children: ReactNode;\n}\n\nexport const NetworkStatusProvider: React.FC<NetworkStatusProviderProps> = ({ children }) => {\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n  const [isSlowConnection, setIsSlowConnection] = useState(false);\n\n  useEffect(() => {\n    const handleOnline = () => {\n      setIsOnline(true);\n      console.log(' Network: Online');\n    };\n\n    const handleOffline = () => {\n      setIsOnline(false);\n      console.log(' Network: Offline');\n    };\n\n    // Listen for online/offline events\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    // Check connection speed if available\n    const checkConnectionSpeed = () => {\n      if ('connection' in navigator) {\n        const connection = (navigator as any).connection;\n        if (connection) {\n          const isSlow = connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g';\n          setIsSlowConnection(isSlow);\n          \n          if (isSlow) {\n            console.log(' Network: Slow connection detected');\n          }\n        }\n      }\n    };\n\n    checkConnectionSpeed();\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  const value: NetworkStatusContextType = {\n    isOnline,\n    isSlowConnection,\n  };\n\n  return (\n    <NetworkStatusContext.Provider value={value}>\n      {children}\n    </NetworkStatusContext.Provider>\n  );\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { X, Mail, Loader2, CheckCircle } from 'lucide-react';\nimport { FocusTrap, AriaUtils, KeyboardNavigation } from '../../utils/accessibility';\n\ninterface EmailInputModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSubmit: (email: string) => Promise<void>;\n  title?: string;\n  description?: string;\n  submitLabel?: string;\n}\n\nconst EmailInputModal: React.FC<EmailInputModalProps> = ({\n  isOpen,\n  onClose,\n  onSubmit,\n  title = 'Enter your email address',\n  description = 'We\\'ll send you a secure sign-in link.',\n  submitLabel = 'Send Link'\n}) => {\n  const [email, setEmail] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState('');\n  const [showSuccess, setShowSuccess] = useState(false);\n  const modalRef = useRef<HTMLDivElement>(null);\n  const emailInputRef = useRef<HTMLInputElement>(null);\n  const focusTrapRef = useRef<FocusTrap | null>(null);\n  const [modalId] = useState(() => AriaUtils.generateId('email-modal'));\n\n  // Focus management and accessibility\n  useEffect(() => {\n    if (isOpen && modalRef.current) {\n      // Reset state\n      setEmail('');\n      setError('');\n      setIsSubmitting(false);\n      setShowSuccess(false);\n      \n      // Initialize focus trap\n      focusTrapRef.current = new FocusTrap(modalRef.current);\n      focusTrapRef.current.activate();\n      \n      // Announce modal opening to screen readers\n      AriaUtils.announce(`${title} dialog opened`);\n      \n      return () => {\n        if (focusTrapRef.current) {\n          focusTrapRef.current.deactivate();\n          focusTrapRef.current = null;\n        }\n      };\n    }\n  }, [isOpen, title]);\n\n  // Handle keyboard interactions\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      KeyboardNavigation.handleEscape(event, onClose);\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, onClose]);\n\n  const validateEmail = (email: string) => {\n    if (!email) return 'Email is required.';\n    if (!/\\S+@\\S+\\.\\S+/.test(email)) return 'Please enter a valid email address.';\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    const validationError = validateEmail(email);\n    if (validationError) {\n      setError(validationError);\n      return;\n    }\n\n    setIsSubmitting(true);\n    setError('');\n\n    try {\n      await onSubmit(email.trim());\n      setShowSuccess(true);\n      // Auto-close after showing success for 3 seconds\n      setTimeout(() => {\n        onClose();\n      }, 3000);\n    } catch (error) {\n      setError(error instanceof Error ? error.message : 'Failed to send email');\n      setIsSubmitting(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\n      style={{ pointerEvents: isOpen ? 'auto' : 'none' }}\n    >\n      {/* Backdrop */}\n      <div\n        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n        onClick={showSuccess ? undefined : onClose}\n      />\n\n      {/* Modal */}\n      <div\n        ref={modalRef}\n        className=\"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={`${modalId}-title`}\n        aria-describedby={`${modalId}-description`}\n        aria-live=\"polite\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">\n          <div>\n            <h2 id={`${modalId}-title`} className=\"text-xl font-semibold text-gray-900\">\n              {showSuccess ? 'Check your email!' : title}\n            </h2>\n            <p id={`${modalId}-description`} className=\"text-sm text-gray-600 mt-1\">\n              {showSuccess ? `We sent a sign-in link to ${email}` : description}\n            </p>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n            aria-label=\"Close modal\"\n            disabled={isSubmitting}\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        {showSuccess ? (\n          // Success State\n          <div className=\"p-6 text-center\">\n            <div className=\"mx-auto flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4\">\n              <CheckCircle className=\"w-8 h-8 text-emerald-600\" />\n            </div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n              Sign-in link sent!\n            </h3>\n            <p className=\"text-gray-600 leading-relaxed mb-4\">\n              Click the link in your email to sign in. The link will expire in 1 hour for security.\n            </p>\n            <div className=\"bg-gray-50 rounded-lg p-4 mb-4\">\n              <p className=\"text-sm text-gray-700\">\n                <strong>Sent to:</strong> {email}\n              </p>\n            </div>\n            <p className=\"text-xs text-gray-500\">\n              Didn't receive it? Check your spam folder or close this to try again.\n            </p>\n          </div>\n        ) : (\n          // Form State\n          <form onSubmit={handleSubmit} className=\"p-6\">\n            <div className=\"space-y-4\">\n              {/* Email Input */}\n              <div>\n                <label htmlFor=\"email-input\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Email Address\n                </label>\n                <div className=\"relative\">\n                  <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                    <Mail className=\"h-5 w-5 text-gray-400\" />\n                  </div>\n                  <input\n                    ref={emailInputRef}\n                    id=\"email-input\"\n                    type=\"email\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    className={`block w-full pl-10 pr-3 py-3 border rounded-xl focus:ring-2 focus:ring-emerald-500 transition-colors ${\n                      error ? 'border-red-500 focus:border-red-500' : 'border-gray-300 focus:border-emerald-500'\n                    }`}\n                    placeholder=\"your@email.com\"\n                    disabled={isSubmitting}\n                    autoComplete=\"email\"\n                  />\n                </div>\n                {error && (\n                  <p className=\"mt-2 text-sm text-red-600\" role=\"alert\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              {/* Submit Button */}\n              <button\n                type=\"submit\"\n                disabled={isSubmitting || !email.trim()}\n                className=\"w-full flex items-center justify-center gap-3 bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white py-3 px-6 rounded-xl font-semibold transition-colors shadow-lg\"\n              >\n                {isSubmitting ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 animate-spin\" />\n                    Sending...\n                  </>\n                ) : (\n                  <>\n                    <Mail className=\"w-5 h-5\" />\n                    {submitLabel}\n                  </>\n                )}\n              </button>\n            </div>\n          </form>\n        )}\n\n        {/* Footer */}\n        {!showSuccess && (\n          <div className=\"px-6 pb-6\">\n            <p className=\"text-xs text-gray-500 text-center\">\n              By continuing, you agree to our Terms of Service and Privacy Policy.\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default EmailInputModal;","import React, { useEffect, useRef, useState } from 'react';\nimport { X, Mail, Chrome } from 'lucide-react';\nimport { FocusTrap, AriaUtils, KeyboardNavigation } from '../../utils/accessibility';\nimport { useAuthGate, resolveAuthGate } from '../../auth/authGateAdapter';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { useNetworkStatus } from '../../providers/NetworkStatusProvider';\nimport { INTENT_MAP, FALLBACK_INTENT } from '../../auth/authIntents';\nimport EmailInputModal from './EmailInputModal';\n\nconst AuthGateModal: React.FC = () => {\n  const { isOpen, pendingIntent, intentMeta } = useAuthGate();\n  const { signInWithGoogle, signInWithEmailLink, user } = useAuthSession();\n  const { isOnline } = useNetworkStatus();\n  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);\n  \n  const modalRef = useRef<HTMLDivElement>(null);\n  const firstButtonRef = useRef<HTMLButtonElement>(null);\n  const focusTrapRef = useRef<FocusTrap | null>(null);\n  const [modalId] = useState(() => AriaUtils.generateId('auth-modal'));\n\n  // Compute displayMeta with fallback as per spec - ALWAYS render when isOpen is true\n  const displayMeta = \n    intentMeta ?? \n    (pendingIntent ? INTENT_MAP[pendingIntent] : undefined) ?? \n    FALLBACK_INTENT;\n\n  // Focus management with accessibility\n  useEffect(() => {\n    if (isOpen && modalRef.current) {\n      // Initialize focus trap\n      focusTrapRef.current = new FocusTrap(modalRef.current);\n      focusTrapRef.current.activate();\n      \n      // Announce modal opening to screen readers\n      AriaUtils.announce(`${displayMeta.title} dialog opened`);\n      \n      return () => {\n        if (focusTrapRef.current) {\n          focusTrapRef.current.deactivate();\n          focusTrapRef.current = null;\n        }\n      };\n    }\n  }, [isOpen, displayMeta.title]);\n\n  // Handle keyboard interactions\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!isOpen) return;\n      \n      KeyboardNavigation.handleEscape(e, handleClose);\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n      return () => document.removeEventListener('keydown', handleKeyDown);\n    }\n  }, [isOpen]);\n\n  // Handle successful authentication - resolve with success\n  useEffect(() => {\n    if (user && isOpen) {\n      if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n        console.log('[FCZ-QA] User authenticated, resolving auth gate');\n      }\n      resolveAuthGate({ status: 'success' });\n    }\n  }, [user, isOpen]);\n\n  // Handle modal close\n  const handleClose = () => {\n    if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n      console.log('[FCZ-QA] Auth modal closed by user');\n    }\n    resolveAuthGate({ status: 'cancel' });\n  };\n\n  // Handle Google sign in\n  const handleGoogleSignIn = async () => {\n    if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n      console.log('[FCZ-QA] Google sign in attempt');\n    }\n    \n    try {\n      const { error } = await signInWithGoogle();\n      if (error) {\n        console.error('Google sign in error:', error);\n        resolveAuthGate({ \n          status: 'error', \n          reason: error.message || 'Google sign in failed' \n        });\n      }\n      // Success case handled by useEffect above\n    } catch (error) {\n      console.error('Google sign in exception:', error);\n      resolveAuthGate({ \n        status: 'error', \n        reason: error instanceof Error ? error.message : 'Unknown error' \n      });\n    }\n  };\n\n  // Handle email link sign in\n  const handleEmailLinkSignIn = () => {\n    if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n      console.log('[FCZ-QA] Opening email input modal');\n    }\n    setIsEmailModalOpen(true);\n  };\n\n  const handleEmailSubmit = async (email: string) => {\n    if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n      console.log('[FCZ-QA] Email sign in attempt with:', email);\n    }\n    \n    try {\n      const { error } = await signInWithEmailLink(email);\n      if (error) {\n        console.error('Email sign in error:', error);\n        throw new Error(error.message || 'Email sign in failed');\n      } else {\n        // Success - close email modal and main modal\n        setIsEmailModalOpen(false);\n        resolveAuthGate({ status: 'success' });\n      }\n    } catch (error) {\n      console.error('Email sign in exception:', error);\n      throw error; // Re-throw to let EmailInputModal handle it\n    }\n  };\n\n  // Don't render if modal is not open - NEVER early-return for missing intentMeta\n  if (!isOpen) return null;\n\n  const isOffline = !isOnline;\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\n      style={{ \n        pointerEvents: isOpen ? 'auto' : 'none' // Ensure no pointer-event bleed when closed\n      }}\n    >\n      {/* Backdrop */}\n      <div\n        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n        onClick={handleClose}\n      />\n\n      {/* Modal */}\n      <div\n        ref={modalRef}\n        className=\"relative w-full max-w-md bg-white rounded-2xl shadow-2xl\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={`${modalId}-title`}\n        aria-describedby={`${modalId}-description`}\n        aria-live=\"polite\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">\n          <div>\n            <h2 id={`${modalId}-title`} className=\"text-xl font-semibold text-gray-900\">\n              {displayMeta.title}\n            </h2>\n            <p id={`${modalId}-description`} className=\"text-sm text-gray-600 mt-1\">\n              {displayMeta.description}\n            </p>\n          </div>\n          <button\n            onClick={handleClose}\n            className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n            aria-label=\"Close modal\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6\">\n          <div className=\"space-y-4\">\n            {/* Primary CTA - Always show Google as primary */}\n            <button\n              ref={firstButtonRef}\n              onClick={handleGoogleSignIn}\n              disabled={isOffline}\n              className=\"w-full flex items-center justify-center gap-3 bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-300 text-white py-4 px-6 rounded-xl font-semibold transition-colors disabled:cursor-not-allowed shadow-lg relative group\"\n              data-qa=\"auth-gate-google\"\n              title=\"You'll sign in with Google to FanClubZ\"\n            >\n              <Chrome className=\"w-5 h-5\" />\n              {displayMeta.primaryCta}\n            </button>\n            \n            {/* Divider */}\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <div className=\"w-full border-t border-gray-200\" />\n              </div>\n              <div className=\"relative flex justify-center text-sm\">\n                <span className=\"px-2 bg-white text-gray-500\">or</span>\n              </div>\n            </div>\n            \n            {/* Secondary CTA - Always show Email as secondary */}\n            <button\n              onClick={handleEmailLinkSignIn}\n              disabled={isOffline}\n              className=\"w-full flex items-center justify-center gap-3 bg-white border-2 border-gray-200 hover:bg-gray-50 hover:border-gray-300 disabled:bg-gray-100 disabled:border-gray-200 text-gray-700 py-4 px-6 rounded-xl font-semibold transition-colors disabled:cursor-not-allowed\"\n              data-qa=\"auth-gate-email\"\n            >\n              <Mail className=\"w-5 h-5\" />\n              {displayMeta.secondaryCta}\n            </button>\n\n            {/* Offline message */}\n            {isOffline && (\n              <div className=\"text-center py-2\">\n                <p className=\"text-sm text-orange-600 bg-orange-50 px-3 py-2 rounded-lg\">\n                  You're offline. Try again when you're back online.\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n\n         {/* Footer */}\n         <div className=\"px-6 pb-6\">\n           <p className=\"text-xs text-gray-500 text-center\">\n             By continuing, you agree to FanClubZ's Terms of Service and Privacy Policy.\n           </p>\n         </div>\n       </div>\n\n       {/* Email Input Modal */}\n       <EmailInputModal\n         isOpen={isEmailModalOpen}\n         onClose={() => setIsEmailModalOpen(false)}\n         onSubmit={handleEmailSubmit}\n         title=\"Continue with Email\"\n         description=\"Enter your email address and we'll send you a secure sign-in link.\"\n         submitLabel=\"Send Sign-in Link\"\n       />\n     </div>\n   );\n };\n \n export default AuthGateModal;\n","let e={data:\"\"},t=t=>{if(\"object\"==typeof window){let e=(t?t.querySelector(\"#_goober\"):window._goober)||Object.assign(document.createElement(\"style\"),{innerHTML:\" \",id:\"_goober\"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||e},r=e=>{let r=t(e),l=r.data;return r.data=\"\",l},l=/(?:([\\u0080-\\uFFFF\\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\\s*)/g,a=/\\/\\*[^]*?\\*\\/|  +/g,n=/\\n+/g,o=(e,t)=>{let r=\"\",l=\"\",a=\"\";for(let n in e){let c=e[n];\"@\"==n[0]?\"i\"==n[1]?r=n+\" \"+c+\";\":l+=\"f\"==n[1]?o(c,n):n+\"{\"+o(c,\"k\"==n[1]?\"\":t)+\"}\":\"object\"==typeof c?l+=o(c,t?t.replace(/([^,])+/g,e=>n.replace(/([^,]*:\\S+\\([^)]*\\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+\" \"+t:t)):n):null!=c&&(n=/^--/.test(n)?n:n.replace(/[A-Z]/g,\"-$&\").toLowerCase(),a+=o.p?o.p(n,c):n+\":\"+c+\";\")}return r+(t&&a?t+\"{\"+a+\"}\":a)+l},c={},s=e=>{if(\"object\"==typeof e){let t=\"\";for(let r in e)t+=r+s(e[r]);return t}return e},i=(e,t,r,i,p)=>{let u=s(e),d=c[u]||(c[u]=(e=>{let t=0,r=11;for(;t<e.length;)r=101*r+e.charCodeAt(t++)>>>0;return\"go\"+r})(u));if(!c[d]){let t=u!==e?e:(e=>{let t,r,o=[{}];for(;t=l.exec(e.replace(a,\"\"));)t[4]?o.shift():t[3]?(r=t[3].replace(n,\" \").trim(),o.unshift(o[0][r]=o[0][r]||{})):o[0][t[1]]=t[2].replace(n,\" \").trim();return o[0]})(e);c[d]=o(p?{[\"@keyframes \"+d]:t}:t,r?\"\":\".\"+d)}let f=r&&c.g?c.g:null;return r&&(c.g=c[d]),((e,t,r,l)=>{l?t.data=t.data.replace(l,e):-1===t.data.indexOf(e)&&(t.data=r?e+t.data:t.data+e)})(c[d],t,i,f),d},p=(e,t,r)=>e.reduce((e,l,a)=>{let n=t[a];if(n&&n.call){let e=n(r),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;n=t?\".\"+t:e&&\"object\"==typeof e?e.props?\"\":o(e,\"\"):!1===e?\"\":e}return e+l+(null==n?\"\":n)},\"\");function u(e){let r=this||{},l=e.call?e(r.p):e;return i(l.unshift?l.raw?p(l,[].slice.call(arguments,1),r.p):l.reduce((e,t)=>Object.assign(e,t&&t.call?t(r.p):t),{}):l,t(r.target),r.g,r.o,r.k)}let d,f,g,b=u.bind({g:1}),h=u.bind({k:1});function m(e,t,r,l){o.p=t,d=e,f=r,g=l}function w(e,t){let r=this||{};return function(){let l=arguments;function a(n,o){let c=Object.assign({},n),s=c.className||a.className;r.p=Object.assign({theme:f&&f()},c),r.o=/ *go\\d+/.test(s),c.className=u.apply(r,l)+(s?\" \"+s:\"\"),t&&(c.ref=o);let i=e;return e[0]&&(i=c.as||e,delete c.as),g&&i[0]&&g(c),d(i,c)}return t?t(a):a}}export{u as css,r as extractCss,b as glob,h as keyframes,m as setup,w as styled};\n","\"use client\";\nvar Z=e=>typeof e==\"function\",h=(e,t)=>Z(e)?e(t):e;var W=(()=>{let e=0;return()=>(++e).toString()})(),E=(()=>{let e;return()=>{if(e===void 0&&typeof window<\"u\"){let t=matchMedia(\"(prefers-reduced-motion: reduce)\");e=!t||t.matches}return e}})();import{useEffect as ee,useState as te,useRef as oe}from\"react\";var re=20,k=\"default\";var H=(e,t)=>{let{toastLimit:o}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,o)};case 1:return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case 2:let{toast:s}=t;return H(e,{type:e.toasts.find(r=>r.id===s.id)?1:0,toast:s});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(r=>r.id===a||a===void 0?{...r,dismissed:!0,visible:!1}:r)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(r=>({...r,pauseDuration:r.pauseDuration+i}))}}},v=[],j={toasts:[],pausedAt:void 0,settings:{toastLimit:re}},f={},Y=(e,t=k)=>{f[t]=H(f[t]||j,e),v.forEach(([o,s])=>{o===t&&s(f[t])})},_=e=>Object.keys(f).forEach(t=>Y(e,t)),Q=e=>Object.keys(f).find(t=>f[t].toasts.some(o=>o.id===e)),S=(e=k)=>t=>{Y(t,e)},se={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},V=(e={},t=k)=>{let[o,s]=te(f[t]||j),a=oe(f[t]);ee(()=>(a.current!==f[t]&&s(f[t]),v.push([t,s]),()=>{let r=v.findIndex(([l])=>l===t);r>-1&&v.splice(r,1)}),[t]);let i=o.toasts.map(r=>{var l,g,T;return{...e,...e[r.type],...r,removeDelay:r.removeDelay||((l=e[r.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:r.duration||((g=e[r.type])==null?void 0:g.duration)||(e==null?void 0:e.duration)||se[r.type],style:{...e.style,...(T=e[r.type])==null?void 0:T.style,...r.style}}});return{...o,toasts:i}};var ie=(e,t=\"blank\",o)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:\"status\",\"aria-live\":\"polite\"},message:e,pauseDuration:0,...o,id:(o==null?void 0:o.id)||W()}),P=e=>(t,o)=>{let s=ie(t,e,o);return S(s.toasterId||Q(s.id))({type:2,toast:s}),s.id},n=(e,t)=>P(\"blank\")(e,t);n.error=P(\"error\");n.success=P(\"success\");n.loading=P(\"loading\");n.custom=P(\"custom\");n.dismiss=(e,t)=>{let o={type:3,toastId:e};t?S(t)(o):_(o)};n.dismissAll=e=>n.dismiss(void 0,e);n.remove=(e,t)=>{let o={type:4,toastId:e};t?S(t)(o):_(o)};n.removeAll=e=>n.remove(void 0,e);n.promise=(e,t,o)=>{let s=n.loading(t.loading,{...o,...o==null?void 0:o.loading});return typeof e==\"function\"&&(e=e()),e.then(a=>{let i=t.success?h(t.success,a):void 0;return i?n.success(i,{id:s,...o,...o==null?void 0:o.success}):n.dismiss(s),a}).catch(a=>{let i=t.error?h(t.error,a):void 0;i?n.error(i,{id:s,...o,...o==null?void 0:o.error}):n.dismiss(s)}),e};import{useEffect as X,useCallback as A,useRef as ne}from\"react\";var ce=1e3,w=(e,t=\"default\")=>{let{toasts:o,pausedAt:s}=V(e,t),a=ne(new Map).current,i=A((c,m=ce)=>{if(a.has(c))return;let p=setTimeout(()=>{a.delete(c),r({type:4,toastId:c})},m);a.set(c,p)},[]);X(()=>{if(s)return;let c=Date.now(),m=o.map(p=>{if(p.duration===1/0)return;let R=(p.duration||0)+p.pauseDuration-(c-p.createdAt);if(R<0){p.visible&&n.dismiss(p.id);return}return setTimeout(()=>n.dismiss(p.id,t),R)});return()=>{m.forEach(p=>p&&clearTimeout(p))}},[o,s,t]);let r=A(S(t),[t]),l=A(()=>{r({type:5,time:Date.now()})},[r]),g=A((c,m)=>{r({type:1,toast:{id:c,height:m}})},[r]),T=A(()=>{s&&r({type:6,time:Date.now()})},[s,r]),d=A((c,m)=>{let{reverseOrder:p=!1,gutter:R=8,defaultPosition:z}=m||{},O=o.filter(u=>(u.position||z)===(c.position||z)&&u.height),K=O.findIndex(u=>u.id===c.id),B=O.filter((u,I)=>I<K&&u.visible).length;return O.filter(u=>u.visible).slice(...p?[B+1]:[0,B]).reduce((u,I)=>u+(I.height||0)+R,0)},[o]);return X(()=>{o.forEach(c=>{if(c.dismissed)i(c.id,c.removeDelay);else{let m=a.get(c.id);m&&(clearTimeout(m),a.delete(c.id))}})},[o,i]),{toasts:o,handlers:{updateHeight:g,startPause:l,endPause:T,calculateOffset:d}}};import*as y from\"react\";import{styled as J,keyframes as G}from\"goober\";import*as b from\"react\";import{styled as U,keyframes as xe}from\"goober\";import{styled as pe,keyframes as M}from\"goober\";var de=M`\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n transform: scale(1) rotate(45deg);\n  opacity: 1;\n}`,me=M`\nfrom {\n  transform: scale(0);\n  opacity: 0;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}`,le=M`\nfrom {\n  transform: scale(0) rotate(90deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(90deg);\n\topacity: 1;\n}`,C=pe(\"div\")`\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ${e=>e.primary||\"#ff4b4b\"};\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: ${de} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n\n  &:after,\n  &:before {\n    content: '';\n    animation: ${me} 0.15s ease-out forwards;\n    animation-delay: 150ms;\n    position: absolute;\n    border-radius: 3px;\n    opacity: 0;\n    background: ${e=>e.secondary||\"#fff\"};\n    bottom: 9px;\n    left: 4px;\n    height: 2px;\n    width: 12px;\n  }\n\n  &:before {\n    animation: ${le} 0.15s ease-out forwards;\n    animation-delay: 180ms;\n    transform: rotate(90deg);\n  }\n`;import{styled as ue,keyframes as fe}from\"goober\";var Te=fe`\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n`,F=ue(\"div\")`\n  width: 12px;\n  height: 12px;\n  box-sizing: border-box;\n  border: 2px solid;\n  border-radius: 100%;\n  border-color: ${e=>e.secondary||\"#e0e0e0\"};\n  border-right-color: ${e=>e.primary||\"#616161\"};\n  animation: ${Te} 1s linear infinite;\n`;import{styled as ye,keyframes as q}from\"goober\";var ge=q`\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(45deg);\n\topacity: 1;\n}`,he=q`\n0% {\n\theight: 0;\n\twidth: 0;\n\topacity: 0;\n}\n40% {\n  height: 0;\n\twidth: 6px;\n\topacity: 1;\n}\n100% {\n  opacity: 1;\n  height: 10px;\n}`,L=ye(\"div\")`\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ${e=>e.primary||\"#61d345\"};\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: ${ge} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n  &:after {\n    content: '';\n    box-sizing: border-box;\n    animation: ${he} 0.2s ease-out forwards;\n    opacity: 0;\n    animation-delay: 200ms;\n    position: absolute;\n    border-right: 2px solid;\n    border-bottom: 2px solid;\n    border-color: ${e=>e.secondary||\"#fff\"};\n    bottom: 6px;\n    left: 6px;\n    height: 10px;\n    width: 6px;\n  }\n`;var be=U(\"div\")`\n  position: absolute;\n`,Se=U(\"div\")`\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 20px;\n  min-height: 20px;\n`,Ae=xe`\nfrom {\n  transform: scale(0.6);\n  opacity: 0.4;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}`,Pe=U(\"div\")`\n  position: relative;\n  transform: scale(0.6);\n  opacity: 0.4;\n  min-width: 20px;\n  animation: ${Ae} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n`,$=({toast:e})=>{let{icon:t,type:o,iconTheme:s}=e;return t!==void 0?typeof t==\"string\"?b.createElement(Pe,null,t):t:o===\"blank\"?null:b.createElement(Se,null,b.createElement(F,{...s}),o!==\"loading\"&&b.createElement(be,null,o===\"error\"?b.createElement(C,{...s}):b.createElement(L,{...s})))};var Re=e=>`\n0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,Ee=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}\n`,ve=\"0%{opacity:0;} 100%{opacity:1;}\",De=\"0%{opacity:1;} 100%{opacity:0;}\",Oe=J(\"div\")`\n  display: flex;\n  align-items: center;\n  background: #fff;\n  color: #363636;\n  line-height: 1.3;\n  will-change: transform;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);\n  max-width: 350px;\n  pointer-events: auto;\n  padding: 8px 10px;\n  border-radius: 8px;\n`,Ie=J(\"div\")`\n  display: flex;\n  justify-content: center;\n  margin: 4px 10px;\n  color: inherit;\n  flex: 1 1 auto;\n  white-space: pre-line;\n`,ke=(e,t)=>{let s=e.includes(\"top\")?1:-1,[a,i]=E()?[ve,De]:[Re(s),Ee(s)];return{animation:t?`${G(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${G(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},N=y.memo(({toast:e,position:t,style:o,children:s})=>{let a=e.height?ke(e.position||t||\"top-center\",e.visible):{opacity:0},i=y.createElement($,{toast:e}),r=y.createElement(Ie,{...e.ariaProps},h(e.message,e));return y.createElement(Oe,{className:e.className,style:{...a,...o,...e.style}},typeof s==\"function\"?s({icon:i,message:r}):y.createElement(y.Fragment,null,i,r))});import{css as _e,setup as Ve}from\"goober\";import*as x from\"react\";Ve(x.createElement);var we=({id:e,className:t,style:o,onHeightUpdate:s,children:a})=>{let i=x.useCallback(r=>{if(r){let l=()=>{let g=r.getBoundingClientRect().height;s(e,g)};l(),new MutationObserver(l).observe(r,{subtree:!0,childList:!0,characterData:!0})}},[e,s]);return x.createElement(\"div\",{ref:i,className:t,style:o},a)},Me=(e,t)=>{let o=e.includes(\"top\"),s=o?{top:0}:{bottom:0},a=e.includes(\"center\")?{justifyContent:\"center\"}:e.includes(\"right\")?{justifyContent:\"flex-end\"}:{};return{left:0,right:0,display:\"flex\",position:\"absolute\",transition:E()?void 0:\"all 230ms cubic-bezier(.21,1.02,.73,1)\",transform:`translateY(${t*(o?1:-1)}px)`,...s,...a}},Ce=_e`\n  z-index: 9999;\n  > * {\n    pointer-events: auto;\n  }\n`,D=16,Fe=({reverseOrder:e,position:t=\"top-center\",toastOptions:o,gutter:s,children:a,toasterId:i,containerStyle:r,containerClassName:l})=>{let{toasts:g,handlers:T}=w(o,i);return x.createElement(\"div\",{\"data-rht-toaster\":i||\"\",style:{position:\"fixed\",zIndex:9999,top:D,left:D,right:D,bottom:D,pointerEvents:\"none\",...r},className:l,onMouseEnter:T.startPause,onMouseLeave:T.endPause},g.map(d=>{let c=d.position||t,m=T.calculateOffset(d,{reverseOrder:e,gutter:s,defaultPosition:t}),p=Me(c,m);return x.createElement(we,{id:d.id,key:d.id,onHeightUpdate:T.updateHeight,className:d.visible?Ce:\"\",style:p},d.type===\"custom\"?h(d.message,d):a?a(d):x.createElement(N,{toast:d,position:c}))}))};var zt=n;export{L as CheckmarkIcon,C as ErrorIcon,F as LoaderIcon,N as ToastBar,$ as ToastIcon,Fe as Toaster,zt as default,h as resolveValue,n as toast,w as useToaster,V as useToasterStore};\n//# sourceMappingURL=index.mjs.map","// Enhanced scroll management utility for Fan Club Z with navigation context\n// Provides sophisticated scroll preservation across route changes\n\ninterface ScrollContext {\n  scrollY: number;\n  timestamp: number;\n  route: string;\n}\n\nclass ScrollManager {\n  private static instance: ScrollManager;\n  private scrollPositions: Map<string, ScrollContext> = new Map();\n  private currentRoute: string = '';\n  private scrollTimeout: number | null = null;\n  private isNavigating: boolean = false;\n  private restoreTimeout: number | null = null;\n  private navigationHistory: string[] = []; // Track navigation history to detect back navigation\n  private isBackNavigation: boolean = false; // Flag to track if current navigation is back\n\n  private constructor() {\n    // Initialize with current location\n    if (typeof window !== 'undefined') {\n      this.currentRoute = window.location.pathname;\n      // Initialize navigation history with current route\n      this.navigationHistory = [this.currentRoute];\n      this.setupNavigationListeners();\n    }\n  }\n\n  static getInstance(): ScrollManager {\n    if (!ScrollManager.instance) {\n      ScrollManager.instance = new ScrollManager();\n    }\n    return ScrollManager.instance;\n  }\n\n  private setupNavigationListeners(): void {\n    // Note: React Router navigation is handled by App.tsx useEffect\n    // This scroll manager focuses on browser back/forward (popstate) events\n\n    // Listen for popstate (browser back/forward)\n    window.addEventListener('popstate', () => {\n      // Browser navigation logging removed - excessive logging issue\n      this.isNavigating = true;\n      this.isBackNavigation = true; // Browser back/forward is always back navigation\n      \n      // Update navigation history for browser navigation\n      const currentPath = window.location.pathname;\n      if (this.navigationHistory.length > 0) {\n        // Remove last entry if it matches (going back)\n        if (this.navigationHistory[this.navigationHistory.length - 1] === this.currentRoute) {\n          this.navigationHistory.pop();\n        }\n      }\n      \n      setTimeout(() => {\n        this.restoreScrollPosition(currentPath);\n        this.currentRoute = currentPath;\n        this.isNavigating = false;\n        this.isBackNavigation = false;\n      }, 100);\n    });\n\n    // Save scroll position before page unload\n    window.addEventListener('beforeunload', () => {\n      this.saveCurrentScrollPosition();\n    });\n  }\n\n  private handleRouteChange(fromRoute: string, toRoute: string): void {\n    // Save scroll position for the route we're leaving\n    if (fromRoute !== toRoute) {\n      this.saveScrollPosition(fromRoute);\n      \n      // Detect if this is a back navigation by checking if toRoute is in our history\n      const isBackNav = this.navigationHistory.length > 1 && \n                        this.navigationHistory[this.navigationHistory.length - 2] === toRoute;\n      \n      // Update navigation history\n      if (!isBackNav) {\n        // Forward navigation - add to history\n        this.navigationHistory.push(toRoute);\n        // Keep history limited to last 10 routes\n        if (this.navigationHistory.length > 10) {\n          this.navigationHistory.shift();\n        }\n      } else {\n        // Back navigation - remove last entry from history\n        this.navigationHistory.pop();\n      }\n      \n      this.currentRoute = toRoute;\n      this.isBackNavigation = isBackNav;\n      \n      if (isBackNav) {\n        // Back navigation - restore scroll position\n        this.scheduleScrollRestore(toRoute);\n      } else {\n        // Forward navigation - always scroll to top\n        this.scrollToTop({ behavior: 'instant', delay: 50 });\n      }\n    }\n  }\n\n  private scheduleScrollRestore(route: string): void {\n    if (this.restoreTimeout) {\n      clearTimeout(this.restoreTimeout);\n    }\n\n    // Wait for page to render, then restore scroll (only if back navigation)\n    this.restoreTimeout = window.setTimeout(() => {\n      if (!this.isNavigating && this.isBackNavigation) {\n        this.restoreScrollPosition(route);\n      }\n    }, 150);\n  }\n\n  saveScrollPosition(route?: string): void {\n    const routeKey = route || this.currentRoute;\n    const scrollY = this.getCurrentScrollPosition();\n\n    if (scrollY > 50) { // Only save meaningful scroll positions\n      this.scrollPositions.set(routeKey, {\n        scrollY,\n        timestamp: Date.now(),\n        route: routeKey\n      });\n      // Scroll position logging removed - excessive logging issue\n    }\n  }\n\n  saveCurrentScrollPosition(): void {\n    this.saveScrollPosition(this.currentRoute);\n  }\n\n  restoreScrollPosition(route: string): boolean {\n    const context = this.scrollPositions.get(route);\n    \n    if (!context) {\n      // Scroll position logging removed - excessive logging issue\n      return false;\n    }\n\n    // Check if the saved position is still valid (within 10 minutes)\n    const isRecent = Date.now() - context.timestamp < 10 * 60 * 1000;\n    if (!isRecent) {\n      // Scroll position logging removed - excessive logging issue\n      this.scrollPositions.delete(route);\n      return false;\n    }\n\n    // Scroll position logging removed - excessive logging issue\n    \n    // Use smooth scrolling with fallback\n    this.scrollToPosition(context.scrollY, 'smooth');\n    return true;\n  }\n\n  private getCurrentScrollPosition(): number {\n    return window.pageYOffset || \n           document.documentElement.scrollTop || \n           document.body.scrollTop || \n           0;\n  }\n\n  private scrollToPosition(scrollY: number, behavior: 'smooth' | 'instant' = 'smooth'): void {\n    // Force scroll on all possible scroll containers for cross-browser/mobile compatibility\n    const forceScroll = () => {\n      // Try all possible scroll containers\n      if (document.scrollingElement) {\n        document.scrollingElement.scrollTop = scrollY;\n      }\n      document.documentElement.scrollTop = scrollY;\n      document.body.scrollTop = scrollY;\n      \n      // Also try window.scrollTo for completeness\n      try {\n        window.scrollTo({\n          top: scrollY,\n          left: 0,\n          behavior: behavior === 'instant' ? 'instant' : 'smooth'\n        });\n      } catch {\n        window.scrollTo(0, scrollY);\n      }\n    };\n\n    // Execute immediately for instant behavior\n    if (behavior === 'instant') {\n      forceScroll();\n      // Double-check with RAF for mobile Safari\n      requestAnimationFrame(() => {\n        forceScroll();\n      });\n      return;\n    }\n\n    // For smooth behavior, use scrollTo API\n    try {\n      window.scrollTo({\n        top: scrollY,\n        left: 0,\n        behavior: 'smooth'\n      });\n      \n      // Verify scroll actually happened\n      setTimeout(() => {\n        const currentPos = this.getCurrentScrollPosition();\n        if (Math.abs(currentPos - scrollY) > 100) {\n          forceScroll();\n        }\n      }, 300);\n    } catch {\n      forceScroll();\n    }\n  }\n\n  // Enhanced scroll to top with debouncing\n  scrollToTop(options: { behavior?: 'smooth' | 'instant'; delay?: number } = {}): void {\n    const { behavior = 'smooth', delay = 0 } = options;\n    \n    // Clear any existing timeout to prevent multiple rapid calls\n    if (this.scrollTimeout) {\n      window.clearTimeout(this.scrollTimeout);\n    }\n    \n    // For instant behavior, execute immediately AND with delay to ensure it takes effect\n    if (behavior === 'instant') {\n      // Immediate scroll\n      this.scrollToPosition(0, 'instant');\n      \n      // Also schedule with delay to catch late-rendering content\n      if (delay > 0) {\n        this.scrollTimeout = window.setTimeout(() => {\n          this.scrollToPosition(0, 'instant');\n          this.scrollTimeout = null;\n        }, delay);\n      }\n      \n      // Extra safety: scroll again after a longer delay for slow-loading pages\n      window.setTimeout(() => {\n        this.scrollToPosition(0, 'instant');\n      }, 100);\n      \n      return;\n    }\n    \n    this.scrollTimeout = window.setTimeout(() => {\n      this.scrollToPosition(0, behavior);\n      this.scrollTimeout = null;\n    }, delay);\n  }\n\n  scrollToElement(elementId: string, options: { behavior?: 'smooth' | 'instant'; offset?: number } = {}): void {\n    const { behavior = 'smooth', offset = 0 } = options;\n    \n    // Clear any existing timeout\n    if (this.scrollTimeout) {\n      window.clearTimeout(this.scrollTimeout);\n    }\n    \n    this.scrollTimeout = window.setTimeout(() => {\n      const element = document.getElementById(elementId);\n      if (element) {\n        const elementPosition = element.offsetTop - offset;\n        this.scrollToPosition(elementPosition, behavior);\n      }\n      this.scrollTimeout = null;\n    }, 50);\n  }\n\n  // Clear old scroll positions to prevent memory leaks\n  clearOldPositions(): void {\n    const now = Date.now();\n    const tenMinutes = 10 * 60 * 1000;\n    \n    for (const [route, context] of this.scrollPositions.entries()) {\n      if (now - context.timestamp > tenMinutes) {\n        this.scrollPositions.delete(route);\n        // Scroll cleanup logging removed - excessive logging issue\n      }\n    }\n  }\n\n  // Mark current navigation as intentional (prevent auto-restore, scroll to top)\n  markNavigationAsIntentional(): void {\n    this.isNavigating = true;\n    this.isBackNavigation = false; // Intentional navigation is forward navigation\n    setTimeout(() => {\n      this.isNavigating = false;\n    }, 500);\n  }\n  \n  // Mark navigation as back navigation (allow scroll restore)\n  markAsBackNavigation(): void {\n    this.isBackNavigation = true;\n  }\n  \n  // Handle React Router navigation change\n  handleRouterNavigation(fromRoute: string, toRoute: string): void {\n    // Save scroll position for the route we're leaving\n    this.saveScrollPosition(fromRoute);\n    \n    // Detect if this is a back navigation by checking if toRoute is in our history\n    const isBackNav = this.navigationHistory.length > 1 && \n                      this.navigationHistory[this.navigationHistory.length - 2] === toRoute;\n    \n    // Update navigation history\n    if (!isBackNav) {\n      // Forward navigation - add to history\n      this.navigationHistory.push(toRoute);\n      // Keep history limited to last 10 routes\n      if (this.navigationHistory.length > 10) {\n        this.navigationHistory.shift();\n      }\n    } else {\n      // Back navigation - remove last entry from history\n      this.navigationHistory.pop();\n    }\n    \n    this.currentRoute = toRoute;\n    this.isBackNavigation = isBackNav;\n    \n    if (isBackNav) {\n      // Back navigation - restore scroll position\n      setTimeout(() => {\n        this.restoreScrollPosition(toRoute);\n      }, 150);\n    } else {\n      // Forward navigation - AGGRESSIVELY scroll to top\n      // Immediately scroll\n      this.scrollToPosition(0, 'instant');\n      // Also schedule with delay for late-rendering content\n      this.scrollToTop({ behavior: 'instant', delay: 50 });\n    }\n  }\n\n  // Get debug info\n  getDebugInfo(): object {\n    return {\n      currentRoute: this.currentRoute,\n      savedPositions: Array.from(this.scrollPositions.entries()).map(([route, context]) => ({\n        route,\n        scrollY: context.scrollY,\n        age: Date.now() - context.timestamp\n      })),\n      isNavigating: this.isNavigating\n    };\n  }\n\n  destroy(): void {\n    if (this.scrollTimeout) {\n      window.clearTimeout(this.scrollTimeout);\n    }\n    if (this.restoreTimeout) {\n      window.clearTimeout(this.restoreTimeout);\n    }\n    this.scrollPositions.clear();\n  }\n}\n\n// Create singleton instance\nconst scrollManager = ScrollManager.getInstance();\n\n// Export convenience functions\nexport const scrollToTop = (options?: { behavior?: 'smooth' | 'instant'; delay?: number }) => {\n  scrollManager.scrollToTop(options);\n};\n\nexport const scrollToElement = (elementId: string, options?: { behavior?: 'smooth' | 'instant'; offset?: number }) => {\n  scrollManager.scrollToElement(elementId, options);\n};\n\nexport const saveScrollPosition = (route?: string) => {\n  scrollManager.saveScrollPosition(route);\n};\n\nexport const restoreScrollPosition = (route: string) => {\n  return scrollManager.restoreScrollPosition(route);\n};\n\nexport const markNavigationAsIntentional = () => {\n  scrollManager.markNavigationAsIntentional();\n};\n\nexport const handleRouterNavigation = (fromRoute: string, toRoute: string) => {\n  scrollManager.handleRouterNavigation(fromRoute, toRoute);\n};\n\nexport const clearScrollTimeout = () => {\n  // Legacy function for backward compatibility\n  console.warn('clearScrollTimeout is deprecated, scroll management is now automatic');\n};\n\n// Hook for React components\nexport const useScrollPreservation = () => {\n  return {\n    saveScroll: saveScrollPosition,\n    restoreScroll: restoreScrollPosition,\n    markIntentionalNavigation: markNavigationAsIntentional,\n    debugInfo: () => scrollManager.getDebugInfo()\n  };\n};\n\n// Clean up old positions periodically\nsetInterval(() => {\n  scrollManager.clearOldPositions();\n}, 5 * 60 * 1000); // Every 5 minutes\n\nexport default scrollManager;","import React, { useEffect, useState } from 'react';\n\ninterface NotificationProps {\n  type: 'success' | 'error' | 'warning' | 'info';\n  message: string;\n  duration?: number;\n  onClose?: () => void;\n  show?: boolean;\n}\n\nconst Notification: React.FC<NotificationProps> = ({\n  type,\n  message,\n  duration = 5000,\n  onClose,\n  show = true\n}) => {\n  const [isVisible, setIsVisible] = useState(show);\n\n  useEffect(() => {\n    setIsVisible(show);\n  }, [show]);\n\n  useEffect(() => {\n    if (isVisible && duration > 0) {\n      const timer = setTimeout(() => {\n        setIsVisible(false);\n        onClose?.();\n      }, duration);\n\n      return () => clearTimeout(timer);\n    }\n  }, [isVisible, duration, onClose]);\n\n  if (!isVisible) return null;\n\n  const getIcon = () => {\n    switch (type) {\n      case 'success':\n        return (\n          <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n          </svg>\n        );\n      case 'error':\n        return (\n          <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        );\n      case 'warning':\n        return (\n          <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n          </svg>\n        );\n      case 'info':\n        return (\n          <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n          </svg>\n        );\n    }\n  };\n\n  const getStyles = () => {\n    const baseStyles = {\n      position: 'fixed' as const,\n      top: '20px',\n      right: '20px',\n      zIndex: 9999,\n      padding: '16px 20px',\n      borderRadius: '16px',\n      boxShadow: '0 20px 40px rgba(0, 0, 0, 0.15)',\n      display: 'flex',\n      alignItems: 'center',\n      gap: '12px',\n      maxWidth: '400px',\n      minWidth: '300px',\n      animation: 'slideIn 0.3s ease-out',\n      border: '1px solid',\n      backdropFilter: 'blur(10px)',\n      fontSize: '14px',\n      fontWeight: '600',\n      fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif'\n    };\n\n    switch (type) {\n      case 'success':\n        return {\n          ...baseStyles,\n          backgroundColor: 'rgba(16, 185, 129, 0.95)',\n          color: 'white',\n          borderColor: 'rgba(16, 185, 129, 0.3)'\n        };\n      case 'error':\n        return {\n          ...baseStyles,\n          backgroundColor: 'rgba(239, 68, 68, 0.95)',\n          color: 'white',\n          borderColor: 'rgba(239, 68, 68, 0.3)'\n        };\n      case 'warning':\n        return {\n          ...baseStyles,\n          backgroundColor: 'rgba(245, 158, 11, 0.95)',\n          color: 'white',\n          borderColor: 'rgba(245, 158, 11, 0.3)'\n        };\n      case 'info':\n        return {\n          ...baseStyles,\n          backgroundColor: 'rgba(59, 130, 246, 0.95)',\n          color: 'white',\n          borderColor: 'rgba(59, 130, 246, 0.3)'\n        };\n    }\n  };\n\n  return (\n    <>\n      <style>\n        {`\n          @keyframes slideIn {\n            from {\n              transform: translateX(100%);\n              opacity: 0;\n            }\n            to {\n              transform: translateX(0);\n              opacity: 1;\n            }\n          }\n          \n          @keyframes slideOut {\n            from {\n              transform: translateX(0);\n              opacity: 1;\n            }\n            to {\n              transform: translateX(100%);\n              opacity: 0;\n            }\n          }\n        `}\n      </style>\n      <div style={getStyles()}>\n        <div style={{ flexShrink: 0 }}>\n          {getIcon()}\n        </div>\n        <div style={{ flex: 1 }}>\n          {message}\n        </div>\n\n      </div>\n    </>\n  );\n};\n\nexport default Notification; ","import React from 'react';\nimport { useNotificationStore } from '../../store/notificationStore';\nimport Notification from './Notification';\n\nconst typeMap: Record<string, 'success' | 'error' | 'info' | 'warning'> = {\n  success: 'success',\n  error: 'error',\n  warning: 'warning',\n  info: 'info',\n  prediction_outcome: 'success',\n  payout: 'success',\n  comment: 'info',\n  market_close: 'warning',\n  like: 'info',\n  follow: 'info',\n  settlement_ready: 'warning',\n  settlement_completed: 'success',\n};\n\nconst NotificationContainer: React.FC = () => {\n  const { toasts, removeToast } = useNotificationStore();\n\n  return (\n    <>\n      {toasts.map((toast) => (\n        <Notification\n          key={toast.id}\n          type={typeMap[toast.type] ?? 'info'}\n          message={toast.message}\n          duration={toast.duration}\n          onClose={() => removeToast(toast.id)}\n          show={true}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default NotificationContainer; ","// PWA utility functions for service worker registration and management\nimport { Capacitor } from '@capacitor/core';\nimport { VAPID_PUBLIC_KEY, getApiUrl } from '@/utils/environment';\n\nexport interface BeforeInstallPromptEvent extends Event {\n  prompt: () => Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\nexport class PWAManager {\n  private static instance: PWAManager;\n  private deferredPrompt: BeforeInstallPromptEvent | null = null;\n  private isInstalled = false;\n\n  private constructor() {\n    this.init();\n  }\n\n  public static getInstance(): PWAManager {\n    if (!PWAManager.instance) {\n      PWAManager.instance = new PWAManager();\n    }\n    return PWAManager.instance;\n  }\n\n  private init() {\n    // CRITICAL: Native builds (Capacitor) should NEVER register service workers\n    // Service workers are web-only and cause issues in native WebViews\n    const isNative = Capacitor.isNativePlatform();\n    if (isNative) {\n      console.log('[PWA] Skipping service worker registration in native build');\n      if ('serviceWorker' in navigator) {\n        // Proactively unregister any existing SW in native builds\n        navigator.serviceWorker.getRegistrations().then((registrations) => {\n          registrations.forEach((registration) => {\n            console.log('[PWA] Unregistering existing service worker in native:', registration.scope);\n            registration.unregister();\n          });\n        }).catch((err) => {\n          console.warn('[PWA] Failed to unregister service workers in native:', err);\n        });\n      }\n      return;\n    }\n\n    // In development, do NOT register or use the PWA service worker.\n    // It interferes with localhost testing by caching old bundles (including landing builds).\n    if (import.meta.env.DEV) {\n      console.log('[PWA] Skipping service worker registration in development');\n      if ('serviceWorker' in navigator) {\n        // Proactively unregister any existing SW so localhost always serves fresh dev code\n        navigator.serviceWorker.getRegistrations().then((registrations) => {\n          registrations.forEach((registration) => {\n            console.log('[PWA] Unregistering existing service worker in dev:', registration.scope);\n            registration.unregister();\n          });\n        }).catch((err) => {\n          console.warn('[PWA] Failed to unregister service workers in dev:', err);\n        });\n      }\n      return;\n    }\n\n    // Register service worker (production web only)\n    this.registerServiceWorker();\n\n    // Check if app is already installed\n    this.checkInstallStatus();\n\n    // Listen for install prompt\n    this.setupInstallPrompt();\n  }\n\n  private async registerServiceWorker() {\n    if ('serviceWorker' in navigator) {\n      try {\n        const registration = await navigator.serviceWorker.register('/sw.js');\n        console.log('Service Worker registered successfully:', registration);\n        \n        // Handle service worker updates\n        registration.addEventListener('updatefound', () => {\n          const newWorker = registration.installing;\n          if (newWorker) {\n            newWorker.addEventListener('statechange', () => {\n              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                // New version available\n                this.showUpdateAvailable();\n              }\n            });\n          }\n        });\n      } catch (error) {\n        console.error('Service Worker registration failed:', error);\n      }\n    }\n  }\n\n  private checkInstallStatus() {\n    // Check if running in standalone mode\n    this.isInstalled = window.matchMedia('(display-mode: standalone)').matches ||\n                     (window.navigator as any).standalone === true;\n  }\n\n  private setupInstallPrompt() {\n    window.addEventListener('beforeinstallprompt', (e) => {\n      e.preventDefault();\n      this.deferredPrompt = e as BeforeInstallPromptEvent;\n      \n      // Dispatch custom event for UI components\n      window.dispatchEvent(new CustomEvent('pwa-installable', {\n        detail: { canInstall: true }\n      }));\n    });\n\n    window.addEventListener('appinstalled', () => {\n      this.isInstalled = true;\n      this.deferredPrompt = null;\n      \n      // Track installation\n      this.trackInstallation();\n      \n      // Dispatch custom event\n      window.dispatchEvent(new CustomEvent('pwa-installed'));\n    });\n  }\n\n  public async promptInstall(): Promise<boolean> {\n    if (!this.deferredPrompt) {\n      return false;\n    }\n\n    try {\n      await this.deferredPrompt.prompt();\n      const choiceResult = await this.deferredPrompt.userChoice;\n      \n      this.deferredPrompt = null;\n      \n      return choiceResult.outcome === 'accepted';\n    } catch (error) {\n      console.error('Install prompt failed:', error);\n      return false;\n    }\n  }\n\n  public canInstall(): boolean {\n    return !!this.deferredPrompt && !this.isInstalled;\n  }\n\n  public isAppInstalled(): boolean {\n    return this.isInstalled;\n  }\n\n  public isIOSDevice(): boolean {\n    return /iPad|iPhone|iPod/.test(navigator.userAgent);\n  }\n\n  public isAndroidDevice(): boolean {\n    return /Android/.test(navigator.userAgent);\n  }\n\n  private showUpdateAvailable() {\n    // Show update notification\n    const updateEvent = new CustomEvent('pwa-update-available', {\n      detail: {\n        message: 'A new version of Fan Club Z is available. Refresh to update.',\n        action: () => window.location.reload()\n      }\n    });\n    window.dispatchEvent(updateEvent);\n  }\n\n  private trackInstallation() {\n    // Track installation analytics\n    if (typeof window !== 'undefined' && window.gtag) {\n      window.gtag('event', 'pwa_install', {\n        event_category: 'engagement',\n        event_label: 'app_install'\n      });\n    }\n  }\n\n  // Request notification permission\n  public async requestNotificationPermission(): Promise<boolean> {\n    if (!('Notification' in window)) {\n      return false;\n    }\n\n    if (Notification.permission === 'granted') {\n      return true;\n    }\n\n    if (Notification.permission === 'denied') {\n      return false;\n    }\n\n    const permission = await Notification.requestPermission();\n    return permission === 'granted';\n  }\n\n  // Subscribe to push notifications\n  public async subscribeToPushNotifications(): Promise<PushSubscription | null> {\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      \n      // Check if already subscribed\n      const existingSubscription = await registration.pushManager.getSubscription();\n      if (existingSubscription) {\n        return existingSubscription;\n      }\n\n      // Subscribe to push notifications\n      const subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: this.urlBase64ToUint8Array(\n          VAPID_PUBLIC_KEY || ''\n        ) as BufferSource\n      });\n\n      // Send subscription to server\n      await this.sendSubscriptionToServer(subscription);\n      \n      return subscription;\n    } catch (error) {\n      console.error('Push subscription failed:', error);\n      return null;\n    }\n  }\n\n  private urlBase64ToUint8Array(base64String: string): Uint8Array {\n    const padding = '='.repeat((4 - base64String.length % 4) % 4);\n    const base64 = (base64String + padding)\n      .replace(/-/g, '+')\n      .replace(/_/g, '/');\n\n    const rawData = window.atob(base64);\n    const outputArray = new Uint8Array(rawData.length);\n\n    for (let i = 0; i < rawData.length; ++i) {\n      const charCode = rawData.charCodeAt(i);\n      outputArray[i] = charCode;\n    }\n    return outputArray;\n  }\n\n  private async sendSubscriptionToServer(subscription: PushSubscription): Promise<void> {\n    try {\n      const apiBase = getApiUrl();\n      await fetch(`${apiBase}/api/notifications/subscribe`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(subscription)\n      });\n    } catch (error) {\n      console.error('Failed to send subscription to server:', error);\n    }\n  }\n}\n\n// Initialize PWA manager\nexport const pwaManager = PWAManager.getInstance();","import React, { useState, useEffect } from 'react';\nimport { X, Download, Smartphone } from 'lucide-react';\nimport { pwaManager } from '../utils/pwa';\n\nconst PWAInstallBanner: React.FC = () => {\n  const [showBanner, setShowBanner] = useState(false);\n  const [canInstall, setCanInstall] = useState(false);\n\n  useEffect(() => {\n    // Check initial install status\n    const checkInstallStatus = () => {\n      if (pwaManager.isAppInstalled()) {\n        setShowBanner(false);\n        return;\n      }\n\n      const isIOS = pwaManager.isIOSDevice();\n      const dismissed = localStorage.getItem(isIOS ? 'ios-install-dismissed' : 'pwa-banner-dismissed');\n      const dismissedTime = dismissed ? parseInt(dismissed) : 0;\n      const daysSinceDissmissal = (Date.now() - dismissedTime) / (24 * 60 * 60 * 1000);\n      \n      // Show banner if not dismissed recently (1 day for Android, 3 days for iOS)\n      const daysThreshold = isIOS ? 3 : 1;\n      const shouldShow = !dismissed || daysSinceDissmissal > daysThreshold;\n      \n      // For MVP, show banner only once per session and make it easily dismissible\n      const sessionDismissed = sessionStorage.getItem('pwa-banner-session-dismissed');\n      \n      if (shouldShow && !sessionDismissed) {\n        if (isIOS) {\n          // For iOS, show after a delay\n          setTimeout(() => setShowBanner(true), 5000); // Increased delay\n        } else {\n          // For Android, wait for install prompt\n          setCanInstall(pwaManager.canInstall());\n        }\n      }\n    };\n\n    // Listen for PWA events\n    const handleInstallable = () => {\n      setCanInstall(true);\n      if (!localStorage.getItem('pwa-banner-dismissed')) {\n        setShowBanner(true);\n      }\n    };\n\n    const handleInstalled = () => {\n      setShowBanner(false);\n      setCanInstall(false);\n    };\n\n    window.addEventListener('pwa-installable', handleInstallable);\n    window.addEventListener('pwa-installed', handleInstalled);\n\n    checkInstallStatus();\n\n    return () => {\n      window.removeEventListener('pwa-installable', handleInstallable);\n      window.removeEventListener('pwa-installed', handleInstalled);\n    };\n  }, []);\n\n  const handleInstallClick = async () => {\n    const isIOS = pwaManager.isIOSDevice();\n    \n    if (isIOS) {\n      // For iOS, show instruction modal\n      window.dispatchEvent(new CustomEvent('show-ios-install'));\n      setShowBanner(false);\n    } else {\n      // For Android, use native install prompt\n      const installed = await pwaManager.promptInstall();\n      if (!installed) {\n        // User dismissed, remember their choice\n        localStorage.setItem('pwa-banner-dismissed', Date.now().toString());\n      }\n      setShowBanner(false);\n    }\n  };\n\n  const handleDismiss = () => {\n    setShowBanner(false);\n    const storageKey = pwaManager.isIOSDevice() ? 'ios-install-dismissed' : 'pwa-banner-dismissed';\n    localStorage.setItem(storageKey, Date.now().toString());\n    // Also dismiss for this session\n    sessionStorage.setItem('pwa-banner-session-dismissed', 'true');\n  };\n\n  if (!showBanner) {\n    return null;\n  }\n\n  const isIOS = pwaManager.isIOSDevice();\n\n  return (\n    <div className=\"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-purple-500 to-teal-600 text-white shadow-lg animate-in slide-in-from-top duration-300\">\n      <div className=\"flex items-center justify-between px-4 py-3 max-w-md mx-auto\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"bg-white/20 p-2 rounded-lg backdrop-blur-sm\">\n            <Smartphone className=\"w-5 h-5\" />\n          </div>\n          <div className=\"flex-1\">\n            <p className=\"font-semibold text-sm\">\n              {isIOS ? 'Add to Home Screen' : 'Install Fan Club Z'}\n            </p>\n            <p className=\"text-xs text-green-100\">\n              {isIOS \n                ? 'Get quick access and offline features'\n                : 'Faster loading  Offline access  Notifications'\n              }\n            </p>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          <button\n            onClick={handleInstallClick}\n            className=\"bg-white text-teal-600 px-3 py-1.5 rounded-md text-sm font-medium hover:bg-teal-50 active:bg-teal-100 transition-colors flex items-center space-x-1 shadow-sm\"\n          >\n            <Download className=\"w-4 h-4\" />\n            <span>{isIOS ? 'How To' : 'Install'}</span>\n          </button>\n          \n          <button\n            onClick={handleDismiss}\n            className=\"text-green-100 hover:text-white transition-colors p-1 rounded\"\n            aria-label=\"Dismiss install banner\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PWAInstallBanner;","import React, { useState, useEffect } from 'react';\nimport { X, Share, Plus, Smartphone } from 'lucide-react';\n\ninterface IOSInstallModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst IOSInstallModal: React.FC<IOSInstallModalProps> = ({ isOpen, onClose }) => {\n  if (!isOpen) return null;\n\n  return (\n    <div \n      className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex flex-col ios-install-modal\"\n      onClick={onClose}\n      style={{ zIndex: 10000 }}\n    >\n      {/* Safe area top spacing */}\n      <div className=\"flex-1 flex items-center justify-center p-4 pb-24\">\n        <div \n          className=\"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200 flex flex-col max-h-[calc(100vh-8rem)]\"\n          onClick={(e) => e.stopPropagation()}\n          style={{ zIndex: 10001 }}\n        >\n          {/* Fixed Header */}\n          <div className=\"bg-gradient-to-r from-purple-500 to-emerald-600 p-4 text-center text-white relative rounded-t-2xl flex-shrink-0\">\n            <button\n              onClick={onClose}\n              className=\"absolute top-3 right-3 text-white/80 hover:text-white transition-colors p-1 rounded-full hover:bg-white/20\"\n              aria-label=\"Close modal\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n            \n            <div className=\"inline-flex items-center justify-center w-12 h-12 bg-white/20 rounded-full mb-3\">\n              <Smartphone className=\"w-6 h-6\" />\n            </div>\n            <h2 className=\"text-lg font-bold mb-1\">Install Fan Club Z</h2>\n            <p className=\"text-green-100 text-sm\">\n              Get the full app experience with offline access and notifications\n            </p>\n          </div>\n\n          {/* Scrollable content area with proper mobile UX */}\n          <div className=\"flex-1 overflow-y-auto overscroll-contain\">\n            <div className=\"p-4 space-y-4\">\n              <div className=\"space-y-4\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                    <span className=\"text-blue-600 font-bold text-sm\">1</span>\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-gray-900 mb-2 text-base\">\n                      Tap the Share button\n                    </p>\n                    <div className=\"flex items-center space-x-2 text-sm text-gray-600\">\n                      <Share className=\"w-4 h-4\" />\n                      <span>Usually found at the bottom of Safari</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                    <span className=\"text-blue-600 font-bold text-sm\">2</span>\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-gray-900 mb-2 text-base\">\n                      Select \"Add to Home Screen\"\n                    </p>\n                    <div className=\"flex items-center space-x-2 text-sm text-gray-600\">\n                      <Plus className=\"w-4 h-4\" />\n                      <span>Scroll down in the share menu to find this option</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                    <span className=\"text-blue-600 font-bold text-sm\">3</span>\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-gray-900 mb-2 text-base\">\n                      Tap \"Add\" to confirm\n                    </p>\n                    <p className=\"text-sm text-gray-600\">\n                      Fan Club Z will appear on your home screen like a native app\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Benefits */}\n              <div className=\"bg-gray-50 rounded-lg p-4\">\n                <h3 className=\"font-medium text-gray-900 mb-3 text-base\">Why install?</h3>\n                <ul className=\"text-sm text-gray-600 space-y-2\">\n                  <li> Faster loading and smoother experience</li>\n                  <li> Works offline for viewing your predictions</li>\n                  <li> Push notifications for important updates</li>\n                  <li> Easy access from your home screen</li>\n                </ul>\n              </div>\n\n              {/* Extra bottom padding for scrolling */}\n              <div className=\"h-4\"></div>\n            </div>\n          </div>\n\n          {/* Fixed bottom actions with safe area */}\n          <div className=\"border-t border-gray-100 p-4 flex-shrink-0 rounded-b-2xl\">\n            <div className=\"flex space-x-3\">\n              <button\n                onClick={onClose}\n                className=\"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors text-base\"\n              >\n                Maybe Later\n              </button>\n              <button\n                onClick={() => {\n                  onClose();\n                  // Don't show again for a week\n                  localStorage.setItem('ios-install-dismissed', Date.now().toString());\n                }}\n                className=\"flex-1 px-4 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-base\"\n              >\n                Got It!\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default IOSInstallModal;","import React, { useState, useEffect } from 'react';\nimport { Download, X, Sparkles, Zap, Bell } from 'lucide-react';\nimport { pwaManager } from '../utils/pwa';\n\ninterface InstallPromptCardProps {\n  onInstall: () => void;\n  onDismiss: () => void;\n}\n\nconst InstallPromptCard: React.FC<InstallPromptCardProps> = ({ onInstall, onDismiss }) => {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    // Show with animation\n    const timer = setTimeout(() => setIsVisible(true), 100);\n    return () => clearTimeout(timer);\n  }, []);\n\n  const handleInstall = () => {\n    setIsVisible(false);\n    setTimeout(onInstall, 300); // Wait for animation\n  };\n\n  const handleDismiss = () => {\n    setIsVisible(false);\n    setTimeout(onDismiss, 300); // Wait for animation\n  };\n\n  return (\n    <div className={`\n      fixed inset-x-4 top-20 max-w-sm mx-auto transition-all duration-300 ease-out pwa-install-prompt\n      ${isVisible ? 'opacity-100 transform translate-y-0' : 'opacity-0 transform -translate-y-4'}\n    `} style={{ zIndex: 10000 }}>\n      <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden\">\n        {/* Header with gradient */}\n        <div className=\"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center\">\n                <Download className=\"w-4 h-4\" />\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-sm\">Install Fan Club Z</h3>\n                <p className=\"text-xs text-green-100\">Get the full app experience</p>\n              </div>\n            </div>\n            <button\n              onClick={handleDismiss}\n              className=\"text-green-100 hover:text-white transition-colors p-1 rounded\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Benefits */}\n        <div className=\"p-4 space-y-3\">\n          <div className=\"flex items-center space-x-3\">\n                            <div className=\"w-8 h-8 bg-gradient-to-r from-purple-400 to-teal-500 rounded-lg flex items-center justify-center\">\n              <Zap className=\"w-4 h-4 text-teal-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-medium text-gray-900\">Faster Performance</p>\n              <p className=\"text-xs text-gray-600\">Lightning-fast loading and smooth animations</p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center\">\n              <Bell className=\"w-4 h-4 text-blue-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-medium text-gray-900\">Push Notifications</p>\n              <p className=\"text-xs text-gray-600\">Get notified about prediction results and updates</p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center\">\n              <Sparkles className=\"w-4 h-4 text-purple-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-medium text-gray-900\">Offline Access</p>\n              <p className=\"text-xs text-gray-600\">View your predictions even without internet</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"p-4 pt-0 flex space-x-2\">\n          <button\n            onClick={handleDismiss}\n            className=\"flex-1 py-2.5 px-4 text-gray-700 bg-gray-100 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors\"\n          >\n            Maybe Later\n          </button>\n          <button\n            onClick={handleInstall}\n            className=\"flex-1 py-2.5 px-4 bg-teal-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors flex items-center justify-center space-x-1\"\n          >\n            <Download className=\"w-4 h-4\" />\n            <span>Install</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Smart install prompt that appears at optimal times\nconst SmartInstallPrompt: React.FC = () => {\n  const [showPrompt, setShowPrompt] = useState(false);\n  const [userEngagement, setUserEngagement] = useState(0);\n\n  useEffect(() => {\n    // Track user engagement\n    let engagementScore = 0;\n    const engagementEvents = ['click', 'scroll', 'touchstart', 'keydown'];\n    \n    const trackEngagement = () => {\n      engagementScore++;\n      setUserEngagement(engagementScore);\n      \n      // Show prompt after significant engagement\n      if (engagementScore >= 5 && !localStorage.getItem('install-prompt-shown')) {\n        checkAndShowPrompt();\n      }\n    };\n\n    engagementEvents.forEach(event => {\n      document.addEventListener(event, trackEngagement, { passive: true });\n    });\n\n    return () => {\n      engagementEvents.forEach(event => {\n        document.removeEventListener(event, trackEngagement);\n      });\n    };\n  }, []);\n\n  const checkAndShowPrompt = () => {\n    // Don't show if already installed or recently dismissed\n    if (pwaManager.isAppInstalled()) return;\n    \n    const dismissed = localStorage.getItem('install-prompt-dismissed');\n    const dismissedTime = dismissed ? parseInt(dismissed) : 0;\n    const oneDayInMs = 24 * 60 * 60 * 1000;\n    \n    if (!dismissed || Date.now() - dismissedTime > oneDayInMs) {\n      // Additional checks for optimal timing\n      const timeOnSite = Date.now() - (parseInt(localStorage.getItem('session-start') || '0'));\n      const hasCreatedPrediction = localStorage.getItem('has-created-prediction');\n      const hasPlacedPrediction = localStorage.getItem('has-placed-prediction');\n      \n      // Show if user has been engaged for at least 30 seconds and has interacted meaningfully\n      if (timeOnSite > 30000 && (hasCreatedPrediction || hasPlacedPrediction)) {\n        setShowPrompt(true);\n        localStorage.setItem('install-prompt-shown', 'true');\n      }\n    }\n  };\n\n  const handleInstall = async () => {\n    const isIOS = pwaManager.isIOSDevice();\n    \n    if (isIOS) {\n      // For iOS, show instructions\n      window.dispatchEvent(new CustomEvent('show-ios-install'));\n    } else {\n      // For Android, use native prompt\n      const installed = await pwaManager.promptInstall();\n      if (!installed) {\n        localStorage.setItem('install-prompt-dismissed', Date.now().toString());\n      }\n    }\n    \n    setShowPrompt(false);\n  };\n\n  const handleDismiss = () => {\n    setShowPrompt(false);\n    localStorage.setItem('install-prompt-dismissed', Date.now().toString());\n  };\n\n  if (!showPrompt) return null;\n\n  return (\n    <InstallPromptCard \n      onInstall={handleInstall}\n      onDismiss={handleDismiss}\n    />\n  );\n};\n\nexport default SmartInstallPrompt;","import React, { useState, useEffect } from 'react';\nimport { X, RefreshCw, Sparkles } from 'lucide-react';\n\ninterface TopUpdateToastProps {\n  isVisible: boolean;\n  onUpdate: () => void;\n  onDismiss: () => void;\n}\n\nconst TopUpdateToast: React.FC<TopUpdateToastProps> = ({\n  isVisible,\n  onUpdate,\n  onDismiss\n}) => {\n  const [isAnimatingOut, setIsAnimatingOut] = useState(false);\n\n  const handleDismiss = () => {\n    setIsAnimatingOut(true);\n    setTimeout(onDismiss, 300);\n  };\n\n  const handleUpdate = () => {\n    setIsAnimatingOut(true);\n    setTimeout(onUpdate, 200);\n  };\n\n  if (!isVisible && !isAnimatingOut) return null;\n\n  return (\n    <>\n      {/* Backdrop overlay for important notifications */}\n      <div className={`\n        fixed inset-0 bg-black/10 backdrop-blur-sm transition-opacity duration-300 update-notification\n        ${isVisible && !isAnimatingOut ? 'opacity-100' : 'opacity-0'}\n      `} style={{ zIndex: 10000 }} />\n      \n      {/* Toast notification - Properly centered with responsive width */}\n      <div className={`\n        fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 update-notification\n        w-[calc(100vw-32px)] max-w-sm max-h-[90vh] overflow-y-auto\n        transition-all duration-300 ease-out\n        ${isVisible && !isAnimatingOut \n          ? 'opacity-100 scale-100' \n          : 'opacity-0 scale-95'\n        }\n      `} style={{ zIndex: 10001 }}>\n        <div className=\"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden\">\n          {/* Header with icon and close */}\n          <div className=\"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white relative\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm\">\n                <RefreshCw className=\"w-5 h-5\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"font-bold text-base flex items-center space-x-2\">\n                  <span>Update Available!</span>\n                  <Sparkles className=\"w-4 h-4\" />\n                </h3>\n                <p className=\"text-sm text-green-100\">\n                  New features and improvements ready\n                </p>\n              </div>\n            </div>\n            \n            <button\n              onClick={handleDismiss}\n              className=\"absolute top-3 right-3 text-green-100 hover:text-white transition-colors p-1 rounded-full hover:bg-white/10\"\n              aria-label=\"Dismiss update notification\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"p-4\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-700 mb-2\">\n                 <strong>What's New:</strong>\n              </p>\n              <ul className=\"text-sm text-gray-600 space-y-1 ml-2\">\n                <li> Improved performance and stability</li>\n                <li> Enhanced user interface</li>\n                <li> Bug fixes and optimizations</li>\n              </ul>\n            </div>\n            \n            <div className=\"flex space-x-3\">\n              <button\n                onClick={handleUpdate}\n                className=\"flex-[2] bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold text-sm hover:bg-green-700 active:bg-green-800 transition-colors flex items-center justify-center space-x-2 shadow-lg\"\n              >\n                <RefreshCw className=\"w-4 h-4\" />\n                <span>Update Now</span>\n              </button>\n              <button\n                onClick={handleDismiss}\n                className=\"flex-1 py-3 px-4 text-gray-600 hover:text-gray-800 transition-colors text-sm font-medium hover:bg-gray-50 rounded-xl border border-gray-200\"\n              >\n                Later\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default TopUpdateToast;","import React, { useState, useEffect } from 'react';\nimport PWAInstallBanner from './PWAInstallBanner';\nimport IOSInstallModal from './IOSInstallModal';\nimport SmartInstallPrompt from './SmartInstallPrompt';\nimport TopUpdateToast from './TopUpdateToast';\nimport { pwaManager } from '../utils/pwa';\nimport { supabase } from '@/lib/supabase';\nimport { Capacitor } from '@capacitor/core';\n\nconst PWAInstallManager: React.FC = () => {\n  const [showIOSModal, setShowIOSModal] = useState(false);\n  const [showUpdateNotification, setShowUpdateNotification] = useState(false);\n\n  // Native builds (Capacitor) should not show any PWA install/update prompts.\n  if (Capacitor.isNativePlatform()) {\n    return null;\n  }\n\n  useEffect(() => {\n    // Track session start for timing calculations\n    if (!localStorage.getItem('session-start')) {\n      localStorage.setItem('session-start', Date.now().toString());\n    }\n\n    // Listen for iOS install prompt\n    const handleIOSInstallPrompt = () => {\n      setShowIOSModal(true);\n    };\n\n    // Listen for app updates\n    const handleUpdateAvailable = (event: any) => {\n      setShowUpdateNotification(true);\n    };\n\n    // Request notification permission after user engagement\n    const requestNotificationPermissionDelayed = () => {\n      setTimeout(async () => {\n        // Only request if user has interacted with the app and not already requested\n        const hasInteracted = localStorage.getItem('user-has-interacted');\n        const alreadyRequested = localStorage.getItem('notification-permission-requested');\n        \n        if (hasInteracted && !alreadyRequested) {\n          const granted = await pwaManager.requestNotificationPermission();\n          localStorage.setItem('notification-permission-requested', 'true');\n          \n          if (granted) {\n            // Subscribe to push notifications\n            await pwaManager.subscribeToPushNotifications();\n          }\n        }\n      }, 15000); // Wait 15 seconds after load\n    };\n\n    window.addEventListener('show-ios-install', handleIOSInstallPrompt);\n    window.addEventListener('pwa-update-available', handleUpdateAvailable);\n\n    // Track user interaction for notification permission\n    const trackInteraction = () => {\n      localStorage.setItem('user-has-interacted', 'true');\n      requestNotificationPermissionDelayed();\n    };\n\n    // Listen for first meaningful user interaction\n    const interactionEvents = ['click', 'scroll', 'touchstart'];\n    interactionEvents.forEach(event => {\n      document.addEventListener(event, trackInteraction, { once: true, passive: true });\n    });\n\n    // Track app usage patterns\n    const trackUsagePatterns = () => {\n      const visitCount = parseInt(localStorage.getItem('visit-count') || '0') + 1;\n      localStorage.setItem('visit-count', visitCount.toString());\n      localStorage.setItem('last-visit', Date.now().toString());\n      \n      // Track returning users for better install targeting\n      if (visitCount > 1) {\n        localStorage.setItem('is-returning-user', 'true');\n      }\n    };\n\n    trackUsagePatterns();\n\n    return () => {\n      window.removeEventListener('show-ios-install', handleIOSInstallPrompt);\n      window.removeEventListener('pwa-update-available', handleUpdateAvailable);\n      \n      interactionEvents.forEach(event => {\n        document.removeEventListener(event, trackInteraction);\n      });\n    };\n  }, []);\n\n  const handleUpdateApp = async () => {\n    try {\n      const { data } = await supabase.auth.getSession();\n      if (data?.session?.access_token && data.session.refresh_token) {\n        sessionStorage.setItem(\n          'fcz:update:session',\n          JSON.stringify({\n            access_token: data.session.access_token,\n            refresh_token: data.session.refresh_token,\n          }),\n        );\n      }\n    } catch (error) {\n      console.warn('[PWA] Failed to capture session before update:', error);\n    }\n\n    // Track update acceptance\n    if (typeof window !== 'undefined' && 'gtag' in window && typeof window.gtag === 'function') {\n      window.gtag('event', 'pwa_update_accepted', {\n        event_category: 'engagement',\n        event_label: 'app_update'\n      });\n    }\n    \n    window.location.reload();\n  };\n\n  const dismissUpdate = () => {\n    setShowUpdateNotification(false);\n    \n    // Track update dismissal\n    if (typeof window !== 'undefined' && 'gtag' in window && typeof window.gtag === 'function') {\n      window.gtag('event', 'pwa_update_dismissed', {\n        event_category: 'engagement',\n        event_label: 'app_update'\n      });\n    }\n  };\n\n  return (\n    <>\n      {/* Top Install Banner - Shows immediately when install is available */}\n      <PWAInstallBanner />\n      \n      {/* Smart Install Prompt - Shows based on user engagement */}\n      <SmartInstallPrompt />\n      \n      {/* iOS Install Modal - Shows detailed instructions for iOS users */}\n      <IOSInstallModal \n        isOpen={showIOSModal} \n        onClose={() => setShowIOSModal(false)} \n      />\n      \n      {/* \n        Update Notification - Top-centered toast with backdrop\n        Positioned to be highly visible without interfering with bottom navigation\n        Uses green brand color to match app theme\n      */}\n      <TopUpdateToast\n        isVisible={showUpdateNotification}\n        onUpdate={handleUpdateApp}\n        onDismiss={dismissUpdate}\n      />\n    </>\n  );\n};\n\nexport default PWAInstallManager;","import React, { Suspense, Component, ReactNode } from 'react';\n\ninterface PageWrapperProps {\n  children: ReactNode;\n  title?: string;\n  fallback?: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error?: Error;\n}\n\n// Error Boundary Component\nclass ErrorBoundary extends Component<{ children: ReactNode; onRetry: () => void }, ErrorBoundaryState> {\n  constructor(props: { children: ReactNode; onRetry: () => void }) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('PageWrapper Error Boundary caught an error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\n          <div className=\"text-center max-w-md\">\n            <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <svg className=\"w-8 h-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n              </svg>\n            </div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Something went wrong</h3>\n            <p className=\"text-gray-600 mb-4\">\n              {this.state.error?.message || 'An unexpected error occurred while loading this page.'}\n            </p>\n            <button\n              onClick={() => {\n                this.setState({ hasError: false, error: undefined });\n                this.props.onRetry();\n              }}\n              className=\"bg-teal-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors\"\n            >\n              Try Again\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Loading Spinner Component\nconst LoadingSpinner: React.FC<{ title?: string }> = ({ title = 'Loading...' }) => (\n  <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n    <div className=\"text-center\">\n      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500 mx-auto mb-4\"></div>\n      <p className=\"text-gray-600\">{title}</p>\n    </div>\n  </div>\n);\n\n// Main PageWrapper Component\nconst PageWrapper: React.FC<PageWrapperProps> = ({ \n  children, \n  title = 'Loading...',\n  fallback \n}) => {\n  const [retryKey, setRetryKey] = React.useState(0);\n\n  const handleRetry = () => {\n    setRetryKey(prev => prev + 1);\n  };\n\n  return (\n    <ErrorBoundary onRetry={handleRetry}>\n      <Suspense fallback={fallback || <LoadingSpinner title={title} />}>\n        <div key={retryKey}>\n          {children}\n        </div>\n      </Suspense>\n    </ErrorBoundary>\n  );\n};\n\nexport default PageWrapper;\n","/**\n * @param {string|RegExp} input The route pattern\n * @param {boolean} [loose] Allow open-ended matching. Ignored with `RegExp` input.\n */\nexport function parse(input, loose) {\n\tif (input instanceof RegExp) return { keys:false, pattern:input };\n\tvar c, o, tmp, ext, keys=[], pattern='', arr = input.split('/');\n\tarr[0] || arr.shift();\n\n\twhile (tmp = arr.shift()) {\n\t\tc = tmp[0];\n\t\tif (c === '*') {\n\t\t\tkeys.push(c);\n\t\t\tpattern += tmp[1] === '?' ? '(?:/(.*))?' : '/(.*)';\n\t\t} else if (c === ':') {\n\t\t\to = tmp.indexOf('?', 1);\n\t\t\text = tmp.indexOf('.', 1);\n\t\t\tkeys.push( tmp.substring(1, !!~o ? o : !!~ext ? ext : tmp.length) );\n\t\t\tpattern += !!~o && !~ext ? '(?:/([^/]+?))?' : '/([^/]+?)';\n\t\t\tif (!!~ext) pattern += (!!~o ? '?' : '') + '\\\\' + tmp.substring(ext);\n\t\t} else {\n\t\t\tpattern += '/' + tmp;\n\t\t}\n\t}\n\n\treturn {\n\t\tkeys: keys,\n\t\tpattern: new RegExp('^' + pattern + (loose ? '(?=$|\\/)' : '\\/?$'), 'i')\n\t};\n}\n\nvar RGX = /(\\/|^)([:*][^/]*?)(\\?)?(?=[/.]|$)/g;\n\n// error if key missing?\nexport function inject(route, values) {\n\treturn route.replace(RGX, (x, lead, key, optional) => {\n\t\tx = values[key=='*' ? key : key.substring(1)];\n\t\treturn x ? '/'+x : (optional || key=='*') ? '' : '/' + key;\n\t});\n}\n","import * as React from \"react\";\n\n// React.useInsertionEffect is not available in React <18\n// This hack fixes a transpilation issue on some apps\nconst useBuiltinInsertionEffect = React[\"useInsertion\" + \"Effect\"];\n\nexport {\n  useMemo,\n  useRef,\n  useState,\n  useContext,\n  createContext,\n  isValidElement,\n  cloneElement,\n  createElement,\n  Fragment,\n  forwardRef,\n} from \"react\";\n\n// To resolve webpack 5 errors, while not presenting problems for native,\n// we copy the approaches from https://github.com/TanStack/query/pull/3561\n// and https://github.com/TanStack/query/pull/3601\n// ~ Show this aging PR some love to remove the need for this hack:\n//   https://github.com/facebook/react/pull/25231 ~\nexport { useSyncExternalStore } from \"./use-sync-external-store.js\";\n\n// Copied from:\n// https://github.com/facebook/react/blob/main/packages/shared/ExecutionEnvironment.js\nconst canUseDOM = !!(\n  typeof window !== \"undefined\" &&\n  typeof window.document !== \"undefined\" &&\n  typeof window.document.createElement !== \"undefined\"\n);\n\n// Copied from:\n// https://github.com/reduxjs/react-redux/blob/master/src/utils/useIsomorphicLayoutEffect.ts\n// \"React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\"\nexport const useIsomorphicLayoutEffect = canUseDOM\n  ? React.useLayoutEffect\n  : React.useEffect;\n\n// useInsertionEffect is already a noop on the server.\n// See: https://github.com/facebook/react/blob/main/packages/react-server/src/ReactFizzHooks.js\nexport const useInsertionEffect =\n  useBuiltinInsertionEffect || useIsomorphicLayoutEffect;\n\n// Userland polyfill while we wait for the forthcoming\n// https://github.com/reactjs/rfcs/blob/useevent/text/0000-useevent.md\n// Note: \"A high-fidelity polyfill for useEvent is not possible because\n// there is no lifecycle or Hook in React that we can use to switch\n// .current at the right timing.\"\n// So we will have to make do with this \"close enough\" approach for now.\nexport const useEvent = (fn) => {\n  const ref = React.useRef([fn, (...args) => ref[0](...args)]).current;\n  // Per Dan Abramov: useInsertionEffect executes marginally closer to the\n  // correct timing for ref synchronization than useLayoutEffect on React 18.\n  // See: https://github.com/facebook/react/pull/25881#issuecomment-1356244360\n  useInsertionEffect(() => {\n    ref[0] = fn;\n  });\n  return ref[1];\n};\n","import { useSyncExternalStore } from \"./react-deps.js\";\n\n/**\n * History API docs @see https://developer.mozilla.org/en-US/docs/Web/API/History\n */\nconst eventPopstate = \"popstate\";\nconst eventPushState = \"pushState\";\nconst eventReplaceState = \"replaceState\";\nconst eventHashchange = \"hashchange\";\nconst events = [\n  eventPopstate,\n  eventPushState,\n  eventReplaceState,\n  eventHashchange,\n];\n\nconst subscribeToLocationUpdates = (callback) => {\n  for (const event of events) {\n    addEventListener(event, callback);\n  }\n  return () => {\n    for (const event of events) {\n      removeEventListener(event, callback);\n    }\n  };\n};\n\nexport const useLocationProperty = (fn, ssrFn) =>\n  useSyncExternalStore(subscribeToLocationUpdates, fn, ssrFn);\n\nconst currentSearch = () => location.search;\n\nexport const useSearch = ({ ssrSearch } = {}) =>\n  useLocationProperty(\n    currentSearch,\n    ssrSearch != null ? () => ssrSearch : currentSearch\n  );\n\nconst currentPathname = () => location.pathname;\n\nexport const usePathname = ({ ssrPath } = {}) =>\n  useLocationProperty(\n    currentPathname,\n    ssrPath != null ? () => ssrPath : currentPathname\n  );\n\nconst currentHistoryState = () => history.state;\nexport const useHistoryState = () =>\n  useLocationProperty(currentHistoryState, () => null);\n\nexport const navigate = (to, { replace = false, state = null } = {}) =>\n  history[replace ? eventReplaceState : eventPushState](state, \"\", to);\n\n// the 2nd argument of the `useBrowserLocation` return value is a function\n// that allows to perform a navigation.\nexport const useBrowserLocation = (opts = {}) => [usePathname(opts), navigate];\n\nconst patchKey = Symbol.for(\"wouter_v3\");\n\n// While History API does have `popstate` event, the only\n// proper way to listen to changes via `push/replaceState`\n// is to monkey-patch these methods.\n//\n// See https://stackoverflow.com/a/4585031\nif (typeof history !== \"undefined\" && typeof window[patchKey] === \"undefined\") {\n  for (const type of [eventPushState, eventReplaceState]) {\n    const original = history[type];\n    // TODO: we should be using unstable_batchedUpdates to avoid multiple re-renders,\n    // however that will require an additional peer dependency on react-dom.\n    // See: https://github.com/reactwg/react-18/discussions/86#discussioncomment-1567149\n    history[type] = function () {\n      const result = original.apply(this, arguments);\n      const event = new Event(type);\n      event.arguments = arguments;\n\n      dispatchEvent(event);\n      return result;\n    };\n  }\n\n  // patch history object only once\n  // See: https://github.com/molefrog/wouter/issues/167\n  Object.defineProperty(window, patchKey, { value: true });\n}\n","/*\n * Transforms `path` into its relative `base` version\n * If base isn't part of the path provided returns absolute path e.g. `~/app`\n */\nconst _relativePath = (base, path) =>\n  !path.toLowerCase().indexOf(base.toLowerCase())\n    ? path.slice(base.length) || \"/\"\n    : \"~\" + path;\n\n/**\n * When basepath is `undefined` or '/' it is ignored (we assume it's empty string)\n */\nconst baseDefaults = (base = \"\") => (base === \"/\" ? \"\" : base);\n\nexport const absolutePath = (to, base) =>\n  to[0] === \"~\" ? to.slice(1) : baseDefaults(base) + to;\n\nexport const relativePath = (base = \"\", path) =>\n  _relativePath(unescape(baseDefaults(base)), unescape(path));\n\n/*\n * Removes leading question mark\n */\nconst stripQm = (str) => (str[0] === \"?\" ? str.slice(1) : str);\n\n/*\n * decodes escape sequences such as %20\n */\nconst unescape = (str) => {\n  try {\n    return decodeURI(str);\n  } catch (_e) {\n    // fail-safe mode: if string can't be decoded do nothing\n    return str;\n  }\n};\n\nexport const sanitizeSearch = (search) => unescape(stripQm(search));\n","import { parse as parsePattern } from \"regexparam\";\n\nimport {\n  useBrowserLocation,\n  useSearch as useBrowserSearch,\n} from \"./use-browser-location.js\";\n\nimport {\n  useRef,\n  useContext,\n  createContext,\n  isValidElement,\n  cloneElement,\n  createElement as h,\n  Fragment,\n  forwardRef,\n  useIsomorphicLayoutEffect,\n  useEvent,\n  useMemo,\n} from \"./react-deps.js\";\nimport { absolutePath, relativePath, sanitizeSearch } from \"./paths.js\";\n\n/*\n * Router and router context. Router is a lightweight object that represents the current\n * routing options: how location is managed, base path etc.\n *\n * There is a default router present for most of the use cases, however it can be overridden\n * via the <Router /> component.\n */\n\nconst defaultRouter = {\n  hook: useBrowserLocation,\n  searchHook: useBrowserSearch,\n  parser: parsePattern,\n  base: \"\",\n  // this option is used to override the current location during SSR\n  ssrPath: undefined,\n  ssrSearch: undefined,\n  // optional context to track render state during SSR\n  ssrContext: undefined,\n  // customizes how `href` props are transformed for <Link />\n  hrefs: (x) => x,\n};\n\nconst RouterCtx = createContext(defaultRouter);\n\n// gets the closest parent router from the context\nexport const useRouter = () => useContext(RouterCtx);\n\n/**\n * Parameters context. Used by `useParams()` to get the\n * matched params from the innermost `Route` component.\n */\n\nconst Params0 = {},\n  ParamsCtx = createContext(Params0);\n\nexport const useParams = () => useContext(ParamsCtx);\n\n/*\n * Part 1, Hooks API: useRoute and useLocation\n */\n\n// Internal version of useLocation to avoid redundant useRouter calls\n\nconst useLocationFromRouter = (router) => {\n  const [location, navigate] = router.hook(router);\n\n  // the function reference should stay the same between re-renders, so that\n  // it can be passed down as an element prop without any performance concerns.\n  // (This is achieved via `useEvent`.)\n  return [\n    relativePath(router.base, location),\n    useEvent((to, navOpts) => navigate(absolutePath(to, router.base), navOpts)),\n  ];\n};\n\nexport const useLocation = () => useLocationFromRouter(useRouter());\n\nexport const useSearch = () => {\n  const router = useRouter();\n  return sanitizeSearch(router.searchHook(router));\n};\n\nexport const matchRoute = (parser, route, path, loose) => {\n  // if the input is a regexp, skip parsing\n  const { pattern, keys } =\n    route instanceof RegExp\n      ? { keys: false, pattern: route }\n      : parser(route || \"*\", loose);\n\n  // array destructuring loses keys, so this is done in two steps\n  const result = pattern.exec(path) || [];\n\n  // when parser is in \"loose\" mode, `$base` is equal to the\n  // first part of the route that matches the pattern\n  // (e.g. for pattern `/a/:b` and path `/a/1/2/3` the `$base` is `a/1`)\n  // we use this for route nesting\n  const [$base, ...matches] = result;\n\n  return $base !== undefined\n    ? [\n        true,\n\n        (() => {\n          // for regex paths, `keys` will always be false\n\n          // an object with parameters matched, e.g. { foo: \"bar\" } for \"/:foo\"\n          // we \"zip\" two arrays here to construct the object\n          // [\"foo\"], [\"bar\"]  { foo: \"bar\" }\n          const groups =\n            keys !== false\n              ? Object.fromEntries(keys.map((key, i) => [key, matches[i]]))\n              : result.groups;\n\n          // convert the array to an instance of object\n          // this makes it easier to integrate with the existing param implementation\n          let obj = { ...matches };\n\n          // merge named capture groups with matches array\n          groups && Object.assign(obj, groups);\n\n          return obj;\n        })(),\n\n        // the third value if only present when parser is in \"loose\" mode,\n        // so that we can extract the base path for nested routes\n        ...(loose ? [$base] : []),\n      ]\n    : [false, null];\n};\n\nexport const useRoute = (pattern) =>\n  matchRoute(useRouter().parser, pattern, useLocation()[0]);\n\n/*\n * Part 2, Low Carb Router API: Router, Route, Link, Switch\n */\n\nexport const Router = ({ children, ...props }) => {\n  // the router we will inherit from - it is the closest router in the tree,\n  // unless the custom `hook` is provided (in that case it's the default one)\n  const parent_ = useRouter();\n  const parent = props.hook ? defaultRouter : parent_;\n\n  // holds to the context value: the router object\n  let value = parent;\n\n  // when `ssrPath` contains a `?` character, we can extract the search from it\n  const [path, search] = props.ssrPath?.split(\"?\") ?? [];\n  if (search) (props.ssrSearch = search), (props.ssrPath = path);\n\n  // hooks can define their own `href` formatter (e.g. for hash location)\n  props.hrefs = props.hrefs ?? props.hook?.hrefs;\n\n  // hooks can define their own search hook (e.g. for memory location)\n  props.searchHook = props.searchHook ?? props.hook?.searchHook;\n\n  // what is happening below: to avoid unnecessary rerenders in child components,\n  // we ensure that the router object reference is stable, unless there are any\n  // changes that require reload (e.g. `base` prop changes -> all components that\n  // get the router from the context should rerender, even if the component is memoized).\n  // the expected behaviour is:\n  //\n  //   1) when the resulted router is no different from the parent, use parent\n  //   2) if the custom `hook` prop is provided, we always inherit from the\n  //      default router instead. this resets all previously overridden options.\n  //   3) when the router is customized here, it should stay stable between renders\n  let ref = useRef({}),\n    prev = ref.current,\n    next = prev;\n\n  for (let k in parent) {\n    const option =\n      k === \"base\"\n        ? /* base is special case, it is appended to the parent's base */\n          parent[k] + (props[k] || \"\")\n        : props[k] || parent[k];\n\n    if (prev === next && option !== next[k]) {\n      ref.current = next = { ...next };\n    }\n\n    next[k] = option;\n\n    // the new router is no different from the parent or from the memoized value, use parent\n    if (option !== parent[k] || option !== value[k]) value = next;\n  }\n\n  return h(RouterCtx.Provider, { value, children });\n};\n\nconst h_route = ({ children, component }, params) => {\n  // React-Router style `component` prop\n  if (component) return h(component, { params });\n\n  // support render prop or plain children\n  return typeof children === \"function\" ? children(params) : children;\n};\n\n// Cache params object between renders if values are shallow equal\nconst useCachedParams = (value) => {\n  let prev = useRef(Params0);\n  const curr = prev.current;\n  return (prev.current =\n    // Update cache if number of params changed or any value changed\n    Object.keys(value).length !== Object.keys(curr).length ||\n    Object.entries(value).some(([k, v]) => v !== curr[k])\n      ? value // Return new value if there are changes\n      : curr); // Return cached value if nothing changed\n};\n\nexport function useSearchParams() {\n  const [location, navigate] = useLocation();\n\n  const search = useSearch();\n  const searchParams = useMemo(() => new URLSearchParams(search), [search]);\n\n  // cached value before next render, so you can call setSearchParams multiple times\n  let tempSearchParams = searchParams;\n\n  const setSearchParams = useEvent((nextInit, options) => {\n    tempSearchParams = new URLSearchParams(\n      typeof nextInit === \"function\" ? nextInit(tempSearchParams) : nextInit\n    );\n    navigate(location + \"?\" + tempSearchParams, options);\n  });\n\n  return [searchParams, setSearchParams];\n}\n\nexport const Route = ({ path, nest, match, ...renderProps }) => {\n  const router = useRouter();\n  const [location] = useLocationFromRouter(router);\n\n  const [matches, routeParams, base] =\n    // `match` is a special prop to give up control to the parent,\n    // it is used by the `Switch` to avoid double matching\n    match ?? matchRoute(router.parser, path, location, nest);\n\n  // when `routeParams` is `null` (there was no match), the argument\n  // below becomes {...null} = {}, see the Object Spread specs\n  // https://tc39.es/proposal-object-rest-spread/#AbstractOperations-CopyDataProperties\n  const params = useCachedParams({ ...useParams(), ...routeParams });\n\n  if (!matches) return null;\n\n  const children = base\n    ? h(Router, { base }, h_route(renderProps, params))\n    : h_route(renderProps, params);\n\n  return h(ParamsCtx.Provider, { value: params, children });\n};\n\nexport const Link = forwardRef((props, ref) => {\n  const router = useRouter();\n  const [currentPath, navigate] = useLocationFromRouter(router);\n\n  const {\n    to = \"\",\n    href: targetPath = to,\n    onClick: _onClick,\n    asChild,\n    children,\n    className: cls,\n    /* eslint-disable no-unused-vars */\n    replace /* ignore nav props */,\n    state /* ignore nav props */,\n    /* eslint-enable no-unused-vars */\n\n    ...restProps\n  } = props;\n\n  const onClick = useEvent((event) => {\n    // ignores the navigation when clicked using right mouse button or\n    // by holding a special modifier key: ctrl, command, win, alt, shift\n    if (\n      event.ctrlKey ||\n      event.metaKey ||\n      event.altKey ||\n      event.shiftKey ||\n      event.button !== 0\n    )\n      return;\n\n    _onClick?.(event);\n    if (!event.defaultPrevented) {\n      event.preventDefault();\n      navigate(targetPath, props);\n    }\n  });\n\n  // handle nested routers and absolute paths\n  const href = router.hrefs(\n    targetPath[0] === \"~\" ? targetPath.slice(1) : router.base + targetPath,\n    router // pass router as a second argument for convinience\n  );\n\n  return asChild && isValidElement(children)\n    ? cloneElement(children, { onClick, href })\n    : h(\"a\", {\n        ...restProps,\n        onClick,\n        href,\n        // `className` can be a function to apply the class if this link is active\n        className: cls?.call ? cls(currentPath === targetPath) : cls,\n        children,\n        ref,\n      });\n});\n\nconst flattenChildren = (children) =>\n  Array.isArray(children)\n    ? children.flatMap((c) =>\n        flattenChildren(c && c.type === Fragment ? c.props.children : c)\n      )\n    : [children];\n\nexport const Switch = ({ children, location }) => {\n  const router = useRouter();\n  const [originalLocation] = useLocationFromRouter(router);\n\n  for (const element of flattenChildren(children)) {\n    let match = 0;\n\n    if (\n      isValidElement(element) &&\n      // we don't require an element to be of type Route,\n      // but we do require it to contain a truthy `path` prop.\n      // this allows to use different components that wrap Route\n      // inside of a switch, for example <AnimatedRoute />.\n      (match = matchRoute(\n        router.parser,\n        element.props.path,\n        location || originalLocation,\n        element.props.nest\n      ))[0]\n    )\n      return cloneElement(element, { match });\n  }\n\n  return null;\n};\n\nexport const Redirect = (props) => {\n  const { to, href = to } = props;\n  const router = useRouter();\n  const [, navigate] = useLocationFromRouter(router);\n  const redirect = useEvent(() => navigate(to || href, props));\n  const { ssrContext } = router;\n\n  // redirect is guaranteed to be stable since it is returned from useEvent\n  useIsomorphicLayoutEffect(() => {\n    redirect();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  if (ssrContext) {\n    ssrContext.redirectTo = to;\n  }\n\n  return null;\n};\n","import React, { useEffect, useState, useCallback, useRef, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { createPortal } from 'react-dom';\nimport { \n  ChevronRight, \n  ChevronLeft, \n  X, \n  Target, \n  Sparkles, \n  Compass, \n  Wallet,\n  CheckCircle,\n  ChevronsRight,\n  Play,\n  TrendingUp,\n  User,\n  Plus,\n  Search,\n  Filter,\n  BarChart3,\n  Settings\n} from 'lucide-react';\n\n// Types\nexport interface OnboardingStep {\n  id: string;\n  title: string;\n  description: string;\n  target?: string; // data-tour-id selector\n  placement?: 'top' | 'bottom' | 'left' | 'right' | 'center' | 'auto';\n  offset?: { x?: number; y?: number };\n  icon?: React.ReactNode;\n  action?: 'highlight' | 'modal' | 'spotlight';\n  onNext?: () => Promise<void> | void;\n  onPrev?: () => Promise<void> | void;\n  skipable?: boolean;\n  delay?: number; // ms delay before showing\n}\n\nexport interface OnboardingConfig {\n  steps: OnboardingStep[];\n  autoStart?: boolean;\n  showProgress?: boolean;\n  allowSkip?: boolean;\n  theme?: 'light' | 'dark';\n  persistent?: boolean; // Save progress if interrupted\n}\n\ninterface UseOnboardingState {\n  isActive: boolean;\n  currentStep: number;\n  completed: boolean;\n  skipped: boolean;\n  userPreferences: {\n    hasSeenOnboarding: boolean;\n    preferredTourStyle: 'full' | 'minimal' | 'none';\n    completedSteps: string[];\n  };\n}\n\n// Enhanced onboarding hook with improved state management\nexport const useOnboarding = () => {\n  const [state, setState] = useState<UseOnboardingState>(() => {\n    try {\n      const saved = localStorage.getItem('fcz_onboarding_state_v3');\n      return saved ? JSON.parse(saved) : {\n        isActive: false,\n        currentStep: 0,\n        completed: false,\n        skipped: false,\n        userPreferences: {\n          hasSeenOnboarding: false,\n          preferredTourStyle: 'full',\n          completedSteps: []\n        }\n      };\n    } catch {\n      return {\n        isActive: false,\n        currentStep: 0,\n        completed: false,\n        skipped: false,\n        userPreferences: {\n          hasSeenOnboarding: false,\n          preferredTourStyle: 'full',\n          completedSteps: []\n        }\n      };\n    }\n  });\n\n  const [config, setConfig] = useState<OnboardingConfig | null>(null);\n\n  // Save state to localStorage with error handling (functional to avoid stale state)\n  const saveState = useCallback((update: Partial<UseOnboardingState> | ((prev: UseOnboardingState) => Partial<UseOnboardingState>)) => {\n    setState(prev => {\n      const patch = typeof update === 'function' ? update(prev) : update;\n      const updatedState = { ...prev, ...patch } as UseOnboardingState;\n      try {\n        localStorage.setItem('fcz_onboarding_state_v3', JSON.stringify(updatedState));\n      } catch (error) {\n        console.warn('Failed to save onboarding state:', error);\n      }\n      return updatedState;\n    });\n  }, []);\n\n  const startOnboarding = useCallback((newConfig: OnboardingConfig) => {\n    setConfig(newConfig);\n    saveState({ \n      isActive: true, \n      currentStep: 0, \n      completed: false, \n      skipped: false \n    });\n  }, [saveState]);\n\n  const nextStep = useCallback(async () => {\n    if (!config) return;\n    const currentStepData = config.steps[state.currentStep];\n    if (currentStepData?.onNext) {\n      try {\n        await currentStepData.onNext();\n      } catch (error) {\n        console.warn('Step onNext handler failed:', error);\n      }\n    }\n\n    saveState(prev => {\n      const isLast = prev.currentStep >= (config?.steps.length || 0) - 1;\n      const completedSteps = currentStepData?.id\n        ? [...prev.userPreferences.completedSteps, currentStepData.id]\n        : prev.userPreferences.completedSteps;\n      if (isLast) {\n        return {\n          isActive: false,\n          completed: true,\n          userPreferences: {\n            ...prev.userPreferences,\n            hasSeenOnboarding: true,\n            completedSteps,\n          },\n        } as Partial<UseOnboardingState>;\n      }\n      return {\n        currentStep: prev.currentStep + 1,\n        userPreferences: {\n          ...prev.userPreferences,\n          completedSteps,\n        },\n      } as Partial<UseOnboardingState>;\n    });\n  }, [config, state.currentStep, saveState]);\n\n  const prevStep = useCallback(async () => {\n    const currentStepData = config?.steps[state.currentStep];\n    if (currentStepData?.onPrev) {\n      try {\n        await currentStepData.onPrev();\n      } catch (error) {\n        console.warn('Step onPrev handler failed:', error);\n      }\n    }\n    if (state.currentStep > 0) {\n      saveState(prev => ({ currentStep: Math.max(0, prev.currentStep - 1) }));\n    }\n  }, [config, state.currentStep, saveState]);\n\n  const skipOnboarding = useCallback(() => {\n    saveState(prev => ({\n      isActive: false,\n      skipped: true,\n      userPreferences: {\n        ...prev.userPreferences,\n        hasSeenOnboarding: true,\n        preferredTourStyle: 'minimal'\n      }\n    }));\n  }, [saveState]);\n\n  const resetOnboarding = useCallback(() => {\n    try {\n      localStorage.removeItem('fcz_onboarding_state_v3');\n      setState({\n        isActive: false,\n        currentStep: 0,\n        completed: false,\n        skipped: false,\n        userPreferences: {\n          hasSeenOnboarding: false,\n          preferredTourStyle: 'full',\n          completedSteps: []\n        }\n      });\n    } catch (error) {\n      console.warn('Failed to reset onboarding state:', error);\n    }\n  }, []);\n\n  return {\n    state,\n    config,\n    startOnboarding,\n    nextStep,\n    prevStep,\n    skipOnboarding,\n    resetOnboarding\n  };\n};\n\n// Improved positioning utility with mobile considerations\nconst calculateOptimalPosition = (\n  targetRect: DOMRect, \n  tooltipRect: DOMRect, \n  placement: string = 'auto'\n) => {\n  const viewport = {\n    width: window.innerWidth,\n    height: window.innerHeight\n  };\n  \n  // Account for mobile safe areas and navigation\n  const safeArea = {\n    top: 44, // Status bar\n    bottom: 100, // Bottom navigation + safe area\n    left: 16,\n    right: 16\n  };\n  \n  const spacing = 16; // Increased spacing for mobile\n  const positions = {\n    top: {\n      x: Math.max(safeArea.left, Math.min(\n        targetRect.left + (targetRect.width - tooltipRect.width) / 2,\n        viewport.width - tooltipRect.width - safeArea.right\n      )),\n      y: Math.max(safeArea.top, targetRect.top - tooltipRect.height - spacing)\n    },\n    bottom: {\n      x: Math.max(safeArea.left, Math.min(\n        targetRect.left + (targetRect.width - tooltipRect.width) / 2,\n        viewport.width - tooltipRect.width - safeArea.right\n      )),\n      y: Math.min(\n        viewport.height - tooltipRect.height - safeArea.bottom,\n        targetRect.bottom + spacing\n      )\n    },\n    left: {\n      x: Math.max(safeArea.left, targetRect.left - tooltipRect.width - spacing),\n      y: Math.max(safeArea.top, Math.min(\n        targetRect.top + (targetRect.height - tooltipRect.height) / 2,\n        viewport.height - tooltipRect.height - safeArea.bottom\n      ))\n    },\n    right: {\n      x: Math.min(\n        viewport.width - tooltipRect.width - safeArea.right,\n        targetRect.right + spacing\n      ),\n      y: Math.max(safeArea.top, Math.min(\n        targetRect.top + (targetRect.height - tooltipRect.height) / 2,\n        viewport.height - tooltipRect.height - safeArea.bottom\n      ))\n    },\n    center: {\n      x: (viewport.width - tooltipRect.width) / 2,\n      y: (viewport.height - tooltipRect.height) / 2\n    }\n  };\n\n  if (placement !== 'auto') {\n    return positions[placement as keyof typeof positions] || positions.center;\n  }\n\n  // Auto-placement logic with better mobile considerations\n  const availableSpace = {\n    top: targetRect.top - safeArea.top,\n    bottom: viewport.height - targetRect.bottom - safeArea.bottom,\n    left: targetRect.left - safeArea.left,\n    right: viewport.width - targetRect.right - safeArea.right\n  };\n\n  const fits = {\n    top: availableSpace.top >= tooltipRect.height + spacing,\n    bottom: availableSpace.bottom >= tooltipRect.height + spacing,\n    left: availableSpace.left >= tooltipRect.width + spacing,\n    right: availableSpace.right >= tooltipRect.width + spacing\n  };\n\n  // Prefer bottom for mobile, then top, then center\n  if (fits.bottom) return positions.bottom;\n  if (fits.top) return positions.top;\n  if (fits.right && tooltipRect.width < 300) return positions.right;\n  if (fits.left && tooltipRect.width < 300) return positions.left;\n  \n  return positions.center;\n};\n\n// Enhanced Tooltip Component with better mobile UX\ninterface TooltipProps {\n  step: OnboardingStep;\n  position: { x: number; y: number };\n  onNext: () => void;\n  onPrev: () => void;\n  onSkip: () => void;\n  isFirst: boolean;\n  isLast: boolean;\n  stepNumber: number;\n  totalSteps: number;\n  canSkip: boolean;\n}\n\nconst OnboardingTooltip: React.FC<TooltipProps> = ({\n  step,\n  position,\n  onNext,\n  onPrev,\n  onSkip,\n  isFirst,\n  isLast,\n  stepNumber,\n  totalSteps,\n  canSkip\n}) => {\n  const handleNext = useCallback(() => {\n    console.log('Next button clicked, calling onNext');\n    onNext();\n  }, [onNext]);\n\n  const handlePrev = useCallback(() => {\n    console.log('Previous button clicked, calling onPrev');\n    onPrev();\n  }, [onPrev]);\n\n  const handleSkip = useCallback(() => {\n    console.log('Skip button clicked, calling onSkip');\n    onSkip();\n  }, [onSkip]);\n\n  return (\n    <motion.div\n      className=\"fixed bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden max-w-sm z-[25000]\"\n      style={{\n        left: position.x,\n        top: position.y,\n        width: 'min(calc(100vw - 32px), 380px)'\n      }}\n      initial={{ scale: 0.8, opacity: 0, y: 10 }}\n      animate={{ scale: 1, opacity: 1, y: 0 }}\n      exit={{ scale: 0.8, opacity: 0, y: 10 }}\n      transition={{ duration: 0.2, ease: \"easeOut\" }}\n    >\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-500 to-teal-600 p-4 text-white\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            {step.icon && (\n              <div className=\"w-6 h-6 flex items-center justify-center\">\n                {step.icon}\n              </div>\n            )}\n            <h3 className=\"font-semibold text-lg\">{step.title}</h3>\n          </div>\n          {canSkip && (\n            <button\n              onClick={handleSkip}\n              className=\"p-1 rounded-lg hover:bg-white/10 transition-colors\"\n              aria-label=\"Skip tour\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n          )}\n        </div>\n        \n        {/* Progress indicator */}\n        <div className=\"mt-3 flex items-center gap-2\">\n          <div className=\"flex-1 bg-white/20 rounded-full h-2\">\n            <div \n              className=\"bg-white rounded-full h-2 transition-all duration-300\"\n              style={{ width: `${((stepNumber + 1) / totalSteps) * 100}%` }}\n            />\n          </div>\n          <span className=\"text-xs font-medium\">\n            {stepNumber + 1} of {totalSteps}\n          </span>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"p-4\">\n        <p className=\"text-gray-700 text-sm leading-relaxed mb-4\">\n          {step.description}\n        </p>\n\n        {/* Actions */}\n        <div className=\"flex items-center justify-between gap-3\">\n          <button\n            onClick={handlePrev}\n            disabled={isFirst}\n            className=\"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-100 text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200 transition-colors text-sm font-medium min-w-[80px] justify-center\"\n          >\n            <ChevronLeft className=\"w-4 h-4\" />\n            Previous\n          </button>\n\n          <div className=\"flex items-center gap-1\">\n            {Array.from({ length: totalSteps }, (_, i) => (\n              <div\n                key={i}\n                className={`w-2 h-2 rounded-full transition-colors ${\n                  i === stepNumber ? 'bg-teal-500' : 'bg-gray-200'\n                }`}\n              />\n            ))}\n          </div>\n\n          <button\n            onClick={handleNext}\n            className=\"flex items-center gap-1 px-4 py-2 rounded-xl bg-teal-500 text-white hover:bg-teal-600 transition-colors text-sm font-medium min-w-[80px] justify-center\"\n          >\n            {isLast ? (\n              <>\n                <CheckCircle className=\"w-4 h-4\" />\n                Finish\n              </>\n            ) : (\n              <>\n                Next\n                <ChevronRight className=\"w-4 h-4\" />\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </motion.div>\n  );\n};\n\n// Improved Spotlight overlay with better performance\nconst SpotlightOverlay: React.FC<{ targetRect: DOMRect | null }> = ({ targetRect }) => {\n  const maskId = useMemo(() => `spotlight-${Math.random().toString(36).substr(2, 9)}`, []);\n  \n  if (!targetRect) return null;\n\n  const radius = Math.max(targetRect.width, targetRect.height) / 2 + 20;\n  const centerX = targetRect.left + targetRect.width / 2;\n  const centerY = targetRect.top + targetRect.height / 2;\n\n  return (\n    <div className=\"fixed inset-0 z-[24000] pointer-events-none\">\n      <svg width=\"100%\" height=\"100%\" className=\"absolute inset-0\">\n        <defs>\n          <mask id={maskId}>\n            <rect width=\"100%\" height=\"100%\" fill=\"white\" />\n            <circle\n              cx={centerX}\n              cy={centerY}\n              r={radius}\n              fill=\"black\"\n            />\n          </mask>\n        </defs>\n        <rect\n          width=\"100%\"\n          height=\"100%\"\n          fill=\"rgba(0,0,0,0.7)\"\n          mask={`url(#${maskId})`}\n        />\n      </svg>\n    </div>\n  );\n};\n\n// Main Onboarding System Component\ninterface OnboardingSystemProps {\n  isActive: boolean;\n  config: OnboardingConfig | null;\n  currentStep: number;\n  onNext: () => void;\n  onPrev: () => void;\n  onSkip: () => void;\n}\n\nexport const OnboardingSystem: React.FC<OnboardingSystemProps> = ({\n  isActive,\n  config,\n  currentStep,\n  onNext,\n  onPrev,\n  onSkip\n}) => {\n  const [targetElement, setTargetElement] = useState<Element | null>(null);\n  const [targetRect, setTargetRect] = useState<DOMRect | null>(null);\n  const [tooltipPosition, setTooltipPosition] = useState({ x: 0, y: 0 });\n  const tooltipRef = useRef<HTMLDivElement>(null);\n  const resizeObserverRef = useRef<ResizeObserver | null>(null);\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  const step = config?.steps[currentStep];\n\n  // Update target element and positioning with improved error handling\n  useEffect(() => {\n    if (!isActive || !step?.target) {\n      setTargetElement(null);\n      setTargetRect(null);\n      return;\n    }\n\n    const selectTourElement = (target: string): Element | null => {\n      if (!target) return null;\n\n      // Allow raw CSS selectors for flexibility\n      if (/^[.#\\[]/.test(target) || target.includes(' ')) {\n        try {\n          return document.querySelector(target);\n        } catch (error) {\n          console.warn('Invalid tour selector:', target, error);\n          return null;\n        }\n      }\n\n      return (\n        document.querySelector(`[data-tour-id=\"${target}\"]`) ||\n        document.querySelector(`[data-tour=\"${target}\"]`)\n      );\n    };\n\n    const updateTargetPosition = () => {\n      if (!step?.target) {\n        setTargetElement(null);\n        setTargetRect(null);\n        return;\n      }\n\n      try {\n        const element = selectTourElement(step.target);\n        if (element) {\n          const rect = element.getBoundingClientRect();\n          setTargetElement(element);\n          setTargetRect(rect);\n\n          // Scroll element into view with better mobile handling\n          element.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center'\n          });\n        } else {\n          console.warn(`Onboarding target not found: ${step.target}`);\n          setTargetElement(null);\n          setTargetRect(null);\n        }\n      } catch (error) {\n        console.warn('Error updating target position:', error);\n      }\n    };\n\n    // Initial positioning with delay for better UX\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n    \n    timeoutRef.current = setTimeout(updateTargetPosition, step.delay || 100);\n\n    // Watch for resize and scroll changes\n    const handleResize = () => updateTargetPosition();\n    const handleScroll = () => updateTargetPosition();\n\n    window.addEventListener('resize', handleResize);\n    window.addEventListener('scroll', handleScroll, true);\n    window.addEventListener('orientationchange', handleResize);\n\n    // Use ResizeObserver for target element changes\n    if (resizeObserverRef.current) {\n      resizeObserverRef.current.disconnect();\n    }\n\n    resizeObserverRef.current = new ResizeObserver(updateTargetPosition);\n    \n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      window.removeEventListener('resize', handleResize);\n      window.removeEventListener('scroll', handleScroll, true);\n      window.removeEventListener('orientationchange', handleResize);\n      if (resizeObserverRef.current) {\n        resizeObserverRef.current.disconnect();\n      }\n    };\n  }, [isActive, step, currentStep]);\n\n  // Calculate tooltip position when target rect changes\n  useEffect(() => {\n    if (targetRect && tooltipRef.current) {\n      // Create a DOMRect-like object for tooltip dimensions\n      const tooltipRect = new DOMRect(0, 0, 380, 200);\n      let position = calculateOptimalPosition(\n        targetRect,\n        tooltipRect,\n        step?.placement || 'auto'\n      );\n      if (step?.offset) {\n        position = {\n          x: position.x + (step.offset.x ?? 0),\n          y: position.y + (step.offset.y ?? 0)\n        };\n      }\n      setTooltipPosition(position);\n    }\n  }, [targetRect, step?.placement]);\n\n  // Focus management for accessibility\n  useEffect(() => {\n    if (isActive) {\n      const timer = setTimeout(() => {\n        const tooltip = document.querySelector('[data-onboarding-tooltip]');\n        if (tooltip) {\n          (tooltip as HTMLElement).focus();\n        }\n      }, 100);\n      return () => clearTimeout(timer);\n    }\n  }, [isActive, currentStep]);\n\n  if (!isActive || !config || !step) {\n    return null;\n  }\n\n  const content = (\n    <AnimatePresence mode=\"wait\">\n      <motion.div\n        key={`onboarding-${currentStep}`}\n        className=\"fixed inset-0 z-[23000]\"\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        transition={{ duration: 0.2 }}\n      >\n        {/* Backdrop */}\n        {step.action === 'spotlight' && targetRect ? (\n          <SpotlightOverlay targetRect={targetRect} />\n        ) : (\n          <div className=\"absolute inset-0 bg-black/40\" />\n        )}\n\n        {/* Highlight border for target element */}\n        {targetRect && step.target && (\n          <motion.div\n            className=\"absolute border-4 border-teal-400 rounded-xl pointer-events-none shadow-lg\"\n            style={{\n              left: Math.max(0, targetRect.left - 4),\n              top: Math.max(0, targetRect.top - 4),\n              width: Math.min(window.innerWidth, targetRect.width + 8),\n              height: targetRect.height + 8\n            }}\n            initial={{ scale: 0.8, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            transition={{ duration: 0.3, delay: 0.1 }}\n          />\n        )}\n\n        {/* Tooltip */}\n        <div ref={tooltipRef} data-onboarding-tooltip tabIndex={-1}>\n          <OnboardingTooltip\n            step={step}\n            position={tooltipPosition}\n            onNext={onNext}\n            onPrev={onPrev}\n            onSkip={onSkip}\n            isFirst={currentStep === 0}\n            isLast={currentStep === config.steps.length - 1}\n            stepNumber={currentStep}\n            totalSteps={config.steps.length}\n            canSkip={config.allowSkip !== false}\n          />\n        </div>\n      </motion.div>\n    </AnimatePresence>\n  );\n\n  return createPortal(content, document.body);\n};\n\n// Welcome Modal Component with improved mobile UX\ninterface WelcomeModalProps {\n  isOpen: boolean;\n  onStartTour: () => void;\n  onSkip: () => void;\n  onMinimalTour: () => void;\n}\n\nexport const WelcomeModal: React.FC<WelcomeModalProps> = ({\n  isOpen,\n  onStartTour,\n  onSkip,\n  onMinimalTour\n}) => {\n  const handleStartTour = useCallback(() => {\n    console.log('Welcome modal: Start Tour clicked');\n    onStartTour();\n  }, [onStartTour]);\n\n  const handleMinimalTour = useCallback(() => {\n    console.log('Welcome modal: Quick Overview clicked');\n    onMinimalTour();\n  }, [onMinimalTour]);\n\n  const handleSkip = useCallback(() => {\n    console.log('Welcome modal: Skip clicked');\n    onSkip();\n  }, [onSkip]);\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <div className=\"fixed inset-0 z-[26000] flex items-center justify-center p-4\">\n          <motion.div\n            className=\"absolute inset-0 bg-black/50\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          />\n          \n          <motion.div\n            className=\"relative bg-white rounded-3xl shadow-2xl overflow-hidden w-full max-w-md\"\n            initial={{ scale: 0.9, opacity: 0, y: 20 }}\n            animate={{ scale: 1, opacity: 1, y: 0 }}\n            exit={{ scale: 0.9, opacity: 0, y: 20 }}\n            transition={{ duration: 0.3, ease: \"easeOut\" }}\n          >\n            {/* Header with gradient */}\n            <div className=\"bg-gradient-to-br from-purple-500 via-teal-600 to-teal-600 p-6 text-white text-center relative overflow-hidden\">\n              <motion.div\n                className=\"absolute inset-0 bg-white/10\"\n                animate={{\n                  background: [\n                    \"radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%)\",\n                    \"radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 0%, transparent 50%)\",\n                    \"radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%)\"\n                  ]\n                }}\n                transition={{ duration: 4, repeat: Infinity, ease: \"linear\" }}\n              />\n              <div className=\"relative z-10\">\n                <motion.div\n                  initial={{ scale: 0 }}\n                  animate={{ scale: 1 }}\n                  transition={{ delay: 0.2, duration: 0.3 }}\n                  className=\"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4\"\n                >\n                  <Sparkles className=\"w-8 h-8\" />\n                </motion.div>\n                <h2 className=\"text-2xl font-bold mb-2\">Welcome to Fan Club Z!</h2>\n                <p className=\"text-teal-100 text-sm\">\n                  Ready to discover the future of social predictions?\n                </p>\n              </div>\n            </div>\n\n            {/* Content */}\n            <div className=\"p-6\">\n              <div className=\"space-y-4 mb-6\">\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-10 h-10 bg-gradient-to-r from-purple-400 to-teal-500 rounded-xl flex items-center justify-center flex-shrink-0\">\n                    <Compass className=\"w-5 h-5 text-teal-600\" />\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900\">Discover Predictions</h3>\n                    <p className=\"text-sm text-gray-600\">Explore trending markets and join the community</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0\">\n                    <Target className=\"w-5 h-5 text-blue-600\" />\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900\">Make Your Predictions</h3>\n                    <p className=\"text-sm text-gray-600\">Put your knowledge to the test and earn rewards</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0\">\n                    <Wallet className=\"w-5 h-5 text-purple-600\" />\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900\">Manage Everything</h3>\n                    <p className=\"text-sm text-gray-600\">Track your performance and manage your wallet</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Action buttons */}\n              <div className=\"space-y-3\">\n                <button\n                  onClick={handleStartTour}\n                  className=\"w-full bg-teal-500 hover:bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold transition-colors flex items-center justify-center gap-2\"\n                >\n                  <Play className=\"w-4 h-4\" />\n                  Take the Tour\n                </button>\n                \n                <button\n                  onClick={handleMinimalTour}\n                  className=\"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-4 rounded-xl font-medium transition-colors\"\n                >\n                  Quick Overview\n                </button>\n                \n                <button\n                  onClick={handleSkip}\n                  className=\"w-full text-gray-500 hover:text-gray-700 py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-1\"\n                >\n                  <ChevronsRight className=\"w-4 h-4\" />\n                  Skip for now\n                </button>\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default OnboardingSystem;","type LexKey =\n  | \"bet\"\n  | \"bets\"\n  | \"betVerb\"\n  | \"myBets\"\n  | \"betSlip\"\n  | \"wager\"\n  | \"winnings\"\n  | \"cashOut\"\n  | \"odds\"\n  | \"betting\";\n\nexport type Lexicon = Record<LexKey, string>;\n\nconst SAFE: Lexicon = {\n  bet: \"stake\",\n  bets: \"stakes\",\n  betVerb: \"Lock stake\",\n  myBets: \"Stakes\",\n  betSlip: \"Prediction ticket\",\n  wager: \"Stake amount\",\n  winnings: \"Payout\",\n  cashOut: \"Withdraw\",\n  odds: \"Payout ratio\",\n  betting: \"predicting\",\n};\n\nexport function L(): Lexicon {\n  return SAFE;\n}\n\nexport function t<K extends LexKey>(k: K): string {\n  return L()[k];\n}\n\n","import { \n  BarChart3, \n  DollarSign,\n  Wallet as WalletIcon,\n  TrendingUp,\n  Plus,\n  Home,\n  Sparkles\n} from 'lucide-react';\nimport type { OnboardingStep } from '../components/onboarding/OnboardingSystem';\nimport { t } from '@/lib/lexicon';\n\n/**\n * Streamlined Contextual Onboarding Tour\n * \n * A concise 5-step tour focusing on the most critical features:\n * 1. Welcome\n * 2. Browse Predictions\n * 3. Create Predictions\n * 4. Track Bets\n * 5. Manage Wallet\n */\n\n// Streamlined tour - 5 essential steps only\nexport const FULL_CONTEXTUAL_TOUR: OnboardingStep[] = [\n  // Step 1: Welcome\n  {\n    id: 'welcome',\n    title: 'Welcome to FanClubZ!',\n    description: `Let's show you the essentials in just 5 quick steps. You'll learn how to discover predictions, create your own, track ${t('bets')}, and manage your wallet.`,\n    placement: 'center',\n    icon: <Sparkles className=\"w-6 h-6\" />,\n    action: 'modal',\n    delay: 300\n  },\n  \n  // Step 2: Discover Predictions (Discover page)\n  {\n    id: 'discover-feed',\n    title: 'Discover Predictions',\n    description: `Browse active predictions here. Each card shows the title, category, pool size, and closing date. Tap any card to ${t('betVerb').toLowerCase()}!`,\n    target: 'discover-list',\n    placement: 'top',\n    offset: { y: -40 },\n    icon: <BarChart3 className=\"w-5 h-5\" />,\n    action: 'highlight'\n  },\n  \n  // Step 3: Create Predictions (Discover page - FAB)\n  {\n    id: 'create-prediction-fab',\n    title: 'Create Your Own',\n    description: 'Got an idea? Tap the plus button to create your own prediction and invite others to participate.',\n    target: 'create-fab',\n    placement: 'left',\n    offset: { x: -16, y: -80 },\n    icon: <Plus className=\"w-5 h-5\" />,\n    action: 'spotlight'\n  },\n  \n  // Step 4: Track Bets (Navigate to Bets page)\n  {\n    id: 'navigate-to-bets',\n    title: 'Track Your Stakes',\n    description: `Visit the ${t('myBets')} tab to track all your active predictions, see predictions you've created, and review completed ${t('bets')}.`,\n    target: 'tab-bets',\n    placement: 'top',\n    offset: { y: -40 },\n    icon: <TrendingUp className=\"w-5 h-5\" />,\n    action: 'spotlight',\n    onNext: async () => {\n      const navigate = (window as any).__router_navigate;\n      if (navigate) {\n        navigate('/bets');\n        // Wait for page to load\n        await new Promise(resolve => setTimeout(resolve, 500));\n      }\n    }\n  },\n  \n  // Step 5: Manage Wallet (Navigate to Wallet page)\n  {\n    id: 'navigate-to-wallet',\n    title: 'Manage Your Wallet',\n    description: `Your Wallet is where you add funds, withdraw ${t('winnings').toLowerCase()}, and track all transactions. Let's check it out!`,\n    target: 'tab-wallet',\n    placement: 'top',\n    offset: { y: -40 },\n    icon: <WalletIcon className=\"w-5 h-5\" />,\n    action: 'spotlight',\n    onNext: async () => {\n      const navigate = (window as any).__router_navigate;\n      if (navigate) {\n        navigate('/wallet');\n        await new Promise(resolve => setTimeout(resolve, 500));\n        \n        // After showing wallet, return to discover\n        setTimeout(() => {\n          navigate('/');\n        }, 2000);\n      }\n    }\n  }\n];\n\n// Quick tour - 3 essential steps (Discover page only)\nexport const QUICK_DISCOVER_TOUR: OnboardingStep[] = [\n  {\n    id: 'quick-welcome',\n    title: 'Welcome!',\n    description: 'Let\\'s quickly show you the essentials in 3 steps.',\n    placement: 'center',\n    icon: <Sparkles className=\"w-6 h-6\" />,\n    action: 'modal'\n  },\n  {\n    id: 'quick-discover',\n    title: 'Browse Predictions',\n    description: 'Scroll through active predictions. Tap any card to view details and place your bet.',\n    target: 'discover-list',\n    placement: 'top',\n    offset: { y: -40 },\n    icon: <BarChart3 className=\"w-5 h-5\" />,\n    action: 'highlight'\n  },\n  {\n    id: 'quick-create',\n    title: 'Create Predictions',\n    description: 'Got an idea? Tap the plus button to create your own prediction. You\\'re all set!',\n    target: 'create-fab',\n    placement: 'left',\n    offset: { x: -16, y: -80 },\n    icon: <Plus className=\"w-5 h-5\" />,\n    action: 'spotlight'\n  }\n];\n\n// Context-aware tour configurations\nexport const CONTEXTUAL_TOURS = {\n  full: {\n    steps: FULL_CONTEXTUAL_TOUR,\n    autoStart: false,\n    showProgress: true,\n    allowSkip: true,\n    theme: 'light',\n    persistent: true\n  },\n  quick: {\n    steps: QUICK_DISCOVER_TOUR,\n    autoStart: false,\n    showProgress: true,\n    allowSkip: true,\n    theme: 'light',\n    persistent: false\n  }\n};\n\n","import React, { createContext, useContext, useCallback, useEffect, useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { isDev } from '@/utils/environment';\nimport { useAuthStore } from '@/store/authStore';\nimport { \n  OnboardingSystem, \n  WelcomeModal, \n  useOnboarding,\n  type OnboardingStep \n} from './OnboardingSystem';\nimport { \n  FULL_CONTEXTUAL_TOUR,\n  QUICK_DISCOVER_TOUR\n} from '@/config/contextualOnboardingTours';\n\n// Enhanced onboarding context\ninterface OnboardingContextValue {\n  isActive: boolean;\n  showWelcome: boolean;\n  startFullTour: () => void;\n  startQuickTour: () => void;\n  skipOnboarding: () => void;\n  resetOnboarding: () => void;\n  hasSeenOnboarding: boolean;\n  currentStep: number;\n  totalSteps: number;\n}\n\nconst OnboardingContext = createContext<OnboardingContextValue | undefined>(undefined);\n\n// Use contextual tours imported from config\nconst FULL_TOUR_STEPS: OnboardingStep[] = FULL_CONTEXTUAL_TOUR;\nconst QUICK_TOUR_STEPS: OnboardingStep[] = QUICK_DISCOVER_TOUR;\n\n// Smart trigger conditions\nconst shouldShowOnboarding = () => {\n  try {\n    const stored = localStorage.getItem('fcz_onboarding_state_v3');\n    if (!stored) return true;\n    \n    const state = JSON.parse(stored);\n    return !state.userPreferences?.hasSeenOnboarding;\n  } catch {\n    return true;\n  }\n};\n\nconst shouldShowWelcomeModal = () => {\n  // Show welcome modal for first-time users or when explicitly requested\n  const urlParams = new URLSearchParams(window.location.search);\n  const forceWelcome = urlParams.get('welcome') === '1';\n  \n  return forceWelcome || shouldShowOnboarding();\n};\n\n// Enhanced Onboarding Provider\nexport const OnboardingProvider: React.FC<{ children: React.ReactNode }> = ({ \n  children \n}) => {\n  const [location, navigate] = useLocation();\n  const {\n    state,\n    config,\n    startOnboarding,\n    nextStep,\n    prevStep,\n    skipOnboarding,\n    resetOnboarding\n  } = useOnboarding();\n\n  const [showWelcome, setShowWelcome] = useState(false);\n  const { user, loading: authLoading } = useAuthStore();\n  \n  // Gate: Don't run tour during auth flow or modals\n  // Check UI readiness based on current route, not just discover page\n  const checkUIReady = () => {\n    const path = location.toLowerCase();\n    if (path === '/' || path === '/discover') {\n      return !!document.querySelector('[data-tour=\"discover-header\"]');\n    }\n    // For other pages, just check if user is signed in and auth is loaded\n    return true;\n  };\n\n  const canRunTour = \n    user && // Signed in\n    !authLoading && // Auth loaded\n    checkUIReady(); // UI ready for current page\n\n  // Store navigate function globally for onboarding steps\n  useEffect(() => {\n    (window as any).__router_navigate = navigate;\n    return () => {\n      delete (window as any).__router_navigate;\n    };\n  }, [navigate]);\n\n  // Check if we should show onboarding on app start\n  // Reduced delay and check UI readiness before showing\n  useEffect(() => {\n    if (!user || authLoading) return; // Wait for auth\n    \n    const checkAndShow = () => {\n      // Only show welcome modal on discover page for first-time users\n      if ((location === '/' || location === '/discover') && shouldShowWelcomeModal()) {\n        // Check if UI is ready before showing\n        if (checkUIReady()) {\n          setShowWelcome(true);\n        } else {\n          // Retry after a short delay if UI not ready\n          setTimeout(checkAndShow, 200);\n        }\n      }\n    };\n\n    // Start checking immediately, but with a small delay for initial render\n    const timer = setTimeout(checkAndShow, 300);\n\n    return () => clearTimeout(timer);\n  }, [user, authLoading, location]);\n\n  // URL-based tour triggers\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const tourType = urlParams.get('tour');\n    \n    if (tourType === 'full') {\n      handleStartFullTour();\n    } else if (tourType === 'quick') {\n      handleStartQuickTour();\n    }\n  }, [location]);\n\n  const handleStartFullTour = useCallback(() => {\n    setShowWelcome(false);\n    \n    // Ensure we're on the discover page for the full tour\n    if (location !== '/' && location !== '/discover') {\n      navigate('/');\n      // Wait for navigation and UI to be ready before starting tour\n      const checkAndStart = () => {\n        const header = document.querySelector('[data-tour=\"discover-header\"]');\n        if (header) {\n          startOnboarding({\n            steps: FULL_TOUR_STEPS,\n            allowSkip: true,\n            showProgress: true,\n            persistent: true\n          });\n        } else {\n          // Retry if UI not ready yet\n          setTimeout(checkAndStart, 100);\n        }\n      };\n      setTimeout(checkAndStart, 200);\n    } else {\n      // Already on discover page, start immediately\n      startOnboarding({\n        steps: FULL_TOUR_STEPS,\n        allowSkip: true,\n        showProgress: true,\n        persistent: true\n      });\n    }\n  }, [location, navigate, startOnboarding]);\n\n  const handleStartQuickTour = useCallback(() => {\n    setShowWelcome(false);\n    startOnboarding({\n      steps: QUICK_TOUR_STEPS,\n      allowSkip: true,\n      showProgress: true,\n      persistent: false\n    });\n  }, [startOnboarding]);\n\n  const handleSkipOnboarding = useCallback(() => {\n    setShowWelcome(false);\n    skipOnboarding();\n  }, [skipOnboarding]);\n\n  const handleResetOnboarding = useCallback(() => {\n    resetOnboarding();\n    setShowWelcome(true);\n  }, [resetOnboarding]);\n\n  // Context value\n  const contextValue: OnboardingContextValue = {\n    isActive: !!(state.isActive && canRunTour),\n    showWelcome,\n    startFullTour: handleStartFullTour,\n    startQuickTour: handleStartQuickTour,\n    skipOnboarding: handleSkipOnboarding,\n    resetOnboarding: handleResetOnboarding,\n    hasSeenOnboarding: state.userPreferences.hasSeenOnboarding,\n    currentStep: state.currentStep,\n    totalSteps: config?.steps.length || 0\n  };\n\n  // Don't render tour if gated\n  if (!canRunTour && state.isActive) {\n    return <OnboardingContext.Provider value={contextValue}>{children}</OnboardingContext.Provider>;\n  }\n\n  return (\n    <OnboardingContext.Provider value={contextValue}>\n      {children}\n      \n      {/* Welcome Modal */}\n      {canRunTour && (\n        <WelcomeModal\n          isOpen={showWelcome}\n          onStartTour={handleStartFullTour}\n          onMinimalTour={handleStartQuickTour}\n          onSkip={handleSkipOnboarding}\n        />\n      )}\n      \n      {/* Onboarding System */}\n      {canRunTour && (\n        <OnboardingSystem\n          isActive={state.isActive}\n          config={config}\n          currentStep={state.currentStep}\n          onNext={nextStep}\n          onPrev={prevStep}\n          onSkip={skipOnboarding}\n        />\n      )}\n    </OnboardingContext.Provider>\n  );\n};\n\n// Hook to use onboarding context\nexport const useOnboardingContext = () => {\n  const context = useContext(OnboardingContext);\n  if (!context) {\n    throw new Error('useOnboardingContext must be used within OnboardingProvider');\n  }\n  return context;\n};\n\n// Debug component for development\nexport const OnboardingDebugPanel: React.FC = () => {\n  const {\n    isActive,\n    hasSeenOnboarding,\n    currentStep,\n    totalSteps,\n    startFullTour,\n    startQuickTour,\n    resetOnboarding\n  } = useOnboardingContext();\n\n  if (!isDev) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed bottom-4 left-4 bg-white p-3 rounded-lg shadow-lg border z-[30000] text-xs max-w-48\">\n      <div className=\"font-semibold mb-2 text-teal-600\">Onboarding v3</div>\n      <div className=\"space-y-1 text-gray-600\">\n        <div>Active: {isActive ? 'Yes' : 'No'}</div>\n        <div>Seen: {hasSeenOnboarding ? 'Yes' : 'No'}</div>\n        <div>Step: {currentStep + 1}/{totalSteps}</div>\n      </div>\n      <div className=\"flex gap-1 mt-2 flex-wrap\">\n        <button\n          onClick={startFullTour}\n          className=\"px-2 py-1 bg-blue-500 text-white rounded text-xs\"\n        >\n          Full\n        </button>\n        <button\n          onClick={startQuickTour}\n          className=\"px-2 py-1 bg-teal-500 text-white rounded text-xs\"\n        >\n          Quick\n        </button>\n        <button\n          onClick={resetOnboarding}\n          className=\"px-2 py-1 bg-red-500 text-white rounded text-xs\"\n        >\n          Reset\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default OnboardingProvider;","/**\n * Development-only QA logging utility\n * Logs are only shown in development builds, production remains silent\n */\n\nexport const qaLog = (...args: unknown[]) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.log('[FCZ-QA]', ...args);\n  }\n};\n\nexport const qaWarn = (...args: unknown[]) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.warn('[FCZ-QA]', ...args);\n  }\n};\n\nexport const qaError = (...args: unknown[]) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.error('[FCZ-QA]', ...args);\n  }\n};\n\nexport const qaGroup = (label: string) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.group(`[FCZ-QA] ${label}`);\n  }\n};\n\nexport const qaGroupEnd = () => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.groupEnd();\n  }\n};\n\nexport const qaTime = (label: string) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.time(`[FCZ-QA] ${label}`);\n  }\n};\n\nexport const qaTimeEnd = (label: string) => {\n  if (import.meta.env.DEV && import.meta.env.VITE_DEBUG_LOGS === 'true') {\n    console.timeEnd(`[FCZ-QA] ${label}`);\n  }\n};\n","import React from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { FCZ_UNIFIED_HEADER } from '@/utils/environment';\nimport MobileHeader from './MobileHeader';\nimport { t } from '@/lib/lexicon';\n\ninterface MobileShellProps {\n  children: React.ReactNode;\n  overrideHeader?: {\n    title: string;\n    leftAction?: {\n      type: 'back' | 'close' | 'none';\n      onClick?: () => void;\n      'aria-label'?: string;\n    };\n    rightAction?: {\n      type: 'menu' | 'custom' | 'none';\n      icon?: React.ReactNode;\n      onClick?: () => void;\n      'aria-label'?: string;\n    };\n    statusChip?: {\n      label: string;\n      variant: 'success' | 'warning' | 'info' | 'neutral';\n    };\n  };\n  className?: string;\n}\n\nconst MobileShell: React.FC<MobileShellProps> = ({ \n  children, \n  overrideHeader,\n  className = '' \n}) => {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  // Get header configuration based on current route\n  const getHeaderConfig = () => {\n    if (overrideHeader) {\n      return overrideHeader;\n    }\n\n    const path = location.pathname;\n\n    // Route-specific header configurations\n    switch (true) {\n      case path === '/':\n      case path === '/discover':\n        return {\n          title: 'Discover',\n          leftAction: { type: 'none' as const },\n          rightAction: { type: 'none' as const }\n        };\n\n      case path === '/my-bets':\n        return {\n          title: t('myBets'),\n          leftAction: { type: 'none' as const },\n          rightAction: { type: 'none' as const }\n        };\n\n      case path === '/wallet':\n        return {\n          title: 'Wallet',\n          leftAction: { type: 'none' as const },\n          rightAction: { type: 'none' as const }\n        };\n\n      case path === '/leaderboard':\n        return {\n          title: 'Leaderboard',\n          leftAction: { type: 'none' as const },\n          rightAction: { type: 'none' as const }\n        };\n\n      case path === '/profile':\n      case path.startsWith('/profile/'):\n        return {\n          title: 'Profile',\n          leftAction: path === '/profile' \n            ? { type: 'none' as const }\n            : { \n                type: 'back' as const, \n                onClick: () => navigate(-1),\n                'aria-label': 'Go back'\n              },\n          rightAction: { type: 'none' as const }\n        };\n\n      case path.startsWith('/prediction/'):\n        return {\n          title: 'Prediction Details',\n          leftAction: { \n            type: 'back' as const, \n            onClick: () => navigate(-1),\n            'aria-label': 'Go back'\n          },\n          rightAction: { type: 'none' as const }\n        };\n\n      case path === '/create':\n        return {\n          title: 'Create Prediction',\n          leftAction: { \n            type: 'close' as const, \n            onClick: () => navigate('/'),\n            'aria-label': 'Close and go to Discover'\n          },\n          rightAction: { type: 'none' as const }\n        };\n\n      default:\n        return {\n          title: 'Fan Club Z',\n          leftAction: { type: 'none' as const },\n          rightAction: { type: 'none' as const }\n        };\n    }\n  };\n\n  const headerConfig = getHeaderConfig();\n\n  return (\n    <div className={`min-h-screen bg-gray-50 ${className}`}>\n      {/* Feature Flag: VITE_FCZ_UNIFIED_HEADER - Temporarily disabled while we fix page headers */}\n      {false && FCZ_UNIFIED_HEADER ? (\n        <MobileHeader {...headerConfig} />\n      ) : null}\n      \n      {/* Main Content */}\n      <main \n        className=\"flex-1\"\n        style={{\n          paddingTop: FCZ_UNIFIED_HEADER ? '0' : undefined\n        }}\n      >\n        {children}\n      </main>\n    </div>\n  );\n};\n\nexport default MobileShell;\n","import React from 'react';\nimport { motion } from 'framer-motion';\n\nconst PageLoadingSpinner: React.FC = () => {\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n      <div className=\"text-center\">\n        <motion.div\n          className=\"inline-block w-8 h-8 border-4 border-emerald-200 border-t-emerald-600 rounded-full\"\n          animate={{ rotate: 360 }}\n          transition={{ duration: 1, repeat: Infinity, ease: \"linear\" }}\n        />\n        <p className=\"mt-4 text-sm text-gray-600\">Loading...</p>\n      </div>\n    </div>\n  );\n};\n\nexport default PageLoadingSpinner;\n","import { useEffect } from 'react';\n\n/**\n * OAuth Redirect Diagnostic Component\n * \n * Add this to your app temporarily to debug OAuth redirect issues\n * Usage: Import and render <OAuthDiagnostic /> in your main App component\n */\nexport function OAuthDiagnostic() {\n  useEffect(() => {\n    console.log('');\n    console.log(' OAUTH REDIRECT DIAGNOSTIC');\n    console.log('');\n    console.log('Environment Variables:');\n    console.log('  VITE_APP_URL:', import.meta.env.VITE_APP_URL);\n    console.log('  VITE_API_URL:', import.meta.env.VITE_API_URL);\n    console.log('  VITE_AUTH_REDIRECT_URL:', import.meta.env.VITE_AUTH_REDIRECT_URL);\n    console.log('  MODE:', import.meta.env.MODE);\n    console.log('  DEV:', import.meta.env.DEV);\n    console.log('  PROD:', import.meta.env.PROD);\n    console.log('');\n    console.log('Current Location:');\n    console.log('  hostname:', window.location.hostname);\n    console.log('  origin:', window.location.origin);\n    console.log('  href:', window.location.href);\n    console.log('');\n    console.log('Expected OAuth Redirect:');\n    const isLocalDev = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';\n    if (isLocalDev) {\n      console.log('   Should redirect to:', `${window.location.origin}/auth/callback`);\n    } else {\n      console.log('   Should redirect to: https://app.fanclubz.app/auth/callback');\n    }\n    console.log('');\n  }, []);\n\n  return null; // This component doesn't render anything\n}\n","import React from 'react';\n\ninterface AuthInProgressOverlayProps {\n  isVisible: boolean;\n  onRetry?: () => void;\n  onCancel?: () => void;\n}\n\n/**\n * Full-screen overlay shown during OAuth authentication\n * Prevents user from getting stuck if they close the browser\n */\nexport const AuthInProgressOverlay: React.FC<AuthInProgressOverlayProps> = ({\n  isVisible,\n  onRetry,\n  onCancel,\n}) => {\n  if (!isVisible) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full mx-4 shadow-xl\">\n        <div className=\"text-center\">\n          <div className=\"mb-4\">\n            <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-green-600\"></div>\n          </div>\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n            Signing in...\n          </h3>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-6\">\n            Please complete the sign-in process in the browser window.\n          </p>\n          <div className=\"flex gap-3 justify-center\">\n            {onRetry && (\n              <button\n                onClick={onRetry}\n                className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium\"\n              >\n                Retry\n              </button>\n            )}\n            {onCancel && (\n              <button\n                onClick={onCancel}\n                className=\"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm font-medium\"\n              >\n                Cancel\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n/**\n * Utility function for merging Tailwind CSS classes\n * Combines clsx for conditional classes with tailwind-merge for deduplication\n */\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}","import React, { useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Home, TrendingUp, Trophy, User, Wallet, Plus } from 'lucide-react';\nimport { cn } from '@/utils/cn';\nimport { t } from '@/lib/lexicon';\n\ninterface NavigationTab {\n  id: string;\n  label: string;\n  icon: typeof Home;\n  badge?: number;\n  path: string;\n}\n\ninterface StableBottomNavigationProps {\n  activeTab?: string;\n  onTabChange?: (tab: string) => void;\n  showFAB?: boolean;\n  onFABClick?: () => void;\n  className?: string;\n}\n\nconst StableBottomNavigation: React.FC<StableBottomNavigationProps> = ({ \n  activeTab = 'discover', \n  onTabChange,\n  showFAB = false,\n  onFABClick,\n  className\n}) => {\n  const tabs: NavigationTab[] = [\n    { id: 'discover', label: 'Discover', icon: Home, path: '/' },\n    { id: 'bets', label: t('myBets'), icon: TrendingUp, path: '/bets', badge: 0 },\n    { id: 'leaderboard', label: 'Rankings', icon: Trophy, path: '/leaderboard' },\n    { id: 'wallet', label: 'Wallet', icon: Wallet, path: '/wallet' },\n    { id: 'profile', label: 'Profile', icon: User, path: '/profile' },\n  ];\n\n  const handleTabClick = useCallback((tabId: string) => {\n    // Scroll to top when navigating to any tab\n    if (typeof window !== 'undefined') {\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n    \n    if (onTabChange) {\n      onTabChange(tabId);\n    }\n  }, [onTabChange]);\n\n  const formatBadgeCount = (count: number) => {\n    if (count > 99) return '99+';\n    return count.toString();\n  };\n\n  return (\n    <>\n      {/* Bottom Navigation Bar */}\n      <motion.div \n        className={cn(\n          \"fixed bottom-0 left-0 right-0 z-[9999]\",\n          \"bg-white/95 backdrop-blur-xl border-t border-gray-200\",\n          \"shadow-[0_-8px_32px_rgba(0,0,0,0.12)]\",\n          className\n        )}\n        style={{\n          paddingBottom: 'max(env(safe-area-inset-bottom), 0.75rem)',\n          paddingTop: '0.75rem',\n          // Ensure proper clearance on all devices\n          minHeight: 'calc(4rem + env(safe-area-inset-bottom))'\n        }}\n        initial={{ y: 100 }}\n        animate={{ y: 0 }}\n        transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n      >\n        <nav className=\"px-4\">\n          <div className=\"flex items-center justify-around max-w-lg mx-auto\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon;\n              const isActive = activeTab === tab.id;\n              const hasBadge = tab.badge !== undefined && tab.badge > 0;\n              \n              return (\n                <motion.button\n                  key={tab.id}\n                  onClick={() => handleTabClick(tab.id)}\n                  className={cn(\n                    \"relative flex flex-col items-center justify-center\",\n                    \"p-2 min-w-0 flex-1 rounded-xl transition-all duration-200\",\n                    \"focus:outline-none focus:ring-2 focus:ring-emerald-500/20\",\n                    \"active:scale-95\"\n                  )}\n                  whileHover={{ scale: 1.02 }}\n                  whileTap={{ scale: 0.98 }}\n                  data-testid={`nav-tab-${tab.id}`}\n                  data-tour={`tab-${tab.id}`}\n                  data-tour-id={`tab-${tab.id}`}\n                  aria-label={`Navigate to ${tab.label}`}\n                  role=\"tab\"\n                  aria-selected={isActive}\n                >\n                  {/* Icon Container */}\n                  <div className=\"relative mb-1\">\n                    <motion.div\n                      className={cn(\n                        \"flex items-center justify-center w-6 h-6\",\n                        \"transition-colors duration-200\"\n                      )}\n                      animate={{\n                        scale: isActive ? 1.1 : 1,\n                        color: isActive ? '#10b981' : '#6b7280'\n                      }}\n                      transition={{ type: \"spring\", stiffness: 400, damping: 25 }}\n                    >\n                      <Icon \n                        size={20} \n                        strokeWidth={isActive ? 2.5 : 2}\n                        className=\"drop-shadow-sm\" \n                      />\n                    </motion.div>\n                    \n                    {/* Badge */}\n                    <AnimatePresence>\n                      {hasBadge && (\n                        <motion.div\n                          className={cn(\n                            \"absolute -top-1 -right-1\",\n                            \"bg-red-500 text-white text-xs font-semibold\",\n                            \"rounded-full min-w-[18px] h-[18px]\",\n                            \"flex items-center justify-center\",\n                            \"shadow-sm border-2 border-white\"\n                          )}\n                          initial={{ scale: 0, opacity: 0 }}\n                          animate={{ scale: 1, opacity: 1 }}\n                          exit={{ scale: 0, opacity: 0 }}\n                          transition={{ type: \"spring\", stiffness: 400, damping: 25 }}\n                        >\n                          {formatBadgeCount(tab.badge!)}\n                        </motion.div>\n                      )}\n                    </AnimatePresence>\n                    \n                    {/* Active Indicator */}\n                    <AnimatePresence>\n                      {isActive && (\n                        <motion.div\n                          className=\"absolute -top-1 left-1/2 w-1 h-1 bg-emerald-500 rounded-full shadow-sm\"\n                          layoutId=\"activeTabIndicator\"\n                          initial={{ opacity: 0, scale: 0 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          exit={{ opacity: 0, scale: 0 }}\n                          transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n                          style={{ transform: 'translateX(-50%)' }}\n                        />\n                      )}\n                    </AnimatePresence>\n                  </div>\n                  \n                  {/* Label */}\n                  <motion.span\n                    className={cn(\n                      \"text-xs font-medium text-center leading-tight\",\n                      \"transition-colors duration-200\"\n                    )}\n                    animate={{\n                      color: isActive ? '#10b981' : '#6b7280',\n                      fontWeight: isActive ? 600 : 500\n                    }}\n                  >\n                    {tab.label}\n                  </motion.span>\n                </motion.button>\n              );\n            })}\n          </div>\n        </nav>\n      </motion.div>\n\n      {/* Floating Action Button */}\n      <AnimatePresence>\n        {showFAB && (\n          <motion.button\n            className={cn(\n              \"fixed z-[10000] w-14 h-14 rounded-full\",\n              \"bg-gradient-to-br from-emerald-500 to-emerald-600\",\n              \"shadow-lg shadow-emerald-500/25\",\n              \"flex items-center justify-center\",\n              \"focus:outline-none focus:ring-4 focus:ring-emerald-500/20\",\n              \"active:scale-95 hover:shadow-xl hover:shadow-emerald-500/30\",\n              \"transition-shadow duration-200\"\n            )}\n            style={{\n              bottom: 'calc(5rem + env(safe-area-inset-bottom))',\n              right: '1rem'\n            }}\n            initial={{ scale: 0, opacity: 0, rotate: -180 }}\n            animate={{ scale: 1, opacity: 1, rotate: 0 }}\n            exit={{ scale: 0, opacity: 0, rotate: 180 }}\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            onClick={onFABClick}\n            data-testid=\"create-fab\"\n            data-tour=\"create-fab\"\n            data-tour-id=\"create-fab\"\n            aria-label=\"Create new prediction\"\n            transition={{ type: \"spring\", stiffness: 300, damping: 25 }}\n          >\n            <Plus size={24} className=\"text-white drop-shadow-sm\" strokeWidth={2.5} />\n            \n            {/* Pulse animation for emphasis */}\n            <motion.div\n              className=\"absolute inset-0 rounded-full bg-emerald-400 opacity-0\"\n              animate={{\n                scale: [1, 1.2, 1],\n                opacity: [0, 0.3, 0]\n              }}\n              transition={{\n                duration: 2,\n                repeat: Infinity,\n                repeatType: \"reverse\"\n              }}\n            />\n          </motion.button>\n        )}\n      </AnimatePresence>\n    </>\n  );\n};\n\nexport default StableBottomNavigation;\n","// src/slot.tsx\nimport * as React from \"react\";\nimport { composeRefs } from \"@radix-ui/react-compose-refs\";\nimport { Fragment as Fragment2, jsx } from \"react/jsx-runtime\";\n// @__NO_SIDE_EFFECTS__\nfunction createSlot(ownerName) {\n  const SlotClone = /* @__PURE__ */ createSlotClone(ownerName);\n  const Slot2 = React.forwardRef((props, forwardedRef) => {\n    const { children, ...slotProps } = props;\n    const childrenArray = React.Children.toArray(children);\n    const slottable = childrenArray.find(isSlottable);\n    if (slottable) {\n      const newElement = slottable.props.children;\n      const newChildren = childrenArray.map((child) => {\n        if (child === slottable) {\n          if (React.Children.count(newElement) > 1) return React.Children.only(null);\n          return React.isValidElement(newElement) ? newElement.props.children : null;\n        } else {\n          return child;\n        }\n      });\n      return /* @__PURE__ */ jsx(SlotClone, { ...slotProps, ref: forwardedRef, children: React.isValidElement(newElement) ? React.cloneElement(newElement, void 0, newChildren) : null });\n    }\n    return /* @__PURE__ */ jsx(SlotClone, { ...slotProps, ref: forwardedRef, children });\n  });\n  Slot2.displayName = `${ownerName}.Slot`;\n  return Slot2;\n}\nvar Slot = /* @__PURE__ */ createSlot(\"Slot\");\n// @__NO_SIDE_EFFECTS__\nfunction createSlotClone(ownerName) {\n  const SlotClone = React.forwardRef((props, forwardedRef) => {\n    const { children, ...slotProps } = props;\n    if (React.isValidElement(children)) {\n      const childrenRef = getElementRef(children);\n      const props2 = mergeProps(slotProps, children.props);\n      if (children.type !== React.Fragment) {\n        props2.ref = forwardedRef ? composeRefs(forwardedRef, childrenRef) : childrenRef;\n      }\n      return React.cloneElement(children, props2);\n    }\n    return React.Children.count(children) > 1 ? React.Children.only(null) : null;\n  });\n  SlotClone.displayName = `${ownerName}.SlotClone`;\n  return SlotClone;\n}\nvar SLOTTABLE_IDENTIFIER = Symbol(\"radix.slottable\");\n// @__NO_SIDE_EFFECTS__\nfunction createSlottable(ownerName) {\n  const Slottable2 = ({ children }) => {\n    return /* @__PURE__ */ jsx(Fragment2, { children });\n  };\n  Slottable2.displayName = `${ownerName}.Slottable`;\n  Slottable2.__radixId = SLOTTABLE_IDENTIFIER;\n  return Slottable2;\n}\nvar Slottable = /* @__PURE__ */ createSlottable(\"Slottable\");\nfunction isSlottable(child) {\n  return React.isValidElement(child) && typeof child.type === \"function\" && \"__radixId\" in child.type && child.type.__radixId === SLOTTABLE_IDENTIFIER;\n}\nfunction mergeProps(slotProps, childProps) {\n  const overrideProps = { ...childProps };\n  for (const propName in childProps) {\n    const slotPropValue = slotProps[propName];\n    const childPropValue = childProps[propName];\n    const isHandler = /^on[A-Z]/.test(propName);\n    if (isHandler) {\n      if (slotPropValue && childPropValue) {\n        overrideProps[propName] = (...args) => {\n          const result = childPropValue(...args);\n          slotPropValue(...args);\n          return result;\n        };\n      } else if (slotPropValue) {\n        overrideProps[propName] = slotPropValue;\n      }\n    } else if (propName === \"style\") {\n      overrideProps[propName] = { ...slotPropValue, ...childPropValue };\n    } else if (propName === \"className\") {\n      overrideProps[propName] = [slotPropValue, childPropValue].filter(Boolean).join(\" \");\n    }\n  }\n  return { ...slotProps, ...overrideProps };\n}\nfunction getElementRef(element) {\n  let getter = Object.getOwnPropertyDescriptor(element.props, \"ref\")?.get;\n  let mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.ref;\n  }\n  getter = Object.getOwnPropertyDescriptor(element, \"ref\")?.get;\n  mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.props.ref;\n  }\n  return element.props.ref || element.ref;\n}\nexport {\n  Slot as Root,\n  Slot,\n  Slottable,\n  createSlot,\n  createSlottable\n};\n//# sourceMappingURL=index.mjs.map\n","// src/primitive.tsx\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { createSlot } from \"@radix-ui/react-slot\";\nimport { jsx } from \"react/jsx-runtime\";\nvar NODES = [\n  \"a\",\n  \"button\",\n  \"div\",\n  \"form\",\n  \"h2\",\n  \"h3\",\n  \"img\",\n  \"input\",\n  \"label\",\n  \"li\",\n  \"nav\",\n  \"ol\",\n  \"p\",\n  \"select\",\n  \"span\",\n  \"svg\",\n  \"ul\"\n];\nvar Primitive = NODES.reduce((primitive, node) => {\n  const Slot = createSlot(`Primitive.${node}`);\n  const Node = React.forwardRef((props, forwardedRef) => {\n    const { asChild, ...primitiveProps } = props;\n    const Comp = asChild ? Slot : node;\n    if (typeof window !== \"undefined\") {\n      window[Symbol.for(\"radix-ui\")] = true;\n    }\n    return /* @__PURE__ */ jsx(Comp, { ...primitiveProps, ref: forwardedRef });\n  });\n  Node.displayName = `Primitive.${node}`;\n  return { ...primitive, [node]: Node };\n}, {});\nfunction dispatchDiscreteCustomEvent(target, event) {\n  if (target) ReactDOM.flushSync(() => target.dispatchEvent(event));\n}\nvar Root = Primitive;\nexport {\n  Primitive,\n  Root,\n  dispatchDiscreteCustomEvent\n};\n//# sourceMappingURL=index.mjs.map\n","// src/visually-hidden.tsx\nimport * as React from \"react\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { jsx } from \"react/jsx-runtime\";\nvar VISUALLY_HIDDEN_STYLES = Object.freeze({\n  // See: https://github.com/twbs/bootstrap/blob/main/scss/mixins/_visually-hidden.scss\n  position: \"absolute\",\n  border: 0,\n  width: 1,\n  height: 1,\n  padding: 0,\n  margin: -1,\n  overflow: \"hidden\",\n  clip: \"rect(0, 0, 0, 0)\",\n  whiteSpace: \"nowrap\",\n  wordWrap: \"normal\"\n});\nvar NAME = \"VisuallyHidden\";\nvar VisuallyHidden = React.forwardRef(\n  (props, forwardedRef) => {\n    return /* @__PURE__ */ jsx(\n      Primitive.span,\n      {\n        ...props,\n        ref: forwardedRef,\n        style: { ...VISUALLY_HIDDEN_STYLES, ...props.style }\n      }\n    );\n  }\n);\nVisuallyHidden.displayName = NAME;\nvar Root = VisuallyHidden;\nexport {\n  Root,\n  VISUALLY_HIDDEN_STYLES,\n  VisuallyHidden\n};\n//# sourceMappingURL=index.mjs.map\n","import * as Dialog from '@radix-ui/react-dialog';\nimport { VisuallyHidden } from '@radix-ui/react-visually-hidden';\nimport { useEffect, useState, useCallback, useRef } from 'react';\nimport { useConnect } from 'wagmi';\nimport toast from 'react-hot-toast';\n\nconst WC_ID = import.meta.env.VITE_WC_PROJECT_ID || import.meta.env.VITE_WALLETCONNECT_PROJECT_ID || '';\nconst wcEnabled = WC_ID.length >= 8;\n\n// Detect mobile device\nconst isMobileDevice = () => {\n  return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) || \n         (window.innerWidth <= 768 && 'ontouchstart' in window);\n};\n\ntype ConnectWalletSheetProps = {\n  isOpen?: boolean;\n  onClose?: () => void;\n};\n\nexport default function ConnectWalletSheet({ isOpen, onClose }: ConnectWalletSheetProps) {\n  const { connect, connectors, status, error } = useConnect();\n  const [open, setOpen] = useState<boolean>(Boolean(isOpen));\n  const [connectError, setConnectError] = useState<string | null>(null);\n  const isMobile = isMobileDevice();\n  const wcConnector = wcEnabled ? connectors.find(c => c.id === 'walletConnect') : null;\n  \n  // Guard to prevent repeated connect attempts\n  const attemptedRef = useRef(false);\n  const lastAttemptRef = useRef<number>(0);\n\n  // Reset attempt guard when sheet opens\n  useEffect(() => {\n    if (open) {\n      attemptedRef.current = false;\n      setConnectError(null);\n    }\n  }, [open]);\n\n  const handleConnect = useCallback(async (connector: any) => {\n    // Prevent repeated attempts within 10 seconds\n    const now = Date.now();\n    if (attemptedRef.current && (now - lastAttemptRef.current) < 10000) {\n      return;\n    }\n    \n    attemptedRef.current = true;\n    lastAttemptRef.current = now;\n    setConnectError(null);\n    \n    try {\n      await connect({ connector });\n      if (onClose) onClose();\n      else setOpen(false);\n    } catch (err: any) {\n      const errorMessage = err?.message || 'Failed to connect wallet';\n      setConnectError(errorMessage);\n      \n      // Provide helpful error messages\n      if (errorMessage.includes('403') || errorMessage.includes('Forbidden')) {\n        toast.error('WalletConnect configuration error. Please contact support.');\n        console.error('[WalletConnect] 403 Forbidden - Domain may not be whitelisted at cloud.reown.com');\n      } else if (errorMessage.includes('User rejected')) {\n        toast.error('Connection cancelled');\n      } else {\n        toast.error(errorMessage);\n      }\n      \n      // Reset attempt flag so user can try again\n      attemptedRef.current = false;\n    }\n  }, [connect, onClose]);\n\n  useEffect(() => {\n    // Controlled mode sync\n    if (typeof isOpen === 'boolean') {\n      setOpen(isOpen);\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    // Uncontrolled (global event) mode only when isOpen prop is not provided\n    if (typeof isOpen === 'boolean') return;\n    const handler = () => {\n      // On mobile, show the sheet (no auto-connect)\n      setOpen(true);\n    };\n    window.addEventListener('fcz:wallet:connect', handler as EventListener);\n    return () => window.removeEventListener('fcz:wallet:connect', handler as EventListener);\n  }, [isOpen]);\n\n  const browserConnector = connectors.find(c => c.id === 'injected');\n\n  return (\n    <Dialog.Root\n      open={open}\n      onOpenChange={(next) => {\n        if (typeof isOpen === 'boolean') {\n          if (!next && onClose) onClose();\n        } else {\n          setOpen(next);\n        }\n      }}\n    >\n      <Dialog.Portal>\n        <Dialog.Overlay className=\"fixed inset-0 bg-black/30 z-modal\" />\n        <Dialog.Content\n          className=\"z-modal fixed inset-x-0 rounded-t-2xl bg-white shadow-xl bottom-[calc(64px+env(safe-area-inset-bottom,0px))] max-h-[calc(100vh-env(safe-area-inset-top,0px)-64px-env(safe-area-inset-bottom,0px))] focus:outline-none\"\n        >\n          <Dialog.Title asChild>\n            <VisuallyHidden>Connect wallet</VisuallyHidden>\n          </Dialog.Title>\n          <Dialog.Description asChild>\n            <VisuallyHidden>Select a wallet provider</VisuallyHidden>\n          </Dialog.Description>\n\n          <div className=\"mx-auto mt-2 mb-3 h-1.5 w-16 rounded-full bg-gray-200\" />\n          <div className=\"px-4 pb-3\">\n            <h3 className=\"text-lg font-semibold\">Connect wallet</h3>\n            <p className=\"text-sm text-gray-500\">Choose a wallet provider to continue.</p>\n          </div>\n\n          <div className=\"overflow-y-auto pb-safe px-4 pt-3\">\n            {isMobile ? (\n              // On mobile, only show WalletConnect option\n              <div className=\"rounded-xl border border-gray-100 overflow-hidden\">\n                <button\n                  type=\"button\"\n                  disabled={!wcConnector || !wcEnabled}\n                  onClick={() => wcConnector && handleConnect(wcConnector)}\n                  className=\"flex w-full items-center justify-between px-4 py-4 hover:bg-gray-50 disabled:opacity-50\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\"></span>\n                    <div>\n                      <div className=\"font-medium\">WalletConnect</div>\n                      <div className=\"text-xs text-gray-500\">\n                        Connect your mobile wallet\n                        {!wcEnabled && (\n                          <span className=\"ml-2 text-xs text-gray-500\">(add VITE_WC_PROJECT_ID)</span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  <span className=\"text-gray-400\"></span>\n                </button>\n              </div>\n            ) : (\n              // On desktop, show both options\n              <ul className=\"divide-y divide-gray-100 rounded-xl border border-gray-100 overflow-hidden\">\n                <li>\n                  <button\n                    type=\"button\"\n                    disabled={!browserConnector}\n                    onClick={() => browserConnector && handleConnect(browserConnector)}\n                    className=\"flex w-full items-center justify-between px-4 py-4 hover:bg-gray-50 disabled:opacity-50\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-2xl\"></span>\n                      <div>\n                        <div className=\"font-medium\">Browser Wallet</div>\n                        <div className=\"text-xs text-gray-500\">MetaMask or compatible</div>\n                      </div>\n                    </div>\n                    <span className=\"text-gray-400\"></span>\n                  </button>\n                </li>\n                <li>\n                  <button\n                    type=\"button\"\n                    disabled={!wcConnector || !wcEnabled}\n                    onClick={() => wcConnector && handleConnect(wcConnector)}\n                    className=\"flex w-full items-center justify-between px-4 py-4 hover:bg-gray-50 disabled:opacity-50\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-2xl\"></span>\n                      <div>\n                        <div className=\"font-medium\">WalletConnect</div>\n                        <div className=\"text-xs text-gray-500\">\n                          Mobile wallets (QR / deep link)\n                          {!wcEnabled && (\n                            <span className=\"ml-2 text-xs text-gray-500\">(add VITE_WC_PROJECT_ID)</span>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                    <span className=\"text-gray-400\"></span>\n                  </button>\n                </li>\n              </ul>\n            )}\n\n            {(status === 'error' || connectError) && (\n              <div className=\"px-4 pt-3 space-y-2\">\n                <p className=\"text-xs text-red-600\">\n                  {connectError || String(error?.message ?? 'Failed to connect')}\n                </p>\n                {connectError && (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      attemptedRef.current = false;\n                      setConnectError(null);\n                    }}\n                    className=\"text-xs text-emerald-600 hover:text-emerald-700 font-medium\"\n                  >\n                    Try again\n                  </button>\n                )}\n              </div>\n            )}\n\n            <div className=\"h-3\" />\n          </div>\n\n          <Dialog.Close className=\"absolute right-3 top-2 rounded-full p-2 text-gray-500 hover:bg-gray-100\" aria-label=\"Close\">\n            \n          </Dialog.Close>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n}\n\n","import React from 'react';\nimport { cn } from '../../../utils/cn';\n\ntype EmptyStateProps = {\n  icon?: React.ReactNode;\n  title: string;\n  description?: string;\n  primaryAction?: React.ReactNode;\n  secondaryAction?: React.ReactNode;\n  className?: string;\n};\n\nexport function EmptyState({ \n  icon, \n  title, \n  description, \n  primaryAction, \n  secondaryAction,\n  className \n}: EmptyStateProps) {\n  return (\n    <div \n      className={cn(\n        'flex flex-col items-center justify-center text-center py-12 px-4',\n        className\n      )}\n    >\n      {/* Minimal icon (2432px) */}\n      {icon && (\n        <div className=\"mb-4 text-gray-300\">\n          {React.cloneElement(icon as React.ReactElement, {\n            className: cn(\n              'w-6 h-6 md:w-8 md:h-8',\n              (icon as React.ReactElement).props.className\n            )\n          })}\n        </div>\n      )}\n\n      {/* Title (1618px) */}\n      <h3 className=\"text-base md:text-lg font-semibold text-gray-900 mb-2\">\n        {title}\n      </h3>\n\n      {/* Description (1415px) */}\n      {description && (\n        <p className=\"text-sm md:text-base text-gray-600 mb-6 max-w-sm leading-relaxed\">\n          {description}\n        </p>\n      )}\n\n      {/* Actions */}\n      {(primaryAction || secondaryAction) && (\n        <div className=\"flex flex-col sm:flex-row items-center space-y-3 sm:space-y-0 sm:space-x-3\">\n          {primaryAction}\n          {secondaryAction}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default EmptyState;\n","import React from 'react';\nimport EmptyState from './EmptyState';\nimport { openAuthGate } from '../../../auth/authGateAdapter';\nimport type { AuthIntent } from '../../../auth/authIntents';\n\ntype AuthRequiredStateProps = {\n  icon: React.ReactElement<{ className?: string }>;\n  title: string;\n  description: string;\n  intent?: AuthIntent;\n  payload?: Record<string, unknown>;\n  className?: string;\n};\n\n/**\n * Reusable component for showing auth-required state across all pages\n * Provides consistent UI/UX when user needs to sign in\n */\nexport function AuthRequiredState({ \n  icon, \n  title, \n  description, \n  intent = 'view_my_bets',\n  payload,\n  className \n}: AuthRequiredStateProps) {\n  const handleSignIn = async () => {\n    try {\n      await openAuthGate({ intent, payload });\n    } catch (error) {\n      console.error('Auth gate error:', error);\n    }\n  };\n\n  return (\n    <EmptyState\n      icon={icon}\n      title={title}\n      description={description}\n      primaryAction={\n        <button\n          onClick={handleSignIn}\n          className=\"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors\"\n        >\n          Sign In\n        </button>\n      }\n      className={className}\n    />\n  );\n}\n\nexport default AuthRequiredState;\n","/**\n * Referral System Utilities\n * \n * Handles referral code management, attribution, and tracking\n * Feature flag: VITE_REFERRALS_ENABLE=1\n */\n\nimport { getApiUrl } from '@/config';\n\nconst REFERRAL_COOKIE_NAME = 'ref_code';\nconst REFERRAL_STORAGE_KEY = 'fanclubz_ref_code';\nconst REFERRAL_COOKIE_EXPIRY_DAYS = 90;\n\n/**\n * Check if referral feature is enabled\n */\nexport const isReferralEnabled = (): boolean => {\n  return import.meta.env.VITE_REFERRALS_ENABLE === '1';\n};\n\n/**\n * Get the referral code from URL, cookie, or localStorage\n */\nexport const getRefCode = (): string | null => {\n  if (!isReferralEnabled()) return null;\n  \n  // 1. Check URL parameters first (highest priority)\n  const urlParams = new URLSearchParams(window.location.search);\n  const urlRefCode = urlParams.get('ref') || urlParams.get('ref_code');\n  if (urlRefCode) {\n    // Persist it\n    setRefCode(urlRefCode);\n    return urlRefCode;\n  }\n  \n  // 2. Check cookie\n  const cookieRefCode = getCookie(REFERRAL_COOKIE_NAME);\n  if (cookieRefCode) return cookieRefCode;\n  \n  // 3. Check localStorage\n  try {\n    return localStorage.getItem(REFERRAL_STORAGE_KEY);\n  } catch {\n    return null;\n  }\n};\n\n/**\n * Set the referral code in cookie and localStorage\n */\nexport const setRefCode = (code: string): void => {\n  if (!isReferralEnabled() || !code) return;\n  \n  // Set cookie\n  const expiryDate = new Date();\n  expiryDate.setDate(expiryDate.getDate() + REFERRAL_COOKIE_EXPIRY_DAYS);\n  document.cookie = `${REFERRAL_COOKIE_NAME}=${code}; expires=${expiryDate.toUTCString()}; path=/; SameSite=Lax`;\n  \n  // Set localStorage as backup\n  try {\n    localStorage.setItem(REFERRAL_STORAGE_KEY, code);\n  } catch {\n    // Ignore storage errors\n  }\n};\n\n/**\n * Clear the referral code\n */\nexport const clearRefCode = (): void => {\n  // Clear cookie\n  document.cookie = `${REFERRAL_COOKIE_NAME}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`;\n  \n  // Clear localStorage\n  try {\n    localStorage.removeItem(REFERRAL_STORAGE_KEY);\n  } catch {\n    // Ignore storage errors\n  }\n};\n\n/**\n * Get a cookie value by name\n */\nconst getCookie = (name: string): string | null => {\n  const value = `; ${document.cookie}`;\n  const parts = value.split(`; ${name}=`);\n  if (parts.length === 2) {\n    return parts.pop()?.split(';').shift() || null;\n  }\n  return null;\n};\n\n/**\n * Generate the full referral link for a user\n */\nexport const getMyReferralLink = (referralCode: string | null | undefined): string | null => {\n  if (!isReferralEnabled() || !referralCode) return null;\n  \n  const baseUrl = import.meta.env.VITE_FRONTEND_URL || 'https://app.fanclubz.app';\n  return `${baseUrl}/r/${referralCode}`;\n};\n\n/**\n * Copy referral link to clipboard\n */\nexport const copyReferralLink = async (referralCode: string): Promise<boolean> => {\n  const link = getMyReferralLink(referralCode);\n  if (!link) return false;\n  \n  try {\n    await navigator.clipboard.writeText(link);\n    return true;\n  } catch {\n    // Fallback for older browsers\n    const textArea = document.createElement('textarea');\n    textArea.value = link;\n    textArea.style.position = 'fixed';\n    textArea.style.left = '-999999px';\n    document.body.appendChild(textArea);\n    textArea.focus();\n    textArea.select();\n    try {\n      document.execCommand('copy');\n      return true;\n    } catch {\n      return false;\n    } finally {\n      document.body.removeChild(textArea);\n    }\n  }\n};\n\n/**\n * Attribute a referral to a user (called on first sign-in)\n */\nexport const attributeReferral = async (userId: string): Promise<{ attributed: boolean; reason?: string }> => {\n  if (!isReferralEnabled()) return { attributed: false, reason: 'disabled' };\n  \n  const refCode = getRefCode();\n  if (!refCode) return { attributed: false, reason: 'no_code' };\n  \n  try {\n    const apiUrl = getApiUrl();\n    const response = await fetch(`${apiUrl}/api/referrals/attribute`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        userId,\n        refCode,\n      }),\n    });\n    \n    if (!response.ok) {\n      console.warn('[Referral] Attribution request failed:', response.status);\n      return { attributed: false, reason: 'request_failed' };\n    }\n    \n    const result = await response.json();\n    \n    if (result.data?.attributed) {\n      // Clear the ref code after successful attribution\n      clearRefCode();\n      return { attributed: true };\n    }\n    \n    return { attributed: false, reason: result.data?.reason || 'unknown' };\n  } catch (error) {\n    console.error('[Referral] Attribution error:', error);\n    return { attributed: false, reason: 'error' };\n  }\n};\n\n/**\n * Log a user login event (for active referral tracking)\n */\nexport const logReferralLogin = async (userId: string): Promise<void> => {\n  if (!isReferralEnabled()) return;\n  \n  try {\n    const apiUrl = getApiUrl();\n    await fetch(`${apiUrl}/api/referrals/log-login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        userId,\n        source: 'web',\n      }),\n    });\n  } catch (error) {\n    // Non-blocking - don't fail the login\n    console.warn('[Referral] Login log failed:', error);\n  }\n};\n\n/**\n * Referral stats interface\n */\nexport interface ReferralStats {\n  referralCode: string | null;\n  referralLink: string | null;\n  totalSignups: number;\n  totalClicks: number;\n  activeReferrals: number;\n  conversionRate: number;\n}\n\n/**\n * Fetch user's referral statistics\n */\nexport const fetchMyReferralStats = async (userId: string): Promise<ReferralStats | null> => {\n  if (!isReferralEnabled()) return null;\n  \n  try {\n    const apiUrl = getApiUrl();\n    const response = await fetch(`${apiUrl}/api/referrals/my-stats?userId=${userId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    \n    if (!response.ok) {\n      console.warn('[Referral] Failed to fetch stats:', response.status);\n      return null;\n    }\n    \n    const result = await response.json();\n    return result.data || null;\n  } catch (error) {\n    console.error('[Referral] Stats fetch error:', error);\n    return null;\n  }\n};\n\n/**\n * Referral leaderboard entry interface\n */\nexport type OGBadgeTier = 'gold' | 'silver' | 'bronze';\n\nexport interface ReferralLeaderboardEntry {\n  userId: string;\n  username: string;\n  fullName?: string;\n  avatarUrl?: string;\n  activeReferrals: number;\n  totalSignups: number;\n  totalClicks: number;\n  conversionRate?: number;\n  ogBadge?: OGBadgeTier | null;\n}\n\n/**\n * Fetch referral leaderboard\n */\nexport const fetchReferralLeaderboard = async (\n  limit: number = 50,\n  period: 'all' | '30d' | '7d' = 'all'\n): Promise<ReferralLeaderboardEntry[]> => {\n  if (!isReferralEnabled()) return [];\n  \n  try {\n    const apiUrl = getApiUrl();\n    const response = await fetch(\n      `${apiUrl}/api/leaderboard/referrals?limit=${limit}&period=${period}`,\n      {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n    );\n    \n    if (!response.ok) {\n      console.warn('[Referral] Leaderboard fetch failed:', response.status);\n      return [];\n    }\n    \n    const result = await response.json();\n    return result.data?.items || [];\n  } catch (error) {\n    console.error('[Referral] Leaderboard error:', error);\n    return [];\n  }\n};\n","/**\n * useReferral Hook\n * \n * React hook for referral system functionality\n * Feature flag: VITE_REFERRALS_ENABLE=1\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useAuthSession } from '@/providers/AuthSessionProvider';\nimport {\n  isReferralEnabled,\n  getRefCode,\n  setRefCode,\n  clearRefCode,\n  getMyReferralLink,\n  copyReferralLink,\n  attributeReferral,\n  logReferralLogin,\n  fetchMyReferralStats,\n  fetchReferralLeaderboard,\n  type ReferralStats,\n  type ReferralLeaderboardEntry,\n} from '@/lib/referral';\n\ninterface UseReferralReturn {\n  // Feature state\n  isEnabled: boolean;\n  \n  // Current user's referral info\n  referralCode: string | null;\n  referralLink: string | null;\n  stats: ReferralStats | null;\n  \n  // Loading states\n  statsLoading: boolean;\n  \n  // Actions\n  copyLink: () => Promise<boolean>;\n  refreshStats: () => Promise<void>;\n}\n\n/**\n * Hook for managing current user's referral state\n */\nexport const useReferral = (): UseReferralReturn => {\n  const { user } = useAuthSession();\n  const [stats, setStats] = useState<ReferralStats | null>(null);\n  const [statsLoading, setStatsLoading] = useState(false);\n  \n  const isEnabled = useMemo(() => isReferralEnabled(), []);\n  \n  // Get referral code from user metadata or stats\n  const referralCode = useMemo(() => {\n    // First try from stats\n    if (stats?.referralCode) return stats.referralCode;\n    \n    // Then try from user metadata (would need to be added to user payload)\n    const metadata = (user as any)?.user_metadata || {};\n    return metadata.referral_code || null;\n  }, [stats, user]);\n  \n  const referralLink = useMemo(() => {\n    return getMyReferralLink(referralCode);\n  }, [referralCode]);\n  \n  const refreshStats = useCallback(async () => {\n    if (!isEnabled || !user?.id) return;\n    \n    setStatsLoading(true);\n    try {\n      const data = await fetchMyReferralStats(user.id);\n      setStats(data);\n    } finally {\n      setStatsLoading(false);\n    }\n  }, [isEnabled, user?.id]);\n  \n  // Load stats on mount\n  useEffect(() => {\n    if (isEnabled && user?.id) {\n      refreshStats();\n    }\n  }, [isEnabled, user?.id, refreshStats]);\n  \n  const copyLink = useCallback(async (): Promise<boolean> => {\n    if (!referralCode) return false;\n    return copyReferralLink(referralCode);\n  }, [referralCode]);\n  \n  return {\n    isEnabled,\n    referralCode,\n    referralLink,\n    stats,\n    statsLoading,\n    copyLink,\n    refreshStats,\n  };\n};\n\ninterface UseReferralLeaderboardReturn {\n  isEnabled: boolean;\n  entries: ReferralLeaderboardEntry[];\n  loading: boolean;\n  error: string | null;\n  period: 'all' | '30d' | '7d';\n  setPeriod: (period: 'all' | '30d' | '7d') => void;\n  refresh: () => Promise<void>;\n}\n\n/**\n * Hook for referral leaderboard data\n */\nexport const useReferralLeaderboard = (\n  initialPeriod: 'all' | '30d' | '7d' = 'all',\n  limit: number = 50\n): UseReferralLeaderboardReturn => {\n  const [entries, setEntries] = useState<ReferralLeaderboardEntry[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [period, setPeriod] = useState(initialPeriod);\n  \n  const isEnabled = useMemo(() => isReferralEnabled(), []);\n  \n  const refresh = useCallback(async () => {\n    if (!isEnabled) {\n      setLoading(false);\n      return;\n    }\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const data = await fetchReferralLeaderboard(limit, period);\n      setEntries(data);\n    } catch (err) {\n      setError('Failed to load referral leaderboard');\n      setEntries([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [isEnabled, limit, period]);\n  \n  useEffect(() => {\n    refresh();\n  }, [refresh]);\n  \n  return {\n    isEnabled,\n    entries,\n    loading,\n    error,\n    period,\n    setPeriod,\n    refresh,\n  };\n};\n\n/**\n * Hook for handling referral link capture (on app load)\n * This extracts ref codes from URLs and stores them\n */\nexport const useReferralCapture = (): void => {\n  useEffect(() => {\n    if (!isReferralEnabled()) return;\n    \n    // Check for ref code in URL path (e.g., /r/code123)\n    const pathMatch = window.location.pathname.match(/^\\/r\\/([a-zA-Z0-9]+)/);\n    if (pathMatch?.[1]) {\n      setRefCode(pathMatch[1]);\n      return;\n    }\n    \n    // Check for ref code in URL params\n    const urlParams = new URLSearchParams(window.location.search);\n    const refParam = urlParams.get('ref') || urlParams.get('ref_code');\n    if (refParam) {\n      setRefCode(refParam);\n    }\n  }, []);\n};\n\n/**\n * Hook for attributing referrals on first login\n */\nexport const useReferralAttribution = (): void => {\n  const { user, initialized } = useAuthSession();\n  const [attributed, setAttributed] = useState(false);\n  \n  useEffect(() => {\n    if (!isReferralEnabled() || !initialized || !user?.id || attributed) return;\n    \n    const handleAttribution = async () => {\n      const refCode = getRefCode();\n      if (!refCode) return;\n      \n      const result = await attributeReferral(user.id);\n      if (result.attributed) {\n        console.log('[Referral] Successfully attributed');\n        setAttributed(true);\n      }\n    };\n    \n    handleAttribution();\n    \n    // Also log the login\n    logReferralLogin(user.id);\n  }, [user?.id, initialized, attributed]);\n};\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { getApiUrl } from '../../config';\nimport { Shield, Loader2 } from 'lucide-react';\n\ninterface AdminGuardProps {\n  children: React.ReactNode;\n}\n\n/**\n * Guard component that only renders children if user is admin\n * Checks against ADMIN_USER_IDS env or profiles.is_admin flag\n */\nexport const AdminGuard: React.FC<AdminGuardProps> = ({ children }) => {\n  const { user, loading: authLoading, initialized } = useAuthSession();\n  const navigate = useNavigate();\n  const [isAdmin, setIsAdmin] = useState<boolean | null>(null);\n  const [checking, setChecking] = useState(true);\n\n  useEffect(() => {\n    const checkAdmin = async () => {\n      if (!initialized) return;\n      \n      if (!user) {\n        setIsAdmin(false);\n        setChecking(false);\n        return;\n      }\n\n      try {\n        // Try to access an admin endpoint to verify access\n        const res = await fetch(`${getApiUrl()}/api/v2/admin/audit?limit=1&actorId=${user.id}`, {\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n\n        if (res.ok) {\n          setIsAdmin(true);\n        } else if (res.status === 403 || res.status === 401) {\n          setIsAdmin(false);\n        } else {\n          // Other errors - assume not admin\n          setIsAdmin(false);\n        }\n      } catch (e) {\n        console.error('[AdminGuard] Failed to check admin status:', e);\n        setIsAdmin(false);\n      } finally {\n        setChecking(false);\n      }\n    };\n\n    checkAdmin();\n  }, [user, initialized]);\n\n  if (authLoading || !initialized || checking) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto mb-4\" />\n          <p className=\"text-slate-400\">Checking access...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <div className=\"text-center max-w-md px-6\">\n          <Shield className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\n          <h1 className=\"text-2xl font-bold text-white mb-2\">Authentication Required</h1>\n          <p className=\"text-slate-400 mb-6\">Please sign in to access the admin dashboard.</p>\n          <button\n            onClick={() => navigate('/')}\n            className=\"px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors\"\n          >\n            Go to App\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAdmin) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <div className=\"text-center max-w-md px-6\">\n          <Shield className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\n          <h1 className=\"text-2xl font-bold text-white mb-2\">Access Denied</h1>\n          <p className=\"text-slate-400 mb-6\">\n            You don't have permission to access the admin dashboard.\n            Contact support if you believe this is an error.\n          </p>\n          <button\n            onClick={() => navigate('/')}\n            className=\"px-6 py-3 bg-slate-700 text-white rounded-lg hover:bg-slate-600 transition-colors\"\n          >\n            Return to App\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n};\n\nexport default AdminGuard;\n\n","import React from 'react';\nimport { NavLink, useNavigate } from 'react-router-dom';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { FRONTEND_URL } from '@/utils/environment';\nimport {\n  LayoutDashboard,\n  Users,\n  Wallet,\n  Target,\n  Gavel,\n  Flag,\n  ScrollText,\n  Settings,\n  LogOut,\n  ChevronLeft,\n} from 'lucide-react';\n\ninterface AdminLayoutProps {\n  children: React.ReactNode;\n}\n\nconst navItems = [\n  { path: '/admin', label: 'Overview', icon: LayoutDashboard, exact: true },\n  { path: '/admin/users', label: 'Users', icon: Users },\n  { path: '/admin/wallets', label: 'Wallets', icon: Wallet },\n  { path: '/admin/predictions', label: 'Predictions', icon: Target },\n  { path: '/admin/settlements', label: 'Settlements', icon: Gavel },\n  { path: '/admin/moderation', label: 'Moderation', icon: Flag },\n  { path: '/admin/audit', label: 'Audit Log', icon: ScrollText },\n  { path: '/admin/config', label: 'Config', icon: Settings },\n];\n\nexport const AdminLayout: React.FC<AdminLayoutProps> = ({ children }) => {\n  const { user } = useAuthSession();\n  const navigate = useNavigate();\n  const appUrl = FRONTEND_URL || 'https://app.fanclubz.app';\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex\">\n      {/* Sidebar */}\n      <aside className=\"w-64 bg-slate-800 border-r border-slate-700 flex flex-col\">\n        {/* Header */}\n        <div className=\"p-4 border-b border-slate-700\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-lg bg-emerald-600 flex items-center justify-center\">\n              <span className=\"text-white font-bold text-lg\">F</span>\n            </div>\n            <div>\n              <h1 className=\"text-white font-semibold\">Fan Club Z</h1>\n              <p className=\"text-xs text-slate-400\">Admin Dashboard</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Navigation */}\n        <nav className=\"flex-1 p-4 space-y-1 overflow-y-auto\">\n          {navItems.map((item) => (\n            <NavLink\n              key={item.path}\n              to={item.path}\n              end={item.exact}\n              className={({ isActive }) =>\n                `flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${\n                  isActive\n                    ? 'bg-emerald-600/20 text-emerald-400'\n                    : 'text-slate-400 hover:text-white hover:bg-slate-700/50'\n                }`\n              }\n            >\n              <item.icon className=\"w-5 h-5\" />\n              {item.label}\n            </NavLink>\n          ))}\n        </nav>\n\n        {/* Footer */}\n        <div className=\"p-4 border-t border-slate-700 space-y-3\">\n          {/* User info */}\n          <div className=\"flex items-center gap-3 px-3 py-2\">\n            <div className=\"w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center\">\n              <span className=\"text-white text-sm font-medium\">\n                {user?.email?.[0]?.toUpperCase() || 'A'}\n              </span>\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm text-white truncate\">{user?.email || 'Admin'}</p>\n              <p className=\"text-xs text-slate-400\">Administrator</p>\n            </div>\n          </div>\n\n          {/* Back to app button */}\n          <button\n            onClick={() => window.open(appUrl, '_self')}\n            className=\"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-700/50 transition-colors\"\n          >\n            <ChevronLeft className=\"w-5 h-5\" />\n            Back to App\n          </button>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"flex-1 overflow-auto\">\n        <div className=\"p-6\">\n          {children}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default AdminLayout;\n\n","import { create } from 'zustand';\n\ntype MaintenanceState = {\n  active: boolean;\n  message: string;\n  setMaintenance: (message: string) => void;\n  clear: () => void;\n};\n\nexport const useMaintenanceStore = create<MaintenanceState>((set) => ({\n  active: false,\n  message: 'The platform is currently under maintenance. Please check back soon.',\n  setMaintenance: (message) =>\n    set({\n      active: true,\n      message: message || 'The platform is currently under maintenance. Please check back soon.',\n    }),\n  clear: () => set({ active: false }),\n}));\n\n","import React from 'react';\nimport { Wrench, RefreshCcw } from 'lucide-react';\nimport { useMaintenanceStore } from '@/store/maintenanceStore';\n\nexport function MaintenanceOverlay() {\n  const { active, message } = useMaintenanceStore();\n\n  if (!active) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-[2147483646] bg-white\">\n      <div className=\"min-h-screen flex items-center justify-center p-6\">\n        <div className=\"w-full max-w-sm text-center\">\n          <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-amber-100 text-amber-700\">\n            <Wrench className=\"h-6 w-6\" />\n          </div>\n          <h1 className=\"text-lg font-semibold text-gray-900\">Maintenance mode</h1>\n          <p className=\"mt-2 text-sm text-gray-600\">{message}</p>\n\n          <button\n            type=\"button\"\n            onClick={() => window.location.reload()}\n            className=\"mt-6 inline-flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-semibold text-white hover:bg-emerald-700\"\n          >\n            <RefreshCcw className=\"h-4 w-4\" />\n            Retry\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n","import React, { useEffect, useCallback, memo, Suspense, lazy, useRef } from 'react';\nimport { Routes, Route, useLocation, useNavigate, useParams } from 'react-router-dom';\nimport { useWalletStore } from './store/walletStore';\nimport { useAuthStore } from './store/authStore';\nimport { useLikeStore } from './store/likeStore';\nimport { useUnifiedCommentStore } from './store/unifiedCommentStore';\nimport { openAuthGate, restorePendingAuth } from './auth/authGateAdapter';\nimport { useAuthSession } from './providers/AuthSessionProvider';\nimport { SupabaseProvider } from './providers/SupabaseProvider';\nimport { AuthSessionProvider } from './providers/AuthSessionProvider';\nimport { RealtimeProvider } from './providers/RealtimeProvider';\nimport AuthGateModal from './components/auth/AuthGateModal';\nimport { Toaster } from 'react-hot-toast';\nimport { scrollToTop, saveScrollPosition, markNavigationAsIntentional, handleRouterNavigation } from './utils/scroll';\nimport NotificationContainer from './components/ui/NotificationContainer';\nimport PWAInstallManager from './components/PWAInstallManager';\nimport PageWrapper from './components/PageWrapper';\nimport { OnboardingProvider } from './components/onboarding/OnboardingProvider';\nimport MobileShell from './components/layout/MobileShell';\nimport { NetworkStatusProvider } from './providers/NetworkStatusProvider';\nimport PageLoadingSpinner from './components/ui/PageLoadingSpinner';\nimport { OAuthDiagnostic } from './components/diagnostics/OAuthDiagnostic';\nimport { AuthInProgressOverlay } from './components/AuthInProgressOverlay';\n\n// Lazy-loaded pages for code splitting\nconst LazyDiscoverPage = lazy(() => import('./pages/DiscoverPage'));\nconst LazyPredictionsPage = lazy(() => import('./pages/PredictionsPage'));\nconst LazyCreatePredictionPage = lazy(() => import('./pages/CreatePredictionPage'));\nconst LazyProfilePage = lazy(() => import('./legacy/pages/ProfilePage'));\nconst LazyWalletPage = lazy(() => import('./legacy/pages/WalletPage'));\nconst LazyPredictionDetailsPageV2 = lazy(() => import('./pages/PredictionDetailsPageV2'));\nconst LazyProfilePageV2 = lazy(() => import('./pages/ProfilePageV2'));\nconst LazyDownloadPage = lazy(() => import('./legacy/pages/DownloadPage'));\nconst LazyWalletPageV2 = lazy(() => import('./pages/WalletPageV2'));\nconst LazyUnifiedWalletPage = lazy(() => import('./pages/UnifiedWalletPage'));\nconst LazyUnifiedLeaderboardPage = lazy(() => import('./pages/UnifiedLeaderboardPage'));\nconst LazyAuthCallback = lazy(() => import('./pages/auth/AuthCallback'));\nconst LazyReferralRedirectPage = lazy(() => import('./pages/ReferralRedirectPage'));\nconst LazyNotificationsPage = lazy(() => import('./pages/NotificationsPage'));\n\n// Admin pages (lazy loaded)\nconst LazyAdminHomePage = lazy(() => import('./pages/admin/AdminHomePage'));\nconst LazyAuditLogPage = lazy(() => import('./pages/admin/AuditLogPage'));\nconst LazyUsersPage = lazy(() => import('./pages/admin/UsersPage'));\nconst LazyUserDetailPage = lazy(() => import('./pages/admin/UserDetailPage'));\nconst LazyWalletsPage = lazy(() => import('./pages/admin/WalletsPage'));\nconst LazyUserWalletPage = lazy(() => import('./pages/admin/UserWalletPage'));\nconst LazyAdminPredictionsPage = lazy(() => import('./pages/admin/PredictionsPage'));\nconst LazyPredictionDetailPage = lazy(() => import('./pages/admin/PredictionDetailPage'));\nconst LazyModerationPage = lazy(() => import('./pages/admin/ModerationPage'));\nconst LazyConfigPage = lazy(() => import('./pages/admin/ConfigPage'));\nconst LazySettlementsPage = lazy(() => import('./pages/admin/SettlementsPage'));\nconst LazySettlementDetailPage = lazy(() => import('./pages/admin/SettlementDetailPage'));\nconst LazySupportPage = lazy(() => import('./pages/admin/SupportPage'));\n\n\n// Import all page components\n// These imports are now lazy-loaded above\nimport StableBottomNavigation from './components/navigation/StableBottomNavigation';\nimport ErrorBoundary from './components/ErrorBoundary';\nimport ConnectWalletSheet from './components/wallet/ConnectWalletSheet';\nimport AuthRequiredState from './components/ui/empty/AuthRequiredState';\nimport { Sparkles } from 'lucide-react';\nimport { captureReturnTo } from './lib/returnTo';\nimport { useReferralCapture, useReferralAttribution } from './hooks/useReferral';\nimport { AdminGuard } from './components/admin/AdminGuard';\nimport { AdminLayout } from './components/admin/AdminLayout';\nimport { MaintenanceOverlay } from './components/MaintenanceOverlay';\n\n// Simple Loading Component\nconst LoadingSpinner: React.FC<{ message?: string }> = ({ message = \"Loading...\" }) => (\n  <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n    <div className=\"text-center\">\n      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto\"></div>\n      <p className=\"mt-2 text-gray-600\">{message}</p>\n    </div>\n  </div>\n);\n\n\n// Enhanced Main Layout Component with scroll preservation\nconst MainLayout: React.FC<{ children: React.ReactNode }> = memo(({ children }) => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { user: sessionUser } = useAuthSession();\n  const isAuthenticated = !!sessionUser;\n  const prevLocationRef = useRef<string>(location.pathname);\n  \n  // Initialize navigation history on mount\n  useEffect(() => {\n    prevLocationRef.current = location.pathname;\n  }, []);\n  \n  // Handle location changes for proper scroll behavior\n  useEffect(() => {\n    const currentPath = location.pathname;\n    const prevPath = prevLocationRef.current;\n    \n    if (currentPath !== prevPath) {\n      // Use scroll manager to handle navigation (detects forward vs back)\n      handleRouterNavigation(prevPath, currentPath);\n      prevLocationRef.current = currentPath;\n    }\n  }, [location.pathname]);\n  \n  // Helper to normalize path by removing trailing slashes (except for root)\n  const normalizePath = useCallback((pathname: string) => {\n    const p = pathname.toLowerCase();\n    return p === '/' ? p : p.replace(/\\/+$/, '');\n  }, []);\n\n  const getCurrentTab = useCallback(() => {\n    const path = normalizePath(location.pathname);\n    if (path === '/' || path === '/discover') return 'discover';\n    if (path === '/bets' || path === '/predictions') return 'bets';\n    if (path === '/leaderboard') return 'leaderboard';\n    if (path === '/profile') return 'profile';\n    if (path === '/wallet') return 'wallet';\n    // For non-tab routes (e.g. /create, details, callbacks), still visually\n    // highlight Discover, but allow tab presses to navigate away.\n    return 'discover';\n  }, [location.pathname, normalizePath]);\n\n  const handleTabChange = useCallback((tab: string) => {\n    const path = normalizePath(location.pathname);\n    const isOnTabRoute =\n      path === '/' ||\n      path === '/discover' ||\n      path === '/bets' ||\n      path === '/predictions' ||\n      path === '/leaderboard' ||\n      path === '/profile' ||\n      path === '/wallet';\n\n    // Prevent redundant navigations only when we're already on a real tab route.\n    // On non-tab routes like /create or completion screens, always allow tab presses\n    // so users can reliably escape back to Home/Stakes/etc.\n    if (isOnTabRoute) {\n      if (tab === 'discover' && (path === '/' || path === '/discover')) return;\n      if (tab === 'bets' && (path === '/bets' || path === '/predictions')) return;\n      if (tab === 'leaderboard' && path === '/leaderboard') return;\n      if (tab === 'profile' && path === '/profile') return;\n      if (tab === 'wallet' && path === '/wallet') return;\n    }\n    \n    // Save current scroll position before navigating\n    saveScrollPosition(location.pathname);\n    \n    // Mark as intentional navigation to prevent auto-scroll-restore\n    markNavigationAsIntentional();\n    \n    // IMMEDIATELY scroll to top before navigation to prevent visual flash\n    window.scrollTo(0, 0);\n    document.documentElement.scrollTop = 0;\n    document.body.scrollTop = 0;\n    \n    // Navigate to the appropriate route\n    switch (tab) {\n      case 'discover':\n        navigate('/');\n        break;\n      case 'bets':\n        navigate('/predictions');\n        break;\n      case 'leaderboard':\n        navigate('/leaderboard');\n        break;\n      case 'profile':\n        navigate('/profile');\n        break;\n      case 'wallet':\n        navigate('/wallet');\n        break;\n      default:\n        navigate('/');\n    }\n    \n    // Scroll to top again after navigation to ensure it takes effect\n    requestAnimationFrame(() => {\n      window.scrollTo(0, 0);\n      document.documentElement.scrollTop = 0;\n      document.body.scrollTop = 0;\n      // One more scroll after a short delay for slow-rendering pages\n      setTimeout(() => {\n        scrollToTop({ behavior: 'instant' });\n      }, 50);\n    });\n  }, [navigate, location]);\n\n  const requestCreateAccess = useCallback(async () => {\n    if (!isAuthenticated) {\n      captureReturnTo('/create');\n      const result = await openAuthGate({ intent: 'create_prediction' });\n      return result.status === 'success';\n    }\n    return true;\n  }, [isAuthenticated]);\n\n  const handleFABClick = useCallback(() => {\n    const run = async () => {\n      const allowed = await requestCreateAccess();\n      if (!allowed) return;\n      saveScrollPosition(location.pathname);\n      markNavigationAsIntentional();\n      navigate('/create');\n    };\n    void run();\n  }, [navigate, location.pathname, requestCreateAccess]);\n\n  // Only show the floating action button on the actual Discover tab route.\n  // On detail/flow routes (e.g. /predictions/:id), this FAB can overlap modals/cards.\n  const showFAB = (() => {\n    const p = normalizePath(location.pathname);\n    return p === '/' || p === '/discover';\n  })();\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col\" data-scroll-container>\n      <MaintenanceOverlay />\n\n      {/* Main Content */}\n      <main className=\"flex-1 pb-[calc(5rem+env(safe-area-inset-bottom))]\">\n        <Suspense fallback={<LoadingSpinner message=\"Loading page...\" />}>\n          {children}\n        </Suspense>\n      </main>\n\n      {/* Stable Bottom Navigation */}\n      <StableBottomNavigation\n        activeTab={getCurrentTab()}\n        onTabChange={handleTabChange}\n        showFAB={showFAB}\n        onFABClick={handleFABClick}\n      />\n\n      {/* Notifications */}\n      <NotificationContainer />\n      \n      {/* PWA Install Manager */}\n      <PWAInstallManager />\n      \n      {/* Toast Notifications */}\n      <Toaster\n        position=\"top-center\"\n        containerStyle={{ zIndex: 2147483647 }}\n        toastOptions={{\n          duration: 4000,\n          style: {\n            background: '#363636',\n            color: '#fff',\n            zIndex: 2147483647,\n          },\n        }}\n      />\n    </div>\n  );\n});\n\nMainLayout.displayName = 'MainLayout';\n\n// Bootstrap effects component for auth adapter and sync\nconst BootstrapEffects: React.FC = () => {\n  const { user: sessionUser, session, initialized: sessionInitialized } = useAuthSession();\n  const { initializeAuth, isAuthenticated: storeAuthenticated, initialized: storeInitialized, user: storeUser } = useAuthStore();\n  \n  // Initialize referral tracking\n  useReferralCapture();\n  useReferralAttribution();\n  \n  // Sync AuthSession with AuthStore\n  useEffect(() => {\n    if (sessionInitialized) {\n      // Always sync session state to store when session is initialized\n      if (sessionUser && session) {\n        const currentStoreUser = useAuthStore.getState().user;\n        const currentStoreAuth = useAuthStore.getState().isAuthenticated;\n        \n        // Only update if there's a meaningful change\n        if (!currentStoreAuth || !currentStoreUser || currentStoreUser.id !== sessionUser.id) {\n          // Convert session user to store format\n          const convertedUser = {\n            id: sessionUser.id,\n            firstName: sessionUser.user_metadata?.firstName || sessionUser.user_metadata?.first_name || sessionUser.user_metadata?.full_name?.split(' ')[0] || 'User',\n            lastName: sessionUser.user_metadata?.lastName || sessionUser.user_metadata?.last_name || sessionUser.user_metadata?.full_name?.split(' ').slice(1).join(' ') || '',\n            email: sessionUser.email || '',\n            phone: sessionUser.phone,\n            avatar: sessionUser.user_metadata?.avatar_url || sessionUser.user_metadata?.picture,\n            provider: sessionUser.app_metadata?.provider || 'email',\n            createdAt: sessionUser.created_at\n          };\n          \n          // Update the auth store state directly\n          useAuthStore.setState({\n            isAuthenticated: true,\n            user: convertedUser,\n            token: session.access_token,\n            loading: false,\n            initialized: true,\n            lastAuthCheck: Date.now()\n          });\n        }\n      }\n      // If no session user but store thinks we're authenticated, clear the store\n      else if (!sessionUser && storeAuthenticated) {\n        \n        useAuthStore.setState({\n          isAuthenticated: false,\n          user: null,\n          token: null,\n          lastAuthCheck: 0\n        });\n      }\n    }\n  }, [sessionUser, session, sessionInitialized, storeAuthenticated]);\n  \n  useEffect(() => {\n    // Restore any pending auth state from session storage\n    restorePendingAuth();\n  }, []);\n  \n  return null;\n};\n\n// Enhanced Page Wrapper Components with scroll preservation\nconst DiscoverPageWrapper: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  const handleNavigateToProfile = useCallback(() => {\n    saveScrollPosition(location.pathname);\n    navigate('/profile');\n  }, [navigate, location.pathname]);\n\n  const handleNavigateToPrediction = useCallback((predictionId: string) => {\n    // Save scroll position before navigating to details\n    saveScrollPosition(location.pathname);\n    const fromPath = `${location.pathname}${location.search}${location.hash}`;\n    navigate(`/prediction/${predictionId}`, {\n      state: { from: fromPath }\n    });\n  }, [navigate, location.pathname, location.search, location.hash]);\n\n  return (\n      <LazyDiscoverPage \n        onNavigateToProfile={handleNavigateToProfile}\n        onNavigateToPrediction={handleNavigateToPrediction}\n      />\n  );\n};\n\nconst PredictionsPageWrapper: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  const handleNavigateToDiscover = useCallback(() => {\n    saveScrollPosition(location.pathname);\n    navigate('/');\n  }, [navigate, location.pathname]);\n\n  return (\n      <LazyPredictionsPage onNavigateToDiscover={handleNavigateToDiscover} />\n  );\n};\n\nconst CreatePredictionPageWrapper: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { user: sessionUser, loading: sessionLoading } = useAuthSession();\n  const isAuthenticated = !!sessionUser;\n  const authPromptedRef = useRef(false);\n  \n  const handleNavigateBack = useCallback(() => {\n    // Don't save scroll position when going back from create\n    markNavigationAsIntentional();\n    navigate('/');\n  }, [navigate]);\n\n  useEffect(() => {\n    if (!isAuthenticated && !sessionLoading && !authPromptedRef.current) {\n      authPromptedRef.current = true;\n      captureReturnTo('/create');\n      void openAuthGate({ intent: 'create_prediction' });\n    }\n  }, [isAuthenticated, sessionLoading]);\n\n  if (!isAuthenticated) {\n    return (\n      <PageWrapper title=\"Create Prediction\">\n        <div className=\"px-4 py-12\">\n          <AuthRequiredState\n            icon={<Sparkles className=\"w-10 h-10 text-emerald-500\" />}\n            title=\"Sign in to create predictions\"\n            description=\"You need to be signed in to create and publish predictions. Your progress will be saved automatically.\"\n            intent=\"create_prediction\"\n          />\n        </div>\n      </PageWrapper>\n    );\n  }\n\n  return (\n    <PageWrapper title=\"Create Prediction\">\n      <LazyCreatePredictionPage \n        onNavigateBack={handleNavigateBack}\n      />\n    </PageWrapper>\n  );\n};\n\n// Component for viewing other users' profiles with proper param extraction\nconst UserProfilePageWrapper: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { userId } = useParams<{ userId: string }>();\n  \n  const handleNavigateBack = useCallback(() => {\n    if (window.history.length > 1) {\n      // Use browser back to restore previous scroll position\n      window.history.back();\n    } else {\n      markNavigationAsIntentional();\n      navigate('/');\n    }\n  }, [navigate]);\n\n  // Validate and clean the userId parameter\n  const validatedUserId = React.useMemo(() => {\n    if (!userId) {\n      console.warn(' No userId provided in profile route');\n      return undefined;\n    }\n    \n    const cleanUserId = userId.trim();\n    if (!cleanUserId) {\n      console.warn(' Empty userId in profile route');\n      return undefined;\n    }\n    \n    // Basic UUID validation\n    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n    if (uuidRegex.test(cleanUserId)) {\n      console.log(' Valid UUID userId:', cleanUserId);\n      return cleanUserId;\n    }\n    \n    // If not UUID but has content, could be username (for backward compatibility)\n    if (cleanUserId.length > 2) {\n      console.log(' Non-UUID userId (might be username):', cleanUserId);\n      return cleanUserId;\n    }\n    \n    console.warn(' Invalid userId format:', cleanUserId);\n    return undefined;\n  }, [userId]);\n\n  // If no valid userId, redirect to own profile\n  if (!validatedUserId) {\n    React.useEffect(() => {\n      console.warn(' Invalid userId in profile route, redirecting to own profile');\n      markNavigationAsIntentional();\n      navigate('/profile');\n    }, [navigate]);\n    \n    return <LoadingSpinner message=\"Redirecting...\" />;\n  }\n\n  console.log(' UserProfilePageWrapper rendering with userId:', validatedUserId);\n\n  return (\n    <PageWrapper title=\"User Profile\">\n      <LazyProfilePage \n        onNavigateBack={handleNavigateBack} \n        userId={validatedUserId} \n      />\n    </PageWrapper>\n  );\n};\n\n// Wrapper for current user profile\nconst MyProfilePageWrapper: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  const handleNavigateBack = useCallback(() => {\n    saveScrollPosition(location.pathname);\n    navigate('/');\n  }, [navigate, location.pathname]);\n\n  return (\n    <PageWrapper title=\"My Profile\">\n      <LazyProfilePage \n        onNavigateBack={handleNavigateBack} \n      />\n    </PageWrapper>\n  );\n};\n\nconst WalletPageWrapper: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  const handleNavigateBack = useCallback(() => {\n    saveScrollPosition(location.pathname);\n    navigate('/');\n  }, [navigate, location.pathname]);\n\n  return (\n    <PageWrapper title=\"Wallet\">\n      <LazyWalletPage onNavigateBack={handleNavigateBack} />\n    </PageWrapper>\n  );\n};\n\nconst LeaderboardPageWrapper: React.FC = () => {\n  return <PageWrapper title=\"Leaderboard\"><LazyUnifiedLeaderboardPage /></PageWrapper>;\n};\n\nconst PredictionDetailsRouteWrapper: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [resolvedId, setResolvedId] = React.useState<string | null>(null);\n  const [checking, setChecking] = React.useState<boolean>(true);\n  \n  const handleNavigateBack = useCallback(() => {\n    // Use browser back to restore previous scroll position automatically\n    console.log(' Navigating back from prediction details');\n    \n    if (window.history.length > 1) {\n      // Browser back will automatically restore scroll position via our scroll manager\n      window.history.back();\n    } else {\n      // Fallback to discover page\n      markNavigationAsIntentional();\n      navigate('/');\n    }\n  }, [navigate]);\n\n  React.useEffect(() => {\n    const run = async () => {\n      if (!id) {\n        setChecking(false);\n        return;\n      }\n      const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n      if (uuidRegex.test(id)) {\n        setResolvedId(id);\n        setChecking(false);\n        return;\n      }\n      // Treat as SEO slug - resolve to full ID\n      try {\n        const apiBase = (await import('./config')).getApiUrl();\n        const r = await fetch(`${apiBase}/api/v2/predictions/resolve/slug/${encodeURIComponent(id)}`, { method: 'GET' });\n        if (!r.ok) throw new Error(`resolve failed ${r.status}`);\n        const j = await r.json();\n        if (j?.id) {\n          setResolvedId(j.id);\n        } else {\n          console.warn('Slug resolve returned no id for', id);\n        }\n      } catch (e) {\n        console.warn('Slug resolve errored', e);\n      } finally {\n        setChecking(false);\n      }\n    };\n    run();\n  }, [id]);\n\n  if (!id) {\n    return (\n        <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Prediction Not Found</h2>\n            <p className=\"text-gray-600 mb-4\">The prediction you're looking for doesn't exist.</p>\n            <button\n              onClick={handleNavigateBack}\n              className=\"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600\"\n            >\n              Go Back\n            </button>\n          </div>\n        </div>\n    );\n  }\n\n  if (checking) {\n    return <LoadingSpinner message=\"Loading prediction...\" />;\n  }\n\n  // If we couldn't resolve, show not-found state\n  if (!resolvedId) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Prediction Not Found</h2>\n          <p className=\"text-gray-600 mb-4\">The prediction you're looking for doesn't exist.</p>\n          <button\n            onClick={handleNavigateBack}\n            className=\"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return <LazyPredictionDetailsPageV2 predictionId={resolvedId} />;\n};\n\n// Main App Component with improved error handling\n// Main App Content - requires providers to be available\nconst AppContent: React.FC = () => {\n  const { initializeWallet } = useWalletStore();\n  const { initializeAuth, loading: storeLoading, initialized: storeInitialized } = useAuthStore();\n  const { initializeLikes } = useLikeStore();\n  \n  // Use session provider as source of truth for authentication\n  const { user: sessionUser, loading: sessionLoading, initialized: sessionInitialized } = useAuthSession();\n  \n  // Determine overall loading and auth state\n  const loading = sessionLoading || storeLoading;\n  const isAuthenticated = !!sessionUser;\n  const initialized = sessionInitialized && storeInitialized;\n\n  // Initialize auth store but let session provider be source of truth\n  useEffect(() => {\n    if (!storeInitialized && !storeLoading && sessionInitialized) {\n      try {\n        console.log('App: Initializing auth store...');\n        // If session already has user, don't call initializeAuth as it might conflict\n        if (sessionUser) {\n          // Let the sync effect above handle the auth store update\n          console.log('App: Session user exists, sync will handle auth store');\n        } else {\n        initializeAuth();\n        }\n      } catch (error) {\n        console.error('Auth initialization failed:', error);\n      }\n    }\n  }, [initializeAuth, storeInitialized, storeLoading, sessionInitialized, sessionUser]);\n\n  // Initialize wallet and social features after auth is ready\n  useEffect(() => {\n    if (isAuthenticated && !loading && sessionInitialized) {\n      try {\n        console.log('App: Initializing wallet and social features...');\n        \n        // Initialize wallet\n        initializeWallet();\n        \n        // Initialize social engagement features\n        initializeLikes();\n        \n        console.log(' All stores initialized successfully');\n      } catch (error) {\n        console.error('Store initialization failed:', error);\n      }\n    }\n  }, [isAuthenticated, loading, sessionInitialized, initializeWallet, initializeLikes]);\n  \n  // Ensure auth store is marked as initialized when session is ready\n  useEffect(() => {\n    if (sessionInitialized && !useAuthStore.getState().initialized) {\n      console.log('App: Marking auth store as initialized to match session state');\n      useAuthStore.setState({ initialized: true, loading: false });\n    }\n  }, [sessionInitialized]);\n\n  return (\n          <OnboardingProvider>\n          <MobileShell>\n          <Suspense fallback={<PageLoadingSpinner />}>\n            <Routes>\n              {/* Admin Routes - OUTSIDE MainLayout (no bottom nav, like landing page) */}\n              <Route\n                path=\"/admin\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyAdminHomePage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/audit\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyAuditLogPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/users\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyUsersPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/users/:userId\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyUserDetailPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/wallets\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyWalletsPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/wallets/:userId\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyUserWalletPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/predictions\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyAdminPredictionsPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/predictions/:predictionId\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyPredictionDetailPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/moderation\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyModerationPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/config\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazyConfigPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/settlements\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazySettlementsPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/settlements/:predictionId\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazySettlementDetailPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/support\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <LazySupportPage />\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n              <Route\n                path=\"/admin/*\"\n                element={\n                  <AdminGuard>\n                    <AdminLayout>\n                      <div className=\"text-center py-12\">\n                        <p className=\"text-slate-400\">Page coming soon</p>\n                      </div>\n                    </AdminLayout>\n                  </AdminGuard>\n                }\n              />\n\n              {/* Main App Routes - INSIDE MainLayout (with bottom nav) */}\n              <Route path=\"*\" element={\n                <MainLayout>\n                  <Routes>\n                    <Route path=\"/\" element={<DiscoverPageWrapper />} />\n                    <Route path=\"/discover\" element={<DiscoverPageWrapper />} />\n                    <Route path=\"/auth/callback\" element={<LazyAuthCallback />} />\n                    <Route path=\"/r/:code\" element={<LazyReferralRedirectPage />} />\n                    <Route path=\"/predictions\" element={<PredictionsPageWrapper />} />\n                    <Route path=\"/predictions/:id\" element={<PredictionDetailsRouteWrapper />} />\n                    <Route path=\"/bets\" element={<PredictionsPageWrapper />} />\n                    <Route path=\"/leaderboard\" element={<LeaderboardPageWrapper />} />\n                    <Route path=\"/create\" element={<CreatePredictionPageWrapper />} />\n                    <Route path=\"/profile\" element={\n                      <PageWrapper title=\"Profile\"><LazyProfilePageV2 /></PageWrapper>\n                    } />\n                    <Route path=\"/profile/:userId\" element={\n                      <PageWrapper title=\"Profile\"><LazyProfilePageV2 /></PageWrapper>\n                    } />\n                    <Route path=\"/wallet\" element={\n                      <PageWrapper title=\"Wallet\"><LazyUnifiedWalletPage /></PageWrapper>\n                    } />\n                    <Route path=\"/notifications\" element={\n                      <PageWrapper title=\"Notifications\"><LazyNotificationsPage /></PageWrapper>\n                    } />\n                    <Route path=\"/rankings\" element={<LeaderboardPageWrapper />} />\n                    <Route path=\"/prediction/:id\" element={<PredictionDetailsRouteWrapper />} />\n                    <Route path=\"/download\" element={<LazyDownloadPage />} />\n                    <Route path=\"*\" element={<DiscoverPageWrapper />} />\n                  </Routes>\n                </MainLayout>\n              } />\n            </Routes>\n          </Suspense>\n          </MobileShell>\n          \n          {/* Auth Gate Modal */}\n          <AuthGateModal />\n          \n          {/* Bootstrap Effects */}\n          <BootstrapEffects />\n          \n          </OnboardingProvider>\n  );\n};\n\n// Root App Component with proper provider nesting\nfunction App() {\n  const [authInProgress, setAuthInProgress] = React.useState(false);\n  const [authError, setAuthError] = React.useState(false);\n\n  React.useEffect(() => {\n    const handleAuthProgress = (event: CustomEvent) => {\n      const { started, completed, error } = event.detail;\n      if (started) {\n        setAuthInProgress(true);\n        setAuthError(false);\n      } else if (completed || error) {\n        setAuthInProgress(false);\n        setAuthError(!!error);\n      }\n    };\n\n    window.addEventListener('auth-in-progress', handleAuthProgress as EventListener);\n    return () => {\n      window.removeEventListener('auth-in-progress', handleAuthProgress as EventListener);\n    };\n  }, []);\n\n  const handleRetry = () => {\n    setAuthInProgress(false);\n    setAuthError(false);\n    // User can retry by clicking sign-in again\n  };\n\n  const handleCancel = () => {\n    setAuthInProgress(false);\n    setAuthError(false);\n  };\n\n  return (\n    <NetworkStatusProvider>\n      <OAuthDiagnostic />\n      <SupabaseProvider>\n        <AuthSessionProvider>\n          <RealtimeProvider>\n            <AppContent />\n            <ConnectWalletSheet />\n            <AuthInProgressOverlay\n              isVisible={authInProgress}\n              onRetry={authError ? handleRetry : undefined}\n              onCancel={handleCancel}\n            />\n          </RealtimeProvider>\n        </AuthSessionProvider>\n      </SupabaseProvider>\n    </NetworkStatusProvider>\n  );\n}\n\nexport default App;","import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../store/authStore';\nimport AuthGateModal from '../components/auth/AuthGateModal';\n\nconst CURRENT_YEAR = new Date().getFullYear();\n\n// Simple, static marketing landing page used when VITE_BUILD_TARGET=landing.\n// Content adapted from the saved production HTML snapshot, with APK links\n// updated to point at the latest FanClubZ.apk (v2.0.78).\n// Landing page ready for production deployment.\nconst LandingPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { isAuthenticated } = useAuthStore();\n  \n  // Production URLs\n  const PROD_APP_URL = 'https://app.fanclubz.app';\n\n  // Handle \"Get started\" CTA\n  // Always redirect to main app - let the app handle authentication\n  const handleGetStarted = () => {\n    window.location.href = import.meta.env.PROD ? `${PROD_APP_URL}/discover` : '/discover';\n  };\n\n\n  return (\n    <div className=\"bg-gradient-to-b from-[#211234] via-[#1b1130] to-[#130c24] text-white min-h-screen\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/5\">\n        <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-4\">\n          <div className=\"flex items-center gap-2\">\n            <img\n              src=\"/brand/fcz-logomark.png\"\n              alt=\"FanClubZ\"\n              className=\"h-8 w-8\"\n              style={{ objectFit: 'contain' }}\n            />\n            <span className=\"text-lg font-semibold tracking-wide\">FanClubZ</span>\n          </div>\n        </div>\n      </header>\n\n      <main>\n        {/* Hero */}\n        <section className=\"relative overflow-hidden\">\n          <div className=\"pointer-events-none absolute inset-0 bg-[radial-gradient(600px_circle_at_20%_20%,rgba(34,197,94,0.15),transparent_60%),radial-gradient(600px_circle_at_80%_0%,rgba(59,130,246,0.12),transparent_60%)]\" />\n          <div className=\"relative mx-auto max-w-6xl px-4 py-16 md:py-20\">\n            <div className=\"mx-auto max-w-3xl text-center\">\n              <h1 className=\"text-balance text-4xl font-extrabold leading-tight sm:text-5xl\">\n                Predict trending topics with friends\n              </h1>\n              <p className=\"mt-4 text-lg text-white/80\">\n                Make a prediction, lock a stake, compare outcomes with friends.\n              </p>\n              <div className=\"mt-8 flex flex-wrap items-center justify-center gap-3\">\n                <button\n                  onClick={handleGetStarted}\n                  className=\"inline-flex items-center gap-2 rounded-xl bg-emerald-500 px-6 py-3 text-sm font-semibold text-black shadow-xl transition hover:brightness-95\"\n                >\n                  Get started\n                </button>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Value props */}\n        <section className=\"mx-auto max-w-6xl px-4 py-10\">\n          <h2 className=\"text-center text-2xl font-bold\">Why choose FanClubZ?</h2>\n          <p className=\"mx-auto mt-2 max-w-2xl text-center text-white/70\">\n            The most engaging way to predict what happens next. Join communities, build credibility, and earn when you\n            get it right.\n          </p>\n          <div className=\"mt-8 grid grid-cols-1 gap-4 md:grid-cols-3\">\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-5\">\n              <div className=\"mb-3 inline-flex items-center justify-center rounded-xl bg-white/10 p-2\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"24\"\n                  height=\"24\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  className=\"h-5 w-5 text-emerald-300\"\n                >\n                  <path d=\"M3 3v16a2 2 0 0 0 2 2h16\" />\n                  <path d=\"m19 9-5 5-4-4-3 3\" />\n                </svg>\n              </div>\n              <div className=\"text-sm font-semibold\">Real time odds</div>\n              <p className=\"mt-1 text-sm text-white/70\">Make predictions as events unfold with dynamic odds.</p>\n            </div>\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-5\">\n              <div className=\"mb-3 inline-flex items-center justify-center rounded-xl bg-white/10 p-2\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"24\"\n                  height=\"24\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  className=\"h-5 w-5 text-emerald-300\"\n                >\n                  <path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" />\n                  <path d=\"M16 3.128a4 4 0 0 1 0 7.744\" />\n                  <path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" />\n                  <circle cx=\"9\" cy=\"7\" r=\"4\" />\n                </svg>\n              </div>\n              <div className=\"text-sm font-semibold\">Social Predictions</div>\n              <p className=\"mt-1 text-sm text-white/70\">Follow top predictors, share insights, and discover trends.</p>\n            </div>\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-5\">\n              <div className=\"mb-3 inline-flex items-center justify-center rounded-xl bg-white/10 p-2\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"24\"\n                  height=\"24\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  className=\"h-5 w-5 text-emerald-300\"\n                >\n                  <path d=\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\" />\n                  <path d=\"m9 12 2 2 4-4\" />\n                </svg>\n              </div>\n              <div className=\"text-sm font-semibold\">Secure &amp; Fair</div>\n              <p className=\"mt-1 text-sm text-white/70\">Transparent rules, verifiable outcomes, and fast payouts.</p>\n            </div>\n          </div>\n        </section>\n\n        {/* How it works */}\n        <section className=\"mx-auto max-w-6xl px-4 py-12\">\n          <h3 className=\"text-xl font-semibold\">How it works</h3>\n          <ol className=\"mt-4 grid list-decimal gap-3 pl-6 text-white/80 md:grid-cols-2\">\n            <li>Pick a prediction that matches your interest.</li>\n            <li>Choose an outcome you believe will happen.</li>\n            <li>Stake an amount you&apos;re comfortable with.</li>\n            <li>If you&apos;re right, you win based on the final odds.</li>\n          </ol>\n        </section>\n\n\n        {/* FAQ */}\n        <section className=\"mx-auto max-w-6xl px-4 pb-16\">\n          <h3 className=\"mb-4 flex items-center gap-2 text-xl font-semibold\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"24\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              className=\"h-5 w-5\"\n            >\n              <circle cx=\"12\" cy=\"12\" r=\"10\" />\n              <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\" />\n              <path d=\"M12 17h.01\" />\n            </svg>\n            FAQ\n          </h3>\n          <div className=\"grid gap-3 md:grid-cols-2\">\n            {[\n              {\n                question: 'Is it free to join?',\n                answer: 'Yes. Browsing predictions is free. You only stake when placing a prediction.',\n              },\n              {\n                question: 'Where can I use FanClubZ?',\n                answer: 'Anywhere the web app loads. Android APK is available; iOS is coming soon.',\n              },\n              {\n                question: 'How are outcomes decided?',\n                answer:\n                  'Each prediction has clear settlement rules and sources. Winning stakes are paid out accordingly.',\n              },\n              {\n                question: 'Is my data safe?',\n                answer:\n                  'We use modern security practices for auth and data storage. You can delete your data anytime.',\n              },\n              {\n                question: 'How do I fund my wallet?',\n                answer:\n                  'FanClubZ uses the Base Sepolia testnet. You\\'ll need to install a wallet like MetaMask, add the Base Sepolia network, and get test ETH and USDC from faucets.',\n                hasLink: true,\n              },\n            ].map((item) => (\n              <details\n                key={item.question}\n                className=\"group rounded-xl border border-white/10 p-4 open:bg-white/5\"\n              >\n                <summary className=\"cursor-pointer list-none select-none font-medium text-white/90\">\n                  <div className=\"flex items-center justify-between gap-3\">\n                    <span>{item.question}</span>\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      width=\"24\"\n                      height=\"24\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      strokeWidth=\"2\"\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      className=\"h-4 w-4 text-white/50 transition group-open:rotate-180\"\n                    >\n                      <path d=\"M12 7v14\" />\n                      <path d=\"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z\" />\n                    </svg>\n                  </div>\n                </summary>\n                <p className=\"mt-2 text-sm text-white/70\">\n                  {item.answer}\n                  {item.hasLink && (\n                    <>\n                      {' '}\n                      <a\n                        href=\"/docs/funding-guide\"\n                        className=\"text-emerald-400 hover:text-emerald-300 underline\"\n                        onClick={(e) => { e.preventDefault(); navigate('/docs/funding-guide'); }}\n                      >\n                        View our step-by-step funding guide \n                      </a>\n                    </>\n                  )}\n                </p>\n              </details>\n            ))}\n          </div>\n        </section>\n      </main>\n\n      {/* Footer */}\n      <footer className=\"border-t border-white/10\">\n         <div className=\"mx-auto grid max-w-6xl grid-cols-2 gap-8 px-4 py-10 md:grid-cols-4\">\n          <div>\n            <div className=\"mb-3 flex items-center gap-2\">\n              <img\n                src=\"/brand/fcz-logomark.png\"\n                alt=\"FanClubZ\"\n                className=\"h-6 w-6\"\n                style={{ objectFit: 'contain' }}\n              />\n              <span className=\"font-semibold\">FanClubZ</span>\n            </div>\n            <p className=\"text-sm text-white/70\">\n              Social predictions done right. Turn your opinions into rewards.\n            </p>\n          </div>\n          <div>\n            <div className=\"mb-2 text-sm font-semibold text-white/80\">Company</div>\n            <ul className=\"space-y-2 text-sm text-white/70\">\n              <li>\n                <a \n                  href={import.meta.env.PROD ? `${PROD_APP_URL}` : '#'} \n                  className=\"hover:text-white\"\n                  {...(import.meta.env.PROD ? {} : { onClick: (e) => { e.preventDefault(); navigate('/discover'); } })}\n                >\n                  Web App\n                </a>\n              </li>\n              <li>\n                <a \n                  href=\"mailto:tech@fanclubz.app\" \n                  className=\"hover:text-white\"\n                >\n                  Contact\n                </a>\n              </li>\n            </ul>\n          </div>\n          <div>\n            <div className=\"mb-2 text-sm font-semibold text-white/80\">Resources</div>\n            <ul className=\"space-y-2 text-sm text-white/70\">\n              <li>\n                <a \n                  href=\"/docs/funding-guide\" \n                  className=\"hover:text-white\"\n                  onClick={(e) => { e.preventDefault(); navigate('/docs/funding-guide'); }}\n                >\n                  Docs\n                </a>\n              </li>\n            </ul>\n          </div>\n          <div>\n            <div className=\"mb-2 text-sm font-semibold text-white/80\">Community</div>\n            <ul className=\"space-y-2 text-sm text-white/70\">\n              <li>\n                <a\n                  href=\"https://www.instagram.com/fanclubzapp?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"hover:text-white\"\n                >\n                  Instagram\n                </a>\n              </li>\n              <li>\n                <a\n                  href=\"https://x.com/fanclubzapp?s=21&t=azQHKJXvTx2oYBcMg4IStg\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"hover:text-white\"\n                >\n                  Twitter\n                </a>\n              </li>\n              <li>\n                <a\n                  href=\"https://youtube.com/@fanclubzapp\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"hover:text-white\"\n                >\n                  YouTube\n                </a>\n              </li>\n              <li>\n                <a\n                  href=\"https://chat.whatsapp.com/Csb2ngooDCt7fguCXvfntj?mode=wwt\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"hover:text-white\"\n                >\n                  WhatsApp\n                </a>\n              </li>\n              <li>\n                <a\n                  href=\"https://discord.gg/PdEs8vD2H5\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"hover:text-white\"\n                >\n                  Discord\n                </a>\n              </li>\n              <li>\n                <a\n                  href=\"https://t.me/Fanclubzapp\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"hover:text-white\"\n                >\n                  Telegram\n                </a>\n              </li>\n            </ul>\n          </div>\n        </div>\n        <div className=\"border-t border-white/10 py-6 text-center text-xs text-white/50\">\n           {CURRENT_YEAR} FanClubZ. All rights reserved.\n        </div>\n      </footer>\n\n      {/* Auth modal for any auth interactions */}\n      <AuthGateModal />\n    </div>\n  );\n};\n\nexport default LandingPage;\n\n\n","import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Wallet, Fuel, Coins, ExternalLink, AlertCircle, CheckCircle, Copy, HelpCircle, ArrowLeft } from 'lucide-react';\n\nconst CURRENT_YEAR = new Date().getFullYear();\n\n// USDC contract address on Base Sepolia\nconst USDC_CONTRACT_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\n\n// Production URLs\nconst PROD_APP_URL = 'https://app.fanclubz.app';\n\nconst FundingGuidePage: React.FC = () => {\n  const navigate = useNavigate();\n  const [copiedAddress, setCopiedAddress] = React.useState(false);\n\n  const handleCopyAddress = async () => {\n    try {\n      await navigator.clipboard.writeText(USDC_CONTRACT_ADDRESS);\n      setCopiedAddress(true);\n      setTimeout(() => setCopiedAddress(false), 2000);\n    } catch (err) {\n      console.error('Failed to copy:', err);\n    }\n  };\n\n  const handleBackToHome = () => {\n    navigate('/');\n  };\n\n  const handleGoToApp = () => {\n    window.location.href = import.meta.env.PROD ? `${PROD_APP_URL}/wallet` : '/wallet';\n  };\n\n  return (\n    <div className=\"bg-gradient-to-b from-[#211234] via-[#1b1130] to-[#130c24] text-white min-h-screen\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/5\">\n        <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={handleBackToHome}\n              className=\"p-2 -ml-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors\"\n              aria-label=\"Go back\"\n            >\n              <ArrowLeft className=\"w-5 h-5\" />\n            </button>\n            <div className=\"flex items-center gap-2\">\n              <img\n                src=\"/brand/fcz-logomark.png\"\n                alt=\"FanClubZ\"\n                className=\"h-8 w-8\"\n                style={{ objectFit: 'contain' }}\n              />\n              <span className=\"text-lg font-semibold tracking-wide\">FanClubZ</span>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main>\n        {/* Hero Section */}\n        <section className=\"relative overflow-hidden\">\n          <div className=\"pointer-events-none absolute inset-0 bg-[radial-gradient(600px_circle_at_20%_20%,rgba(34,197,94,0.15),transparent_60%),radial-gradient(600px_circle_at_80%_0%,rgba(59,130,246,0.12),transparent_60%)]\" />\n          <div className=\"relative mx-auto max-w-4xl px-4 py-12 md:py-16\">\n            <div className=\"text-center mb-8\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-emerald-500/20 mb-4\">\n                <Wallet className=\"w-8 h-8 text-emerald-400\" />\n              </div>\n              <h1 className=\"text-3xl md:text-4xl font-extrabold mb-3\">\n                How to Fund Your Wallet\n              </h1>\n              <p className=\"text-lg text-white/70 max-w-2xl mx-auto\">\n                FanClubZ uses the Base Sepolia testnet. Follow these steps to get test tokens and start making predictions.\n              </p>\n            </div>\n          </div>\n        </section>\n\n        {/* Steps Section */}\n        <section className=\"mx-auto max-w-4xl px-4 pb-16\">\n          <div className=\"space-y-6\">\n            \n            {/* Step 1: Install Wallet */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <span className=\"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold\">1</span>\n                <h2 className=\"text-xl font-semibold\">Install a Wallet</h2>\n              </div>\n              <p className=\"text-white/70 mb-4\">\n                You'll need a crypto wallet to interact with FanClubZ. We recommend MetaMask, but any WalletConnect-compatible wallet works.\n              </p>\n              <a\n                href=\"https://metamask.io/download/\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group\"\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 bg-orange-500/20 rounded-lg flex items-center justify-center\">\n                    <span className=\"text-orange-400 text-lg font-bold\">M</span>\n                  </div>\n                  <div>\n                    <p className=\"font-medium text-white\">MetaMask</p>\n                    <p className=\"text-sm text-white/50\">Browser extension & mobile app</p>\n                  </div>\n                </div>\n                <ExternalLink className=\"w-5 h-5 text-white/40 group-hover:text-white/70\" />\n              </a>\n              <div className=\"mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-xl\">\n                <p className=\"text-sm text-blue-300\">\n                  <strong>Tip:</strong> This is a one-time setup. Once installed, your wallet will work across all Web3 apps.\n                </p>\n              </div>\n            </div>\n\n            {/* Step 2: Add Network */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <span className=\"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold\">2</span>\n                <h2 className=\"text-xl font-semibold\">Add Base Sepolia Network</h2>\n              </div>\n              <p className=\"text-white/70 mb-4\">\n                Add the Base Sepolia testnet to your wallet using these settings:\n              </p>\n              <div className=\"bg-white/5 border border-white/10 rounded-xl p-4 space-y-3\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-white/50\">Network Name</span>\n                  <span className=\"font-medium text-white\">Base Sepolia</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-white/50\">RPC URL</span>\n                  <span className=\"font-mono text-sm text-white\">https://sepolia.base.org</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-white/50\">Chain ID</span>\n                  <span className=\"font-mono text-white\">84532</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-white/50\">Currency Symbol</span>\n                  <span className=\"font-medium text-white\">ETH</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-white/50\">Block Explorer</span>\n                  <a \n                    href=\"https://sepolia.basescan.org\" \n                    target=\"_blank\" \n                    rel=\"noopener noreferrer\"\n                    className=\"text-emerald-400 hover:text-emerald-300 transition-colors\"\n                  >\n                    sepolia.basescan.org\n                  </a>\n                </div>\n              </div>\n            </div>\n\n            {/* Step 3: Get ETH */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <span className=\"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold\">3</span>\n                <h2 className=\"text-xl font-semibold\">Get Base Sepolia ETH (Gas)</h2>\n              </div>\n              <p className=\"text-white/70 mb-4\">\n                You need a small amount of ETH to pay for transaction fees (gas). Use any of these free faucets:\n              </p>\n              <div className=\"space-y-3\">\n                {[\n                  { name: 'Alchemy Faucet', url: 'https://www.alchemy.com/faucets/base-sepolia', desc: 'Fast & reliable' },\n                  { name: 'Chainlink Faucet', url: 'https://faucets.chain.link', desc: 'Select \"Base Sepolia\"' },\n                  { name: 'QuickNode Faucet', url: 'https://faucet.quicknode.com', desc: 'Select \"Base Sepolia\"' },\n                ].map((faucet) => (\n                  <a\n                    key={faucet.name}\n                    href={faucet.url}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center\">\n                        <Fuel className=\"w-5 h-5 text-purple-400\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium text-white\">{faucet.name}</p>\n                        <p className=\"text-sm text-white/50\">{faucet.desc}</p>\n                      </div>\n                    </div>\n                    <ExternalLink className=\"w-5 h-5 text-white/40 group-hover:text-white/70\" />\n                  </a>\n                ))}\n              </div>\n              <div className=\"mt-4 flex items-start gap-2 p-3 bg-emerald-500/10 border border-emerald-500/20 rounded-xl\">\n                <CheckCircle className=\"w-5 h-5 text-emerald-400 mt-0.5 flex-shrink-0\" />\n                <p className=\"text-sm text-emerald-300\">\n                  After claiming, confirm your wallet shows a small ETH balance on Base Sepolia before proceeding.\n                </p>\n              </div>\n            </div>\n\n            {/* Step 4: Get USDC */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <span className=\"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold\">4</span>\n                <h2 className=\"text-xl font-semibold\">Get Base Sepolia USDC</h2>\n              </div>\n              <p className=\"text-white/70 mb-4\">\n                USDC is the currency used for predictions on FanClubZ. Get test USDC from these faucets:\n              </p>\n              <div className=\"space-y-3\">\n                <a\n                  href=\"https://faucet.circle.com\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center\">\n                      <Coins className=\"w-5 h-5 text-blue-400\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-white\">Circle USDC Faucet</p>\n                      <p className=\"text-sm text-white/50\">Select \"Base Sepolia\" if available</p>\n                    </div>\n                  </div>\n                  <ExternalLink className=\"w-5 h-5 text-white/40 group-hover:text-white/70\" />\n                </a>\n                <a\n                  href=\"https://portal.cdp.coinbase.com/\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors group\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center\">\n                      <Coins className=\"w-5 h-5 text-blue-400\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-white\">Coinbase Developer Platform</p>\n                      <p className=\"text-sm text-white/50\">Alternative USDC source</p>\n                    </div>\n                  </div>\n                  <ExternalLink className=\"w-5 h-5 text-white/40 group-hover:text-white/70\" />\n                </a>\n              </div>\n\n              {/* Warning */}\n              <div className=\"mt-4 flex items-start gap-2 p-3 bg-amber-500/10 border border-amber-500/20 rounded-xl\">\n                <AlertCircle className=\"w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0\" />\n                <p className=\"text-sm text-amber-300\">\n                  <strong>Important:</strong> Only connect your wallet to trusted websites. Always verify the URL before approving any transactions.\n                </p>\n              </div>\n\n              {/* USDC Token Address */}\n              <div className=\"mt-4 p-4 bg-white/5 border border-white/10 rounded-xl\">\n                <p className=\"text-sm text-white/50 mb-2\">USDC Token Address (Base Sepolia)</p>\n                <div className=\"flex items-center justify-between gap-2\">\n                  <code className=\"text-sm font-mono text-white/80 break-all\">\n                    {USDC_CONTRACT_ADDRESS}\n                  </code>\n                  <button\n                    onClick={handleCopyAddress}\n                    className=\"p-2 text-white/50 hover:text-white hover:bg-white/10 rounded-lg transition-colors flex-shrink-0\"\n                    aria-label=\"Copy address\"\n                  >\n                    {copiedAddress ? (\n                      <CheckCircle className=\"w-5 h-5 text-emerald-400\" />\n                    ) : (\n                      <Copy className=\"w-5 h-5\" />\n                    )}\n                  </button>\n                </div>\n                <p className=\"text-xs text-white/50 mt-2\">\n                  If USDC doesn't appear in your wallet, use \"Import Token\" and paste this address.\n                </p>\n              </div>\n            </div>\n\n            {/* Step 5: Use in App */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <span className=\"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500 text-white text-sm font-bold\">5</span>\n                <h2 className=\"text-xl font-semibold\">Use It in the App</h2>\n              </div>\n              <p className=\"text-white/70 mb-4\">\n                Now you're ready to start making predictions!\n              </p>\n              <ol className=\"space-y-3\">\n                {[\n                  { step: 'Open the app and go to Wallet' },\n                  { step: 'Tap Connect Wallet and select your wallet' },\n                  { step: 'Tap Deposit to add USDC to your escrow balance' },\n                  { step: 'Approve the transaction in your wallet when prompted' },\n                  { step: 'Start placing predictions using your Available balance!' },\n                ].map((item, index) => (\n                  <li key={index} className=\"flex items-start gap-3\">\n                    <span className=\"flex items-center justify-center w-6 h-6 rounded-full bg-white/10 text-white/70 text-xs font-medium flex-shrink-0 mt-0.5\">\n                      {index + 1}\n                    </span>\n                    <p className=\"text-white/70\">{item.step}</p>\n                  </li>\n                ))}\n              </ol>\n            </div>\n\n            {/* Troubleshooting */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <HelpCircle className=\"w-6 h-6 text-white/50\" />\n                <h2 className=\"text-xl font-semibold\">Troubleshooting</h2>\n              </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"font-medium text-white mb-1\">No wallet prompt appearing?</p>\n                  <p className=\"text-sm text-white/60\">Make sure your wallet is set to Base Sepolia network, then try again.</p>\n                </div>\n                <div className=\"border-t border-white/10 pt-4\">\n                  <p className=\"font-medium text-white mb-1\">Balance didn't update?</p>\n                  <p className=\"text-sm text-white/60\">Wait a few seconds for the transaction to confirm, then refresh the page.</p>\n                </div>\n                <div className=\"border-t border-white/10 pt-4\">\n                  <p className=\"font-medium text-white mb-1\">USDC not visible in wallet?</p>\n                  <p className=\"text-sm text-white/60\">Import the USDC token using the address shown above.</p>\n                </div>\n                <div className=\"border-t border-white/10 pt-4\">\n                  <p className=\"font-medium text-white mb-1\">Out of gas?</p>\n                  <p className=\"text-sm text-white/60\">Grab a bit more Base Sepolia ETH from any of the faucets listed above.</p>\n                </div>\n              </div>\n            </div>\n\n            {/* CTA */}\n            <div className=\"rounded-2xl border border-white/10 bg-white/5 p-8 text-center\">\n              <p className=\"text-white/70 mb-4\">\n                Ready to start making predictions?\n              </p>\n              <button\n                onClick={handleGoToApp}\n                className=\"inline-flex items-center gap-2 rounded-xl bg-emerald-500 px-8 py-3 text-sm font-semibold text-black shadow-xl transition hover:brightness-95\"\n              >\n                Open the App\n              </button>\n            </div>\n\n          </div>\n        </section>\n      </main>\n\n      {/* Footer */}\n      <footer className=\"border-t border-white/10\">\n        <div className=\"mx-auto max-w-6xl px-4 py-8\">\n          <div className=\"flex flex-col md:flex-row items-center justify-between gap-4\">\n            <div className=\"flex items-center gap-2\">\n              <img\n                src=\"/brand/fcz-logomark.png\"\n                alt=\"FanClubZ\"\n                className=\"h-6 w-6\"\n                style={{ objectFit: 'contain' }}\n              />\n              <span className=\"font-semibold\">FanClubZ</span>\n            </div>\n            <div className=\"flex items-center gap-6 text-sm text-white/50\">\n              <button onClick={handleBackToHome} className=\"hover:text-white transition-colors\">\n                Home\n              </button>\n              <a href=\"mailto:tech@fanclubz.app\" className=\"hover:text-white transition-colors\">\n                Contact\n              </a>\n            </div>\n          </div>\n          <div className=\"mt-6 text-center text-xs text-white/50\">\n             {CURRENT_YEAR} FanClubZ. All rights reserved.\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n};\n\nexport default FundingGuidePage;\n","import React, { useState, useEffect } from 'react';\nimport { Shield, Loader2, Lock } from 'lucide-react';\n\ninterface AdminGateProps {\n  children: React.ReactNode;\n}\n\nconst ADMIN_KEY_STORAGE = 'fcz_admin_key';\n\n/**\n * AdminGate - Simple admin key gate for admin access\n * Stores admin key in localStorage and requires it for all admin API calls\n */\nexport const AdminGate: React.FC<AdminGateProps> = ({ children }) => {\n  const [adminKey, setAdminKey] = useState<string | null>(null);\n  const [inputKey, setInputKey] = useState('');\n  const [error, setError] = useState<string | null>(null);\n  const [checking, setChecking] = useState(true);\n\n  useEffect(() => {\n    // Load admin key from localStorage\n    const stored = localStorage.getItem(ADMIN_KEY_STORAGE);\n    if (stored) {\n      setAdminKey(stored);\n    }\n    setChecking(false);\n  }, []);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    if (!inputKey.trim()) {\n      setError('Please enter an admin key');\n      return;\n    }\n\n    // Store the key\n    localStorage.setItem(ADMIN_KEY_STORAGE, inputKey.trim());\n    setAdminKey(inputKey.trim());\n    setInputKey('');\n  };\n\n  const handleClear = () => {\n    localStorage.removeItem(ADMIN_KEY_STORAGE);\n    setAdminKey(null);\n    setInputKey('');\n    setError(null);\n  };\n\n  if (checking) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto mb-4\" />\n          <p className=\"text-slate-400\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!adminKey) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <div className=\"text-center max-w-md px-6\">\n          <div className=\"w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <Lock className=\"w-8 h-8 text-slate-600\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-white mb-2\">Admin Access Required</h1>\n          <p className=\"text-slate-400 mb-6\">Please enter your admin key to continue.</p>\n          \n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <input\n                type=\"password\"\n                value={inputKey}\n                onChange={(e) => {\n                  setInputKey(e.target.value);\n                  setError(null);\n                }}\n                placeholder=\"Enter admin key\"\n                className=\"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\n                autoFocus\n              />\n              {error && (\n                <p className=\"text-red-400 text-sm mt-2\">{error}</p>\n              )}\n            </div>\n            <button\n              type=\"submit\"\n              className=\"w-full px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium\"\n            >\n              Access Admin\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n};\n\n/**\n * Get admin key from localStorage\n */\nexport function getAdminKey(): string | null {\n  if (typeof window === 'undefined') return null;\n  return localStorage.getItem(ADMIN_KEY_STORAGE);\n}\n\nexport default AdminGate;\n","import { getApiUrl } from '@/config';\nimport { getAdminKey } from '@/components/admin/AdminGate';\n\ntype Primitive = string | number | undefined;\n\nexport function buildAdminUrl(\n  path: string,\n  actorId: string,\n  params?: Record<string, Primitive>\n): string {\n  const base = getApiUrl();\n  const origin = typeof window !== 'undefined' ? window.location.origin : 'http://localhost';\n  const url = new URL(path.startsWith('http') ? path : `${base}${path}`, origin);\n\n  // Preserve existing query params (from path) and add/override with params + actorId.\n  if (actorId) {\n    url.searchParams.set('actorId', actorId);\n  }\n  if (params) {\n    for (const [k, v] of Object.entries(params)) {\n      if (v === undefined) continue;\n      url.searchParams.set(k, String(v));\n    }\n  }\n  return url.toString();\n}\n\nasync function parseJsonOrText<T>(res: Response): Promise<T> {\n  const ct = res.headers.get('content-type') || '';\n  if (ct.includes('application/json')) {\n    return (await res.json()) as T;\n  }\n  const txt = await res.text().catch(() => '');\n  return ({ message: txt } as unknown) as T;\n}\n\nexport async function adminGet<T>(\n  path: string,\n  actorId: string,\n  params?: Record<string, Primitive>\n): Promise<T> {\n  const url = buildAdminUrl(path, actorId, params);\n  const adminKey = getAdminKey();\n  // Avoid forcing CORS preflight on GET by not setting Content-Type.\n  const headers: HeadersInit = {};\n  if (adminKey) {\n    headers['x-admin-key'] = adminKey;\n  }\n  const res = await fetch(url, { \n    method: 'GET', \n    credentials: 'include',\n    headers,\n  });\n  if (!res.ok) {\n    const err: any = await parseJsonOrText(res);\n    throw new Error(err?.message || `Request failed (${res.status})`);\n  }\n  return (await res.json()) as T;\n}\n\nexport async function adminPost<T>(\n  path: string,\n  actorId: string,\n  body?: Record<string, any>\n): Promise<T> {\n  // Preserve query params if they exist in path, and include actorId in both query+body for consistency.\n  const url = buildAdminUrl(path, actorId);\n  const adminKey = getAdminKey();\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n    Accept: 'application/json',\n  };\n  if (adminKey) {\n    headers['x-admin-key'] = adminKey;\n  }\n  const res = await fetch(url, {\n    method: 'POST',\n    credentials: 'include',\n    headers,\n    body: JSON.stringify(actorId ? { ...(body || {}), actorId } : { ...(body || {}) }),\n  });\n  if (!res.ok) {\n    const err: any = await parseJsonOrText(res);\n    throw new Error(err?.message || `Request failed (${res.status})`);\n  }\n  return (await res.json()) as T;\n}\n\nexport async function adminPut<T>(\n  path: string,\n  actorId: string,\n  body?: Record<string, any>\n): Promise<T> {\n  const url = buildAdminUrl(path, actorId);\n  const adminKey = getAdminKey();\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n    Accept: 'application/json',\n  };\n  if (adminKey) {\n    headers['x-admin-key'] = adminKey;\n  }\n  const res = await fetch(url, {\n    method: 'PUT',\n    credentials: 'include',\n    headers,\n    body: JSON.stringify(actorId ? { ...(body || {}), actorId } : { ...(body || {}) }),\n  });\n  if (!res.ok) {\n    const err: any = await parseJsonOrText(res);\n    throw new Error(err?.message || `Request failed (${res.status})`);\n  }\n  return (await res.json()) as T;\n}\n\nexport async function adminPatch<T>(\n  path: string,\n  actorId: string,\n  body?: Record<string, any>\n): Promise<T> {\n  const url = buildAdminUrl(path, actorId);\n  const adminKey = getAdminKey();\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n    Accept: 'application/json',\n  };\n  if (adminKey) {\n    headers['x-admin-key'] = adminKey;\n  }\n  const res = await fetch(url, {\n    method: 'PATCH',\n    credentials: 'include',\n    headers,\n    body: JSON.stringify(actorId ? { ...(body || {}), actorId } : { ...(body || {}) }),\n  });\n  if (!res.ok) {\n    const err: any = await parseJsonOrText(res);\n    throw new Error(err?.message || `Request failed (${res.status})`);\n  }\n  return (await res.json()) as T;\n}\n\n\n","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Users,\n  Wallet,\n  Target,\n  Gavel,\n  TrendingUp,\n  AlertTriangle,\n  Clock,\n  Activity,\n  Tag,\n} from 'lucide-react';\nimport { adminGet } from '@/lib/adminApi';\n\ninterface QuickStats {\n  totalUsers?: number;\n  activePredictions?: number;\n  pendingSettlements?: number;\n  totalVolume?: number;\n}\n\nexport const AdminHomePage: React.FC = () => {\n  const [stats, setStats] = useState<QuickStats>({});\n  const [recentActions, setRecentActions] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // Admin-key-only mode should work even without a logged-in session userId.\n        const [overview, audit] = await Promise.all([\n          adminGet<any>(`/api/v2/admin/overview`, actorId),\n          adminGet<{ items?: any[] }>(`/api/v2/admin/audit`, actorId, { limit: 5 }),\n        ]);\n        setStats({\n          totalUsers: overview.totalUsers,\n          activePredictions: overview.activePredictions,\n          pendingSettlements: overview.pendingSettlements,\n          totalVolume: overview.totalVolume,\n        });\n        setRecentActions(audit.items || []);\n      } catch (e) {\n        console.error('[AdminHome] Failed to fetch data:', e);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [actorId]);\n\n  const quickActions = [\n    { label: 'Search Users', path: '/admin/users', icon: Users, color: 'bg-blue-600' },\n    { label: 'View Wallets', path: '/admin/wallets', icon: Wallet, color: 'bg-emerald-600' },\n    { label: 'Predictions', path: '/admin/predictions', icon: Target, color: 'bg-purple-600' },\n    { label: 'Settlements', path: '/admin/settlements', icon: Gavel, color: 'bg-amber-600' },\n    { label: 'Categories', path: '/admin/categories', icon: Tag, color: 'bg-indigo-600' },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white\">Admin Dashboard</h1>\n        <p className=\"text-slate-400 mt-1\">Welcome to the Fan Club Z admin panel</p>\n      </div>\n\n      {/* Quick Actions */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        {quickActions.map((action) => (\n          <Link\n            key={action.path}\n            to={action.path}\n            className=\"bg-slate-800 border border-slate-700 rounded-xl p-4 hover:border-slate-600 transition-colors group\"\n          >\n            <div className={`w-10 h-10 ${action.color} rounded-lg flex items-center justify-center mb-3 group-hover:scale-110 transition-transform`}>\n              <action.icon className=\"w-5 h-5 text-white\" />\n            </div>\n            <p className=\"text-white font-medium\">{action.label}</p>\n          </Link>\n        ))}\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Users className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Users</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">{stats.totalUsers ?? ''}</p>\n        </div>\n        \n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Activity className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Active Predictions</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">{stats.activePredictions ?? ''}</p>\n        </div>\n        \n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Clock className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Pending Settlements</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">{stats.pendingSettlements ?? ''}</p>\n        </div>\n        \n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <TrendingUp className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Volume</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">\n            {stats.totalVolume != null ? `$${stats.totalVolume.toLocaleString()}` : ''}\n          </p>\n        </div>\n      </div>\n\n      {/* Recent Admin Actions */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-4 py-3 border-b border-slate-700 flex items-center justify-between\">\n          <h2 className=\"text-white font-semibold\">Recent Admin Actions</h2>\n          <Link to=\"/admin/audit\" className=\"text-sm text-emerald-400 hover:text-emerald-300\">\n            View All\n          </Link>\n        </div>\n        \n        <div className=\"divide-y divide-slate-700\">\n          {loading ? (\n            <div className=\"p-8 text-center\">\n              <div className=\"w-6 h-6 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto\" />\n              <p className=\"text-slate-400 mt-2 text-sm\">Loading...</p>\n            </div>\n          ) : recentActions.length === 0 ? (\n            <div className=\"p-8 text-center\">\n              <AlertTriangle className=\"w-8 h-8 text-slate-600 mx-auto mb-2\" />\n              <p className=\"text-slate-400\">No recent admin actions</p>\n            </div>\n          ) : (\n            recentActions.map((action) => (\n              <div key={action.id} className=\"px-4 py-3 hover:bg-slate-700/30 transition-colors\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-white font-medium text-sm\">{action.action}</p>\n                    <p className=\"text-slate-400 text-xs mt-0.5\">\n                      by {action.actorName}  {action.targetType && `${action.targetType}: `}\n                      {action.targetId?.slice(0, 8)}...\n                    </p>\n                  </div>\n                  <span className=\"text-xs text-slate-500\">\n                    {new Date(action.createdAt).toLocaleDateString()}\n                  </span>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* System Status */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n        <h2 className=\"text-white font-semibold mb-3\">System Status</h2>\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-2 h-2 rounded-full bg-emerald-500\" />\n          <span className=\"text-slate-300 text-sm\">All systems operational</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminHomePage;\n\n","import React, { useState, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Users, Search, Loader2, User, Shield, Calendar } from 'lucide-react';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { adminGet } from '@/lib/adminApi';\n\ninterface UserResult {\n  id: string;\n  username: string | null;\n  fullName: string | null;\n  email: string | null;\n  avatarUrl: string | null;\n  isAdmin: boolean;\n  createdAt: string;\n}\n\nexport const UsersPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState<UserResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [searched, setSearched] = useState(false);\n\n  const handleSearch = useCallback(async () => {\n    if (!query.trim()) return;\n    \n    setLoading(true);\n    setSearched(true);\n    try {\n      const data = await adminGet<{ items?: UserResult[] }>(\n        `/api/v2/admin/users/search`,\n        actorId,\n        { q: query.trim(), limit: 25 }\n      );\n      setResults(data.items || []);\n    } catch (e) {\n      console.error('[UsersPage] Search error:', e);\n      setResults([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [query, actorId]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handleSearch();\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <Users className=\"w-7 h-7 text-blue-500\" />\n          User Management\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Search and view user details</p>\n      </div>\n\n      {/* Search */}\n      <div className=\"flex gap-3\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400\" />\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search by email, username, name, or user ID...\"\n            className=\"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\n          />\n        </div>\n        <button\n          onClick={handleSearch}\n          disabled={loading || !query.trim()}\n          className=\"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n        >\n          {loading ? (\n            <Loader2 className=\"w-5 h-5 animate-spin\" />\n          ) : (\n            <Search className=\"w-5 h-5\" />\n          )}\n          Search\n        </button>\n      </div>\n\n      {/* Results */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n        {!searched ? (\n          <div className=\"p-12 text-center\">\n            <Users className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">Search for users</p>\n            <p className=\"text-slate-400 text-sm mt-1\">\n              Enter an email, username, name, or user ID to search\n            </p>\n          </div>\n        ) : loading ? (\n          <div className=\"p-12 text-center\">\n            <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto\" />\n            <p className=\"text-slate-400 mt-3\">Searching...</p>\n          </div>\n        ) : results.length === 0 ? (\n          <div className=\"p-12 text-center\">\n            <User className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">No users found</p>\n            <p className=\"text-slate-400 text-sm mt-1\">\n              Try a different search term\n            </p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-slate-700\">\n            {results.map((user) => (\n              <button\n                key={user.id}\n                onClick={() => navigate(`/admin/users/${user.id}`)}\n                className=\"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center gap-4\"\n              >\n                {/* Avatar */}\n                <div className=\"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0\">\n                  {user.avatarUrl ? (\n                    <img src={user.avatarUrl} alt=\"\" className=\"w-full h-full object-cover\" />\n                  ) : (\n                    <User className=\"w-5 h-5 text-slate-400\" />\n                  )}\n                </div>\n\n                {/* Info */}\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-white font-medium truncate\">\n                      {user.fullName || user.username || 'Unknown User'}\n                    </span>\n                    {user.isAdmin && (\n                      <Shield className=\"w-4 h-4 text-amber-500\" />\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-3 text-sm text-slate-400 mt-0.5\">\n                    {user.username && <span>@{user.username}</span>}\n                    {user.email && <span className=\"truncate\">{user.email}</span>}\n                  </div>\n                </div>\n\n                {/* Meta */}\n                <div className=\"text-right flex-shrink-0\">\n                  <div className=\"text-xs text-slate-500 font-mono\">\n                    {user.id.slice(0, 8)}...\n                  </div>\n                  <div className=\"flex items-center gap-1 text-xs text-slate-500 mt-0.5\">\n                    <Calendar className=\"w-3 h-3\" />\n                    {new Date(user.createdAt).toLocaleDateString()}\n                  </div>\n                </div>\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default UsersPage;\n\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport {\n  User,\n  ArrowLeft,\n  Wallet,\n  Target,\n  Trophy,\n  Calendar,\n  Mail,\n  Shield,\n  BadgeCheck,\n  Loader2,\n  ChevronDown,\n  ChevronUp,\n  ExternalLink,\n  DollarSign,\n  AlertTriangle,\n} from 'lucide-react';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { adminGet } from '@/lib/adminApi';\n\ninterface UserDetail {\n  id: string;\n  username: string | null;\n  fullName: string | null;\n  email: string | null;\n  role: string;\n  avatarUrl: string | null;\n  bio: string | null;\n  isAdmin: boolean;\n  isVerified: boolean;\n  createdAt: string;\n}\n\ninterface WalletInfo {\n  availableBalance: number;\n  reservedBalance: number;\n  totalDeposited: number;\n  totalWithdrawn: number;\n  currency: string;\n}\n\ninterface UserStats {\n  totalBets: number;\n  totalWins: number;\n  winRate: string;\n}\n\ninterface TimelineItem {\n  id: string;\n  type: 'wallet_tx' | 'entry' | 'settlement' | 'admin';\n  timestamp: string;\n  summary: string;\n  details: Record<string, any>;\n}\n\nexport const UserDetailPage: React.FC = () => {\n  const { userId } = useParams<{ userId: string }>();\n  const navigate = useNavigate();\n  const { user: authUser } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || authUser?.id || '';\n  const [user, setUser] = useState<UserDetail | null>(null);\n  const [wallet, setWallet] = useState<WalletInfo | null>(null);\n  const [stats, setStats] = useState<UserStats | null>(null);\n  const [addresses, setAddresses] = useState<any[]>([]);\n  const [timeline, setTimeline] = useState<TimelineItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [timelineLoading, setTimelineLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState<'timeline' | 'wallets' | 'bets' | 'settlements'>('timeline');\n  const [expandedId, setExpandedId] = useState<string | null>(null);\n  const [timelineFilter, setTimelineFilter] = useState<'all' | 'wallet' | 'bets' | 'settlements' | 'admin'>('all');\n\n  const fetchUser = useCallback(async () => {\n    if (!userId) return;\n    setLoading(true);\n    try {\n      const data = await adminGet<any>(`/api/v2/admin/users/${userId}`, actorId);\n      setUser(data.user);\n      setWallet(data.wallet);\n      setStats(data.stats);\n      setAddresses(data.addresses || []);\n    } catch (e) {\n      console.error('[UserDetail] Fetch error:', e);\n    } finally {\n      setLoading(false);\n    }\n  }, [userId, actorId]);\n\n  const fetchTimeline = useCallback(async () => {\n    if (!userId) return;\n    setTimelineLoading(true);\n    try {\n      const data = await adminGet<any>(`/api/v2/admin/users/${userId}/timeline`, actorId, {\n        limit: 100,\n        type: timelineFilter,\n      });\n      setTimeline(data.items || []);\n    } catch (e) {\n      console.error('[UserDetail] Timeline error:', e);\n    } finally {\n      setTimelineLoading(false);\n    }\n  }, [userId, timelineFilter, actorId]);\n\n  useEffect(() => {\n    fetchUser();\n  }, [fetchUser]);\n\n  useEffect(() => {\n    fetchTimeline();\n  }, [fetchTimeline]);\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case 'wallet_tx':\n        return <Wallet className=\"w-4 h-4\" />;\n      case 'entry':\n        return <Target className=\"w-4 h-4\" />;\n      case 'settlement':\n        return <Trophy className=\"w-4 h-4\" />;\n      case 'admin':\n        return <Shield className=\"w-4 h-4\" />;\n      default:\n        return <Calendar className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case 'wallet_tx':\n        return 'bg-emerald-600/20 text-emerald-400';\n      case 'entry':\n        return 'bg-blue-600/20 text-blue-400';\n      case 'settlement':\n        return 'bg-purple-600/20 text-purple-400';\n      case 'admin':\n        return 'bg-amber-600/20 text-amber-400';\n      default:\n        return 'bg-slate-600/20 text-slate-400';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"text-center py-20\">\n        <AlertTriangle className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n        <p className=\"text-white font-medium\">User not found</p>\n        <button\n          onClick={() => navigate('/admin/users')}\n          className=\"mt-4 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600\"\n        >\n          Back to Users\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back Button */}\n      <button\n        onClick={() => navigate('/admin/users')}\n        className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors\"\n      >\n        <ArrowLeft className=\"w-4 h-4\" />\n        Back to Users\n      </button>\n\n      {/* User Header */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-6\">\n        <div className=\"flex items-start gap-4\">\n          {/* Avatar */}\n          <div className=\"w-16 h-16 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0\">\n            {user.avatarUrl ? (\n              <img src={user.avatarUrl} alt=\"\" className=\"w-full h-full object-cover\" />\n            ) : (\n              <User className=\"w-8 h-8 text-slate-400\" />\n            )}\n          </div>\n\n          {/* Info */}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-center gap-2 flex-wrap\">\n              <h1 className=\"text-xl font-bold text-white\">\n                {user.fullName || user.username || 'Unknown User'}\n              </h1>\n              {user.isAdmin && (\n                <span className=\"px-2 py-0.5 bg-amber-600/20 text-amber-400 text-xs font-medium rounded flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> Admin\n                </span>\n              )}\n              {user.isVerified && (\n                <span className=\"px-2 py-0.5 bg-blue-600/20 text-blue-400 text-xs font-medium rounded flex items-center gap-1\">\n                  <BadgeCheck className=\"w-3 h-3\" /> Verified\n                </span>\n              )}\n            </div>\n\n            {user.username && (\n              <p className=\"text-slate-400 mt-1\">@{user.username}</p>\n            )}\n\n            <div className=\"flex items-center gap-4 mt-3 text-sm\">\n              {user.email && (\n                <span className=\"flex items-center gap-1 text-slate-400\">\n                  <Mail className=\"w-4 h-4\" />\n                  {user.email}\n                </span>\n              )}\n              <span className=\"flex items-center gap-1 text-slate-400\">\n                <Calendar className=\"w-4 h-4\" />\n                Joined {new Date(user.createdAt).toLocaleDateString()}\n              </span>\n            </div>\n\n            <p className=\"text-xs text-slate-500 mt-2 font-mono\">ID: {user.id}</p>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex flex-col gap-2\">\n            <button\n              onClick={() => navigate(`/admin/users/${user.id}/view`)}\n              className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors\"\n            >\n              View as user\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <DollarSign className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Available</span>\n          </div>\n          <p className=\"text-xl font-bold text-white\">\n            ${wallet?.availableBalance?.toFixed(2) || '0.00'}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Wallet className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Deposited</span>\n          </div>\n          <p className=\"text-xl font-bold text-white\">\n            ${wallet?.totalDeposited?.toFixed(2) || '0.00'}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Target className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Bets</span>\n          </div>\n          <p className=\"text-xl font-bold text-white\">{stats?.totalBets || 0}</p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Trophy className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Win Rate</span>\n          </div>\n          <p className=\"text-xl font-bold text-emerald-400\">{stats?.winRate || '0'}%</p>\n        </div>\n      </div>\n\n      {/* Timeline */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-4 py-3 border-b border-slate-700 flex items-center justify-between\">\n          <h2 className=\"text-white font-semibold\">Activity Timeline</h2>\n          <select\n            value={timelineFilter}\n            onChange={(e) => setTimelineFilter(e.target.value as any)}\n            className=\"px-3 py-1.5 bg-slate-700 border border-slate-600 rounded-lg text-sm text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n          >\n            <option value=\"all\">All Activity</option>\n            <option value=\"wallet\">Wallet</option>\n            <option value=\"bets\">Bets</option>\n            <option value=\"settlements\">Settlements</option>\n            <option value=\"admin\">Admin Actions</option>\n          </select>\n        </div>\n\n        <div className=\"divide-y divide-slate-700 max-h-[500px] overflow-y-auto\">\n          {timelineLoading ? (\n            <div className=\"p-8 text-center\">\n              <Loader2 className=\"w-6 h-6 text-emerald-500 animate-spin mx-auto\" />\n              <p className=\"text-slate-400 mt-2 text-sm\">Loading timeline...</p>\n            </div>\n          ) : timeline.length === 0 ? (\n            <div className=\"p-8 text-center\">\n              <Calendar className=\"w-8 h-8 text-slate-600 mx-auto mb-2\" />\n              <p className=\"text-slate-400\">No activity found</p>\n            </div>\n          ) : (\n            timeline.map((item) => (\n              <div key={item.id} className=\"hover:bg-slate-700/30 transition-colors\">\n                <button\n                  onClick={() => setExpandedId(expandedId === item.id ? null : item.id)}\n                  className=\"w-full px-4 py-3 text-left\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${getTypeColor(item.type)}`}>\n                      {getTypeIcon(item.type)}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-white text-sm\">{item.summary}</p>\n                      <p className=\"text-xs text-slate-500 mt-0.5\">\n                        {new Date(item.timestamp).toLocaleString()}\n                      </p>\n                    </div>\n                    {expandedId === item.id ? (\n                      <ChevronUp className=\"w-4 h-4 text-slate-400\" />\n                    ) : (\n                      <ChevronDown className=\"w-4 h-4 text-slate-400\" />\n                    )}\n                  </div>\n                </button>\n\n                {expandedId === item.id && (\n                  <div className=\"px-4 pb-3\">\n                    <div className=\"bg-slate-900 rounded-lg p-3 ml-11\">\n                      <pre className=\"text-xs text-slate-300 font-mono overflow-x-auto\">\n                        {JSON.stringify(item.details, null, 2)}\n                      </pre>\n                      {item.details.predictionId && (\n                        <button\n                          onClick={() => navigate(`/prediction/${item.details.predictionId}`)}\n                          className=\"mt-2 flex items-center gap-1 text-xs text-emerald-400 hover:text-emerald-300\"\n                        >\n                          <ExternalLink className=\"w-3 h-3\" />\n                          View Prediction\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Crypto Addresses */}\n      {addresses.length > 0 && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <h3 className=\"text-white font-semibold mb-3\">Crypto Addresses</h3>\n          <div className=\"space-y-2\">\n            {addresses.map((addr, i) => (\n              <div key={i} className=\"flex items-center justify-between text-sm\">\n                <span className=\"font-mono text-slate-300\">{addr.address}</span>\n                <span className=\"text-slate-500\">Chain {addr.chain_id}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UserDetailPage;\n\n","import React, { useEffect, useMemo, useState, useCallback } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { ArrowLeft, Eye, Loader2 } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet } from '@/lib/adminApi';\n\ntype TabKey = 'active' | 'complete' | 'created' | 'activity';\n\nexport const UserViewPage: React.FC = () => {\n  const { userId } = useParams<{ userId: string }>();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  const [tab, setTab] = useState<TabKey>('active');\n\n  const [summary, setSummary] = useState<any>(null);\n  const [predictions, setPredictions] = useState<any>(null);\n  const [activity, setActivity] = useState<any[]>([]);\n\n  const fetchAll = useCallback(async () => {\n    if (!userId) return;\n    setLoading(true);\n    try {\n      const [s, p, a] = await Promise.all([\n        adminGet<any>(`/api/v2/admin/users/${userId}/summary`, ''),\n        adminGet<any>(`/api/v2/admin/users/${userId}/predictions`, ''),\n        adminGet<any>(`/api/v2/admin/users/${userId}/activity`, '', { limit: 100 }),\n      ]);\n      setSummary(s);\n      setPredictions(p);\n      setActivity(a.items || []);\n    } catch (e: any) {\n      console.error('[Admin/UserView] fetch error', e);\n      toast.error(e?.message || 'Failed to load user view');\n    } finally {\n      setLoading(false);\n    }\n  }, [userId]);\n\n  useEffect(() => {\n    fetchAll();\n  }, [fetchAll]);\n\n  const userLabel = useMemo(() => {\n    const u = summary?.user;\n    return u?.fullName || u?.username || u?.email || (userId ? `${userId.slice(0, 8)}` : 'User');\n  }, [summary, userId]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  if (!summary?.user) {\n    return (\n      <div className=\"text-center py-20\">\n        <p className=\"text-white font-medium\">User not found</p>\n        <button\n          onClick={() => navigate('/admin/users')}\n          className=\"mt-4 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600\"\n        >\n          Back to Users\n        </button>\n      </div>\n    );\n  }\n\n  const wallet = summary.wallet;\n\n  const tabItems: Array<{ key: TabKey; label: string }> = [\n    { key: 'active', label: 'Active' },\n    { key: 'complete', label: 'Complete' },\n    { key: 'created', label: 'Created' },\n    { key: 'activity', label: 'Activity' },\n  ];\n\n  const listForTab = (key: TabKey): any[] => {\n    if (!predictions) return [];\n    if (key === 'active') return predictions.active || [];\n    if (key === 'complete') return predictions.complete || [];\n    if (key === 'created') return predictions.created || [];\n    return [];\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back */}\n      <button\n        onClick={() => navigate(`/admin/users/${userId}`)}\n        className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors\"\n      >\n        <ArrowLeft className=\"w-4 h-4\" />\n        Back to User\n      </button>\n\n      {/* Banner */}\n      <div className=\"bg-amber-600/20 border border-amber-600/30 rounded-xl p-4 flex items-start gap-3\">\n        <Eye className=\"w-5 h-5 text-amber-400 mt-0.5\" />\n        <div className=\"flex-1\">\n          <p className=\"text-white font-semibold\">Admin view (read-only)</p>\n          <p className=\"text-slate-300 text-sm\">\n            You are viewing the user experience in read-only mode. No staking/cancelling/editing actions are available.\n          </p>\n        </div>\n      </div>\n\n      {/* Header */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n        <div className=\"flex items-center justify-between gap-3 flex-wrap\">\n          <div>\n            <p className=\"text-white font-semibold\">{userLabel}</p>\n            <p className=\"text-slate-500 text-xs font-mono\">userId: {summary.user.id}</p>\n          </div>\n          <button\n            onClick={() => fetchAll()}\n            className=\"px-3 py-2 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600\"\n          >\n            Refresh\n          </button>\n        </div>\n      </div>\n\n      {/* Wallet snapshot */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <p className=\"text-slate-400 text-sm\">Demo balance</p>\n          <p className=\"text-white text-xl font-bold\">${Number(wallet?.availableBalance || 0).toFixed(2)}</p>\n        </div>\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <p className=\"text-slate-400 text-sm\">Crypto balance</p>\n          <p className=\"text-white text-xl font-bold\"></p>\n          <p className=\"text-slate-500 text-xs mt-1\">Placeholder (depends on escrow/chain model)</p>\n        </div>\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <p className=\"text-slate-400 text-sm\">Fiat balance</p>\n          <p className=\"text-white text-xl font-bold\"></p>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-2 flex-wrap\">\n        {tabItems.map((t) => (\n          <button\n            key={t.key}\n            onClick={() => setTab(t.key)}\n            className={`px-4 py-2 rounded-lg font-medium transition-colors ${\n              tab === t.key ? 'bg-emerald-600 text-white' : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n            }`}\n          >\n            {t.label}\n          </button>\n        ))}\n      </div>\n\n      {/* Content */}\n      {tab === 'activity' ? (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n          {activity.length === 0 ? (\n            <div className=\"p-8 text-center text-slate-400\">No activity found</div>\n          ) : (\n            <div className=\"divide-y divide-slate-700\">\n              {activity.map((a) => (\n                <div key={a.id} className=\"px-4 py-3\">\n                  <div className=\"flex items-center justify-between gap-3\">\n                    <div className=\"min-w-0\">\n                      <p className=\"text-white text-sm font-medium truncate\">{a.title}</p>\n                      <p className=\"text-slate-400 text-xs mt-0.5\">\n                        {a.rail?.toUpperCase?.() || ''}  {new Date(a.created_at).toLocaleString()}\n                      </p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-white text-sm font-semibold\">\n                        {typeof a.amount === 'number' ? `$${Math.abs(a.amount).toFixed(2)}` : ''}\n                      </p>\n                    </div>\n                  </div>\n                  {a.href && (\n                    <button\n                      onClick={() => navigate(a.href)}\n                      className=\"mt-2 text-xs text-emerald-400 hover:text-emerald-300\"\n                    >\n                      Open\n                    </button>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n          {listForTab(tab).length === 0 ? (\n            <div className=\"p-8 text-center text-slate-400\">No items</div>\n          ) : (\n            <div className=\"divide-y divide-slate-700\">\n              {listForTab(tab).map((p) => (\n                <button\n                  key={p.id}\n                  onClick={() => navigate(`/admin/predictions/${p.id}`)}\n                  className=\"w-full px-4 py-3 hover:bg-slate-700/40 transition-colors text-left\"\n                >\n                  <p className=\"text-white font-medium\">{p.title}</p>\n                  <p className=\"text-slate-400 text-xs mt-0.5\">\n                    status: {p.status}  id: {String(p.id).slice(0, 8)}\n                  </p>\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UserViewPage;\n\n","import React, { useState, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Wallet, Search, Loader2, User, ArrowRight } from 'lucide-react';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { adminGet } from '@/lib/adminApi';\n\ninterface UserResult {\n  id: string;\n  username: string | null;\n  fullName: string | null;\n  email: string | null;\n}\n\nexport const WalletsPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState<UserResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [searched, setSearched] = useState(false);\n\n  const handleSearch = useCallback(async () => {\n    if (!query.trim()) return;\n    \n    setLoading(true);\n    setSearched(true);\n    try {\n      const data = await adminGet<{ items?: UserResult[] }>(`/api/v2/admin/users/search`, actorId, {\n        q: query.trim(),\n        limit: 25,\n      });\n      setResults(data.items || []);\n    } catch (e) {\n      console.error('[WalletsPage] Search error:', e);\n      setResults([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [query, actorId]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handleSearch();\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <Wallet className=\"w-7 h-7 text-emerald-500\" />\n          Wallet Management\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Search users to view their wallet details</p>\n      </div>\n\n      {/* Search */}\n      <div className=\"flex gap-3\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400\" />\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search by email, username, or user ID...\"\n            className=\"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\n          />\n        </div>\n        <button\n          onClick={handleSearch}\n          disabled={loading || !query.trim()}\n          className=\"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n        >\n          {loading ? (\n            <Loader2 className=\"w-5 h-5 animate-spin\" />\n          ) : (\n            <Search className=\"w-5 h-5\" />\n          )}\n          Search\n        </button>\n      </div>\n\n      {/* Results */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n        {!searched ? (\n          <div className=\"p-12 text-center\">\n            <Wallet className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">Search for a user</p>\n            <p className=\"text-slate-400 text-sm mt-1\">\n              Enter an email, username, or user ID to view their wallet\n            </p>\n          </div>\n        ) : loading ? (\n          <div className=\"p-12 text-center\">\n            <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto\" />\n            <p className=\"text-slate-400 mt-3\">Searching...</p>\n          </div>\n        ) : results.length === 0 ? (\n          <div className=\"p-12 text-center\">\n            <User className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">No users found</p>\n            <p className=\"text-slate-400 text-sm mt-1\">Try a different search term</p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-slate-700\">\n            {results.map((user) => (\n              <button\n                key={user.id}\n                onClick={() => navigate(`/admin/wallets/${user.id}`)}\n                className=\"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between\"\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center\">\n                    <User className=\"w-5 h-5 text-slate-400\" />\n                  </div>\n                  <div>\n                    <p className=\"text-white font-medium\">\n                      {user.fullName || user.username || 'Unknown User'}\n                    </p>\n                    <p className=\"text-sm text-slate-400\">\n                      {user.email || user.id.slice(0, 8) + '...'}\n                    </p>\n                  </div>\n                </div>\n                <ArrowRight className=\"w-5 h-5 text-slate-400\" />\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default WalletsPage;\n\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Wallet,\n  ArrowLeft,\n  Download,\n  Loader2,\n  DollarSign,\n  TrendingUp,\n  TrendingDown,\n  Lock,\n  Clock,\n  AlertTriangle,\n  ExternalLink,\n} from 'lucide-react';\nimport { adminGet, buildAdminUrl } from '@/lib/adminApi';\nimport { getAdminKey } from '@/components/admin/AdminGate';\n\ninterface WalletData {\n  id: string;\n  currency: string;\n  availableBalance: number;\n  reservedBalance: number;\n  totalDeposited: number;\n  totalWithdrawn: number;\n  updatedAt: string;\n}\n\ninterface Transaction {\n  id: string;\n  created_at: string;\n  type: string;\n  direction: string;\n  channel: string;\n  provider: string;\n  amount: number;\n  currency: string;\n  status: string;\n  description: string;\n  external_ref: string | null;\n  prediction_id: string | null;\n}\n\ninterface EscrowLock {\n  id: string;\n  amount: number;\n  status: string;\n  prediction_id: string;\n  created_at: string;\n  expires_at: string | null;\n}\n\nexport const UserWalletPage: React.FC = () => {\n  const { userId } = useParams<{ userId: string }>();\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [wallets, setWallets] = useState<WalletData[]>([]);\n  const [cryptoTx, setCryptoTx] = useState<Transaction[]>([]);\n  const [demoTx, setDemoTx] = useState<Transaction[]>([]);\n  const [escrowLocks, setEscrowLocks] = useState<EscrowLock[]>([]);\n  const [addresses, setAddresses] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [providerFilter, setProviderFilter] = useState<'all' | 'crypto' | 'demo'>('all');\n  const [exporting, setExporting] = useState(false);\n\n  const fetchData = useCallback(async () => {\n    if (!userId) return;\n    setLoading(true);\n    try {\n      const data = await adminGet<any>(`/api/v2/admin/wallets/user/${userId}`, actorId);\n      setWallets(data.wallets || []);\n      setCryptoTx(data.recentTransactions?.crypto || []);\n      setDemoTx(data.recentTransactions?.demo || []);\n      setEscrowLocks(data.escrowLocks || []);\n      setAddresses(data.addresses || []);\n    } catch (e) {\n      console.error('[UserWallet] Fetch error:', e);\n    } finally {\n      setLoading(false);\n    }\n  }, [userId, actorId]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const handleExport = async () => {\n    if (!userId) return;\n    setExporting(true);\n    try {\n      const url = buildAdminUrl(`/api/v2/admin/wallets/transactions/export.csv`, actorId, {\n        userId,\n        provider: providerFilter,\n        limit: 500,\n      });\n      const adminKey = getAdminKey();\n      const res = await fetch(url, {\n        headers: adminKey ? { 'x-admin-key': adminKey } : undefined,\n        credentials: 'include',\n      });\n      if (!res.ok) throw new Error('Export failed');\n      const blob = await res.blob();\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = downloadUrl;\n      a.download = `transactions_${userId.slice(0, 8)}_${Date.now()}.csv`;\n      document.body.appendChild(a);\n      a.click();\n      a.remove();\n      window.URL.revokeObjectURL(downloadUrl);\n    } catch (e) {\n      console.error('[UserWallet] Export error:', e);\n    } finally {\n      setExporting(false);\n    }\n  };\n\n  const filteredTx = providerFilter === 'crypto' ? cryptoTx \n    : providerFilter === 'demo' ? demoTx \n    : [...cryptoTx, ...demoTx].sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\n\n  const usdWallet = wallets.find(w => w.currency === 'USD');\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back Button */}\n      <button\n        onClick={() => navigate('/admin/wallets')}\n        className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors\"\n      >\n        <ArrowLeft className=\"w-4 h-4\" />\n        Back to Wallets\n      </button>\n\n      {/* Page Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n            <Wallet className=\"w-7 h-7 text-emerald-500\" />\n            User Wallet\n          </h1>\n          <p className=\"text-slate-400 mt-1 font-mono text-sm\">{userId}</p>\n        </div>\n        <button\n          onClick={() => navigate(`/admin/users/${userId}`)}\n          className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 transition-colors text-sm flex items-center gap-2\"\n        >\n          View User Profile\n          <ExternalLink className=\"w-4 h-4\" />\n        </button>\n      </div>\n\n      {/* Balance Cards */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <DollarSign className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Available</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">\n            ${usdWallet?.availableBalance?.toFixed(2) || '0.00'}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Lock className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Reserved</span>\n          </div>\n          <p className=\"text-2xl font-bold text-amber-400\">\n            ${usdWallet?.reservedBalance?.toFixed(2) || '0.00'}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <TrendingUp className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Deposited</span>\n          </div>\n          <p className=\"text-2xl font-bold text-emerald-400\">\n            ${usdWallet?.totalDeposited?.toFixed(2) || '0.00'}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <TrendingDown className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Withdrawn</span>\n          </div>\n          <p className=\"text-2xl font-bold text-red-400\">\n            ${usdWallet?.totalWithdrawn?.toFixed(2) || '0.00'}\n          </p>\n        </div>\n      </div>\n\n      {/* Crypto Addresses */}\n      {addresses.length > 0 && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <h3 className=\"text-white font-semibold mb-3\">Crypto Addresses</h3>\n          <div className=\"space-y-2\">\n            {addresses.map((addr, i) => (\n              <div key={i} className=\"flex items-center justify-between text-sm bg-slate-900 rounded-lg px-3 py-2\">\n                <span className=\"font-mono text-slate-300\">{addr.address}</span>\n                <span className=\"text-slate-500\">Chain {addr.chain_id}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Transactions */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-4 py-3 border-b border-slate-700 flex items-center justify-between flex-wrap gap-3\">\n          <h2 className=\"text-white font-semibold\">Transactions</h2>\n          <div className=\"flex items-center gap-3\">\n            {/* Filter Chips */}\n            <div className=\"flex gap-1\">\n              {(['all', 'crypto', 'demo'] as const).map((filter) => (\n                <button\n                  key={filter}\n                  onClick={() => setProviderFilter(filter)}\n                  className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${\n                    providerFilter === filter\n                      ? 'bg-emerald-600 text-white'\n                      : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n                  }`}\n                >\n                  {filter.charAt(0).toUpperCase() + filter.slice(1)}\n                </button>\n              ))}\n            </div>\n            \n            {/* Export Button */}\n            <button\n              onClick={handleExport}\n              disabled={exporting}\n              className=\"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm flex items-center gap-2 hover:bg-slate-600 disabled:opacity-50\"\n            >\n              {exporting ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Download className=\"w-4 h-4\" />\n              )}\n              Export CSV\n            </button>\n          </div>\n        </div>\n\n        <div className=\"divide-y divide-slate-700 max-h-[400px] overflow-y-auto\">\n          {filteredTx.length === 0 ? (\n            <div className=\"p-8 text-center\">\n              <AlertTriangle className=\"w-8 h-8 text-slate-600 mx-auto mb-2\" />\n              <p className=\"text-slate-400\">No transactions found</p>\n            </div>\n          ) : (\n            filteredTx.map((tx) => (\n              <div key={tx.id} className=\"px-4 py-3 hover:bg-slate-700/30 transition-colors\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${\n                      tx.direction === 'credit' ? 'bg-emerald-600/20 text-emerald-400' : 'bg-red-600/20 text-red-400'\n                    }`}>\n                      {tx.direction === 'credit' ? (\n                        <TrendingUp className=\"w-4 h-4\" />\n                      ) : (\n                        <TrendingDown className=\"w-4 h-4\" />\n                      )}\n                    </div>\n                    <div>\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-white font-medium\">\n                          {tx.direction === 'credit' ? '+' : '-'}${Math.abs(Number(tx.amount)).toFixed(2)}\n                        </span>\n                        <span className={`px-1.5 py-0.5 text-xs rounded ${\n                          tx.provider === 'demo-wallet' ? 'bg-purple-600/20 text-purple-400' : 'bg-blue-600/20 text-blue-400'\n                        }`}>\n                          {tx.provider === 'demo-wallet' ? 'Demo' : 'Crypto'}\n                        </span>\n                      </div>\n                      <p className=\"text-xs text-slate-400 mt-0.5\">\n                        {tx.channel}  {tx.description || tx.type}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-xs text-slate-500\">\n                      {new Date(tx.created_at).toLocaleString()}\n                    </p>\n                    <p className={`text-xs mt-0.5 ${\n                      tx.status === 'success' ? 'text-emerald-400' : 'text-amber-400'\n                    }`}>\n                      {tx.status}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Escrow Locks */}\n      {escrowLocks.length > 0 && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n          <div className=\"px-4 py-3 border-b border-slate-700\">\n            <h2 className=\"text-white font-semibold\">Escrow Locks</h2>\n          </div>\n          <div className=\"divide-y divide-slate-700\">\n            {escrowLocks.map((lock) => (\n              <div key={lock.id} className=\"px-4 py-3 flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-8 h-8 rounded-lg bg-amber-600/20 flex items-center justify-center\">\n                    <Lock className=\"w-4 h-4 text-amber-400\" />\n                  </div>\n                  <div>\n                    <p className=\"text-white font-medium\">${Number(lock.amount).toFixed(2)}</p>\n                    <p className=\"text-xs text-slate-400\">{lock.status}</p>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-xs text-slate-500 font-mono\">\n                    {lock.prediction_id?.slice(0, 8)}...\n                  </p>\n                  {lock.expires_at && (\n                    <p className=\"text-xs text-slate-500 flex items-center gap-1 justify-end mt-0.5\">\n                      <Clock className=\"w-3 h-3\" />\n                      {new Date(lock.expires_at).toLocaleString()}\n                    </p>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UserWalletPage;\n\n","/**\n * Canonical prediction status UI mapping\n * \n * Ensures consistent status labels across all prediction displays.\n * Never shows \"Settled\" unless actually settled.\n */\n\nexport type StatusTone = 'default' | 'success' | 'warning' | 'danger';\n\nexport interface PredictionStatusUi {\n  label: string;\n  tone: StatusTone;\n  subtext?: string;\n}\n\ntype PredictionInput = {\n  status?: string | null;\n  closesAt?: string | number | null;\n  closedAt?: string | number | null;\n  settledAt?: string | number | null;\n  settled_at?: string | number | null;\n  cancelledAt?: string | number | null;\n  voidedAt?: string | number | null;\n  disputeStatus?: string | null;\n  [key: string]: any;\n};\n\n/**\n * Get canonical status UI for a prediction\n * \n * Rules (deterministic):\n * 1) If cancelled/voided  danger badge\n * 2) Else if disputed  warning badge\n * 3) Else if settled  success badge \"Complete\"\n * 4) Else if closed  default badge \"Closed\" + \"Awaiting settlement\"\n * 5) Else  default badge \"Active\"\n */\nexport function getPredictionStatusUi(pred: PredictionInput): PredictionStatusUi {\n  const status = (pred.status || '').toLowerCase();\n  const now = Date.now();\n\n  // Rule 1: Cancelled\n  if (status === 'cancelled' || pred.cancelledAt) {\n    return {\n      label: 'Cancelled',\n      tone: 'danger',\n      subtext: pred.cancelledAt\n        ? `Cancelled on ${new Date(pred.cancelledAt).toLocaleDateString()}`\n        : undefined,\n    };\n  }\n\n  // Rule 2: Voided\n  if (status === 'voided' || pred.voidedAt) {\n    return {\n      label: 'Voided',\n      tone: 'danger',\n      subtext: pred.voidedAt\n        ? `Voided on ${new Date(pred.voidedAt).toLocaleDateString()}`\n        : undefined,\n    };\n  }\n\n  // Rule 3: Disputed\n  const disputeStatus = (pred.disputeStatus || '').toLowerCase();\n  if (disputeStatus === 'open' || disputeStatus === 'active' || status === 'disputed') {\n    return {\n      label: 'Disputed',\n      tone: 'warning',\n      subtext: 'Under review',\n    };\n  }\n\n  // Rule 4: Settled/Complete (highest priority after cancelled/voided/disputed)\n  const hasSettledAt = !!(pred.settledAt || pred.settled_at);\n  const isSettled = hasSettledAt || status === 'settled' || status === 'complete';\n  \n  if (isSettled) {\n    const settledDate = pred.settledAt || pred.settled_at;\n    return {\n      label: 'Complete',\n      tone: 'success',\n      subtext: settledDate\n        ? `Settled on ${new Date(settledDate).toLocaleDateString()}`\n        : undefined,\n    };\n  }\n\n  // Rule 5: Closed (but not settled)\n  const hasClosedAt = !!pred.closedAt;\n  const closesAtTime = pred.closesAt ? new Date(pred.closesAt).getTime() : null;\n  const isPastDeadline = closesAtTime ? closesAtTime <= now : false;\n  const isClosed = hasClosedAt || status === 'closed' || status === 'awaiting_settlement' || isPastDeadline;\n\n  if (isClosed) {\n    return {\n      label: 'Closed',\n      tone: 'default',\n      subtext: 'Awaiting settlement',\n    };\n  }\n\n  // Rule 6: Active (default)\n  return {\n    label: 'Active',\n    tone: 'default',\n    // Optional: Add relative time if helpers exist (not adding new formatting here)\n  };\n}\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Target,\n  Search,\n  Loader2,\n  ArrowRight,\n  Filter,\n  CheckCircle,\n  Clock,\n  XCircle,\n  Ban,\n} from 'lucide-react';\nimport { adminGet } from '@/lib/adminApi';\nimport { getPredictionStatusUi } from '@/lib/predictionStatusUi';\n\ninterface PredictionResult {\n  id: string;\n  title: string;\n  status: string;\n  createdAt: string;\n  endDate: string | null;\n  closesAt?: string | null;\n  settledAt?: string | null;\n  creatorUsername: string | null;\n  creatorName: string | null;\n  railsSummary?: { hasDemo: boolean; hasCrypto: boolean };\n}\n\nconst statusConfig: Record<string, { icon: React.ElementType; color: string; label: string }> = {\n  active: { icon: Clock, color: 'text-emerald-400 bg-emerald-600/20', label: 'Active' },\n  pending: { icon: Clock, color: 'text-amber-400 bg-amber-600/20', label: 'Pending' },\n  settled: { icon: CheckCircle, color: 'text-blue-400 bg-blue-600/20', label: 'Settled' },\n  voided: { icon: XCircle, color: 'text-red-400 bg-red-600/20', label: 'Voided' },\n  cancelled: { icon: Ban, color: 'text-slate-400 bg-slate-600/20', label: 'Cancelled' },\n};\n\nexport const PredictionsPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [query, setQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [railFilter, setRailFilter] = useState<string>('all');\n  const [results, setResults] = useState<PredictionResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [total, setTotal] = useState(0);\n\n  const fetchPredictions = useCallback(async () => {\n    setLoading(true);\n    try {\n      const data = await adminGet<{ items?: PredictionResult[]; total?: number }>(\n        `/api/v2/admin/predictions`,\n        actorId,\n        {\n          q: query || undefined,\n          status: statusFilter !== 'all' ? statusFilter : undefined,\n          rail: railFilter !== 'all' ? railFilter : undefined,\n          limit: 50,\n        }\n      );\n      setResults(data.items || []);\n      setTotal(data.total || 0);\n    } catch (e) {\n      console.error('[PredictionsPage] Search error:', e);\n      setResults([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [query, statusFilter, railFilter, actorId]);\n\n  useEffect(() => {\n    fetchPredictions();\n  }, [statusFilter, railFilter, fetchPredictions]);\n\n  const handleSearch = () => {\n    fetchPredictions();\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      fetchPredictions();\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <Target className=\"w-7 h-7 text-emerald-500\" />\n          Prediction Management\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Search and manage predictions</p>\n      </div>\n\n      {/* Search + Filter */}\n      <div className=\"flex gap-3 flex-wrap\">\n        <div className=\"relative flex-1 min-w-[250px]\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400\" />\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search by title or prediction ID...\"\n            className=\"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\n          />\n        </div>\n\n        <div className=\"relative\">\n          <Filter className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\n          <select\n            value={statusFilter}\n            onChange={(e) => setStatusFilter(e.target.value)}\n            className=\"pl-10 pr-8 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n          >\n            <option value=\"all\">All Status</option>\n            <option value=\"active\">Active (Open)</option>\n            <option value=\"closed\">Closed</option>\n            <option value=\"settled\">Settled</option>\n            <option value=\"voided\">Voided</option>\n            <option value=\"cancelled\">Cancelled</option>\n          </select>\n        </div>\n\n        <div className=\"relative\">\n          <Filter className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\n          <select\n            value={railFilter}\n            onChange={(e) => setRailFilter(e.target.value)}\n            className=\"pl-10 pr-8 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n          >\n            <option value=\"all\">All Rails</option>\n            <option value=\"demo\">Demo</option>\n            <option value=\"crypto\">Crypto</option>\n            <option value=\"hybrid\">Hybrid</option>\n          </select>\n        </div>\n\n        <button\n          onClick={handleSearch}\n          disabled={loading}\n          className=\"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n        >\n          {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : <Search className=\"w-5 h-5\" />}\n          Search\n        </button>\n      </div>\n\n      {/* Results Count */}\n      {!loading && (\n        <p className=\"text-slate-400 text-sm\">{total} prediction{total !== 1 ? 's' : ''} found</p>\n      )}\n\n      {/* Results */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n        {loading ? (\n          <div className=\"p-12 text-center\">\n            <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto\" />\n            <p className=\"text-slate-400 mt-3\">Searching...</p>\n          </div>\n        ) : results.length === 0 ? (\n          <div className=\"p-12 text-center\">\n            <Target className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">No predictions found</p>\n            <p className=\"text-slate-400 text-sm mt-1\">Try a different search term or filter</p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-slate-700\">\n            {results.map((p) => {\n              const fallback = statusConfig.pending ?? {\n                icon: Clock,\n                color: 'text-amber-400 bg-amber-600/20',\n                label: 'Pending',\n              };\n              const config = statusConfig[p.status] ?? fallback;\n              const StatusIcon = config.icon;\n              const rails = p.railsSummary || { hasDemo: false, hasCrypto: false };\n              const railLabel = rails.hasDemo && rails.hasCrypto ? 'Hybrid' : rails.hasCrypto ? 'Crypto' : rails.hasDemo ? 'Demo' : '';\n              const statusUi = getPredictionStatusUi({\n                status: p.status,\n                closedAt: p.closesAt || p.endDate || null,\n                settledAt: p.settledAt || null,\n              });\n              const statusTone =\n                statusUi.tone === 'success' ? 'text-emerald-400 bg-emerald-600/20' :\n                statusUi.tone === 'danger' ? 'text-red-400 bg-red-600/20' :\n                statusUi.tone === 'warning' ? 'text-amber-400 bg-amber-600/20' :\n                'text-slate-400 bg-slate-600/20';\n              return (\n                <button\n                  key={p.id}\n                  onClick={() => navigate(`/admin/predictions/${p.id}`)}\n                  className=\"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between\"\n                >\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"text-white font-medium truncate\">{p.title}</p>\n                      <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${statusTone}`}>\n                        {statusUi.label}\n                      </span>\n                      <span className=\"px-2 py-0.5 rounded-full text-xs font-medium text-slate-300 bg-slate-700/50\">\n                        {railLabel}\n                      </span>\n                    </div>\n                    <p className=\"text-sm text-slate-400 mt-0.5\">\n                      by {p.creatorName || p.creatorUsername || 'Unknown'} {' '}\n                      closes {new Date((p.closesAt || p.endDate || p.createdAt) as string).toLocaleDateString()}\n                    </p>\n                  </div>\n                  <ArrowRight className=\"w-5 h-5 text-slate-400 flex-shrink-0 ml-3\" />\n                </button>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PredictionsPage;\n\n","import React from 'react';\n\n/**\n * Category UI helpers - single source of truth for category display\n * Backward compatible with existing prediction payloads\n */\n\n/**\n * Get category label from prediction (backward compatible)\n */\nexport function getCategoryLabel(pred: any): string | null {\n  if (!pred) return null;\n\n  // New format: category object\n  if (pred.categoryObj && typeof pred.categoryObj === 'object' && pred.categoryObj.label) {\n    return pred.categoryObj.label;\n  }\n\n  // Alternative: categoryLabel string\n  if (pred.categoryLabel && typeof pred.categoryLabel === 'string') {\n    return pred.categoryLabel;\n  }\n\n  // Legacy: category string (slug)\n  if (pred.category && typeof pred.category === 'string') {\n    // Capitalize and format slug\n    return pred.category\n      .split('_')\n      .map((word: string) => word.charAt(0).toUpperCase() + word.slice(1))\n      .join(' ');\n  }\n\n  return null;\n}\n\n/**\n * Get category ID from prediction (backward compatible)\n */\nexport function getCategoryId(pred: any): string | null {\n  if (!pred) return null;\n\n  // New format: category object\n  if (pred.categoryObj && typeof pred.categoryObj === 'object' && pred.categoryObj.id) {\n    return pred.categoryObj.id;\n  }\n\n  // Alternative: categoryId\n  if (pred.categoryId && typeof pred.categoryId === 'string') {\n    return pred.categoryId;\n  }\n\n  // Legacy: category_id\n  if (pred.category_id && typeof pred.category_id === 'string') {\n    return pred.category_id;\n  }\n\n  return null;\n}\n\n/**\n * Get category slug from prediction (backward compatible)\n */\nexport function getCategorySlug(pred: any): string | null {\n  if (!pred) return null;\n\n  // New format: category object\n  if (pred.categoryObj && typeof pred.categoryObj === 'object' && pred.categoryObj.slug) {\n    return pred.categoryObj.slug;\n  }\n\n  // Legacy: category string (slug)\n  if (pred.category && typeof pred.category === 'string') {\n    return pred.category;\n  }\n\n  return null;\n}\n\n/**\n * Render category chip using existing app chip style\n * Must match the style used in DiscoverPage CategoryFilters\n */\nexport function renderCategoryChip(label: string, isSelected = false): React.ReactElement {\n  const className = isSelected\n    ? 'inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-purple-600 text-white'\n    : 'inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-gray-100 text-gray-700';\n  \n  return React.createElement('span', { className }, label);\n}\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Target,\n  ArrowLeft,\n  Loader2,\n  User,\n  DollarSign,\n  Users,\n  Clock,\n  CheckCircle,\n  XCircle,\n  Ban,\n  RotateCcw,\n  AlertTriangle,\n  ExternalLink,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet, adminPost } from '@/lib/adminApi';\nimport { getPredictionStatusUi } from '@/lib/predictionStatusUi';\nimport { FRONTEND_URL } from '@/utils/environment';\nimport { getCategoryLabel } from '@/lib/categoryUi';\n\ninterface PredictionDetail {\n  prediction: {\n    id: string;\n    title: string;\n    description: string;\n    status: string;\n    createdAt: string;\n    endDate: string | null;\n    resolutionDate: string | null;\n    closesAt?: string | null;\n    closedAt?: string | null;\n    settledAt?: string | null;\n    winningOptionId: string | null;\n    platformFee: number;\n    creatorFee: number;\n  };\n  creator: {\n    id: string;\n    username: string | null;\n    fullName: string | null;\n    email: string | null;\n  } | null;\n  options: Array<{\n    id: string;\n    text: string;\n    odds: number;\n    probability: number;\n    totalStake: number;\n  }>;\n  stats: {\n    totalStake: number;\n    uniqueBettors: number;\n    entryCount: number;\n  };\n  entries: Array<{\n    id: string;\n    user_id: string;\n    option_id: string;\n    amount: number;\n    provider: string;\n    created_at: string;\n    status: string;\n  }>;\n  settlement: any;\n  aggregates?: {\n    demo?: { pot: number; fees?: { platform: number; creator: number }; entriesCount: number };\n    crypto?: { pot: number; fees?: { platform: number; creator: number }; entriesCount: number };\n    total?: { pot: number; entriesCount: number };\n  };\n  disputes?: any[];\n}\n\nexport const PredictionDetailPage: React.FC = () => {\n  const { predictionId } = useParams<{ predictionId: string }>();\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [data, setData] = useState<PredictionDetail | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState(false);\n  const [showVoidModal, setShowVoidModal] = useState(false);\n  const [showCancelModal, setShowCancelModal] = useState(false);\n  const [reason, setReason] = useState('');\n  const [settingOutcome, setSettingOutcome] = useState<string | null>(null);\n\n  const fetchData = useCallback(async () => {\n    if (!predictionId) return;\n    setLoading(true);\n    try {\n      const json = await adminGet<any>(`/api/v2/admin/predictions/${predictionId}`, actorId);\n      setData(json);\n    } catch (e) {\n      console.error('[PredictionDetail] Fetch error:', e);\n      toast.error('Failed to load prediction');\n    } finally {\n      setLoading(false);\n    }\n  }, [predictionId, actorId]);\n\n  const handleSetOutcome = async (optionId: string) => {\n    if (!predictionId) return;\n    setSettingOutcome(optionId);\n    try {\n      const result = await adminPost<any>(\n        `/api/v2/admin/predictions/${predictionId}/outcome`,\n        actorId,\n        actorId ? { optionId, actorId } : { optionId }\n      );\n      \n      // Show detailed success message based on settlement results\n      if (result?.alreadySettled) {\n        toast.success('Already settled');\n      } else if (result?.settlement) {\n        const s = result.settlement;\n        const totalEntries = (s.demoEntriesCount || 0) + (s.cryptoEntriesCount || 0);\n        toast.success(\n          `Settled! ${totalEntries} entries processed. ` +\n          `Fees: $${(s.totalPlatformFee || 0).toFixed(2)} platform, $${(s.totalCreatorFee || 0).toFixed(2)} creator.`\n        );\n      } else {\n        toast.success('Settlement complete');\n      }\n      fetchData();\n    } catch (e: any) {\n      console.error('[Admin/Settlement] Error:', e);\n      toast.error(e?.message || 'Failed to settle prediction');\n    } finally {\n      setSettingOutcome(null);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const handleVoid = async () => {\n    if (!predictionId || !actorId || reason.length < 5) return;\n    setActionLoading(true);\n    try {\n      const json = await adminPost<any>(`/api/v2/admin/predictions/${predictionId}/void`, actorId, { reason });\n      toast.success(`Prediction voided. ${json.refunds?.success || 0} bets refunded.`);\n      setShowVoidModal(false);\n      setReason('');\n      fetchData();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to void prediction');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleCancel = async () => {\n    if (!predictionId || !actorId || reason.length < 5) return;\n    setActionLoading(true);\n    try {\n      await adminPost<any>(`/api/v2/admin/predictions/${predictionId}/cancel`, actorId, { reason });\n      toast.success('Prediction cancelled');\n      setShowCancelModal(false);\n      setReason('');\n      fetchData();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to cancel prediction');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleReset = async () => {\n    if (!predictionId || !actorId) return;\n    if (!window.confirm('Reset this prediction to active? This will undo settlement.')) return;\n    setActionLoading(true);\n    try {\n      await adminPost<any>(`/api/v2/admin/predictions/${predictionId}/reset`, actorId, {});\n      toast.success('Prediction reset to active');\n      fetchData();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to reset prediction');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  if (!data) {\n    return (\n      <div className=\"text-center py-20\">\n        <AlertTriangle className=\"w-12 h-12 text-amber-500 mx-auto mb-3\" />\n        <p className=\"text-white font-medium\">Prediction not found</p>\n      </div>\n    );\n  }\n\n  const { prediction, creator, options, stats, entries } = data;\n  const isActive = prediction.status === 'active';\n  const isSettled = prediction.status === 'settled';\n  const isTerminal = prediction.status === 'voided' || prediction.status === 'cancelled';\n  const appUrl = FRONTEND_URL || 'https://app.fanclubz.app';\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back Button */}\n      <button\n        onClick={() => navigate('/admin/predictions')}\n        className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors\"\n      >\n        <ArrowLeft className=\"w-4 h-4\" />\n        Back to Predictions\n      </button>\n\n      {/* Header */}\n      <div className=\"flex items-start justify-between gap-4 flex-wrap\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n            <Target className=\"w-7 h-7 text-emerald-500\" />\n            {prediction.title}\n          </h1>\n          <div className=\"flex items-center gap-3 mt-1\">\n            <p className=\"text-slate-400 font-mono text-sm\">{prediction.id}</p>\n            {(() => {\n              const categoryLabel = getCategoryLabel(data);\n              return categoryLabel ? (\n                <span className=\"inline-flex items-center rounded-full bg-slate-700 px-2.5 py-0.5 text-xs font-medium text-slate-300\">\n                  {categoryLabel}\n                </span>\n              ) : null;\n            })()}\n          </div>\n        </div>\n\n        {/* Status Badge */}\n        {(() => {\n          const statusUi = getPredictionStatusUi({\n            status: prediction.status,\n            settledAt: prediction.settledAt || prediction.resolutionDate,\n            closedAt: prediction.closedAt || prediction.closesAt || prediction.endDate,\n          });\n          return (\n            <div className={`px-3 py-1.5 rounded-full text-sm font-medium ${\n              statusUi.tone === 'success' ? 'bg-emerald-600/20 text-emerald-400' :\n              statusUi.tone === 'danger' ? 'bg-red-600/20 text-red-400' :\n              statusUi.tone === 'warning' ? 'bg-amber-600/20 text-amber-400' :\n              'bg-slate-600/20 text-slate-400'\n            }`}>\n              {statusUi.label}\n              {statusUi.subtext && (\n                <span className=\"ml-2 text-xs opacity-75\">{statusUi.subtext}</span>\n              )}\n            </div>\n          );\n        })()}\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <DollarSign className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Stake</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">${stats.totalStake.toFixed(2)}</p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Users className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Bettors</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">{stats.uniqueBettors}</p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Target className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Bets</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">{stats.entryCount}</p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Clock className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Created</span>\n          </div>\n          <p className=\"text-lg font-medium text-white\">\n            {new Date(prediction.createdAt).toLocaleDateString()}\n          </p>\n        </div>\n      </div>\n\n      {/* Aggregates (by rail) */}\n      {data.aggregates && (\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <h3 className=\"text-white font-semibold mb-2\">Demo rail</h3>\n            <p className=\"text-slate-400 text-sm\">\n              Pot: <span className=\"text-white\">${Number(data.aggregates.demo?.pot || 0).toFixed(2)}</span>\n            </p>\n            <p className=\"text-slate-400 text-sm\">\n              Entries: <span className=\"text-white\">{data.aggregates.demo?.entriesCount || 0}</span>\n            </p>\n          </div>\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <h3 className=\"text-white font-semibold mb-2\">Crypto rail</h3>\n            <p className=\"text-slate-400 text-sm\">\n              Pot: <span className=\"text-white\">${Number(data.aggregates.crypto?.pot || 0).toFixed(2)}</span>\n            </p>\n            <p className=\"text-slate-400 text-sm\">\n              Entries: <span className=\"text-white\">{data.aggregates.crypto?.entriesCount || 0}</span>\n            </p>\n          </div>\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <h3 className=\"text-white font-semibold mb-2\">Total</h3>\n            <p className=\"text-slate-400 text-sm\">\n              Pot: <span className=\"text-white\">${Number(data.aggregates.total?.pot || 0).toFixed(2)}</span>\n            </p>\n            <p className=\"text-slate-400 text-sm\">\n              Entries: <span className=\"text-white\">{data.aggregates.total?.entriesCount || 0}</span>\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Creator Info */}\n      {creator && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <h3 className=\"text-white font-semibold mb-3 flex items-center gap-2\">\n            <User className=\"w-4 h-4\" />\n            Creator\n          </h3>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-white font-medium\">{creator.fullName || creator.username || 'Unknown'}</p>\n              <p className=\"text-sm text-slate-400\">{creator.email}</p>\n            </div>\n            <button\n              onClick={() => navigate(`/admin/users/${creator.id}`)}\n              className=\"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600 flex items-center gap-1\"\n            >\n              View Profile\n              <ExternalLink className=\"w-3 h-3\" />\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Options */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-4 py-3 border-b border-slate-700\">\n          <h2 className=\"text-white font-semibold\">Options</h2>\n        </div>\n        <div className=\"divide-y divide-slate-700\">\n          {options.map((opt) => (\n            <div\n              key={opt.id}\n              className={`px-4 py-3 flex items-center justify-between ${\n                prediction.winningOptionId === opt.id ? 'bg-emerald-600/10 border-l-4 border-emerald-500' : ''\n              }`}\n            >\n              <div className=\"flex items-center gap-3\">\n                {prediction.winningOptionId === opt.id && (\n                  <CheckCircle className=\"w-5 h-5 text-emerald-400\" />\n                )}\n                <div>\n                  <p className=\"text-white font-medium\">{opt.text}</p>\n                  <p className=\"text-sm text-slate-400\">\n                    Odds: {opt.odds?.toFixed(2) || 'N/A'}  Prob: {((opt.probability || 0) * 100).toFixed(0)}%\n                  </p>\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-white font-medium\">${opt.totalStake.toFixed(2)}</p>\n                <p className=\"text-sm text-slate-400\">staked</p>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Recent Entries */}\n      {entries.length > 0 && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n          <div className=\"px-4 py-3 border-b border-slate-700\">\n            <h2 className=\"text-white font-semibold\">Recent Bets ({entries.length})</h2>\n          </div>\n          <div className=\"divide-y divide-slate-700 max-h-[300px] overflow-y-auto\">\n            {entries.map((entry) => {\n              const opt = options.find(o => o.id === entry.option_id);\n              return (\n                <div key={entry.id} className=\"px-4 py-2 flex items-center justify-between text-sm\">\n                  <div>\n                    <span className=\"text-white font-mono text-xs\">\n                      {entry.user_id.slice(0, 8)}...\n                    </span>\n                    <span className=\"text-slate-400 ml-2\">on \"{opt?.text || '?'}\"</span>\n                  </div>\n                  <div className=\"text-right\">\n                    <span className=\"text-white font-medium\">${Number(entry.amount).toFixed(2)}</span>\n                    <span className={`ml-2 px-1.5 py-0.5 rounded text-xs ${\n                      entry.provider === 'demo-wallet' ? 'bg-purple-600/20 text-purple-400' : 'bg-blue-600/20 text-blue-400'\n                    }`}>\n                      {entry.provider === 'demo-wallet' ? 'Demo' : 'Crypto'}\n                    </span>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Action Bar (Phase 3B spec) */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n        <h3 className=\"text-white font-semibold mb-3\">Navigation</h3>\n        <div className=\"flex flex-wrap gap-3 mb-4\">\n          {/* View as user (creator) */}\n          {creator?.id && (\n            <button\n              onClick={() => navigate(`/admin/users/${creator.id}/view`)}\n              className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 flex items-center gap-2\"\n            >\n              <User className=\"w-4 h-4\" />\n              View as user (creator)\n            </button>\n          )}\n\n          {/* Go to prediction page (open in app) */}\n          <button\n            onClick={() => window.open(`${appUrl}/predictions/${predictionId}`, '_blank')}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 flex items-center gap-2\"\n          >\n            <ExternalLink className=\"w-4 h-4\" />\n            Go to prediction page\n          </button>\n        </div>\n      </div>\n\n      {/* Settle Prediction - Admin sets outcome and triggers immediate settlement */}\n      {!prediction.winningOptionId && !isTerminal && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <h3 className=\"text-white font-semibold mb-2\">Settle Prediction</h3>\n          <p className=\"text-slate-400 text-sm mb-3\">\n            Select the winning outcome to settle this prediction immediately. Winners will be credited and losers debited.\n          </p>\n          <div className=\"flex flex-wrap gap-2\">\n            {options.map((o) => (\n              <button\n                key={o.id}\n                onClick={() => handleSetOutcome(o.id)}\n                disabled={settingOutcome !== null}\n                className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700 disabled:opacity-50\"\n              >\n                {settingOutcome === o.id ? 'Settling' : `Settle: ${o.text}`}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Admin Actions */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n        <h3 className=\"text-white font-semibold mb-4\">Admin Actions</h3>\n        <div className=\"flex flex-wrap gap-3\">\n          {/* Void - refunds bets */}\n          <button\n            onClick={() => setShowVoidModal(true)}\n            disabled={isTerminal || actionLoading}\n            className=\"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n          >\n            <XCircle className=\"w-4 h-4\" />\n            Void (Refund Bets)\n          </button>\n\n          {/* Cancel - no refunds */}\n          <button\n            onClick={() => setShowCancelModal(true)}\n            disabled={isTerminal || actionLoading}\n            className=\"px-4 py-2 bg-slate-600 text-white rounded-lg font-medium hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n          >\n            <Ban className=\"w-4 h-4\" />\n            Cancel (No Refund)\n          </button>\n\n          {/* Reset - undo settlement */}\n          {isSettled && (\n            <button\n              onClick={handleReset}\n              disabled={actionLoading}\n              className=\"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n            >\n              <RotateCcw className=\"w-4 h-4\" />\n              Reset to Active\n            </button>\n          )}\n        </div>\n\n        {isTerminal && (\n          <p className=\"text-amber-400 text-sm mt-3 flex items-center gap-2\">\n            <AlertTriangle className=\"w-4 h-4\" />\n            This prediction has been {prediction.status} and cannot be modified further.\n          </p>\n        )}\n      </div>\n\n      {/* Void Modal */}\n      {showVoidModal && (\n        <div className=\"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700\">\n            <h3 className=\"text-xl font-bold text-white mb-4\">Void Prediction</h3>\n            <p className=\"text-slate-400 mb-4\">\n              This will void the prediction and refund all bets to participants.\n            </p>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Reason (required)\n            </label>\n            <textarea\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder=\"Explain why this prediction is being voided...\"\n              className=\"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-red-500 h-24 resize-none\"\n            />\n            <div className=\"flex justify-end gap-3 mt-4\">\n              <button\n                onClick={() => { setShowVoidModal(false); setReason(''); }}\n                className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleVoid}\n                disabled={reason.length < 5 || actionLoading}\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n              >\n                {actionLoading && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                Void Prediction\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Cancel Modal */}\n      {showCancelModal && (\n        <div className=\"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700\">\n            <h3 className=\"text-xl font-bold text-white mb-4\">Cancel Prediction</h3>\n            <p className=\"text-amber-400 text-sm mb-4 flex items-start gap-2\">\n              <AlertTriangle className=\"w-4 h-4 flex-shrink-0 mt-0.5\" />\n              <span>\n                This will cancel the prediction <strong>without refunding bets</strong>. \n                Use this only for spam/fraud predictions.\n              </span>\n            </p>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Reason (required)\n            </label>\n            <textarea\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder=\"Explain why this prediction is being cancelled...\"\n              className=\"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 h-24 resize-none\"\n            />\n            <div className=\"flex justify-end gap-3 mt-4\">\n              <button\n                onClick={() => { setShowCancelModal(false); setReason(''); }}\n                className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600\"\n              >\n                Back\n              </button>\n              <button\n                onClick={handleCancel}\n                disabled={reason.length < 5 || actionLoading}\n                className=\"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n              >\n                {actionLoading && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                Cancel Prediction\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PredictionDetailPage;\n\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  BarChart3,\n  Loader2,\n  ArrowRight,\n  Clock,\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  RefreshCw,\n  Filter,\n  TrendingUp,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet, adminPost } from '@/lib/adminApi';\n\ninterface QueueItem {\n  predictionId: string;\n  title: string;\n  status: string;\n  closesAt: string | null;\n  closedAt: string | null;\n  settledAt: string | null;\n  settlementStatus: string | null;\n  rails: { hasDemo: boolean; hasCrypto: boolean };\n  needs: {\n    needsOutcome: boolean;\n    needsOffchainSettlement: boolean;\n    needsOnchainFinalize: boolean;\n  };\n  job: {\n    status: string;\n    txHash: string | null;\n    error: string | null;\n    updatedAt: string | null;\n  } | null;\n}\n\ninterface Stats {\n  predictions: {\n    active: number;\n    pendingSettlement: number;\n    settled: number;\n    voided: number;\n  };\n  jobs: {\n    queued: number;\n    running: number;\n    finalized: number;\n    failed: number;\n  };\n  totalStake: number;\n  recentSettlements: number;\n}\n\ntype FilterType = 'all' | 'pending' | 'settled' | 'active';\n\nexport const SettlementsPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [queue, setQueue] = useState<QueueItem[]>([]);\n  const [stats, setStats] = useState<Stats | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState<string | null>(null);\n\n  const fetchData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const [queueData, statsData] = await Promise.all([\n        adminGet<any>(`/api/v2/admin/settlements/queue`, actorId),\n        adminGet<any>(`/api/v2/admin/settlements/stats`, actorId),\n      ]);\n      setQueue(queueData.items || []);\n      setStats(statsData || null);\n    } catch (e) {\n      console.error('[SettlementsPage] Fetch error:', e);\n    } finally {\n      setLoading(false);\n    }\n  }, [actorId]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const handleSync = async (predictionId: string) => {\n    setActionLoading(predictionId);\n    try {\n      await adminPost<any>(`/api/v2/admin/settlements/${predictionId}/sync`, actorId, actorId ? { actorId } : {});\n      toast.success('Sync queued');\n      fetchData();\n    } catch (e) {\n      toast.error((e as any)?.message || 'Failed to sync');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleFinalize = async (predictionId: string) => {\n    if (!window.confirm('Finalize on-chain? This may submit a relayer transaction.')) return;\n    setActionLoading(predictionId);\n    try {\n      await adminPost<any>(`/api/v2/admin/settlements/${predictionId}/finalize`, actorId, actorId ? { actorId } : {});\n      toast.success('Finalize submitted');\n      fetchData();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to finalize');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const getNeedsChips = (item: QueueItem) => {\n    const chips: Array<{ label: string; cls: string }> = [];\n    if (item.needs.needsOutcome) chips.push({ label: 'Outcome', cls: 'bg-amber-600/20 text-amber-400' });\n    if (item.needs.needsOffchainSettlement) chips.push({ label: 'Offchain', cls: 'bg-blue-600/20 text-blue-400' });\n    if (item.needs.needsOnchainFinalize) chips.push({ label: 'Finalize', cls: 'bg-red-600/20 text-red-400' });\n    if (chips.length === 0) chips.push({ label: 'OK', cls: 'bg-emerald-600/20 text-emerald-400' });\n    return chips;\n  };\n\n  const getJobStatusBadge = (job: QueueItem['job']) => {\n    if (!job) return null;\n    \n    const statusConfig: Record<string, { icon: React.ElementType; color: string }> = {\n      queued: { icon: Clock, color: 'text-amber-400 bg-amber-600/20' },\n      running: { icon: RefreshCw, color: 'text-blue-400 bg-blue-600/20' },\n      finalized: { icon: CheckCircle, color: 'text-emerald-400 bg-emerald-600/20' },\n      failed: { icon: XCircle, color: 'text-red-400 bg-red-600/20' },\n    };\n\n    const fallback = statusConfig.queued ?? { icon: Clock, color: 'text-amber-400 bg-amber-600/20' };\n    const config = statusConfig[job.status] ?? fallback;\n    const Icon = config.icon;\n\n    return (\n      <span className={`px-2 py-0.5 rounded-full text-xs font-medium flex items-center gap-1 ${config.color}`}>\n        <Icon className={`w-3 h-3 ${job.status === 'running' ? 'animate-spin' : ''}`} />\n        {job.status}\n      </span>\n    );\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <BarChart3 className=\"w-7 h-7 text-emerald-500\" />\n          Settlements\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Manage prediction settlements and finalization</p>\n      </div>\n\n      {/* Stats Cards */}\n      {stats && (\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n              <AlertTriangle className=\"w-4 h-4 text-amber-400\" />\n              <span className=\"text-sm\">Pending Settlement</span>\n            </div>\n            <p className=\"text-2xl font-bold text-amber-400\">{stats.predictions.pendingSettlement}</p>\n          </div>\n\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n              <CheckCircle className=\"w-4 h-4 text-emerald-400\" />\n              <span className=\"text-sm\">Settled</span>\n            </div>\n            <p className=\"text-2xl font-bold text-emerald-400\">{stats.predictions.settled}</p>\n          </div>\n\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n              <XCircle className=\"w-4 h-4 text-red-400\" />\n              <span className=\"text-sm\">Failed Jobs</span>\n            </div>\n            <p className=\"text-2xl font-bold text-red-400\">{stats.jobs.failed}</p>\n          </div>\n\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n            <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n              <TrendingUp className=\"w-4 h-4\" />\n              <span className=\"text-sm\">Total Staked</span>\n            </div>\n            <p className=\"text-2xl font-bold text-white\">${stats.totalStake.toLocaleString()}</p>\n          </div>\n        </div>\n      )}\n\n      {/* Filter */}\n      <div className=\"text-slate-400 text-sm\">\n        Finalize Queue  items needing Outcome, Offchain sync, or Onchain finalize.\n      </div>\n\n      {/* Finalize Queue List */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n        {loading ? (\n          <div className=\"p-12 text-center\">\n            <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto\" />\n            <p className=\"text-slate-400 mt-3\">Loading queue...</p>\n          </div>\n        ) : queue.length === 0 ? (\n          <div className=\"p-12 text-center\">\n            <BarChart3 className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">Queue is empty</p>\n            <p className=\"text-slate-400 text-sm mt-1\">\n              No predictions need admin settlement attention.\n            </p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-slate-700\">\n            {queue.map((s) => (\n              <div\n                key={s.predictionId}\n                className=\"px-4 py-3 hover:bg-slate-700/30 transition-colors\"\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2 flex-wrap\">\n                      <p className=\"text-white font-medium truncate\">{s.title}</p>\n                      <span className=\"px-2 py-0.5 rounded-full text-xs font-medium bg-slate-600/20 text-slate-300\">\n                        {s.status}\n                      </span>\n                      {getJobStatusBadge(s.job)}\n                      {getNeedsChips(s).map((c) => (\n                        <span key={c.label} className={`px-2 py-0.5 rounded-full text-xs font-medium ${c.cls}`}>\n                          {c.label}\n                        </span>\n                      ))}\n                    </div>\n                    <p className=\"text-sm text-slate-400 mt-0.5\">\n                      Rails: {s.rails.hasDemo && s.rails.hasCrypto ? 'Hybrid' : s.rails.hasCrypto ? 'Crypto' : s.rails.hasDemo ? 'Demo' : ''} \n                      Closes: {s.closesAt ? new Date(s.closesAt).toLocaleDateString() : ''}\n                    </p>\n                    {s.job?.error && (\n                      <p className=\"text-xs text-red-400 mt-1 truncate\">\n                        Error: {s.job.error}\n                      </p>\n                    )}\n                  </div>\n\n                  <div className=\"flex items-center gap-2 ml-4\">\n                    <button\n                      onClick={() => handleSync(s.predictionId)}\n                      disabled={actionLoading === s.predictionId || s.needs.needsOutcome}\n                      title={s.needs.needsOutcome ? 'Set outcome first (use Details  Set Outcome)' : 'Sync settlement'}\n                      className={`px-3 py-1.5 rounded-lg text-sm flex items-center gap-1 ${\n                        s.needs.needsOutcome\n                          ? 'bg-slate-700 text-slate-500 cursor-not-allowed'\n                          : 'bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50'\n                      }`}\n                    >\n                      {actionLoading === s.predictionId ? (\n                        <Loader2 className=\"w-3 h-3 animate-spin\" />\n                      ) : (\n                        <RefreshCw className=\"w-3 h-3\" />\n                      )}\n                      Sync\n                    </button>\n\n                    {s.needs.needsOnchainFinalize && (\n                      <button\n                        onClick={() => handleFinalize(s.predictionId)}\n                        disabled={actionLoading === s.predictionId}\n                        className=\"px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 disabled:opacity-50 flex items-center gap-1\"\n                      >\n                        Finalize\n                      </button>\n                    )}\n\n                    <button\n                      onClick={() => navigate(`/admin/predictions/${s.predictionId}`)}\n                      className=\"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600 flex items-center gap-1\"\n                    >\n                      Details\n                      <ArrowRight className=\"w-3 h-3\" />\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SettlementsPage;\n\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  BarChart3,\n  ArrowLeft,\n  Loader2,\n  User,\n  DollarSign,\n  Users,\n  Clock,\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  RefreshCw,\n  Play,\n  ExternalLink,\n  Copy,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet, adminPost } from '@/lib/adminApi';\n\ninterface SettlementDetail {\n  prediction: {\n    id: string;\n    title: string;\n    description: string;\n    status: string;\n    createdAt: string;\n    endDate: string;\n    resolutionDate: string | null;\n    winningOptionId: string | null;\n    platformFee: number;\n    creatorFee: number;\n  };\n  creator: {\n    id: string;\n    username: string | null;\n    fullName: string | null;\n    email: string | null;\n  } | null;\n  options: Array<{\n    id: string;\n    text: string;\n    odds: number;\n    probability: number;\n  }>;\n  entryStats: {\n    total: number;\n    totalStake: number;\n    byOption: Record<string, { count: number; stake: number }>;\n    byProvider: Record<string, { count: number; stake: number }>;\n  };\n  job: {\n    id: string;\n    status: string;\n    tx_hash: string | null;\n    error: string | null;\n    created_at: string;\n    updated_at: string;\n  } | null;\n  settlement: any;\n  payouts: Array<{\n    id: string;\n    user_id: string;\n    amount: number;\n    status: string;\n    created_at: string;\n    channel: string;\n    provider: string;\n  }>;\n}\n\nexport const SettlementDetailPage: React.FC = () => {\n  const { predictionId } = useParams<{ predictionId: string }>();\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [data, setData] = useState<SettlementDetail | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState(false);\n  const [showTriggerModal, setShowTriggerModal] = useState(false);\n  const [selectedWinningOption, setSelectedWinningOption] = useState<string>('');\n\n  const fetchData = useCallback(async () => {\n    if (!predictionId) return;\n    setLoading(true);\n    try {\n      if (!actorId) throw new Error('Missing user');\n      const json = await adminGet<any>(`/api/v2/admin/settlements/${predictionId}`, actorId);\n      setData(json);\n    } catch (e) {\n      console.error('[SettlementDetail] Fetch error:', e);\n      toast.error('Failed to load settlement');\n    } finally {\n      setLoading(false);\n    }\n  }, [predictionId, actorId]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const handleTrigger = async () => {\n    if (!predictionId || !actorId || !selectedWinningOption) return;\n    setActionLoading(true);\n    try {\n      await adminPost<any>(`/api/v2/admin/settlements/${predictionId}/trigger`, actorId, {\n        winningOptionId: selectedWinningOption,\n      });\n      toast.success('Settlement triggered');\n      setShowTriggerModal(false);\n      fetchData();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to trigger settlement');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleRetry = async () => {\n    if (!predictionId || !actorId) return;\n    setActionLoading(true);\n    try {\n      await adminPost<any>(`/api/v2/admin/settlements/${predictionId}/retry`, actorId, {});\n      toast.success('Settlement retry queued');\n      fetchData();\n    } catch (e) {\n      toast.error('Failed to retry settlement');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const copyToClipboard = (text: string) => {\n    navigator.clipboard.writeText(text);\n    toast.success('Copied to clipboard');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  if (!data) {\n    return (\n      <div className=\"text-center py-20\">\n        <AlertTriangle className=\"w-12 h-12 text-amber-500 mx-auto mb-3\" />\n        <p className=\"text-white font-medium\">Settlement not found</p>\n      </div>\n    );\n  }\n\n  const { prediction, creator, options, entryStats, job, payouts } = data;\n  const isPending = prediction.status === 'active' && new Date(prediction.endDate) < new Date();\n  const canTrigger = isPending && !prediction.winningOptionId;\n  const canRetry = job?.status === 'failed';\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back Button */}\n      <button\n        onClick={() => navigate('/admin/settlements')}\n        className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors\"\n      >\n        <ArrowLeft className=\"w-4 h-4\" />\n        Back to Settlements\n      </button>\n\n      {/* Header */}\n      <div className=\"flex items-start justify-between gap-4 flex-wrap\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n            <BarChart3 className=\"w-7 h-7 text-emerald-500\" />\n            {prediction.title}\n          </h1>\n          <p className=\"text-slate-400 mt-1 font-mono text-sm\">{prediction.id}</p>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          {/* Status Badge */}\n          <div className={`px-3 py-1.5 rounded-full text-sm font-medium ${\n            prediction.status === 'active' ? 'bg-emerald-600/20 text-emerald-400' :\n            prediction.status === 'settled' ? 'bg-blue-600/20 text-blue-400' :\n            'bg-slate-600/20 text-slate-400'\n          }`}>\n            {prediction.status}\n          </div>\n\n          {/* Job Status Badge */}\n          {job && (\n            <div className={`px-3 py-1.5 rounded-full text-sm font-medium flex items-center gap-1 ${\n              job.status === 'queued' ? 'bg-amber-600/20 text-amber-400' :\n              job.status === 'running' ? 'bg-blue-600/20 text-blue-400' :\n              job.status === 'finalized' ? 'bg-emerald-600/20 text-emerald-400' :\n              'bg-red-600/20 text-red-400'\n            }`}>\n              {job.status === 'running' && <RefreshCw className=\"w-3 h-3 animate-spin\" />}\n              Job: {job.status}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <DollarSign className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Stake</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">${entryStats.totalStake.toFixed(2)}</p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Users className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Total Entries</span>\n          </div>\n          <p className=\"text-2xl font-bold text-white\">{entryStats.total}</p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <Clock className=\"w-4 h-4\" />\n            <span className=\"text-sm\">End Date</span>\n          </div>\n          <p className=\"text-lg font-medium text-white\">\n            {new Date(prediction.endDate).toLocaleDateString()}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 text-slate-400 mb-2\">\n            <span className=\"text-sm\">Fees</span>\n          </div>\n          <p className=\"text-lg font-medium text-white\">\n            Platform: {prediction.platformFee}%  Creator: {prediction.creatorFee}%\n          </p>\n        </div>\n      </div>\n\n      {/* Options with Stakes */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-4 py-3 border-b border-slate-700\">\n          <h2 className=\"text-white font-semibold\">Options & Stakes</h2>\n        </div>\n        <div className=\"divide-y divide-slate-700\">\n          {options.map((opt) => {\n            const stats = entryStats.byOption[opt.id] || { count: 0, stake: 0 };\n            const isWinner = prediction.winningOptionId === opt.id;\n            return (\n              <div\n                key={opt.id}\n                className={`px-4 py-3 flex items-center justify-between ${\n                  isWinner ? 'bg-emerald-600/10 border-l-4 border-emerald-500' : ''\n                }`}\n              >\n                <div className=\"flex items-center gap-3\">\n                  {isWinner && <CheckCircle className=\"w-5 h-5 text-emerald-400\" />}\n                  <div>\n                    <p className=\"text-white font-medium\">{opt.text}</p>\n                    <p className=\"text-sm text-slate-400\">\n                      {stats.count} entries  Odds: {opt.odds?.toFixed(2) || 'N/A'}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-white font-medium\">${stats.stake.toFixed(2)}</p>\n                  <p className=\"text-sm text-slate-400\">\n                    {entryStats.totalStake > 0 \n                      ? ((stats.stake / entryStats.totalStake) * 100).toFixed(1) \n                      : 0}%\n                  </p>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Stakes by Provider */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n        <h3 className=\"text-white font-semibold mb-3\">Stakes by Provider</h3>\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          {Object.entries(entryStats.byProvider).map(([provider, stats]) => (\n            <div key={provider} className=\"bg-slate-900 rounded-lg p-3\">\n              <p className={`text-xs font-medium uppercase ${\n                provider === 'demo-wallet' ? 'text-purple-400' : 'text-blue-400'\n              }`}>\n                {provider === 'demo-wallet' ? 'Demo' : provider}\n              </p>\n              <p className=\"text-white font-bold text-lg mt-1\">${stats.stake.toFixed(2)}</p>\n              <p className=\"text-slate-400 text-sm\">{stats.count} entries</p>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Job Details */}\n      {job && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n          <h3 className=\"text-white font-semibold mb-3\">Settlement Job</h3>\n          <div className=\"space-y-3\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-slate-400\">Status</span>\n              <span className={`font-medium ${\n                job.status === 'finalized' ? 'text-emerald-400' :\n                job.status === 'failed' ? 'text-red-400' :\n                'text-amber-400'\n              }`}>\n                {job.status}\n              </span>\n            </div>\n            {job.tx_hash && (\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-slate-400\">Transaction</span>\n                <button\n                  onClick={() => copyToClipboard(job.tx_hash!)}\n                  className=\"text-blue-400 font-mono text-sm flex items-center gap-1 hover:text-blue-300\"\n                >\n                  {job.tx_hash.slice(0, 10)}...{job.tx_hash.slice(-8)}\n                  <Copy className=\"w-3 h-3\" />\n                </button>\n              </div>\n            )}\n            {job.error && (\n              <div>\n                <span className=\"text-slate-400 text-sm\">Error</span>\n                <p className=\"text-red-400 text-sm mt-1 bg-red-600/10 rounded p-2\">\n                  {job.error}\n                </p>\n              </div>\n            )}\n            <div className=\"flex justify-between text-sm\">\n              <span className=\"text-slate-400\">Created</span>\n              <span className=\"text-slate-300\">{new Date(job.created_at).toLocaleString()}</span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Payouts */}\n      {payouts.length > 0 && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n          <div className=\"px-4 py-3 border-b border-slate-700\">\n            <h2 className=\"text-white font-semibold\">Payouts ({payouts.length})</h2>\n          </div>\n          <div className=\"divide-y divide-slate-700 max-h-[300px] overflow-y-auto\">\n            {payouts.map((p) => (\n              <div key={p.id} className=\"px-4 py-2 flex items-center justify-between text-sm\">\n                <div>\n                  <span className=\"text-white font-mono text-xs\">\n                    {p.user_id.slice(0, 8)}...\n                  </span>\n                  <span className={`ml-2 px-1.5 py-0.5 rounded text-xs ${\n                    p.channel === 'payout' ? 'bg-emerald-600/20 text-emerald-400' :\n                    p.channel === 'creator_fee' ? 'bg-blue-600/20 text-blue-400' :\n                    'bg-purple-600/20 text-purple-400'\n                  }`}>\n                    {p.channel}\n                  </span>\n                </div>\n                <div className=\"text-right\">\n                  <span className=\"text-white font-medium\">${Number(p.amount).toFixed(2)}</span>\n                  <span className={`ml-2 text-xs ${\n                    p.status === 'completed' ? 'text-emerald-400' : 'text-amber-400'\n                  }`}>\n                    {p.status}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Admin Actions */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-4\">\n        <h3 className=\"text-white font-semibold mb-4\">Admin Actions</h3>\n        <div className=\"flex flex-wrap gap-3\">\n          {canTrigger && (\n            <button\n              onClick={() => setShowTriggerModal(true)}\n              disabled={actionLoading}\n              className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 flex items-center gap-2\"\n            >\n              <Play className=\"w-4 h-4\" />\n              Trigger Settlement\n            </button>\n          )}\n\n          {canRetry && (\n            <button\n              onClick={handleRetry}\n              disabled={actionLoading}\n              className=\"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:opacity-50 flex items-center gap-2\"\n            >\n              {actionLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <RefreshCw className=\"w-4 h-4\" />}\n              Retry Settlement\n            </button>\n          )}\n\n          <button\n            onClick={() => navigate(`/admin/predictions/${prediction.id}`)}\n            className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 flex items-center gap-2\"\n          >\n            View Prediction\n            <ExternalLink className=\"w-4 h-4\" />\n          </button>\n\n          {creator && (\n            <button\n              onClick={() => navigate(`/admin/users/${creator.id}`)}\n              className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 flex items-center gap-2\"\n            >\n              <User className=\"w-4 h-4\" />\n              View Creator\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Trigger Modal */}\n      {showTriggerModal && (\n        <div className=\"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700\">\n            <h3 className=\"text-xl font-bold text-white mb-4\">Trigger Settlement</h3>\n            <p className=\"text-slate-400 mb-4\">\n              Select the winning option to settle this prediction.\n            </p>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Winning Option\n            </label>\n            <select\n              value={selectedWinningOption}\n              onChange={(e) => setSelectedWinningOption(e.target.value)}\n              className=\"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n            >\n              <option value=\"\">Select option...</option>\n              {options.map((opt) => (\n                <option key={opt.id} value={opt.id}>\n                  {opt.text}\n                </option>\n              ))}\n            </select>\n            <div className=\"flex justify-end gap-3 mt-6\">\n              <button\n                onClick={() => { setShowTriggerModal(false); setSelectedWinningOption(''); }}\n                className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleTrigger}\n                disabled={!selectedWinningOption || actionLoading}\n                className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n              >\n                {actionLoading && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                Trigger Settlement\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SettlementDetailPage;\n\n","import React, { useState, useCallback} from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  HeadphonesIcon,\n  Search,\n  Loader2,\n  User,\n  Target,\n  Receipt,\n  ArrowRight,\n  Clock,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet } from '@/lib/adminApi';\n\ninterface SearchResults {\n  users: Array<{ id: string; username: string | null; full_name: string | null; email: string | null }>;\n  predictions: Array<{ id: string; title: string; status: string; created_at: string }>;\n  transactions: Array<{ id: string; user_id: string; amount: number; channel: string; tx_hash: string }>;\n}\n\nexport const SupportPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [query, setQuery] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [results, setResults] = useState<SearchResults | null>(null);\n  const [searched, setSearched] = useState(false);\n\n  const handleSearch = useCallback(async () => {\n    if (!query.trim() || query.length < 2) {\n      toast.error('Query must be at least 2 characters');\n      return;\n    }\n    if (!actorId) return;\n\n    setLoading(true);\n    setSearched(true);\n    try {\n      const data = await adminGet<any>(`/api/v2/admin/support/search`, actorId, { q: query.trim() });\n      setResults(data.results);\n    } catch (e) {\n      console.error('[SupportPage] Search error:', e);\n      toast.error('Search failed');\n      setResults(null);\n    } finally {\n      setLoading(false);\n    }\n  }, [query, actorId]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handleSearch();\n    }\n  };\n\n  const totalResults = results \n    ? results.users.length + results.predictions.length + results.transactions.length \n    : 0;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <HeadphonesIcon className=\"w-7 h-7 text-emerald-500\" />\n          Support Center\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Search users, predictions, and transactions for investigation</p>\n      </div>\n\n      {/* Search */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-6\">\n        <h3 className=\"text-white font-semibold mb-4\">Global Search</h3>\n        <div className=\"flex gap-3\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400\" />\n            <input\n              type=\"text\"\n              value={query}\n              onChange={(e) => setQuery(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder=\"Search by user ID, email, username, prediction ID, tx hash...\"\n              className=\"w-full pl-10 pr-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\n            />\n          </div>\n          <button\n            onClick={handleSearch}\n            disabled={loading || query.length < 2}\n            className=\"px-6 py-3 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n          >\n            {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : <Search className=\"w-5 h-5\" />}\n            Search\n          </button>\n        </div>\n        <p className=\"text-slate-500 text-sm mt-2\">\n          Tip: You can search by UUID, email address, username, prediction title, or transaction hash (0x...)\n        </p>\n      </div>\n\n      {/* Results */}\n      {searched && (\n        <div className=\"space-y-4\">\n          {loading ? (\n            <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-12 text-center\">\n              <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto\" />\n              <p className=\"text-slate-400 mt-3\">Searching...</p>\n            </div>\n          ) : totalResults === 0 ? (\n            <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-12 text-center\">\n              <Search className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n              <p className=\"text-white font-medium\">No results found</p>\n              <p className=\"text-slate-400 text-sm mt-1\">Try a different search term</p>\n            </div>\n          ) : (\n            <>\n              <p className=\"text-slate-400 text-sm\">{totalResults} result{totalResults !== 1 ? 's' : ''} found</p>\n\n              {/* Users */}\n              {results?.users && results.users.length > 0 && (\n                <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n                  <div className=\"px-4 py-3 border-b border-slate-700 flex items-center gap-2\">\n                    <User className=\"w-4 h-4 text-blue-400\" />\n                    <h3 className=\"text-white font-semibold\">Users ({results.users.length})</h3>\n                  </div>\n                  <div className=\"divide-y divide-slate-700\">\n                    {results.users.map((user) => (\n                      <button\n                        key={user.id}\n                        onClick={() => navigate(`/admin/users/${user.id}`)}\n                        className=\"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between\"\n                      >\n                        <div>\n                          <p className=\"text-white font-medium\">\n                            {user.full_name || user.username || 'Unknown'}\n                          </p>\n                          <p className=\"text-sm text-slate-400\">{user.email || user.id}</p>\n                        </div>\n                        <ArrowRight className=\"w-4 h-4 text-slate-400\" />\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Predictions */}\n              {results?.predictions && results.predictions.length > 0 && (\n                <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n                  <div className=\"px-4 py-3 border-b border-slate-700 flex items-center gap-2\">\n                    <Target className=\"w-4 h-4 text-emerald-400\" />\n                    <h3 className=\"text-white font-semibold\">Predictions ({results.predictions.length})</h3>\n                  </div>\n                  <div className=\"divide-y divide-slate-700\">\n                    {results.predictions.map((pred) => (\n                      <button\n                        key={pred.id}\n                        onClick={() => navigate(`/admin/predictions/${pred.id}`)}\n                        className=\"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between\"\n                      >\n                        <div>\n                          <p className=\"text-white font-medium\">{pred.title}</p>\n                          <p className=\"text-sm text-slate-400 flex items-center gap-2\">\n                            <span className={`px-1.5 py-0.5 rounded text-xs ${\n                              pred.status === 'active' ? 'bg-emerald-600/20 text-emerald-400' :\n                              pred.status === 'settled' ? 'bg-blue-600/20 text-blue-400' :\n                              'bg-slate-600/20 text-slate-400'\n                            }`}>\n                              {pred.status}\n                            </span>\n                            <span className=\"flex items-center gap-1\">\n                              <Clock className=\"w-3 h-3\" />\n                              {new Date(pred.created_at).toLocaleDateString()}\n                            </span>\n                          </p>\n                        </div>\n                        <ArrowRight className=\"w-4 h-4 text-slate-400\" />\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Transactions */}\n              {results?.transactions && results.transactions.length > 0 && (\n                <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n                  <div className=\"px-4 py-3 border-b border-slate-700 flex items-center gap-2\">\n                    <Receipt className=\"w-4 h-4 text-purple-400\" />\n                    <h3 className=\"text-white font-semibold\">Transactions ({results.transactions.length})</h3>\n                  </div>\n                  <div className=\"divide-y divide-slate-700\">\n                    {results.transactions.map((tx) => (\n                      <button\n                        key={tx.id}\n                        onClick={() => navigate(`/admin/wallets/${tx.user_id}`)}\n                        className=\"w-full px-4 py-3 hover:bg-slate-700/50 transition-colors text-left flex items-center justify-between\"\n                      >\n                        <div>\n                          <p className=\"text-white font-medium\">\n                            ${Number(tx.amount).toFixed(2)} - {tx.channel}\n                          </p>\n                          <p className=\"text-sm text-slate-400 font-mono\">\n                            {tx.tx_hash?.slice(0, 20)}...\n                          </p>\n                        </div>\n                        <ArrowRight className=\"w-4 h-4 text-slate-400\" />\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      )}\n\n      {/* Quick Links */}\n      {!searched && (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          <button\n            onClick={() => navigate('/admin/users')}\n            className=\"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:bg-slate-700/50 transition-colors text-left\"\n          >\n            <User className=\"w-8 h-8 text-blue-400 mb-3\" />\n            <h3 className=\"text-white font-semibold\">User Management</h3>\n            <p className=\"text-slate-400 text-sm mt-1\">Search and manage user accounts</p>\n          </button>\n\n          <button\n            onClick={() => navigate('/admin/settlements')}\n            className=\"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:bg-slate-700/50 transition-colors text-left\"\n          >\n            <Target className=\"w-8 h-8 text-emerald-400 mb-3\" />\n            <h3 className=\"text-white font-semibold\">Settlements</h3>\n            <p className=\"text-slate-400 text-sm mt-1\">View and manage prediction settlements</p>\n          </button>\n\n          <button\n            onClick={() => navigate('/admin/wallets')}\n            className=\"bg-slate-800 border border-slate-700 rounded-xl p-6 hover:bg-slate-700/50 transition-colors text-left\"\n          >\n            <Receipt className=\"w-8 h-8 text-purple-400 mb-3\" />\n            <h3 className=\"text-white font-semibold\">Wallets</h3>\n            <p className=\"text-slate-400 text-sm mt-1\">Investigate wallet transactions</p>\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SupportPage;\n\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Shield,\n  Search,\n  Loader2,\n  User,\n  Ban,\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  Flag,\n  BadgeCheck,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet, adminPost } from '@/lib/adminApi';\n\ninterface Creator {\n  id: string;\n  username: string | null;\n  fullName: string | null;\n  email: string | null;\n  avatarUrl: string | null;\n  createdAt: string;\n  isBanned: boolean;\n  banReason: string | null;\n  isVerified: boolean;\n  predictionCount: number;\n}\n\ntype TabType = 'creators' | 'reports';\n\nexport const ModerationPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [activeTab, setActiveTab] = useState<TabType>('creators');\n  const [creators, setCreators] = useState<Creator[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [actionLoading, setActionLoading] = useState<string | null>(null);\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Ban modal state\n  const [showBanModal, setShowBanModal] = useState(false);\n  const [banTarget, setBanTarget] = useState<Creator | null>(null);\n  const [banReason, setBanReason] = useState('');\n\n  const fetchCreators = useCallback(async () => {\n    setLoading(true);\n    try {\n      if (!actorId) throw new Error('Missing user');\n      const data = await adminGet<any>(`/api/v2/admin/moderation/creators`, actorId, { limit: 100 });\n      setCreators(data.items || []);\n    } catch (e) {\n      console.error('[ModerationPage] Fetch error:', e);\n      toast.error('Failed to load creators');\n    } finally {\n      setLoading(false);\n    }\n  }, [actorId]);\n\n  useEffect(() => {\n    if (activeTab === 'creators') {\n      fetchCreators();\n    }\n  }, [activeTab, fetchCreators]);\n\n  const handleBan = async () => {\n    if (!banTarget || !actorId || banReason.length < 5) return;\n    setActionLoading(banTarget.id);\n    try {\n      const json = await adminPost<any>(`/api/v2/admin/moderation/users/${banTarget.id}/ban`, actorId, { reason: banReason });\n      toast.success('User banned successfully');\n      setShowBanModal(false);\n      setBanTarget(null);\n      setBanReason('');\n      fetchCreators();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to ban user');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleUnban = async (userId: string) => {\n    if (!actorId) return;\n    setActionLoading(userId);\n    try {\n      await adminPost<any>(`/api/v2/admin/moderation/users/${userId}/unban`, actorId, {});\n      toast.success('User unbanned successfully');\n      fetchCreators();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to unban user');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleVerify = async (userId: string) => {\n    if (!actorId) return;\n    setActionLoading(userId);\n    try {\n      await adminPost<any>(`/api/v2/admin/moderation/users/${userId}/verify`, actorId, {});\n      toast.success('User verified successfully');\n      fetchCreators();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to verify user');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleUnverify = async (userId: string) => {\n    if (!actorId) return;\n    setActionLoading(userId);\n    try {\n      await adminPost<any>(`/api/v2/admin/moderation/users/${userId}/unverify`, actorId, {});\n      toast.success('Verification removed');\n      fetchCreators();\n    } catch (e: any) {\n      toast.error(e.message || 'Failed to remove verification');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  // (legacy duplicate) handled above via adminPost + actorId enforcement\n\n  const filteredCreators = searchQuery\n    ? creators.filter(c =>\n        c.username?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        c.fullName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        c.email?.toLowerCase().includes(searchQuery.toLowerCase())\n      )\n    : creators;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <Shield className=\"w-7 h-7 text-emerald-500\" />\n          Moderation\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Manage creators, bans, and content reports</p>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-2\">\n        <button\n          onClick={() => setActiveTab('creators')}\n          className={`px-4 py-2 rounded-lg font-medium transition-colors ${\n            activeTab === 'creators'\n              ? 'bg-emerald-600 text-white'\n              : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n          }`}\n        >\n          <User className=\"w-4 h-4 inline mr-2\" />\n          Creators\n        </button>\n        <button\n          onClick={() => setActiveTab('reports')}\n          className={`px-4 py-2 rounded-lg font-medium transition-colors ${\n            activeTab === 'reports'\n              ? 'bg-emerald-600 text-white'\n              : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n          }`}\n        >\n          <Flag className=\"w-4 h-4 inline mr-2\" />\n          Reports\n        </button>\n      </div>\n\n      {activeTab === 'creators' && (\n        <>\n          {/* Search */}\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400\" />\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              placeholder=\"Filter by username, name, or email...\"\n              className=\"w-full pl-10 pr-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\n            />\n          </div>\n\n          {/* Creators List */}\n          <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n            {loading ? (\n              <div className=\"p-12 text-center\">\n                <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin mx-auto\" />\n                <p className=\"text-slate-400 mt-3\">Loading creators...</p>\n              </div>\n            ) : filteredCreators.length === 0 ? (\n              <div className=\"p-12 text-center\">\n                <User className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n                <p className=\"text-white font-medium\">No creators found</p>\n              </div>\n            ) : (\n              <div className=\"divide-y divide-slate-700\">\n                {filteredCreators.map((creator) => (\n                  <div\n                    key={creator.id}\n                    className={`px-4 py-3 flex items-center justify-between ${\n                      creator.isBanned ? 'bg-red-900/10' : ''\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden\">\n                        {creator.avatarUrl ? (\n                          <img src={creator.avatarUrl} alt=\"\" className=\"w-full h-full object-cover\" />\n                        ) : (\n                          <User className=\"w-5 h-5 text-slate-400\" />\n                        )}\n                      </div>\n                      <div>\n                        <div className=\"flex items-center gap-2\">\n                          <p className=\"text-white font-medium\">\n                            {creator.fullName || creator.username || 'Unknown'}\n                          </p>\n                          {creator.isVerified && (\n                            <BadgeCheck className=\"w-4 h-4 text-blue-400\" aria-label=\"Verified\" />\n                          )}\n                          {creator.isBanned && (\n                            <span className=\"px-2 py-0.5 bg-red-600/20 text-red-400 text-xs rounded-full\">\n                              Banned\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-slate-400\">\n                          {creator.email}  {creator.predictionCount} predictions\n                        </p>\n                        {creator.isBanned && creator.banReason && (\n                          <p className=\"text-xs text-red-400 mt-0.5\">\n                            Reason: {creator.banReason}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-2\">\n                      {/* View Profile */}\n                      <button\n                        onClick={() => navigate(`/admin/users/${creator.id}`)}\n                        className=\"px-3 py-1.5 bg-slate-700 text-white rounded-lg text-sm hover:bg-slate-600\"\n                      >\n                        View\n                      </button>\n\n                      {/* Verify/Unverify */}\n                      {creator.isVerified ? (\n                        <button\n                          onClick={() => handleUnverify(creator.id)}\n                          disabled={actionLoading === creator.id}\n                          className=\"px-3 py-1.5 bg-slate-600 text-white rounded-lg text-sm hover:bg-slate-500 disabled:opacity-50 flex items-center gap-1\"\n                        >\n                          {actionLoading === creator.id ? (\n                            <Loader2 className=\"w-3 h-3 animate-spin\" />\n                          ) : (\n                            <XCircle className=\"w-3 h-3\" />\n                          )}\n                          Unverify\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => handleVerify(creator.id)}\n                          disabled={actionLoading === creator.id}\n                          className=\"px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50 flex items-center gap-1\"\n                        >\n                          {actionLoading === creator.id ? (\n                            <Loader2 className=\"w-3 h-3 animate-spin\" />\n                          ) : (\n                            <BadgeCheck className=\"w-3 h-3\" />\n                          )}\n                          Verify\n                        </button>\n                      )}\n\n                      {/* Ban/Unban */}\n                      {creator.isBanned ? (\n                        <button\n                          onClick={() => handleUnban(creator.id)}\n                          disabled={actionLoading === creator.id}\n                          className=\"px-3 py-1.5 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700 disabled:opacity-50 flex items-center gap-1\"\n                        >\n                          {actionLoading === creator.id ? (\n                            <Loader2 className=\"w-3 h-3 animate-spin\" />\n                          ) : (\n                            <CheckCircle className=\"w-3 h-3\" />\n                          )}\n                          Unban\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => { setBanTarget(creator); setShowBanModal(true); }}\n                          disabled={actionLoading === creator.id}\n                          className=\"px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 disabled:opacity-50 flex items-center gap-1\"\n                        >\n                          <Ban className=\"w-3 h-3\" />\n                          Ban\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </>\n      )}\n\n      {activeTab === 'reports' && (\n        <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-8 text-center\">\n          <Flag className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n          <p className=\"text-white font-medium\">Content Reports</p>\n          <p className=\"text-slate-400 text-sm mt-1\">\n            No reports pending. Reports from users will appear here.\n          </p>\n        </div>\n      )}\n\n      {/* Ban Modal */}\n      {showBanModal && banTarget && (\n        <div className=\"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-slate-800 rounded-xl max-w-md w-full p-6 border border-slate-700\">\n            <h3 className=\"text-xl font-bold text-white mb-4\">Ban User</h3>\n            <p className=\"text-slate-400 mb-4\">\n              Ban <strong className=\"text-white\">{banTarget.fullName || banTarget.username}</strong>?\n              They will be unable to access the platform.\n            </p>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Reason (required)\n            </label>\n            <textarea\n              value={banReason}\n              onChange={(e) => setBanReason(e.target.value)}\n              placeholder=\"Explain why this user is being banned...\"\n              className=\"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-red-500 h-24 resize-none\"\n            />\n            <div className=\"flex justify-end gap-3 mt-4\">\n              <button\n                onClick={() => { setShowBanModal(false); setBanTarget(null); setBanReason(''); }}\n                className=\"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleBan}\n                disabled={banReason.length < 5 || actionLoading === banTarget.id}\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n              >\n                {actionLoading === banTarget.id && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                Ban User\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ModerationPage;\n\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Settings,\n  Loader2,\n  Save,\n  AlertTriangle,\n  Power,\n  ToggleLeft,\n  ToggleRight,\n  DollarSign,\n  Percent,\n  Wrench,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet, adminPost, adminPut } from '@/lib/adminApi';\n\ninterface FeatureFlags {\n  crypto_deposits: boolean;\n  demo_wallet: boolean;\n  referrals: boolean;\n  comments: boolean;\n  [key: string]: boolean;\n}\n\ninterface ConfigData {\n  maintenance_mode: boolean;\n  maintenance_message: string;\n  feature_flags: FeatureFlags;\n  platform_fee_percentage: number;\n  creator_fee_percentage: number;\n  min_bet_amount: number;\n  max_bet_amount: number;\n  default_demo_balance: number;\n}\n\nconst defaultConfig: ConfigData = {\n  maintenance_mode: false,\n  maintenance_message: 'The platform is currently under maintenance. Please check back soon.',\n  feature_flags: {\n    crypto_deposits: true,\n    demo_wallet: true,\n    referrals: true,\n    comments: true,\n  },\n  platform_fee_percentage: 2.5,\n  creator_fee_percentage: 1.0,\n  min_bet_amount: 1,\n  max_bet_amount: 10000,\n  default_demo_balance: 1000,\n};\n\nexport const ConfigPage: React.FC = () => {\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [config, setConfig] = useState<ConfigData>(defaultConfig);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [maintenanceMessage, setMaintenanceMessage] = useState('');\n\n  const fetchConfig = useCallback(async () => {\n    setLoading(true);\n    try {\n      const data = await adminGet<any>(`/api/v2/admin/config`, actorId || '');\n      setConfig({ ...defaultConfig, ...data.config });\n      setMaintenanceMessage(data.config?.maintenance_message || defaultConfig.maintenance_message);\n    } catch (e) {\n      console.error('[ConfigPage] Fetch error:', e);\n      // Use defaults on error\n    } finally {\n      setLoading(false);\n    }\n  }, [actorId]);\n\n  useEffect(() => {\n    fetchConfig();\n  }, [fetchConfig]);\n\n  const handleToggleMaintenance = async () => {\n    setSaving(true);\n    try {\n      const newValue = !config.maintenance_mode;\n      await adminPost<any>(`/api/v2/admin/config/maintenance`, actorId || '', {\n        enabled: newValue,\n        message: maintenanceMessage,\n      });\n      setConfig(prev => ({ ...prev, maintenance_mode: newValue }));\n      toast.success(newValue ? 'Maintenance mode enabled' : 'Maintenance mode disabled');\n      // Refresh config to ensure UI is in sync\n      setTimeout(() => fetchConfig(), 500);\n    } catch (e: any) {\n      console.error('[ConfigPage] Maintenance toggle error:', e);\n      toast.error(e?.message || 'Failed to toggle maintenance mode');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleToggleFeature = async (feature: string) => {\n    setSaving(true);\n    try {\n      const newFlags = {\n        ...config.feature_flags,\n        [feature]: !config.feature_flags[feature],\n      };\n      await adminPost<any>(`/api/v2/admin/config/feature-flags`, actorId || '', {\n        flags: { [feature]: newFlags[feature] },\n      });\n      setConfig(prev => ({ ...prev, feature_flags: newFlags }));\n      toast.success(`${feature.replace(/_/g, ' ')} ${newFlags[feature] ? 'enabled' : 'disabled'}`);\n    } catch (e: any) {\n      console.error('[ConfigPage] Feature flag toggle error:', e);\n      toast.error(e?.message || 'Failed to update feature flag');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleSaveConfig = async (key: string, value: any) => {\n    setSaving(true);\n    try {\n      await adminPut<any>(`/api/v2/admin/config/${key}`, actorId || '', { value });\n      setConfig(prev => ({ ...prev, [key]: value }));\n      toast.success('Config saved');\n    } catch (e: any) {\n      console.error('[ConfigPage] Save config error:', e);\n      toast.error(e?.message || 'Failed to save config');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n          <Settings className=\"w-7 h-7 text-emerald-500\" />\n          App Configuration\n        </h1>\n        <p className=\"text-slate-400 mt-1\">Manage platform settings and feature flags</p>\n      </div>\n\n      {/* Maintenance Mode */}\n      <div className={`rounded-xl p-6 border ${\n        config.maintenance_mode \n          ? 'bg-amber-900/20 border-amber-600' \n          : 'bg-slate-800 border-slate-700'\n      }`}>\n        <div className=\"flex items-start justify-between gap-4\">\n          <div className=\"flex items-start gap-4\">\n            <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${\n              config.maintenance_mode ? 'bg-amber-600/20' : 'bg-slate-700'\n            }`}>\n              <Wrench className={`w-6 h-6 ${config.maintenance_mode ? 'text-amber-400' : 'text-slate-400'}`} />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-bold text-white flex items-center gap-2\">\n                Maintenance Mode\n                {config.maintenance_mode && (\n                  <span className=\"px-2 py-0.5 bg-amber-600 text-white text-xs rounded-full\">\n                    ACTIVE\n                  </span>\n                )}\n              </h2>\n              <p className=\"text-slate-400 mt-1\">\n                When enabled, users will see a maintenance message instead of the app\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={handleToggleMaintenance}\n            disabled={saving}\n            className={`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${\n              config.maintenance_mode\n                ? 'bg-emerald-600 text-white hover:bg-emerald-700'\n                : 'bg-amber-600 text-white hover:bg-amber-700'\n            } disabled:opacity-50`}\n          >\n            {saving ? (\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\n            ) : (\n              <Power className=\"w-4 h-4\" />\n            )}\n            {config.maintenance_mode ? 'Disable' : 'Enable'}\n          </button>\n        </div>\n\n        <div className=\"mt-4\">\n          <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n            Maintenance Message\n          </label>\n          <textarea\n            value={maintenanceMessage}\n            onChange={(e) => setMaintenanceMessage(e.target.value)}\n            className=\"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 h-20 resize-none\"\n          />\n        </div>\n      </div>\n\n      {/* Feature Flags */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-6 py-4 border-b border-slate-700\">\n          <h2 className=\"text-lg font-semibold text-white\">Feature Flags</h2>\n          <p className=\"text-sm text-slate-400\">Enable or disable platform features</p>\n        </div>\n        <div className=\"divide-y divide-slate-700\">\n          {Object.entries(config.feature_flags).map(([key, enabled]) => (\n            <div key={key} className=\"px-6 py-4 flex items-center justify-between\">\n              <div>\n                <p className=\"text-white font-medium capitalize\">{key.replace(/_/g, ' ')}</p>\n                <p className=\"text-sm text-slate-400\">\n                  {key === 'crypto_deposits' && 'Allow users to deposit crypto to their wallet'}\n                  {key === 'demo_wallet' && 'Enable demo wallet for testing'}\n                  {key === 'referrals' && 'Enable referral program'}\n                  {key === 'comments' && 'Allow comments on predictions'}\n                </p>\n              </div>\n              <button\n                onClick={() => handleToggleFeature(key)}\n                disabled={saving}\n                className=\"relative\"\n              >\n                {enabled ? (\n                  <ToggleRight className=\"w-10 h-10 text-emerald-500\" />\n                ) : (\n                  <ToggleLeft className=\"w-10 h-10 text-slate-500\" />\n                )}\n              </button>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Fee Configuration */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-6 py-4 border-b border-slate-700\">\n          <h2 className=\"text-lg font-semibold text-white flex items-center gap-2\">\n            <Percent className=\"w-5 h-5 text-emerald-500\" />\n            Fee Configuration\n          </h2>\n        </div>\n        <div className=\"p-6 grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Platform Fee (%)\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                step=\"0.1\"\n                min=\"0\"\n                max=\"10\"\n                value={config.platform_fee_percentage}\n                onChange={(e) => setConfig(prev => ({ ...prev, platform_fee_percentage: Number(e.target.value) }))}\n                className=\"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n              />\n              <button\n                onClick={() => handleSaveConfig('platform_fee_percentage', config.platform_fee_percentage)}\n                disabled={saving}\n                className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Creator Fee (%)\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                step=\"0.1\"\n                min=\"0\"\n                max=\"10\"\n                value={config.creator_fee_percentage}\n                onChange={(e) => setConfig(prev => ({ ...prev, creator_fee_percentage: Number(e.target.value) }))}\n                className=\"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n              />\n              <button\n                onClick={() => handleSaveConfig('creator_fee_percentage', config.creator_fee_percentage)}\n                disabled={saving}\n                className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Bet Limits */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl\">\n        <div className=\"px-6 py-4 border-b border-slate-700\">\n          <h2 className=\"text-lg font-semibold text-white flex items-center gap-2\">\n            <DollarSign className=\"w-5 h-5 text-emerald-500\" />\n            Bet Limits\n          </h2>\n        </div>\n        <div className=\"p-6 grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Min Bet Amount ($)\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={config.min_bet_amount}\n                onChange={(e) => setConfig(prev => ({ ...prev, min_bet_amount: Number(e.target.value) }))}\n                className=\"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n              />\n              <button\n                onClick={() => handleSaveConfig('min_bet_amount', config.min_bet_amount)}\n                disabled={saving}\n                className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Max Bet Amount ($)\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={config.max_bet_amount}\n                onChange={(e) => setConfig(prev => ({ ...prev, max_bet_amount: Number(e.target.value) }))}\n                className=\"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n              />\n              <button\n                onClick={() => handleSaveConfig('max_bet_amount', config.max_bet_amount)}\n                disabled={saving}\n                className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n              Default Demo Balance ($)\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={config.default_demo_balance}\n                onChange={(e) => setConfig(prev => ({ ...prev, default_demo_balance: Number(e.target.value) }))}\n                className=\"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n              />\n              <button\n                onClick={() => handleSaveConfig('default_demo_balance', config.default_demo_balance)}\n                disabled={saving}\n                className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Warning */}\n      <div className=\"flex items-start gap-3 p-4 bg-amber-900/20 border border-amber-600/30 rounded-lg\">\n        <AlertTriangle className=\"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5\" />\n        <div>\n          <p className=\"text-amber-200 font-medium\">Configuration Changes Are Immediate</p>\n          <p className=\"text-amber-200/70 text-sm mt-1\">\n            Changes to these settings take effect immediately across the platform. \n            Use caution when modifying production settings.\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ConfigPage;\n\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { ScrollText, ChevronDown, ChevronUp, RefreshCw, Filter, Search } from 'lucide-react';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport { adminGet } from '@/lib/adminApi';\n\ninterface AuditLogItem {\n  id: string;\n  actorId: string;\n  actorName: string;\n  action: string;\n  targetType: string | null;\n  targetId: string | null;\n  reason: string | null;\n  meta: Record<string, unknown> | null;\n  createdAt: string;\n}\n\nexport const AuditLogPage: React.FC = () => {\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [items, setItems] = useState<AuditLogItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [total, setTotal] = useState(0);\n  const [offset, setOffset] = useState(0);\n  const [expandedId, setExpandedId] = useState<string | null>(null);\n  const [actionFilter, setActionFilter] = useState('');\n  const [actions, setActions] = useState<string[]>([]);\n  const limit = 25;\n\n  const fetchAuditLog = useCallback(async () => {\n    setLoading(true);\n    try {\n      if (!actorId) return;\n      const data = await adminGet<{ items?: AuditLogItem[]; total?: number }>(`/api/v2/admin/audit`, actorId, {\n        limit,\n        offset,\n        action: actionFilter || undefined,\n      });\n      setItems(data.items || []);\n      setTotal(data.total || 0);\n    } catch (e) {\n      console.error('[AuditLog] Fetch error:', e);\n    } finally {\n      setLoading(false);\n    }\n  }, [offset, actionFilter, actorId]);\n\n  const fetchActions = useCallback(async () => {\n    try {\n      if (!actorId) return;\n      const data = await adminGet<{ actions?: string[] }>(`/api/v2/admin/audit/actions`, actorId);\n      setActions(data.actions || []);\n    } catch (e) {\n      console.error('[AuditLog] Failed to fetch actions:', e);\n    }\n  }, [actorId]);\n\n  useEffect(() => {\n    fetchAuditLog();\n  }, [fetchAuditLog]);\n\n  useEffect(() => {\n    fetchActions();\n  }, [fetchActions]);\n\n  const handleRefresh = () => {\n    setOffset(0);\n    fetchAuditLog();\n  };\n\n  const totalPages = Math.ceil(total / limit);\n  const currentPage = Math.floor(offset / limit) + 1;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n            <ScrollText className=\"w-7 h-7 text-emerald-500\" />\n            Audit Log\n          </h1>\n          <p className=\"text-slate-400 mt-1\">Track all admin actions and changes</p>\n        </div>\n        \n        <button\n          onClick={handleRefresh}\n          disabled={loading}\n          className=\"flex items-center gap-2 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 disabled:opacity-50 transition-colors\"\n        >\n          <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />\n          Refresh\n        </button>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex items-center gap-4\">\n        <div className=\"relative flex-1 max-w-xs\">\n          <Filter className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\n          <select\n            value={actionFilter}\n            onChange={(e) => {\n              setActionFilter(e.target.value);\n              setOffset(0);\n            }}\n            className=\"w-full pl-10 pr-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n          >\n            <option value=\"\">All Actions</option>\n            {actions.map((action) => (\n              <option key={action} value={action}>\n                {action}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <span className=\"text-sm text-slate-400\">\n          {total} total entries\n        </span>\n      </div>\n\n      {/* Audit Log Table */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n        {loading && items.length === 0 ? (\n          <div className=\"p-12 text-center\">\n            <div className=\"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto\" />\n            <p className=\"text-slate-400 mt-3\">Loading audit log...</p>\n          </div>\n        ) : items.length === 0 ? (\n          <div className=\"p-12 text-center\">\n            <ScrollText className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\n            <p className=\"text-white font-medium\">No audit entries found</p>\n            <p className=\"text-slate-400 text-sm mt-1\">Admin actions will appear here</p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-slate-700\">\n            {items.map((item) => (\n              <div key={item.id} className=\"hover:bg-slate-700/30 transition-colors\">\n                <button\n                  onClick={() => setExpandedId(expandedId === item.id ? null : item.id)}\n                  className=\"w-full px-4 py-3 text-left\"\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-3\">\n                        <span className=\"px-2 py-0.5 bg-emerald-600/20 text-emerald-400 text-xs font-medium rounded\">\n                          {item.action}\n                        </span>\n                        {item.targetType && (\n                          <span className=\"text-slate-400 text-sm\">\n                            {item.targetType}\n                          </span>\n                        )}\n                      </div>\n                      <div className=\"mt-1 flex items-center gap-2 text-sm\">\n                        <span className=\"text-white\">{item.actorName}</span>\n                        {item.targetId && (\n                          <>\n                            <span className=\"text-slate-500\"></span>\n                            <span className=\"text-slate-400 font-mono text-xs\">\n                              {item.targetId.slice(0, 8)}...\n                            </span>\n                          </>\n                        )}\n                      </div>\n                      {item.reason && (\n                        <p className=\"text-slate-500 text-sm mt-1 truncate\">\n                          Reason: {item.reason}\n                        </p>\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-xs text-slate-500 whitespace-nowrap\">\n                        {new Date(item.createdAt).toLocaleString()}\n                      </span>\n                      {item.meta && Object.keys(item.meta).length > 0 && (\n                        expandedId === item.id ? (\n                          <ChevronUp className=\"w-4 h-4 text-slate-400\" />\n                        ) : (\n                          <ChevronDown className=\"w-4 h-4 text-slate-400\" />\n                        )\n                      )}\n                    </div>\n                  </div>\n                </button>\n                \n                {/* Expanded Meta */}\n                {expandedId === item.id && item.meta && (\n                  <div className=\"px-4 pb-3\">\n                    <div className=\"bg-slate-900 rounded-lg p-3 overflow-x-auto\">\n                      <pre className=\"text-xs text-slate-300 font-mono\">\n                        {JSON.stringify(item.meta, null, 2)}\n                      </pre>\n                    </div>\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* Pagination */}\n        {totalPages > 1 && (\n          <div className=\"px-4 py-3 border-t border-slate-700 flex items-center justify-between\">\n            <button\n              onClick={() => setOffset(Math.max(0, offset - limit))}\n              disabled={offset === 0 || loading}\n              className=\"px-3 py-1.5 text-sm text-slate-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Previous\n            </button>\n            \n            <span className=\"text-sm text-slate-400\">\n              Page {currentPage} of {totalPages}\n            </span>\n            \n            <button\n              onClick={() => setOffset(offset + limit)}\n              disabled={offset + limit >= total || loading}\n              className=\"px-3 py-1.5 text-sm text-slate-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Next\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AuditLogPage;\n\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useAuthStore } from '../../store/authStore';\nimport { useAuthSession } from '../../providers/AuthSessionProvider';\nimport {\n  Tag,\n  Loader2,\n  Plus,\n  ChevronUp,\n  ChevronDown,\n  X,\n  Check,\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { adminGet, adminPost, adminPatch } from '@/lib/adminApi';\nimport * as Dialog from '@radix-ui/react-dialog';\n\ninterface Category {\n  id: string;\n  slug: string;\n  label: string;\n  icon: string | null;\n  sortOrder: number;\n  isEnabled: boolean;\n  createdAt: string;\n}\n\nexport const CategoriesPage: React.FC = () => {\n  const { user } = useAuthStore();\n  const { user: sessionUser } = useAuthSession();\n  const actorId = sessionUser?.id || user?.id || '';\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [newCategory, setNewCategory] = useState({ slug: '', label: '', icon: '' });\n\n  const fetchCategories = useCallback(async () => {\n    setLoading(true);\n    try {\n      const data = await adminGet<{ data: Category[] }>(`/api/v2/admin/categories`, actorId || '');\n      setCategories(data.data || []);\n    } catch (e) {\n      console.error('[CategoriesPage] Fetch error:', e);\n      toast.error('Failed to load categories');\n    } finally {\n      setLoading(false);\n    }\n  }, [actorId]);\n\n  useEffect(() => {\n    fetchCategories();\n  }, [fetchCategories]);\n\n  const handleToggleEnabled = async (categoryId: string, currentValue: boolean) => {\n    setSaving(true);\n    try {\n      await adminPatch<any>(`/api/v2/admin/categories/${categoryId}`, actorId || '', {\n        isEnabled: !currentValue,\n      });\n      setCategories((prev) =>\n        prev.map((cat) => (cat.id === categoryId ? { ...cat, isEnabled: !currentValue } : cat))\n      );\n      toast.success(`Category ${!currentValue ? 'enabled' : 'disabled'}`);\n    } catch (e: any) {\n      console.error('[CategoriesPage] Toggle error:', e);\n      toast.error(e?.message || 'Failed to update category');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleMoveUp = async (category: Category, index: number) => {\n    if (index === 0) return;\n    const prevCategory = categories[index - 1];\n    if (!prevCategory) return;\n    setSaving(true);\n    try {\n      // Swap sort orders\n      await Promise.all([\n        adminPatch<any>(`/api/v2/admin/categories/${category.id}`, actorId || '', {\n          sortOrder: prevCategory.sortOrder,\n        }),\n        adminPatch<any>(`/api/v2/admin/categories/${prevCategory.id}`, actorId || '', {\n          sortOrder: category.sortOrder,\n        }),\n      ]);\n      await fetchCategories(); // Refetch to get updated order\n      toast.success('Category order updated');\n    } catch (e: any) {\n      console.error('[CategoriesPage] Move error:', e);\n      toast.error(e?.message || 'Failed to reorder category');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleMoveDown = async (category: Category, index: number) => {\n    if (index === categories.length - 1) return;\n    const nextCategory = categories[index + 1];\n    if (!nextCategory) return;\n    setSaving(true);\n    try {\n      // Swap sort orders\n      await Promise.all([\n        adminPatch<any>(`/api/v2/admin/categories/${category.id}`, actorId || '', {\n          sortOrder: nextCategory.sortOrder,\n        }),\n        adminPatch<any>(`/api/v2/admin/categories/${nextCategory.id}`, actorId || '', {\n          sortOrder: category.sortOrder,\n        }),\n      ]);\n      await fetchCategories(); // Refetch to get updated order\n      toast.success('Category order updated');\n    } catch (e: any) {\n      console.error('[CategoriesPage] Move error:', e);\n      toast.error(e?.message || 'Failed to reorder category');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleCreate = async () => {\n    if (!newCategory.label.trim() || !newCategory.slug.trim()) {\n      toast.error('Label and slug are required');\n      return;\n    }\n    setSaving(true);\n    try {\n      await adminPost<any>(`/api/v2/admin/categories`, actorId || '', {\n        slug: newCategory.slug.toLowerCase(),\n        label: newCategory.label,\n        icon: newCategory.icon || null,\n      });\n      toast.success('Category created');\n      setShowAddModal(false);\n      setNewCategory({ slug: '', label: '', icon: '' });\n      await fetchCategories();\n    } catch (e: any) {\n      console.error('[CategoriesPage] Create error:', e);\n      toast.error(e?.message || 'Failed to create category');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Auto-generate slug from label\n  const handleLabelChange = (label: string) => {\n    setNewCategory({\n      ...newCategory,\n      label,\n      slug: label\n        .toLowerCase()\n        .replace(/[^a-z0-9]+/g, '_')\n        .replace(/^_+|_+$/g, ''),\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <Loader2 className=\"w-8 h-8 text-emerald-500 animate-spin\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\n            <Tag className=\"w-7 h-7 text-emerald-500\" />\n            Categories\n          </h1>\n          <p className=\"text-slate-400 mt-1\">Manage prediction categories</p>\n        </div>\n        <button\n          onClick={() => setShowAddModal(true)}\n          className=\"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors\"\n        >\n          <Plus className=\"w-4 h-4\" />\n          Add Category\n        </button>\n      </div>\n\n      {/* Categories List */}\n      <div className=\"bg-slate-800 border border-slate-700 rounded-xl overflow-hidden\">\n        <div className=\"divide-y divide-slate-700\">\n          {categories.map((category, index) => (\n            <div\n              key={category.id}\n              className=\"flex items-center justify-between p-4 hover:bg-slate-750 transition-colors\"\n            >\n              <div className=\"flex items-center gap-4 flex-1\">\n                {/* Reorder buttons */}\n                <div className=\"flex flex-col gap-1\">\n                  <button\n                    onClick={() => handleMoveUp(category, index)}\n                    disabled={index === 0 || saving}\n                    className=\"p-1 text-slate-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed\"\n                    title=\"Move up\"\n                  >\n                    <ChevronUp className=\"w-4 h-4\" />\n                  </button>\n                  <button\n                    onClick={() => handleMoveDown(category, index)}\n                    disabled={index === categories.length - 1 || saving}\n                    className=\"p-1 text-slate-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed\"\n                    title=\"Move down\"\n                  >\n                    <ChevronDown className=\"w-4 h-4\" />\n                  </button>\n                </div>\n\n                {/* Category info */}\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-3\">\n                    <h3 className=\"text-white font-semibold\">{category.label}</h3>\n                    <span className=\"text-slate-400 text-sm font-mono\">/{category.slug}</span>\n                    {category.icon && <span className=\"text-slate-400\">{category.icon}</span>}\n                  </div>\n                  <p className=\"text-slate-500 text-xs mt-1\">\n                    Sort order: {category.sortOrder}  Created: {new Date(category.createdAt).toLocaleDateString()}\n                  </p>\n                </div>\n              </div>\n\n              {/* Enabled toggle */}\n              <button\n                onClick={() => handleToggleEnabled(category.id, category.isEnabled)}\n                disabled={saving}\n                className={`px-4 py-2 rounded-lg font-medium transition-colors ${\n                  category.isEnabled\n                    ? 'bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30'\n                    : 'bg-slate-700 text-slate-400 hover:bg-slate-600'\n                } disabled:opacity-50`}\n              >\n                {category.isEnabled ? 'Enabled' : 'Disabled'}\n              </button>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Add Category Modal */}\n      <Dialog.Root open={showAddModal} onOpenChange={setShowAddModal}>\n        <Dialog.Portal>\n          <Dialog.Overlay className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-[12000]\" />\n          <Dialog.Content className=\"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-slate-800 border border-slate-700 rounded-xl shadow-2xl z-[12001] w-full max-w-md p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <Dialog.Title className=\"text-xl font-bold text-white\">Add Category</Dialog.Title>\n              <Dialog.Close className=\"p-2 rounded-lg hover:bg-slate-700 text-slate-400 hover:text-white\">\n                <X className=\"w-5 h-5\" />\n              </Dialog.Close>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-slate-300 mb-2\">Label *</label>\n                <input\n                  type=\"text\"\n                  value={newCategory.label}\n                  onChange={(e) => handleLabelChange(e.target.value)}\n                  placeholder=\"e.g., Sports\"\n                  className=\"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-slate-300 mb-2\">Slug *</label>\n                <input\n                  type=\"text\"\n                  value={newCategory.slug}\n                  onChange={(e) => setNewCategory({ ...newCategory, slug: e.target.value.toLowerCase() })}\n                  placeholder=\"e.g., sports\"\n                  className=\"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 font-mono text-sm\"\n                />\n                <p className=\"text-xs text-slate-500 mt-1\">Lowercase, alphanumeric, underscores only</p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-slate-300 mb-2\">Icon (optional)</label>\n                <input\n                  type=\"text\"\n                  value={newCategory.icon}\n                  onChange={(e) => setNewCategory({ ...newCategory, icon: e.target.value })}\n                  placeholder=\"e.g.,  or trophy\"\n                  className=\"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-end gap-3 mt-6\">\n              <Dialog.Close className=\"px-4 py-2 text-slate-400 hover:text-white transition-colors\">\n                Cancel\n              </Dialog.Close>\n              <button\n                onClick={handleCreate}\n                disabled={saving || !newCategory.label.trim() || !newCategory.slug.trim()}\n                className=\"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n              >\n                {saving ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                    Creating...\n                  </>\n                ) : (\n                  <>\n                    <Check className=\"w-4 h-4\" />\n                    Create\n                  </>\n                )}\n              </button>\n            </div>\n          </Dialog.Content>\n        </Dialog.Portal>\n      </Dialog.Root>\n    </div>\n  );\n};\n","import React from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport AdminGate from '@/components/admin/AdminGate';\nimport AdminLayout from '@/components/admin/AdminLayout';\n\nimport AdminHomePage from '@/pages/admin/AdminHomePage';\nimport UsersPage from '@/pages/admin/UsersPage';\nimport UserDetailPage from '@/pages/admin/UserDetailPage';\nimport UserViewPage from '@/pages/admin/UserViewPage';\nimport WalletsPage from '@/pages/admin/WalletsPage';\nimport UserWalletPage from '@/pages/admin/UserWalletPage';\nimport PredictionsPage from '@/pages/admin/PredictionsPage';\nimport PredictionDetailPage from '@/pages/admin/PredictionDetailPage';\nimport SettlementsPage from '@/pages/admin/SettlementsPage';\nimport SettlementDetailPage from '@/pages/admin/SettlementDetailPage';\nimport SupportPage from '@/pages/admin/SupportPage';\nimport ModerationPage from '@/pages/admin/ModerationPage';\nimport ConfigPage from '@/pages/admin/ConfigPage';\nimport AuditLogPage from '@/pages/admin/AuditLogPage';\nimport { CategoriesPage } from '@/pages/admin/CategoriesPage';\n\n/**\n * LandingAdminRouter mounts the admin dashboard under the WEBSITE build router.\n * This enables fanclubz.app/admin/* when VITE_BUILD_TARGET=landing.\n */\nconst LandingAdminRouter: React.FC = () => {\n  return (\n    <AdminGate>\n      <AdminLayout>\n        <Routes>\n          <Route path=\"/\" element={<AdminHomePage />} />\n          <Route path=\"users\" element={<UsersPage />} />\n          <Route path=\"users/:userId\" element={<UserDetailPage />} />\n          <Route path=\"users/:userId/view\" element={<UserViewPage />} />\n          <Route path=\"wallets\" element={<WalletsPage />} />\n          <Route path=\"wallets/:userId\" element={<UserWalletPage />} />\n          <Route path=\"predictions\" element={<PredictionsPage />} />\n          <Route path=\"predictions/:predictionId\" element={<PredictionDetailPage />} />\n          <Route path=\"settlements\" element={<SettlementsPage />} />\n          <Route path=\"settlements/:predictionId\" element={<SettlementDetailPage />} />\n          <Route path=\"support\" element={<SupportPage />} />\n          <Route path=\"moderation\" element={<ModerationPage />} />\n          <Route path=\"config\" element={<ConfigPage />} />\n          <Route path=\"categories\" element={<CategoriesPage />} />\n          <Route path=\"audit\" element={<AuditLogPage />} />\n        </Routes>\n      </AdminLayout>\n    </AdminGate>\n  );\n};\n\nexport default LandingAdminRouter;\n\n\n","import React, { useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { FRONTEND_URL } from '@/utils/environment';\n\n/**\n * RedirectToApp\n * Resolves deployment confusion by redirecting app routes that hit the landing domain\n * (fanclubz.app) over to the main app domain (app.fanclubz.app), preserving path+query.\n */\nexport const RedirectToApp: React.FC = () => {\n  const loc = useLocation();\n  useEffect(() => {\n    const appUrl = FRONTEND_URL || 'https://app.fanclubz.app';\n    const target = `${appUrl}${loc.pathname}${loc.search}${loc.hash}`;\n    window.location.replace(target);\n  }, [loc.pathname, loc.search, loc.hash]);\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n      <div className=\"text-slate-300\">Redirecting</div>\n    </div>\n  );\n};\n\nexport default RedirectToApp;\n\n","import React from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport LandingPage from './LandingPage';\nimport FundingGuidePage from './FundingGuidePage';\nimport LandingAdminRouter from './LandingAdminRouter';\nimport RedirectToApp from './RedirectToApp';\n\n/**\n * LandingRouter handles routing for the landing/marketing site (fanclubz.app)\n * This is separate from the main app (app.fanclubz.app)\n */\nconst LandingRouter: React.FC = () => {\n  return (\n    <Routes>\n      <Route path=\"/\" element={<LandingPage />} />\n      <Route path=\"/docs/funding-guide\" element={<FundingGuidePage />} />\n      {/* If app routes hit landing domain, redirect to main app to avoid deployment confusion */}\n      <Route path=\"/predictions/*\" element={<RedirectToApp />} />\n      <Route path=\"/prediction/*\" element={<RedirectToApp />} />\n      <Route path=\"/profile/*\" element={<RedirectToApp />} />\n      <Route path=\"/wallet/*\" element={<RedirectToApp />} />\n      <Route path=\"/discover/*\" element={<RedirectToApp />} />\n      <Route path=\"/bets/*\" element={<RedirectToApp />} />\n      <Route path=\"/create/*\" element={<RedirectToApp />} />\n      <Route path=\"/rankings/*\" element={<RedirectToApp />} />\n      {/* Admin routes - must come before catch-all */}\n      <Route path=\"/admin\" element={<LandingAdminRouter />} />\n      <Route path=\"/admin/*\" element={<LandingAdminRouter />} />\n      {/* Fallback to landing page for any unmatched routes */}\n      <Route path=\"*\" element={<LandingPage />} />\n    </Routes>\n  );\n};\n\nexport default LandingRouter;\n","import React from 'react';\nimport { AlertTriangle, RefreshCw, Home } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error?: Error;\n  errorInfo?: React.ErrorInfo;\n}\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode;\n  fallback?: React.ComponentType<{ error?: Error; resetError: () => void }>;\n  onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\n}\n\nclass ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    // Update state so the next render will show the fallback UI\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    // Always log errors to console for debugging (even in production)\n    console.error(' ErrorBoundary caught an error:', error);\n    console.error('Error stack:', error.stack);\n    console.error('Error info:', errorInfo);\n    console.error('Component stack:', errorInfo.componentStack);\n    \n    // CRITICAL: Handle dynamic module loading errors (stale Vercel chunks)\n    // These occur when Vercel deploys new code but the browser has cached old chunk references\n    const isModuleLoadError = \n      error.message.includes('Failed to fetch dynamically imported module') ||\n      error.message.includes('Failed to load module script') ||\n      error.message.includes('Loading chunk') ||\n      error.message.includes('ChunkLoadError');\n    \n    if (isModuleLoadError) {\n      console.warn(' Module loading error detected - triggering hard reload to fetch fresh chunks');\n      // Clear any cached service worker data\n      if ('caches' in window) {\n        caches.keys().then(names => {\n          names.forEach(name => caches.delete(name));\n        });\n      }\n      // Force a hard reload bypassing cache\n      window.location.reload();\n      return;\n    }\n    \n    this.setState({\n      error,\n      errorInfo\n    });\n\n    // Call optional error handler\n    this.props.onError?.(error, errorInfo);\n  }\n\n  resetError = () => {\n    this.setState({ hasError: false, error: undefined, errorInfo: undefined });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Use custom fallback if provided\n      if (this.props.fallback) {\n        const FallbackComponent = this.props.fallback;\n        return <FallbackComponent error={this.state.error} resetError={this.resetError} />;\n      }\n\n      // Default error UI\n      return <DefaultErrorFallback error={this.state.error} resetError={this.resetError} />;\n    }\n\n    return this.props.children;\n  }\n}\n\n// Default error fallback component\nconst DefaultErrorFallback: React.FC<{ error?: Error; resetError: () => void }> = ({ \n  error, \n  resetError \n}) => {\n  const handleGoHome = () => {\n    resetError();\n    // Navigate to home\n    window.location.href = '/';\n  };\n\n  const handleRefresh = () => {\n    resetError();\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"max-w-md w-full bg-white rounded-2xl shadow-lg p-8 text-center\"\n      >\n        <div className=\"mb-6\">\n          <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\n            Something went wrong\n          </h1>\n          <p className=\"text-gray-600 text-sm leading-relaxed\">\n            We encountered an unexpected error. This has been logged and our team will investigate.\n          </p>\n        </div>\n\n        {error && (\n          <details className=\"mb-6 p-4 bg-gray-100 rounded-lg text-left\">\n            <summary className=\"font-semibold text-sm text-gray-800 mb-2 cursor-pointer\">\n              Error Details (click to expand)\n            </summary>\n            <pre className=\"text-xs text-gray-600 whitespace-pre-wrap mt-2\">\n              {error.message}\n              {error.stack && `\\n\\nStack:\\n${error.stack}`}\n            </pre>\n          </details>\n        )}\n\n        <div className=\"flex flex-col gap-3\">\n          <motion.button\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n            onClick={handleRefresh}\n            className=\"flex items-center justify-center gap-2 w-full bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-green-700 transition-colors\"\n          >\n            <RefreshCw className=\"w-4 h-4\" />\n            Try Again\n          </motion.button>\n          \n          <motion.button\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n            onClick={handleGoHome}\n            className=\"flex items-center justify-center gap-2 w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-xl font-semibold hover:bg-gray-200 transition-colors\"\n          >\n            <Home className=\"w-4 h-4\" />\n            Go to Home\n          </motion.button>\n        </div>\n      </motion.div>\n    </div>\n  );\n};\n\n// Specific error boundary for profile navigation\nexport const ProfileErrorBoundary: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const handleProfileError = (error: Error, errorInfo: React.ErrorInfo) => {\n    console.error('Profile navigation error:', error, errorInfo);\n    \n    // Check if it's the specific React error #301\n    if (error.message.includes('Minified React error #301')) {\n      console.error('React error #301 detected in profile navigation - this is typically a hydration mismatch');\n    }\n  };\n\n  return (\n    <ErrorBoundary \n      onError={handleProfileError}\n      fallback={ProfileErrorFallback}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n};\n\n// Profile-specific error fallback\nconst ProfileErrorFallback: React.FC<{ error?: Error; resetError: () => void }> = ({ \n  error, \n  resetError \n}) => {\n  const handleGoBack = () => {\n    resetError();\n    window.history.back();\n  };\n\n  const handleGoHome = () => {\n    resetError();\n    window.location.href = '/';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-500 to-teal-600 pt-12 pb-6\">\n        <div className=\"px-6\">\n          <h1 className=\"text-white text-2xl font-bold\">Profile</h1>\n        </div>\n      </div>\n\n      {/* Error Content */}\n      <div className=\"flex items-center justify-center p-6 mt-8\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"max-w-sm w-full bg-white rounded-2xl shadow-lg p-6 text-center\"\n        >\n          <div className=\"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <AlertTriangle className=\"w-6 h-6 text-red-600\" />\n          </div>\n          \n          <h2 className=\"text-lg font-bold text-gray-900 mb-2\">\n            Profile Unavailable\n          </h2>\n          \n          <p className=\"text-gray-600 text-sm mb-6\">\n            We couldn't load this profile. The user might not exist or there was a connection issue.\n          </p>\n\n          <div className=\"flex flex-col gap-3\">\n            <motion.button\n              whileHover={{ scale: 1.02 }}\n              whileTap={{ scale: 0.98 }}\n              onClick={handleGoBack}\n              className=\"w-full bg-teal-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-green-700 transition-colors\"\n            >\n              Go Back\n            </motion.button>\n            \n            <motion.button\n              whileHover={{ scale: 1.02 }}\n              whileTap={{ scale: 0.98 }}\n              onClick={handleGoHome}\n              className=\"w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-xl font-semibold hover:bg-gray-200 transition-colors\"\n            >\n              Go to Home\n            </motion.button>\n          </div>\n        </motion.div>\n      </div>\n    </div>\n  );\n};\n\nexport default ErrorBoundary;","import toast from 'react-hot-toast';\nimport { qaLog } from './devQa';\n\n// Toast throttling and deduplication\ninterface ToastThrottle {\n  lastShown: number;\n  count: number;\n}\n\nconst toastThrottle = new Map<string, ToastThrottle>();\nconst THROTTLE_DURATION = 10000; // 10 seconds\nconst MAX_DUPLICATES = 3;\n\n// Toast categories for different types of messages\nexport type ToastCategory = \n  | 'user_action'\n  | 'background_error'\n  | 'network_error'\n  | 'validation_error'\n  | 'success'\n  | 'info';\n\ninterface ToastOptions {\n  category?: ToastCategory;\n  duration?: number;\n  throttle?: boolean;\n  dedupe?: boolean;\n}\n\n// Only show toasts for user actions and critical errors\nconst ALLOWED_CATEGORIES: ToastCategory[] = [\n  'user_action',\n  'validation_error',\n  'success',\n  'info'\n];\n\nexport const showToast = (\n  message: string,\n  type: 'success' | 'error' | 'loading' | 'info' = 'info',\n  options: ToastOptions = {}\n) => {\n  const {\n    category = 'user_action',\n    duration = 4000,\n    throttle = true,\n    dedupe = true\n  } = options;\n\n  // Only show toasts for allowed categories\n  if (!ALLOWED_CATEGORIES.includes(category)) {\n    qaLog('Toast blocked for category:', category, message);\n    return;\n  }\n\n  // Create a unique key for deduplication\n  const key = `${category}:${message}`;\n\n  // Check throttling\n  if (throttle) {\n    const now = Date.now();\n    const throttleInfo = toastThrottle.get(key);\n\n    if (throttleInfo) {\n      const timeSinceLastShown = now - throttleInfo.lastShown;\n      \n      if (timeSinceLastShown < THROTTLE_DURATION) {\n        throttleInfo.count++;\n        \n        // If we've shown this message too many times, don't show it again\n        if (throttleInfo.count > MAX_DUPLICATES) {\n          qaLog('Toast throttled (max duplicates reached):', message);\n          return;\n        }\n        \n        qaLog('Toast throttled:', message, `(${throttleInfo.count}/${MAX_DUPLICATES})`);\n        return;\n      } else {\n        // Reset the counter if enough time has passed\n        throttleInfo.count = 1;\n        throttleInfo.lastShown = now;\n      }\n    } else {\n      toastThrottle.set(key, {\n        lastShown: now,\n        count: 1\n      });\n    }\n  }\n\n  // Check deduplication\n  if (dedupe) {\n    // Check if the same message is already being shown\n    const existingToasts = document.querySelectorAll('[data-testid=\"toast\"]');\n    for (const existingToast of existingToasts) {\n      const text = existingToast.textContent;\n      if (text && text.includes(message)) {\n        qaLog('Toast deduplicated:', message);\n        return;\n      }\n    }\n  }\n\n  qaLog('Showing toast:', { type, category, message });\n\n  // Show the toast with appropriate styling\n  switch (type) {\n    case 'success':\n      toast.success(message, {\n        duration,\n        style: {\n          background: '#10B981',\n          color: '#fff',\n        },\n        iconTheme: {\n          primary: '#fff',\n          secondary: '#10B981',\n        },\n      });\n      break;\n    case 'error':\n      toast.error(message, {\n        duration,\n        style: {\n          background: '#EF4444',\n          color: '#fff',\n        },\n        iconTheme: {\n          primary: '#fff',\n          secondary: '#EF4444',\n        },\n      });\n      break;\n    case 'loading':\n      toast.loading(message, {\n        duration,\n        style: {\n          background: '#3B82F6',\n          color: '#fff',\n        },\n      });\n      break;\n    case 'info':\n    default:\n      toast(message, {\n        duration,\n        style: {\n          background: '#6B7280',\n          color: '#fff',\n        },\n        iconTheme: {\n          primary: '#fff',\n          secondary: '#6B7280',\n        },\n      });\n      break;\n  }\n};\n\n// Convenience functions for different toast types\nexport const showSuccessToast = (message: string, options?: ToastOptions) => {\n  showToast(message, 'success', { ...options, category: 'success' });\n};\n\nexport const showErrorToast = (message: string, options?: ToastOptions) => {\n  showToast(message, 'error', { ...options, category: 'user_action' });\n};\n\nexport const showLoadingToast = (message: string, options?: ToastOptions) => {\n  showToast(message, 'loading', { ...options, category: 'user_action' });\n};\n\nexport const showInfoToast = (message: string, options?: ToastOptions) => {\n  showToast(message, 'info', { ...options, category: 'info' });\n};\n\n// Validation error toasts\nexport const showValidationError = (message: string, options?: ToastOptions) => {\n  showToast(message, 'error', { ...options, category: 'validation_error' });\n};\n\n// User action toasts (these are always shown)\nexport const showUserActionToast = (message: string, type: 'success' | 'error' | 'info' = 'info') => {\n  showToast(message, type, { category: 'user_action', throttle: false });\n};\n\n// Clear all toasts\nexport const clearAllToasts = () => {\n  toast.dismiss();\n  toastThrottle.clear();\n};\n\n// Clear throttling for a specific message\nexport const clearToastThrottle = (message: string, category: ToastCategory = 'user_action') => {\n  const key = `${category}:${message}`;\n  toastThrottle.delete(key);\n};\n\n// Get throttling info for debugging\nexport const getToastThrottleInfo = () => {\n  return Array.from(toastThrottle.entries()).map(([key, info]) => ({\n    key,\n    lastShown: new Date(info.lastShown).toISOString(),\n    count: info.count,\n    timeSinceLastShown: Date.now() - info.lastShown\n  }));\n};\n","import { qaLog } from './devQa';\nimport { showErrorToast, showUserActionToast } from './toasts';\n\nexport interface ErrorInfo {\n  message: string;\n  code?: string;\n  status?: number;\n  timestamp: number;\n  context?: string;\n  userAction?: boolean;\n}\n\nexport class AppError extends Error {\n  public readonly code?: string;\n  public readonly status?: number;\n  public readonly context?: string;\n  public readonly userAction?: boolean;\n  public readonly timestamp: number;\n\n  constructor(\n    message: string,\n    options: {\n      code?: string;\n      status?: number;\n      context?: string;\n      userAction?: boolean;\n    } = {}\n  ) {\n    super(message);\n    this.name = 'AppError';\n    this.code = options.code;\n    this.status = options.status;\n    this.context = options.context;\n    this.userAction = options.userAction;\n    this.timestamp = Date.now();\n  }\n\n  toErrorInfo(): ErrorInfo {\n    return {\n      message: this.message,\n      code: this.code,\n      status: this.status,\n      timestamp: this.timestamp,\n      context: this.context,\n      userAction: this.userAction,\n    };\n  }\n}\n\n// Error classification\nexport const classifyError = (error: unknown): {\n  type: 'network' | 'validation' | 'auth' | 'server' | 'unknown';\n  message: string;\n  userFriendly: boolean;\n  shouldShowToast: boolean;\n} => {\n  if (error instanceof AppError) {\n    return {\n      type: error.code === 'AUTH_REQUIRED' ? 'auth' : \n            error.code === 'VALIDATION_ERROR' ? 'validation' :\n            error.status && error.status >= 500 ? 'server' :\n            error.status && error.status >= 400 ? 'validation' : 'unknown',\n      message: error.message,\n      userFriendly: true,\n      shouldShowToast: error.userAction || false,\n    };\n  }\n\n  if (error instanceof Error) {\n    // Network errors\n    if (error.message.includes('fetch') || error.message.includes('network') || error.message.includes('Failed to fetch')) {\n      return {\n        type: 'network',\n        message: 'Connection problem. Please check your internet and try again.',\n        userFriendly: true,\n        shouldShowToast: false, // Background error, show in banner instead\n      };\n    }\n\n    // Generic error\n    return {\n      type: 'unknown',\n      message: error.message,\n      userFriendly: false,\n      shouldShowToast: false,\n    };\n  }\n\n  // Unknown error type\n  return {\n    type: 'unknown',\n    message: 'Something went wrong. Please try again.',\n    userFriendly: true,\n    shouldShowToast: false,\n  };\n};\n\n// Error handler for async operations\nexport const handleAsyncError = async <T>(\n  operation: () => Promise<T>,\n  context?: string\n): Promise<{ data?: T; error?: AppError }> => {\n  try {\n    const data = await operation();\n    return { data };\n  } catch (error) {\n    const appError = error instanceof AppError \n      ? error \n      : new AppError(\n          error instanceof Error ? error.message : 'Unknown error occurred',\n          { context }\n        );\n    \n    qaLog('[ErrorHandler] Async error:', appError.toErrorInfo());\n    \n    const classification = classifyError(appError);\n    if (classification.shouldShowToast) {\n      showErrorToast(classification.message);\n    }\n    \n    return { error: appError };\n  }\n};\n\n// Error handler for user actions\nexport const handleUserActionError = async <T>(\n  operation: () => Promise<T>,\n  context?: string\n): Promise<T> => {\n  try {\n    return await operation();\n  } catch (error) {\n    const appError = error instanceof AppError \n      ? error \n      : new AppError(\n          error instanceof Error ? error.message : 'Action failed',\n          { context, userAction: true }\n        );\n    \n    qaLog('[ErrorHandler] User action error:', appError.toErrorInfo());\n    \n    const classification = classifyError(appError);\n    showErrorToast(classification.message);\n    \n    throw appError;\n  }\n};\n\n// Retry logic with exponential backoff\nexport const withRetry = async <T>(\n  operation: () => Promise<T>,\n  maxRetries: number = 3,\n  baseDelay: number = 1000,\n  context?: string\n): Promise<T> => {\n  let lastError: unknown;\n  \n  for (let attempt = 0; attempt <= maxRetries; attempt++) {\n    try {\n      return await operation();\n    } catch (error) {\n      lastError = error;\n      \n      if (attempt === maxRetries) {\n        qaLog(`[ErrorHandler] Max retries (${maxRetries}) reached for:`, context);\n        break;\n      }\n      \n      const delay = baseDelay * Math.pow(2, attempt);\n      qaLog(`[ErrorHandler] Retry ${attempt + 1}/${maxRetries} after ${delay}ms for:`, context);\n      \n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n  \n  throw lastError;\n};\n\n// Error boundary helper\nexport const createErrorBoundaryFallback = (error: Error, context?: string) => {\n  const appError = error instanceof AppError \n    ? error \n    : new AppError(error.message, { context });\n  \n  qaLog('[ErrorHandler] Error boundary triggered:', appError.toErrorInfo());\n  \n  return {\n    title: 'Something went wrong',\n    message: 'We encountered an unexpected error. Please refresh the page and try again.',\n    canRetry: true,\n    error: appError,\n  };\n};\n\n// Network error detection\nexport const isNetworkError = (error: unknown): boolean => {\n  if (error instanceof AppError) {\n    return error.code === 'NETWORK_ERROR' || error.status === 0;\n  }\n  \n  if (error instanceof Error) {\n    return error.message.includes('fetch') || \n           error.message.includes('network') || \n           error.message.includes('Failed to fetch') ||\n           error.name === 'NetworkError';\n  }\n  \n  return false;\n};\n\n// Auth error detection\nexport const isAuthError = (error: unknown): boolean => {\n  if (error instanceof AppError) {\n    return error.code === 'AUTH_REQUIRED' || error.status === 401;\n  }\n  \n  if (error instanceof Error) {\n    return error.message.includes('unauthorized') || \n           error.message.includes('authentication');\n  }\n  \n  return false;\n};\n\n// Validation error detection\nexport const isValidationError = (error: unknown): boolean => {\n  if (error instanceof AppError) {\n    return error.code === 'VALIDATION_ERROR' || \n           (typeof error.status === 'number' && error.status >= 400 && error.status < 500);\n  }\n  \n  return false;\n};\n","import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { qaLog } from '../utils/devQa';\nimport { showErrorToast } from '../utils/toasts';\nimport { AppError, classifyError } from '../utils/errorHandling';\n\ninterface ErrorHandlingContextType {\n  reportError: (error: AppError | Error, context?: string) => void;\n  clearErrors: () => void;\n  errors: AppError[];\n}\n\nconst ErrorHandlingContext = createContext<ErrorHandlingContextType | undefined>(undefined);\n\nexport const useErrorHandling = () => {\n  const context = useContext(ErrorHandlingContext);\n  if (context === undefined) {\n    throw new Error('useErrorHandling must be used within an ErrorHandlingProvider');\n  }\n  return context;\n};\n\ninterface ErrorHandlingProviderProps {\n  children: React.ReactNode;\n  maxErrors?: number;\n  showToasts?: boolean;\n}\n\nexport const ErrorHandlingProvider: React.FC<ErrorHandlingProviderProps> = ({\n  children,\n  maxErrors = 10,\n  showToasts = true,\n}) => {\n  const [errors, setErrors] = useState<AppError[]>([]);\n\n  const reportError = (error: AppError | Error, context?: string) => {\n    const appError = error instanceof AppError \n      ? error \n      : new AppError(error.message, { context });\n\n    const classification = classifyError(appError);\n    \n    // Add to errors list\n    setErrors(prev => {\n      const newErrors = [appError, ...prev].slice(0, maxErrors);\n      return newErrors;\n    });\n\n    // Log the error\n    qaLog('[ErrorHandlingProvider] Error reported:', appError.toErrorInfo());\n\n    // Show toast if appropriate\n    if (showToasts && classification.shouldShowToast) {\n      showErrorToast(classification.message);\n    }\n  };\n\n  const clearErrors = () => {\n    setErrors([]);\n    qaLog('[ErrorHandlingProvider] Errors cleared');\n  };\n\n  // Global error handler for unhandled errors\n  useEffect(() => {\n    const handleUnhandledError = (event: ErrorEvent) => {\n      const error = new AppError(event.message, {\n        context: 'unhandled_error',\n        code: 'UNHANDLED_ERROR',\n      });\n      reportError(error);\n    };\n\n    const handleUnhandledRejection = (event: PromiseRejectionEvent) => {\n      const error = new AppError(\n        event.reason instanceof Error ? event.reason.message : 'Unhandled promise rejection',\n        {\n          context: 'unhandled_rejection',\n          code: 'UNHANDLED_REJECTION',\n        }\n      );\n      reportError(error);\n    };\n\n    window.addEventListener('error', handleUnhandledError);\n    window.addEventListener('unhandledrejection', handleUnhandledRejection);\n\n    return () => {\n      window.removeEventListener('error', handleUnhandledError);\n      window.removeEventListener('unhandledrejection', handleUnhandledRejection);\n    };\n  }, [reportError]);\n\n  const value = {\n    reportError,\n    clearErrors,\n    errors,\n  };\n\n  return (\n    <ErrorHandlingContext.Provider value={value}>\n      {children}\n    </ErrorHandlingContext.Provider>\n  );\n};\n","import { ChainNotConfiguredError, createConnector, } from '@wagmi/core';\nimport { getAddress, numberToHex, SwitchChainError, UserRejectedRequestError, } from 'viem';\ncoinbaseWallet.type = 'coinbaseWallet';\nexport function coinbaseWallet(parameters = {}) {\n    if (parameters.version === '3' || parameters.headlessMode)\n        return version3(parameters);\n    return version4(parameters);\n}\nfunction version4(parameters) {\n    let walletProvider;\n    let accountsChanged;\n    let chainChanged;\n    let disconnect;\n    return createConnector((config) => ({\n        id: 'coinbaseWalletSDK',\n        name: 'Coinbase Wallet',\n        rdns: 'com.coinbase.wallet',\n        type: coinbaseWallet.type,\n        async connect({ chainId, withCapabilities, ...rest } = {}) {\n            try {\n                const provider = await this.getProvider();\n                const accounts = (await provider.request({\n                    method: 'eth_requestAccounts',\n                    params: 'instantOnboarding' in rest && rest.instantOnboarding\n                        ? [{ onboarding: 'instant' }]\n                        : [],\n                })).map((x) => getAddress(x));\n                if (!accountsChanged) {\n                    accountsChanged = this.onAccountsChanged.bind(this);\n                    provider.on('accountsChanged', accountsChanged);\n                }\n                if (!chainChanged) {\n                    chainChanged = this.onChainChanged.bind(this);\n                    provider.on('chainChanged', chainChanged);\n                }\n                if (!disconnect) {\n                    disconnect = this.onDisconnect.bind(this);\n                    provider.on('disconnect', disconnect);\n                }\n                // Switch to chain if provided\n                let currentChainId = await this.getChainId();\n                if (chainId && currentChainId !== chainId) {\n                    const chain = await this.switchChain({ chainId }).catch((error) => {\n                        if (error.code === UserRejectedRequestError.code)\n                            throw error;\n                        return { id: currentChainId };\n                    });\n                    currentChainId = chain?.id ?? currentChainId;\n                }\n                return {\n                    accounts: (withCapabilities\n                        ? accounts.map((address) => ({ address, capabilities: {} }))\n                        : accounts),\n                    chainId: currentChainId,\n                };\n            }\n            catch (error) {\n                if (/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(error.message))\n                    throw new UserRejectedRequestError(error);\n                throw error;\n            }\n        },\n        async disconnect() {\n            const provider = await this.getProvider();\n            if (accountsChanged) {\n                provider.removeListener('accountsChanged', accountsChanged);\n                accountsChanged = undefined;\n            }\n            if (chainChanged) {\n                provider.removeListener('chainChanged', chainChanged);\n                chainChanged = undefined;\n            }\n            if (disconnect) {\n                provider.removeListener('disconnect', disconnect);\n                disconnect = undefined;\n            }\n            provider.disconnect();\n            provider.close?.();\n        },\n        async getAccounts() {\n            const provider = await this.getProvider();\n            return (await provider.request({\n                method: 'eth_accounts',\n            })).map((x) => getAddress(x));\n        },\n        async getChainId() {\n            const provider = await this.getProvider();\n            const chainId = (await provider.request({\n                method: 'eth_chainId',\n            }));\n            return Number(chainId);\n        },\n        async getProvider() {\n            if (!walletProvider) {\n                const preference = (() => {\n                    if (typeof parameters.preference === 'string')\n                        return { options: parameters.preference };\n                    return {\n                        ...parameters.preference,\n                        options: parameters.preference?.options ?? 'all',\n                    };\n                })();\n                const { createCoinbaseWalletSDK } = await import('@coinbase/wallet-sdk');\n                const sdk = createCoinbaseWalletSDK({\n                    ...parameters,\n                    appChainIds: config.chains.map((x) => x.id),\n                    preference,\n                });\n                walletProvider = sdk.getProvider();\n            }\n            return walletProvider;\n        },\n        async isAuthorized() {\n            try {\n                const accounts = await this.getAccounts();\n                return !!accounts.length;\n            }\n            catch {\n                return false;\n            }\n        },\n        async switchChain({ addEthereumChainParameter, chainId }) {\n            const chain = config.chains.find((chain) => chain.id === chainId);\n            if (!chain)\n                throw new SwitchChainError(new ChainNotConfiguredError());\n            const provider = await this.getProvider();\n            try {\n                await provider.request({\n                    method: 'wallet_switchEthereumChain',\n                    params: [{ chainId: numberToHex(chain.id) }],\n                });\n                return chain;\n            }\n            catch (error) {\n                // Indicates chain is not added to provider\n                if (error.code === 4902) {\n                    try {\n                        let blockExplorerUrls;\n                        if (addEthereumChainParameter?.blockExplorerUrls)\n                            blockExplorerUrls = addEthereumChainParameter.blockExplorerUrls;\n                        else\n                            blockExplorerUrls = chain.blockExplorers?.default.url\n                                ? [chain.blockExplorers?.default.url]\n                                : [];\n                        let rpcUrls;\n                        if (addEthereumChainParameter?.rpcUrls?.length)\n                            rpcUrls = addEthereumChainParameter.rpcUrls;\n                        else\n                            rpcUrls = [chain.rpcUrls.default?.http[0] ?? ''];\n                        const addEthereumChain = {\n                            blockExplorerUrls,\n                            chainId: numberToHex(chainId),\n                            chainName: addEthereumChainParameter?.chainName ?? chain.name,\n                            iconUrls: addEthereumChainParameter?.iconUrls,\n                            nativeCurrency: addEthereumChainParameter?.nativeCurrency ??\n                                chain.nativeCurrency,\n                            rpcUrls,\n                        };\n                        await provider.request({\n                            method: 'wallet_addEthereumChain',\n                            params: [addEthereumChain],\n                        });\n                        return chain;\n                    }\n                    catch (error) {\n                        throw new UserRejectedRequestError(error);\n                    }\n                }\n                throw new SwitchChainError(error);\n            }\n        },\n        onAccountsChanged(accounts) {\n            if (accounts.length === 0)\n                this.onDisconnect();\n            else\n                config.emitter.emit('change', {\n                    accounts: accounts.map((x) => getAddress(x)),\n                });\n        },\n        onChainChanged(chain) {\n            const chainId = Number(chain);\n            config.emitter.emit('change', { chainId });\n        },\n        async onDisconnect(_error) {\n            config.emitter.emit('disconnect');\n            const provider = await this.getProvider();\n            if (accountsChanged) {\n                provider.removeListener('accountsChanged', accountsChanged);\n                accountsChanged = undefined;\n            }\n            if (chainChanged) {\n                provider.removeListener('chainChanged', chainChanged);\n                chainChanged = undefined;\n            }\n            if (disconnect) {\n                provider.removeListener('disconnect', disconnect);\n                disconnect = undefined;\n            }\n        },\n    }));\n}\nfunction version3(parameters) {\n    const reloadOnDisconnect = false;\n    let sdk;\n    let walletProvider;\n    let accountsChanged;\n    let chainChanged;\n    let disconnect;\n    return createConnector((config) => ({\n        id: 'coinbaseWalletSDK',\n        name: 'Coinbase Wallet',\n        rdns: 'com.coinbase.wallet',\n        type: coinbaseWallet.type,\n        async connect({ chainId, withCapabilities } = {}) {\n            try {\n                const provider = await this.getProvider();\n                const accounts = (await provider.request({\n                    method: 'eth_requestAccounts',\n                })).map((x) => getAddress(x));\n                if (!accountsChanged) {\n                    accountsChanged = this.onAccountsChanged.bind(this);\n                    provider.on('accountsChanged', accountsChanged);\n                }\n                if (!chainChanged) {\n                    chainChanged = this.onChainChanged.bind(this);\n                    provider.on('chainChanged', chainChanged);\n                }\n                if (!disconnect) {\n                    disconnect = this.onDisconnect.bind(this);\n                    provider.on('disconnect', disconnect);\n                }\n                // Switch to chain if provided\n                let currentChainId = await this.getChainId();\n                if (chainId && currentChainId !== chainId) {\n                    const chain = await this.switchChain({ chainId }).catch((error) => {\n                        if (error.code === UserRejectedRequestError.code)\n                            throw error;\n                        return { id: currentChainId };\n                    });\n                    currentChainId = chain?.id ?? currentChainId;\n                }\n                return {\n                    accounts: (withCapabilities\n                        ? accounts.map((address) => ({ address, capabilities: {} }))\n                        : accounts),\n                    chainId: currentChainId,\n                };\n            }\n            catch (error) {\n                if (/(user closed modal|accounts received is empty|user denied account)/i.test(error.message))\n                    throw new UserRejectedRequestError(error);\n                throw error;\n            }\n        },\n        async disconnect() {\n            const provider = await this.getProvider();\n            if (accountsChanged) {\n                provider.removeListener('accountsChanged', accountsChanged);\n                accountsChanged = undefined;\n            }\n            if (chainChanged) {\n                provider.removeListener('chainChanged', chainChanged);\n                chainChanged = undefined;\n            }\n            if (disconnect) {\n                provider.removeListener('disconnect', disconnect);\n                disconnect = undefined;\n            }\n            provider.disconnect();\n            provider.close();\n        },\n        async getAccounts() {\n            const provider = await this.getProvider();\n            return (await provider.request({\n                method: 'eth_accounts',\n            })).map((x) => getAddress(x));\n        },\n        async getChainId() {\n            const provider = await this.getProvider();\n            const chainId = await provider.request({\n                method: 'eth_chainId',\n            });\n            return Number(chainId);\n        },\n        async getProvider() {\n            if (!walletProvider) {\n                // Unwrapping import for Vite compatibility.\n                // See: https://github.com/vitejs/vite/issues/9703\n                const CoinbaseWalletSDK = await (async () => {\n                    const { default: SDK } = await import('cbw-sdk');\n                    if (typeof SDK !== 'function' && typeof SDK.default === 'function')\n                        return SDK.default;\n                    return SDK;\n                })();\n                sdk = new CoinbaseWalletSDK({ ...parameters, reloadOnDisconnect });\n                // Force types to retrieve private `walletExtension` method from the Coinbase Wallet SDK.\n                const walletExtensionChainId = sdk.walletExtension?.getChainId();\n                const chain = config.chains.find((chain) => parameters.chainId\n                    ? chain.id === parameters.chainId\n                    : chain.id === walletExtensionChainId) || config.chains[0];\n                const chainId = parameters.chainId || chain?.id;\n                const jsonRpcUrl = parameters.jsonRpcUrl || chain?.rpcUrls.default.http[0];\n                walletProvider = sdk.makeWeb3Provider(jsonRpcUrl, chainId);\n            }\n            return walletProvider;\n        },\n        async isAuthorized() {\n            try {\n                const accounts = await this.getAccounts();\n                return !!accounts.length;\n            }\n            catch {\n                return false;\n            }\n        },\n        async switchChain({ addEthereumChainParameter, chainId }) {\n            const chain = config.chains.find((chain) => chain.id === chainId);\n            if (!chain)\n                throw new SwitchChainError(new ChainNotConfiguredError());\n            const provider = await this.getProvider();\n            try {\n                await provider.request({\n                    method: 'wallet_switchEthereumChain',\n                    params: [{ chainId: numberToHex(chain.id) }],\n                });\n                return chain;\n            }\n            catch (error) {\n                // Indicates chain is not added to provider\n                if (error.code === 4902) {\n                    try {\n                        let blockExplorerUrls;\n                        if (addEthereumChainParameter?.blockExplorerUrls)\n                            blockExplorerUrls = addEthereumChainParameter.blockExplorerUrls;\n                        else\n                            blockExplorerUrls = chain.blockExplorers?.default.url\n                                ? [chain.blockExplorers?.default.url]\n                                : [];\n                        let rpcUrls;\n                        if (addEthereumChainParameter?.rpcUrls?.length)\n                            rpcUrls = addEthereumChainParameter.rpcUrls;\n                        else\n                            rpcUrls = [chain.rpcUrls.default?.http[0] ?? ''];\n                        const addEthereumChain = {\n                            blockExplorerUrls,\n                            chainId: numberToHex(chainId),\n                            chainName: addEthereumChainParameter?.chainName ?? chain.name,\n                            iconUrls: addEthereumChainParameter?.iconUrls,\n                            nativeCurrency: addEthereumChainParameter?.nativeCurrency ??\n                                chain.nativeCurrency,\n                            rpcUrls,\n                        };\n                        await provider.request({\n                            method: 'wallet_addEthereumChain',\n                            params: [addEthereumChain],\n                        });\n                        return chain;\n                    }\n                    catch (error) {\n                        throw new UserRejectedRequestError(error);\n                    }\n                }\n                throw new SwitchChainError(error);\n            }\n        },\n        onAccountsChanged(accounts) {\n            if (accounts.length === 0)\n                this.onDisconnect();\n            else\n                config.emitter.emit('change', {\n                    accounts: accounts.map((x) => getAddress(x)),\n                });\n        },\n        onChainChanged(chain) {\n            const chainId = Number(chain);\n            config.emitter.emit('change', { chainId });\n        },\n        async onDisconnect(_error) {\n            config.emitter.emit('disconnect');\n            const provider = await this.getProvider();\n            if (accountsChanged) {\n                provider.removeListener('accountsChanged', accountsChanged);\n                accountsChanged = undefined;\n            }\n            if (chainChanged) {\n                provider.removeListener('chainChanged', chainChanged);\n                chainChanged = undefined;\n            }\n            if (disconnect) {\n                provider.removeListener('disconnect', disconnect);\n                disconnect = undefined;\n            }\n        },\n    }));\n}\n//# sourceMappingURL=coinbaseWallet.js.map","import { ChainNotConfiguredError, createConnector, extractRpcUrls, ProviderNotFoundError, } from '@wagmi/core';\nimport { getAddress, numberToHex, SwitchChainError, UserRejectedRequestError, } from 'viem';\nwalletConnect.type = 'walletConnect';\n/**\n * @deprecated **NOTE: This connector uses a vulnerable dependency downstream** (`@walletconnect/ethereum-provider@2.21.1` > `@reown/appkit@1.8.9` > `@reown/appkit-utils@1.8.9` > `@walletconnect/logger@2.1.2` > `pino@7.11.0`). You should override `pino` to a secure version via your package manager:\n *\n * ### npm\n * ```json\n * {\n *   \"overrides\": {\n *     \"@walletconnect/logger\": {\n *       \"pino\": \"10.0.0\"\n *     }\n *   }\n * }\n * ```\n *\n * ### pnpm\n * ```json\n * {\n *   \"pnpm\": {\n *     \"overrides\": {\n *       \"@walletconnect/logger>pino\": \"10.0.0\"\n *     }\n *   }\n * }\n * ```\n *\n * ### yarn\n * ```json\n * {\n *   \"resolutions\": {\n *     \"@walletconnect/logger/pino\": \"10.0.0\"\n *   }\n * }\n * ```\n *\n * ### bun\n * ```json\n * {\n *   \"overrides\": {\n *     \"@walletconnect/logger\": {\n *       \"pino\": \"10.0.0\"\n *     }\n *   }\n * }\n * ```\n *\n * Normally the Wagmi team would upgrade `@walletconnect/ethereum-provider` to a fixed version for you, but `@walletconnect/ethereum-provider` was relicensed recently from Apache to a [non-permissive license](https://github.com/reown-com/appkit/blob/main/LICENSE.md). We are trying to get the WalletConnect team to release a version that closes the vulnerability under the old Apache license.\n */\nexport function walletConnect(parameters) {\n    const isNewChainsStale = parameters.isNewChainsStale ?? true;\n    let provider_;\n    let providerPromise;\n    const NAMESPACE = 'eip155';\n    let accountsChanged;\n    let chainChanged;\n    let connect;\n    let displayUri;\n    let sessionDelete;\n    let disconnect;\n    return createConnector((config) => ({\n        id: 'walletConnect',\n        name: 'WalletConnect',\n        type: walletConnect.type,\n        async setup() {\n            const provider = await this.getProvider().catch(() => null);\n            if (!provider)\n                return;\n            if (!connect) {\n                connect = this.onConnect.bind(this);\n                provider.on('connect', connect);\n            }\n            if (!sessionDelete) {\n                sessionDelete = this.onSessionDelete.bind(this);\n                provider.on('session_delete', sessionDelete);\n            }\n        },\n        async connect({ chainId, withCapabilities, ...rest } = {}) {\n            try {\n                const provider = await this.getProvider();\n                if (!provider)\n                    throw new ProviderNotFoundError();\n                if (!displayUri) {\n                    displayUri = this.onDisplayUri;\n                    provider.on('display_uri', displayUri);\n                }\n                let targetChainId = chainId;\n                if (!targetChainId) {\n                    const state = (await config.storage?.getItem('state')) ?? {};\n                    const isChainSupported = config.chains.some((x) => x.id === state.chainId);\n                    if (isChainSupported)\n                        targetChainId = state.chainId;\n                    else\n                        targetChainId = config.chains[0]?.id;\n                }\n                if (!targetChainId)\n                    throw new Error('No chains found on connector.');\n                const isChainsStale = await this.isChainsStale();\n                // If there is an active session with stale chains, disconnect current session.\n                if (provider.session && isChainsStale)\n                    await provider.disconnect();\n                // If there isn't an active session or chains are stale, connect.\n                if (!provider.session || isChainsStale) {\n                    const optionalChains = config.chains\n                        .filter((chain) => chain.id !== targetChainId)\n                        .map((optionalChain) => optionalChain.id);\n                    await provider.connect({\n                        optionalChains: [targetChainId, ...optionalChains],\n                        ...('pairingTopic' in rest\n                            ? { pairingTopic: rest.pairingTopic }\n                            : {}),\n                    });\n                    this.setRequestedChainsIds(config.chains.map((x) => x.id));\n                }\n                // If session exists and chains are authorized, enable provider for required chain\n                const accounts = (await provider.enable()).map((x) => getAddress(x));\n                // Switch to chain if provided\n                let currentChainId = await this.getChainId();\n                if (chainId && currentChainId !== chainId) {\n                    const chain = await this.switchChain({ chainId }).catch((error) => {\n                        if (error.code === UserRejectedRequestError.code &&\n                            error.cause?.message !==\n                                'Missing or invalid. request() method: wallet_addEthereumChain')\n                            throw error;\n                        return { id: currentChainId };\n                    });\n                    currentChainId = chain?.id ?? currentChainId;\n                }\n                if (displayUri) {\n                    provider.removeListener('display_uri', displayUri);\n                    displayUri = undefined;\n                }\n                if (connect) {\n                    provider.removeListener('connect', connect);\n                    connect = undefined;\n                }\n                if (!accountsChanged) {\n                    accountsChanged = this.onAccountsChanged.bind(this);\n                    provider.on('accountsChanged', accountsChanged);\n                }\n                if (!chainChanged) {\n                    chainChanged = this.onChainChanged.bind(this);\n                    provider.on('chainChanged', chainChanged);\n                }\n                if (!disconnect) {\n                    disconnect = this.onDisconnect.bind(this);\n                    provider.on('disconnect', disconnect);\n                }\n                if (!sessionDelete) {\n                    sessionDelete = this.onSessionDelete.bind(this);\n                    provider.on('session_delete', sessionDelete);\n                }\n                return {\n                    accounts: (withCapabilities\n                        ? accounts.map((address) => ({ address, capabilities: {} }))\n                        : accounts),\n                    chainId: currentChainId,\n                };\n            }\n            catch (error) {\n                if (/(user rejected|connection request reset)/i.test(error?.message)) {\n                    throw new UserRejectedRequestError(error);\n                }\n                throw error;\n            }\n        },\n        async disconnect() {\n            const provider = await this.getProvider();\n            try {\n                await provider?.disconnect();\n            }\n            catch (error) {\n                if (!/No matching key/i.test(error.message))\n                    throw error;\n            }\n            finally {\n                if (chainChanged) {\n                    provider?.removeListener('chainChanged', chainChanged);\n                    chainChanged = undefined;\n                }\n                if (disconnect) {\n                    provider?.removeListener('disconnect', disconnect);\n                    disconnect = undefined;\n                }\n                if (!connect) {\n                    connect = this.onConnect.bind(this);\n                    provider?.on('connect', connect);\n                }\n                if (accountsChanged) {\n                    provider?.removeListener('accountsChanged', accountsChanged);\n                    accountsChanged = undefined;\n                }\n                if (sessionDelete) {\n                    provider?.removeListener('session_delete', sessionDelete);\n                    sessionDelete = undefined;\n                }\n                this.setRequestedChainsIds([]);\n            }\n        },\n        async getAccounts() {\n            const provider = await this.getProvider();\n            return provider.accounts.map((x) => getAddress(x));\n        },\n        async getProvider({ chainId } = {}) {\n            async function initProvider() {\n                const optionalChains = config.chains.map((x) => x.id);\n                if (!optionalChains.length)\n                    return;\n                const { EthereumProvider } = await import('@walletconnect/ethereum-provider');\n                return await EthereumProvider.init({\n                    ...parameters,\n                    disableProviderPing: true,\n                    optionalChains,\n                    projectId: parameters.projectId,\n                    rpcMap: Object.fromEntries(config.chains.map((chain) => {\n                        const [url] = extractRpcUrls({\n                            chain,\n                            transports: config.transports,\n                        });\n                        return [chain.id, url];\n                    })),\n                    showQrModal: parameters.showQrModal ?? true,\n                });\n            }\n            if (!provider_) {\n                if (!providerPromise)\n                    providerPromise = initProvider();\n                provider_ = await providerPromise;\n                provider_?.events.setMaxListeners(Number.POSITIVE_INFINITY);\n            }\n            if (chainId)\n                await this.switchChain?.({ chainId });\n            return provider_;\n        },\n        async getChainId() {\n            const provider = await this.getProvider();\n            return provider.chainId;\n        },\n        async isAuthorized() {\n            try {\n                const [accounts, provider] = await Promise.all([\n                    this.getAccounts(),\n                    this.getProvider(),\n                ]);\n                // If an account does not exist on the session, then the connector is unauthorized.\n                if (!accounts.length)\n                    return false;\n                // If the chains are stale on the session, then the connector is unauthorized.\n                const isChainsStale = await this.isChainsStale();\n                if (isChainsStale && provider.session) {\n                    await provider.disconnect().catch(() => { });\n                    return false;\n                }\n                return true;\n            }\n            catch {\n                return false;\n            }\n        },\n        async switchChain({ addEthereumChainParameter, chainId }) {\n            const provider = await this.getProvider();\n            if (!provider)\n                throw new ProviderNotFoundError();\n            const chain = config.chains.find((x) => x.id === chainId);\n            if (!chain)\n                throw new SwitchChainError(new ChainNotConfiguredError());\n            try {\n                await Promise.all([\n                    new Promise((resolve) => {\n                        const listener = ({ chainId: currentChainId, }) => {\n                            if (currentChainId === chainId) {\n                                config.emitter.off('change', listener);\n                                resolve();\n                            }\n                        };\n                        config.emitter.on('change', listener);\n                    }),\n                    provider.request({\n                        method: 'wallet_switchEthereumChain',\n                        params: [{ chainId: numberToHex(chainId) }],\n                    }),\n                ]);\n                const requestedChains = await this.getRequestedChainsIds();\n                this.setRequestedChainsIds([...requestedChains, chainId]);\n                return chain;\n            }\n            catch (err) {\n                const error = err;\n                if (/(user rejected)/i.test(error.message))\n                    throw new UserRejectedRequestError(error);\n                // Indicates chain is not added to provider\n                try {\n                    let blockExplorerUrls;\n                    if (addEthereumChainParameter?.blockExplorerUrls)\n                        blockExplorerUrls = addEthereumChainParameter.blockExplorerUrls;\n                    else\n                        blockExplorerUrls = chain.blockExplorers?.default.url\n                            ? [chain.blockExplorers?.default.url]\n                            : [];\n                    let rpcUrls;\n                    if (addEthereumChainParameter?.rpcUrls?.length)\n                        rpcUrls = addEthereumChainParameter.rpcUrls;\n                    else\n                        rpcUrls = [...chain.rpcUrls.default.http];\n                    const addEthereumChain = {\n                        blockExplorerUrls,\n                        chainId: numberToHex(chainId),\n                        chainName: addEthereumChainParameter?.chainName ?? chain.name,\n                        iconUrls: addEthereumChainParameter?.iconUrls,\n                        nativeCurrency: addEthereumChainParameter?.nativeCurrency ?? chain.nativeCurrency,\n                        rpcUrls,\n                    };\n                    await provider.request({\n                        method: 'wallet_addEthereumChain',\n                        params: [addEthereumChain],\n                    });\n                    const requestedChains = await this.getRequestedChainsIds();\n                    this.setRequestedChainsIds([...requestedChains, chainId]);\n                    return chain;\n                }\n                catch (error) {\n                    throw new UserRejectedRequestError(error);\n                }\n            }\n        },\n        onAccountsChanged(accounts) {\n            if (accounts.length === 0)\n                this.onDisconnect();\n            else\n                config.emitter.emit('change', {\n                    accounts: accounts.map((x) => getAddress(x)),\n                });\n        },\n        onChainChanged(chain) {\n            const chainId = Number(chain);\n            config.emitter.emit('change', { chainId });\n        },\n        async onConnect(connectInfo) {\n            const chainId = Number(connectInfo.chainId);\n            const accounts = await this.getAccounts();\n            config.emitter.emit('connect', { accounts, chainId });\n        },\n        async onDisconnect(_error) {\n            this.setRequestedChainsIds([]);\n            config.emitter.emit('disconnect');\n            const provider = await this.getProvider();\n            if (accountsChanged) {\n                provider.removeListener('accountsChanged', accountsChanged);\n                accountsChanged = undefined;\n            }\n            if (chainChanged) {\n                provider.removeListener('chainChanged', chainChanged);\n                chainChanged = undefined;\n            }\n            if (disconnect) {\n                provider.removeListener('disconnect', disconnect);\n                disconnect = undefined;\n            }\n            if (sessionDelete) {\n                provider.removeListener('session_delete', sessionDelete);\n                sessionDelete = undefined;\n            }\n            if (!connect) {\n                connect = this.onConnect.bind(this);\n                provider.on('connect', connect);\n            }\n        },\n        onDisplayUri(uri) {\n            config.emitter.emit('message', { type: 'display_uri', data: uri });\n        },\n        onSessionDelete() {\n            this.onDisconnect();\n        },\n        getNamespaceChainsIds() {\n            if (!provider_)\n                return [];\n            const chainIds = provider_.session?.namespaces[NAMESPACE]?.accounts?.map((account) => Number.parseInt(account.split(':')[1] || '', 10));\n            return chainIds ?? [];\n        },\n        async getRequestedChainsIds() {\n            return ((await config.storage?.getItem(this.requestedChainsStorageKey)) ?? []);\n        },\n        /**\n         * Checks if the target chains match the chains that were\n         * initially requested by the connector for the WalletConnect session.\n         * If there is a mismatch, this means that the chains on the connector\n         * are considered stale, and need to be revalidated at a later point (via\n         * connection).\n         *\n         * There may be a scenario where a dapp adds a chain to the\n         * connector later on, however, this chain will not have been approved or rejected\n         * by the wallet. In this case, the chain is considered stale.\n         */\n        async isChainsStale() {\n            if (!isNewChainsStale)\n                return false;\n            const connectorChains = config.chains.map((x) => x.id);\n            const namespaceChains = this.getNamespaceChainsIds();\n            if (namespaceChains.length &&\n                !namespaceChains.some((id) => connectorChains.includes(id)))\n                return false;\n            const requestedChains = await this.getRequestedChainsIds();\n            return !connectorChains.every((id) => requestedChains.includes(id));\n        },\n        async setRequestedChainsIds(chains) {\n            await config.storage?.setItem(this.requestedChainsStorageKey, chains);\n        },\n        get requestedChainsStorageKey() {\n            return `${this.id}.requestedChains`;\n        },\n    }));\n}\n//# sourceMappingURL=walletConnect.js.map","import { createConfig, http, createStorage } from 'wagmi';\nimport { baseSepolia } from 'wagmi/chains';\nimport { walletConnect, injected, coinbaseWallet } from 'wagmi/connectors';\nimport { Capacitor } from '@capacitor/core';\n\n/**\n * Clean up stale WalletConnect sessions from localStorage\n * This prevents \"No matching key. session topic doesn't exist\" errors\n * \n * ENHANCED v7: Only clean up on explicit disconnect, not on page load\n * \n * Should be called:\n * - On explicit disconnect\n * - On session errors (via triggerRecovery)\n * \n * Should NOT be called:\n * - On app startup/page reload (let wagmi handle reconnection)\n */\nexport function cleanupStaleWalletConnectSessions(): number {\n  let removedCount = 0;\n  \n  try {\n    // Clear localStorage entries\n    // IMPORTANT: DO NOT remove 'wagmi.store' - it contains connection state!\n    const localKeysToRemove: string[] = [];\n    for (let i = 0; i < localStorage.length; i++) {\n      const key = localStorage.key(i);\n      if (!key) continue;\n      \n      // Skip the main wagmi store - this holds connection state\n      if (key === 'wagmi.store') continue;\n      \n      // Only remove WalletConnect-specific session data\n      if (\n        key.startsWith('wc@2:') || \n        key.startsWith('wc@1:') || \n        key.startsWith('walletconnect') ||\n        key.startsWith('WALLETCONNECT') ||\n        key.includes('wc_session') ||\n        key.includes('@walletconnect') ||\n        key.startsWith('wc_') ||\n        (key.includes('pairing') && key.includes('wc')) ||\n        (key.includes('relay') && key.includes('wc')) ||\n        (key.includes('topic') && key.includes('wc')) ||\n        key.includes('wallet-connect')\n      ) {\n        localKeysToRemove.push(key);\n      }\n    }\n    \n    localKeysToRemove.forEach(key => {\n      try {\n        localStorage.removeItem(key);\n        removedCount++;\n      } catch {}\n    });\n\n    // Clear sessionStorage entries\n    const sessionKeysToRemove: string[] = [];\n    for (let i = 0; i < sessionStorage.length; i++) {\n      const key = sessionStorage.key(i);\n      if (key && (\n        key.startsWith('wc@2:') || \n        key.startsWith('walletconnect') ||\n        key.includes('@walletconnect')\n      )) {\n        sessionKeysToRemove.push(key);\n      }\n    }\n    \n    sessionKeysToRemove.forEach(key => {\n      try {\n        sessionStorage.removeItem(key);\n        removedCount++;\n      } catch {}\n    });\n\n    if (removedCount > 0 && import.meta.env.DEV) {\n      console.log(`[Wagmi] Cleaned ${removedCount} stale WC sessions`);\n    }\n  } catch (error) {\n    console.warn('[Wagmi] Error cleaning WalletConnect sessions:', error);\n  }\n  \n  return removedCount;\n}\n\n/**\n * Check if an error is a WalletConnect session error\n */\nexport function isWalletConnectSessionError(error: unknown): boolean {\n  if (!error) return false;\n  \n  const errorMsg = String(error).toLowerCase();\n  const sessionPatterns = [\n    'no matching key',\n    'session topic',\n    'session not found',\n    'pairing topic',\n    'missing session',\n    'inactive session',\n    'session disconnected',\n    'expired session',\n    'please call connect() before request',\n    'client not initialized',\n    'peer disconnected',\n    'connection closed',\n    'request timeout',\n    'transport error',\n  ];\n  \n  return sessionPatterns.some(pattern => errorMsg.includes(pattern));\n}\n\n// Get project ID from environment (no fallback - require a real ID)\nconst projectId = import.meta.env.VITE_WALLETCONNECT_PROJECT_ID as string | undefined;\n\ntype ConnectorReturn =\n  | ReturnType<typeof injected>\n  | ReturnType<typeof walletConnect>\n  | ReturnType<typeof coinbaseWallet>;\n\n// Always include injected connector (works for browser extensions and mobile browser wallets)\nconst connectors: ConnectorReturn[] = [\n  injected({\n    // Avoid redefining window.ethereum on environments where it's non-configurable\n    // (prevents \"Cannot redefine property: ethereum\" errors with some wallets)\n    shimDisconnect: false,\n  }),\n];\n\n// Only add WalletConnect if project ID is valid\n// Note: Domain must be whitelisted at https://cloud.reown.com\nif (projectId && projectId.length >= 8) {\n  try {\n    const metadataUrl = typeof window !== 'undefined'\n      ? (Capacitor?.isNativePlatform?.() ? 'https://app.fanclubz.app' : window.location.origin)\n      : 'https://app.fanclubz.app';\n\n    connectors.push(\n      walletConnect({\n        projectId,\n        showQrModal: true,\n        qrModalOptions: { \n          themeMode: 'light',\n          // Better mobile support\n          enableExplorer: true,\n        },\n        metadata: {\n          name: 'Fan Club Z',\n          description: 'Prediction Platform',\n          url: metadataUrl,\n          icons: ['https://app.fanclubz.app/icons/icon-192.png'],\n        },\n      })\n    );\n  } catch (error) {\n    console.warn('[Wagmi] Failed to initialize WalletConnect connector:', error);\n    // Continue without WalletConnect - injected connector will still work\n  }\n}\n\nif (import.meta.env.VITE_ENABLE_COINBASE_CONNECTOR === '1') {\n  const coinbaseConnector = coinbaseWallet({\n    appName: 'Fan Club Z',\n    preference: 'smartWalletOnly',\n    headlessMode: false,\n  }) as ReturnType<typeof coinbaseWallet>;\n\n  connectors.push(coinbaseConnector);\n}\n\n// Multiple RPC endpoints for fallback - used by onchainTransactionService\nexport const RPC_ENDPOINTS = [\n  'https://sepolia.base.org',\n  'https://base-sepolia-rpc.publicnode.com',\n  'https://base-sepolia.blockpi.network/v1/rpc/public',\n] as const;\n\n/**\n * CRITICAL FIX: Explicit storage configuration for wagmi\n * \n * Without explicit storage config, wagmi may not properly persist and restore\n * wallet connections on page reload. This creates the storage with proper\n * serialization and the correct key prefix.\n */\nconst storage = createStorage({\n  storage: typeof window !== 'undefined' ? window.localStorage : undefined,\n  key: 'wagmi',\n});\n\nexport const config = createConfig({\n  chains: [baseSepolia],\n  connectors,\n  // CRITICAL: Explicit storage for connection persistence\n  storage,\n  // Sync connected state across tabs\n  syncConnectedChain: true,\n  // CRITICAL: Enable multiInjectedProviderDiscovery for better wallet detection\n  multiInjectedProviderDiscovery: true,\n  transports: {\n    [baseSepolia.id]: http(RPC_ENDPOINTS[0], {\n      batch: {\n        batchSize: 1024,\n        wait: 16,\n      },\n      timeout: 30_000,\n      retryCount: 3,\n      retryDelay: 500,\n    }),\n  },\n});\n\ndeclare module 'wagmi' {\n  interface Register {\n    config: typeof config;\n  }\n}\n\ndeclare module '@wagmi/core' {\n  interface Register {\n    config: typeof config;\n  }\n}\n","/**\n * On-Chain Transaction Service v6 - COMPREHENSIVE END-TO-END FIX\n * \n * Centralized service for managing all on-chain transactions\n * with proper error handling, logging, and state recovery.\n * \n * CRITICAL FIXES v6:\n * 1. WalletConnect session errors - AGGRESSIVE cleanup and recovery with user feedback\n * 2. ERC20 allowance - HARD WAIT after approval + consecutive multi-RPC verification\n * 3. Transaction logging - GUARANTEED logging with retry queue and persistence\n * 4. Error propagation - Structured errors that ALWAYS reach the UI\n * 5. Settlement/fees - All tx hashes logged to backend with proper types\n * 6. User feedback - Clear, actionable error messages at every step\n */\n\nimport { readContract } from '@wagmi/core';\nimport type { QueryClient } from '@tanstack/react-query';\nimport { config as wagmiBaseConfig } from '@/lib/wagmi';\nimport { getAddress, type Address, type Hash, createPublicClient, http, formatUnits } from 'viem';\nimport { baseSepolia } from 'wagmi/chains';\nimport { getApiUrl } from '@/utils/environment';\n\nconst wagmiConfig = wagmiBaseConfig;\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport type TxType = 'approval' | 'deposit' | 'withdraw' | 'settlement' | 'claim' | 'bet_lock' | 'bet_release' | 'post_root' | 'fee' | 'payout';\nexport type TxStatus = 'pending' | 'completed' | 'failed';\n\nexport interface TransactionLogPayload {\n  userId: string;\n  walletAddress: string;\n  txHash: string;\n  type: TxType;\n  status: TxStatus;\n  amount?: number;\n  error?: string;\n  predictionId?: string;\n  feeUSD?: number;\n  chainId?: number;\n  blockNumber?: number;\n  gasUsed?: number;\n}\n\nexport interface OnchainResult<T = unknown> {\n  success: boolean;\n  txHash?: Hash;\n  receipt?: T;\n  error?: string;\n  errorCode?: string;\n}\n\nexport type WalletReadyParams = {\n  address?: Address | null;\n  chainId?: number | null;\n  expectedChainId?: number;\n  isConnected?: boolean;\n  sessionHealthy?: boolean;\n};\n\n// ============================================================================\n// CUSTOM ERRORS\n// ============================================================================\n\nexport class WalletStateError extends Error {\n  code: string;\n  constructor(message: string, code: string) {\n    super(message);\n    this.name = 'WalletStateError';\n    this.code = code;\n  }\n}\n\nexport class AllowanceError extends Error {\n  requiredAmount: bigint;\n  actualAmount: bigint;\n  constructor(message: string, required: bigint, actual: bigint) {\n    super(message);\n    this.name = 'AllowanceError';\n    this.requiredAmount = required;\n    this.actualAmount = actual;\n  }\n}\n\nexport class SessionError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'SessionError';\n  }\n}\n\nexport class TransactionTimeoutError extends Error {\n  txHash?: string;\n  constructor(message: string, txHash?: string) {\n    super(message);\n    this.name = 'TransactionTimeoutError';\n    this.txHash = txHash;\n  }\n}\n\n// ============================================================================\n// ERROR PATTERN MATCHERS - COMPREHENSIVE (v6)\n// ============================================================================\n\nconst TRANSIENT_ERRORS = [\n  'network', 'timeout', 'connection', 'rpc', 'rate limit', 'too many requests',\n  'econnrefused', 'socket hang up', 'fetch failed', 'ethers-nofallback',\n  'failed to fetch', 'econnreset', 'etimedout', 'request failed',\n];\n\nconst USER_ACTION_ERRORS = [\n  'user rejected', 'user denied', 'rejected by user', 'user cancelled',\n  'action_rejected', 'user closed', 'request denied', 'request rejected',\n  'user refused', 'denied transaction', 'transaction declined', 'rejected the request',\n];\n\n// COMPREHENSIVE session error patterns - covers ALL WalletConnect edge cases\nconst SESSION_ERRORS = [\n  'no matching key', 'session topic', 'session not found', 'pairing topic',\n  'inactive session', 'expired session', 'session disconnected', 'missing session',\n  'getdefaultprovider', 'provider.request', 'wallet disconnected', 'walletconnect',\n  'topic not found', 'missing or invalid', 'proposal expired', 'wc_session',\n  'relay connection', 'socket hang up', 'ns sepolia', 'no provider',\n  'provider is undefined', 'disconnected from', 'please call connect() before request',\n  'client not initialized', 'pairing not found', 'session request timeout',\n  'peer disconnected', 'connection closed', 'request timeout', 'transport error',\n  'signerclient is undefined', 'provider not found', 'connector not connected',\n  'no signer available', 'chain mismatch', 'unsupported chain',\n];\n\n// ============================================================================\n// RPC CONFIGURATION - MULTIPLE FALLBACKS WITH ROTATION\n// ============================================================================\n\nconst RPC_ENDPOINTS = [\n  'https://sepolia.base.org',\n  'https://base-sepolia-rpc.publicnode.com',\n  'https://base-sepolia.blockpi.network/v1/rpc/public',\n] as const;\n\ntype RpcEndpoint = (typeof RPC_ENDPOINTS)[number];\n\nlet currentRpcIndex = 0;\n\nfunction getNextRpcEndpoint(): RpcEndpoint {\n  const index = currentRpcIndex % RPC_ENDPOINTS.length;\n  currentRpcIndex = (currentRpcIndex + 1) % RPC_ENDPOINTS.length;\n  return RPC_ENDPOINTS[index] ?? RPC_ENDPOINTS[0];\n}\n\nfunction getAllRpcEndpoints(): readonly RpcEndpoint[] {\n  return RPC_ENDPOINTS;\n}\n\n// ============================================================================\n// ERC20 ABI\n// ============================================================================\n\nconst ERC20_ABI = [\n  {\n    type: 'function',\n    name: 'allowance',\n    stateMutability: 'view',\n    inputs: [\n      { name: 'owner', type: 'address' },\n      { name: 'spender', type: 'address' }\n    ],\n    outputs: [{ type: 'uint256' }],\n  },\n  {\n    type: 'function',\n    name: 'approve',\n    stateMutability: 'nonpayable',\n    inputs: [\n      { name: 'spender', type: 'address' },\n      { name: 'amount', type: 'uint256' }\n    ],\n    outputs: [{ type: 'bool' }],\n  },\n  {\n    type: 'function',\n    name: 'balanceOf',\n    stateMutability: 'view',\n    inputs: [{ name: 'account', type: 'address' }],\n    outputs: [{ type: 'uint256' }],\n  },\n] as const;\n\n// ============================================================================\n// WALLET STATE VALIDATION\n// ============================================================================\n\nexport function ensureWalletReady(params: WalletReadyParams): void {\n  const { address, chainId, expectedChainId, isConnected, sessionHealthy } = params;\n  const targetChain = expectedChainId ?? baseSepolia.id;\n\n  if (!isConnected || !address) {\n    throw new WalletStateError(\n      'Wallet not connected. Please connect your wallet to continue.',\n      'WALLET_NOT_CONNECTED'\n    );\n  }\n\n  if (chainId !== targetChain) {\n    throw new WalletStateError(\n      'Wrong network. Please switch your wallet to Base Sepolia.',\n      'WRONG_NETWORK'\n    );\n  }\n\n  if (sessionHealthy === false) {\n    throw new WalletStateError(\n      'Wallet session expired. Please reconnect your wallet.',\n      'SESSION_UNHEALTHY'\n    );\n  }\n}\n\n// ============================================================================\n// ERROR DETECTION UTILITIES\n// ============================================================================\n\nexport function isTransientError(error: unknown): boolean {\n  const msg = String(error).toLowerCase();\n  return TRANSIENT_ERRORS.some(e => msg.includes(e));\n}\n\nexport function isUserRejection(error: unknown): boolean {\n  const msg = String(error).toLowerCase();\n  return USER_ACTION_ERRORS.some(e => msg.includes(e));\n}\n\nexport function isSessionError(error: unknown): boolean {\n  const msg = String(error).toLowerCase();\n  return SESSION_ERRORS.some(e => msg.includes(e));\n}\n\n// ============================================================================\n// ERROR PARSING - USER-FRIENDLY MESSAGES (v6 - Enhanced)\n// ============================================================================\n\nexport function parseOnchainError(error: unknown): { message: string; code: string } {\n  const errorStr = String(error).toLowerCase();\n  const errorMessage = error instanceof Error ? error.message : String(error);\n  \n  if (error instanceof WalletStateError) {\n    return { message: error.message, code: error.code };\n  }\n  \n  if (error instanceof AllowanceError) {\n    const requiredUSD = Number(error.requiredAmount) / 1_000_000;\n    const actualUSD = Number(error.actualAmount) / 1_000_000;\n    return { \n      message: `Approval not confirmed yet (need $${requiredUSD.toFixed(2)}, have $${actualUSD.toFixed(2)}). Please wait a moment and try again.`,\n      code: 'ALLOWANCE_VERIFICATION_FAILED'\n    };\n  }\n  \n  if (error instanceof SessionError) {\n    return { message: error.message, code: 'SESSION_EXPIRED' };\n  }\n  \n  if (error instanceof TransactionTimeoutError) {\n    return { \n      message: error.txHash \n        ? `Transaction timed out. Check status on BaseScan: ${error.txHash.slice(0, 10)}...`\n        : 'Transaction timed out. Please check your wallet and try again.',\n      code: 'TIMEOUT' \n    };\n  }\n  \n  if (isUserRejection(error)) {\n    return { message: 'Transaction cancelled', code: 'USER_REJECTED' };\n  }\n  \n  if (isSessionError(error)) {\n    return { message: 'Wallet session expired. Please reconnect your wallet.', code: 'SESSION_EXPIRED' };\n  }\n  \n  if (errorStr.includes('insufficient funds') || errorStr.includes('insufficient eth') || errorStr.includes('intrinsic gas too low')) {\n    return { message: 'Not enough ETH for gas fees. Please add ETH to your wallet on Base Sepolia.', code: 'INSUFFICIENT_GAS' };\n  }\n  \n  if (errorStr.includes('allowance') || errorStr.includes('erc20: transfer amount exceeds allowance') || errorStr.includes('transfer amount exceeds allowance')) {\n    return { message: 'Token approval not yet confirmed. Please wait a moment and try again.', code: 'INSUFFICIENT_ALLOWANCE' };\n  }\n  \n  if (errorStr.includes('insufficient balance') || errorStr.includes('exceeds balance') || errorStr.includes('transfer amount exceeds balance')) {\n    return { message: 'Insufficient USDC balance', code: 'INSUFFICIENT_BALANCE' };\n  }\n  \n  if (errorStr.includes('insufficient escrow') || errorStr.includes('not enough funds in escrow')) {\n    return { message: 'Insufficient funds in escrow account', code: 'INSUFFICIENT_ESCROW' };\n  }\n  \n  if (errorStr.includes('gas required exceeds allowance') || errorStr.includes('cannot estimate gas')) {\n    return { message: 'Transaction would fail. Check your balance and inputs.', code: 'GAS_ESTIMATION_FAILED' };\n  }\n  \n  if (isTransientError(error)) {\n    return { message: 'Network error. Please check your connection and try again.', code: 'NETWORK_ERROR' };\n  }\n  \n  if (errorStr.includes('revert') || errorStr.includes('execution reverted')) {\n    const revertMatch = errorMessage.match(/reason: (.+?)(?:\\n|$)/);\n    const shortReason = revertMatch?.[1] || 'Transaction reverted by contract';\n    return { message: shortReason.slice(0, 100), code: 'CONTRACT_REVERT' };\n  }\n  \n  if (errorStr.includes('simulation') || errorStr.includes('simulate')) {\n    return { message: 'Transaction simulation failed. Check your inputs.', code: 'SIMULATION_FAILED' };\n  }\n  \n  if (errorStr.includes('replacement') || errorStr.includes('nonce') || errorStr.includes('already known')) {\n    return { message: 'Transaction was replaced or dropped. Please try again.', code: 'TX_REPLACED' };\n  }\n  \n  if (errorStr.includes('timeout') || errorStr.includes('timed out')) {\n    return { message: 'Transaction timed out. Please check your wallet and blockchain explorer.', code: 'TIMEOUT' };\n  }\n  \n  const cleanMessage = errorMessage\n    .replace(/0x[a-fA-F0-9]{40,}/g, '[address]')\n    .replace(/\\n/g, ' ')\n    .slice(0, 120);\n  \n  return { message: cleanMessage || 'Transaction failed', code: 'UNKNOWN_ERROR' };\n}\n\n// ============================================================================\n// FRESH PUBLIC CLIENT CREATION - BYPASSES ALL CACHING\n// ============================================================================\n\nfunction createFreshPublicClient(rpcUrl?: RpcEndpoint) {\n  const endpoint = rpcUrl ?? RPC_ENDPOINTS[0];\n  return createPublicClient({\n    chain: baseSepolia,\n    transport: http(endpoint, {\n      batch: false, // No batching - immediate results\n      fetchOptions: {\n        cache: 'no-store', // Bypass HTTP cache completely\n      },\n      timeout: 30_000,\n      retryCount: 2,\n      retryDelay: 500,\n    }),\n  }) as ReturnType<typeof createPublicClient>;\n}\n\n// ============================================================================\n// TRANSACTION LOGGING - WITH GUARANTEED DELIVERY (v6)\n// ============================================================================\n\nconst FAILED_LOGS_STORAGE_KEY = 'fcz:failedTxLogs';\nconst MAX_STORED_LOGS = 100;\n\ninterface StoredLog extends TransactionLogPayload {\n  timestamp: string;\n  retryCount: number;\n}\n\nexport async function logTransaction(payload: TransactionLogPayload, retries = 3): Promise<boolean> {\n  const apiBase = getApiUrl();\n  const endpoint = `${apiBase}/api/wallet/log-transaction`;\n  for (let attempt = 1; attempt <= retries; attempt++) {\n    try {\n      console.log(`[FCZ-TX] Logging ${payload.type} tx: ${payload.txHash.slice(0, 10)}... (${payload.status}) - attempt ${attempt}`);\n      \n      const response = await fetch(endpoint, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          ...payload,\n          chainId: payload.chainId ?? baseSepolia.id,\n          timestamp: new Date().toISOString(),\n        }),\n      });\n      \n      if (response.ok) {\n        console.log(`[FCZ-TX]  Transaction logged: ${payload.txHash.slice(0, 10)}`);\n        return true;\n      }\n      \n      const errorText = await response.text().catch(() => 'Unknown error');\n      console.warn(`[FCZ-TX] Log response not ok: ${response.status} - ${errorText}, attempt ${attempt}/${retries}`);\n    } catch (err) {\n      console.warn(`[FCZ-TX] Failed to log transaction (attempt ${attempt}/${retries}):`, err);\n    }\n    \n    if (attempt < retries) {\n      await new Promise(resolve => setTimeout(resolve, 1000 * attempt));\n    }\n  }\n  \n  // Store failed log locally for later retry\n  storeFailedLog(payload);\n  return false;\n}\n\nfunction storeFailedLog(payload: TransactionLogPayload): void {\n  try {\n    const failedLogs: StoredLog[] = JSON.parse(localStorage.getItem(FAILED_LOGS_STORAGE_KEY) || '[]');\n    \n    // Check for duplicate\n    const existingLog = failedLogs.find(l => l.txHash === payload.txHash && l.status === payload.status);\n    if (existingLog) {\n      existingLog.retryCount++;\n      localStorage.setItem(FAILED_LOGS_STORAGE_KEY, JSON.stringify(failedLogs));\n      return;\n    }\n    \n    failedLogs.push({ \n      ...payload, \n      timestamp: new Date().toISOString(),\n      retryCount: 0,\n    });\n    \n    // Keep only the most recent logs\n    if (failedLogs.length > MAX_STORED_LOGS) {\n      failedLogs.splice(0, failedLogs.length - MAX_STORED_LOGS);\n    }\n    \n    localStorage.setItem(FAILED_LOGS_STORAGE_KEY, JSON.stringify(failedLogs));\n    console.log(`[FCZ-TX] Stored failed log locally for retry`);\n  } catch (err) {\n    console.warn('[FCZ-TX] Failed to store failed log:', err);\n  }\n}\n\nexport async function retryFailedTransactionLogs(): Promise<number> {\n  let successCount = 0;\n  try {\n    const failedLogs: StoredLog[] = JSON.parse(localStorage.getItem(FAILED_LOGS_STORAGE_KEY) || '[]');\n    if (failedLogs.length === 0) return 0;\n    \n    console.log(`[FCZ-TX] Retrying ${failedLogs.length} failed transaction logs...`);\n    \n    const remaining: StoredLog[] = [];\n    \n    for (const log of failedLogs) {\n      // Skip logs that have been retried too many times\n      if (log.retryCount >= 5) {\n        console.warn(`[FCZ-TX] Skipping log with too many retries: ${log.txHash.slice(0, 10)}`);\n        continue;\n      }\n      \n      const success = await logTransaction(log, 1);\n      if (success) {\n        successCount++;\n      } else {\n        remaining.push({ ...log, retryCount: log.retryCount + 1 });\n      }\n    }\n    \n    localStorage.setItem(FAILED_LOGS_STORAGE_KEY, JSON.stringify(remaining));\n    console.log(`[FCZ-TX] Retried failed logs: ${successCount} succeeded, ${remaining.length} remaining`);\n  } catch (err) {\n    console.warn('[FCZ-TX] Failed to retry logs:', err);\n  }\n  \n  return successCount;\n}\n\n// ============================================================================\n// DIRECT CHAIN READS - BYPASS ALL CACHING (v6 - Enhanced)\n// ============================================================================\n\n/**\n * Read allowance directly from chain with multi-RPC fallback\n * CRITICAL: This bypasses all caching to get accurate chain state\n */\nexport async function readAllowanceDirect(\n  tokenAddress: Address,\n  ownerAddress: Address,\n  spenderAddress: Address,\n  chainId: typeof baseSepolia.id = baseSepolia.id\n): Promise<bigint> {\n  let lastError: unknown = null;\n  \n  // Try each RPC endpoint\n  for (let i = 0; i < RPC_ENDPOINTS.length; i++) {\n    const rpcIndex = (currentRpcIndex + i) % RPC_ENDPOINTS.length;\n    const rpcEndpoint = RPC_ENDPOINTS[rpcIndex] ?? RPC_ENDPOINTS[0];\n    \n    try {\n      const freshClient = createFreshPublicClient(rpcEndpoint);\n      \n      const result = await freshClient.readContract({\n        address: tokenAddress,\n        abi: ERC20_ABI,\n        functionName: 'allowance',\n        args: [ownerAddress, spenderAddress],\n      });\n      \n      console.log('[FCZ-TX] Direct allowance read:', {\n        token: tokenAddress.slice(0, 10),\n        owner: ownerAddress.slice(0, 10),\n        spender: spenderAddress.slice(0, 10),\n        allowance: result.toString(),\n        rpc: rpcEndpoint.slice(0, 30),\n      });\n      \n      currentRpcIndex = (rpcIndex + 1) % RPC_ENDPOINTS.length;\n      return result as bigint;\n    } catch (err) {\n      lastError = err;\n      console.warn(`[FCZ-TX] Allowance read failed on ${rpcEndpoint?.slice(0, 30)}:`, err);\n    }\n  }\n  \n  // Final fallback to wagmi\n  try {\n    console.log('[FCZ-TX] Falling back to wagmi readContract for allowance...');\n    const result = await readContract(wagmiConfig, {\n      address: tokenAddress,\n      abi: ERC20_ABI,\n      functionName: 'allowance',\n      args: [ownerAddress, spenderAddress],\n      chainId,\n    });\n    return result as bigint;\n  } catch (fallbackErr) {\n    console.error('[FCZ-TX] All allowance reads failed:', fallbackErr);\n    return BigInt(0);\n  }\n}\n\n/**\n * Read token balance directly from chain\n */\nexport async function readBalanceDirect(\n  tokenAddress: Address,\n  accountAddress: Address,\n  chainId: typeof baseSepolia.id = baseSepolia.id\n): Promise<bigint> {\n  for (let i = 0; i < RPC_ENDPOINTS.length; i++) {\n    try {\n      const endpoint = RPC_ENDPOINTS[i] ?? RPC_ENDPOINTS[0];\n      const freshClient = createFreshPublicClient(endpoint);\n      \n      const result = await freshClient.readContract({\n        address: tokenAddress,\n        abi: ERC20_ABI,\n        functionName: 'balanceOf',\n        args: [accountAddress],\n      });\n      \n      return result as bigint;\n    } catch (err) {\n      const endpoint = RPC_ENDPOINTS[i] ?? RPC_ENDPOINTS[0];\n      console.warn(`[FCZ-TX] Balance read failed on ${endpoint}:`, err);\n    }\n  }\n  \n  try {\n    const result = await readContract(wagmiConfig, {\n      address: tokenAddress,\n      abi: ERC20_ABI,\n      functionName: 'balanceOf',\n      args: [accountAddress],\n      chainId,\n    });\n    return result as bigint;\n  } catch {\n    return BigInt(0);\n  }\n}\n\n// ============================================================================\n// ALLOWANCE VERIFICATION - ROBUST MULTI-RPC WITH HARD WAITS (v6)\n// ============================================================================\n\n/**\n * Wait for allowance to update with exponential backoff and multi-RPC verification\n * CRITICAL FIX v6: More robust waiting with longer timeouts and consecutive confirmations\n * \n * Strategy:\n * 1. Initial hard wait of 3 seconds after approval receipt\n * 2. Check across ALL RPC endpoints in parallel\n * 3. Require 3 consecutive successful checks before proceeding\n * 4. Use exponential backoff between check rounds\n */\nexport async function waitForAllowanceUpdate(\n  tokenAddress: Address,\n  ownerAddress: Address,\n  spenderAddress: Address,\n  requiredAmount: bigint,\n  options?: {\n    maxRetries?: number;\n    initialDelayMs?: number;\n    maxDelayMs?: number;\n    chainId?: typeof baseSepolia.id;\n    onProgress?: (attempt: number, current: bigint) => void;\n  }\n): Promise<boolean> {\n  const maxRetries = options?.maxRetries ?? 80; // More retries for better reliability\n  const initialDelay = options?.initialDelayMs ?? 500;\n  const maxDelay = options?.maxDelayMs ?? 5000;\n\n  console.log('[FCZ-TX] Waiting for allowance update...', {\n    required: requiredAmount.toString(),\n    requiredUSD: formatUnits(requiredAmount, 6),\n    maxRetries,\n    token: tokenAddress.slice(0, 10),\n    owner: ownerAddress.slice(0, 10),\n    spender: spenderAddress.slice(0, 10),\n  });\n\n  let lastAllowance = BigInt(0);\n  let consecutiveSuccesses = 0;\n  const REQUIRED_CONSECUTIVE_CONFIRMATIONS = 3; // Require 3 consecutive confirmations\n  \n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    // Exponential backoff with jitter\n    const delay = Math.min(initialDelay * Math.pow(1.12, attempt), maxDelay);\n    const jitter = Math.random() * 200;\n    \n    await new Promise(resolve => setTimeout(resolve, delay + jitter));\n\n    try {\n      // Rotate through RPC endpoints to get fresh data\n      const rpcIndex = attempt % RPC_ENDPOINTS.length;\n      const endpoint = RPC_ENDPOINTS[rpcIndex] ?? RPC_ENDPOINTS[0];\n      const freshClient = createFreshPublicClient(endpoint);\n      \n      const currentAllowance = await freshClient.readContract({\n        address: tokenAddress,\n        abi: ERC20_ABI,\n        functionName: 'allowance',\n        args: [ownerAddress, spenderAddress],\n      }) as bigint;\n\n      lastAllowance = currentAllowance;\n      \n      if (attempt % 10 === 0 || currentAllowance >= requiredAmount) {\n        console.log(`[FCZ-TX] Allowance check ${attempt + 1}/${maxRetries}:`, {\n          current: currentAllowance.toString(),\n          currentUSD: formatUnits(currentAllowance, 6),\n          required: requiredAmount.toString(),\n          sufficient: currentAllowance >= requiredAmount,\n          rpc: endpoint ? endpoint.slice(8, 30) : 'unknown',\n          consecutiveSuccesses,\n        });\n      }\n\n      options?.onProgress?.(attempt + 1, currentAllowance);\n\n      if (currentAllowance >= requiredAmount) {\n        consecutiveSuccesses++;\n        \n        if (consecutiveSuccesses >= REQUIRED_CONSECUTIVE_CONFIRMATIONS) {\n          console.log('[FCZ-TX]  Allowance confirmed with', consecutiveSuccesses, 'consecutive checks!');\n          return true;\n        }\n      } else {\n        consecutiveSuccesses = 0; // Reset if not sufficient\n      }\n    } catch (err) {\n      console.warn(`[FCZ-TX] Allowance check failed (attempt ${attempt + 1}):`, err);\n      consecutiveSuccesses = 0;\n    }\n  }\n\n  console.error('[FCZ-TX]  Allowance update timeout after', maxRetries, 'attempts. Last value:', lastAllowance.toString());\n  return false;\n}\n\n/**\n * Final verification of allowance before deposit - EXTRA SAFETY\n * Uses ALL RPCs in parallel and requires majority agreement\n */\nexport async function verifyAllowanceBeforeDeposit(\n  tokenAddress: Address,\n  ownerAddress: Address,\n  spenderAddress: Address,\n  requiredAmount: bigint,\n  maxAttempts: number = 9\n): Promise<{ verified: boolean; actualAllowance: bigint }> {\n  console.log('[FCZ-TX] Final allowance verification before deposit...');\n  \n  let highestAllowance = BigInt(0);\n  let successfulReads = 0;\n  const REQUIRED_SUCCESSFUL_READS = Math.ceil(maxAttempts / 2); // Majority required\n  \n  // Try all RPCs in parallel for faster verification\n  const rpcPromises = RPC_ENDPOINTS.map(async (endpoint) => {\n    try {\n      const freshClient = createFreshPublicClient(endpoint);\n      const allowance = await freshClient.readContract({\n        address: tokenAddress,\n        abi: ERC20_ABI,\n        functionName: 'allowance',\n        args: [ownerAddress, spenderAddress],\n      }) as bigint;\n      return { endpoint, allowance, success: true };\n    } catch (err) {\n      return { endpoint, allowance: BigInt(0), success: false, error: err };\n    }\n  });\n  \n  const results = await Promise.all(rpcPromises);\n  \n  for (const result of results) {\n    if (result.success) {\n      if (result.allowance > highestAllowance) {\n        highestAllowance = result.allowance;\n      }\n      if (result.allowance >= requiredAmount) {\n        successfulReads++;\n        console.log(`[FCZ-TX] Parallel verification:  PASS on ${result.endpoint.slice(8, 30)} (${formatUnits(result.allowance, 6)} USDC)`);\n      } else {\n        console.log(`[FCZ-TX] Parallel verification:  FAIL on ${result.endpoint.slice(8, 30)} (${formatUnits(result.allowance, 6)} < ${formatUnits(requiredAmount, 6)})`);\n      }\n    } else {\n      console.warn(`[FCZ-TX] Parallel verification: ERROR on ${result.endpoint.slice(8, 30)}`);\n    }\n  }\n  \n  // If parallel checks don't pass, do sequential retries\n  if (successfulReads < REQUIRED_SUCCESSFUL_READS) {\n    console.log('[FCZ-TX] Parallel verification incomplete, doing sequential retries...');\n    \n    for (let i = 0; i < maxAttempts - RPC_ENDPOINTS.length; i++) {\n      await new Promise(resolve => setTimeout(resolve, 500));\n      \n      try {\n        const rpcEndpoint = RPC_ENDPOINTS[i % RPC_ENDPOINTS.length];\n        const freshClient = createFreshPublicClient(rpcEndpoint);\n        \n        const allowance = await freshClient.readContract({\n          address: tokenAddress,\n          abi: ERC20_ABI,\n          functionName: 'allowance',\n          args: [ownerAddress, spenderAddress],\n        }) as bigint;\n        \n        if (allowance > highestAllowance) {\n          highestAllowance = allowance;\n        }\n        \n        if (allowance >= requiredAmount) {\n          successfulReads++;\n          console.log(`[FCZ-TX] Sequential verification ${i + 1}:  PASS (${formatUnits(allowance, 6)} USDC)`);\n          \n          if (successfulReads >= REQUIRED_SUCCESSFUL_READS) {\n            return { verified: true, actualAllowance: allowance };\n          }\n        }\n      } catch (err) {\n        console.warn(`[FCZ-TX] Sequential verification ${i + 1} failed:`, err);\n      }\n    }\n  }\n  \n  const verified = successfulReads >= REQUIRED_SUCCESSFUL_READS;\n  console.log(`[FCZ-TX] Final verification result: ${verified ? ' VERIFIED' : ' FAILED'} (${successfulReads}/${RPC_ENDPOINTS.length + maxAttempts - RPC_ENDPOINTS.length} checks passed)`);\n  \n  return { verified, actualAllowance: highestAllowance };\n}\n\n// ============================================================================\n// WALLETCONNECT SESSION CLEANUP - COMPREHENSIVE (v6)\n// ============================================================================\n\n/**\n * Clean up stale WalletConnect sessions from storage\n * AGGRESSIVE: Cleans ALL possible WC-related keys\n */\nexport function cleanupWalletConnectStorage(): number {\n  let removedCount = 0;\n  \n  try {\n    // Clear localStorage entries\n    const localKeysToRemove: string[] = [];\n    for (let i = 0; i < localStorage.length; i++) {\n      const key = localStorage.key(i);\n      if (key && (\n        key.startsWith('wc@2:') || \n        key.startsWith('wc@1:') || \n        key.startsWith('walletconnect') ||\n        key.startsWith('WALLETCONNECT') ||\n        key.includes('wc_session') ||\n        key.includes('@walletconnect') ||\n        key.startsWith('wc_') ||\n        key.includes('pairing') ||\n        key.includes('relay') ||\n        (key.includes('topic') && key.includes('wc')) ||\n        key.includes('wallet-connect') ||\n        // Also clean wagmi WC state\n        (key.includes('wagmi') && key.includes('walletConnect'))\n      )) {\n        localKeysToRemove.push(key);\n      }\n    }\n    \n    localKeysToRemove.forEach(key => {\n      try {\n        localStorage.removeItem(key);\n        removedCount++;\n      } catch {}\n    });\n\n    // Clear sessionStorage entries\n    const sessionKeysToRemove: string[] = [];\n    for (let i = 0; i < sessionStorage.length; i++) {\n      const key = sessionStorage.key(i);\n      if (key && (\n        key.startsWith('wc@2:') || \n        key.startsWith('wc@1:') || \n        key.startsWith('walletconnect') ||\n        key.includes('@walletconnect') ||\n        key.includes('wc_session')\n      )) {\n        sessionKeysToRemove.push(key);\n      }\n    }\n    \n    sessionKeysToRemove.forEach(key => {\n      try {\n        sessionStorage.removeItem(key);\n        removedCount++;\n      } catch {}\n    });\n\n    if (removedCount > 0) {\n      console.log(`[FCZ-TX] Cleaned ${removedCount} stale WalletConnect sessions`);\n    }\n  } catch (error) {\n    console.warn('[FCZ-TX] Error cleaning WalletConnect sessions:', error);\n  }\n  \n  return removedCount;\n}\n\n// ============================================================================\n// EVENT BROADCASTING\n// ============================================================================\n\nexport function broadcastBalanceRefresh(): void {\n  window.dispatchEvent(new CustomEvent('fcz:balance:refresh'));\n  console.log('[FCZ-TX] Balance refresh event dispatched');\n}\n\nexport function broadcastReconnectRequired(reason: string): void {\n  window.dispatchEvent(new CustomEvent('fcz:wallet:reconnect-required', {\n    detail: { reason }\n  }));\n  console.log('[FCZ-TX] Reconnect required event dispatched:', reason);\n}\n\nexport function broadcastTxUpdate(payload: { \n  txHash: string; \n  type: TxType; \n  status: TxStatus;\n  amount?: number;\n}): void {\n  window.dispatchEvent(new CustomEvent('fcz:tx:update', { detail: payload }));\n}\n\nexport function broadcastWalletError(error: { code: string; message: string }): void {\n  window.dispatchEvent(new CustomEvent('fcz:wallet:error', { detail: error }));\n}\n\n// ============================================================================\n// GLOBAL ERROR HANDLING\n// ============================================================================\n\nlet globalErrorHandlerInstalled = false;\n\nexport function setupGlobalWalletConnectErrorHandler(): () => void {\n  if (globalErrorHandlerInstalled) {\n    console.log('[FCZ-TX] Global error handler already installed, skipping');\n    return () => {};\n  }\n\n  // Use the shared hasPersistedWagmiConnection function defined above\n  \n  const handleUnhandledRejection = (event: PromiseRejectionEvent) => {\n    const reason = event.reason;\n    if (isSessionError(reason)) {\n      console.warn('[FCZ-TX] Caught unhandled WC rejection in global handler:', \n        reason?.message?.slice?.(0, 100) || reason);\n      event.preventDefault();\n      // IMPORTANT:\n      // Do NOT blindly clear WalletConnect storage while a real connection exists.\n      // This previously caused wallets to disconnect during page navigation when\n      // benign WC errors bubbled up. Only run aggressive cleanup when there is\n      // NO persisted wagmi connection (i.e. on cold-start / stale sessions).\n      if (!hasPersistedWagmiConnection()) {\n        cleanupWalletConnectStorage();\n      } else {\n        console.log('[FCZ-TX] Skipping WC storage cleanup  persisted wagmi connection detected');\n      }\n    }\n  };\n\n  const handleError = (event: ErrorEvent) => {\n    if (isSessionError(event.error)) {\n      console.warn('[FCZ-TX] Caught WC error in global handler');\n      event.preventDefault();\n      if (!hasPersistedWagmiConnection()) {\n        cleanupWalletConnectStorage();\n      } else {\n        console.log('[FCZ-TX] Skipping WC storage cleanup  persisted wagmi connection detected');\n      }\n    }\n  };\n\n  window.addEventListener('unhandledrejection', handleUnhandledRejection);\n  window.addEventListener('error', handleError);\n  \n  globalErrorHandlerInstalled = true;\n  console.log('[FCZ-TX] Global WalletConnect error handler installed');\n  \n  return () => {\n    window.removeEventListener('unhandledrejection', handleUnhandledRejection);\n    window.removeEventListener('error', handleError);\n    globalErrorHandlerInstalled = false;\n  };\n}\n\n// ============================================================================\n// SERVICE INITIALIZATION\n// ============================================================================\n\nconst BALANCE_QUERY_KEYS: ReadonlyArray<readonly unknown[]> = [\n  ['wallet'],\n  ['wallet', 'summary'],\n  ['escrow-balance'],\n  ['escrow-snapshot'],\n  ['unified-balance'],\n  ['usdcBalance'],\n  ['readContract'],\n  ['onchain-activity'],\n  ['allowance'],\n];\n\nlet serviceInitialized = false;\n\n/**\n * Check if wagmi has a valid persisted connection in localStorage\n * CRITICAL: Used to prevent cleanup when a valid connection exists\n * This prevents wallet disconnections on page reload\n */\nfunction hasPersistedWagmiConnection(): boolean {\n  if (typeof window === 'undefined') return false;\n  try {\n    const raw = localStorage.getItem('wagmi.store');\n    if (!raw) return false;\n    const parsed = JSON.parse(raw);\n    const connections = parsed?.state?.connections;\n    const current = parsed?.state?.current;\n    if (current && connections?.value?.length > 0) {\n      // Find the current connection entry and ensure it has accounts\n      const currentEntry = connections.value.find(\n        (entry: any) => Array.isArray(entry) && entry[0] === current,\n      );\n      if (currentEntry && currentEntry[1]?.accounts?.length > 0) {\n        return true;\n      }\n      // Fallback: any connection with accounts counts as \"persisted\"\n      return connections.value.some(\n        (entry: any) => Array.isArray(entry) && entry[1]?.accounts?.length > 0,\n      );\n    }\n  } catch {\n    // Ignore parse errors  treat as no persisted connection\n  }\n  return false;\n}\n\nexport function initializeOnchainService(): void {\n  if (serviceInitialized) {\n    return;\n  }\n  \n  setupGlobalWalletConnectErrorHandler();\n  retryFailedTransactionLogs();\n  \n  // CRITICAL FIX: Only cleanup if there's NO persisted connection\n  // This prevents disconnecting wallets on page reload\n  if (!hasPersistedWagmiConnection()) {\n    cleanupWalletConnectStorage();\n  }\n  \n  serviceInitialized = true;\n}\n\nexport function setupBalanceRefreshListener(queryClient?: QueryClient): () => void {\n  if (typeof window === 'undefined') return () => {};\n\n  const handler = () => {\n    try {\n      if (queryClient) {\n        BALANCE_QUERY_KEYS.forEach((key) => {\n          queryClient.invalidateQueries({ queryKey: key, exact: false }).catch((err) => {\n            console.warn('[FCZ-TX] Failed to invalidate query', key, err);\n          });\n        });\n      }\n    } catch (err) {\n      console.warn('[FCZ-TX] Balance refresh invalidation failed:', err);\n    }\n  };\n\n  window.addEventListener('fcz:balance:refresh', handler);\n  return () => window.removeEventListener('fcz:balance:refresh', handler);\n}\n\n// ============================================================================\n// UTILITY: Hard delay with logging\n// ============================================================================\n\nexport async function hardDelay(ms: number, reason: string): Promise<void> {\n  console.log(`[FCZ-TX] Hard delay: ${ms}ms - ${reason}`);\n  await new Promise(resolve => setTimeout(resolve, ms));\n}\n","/**\n * Query Invalidation Utilities\n * \n * Centralized query invalidation for preventing stale UI\n * Ensures all related queries are invalidated after mutations\n */\n\nimport { QueryClient } from '@tanstack/react-query';\nimport { QK } from '@/lib/queryKeys';\nimport { broadcastBalanceRefresh } from '@/services/onchainTransactionService';\n\n// All wallet-related query keys\nconst WALLET_QUERY_KEYS = [\n  ['wallet'],\n  ['escrow-balance'],\n  ['unified-balance'],\n  ['escrow-snapshot'],\n  ['readContract'],\n  ['onchain-usdc'],\n  ['usdcBalance'],\n  ['balance'],\n  ['allowance'],\n  ['escrow'],\n];\n\n// All activity-related query keys\nconst ACTIVITY_QUERY_KEYS = [\n  ['onchain-activity'],\n  ['wallet-activity'],\n  ['blockchain-transactions'],\n];\n\n// All prediction-related query keys (prefix)\nconst PREDICTION_QUERY_KEYS = [\n  ['prediction'],\n  ['prediction-activity'],\n  ['prediction-entries'],\n];\n\n// User-related query keys\nconst USER_QUERY_KEYS = [\n  ['user-entries'],\n  ['user-predictions'],\n];\n\n// Claim-related query keys\nconst CLAIM_QUERY_KEYS = [\n  ['claimable-claims'],\n  ['merkle-proof'],\n];\n\n/**\n * Invalidate all wallet-related queries after deposit/withdraw/bet\n */\nexport function invalidateWalletQueries(\n  queryClient: QueryClient,\n  options?: {\n    userId?: string;\n    predictionId?: string;\n    includeEscrow?: boolean;\n    includeActivity?: boolean;\n  }\n) {\n  const { userId, predictionId, includeEscrow = true, includeActivity = true } = options || {};\n\n  // Invalidate all wallet balance queries\n  WALLET_QUERY_KEYS.forEach(key => {\n    queryClient.invalidateQueries({ queryKey: key, exact: false });\n  });\n\n  // Invalidate activity queries\n  if (includeActivity && userId) {\n    queryClient.invalidateQueries({ queryKey: QK.walletActivity(userId) });\n    ACTIVITY_QUERY_KEYS.forEach(key => {\n      queryClient.invalidateQueries({ queryKey: key, exact: false });\n    });\n  }\n\n  // Invalidate escrow-related queries\n  if (includeEscrow && userId) {\n    queryClient.invalidateQueries({ queryKey: QK.escrowBalance(userId) });\n  }\n\n  // Invalidate prediction-related queries if predictionId provided\n  if (predictionId) {\n    queryClient.invalidateQueries({ queryKey: QK.prediction(predictionId) });\n    queryClient.invalidateQueries({ queryKey: QK.predictionEntries(predictionId) });\n    PREDICTION_QUERY_KEYS.forEach(key => {\n      queryClient.invalidateQueries({ queryKey: [...key, predictionId], exact: false });\n    });\n  }\n\n  // Invalidate user entries\n  if (userId) {\n    USER_QUERY_KEYS.forEach(key => {\n      queryClient.invalidateQueries({ queryKey: key, exact: false });\n    });\n  }\n}\n\n/**\n * Invalidate queries after deposit\n */\nexport function invalidateAfterDeposit(\n  queryClient: QueryClient,\n  options?: { userId?: string; txHash?: string }\n) {\n  invalidateWalletQueries(queryClient, {\n    userId: options?.userId,\n    includeEscrow: true,\n    includeActivity: true,\n  });\n\n  // Force refetch all wallet balances\n  queryClient.invalidateQueries({ queryKey: ['usdcBalance'] });\n  queryClient.invalidateQueries({ queryKey: ['escrow-balance'] });\n  queryClient.invalidateQueries({ queryKey: ['unified-balance'] });\n  queryClient.invalidateQueries({ queryKey: ['readContract'] });\n}\n\n/**\n * Invalidate queries after withdrawal\n */\nexport function invalidateAfterWithdraw(\n  queryClient: QueryClient,\n  options?: { userId?: string; txHash?: string }\n) {\n  invalidateWalletQueries(queryClient, {\n    userId: options?.userId,\n    includeEscrow: true,\n    includeActivity: true,\n  });\n\n  // Force refetch all wallet balances\n  queryClient.invalidateQueries({ queryKey: ['usdcBalance'] });\n  queryClient.invalidateQueries({ queryKey: ['escrow-balance'] });\n  queryClient.invalidateQueries({ queryKey: ['unified-balance'] });\n  queryClient.invalidateQueries({ queryKey: ['readContract'] });\n}\n\n/**\n * Invalidate queries after stake placement\n * CRITICAL: Must broadcast balance refresh to update UI immediately\n */\nexport function invalidateAfterBet(\n  queryClient: QueryClient,\n  options: { userId: string; predictionId: string }\n) {\n  invalidateWalletQueries(queryClient, {\n    userId: options.userId,\n    predictionId: options.predictionId,\n    includeEscrow: true,\n    includeActivity: true,\n  });\n\n  // Also invalidate prediction stats\n  queryClient.invalidateQueries({ queryKey: ['prediction-stats', options.predictionId] });\n  \n  // CRITICAL: Broadcast balance refresh to force immediate UI update\n  // The backend has updated escrow_locks, so we need to refetch wallet summary\n  broadcastBalanceRefresh();\n}\n\n/**\n * Invalidate queries after claim\n * PERFORMANCE FIX: More targeted invalidation, debounced refetch\n */\nlet claimInvalidationTimeout: ReturnType<typeof setTimeout> | null = null;\nexport function invalidateAfterClaim(\n  queryClient: QueryClient,\n  options?: { userId?: string; predictionId?: string }\n) {\n  // Invalidate wallet queries (non-blocking)\n  invalidateWalletQueries(queryClient, {\n    userId: options?.userId,\n    predictionId: options?.predictionId,\n    includeEscrow: true,\n    includeActivity: true,\n  });\n\n  // Invalidate claim-related queries (non-blocking)\n  CLAIM_QUERY_KEYS.forEach(key => {\n    queryClient.invalidateQueries({ queryKey: key, exact: false });\n  });\n\n  // Invalidate specific balance queries (non-blocking)\n  queryClient.invalidateQueries({ queryKey: ['usdcBalance'] });\n  queryClient.invalidateQueries({ queryKey: ['escrow-balance'] });\n  queryClient.invalidateQueries({ queryKey: ['unified-balance'] });\n  \n  // PERFORMANCE FIX: Debounce balance refresh to prevent UI blocking\n  // Clear any pending refresh\n  if (claimInvalidationTimeout) {\n    clearTimeout(claimInvalidationTimeout);\n  }\n  \n  // Schedule balance refresh after short delay (non-blocking)\n  claimInvalidationTimeout = setTimeout(() => {\n    // Only refetch critical balance queries\n    Promise.all([\n      queryClient.refetchQueries({ queryKey: ['usdcBalance'] }).catch(() => {}),\n      queryClient.refetchQueries({ queryKey: ['escrow-balance'] }).catch(() => {}),\n      queryClient.refetchQueries({ queryKey: ['unified-balance'] }).catch(() => {}),\n    ]).catch(() => {});\n    claimInvalidationTimeout = null;\n  }, 200); // 200ms debounce - fast enough for UX, slow enough to batch\n}\n\n/**\n * Invalidate queries after settlement\n */\nexport function invalidateAfterSettlement(\n  queryClient: QueryClient,\n  options?: { userId?: string; predictionId?: string }\n) {\n  invalidateWalletQueries(queryClient, {\n    userId: options?.userId,\n    predictionId: options?.predictionId,\n    includeEscrow: true,\n    includeActivity: true,\n  });\n\n  // Invalidate settlement-specific queries\n  if (options?.predictionId) {\n    queryClient.invalidateQueries({ queryKey: ['settlement', options.predictionId] });\n    queryClient.invalidateQueries({ queryKey: ['prediction', options.predictionId] });\n  }\n\n  // Invalidate all claim-related queries (users may now be able to claim)\n  CLAIM_QUERY_KEYS.forEach(key => {\n    queryClient.invalidateQueries({ queryKey: key, exact: false });\n  });\n}\n\n/**\n * Force refresh all wallet data (call after balance refresh event)\n * PERFORMANCE FIX: Non-blocking, debounced refetch\n */\nlet refreshTimeout: ReturnType<typeof setTimeout> | null = null;\nexport function forceRefreshAllWalletData(queryClient: QueryClient) {\n  // Invalidate all wallet-related queries (non-blocking)\n  WALLET_QUERY_KEYS.forEach(key => {\n    queryClient.invalidateQueries({ queryKey: key, exact: false });\n  });\n\n  // PERFORMANCE FIX: Debounce refetch to prevent UI blocking\n  // Clear any pending refetch\n  if (refreshTimeout) {\n    clearTimeout(refreshTimeout);\n  }\n  \n  // Schedule refetch after a short delay (non-blocking)\n  refreshTimeout = setTimeout(() => {\n    // Only refetch wallet-related queries, not ALL active queries\n    WALLET_QUERY_KEYS.forEach(key => {\n      queryClient.refetchQueries({ queryKey: key, exact: false }).catch(() => {});\n    });\n    refreshTimeout = null;\n  }, 300); // 300ms debounce\n}\n\n/**\n * Refetch queries on window focus (for stale UI prevention)\n * PERFORMANCE FIX: Debounced, non-blocking refetch\n */\nlet focusRefetchTimeout: ReturnType<typeof setTimeout> | null = null;\nexport function setupRefetchOnFocus(queryClient: QueryClient) {\n  if (typeof window === 'undefined') return;\n\n  const handleFocus = () => {\n    if (document.hasFocus()) {\n      // PERFORMANCE FIX: Debounce refetch to prevent UI blocking\n      if (focusRefetchTimeout) {\n        clearTimeout(focusRefetchTimeout);\n      }\n      \n      focusRefetchTimeout = setTimeout(() => {\n        // Only refetch stale queries, not all active queries\n        queryClient.refetchQueries({ \n          type: 'active',\n          stale: true // Only refetch stale queries\n        }).catch(() => {});\n        focusRefetchTimeout = null;\n      }, 500); // 500ms debounce\n    }\n  };\n\n  window.addEventListener('focus', handleFocus);\n  \n  return () => {\n    window.removeEventListener('focus', handleFocus);\n    if (focusRefetchTimeout) {\n      clearTimeout(focusRefetchTimeout);\n    }\n  };\n}\n\n/**\n * Setup listener for balance refresh events\n * PERFORMANCE FIX: Debounced to prevent spam\n */\nlet balanceRefreshTimeout: ReturnType<typeof setTimeout> | null = null;\nexport function setupBalanceRefreshListener(queryClient: QueryClient) {\n  if (typeof window === 'undefined') return;\n\n  const handleBalanceRefresh = () => {\n    // PERFORMANCE FIX: Debounce balance refresh to prevent UI blocking\n    if (balanceRefreshTimeout) {\n      clearTimeout(balanceRefreshTimeout);\n    }\n    \n    balanceRefreshTimeout = setTimeout(() => {\n      forceRefreshAllWalletData(queryClient);\n      balanceRefreshTimeout = null;\n    }, 100); // 100ms debounce - batch multiple events\n  };\n\n  window.addEventListener('fcz:balance:refresh', handleBalanceRefresh);\n  \n  return () => {\n    window.removeEventListener('fcz:balance:refresh', handleBalanceRefresh);\n    if (balanceRefreshTimeout) {\n      clearTimeout(balanceRefreshTimeout);\n    }\n  };\n}\n","/**\n * Web3Provider - Unified provider for all Web3/Wagmi functionality\n * \n * ENHANCED v9: \n * - FIXED: Wallet disconnect on page reload issue\n * - Explicit wagmi reconnect call on mount when persisted connection exists\n * - DEBOUNCED error handling to prevent duplicate messages\n * - Single source of truth for wallet errors\n * - No toast spam - UI components handle display\n * - Cleaner recovery flow\n * - IMPORTANT: Cleanup only runs when explicitly disconnected, NOT on page reload\n */\n\nimport React, { useEffect, useRef, useCallback, createContext, useContext, useState } from 'react';\nimport { WagmiProvider, useAccount, useDisconnect, useConnectors, useReconnect } from 'wagmi';\nimport { QueryClient, QueryClientProvider, useQueryClient } from '@tanstack/react-query';\nimport { config } from '../lib/wagmi';\nimport { initializeOnchainService, retryFailedTransactionLogs, setupBalanceRefreshListener } from '@/services/onchainTransactionService';\nimport { forceRefreshAllWalletData } from '@/utils/queryInvalidation';\n\n// Session error patterns that indicate stale/expired sessions\n// IMPORTANT: These patterns should be SPECIFIC to actual session failures\n// Avoid overly broad patterns that match normal WalletConnect operations\nconst SESSION_ERROR_PATTERNS = [\n  'no matching key',\n  'session topic doesn\\'t exist',\n  'session not found',\n  'pairing topic doesn\\'t exist',\n  'missing session',\n  'inactive session',\n  'session disconnected',\n  'expired session',\n  'please call connect() before request',\n  'client not initialized',\n  'pairing not found',\n  'session request timeout',\n  'peer disconnected',\n  'signerclient is undefined',\n  'provider not found',\n  'connector not connected',\n  'no signer available',\n];\n\n// Query keys to invalidate on session recovery\nconst WALLET_QUERY_KEYS = [\n  ['wallet'],\n  ['readContract'],\n  ['balance'],\n  ['allowance'],\n  ['escrow'],\n  ['usdcBalance'],\n  ['escrow-balance'],\n  ['unified-balance'],\n  ['escrow-snapshot'],\n  ['onchain-usdc'],\n  ['claimable-claims'],\n  ['merkle-proof'],\n  ['wallet-summary'],\n  ['onchain-activity'],\n];\n\n/**\n * Check if wagmi has a valid persisted connection in localStorage\n * This is used to determine if we should allow wagmi to reconnect\n */\nfunction hasPersistedWagmiConnection(): boolean {\n  try {\n    const wagmiStore = localStorage.getItem('wagmi.store');\n    if (!wagmiStore) return false;\n    \n    const parsed = JSON.parse(wagmiStore);\n    const connections = parsed?.state?.connections;\n    const current = parsed?.state?.current;\n    \n    if (!current || !connections?.value?.length) return false;\n    \n    // Check if there's an actual connection with accounts\n    for (const entry of connections.value) {\n      if (Array.isArray(entry) && entry[1]?.accounts?.length > 0) {\n        return true;\n      }\n    }\n    return false;\n  } catch {\n    return false;\n  }\n}\n\n// Recovery state management\ninterface Web3ContextState {\n  isRecovering: boolean;\n  lastRecoveryTime: number;\n  sessionHealthy: boolean;\n  lastError: { code: string; message: string } | null;\n  triggerRecovery: () => Promise<boolean>;\n  cleanupSessions: () => Promise<void>;\n  wrapWithRecovery: <T>(operation: () => Promise<T>, options?: { maxRetries?: number }) => Promise<T>;\n  clearLastError: () => void;\n}\n\nconst Web3Context = createContext<Web3ContextState | null>(null);\n\nexport function useWeb3Recovery() {\n  const context = useContext(Web3Context);\n  if (!context) {\n    throw new Error('useWeb3Recovery must be used within Web3Provider');\n  }\n  return context;\n}\n\n// Query client configuration optimized for Web3\n// PERFORMANCE FIX: Added better default caching settings\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      staleTime: 1000 * 30, // 30 seconds\n      gcTime: 1000 * 60 * 2, // 2 minutes\n      refetchOnWindowFocus: false, // Reduce unnecessary refetches\n      retry: (failureCount, error) => {\n        const errorStr = String(error).toLowerCase();\n        if (SESSION_ERROR_PATTERNS.some(p => errorStr.includes(p))) {\n          return false;\n        }\n        return failureCount < 2;\n      },\n    },\n  },\n});\n\n// Inner provider that has access to wagmi hooks\nfunction Web3ProviderInner({ children }: { children: React.ReactNode }) {\n  const { address, connector, isConnected, isConnecting, isReconnecting, status } = useAccount();\n  const { disconnect } = useDisconnect();\n  const { reconnect, isPending: isReconnectPending } = useReconnect();\n  const connectors = useConnectors();\n  const queryClient = useQueryClient();\n  \n  const [isRecovering, setIsRecovering] = useState(false);\n  const [lastRecoveryTime, setLastRecoveryTime] = useState(0);\n  const [sessionHealthy, setSessionHealthy] = useState(true);\n  const [lastError, setLastError] = useState<{ code: string; message: string } | null>(null);\n  \n  const recoveryLockRef = useRef(false);\n  const mountedRef = useRef(true);\n  const initializedRef = useRef(false);\n  const reconnectAttemptedRef = useRef(false);\n  \n  // Track latest connection state for cleanup timeout (prevents stale closures)\n  const connectionStateRef = useRef({ isConnected, isConnecting, isReconnecting, status, address });\n\n  // Keep connection state ref up to date (for cleanup timeout)\n  useEffect(() => {\n    connectionStateRef.current = { isConnected, isConnecting, isReconnecting, status, address };\n  }, [isConnected, isConnecting, isReconnecting, status, address]);\n\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => { mountedRef.current = false; };\n  }, []);\n\n  const clearLastError = useCallback(() => {\n    setLastError(null);\n  }, []);\n\n  /**\n   * CRITICAL FIX v9: Trigger wagmi reconnect on mount if persisted connection exists\n   * This ensures the wallet reconnects after page reload\n   */\n  useEffect(() => {\n    if (!initializedRef.current) {\n      initializedRef.current = true;\n      \n      // Initialize on-chain service\n      try {\n        initializeOnchainService();\n      } catch (err) {\n        if (import.meta.env.DEV) console.warn('[Web3] Failed to initialize on-chain service:', err);\n      }\n      \n      retryFailedTransactionLogs().catch(() => {});\n      \n      // CRITICAL FIX: Check for persisted connection and trigger reconnect if needed\n      // IMPORTANT: Do NOT run cleanup when there's a persisted connection - let wagmi handle reconnection\n      const hasPersisted = hasPersistedWagmiConnection();\n      if (hasPersisted && !isConnected && !isConnecting && !isReconnecting && !reconnectAttemptedRef.current) {\n        reconnectAttemptedRef.current = true;\n        // Small delay to let wagmi initialize fully before attempting reconnect\n        setTimeout(() => {\n          try {\n            reconnect();\n          } catch (e) {\n            // Silently fail - wagmi will handle reconnection on its own\n          }\n        }, 200);\n      }\n    }\n  }, [isConnected, isConnecting, isReconnecting, reconnect]);\n\n  /**\n   * Setup balance refresh listener\n   */\n  useEffect(() => {\n    const cleanup = setupBalanceRefreshListener(queryClient);\n    return cleanup;\n  }, [queryClient]);\n\n  /**\n   * Check if an error indicates a stale session\n   */\n  const isSessionError = useCallback((error: unknown): boolean => {\n    if (!error) return false;\n    const errorMsg = String(error).toLowerCase();\n    return SESSION_ERROR_PATTERNS.some(pattern => errorMsg.includes(pattern));\n  }, []);\n\n  /**\n   * Clean up all WalletConnect sessions - COMPREHENSIVE\n   */\n  const cleanupSessions = useCallback(async () => {\n    \n    try {\n      const wcConnector = connectors.find(c => c.id === 'walletConnect');\n      if (wcConnector) {\n        try {\n          const provider = await wcConnector.getProvider().catch(() => null);\n          if (provider && typeof (provider as any).disconnect === 'function') {\n            await (provider as any).disconnect().catch(() => {});\n          }\n        } catch (e) {\n          // Ignore - just trying to clean up\n        }\n      }\n\n      // Clear all WC-related localStorage entries\n      // IMPORTANT: DO NOT remove 'wagmi.store' - it contains connection state!\n      const keysToRemove: string[] = [];\n      for (let i = 0; i < localStorage.length; i++) {\n        const key = localStorage.key(i);\n        if (!key) continue;\n        \n        // Skip the main wagmi store - this holds connection state\n        if (key === 'wagmi.store') continue;\n        \n        // Only remove WalletConnect-specific session data\n        if (\n          key.startsWith('wc@2:') ||\n          key.startsWith('wc@1:') ||\n          key.startsWith('walletconnect') ||\n          key.startsWith('WALLETCONNECT') ||\n          key.includes('wc_session') ||\n          key.includes('@walletconnect') ||\n          key.startsWith('wc_') ||\n          (key.includes('pairing') && key.includes('wc')) ||\n          (key.includes('relay') && key.includes('wc')) ||\n          (key.includes('topic') && key.includes('wc')) ||\n          key.includes('wallet-connect')\n        ) {\n          keysToRemove.push(key);\n        }\n      }\n      \n      keysToRemove.forEach(key => {\n        try { localStorage.removeItem(key); } catch {}\n      });\n\n      // Also clear sessionStorage\n      const sessionKeysToRemove: string[] = [];\n      for (let i = 0; i < sessionStorage.length; i++) {\n        const key = sessionStorage.key(i);\n        if (key && (\n          key.startsWith('wc@2:') ||\n          key.startsWith('wc@1:') ||\n          key.startsWith('walletconnect') ||\n          key.includes('@walletconnect') ||\n          key.includes('wc_session')\n        )) {\n          sessionKeysToRemove.push(key);\n        }\n      }\n      sessionKeysToRemove.forEach(key => {\n        try { sessionStorage.removeItem(key); } catch {}\n      });\n\n    } catch (error) {\n      // Cleanup errors are non-critical, ignore silently\n    }\n  }, [connectors]);\n\n  /**\n   * Trigger full session recovery - NO TOASTS (let UI handle display)\n   * CRITICAL FIX: Do NOT run cleanup if there's a persisted connection - let wagmi reconnect naturally\n   */\n  const triggerRecovery = useCallback(async (): Promise<boolean> => {\n    const now = Date.now();\n    if (now - lastRecoveryTime < 3000 || recoveryLockRef.current) {\n      return false;\n    }\n\n    // CRITICAL: Check if there's a persisted connection - if so, don't cleanup, let wagmi reconnect\n    const hasPersisted = hasPersistedWagmiConnection();\n    if (hasPersisted && (isConnecting || isReconnecting)) {\n      // Wagmi is already reconnecting - don't interfere\n      return false;\n    }\n\n    recoveryLockRef.current = true;\n    setIsRecovering(true);\n    setLastRecoveryTime(now);\n\n    try {\n      /**\n       * IMPORTANT UX FIX:\n       * Do NOT automatically disconnect users during \"recovery\".\n       * Some WalletConnect/session errors are transient (relay hiccups, mobile backgrounding),\n       * and auto-disconnecting causes the \"wallet disconnects after some time\" issue.\n       *\n       * Recovery should primarily:\n       * - invalidate/remove queries that may be stuck\n       * - mark the session unhealthy so UI can prompt a reconnect\n       *\n       * Cleanup/disconnect should happen only when:\n       * - user explicitly disconnects, OR\n       * - we can positively detect there is NO persisted session AND wallet is already disconnected.\n       */\n      if (!hasPersisted && !isConnected && !isConnecting && !isReconnecting) {\n        await cleanupSessions();\n      }\n\n      await new Promise(resolve => setTimeout(resolve, 300));\n\n      WALLET_QUERY_KEYS.forEach(key => {\n        queryClient.removeQueries({ queryKey: key, exact: false });\n      });\n\n      // Broadcast reconnect event (UI listens for this)\n      window.dispatchEvent(new CustomEvent('fcz:wallet:reconnect-required', {\n        detail: { reason: 'Wallet session expired' }\n      }));\n\n      setSessionHealthy(false); // Mark as unhealthy until reconnected\n\n      return true;\n    } catch (error) {\n      setSessionHealthy(false);\n      return false;\n    } finally {\n      recoveryLockRef.current = false;\n      if (mountedRef.current) {\n        setIsRecovering(false);\n      }\n    }\n  }, [cleanupSessions, isConnected, isConnecting, isReconnecting, lastRecoveryTime, queryClient]);\n\n  /**\n   * Wrap an async operation with automatic recovery on session errors\n   */\n  const wrapWithRecovery = useCallback(<T,>(\n    operation: () => Promise<T>,\n    options?: { maxRetries?: number; retryDelay?: number; operationTimeoutMs?: number }\n  ): Promise<T> => {\n    const exec = async () => {\n      const maxRetries = options?.maxRetries ?? 1;\n      const retryDelay = options?.retryDelay ?? 1000;\n      const operationTimeoutMs = options?.operationTimeoutMs ?? 60_000;\n      let lastError: unknown = null;\n\n      for (let attempt = 0; attempt <= maxRetries; attempt++) {\n        try {\n          const opPromise = operation();\n          const timeoutPromise = new Promise<never>((_, reject) => {\n            setTimeout(() => {\n              reject(new Error('Wallet operation timed out. Please try again.'));\n            }, operationTimeoutMs);\n          });\n          \n          return await Promise.race([opPromise, timeoutPromise]);\n        } catch (error) {\n          lastError = error;\n\n          const isTimeoutError = error instanceof Error && \n            error.message.toLowerCase().includes('timed out');\n\n          if (isSessionError(error) || isTimeoutError) {\n            const recovered = await triggerRecovery();\n\n            if (recovered && attempt < maxRetries) {\n              await new Promise(resolve => setTimeout(resolve, retryDelay));\n              continue;\n            }\n          }\n\n          throw error;\n        }\n      }\n\n      throw lastError;\n    };\n\n    return exec();\n  }, [isSessionError, triggerRecovery]);\n\n  /**\n   * Listen for balance refresh events\n   */\n  useEffect(() => {\n    const handleBalanceRefresh = () => {\n      forceRefreshAllWalletData(queryClient);\n    };\n\n    window.addEventListener('fcz:balance:refresh', handleBalanceRefresh);\n    \n    return () => {\n      window.removeEventListener('fcz:balance:refresh', handleBalanceRefresh);\n    };\n  }, [queryClient]);\n\n  /**\n   * When connection becomes healthy again, reset state\n   */\n  useEffect(() => {\n    if (isConnected && address) {\n      setSessionHealthy(true);\n      setLastError(null);\n      reconnectAttemptedRef.current = false; // Reset for next page load\n    }\n  }, [isConnected, address]);\n\n  const contextValue: Web3ContextState = {\n    isRecovering,\n    lastRecoveryTime,\n    sessionHealthy,\n    lastError,\n    triggerRecovery,\n    cleanupSessions,\n    wrapWithRecovery,\n    clearLastError,\n  };\n\n  return (\n    <Web3Context.Provider value={contextValue}>\n      {children}\n    </Web3Context.Provider>\n  );\n}\n\n// Main provider export\nexport function Web3Provider({ children }: { children: React.ReactNode }) {\n  return (\n    <WagmiProvider config={config}>\n      <QueryClientProvider client={queryClient}>\n        <Web3ProviderInner>\n          {children}\n        </Web3ProviderInner>\n      </QueryClientProvider>\n    </WagmiProvider>\n  );\n}\n\nexport default Web3Provider;\n","/**\n * [PERF] Web Vitals Logger\n * \n * Reports Core Web Vitals metrics:\n * - FCP (First Contentful Paint)\n * - LCP (Largest Contentful Paint)\n * - CLS (Cumulative Layout Shift)\n * - INP (Interaction to Next Paint - replaces FID)\n * - TTFB (Time to First Byte)\n * \n * DEV: Logs to console\n * PROD: Reports to Sentry with configurable sample rate\n * \n * @see https://web.dev/vitals/\n */\n\ntype MetricName = 'FCP' | 'LCP' | 'CLS' | 'INP' | 'TTFB';\n\ninterface WebVitalMetric {\n  name: MetricName;\n  value: number;\n  rating: 'good' | 'needs-improvement' | 'poor';\n  delta: number;\n  id: string;\n  navigationType: string;\n}\n\n// [PERF] Thresholds per Google's Core Web Vitals recommendations\nconst THRESHOLDS: Record<MetricName, { good: number; poor: number }> = {\n  FCP: { good: 1800, poor: 3000 },\n  LCP: { good: 2500, poor: 4000 },\n  CLS: { good: 0.1, poor: 0.25 },\n  INP: { good: 200, poor: 500 },\n  TTFB: { good: 800, poor: 1800 },\n};\n\nfunction getRating(name: MetricName, value: number): 'good' | 'needs-improvement' | 'poor' {\n  const threshold = THRESHOLDS[name];\n  if (value <= threshold.good) return 'good';\n  if (value <= threshold.poor) return 'needs-improvement';\n  return 'poor';\n}\n\n// [PERF] Check if we should sample this session (controlled by env)\nfunction shouldSample(): boolean {\n  const sampleRate = parseFloat(import.meta.env.VITE_WEB_VITALS_SAMPLE || '0.05');\n  return Math.random() < sampleRate;\n}\n\n// [PERF] Log metric to console in development\nfunction logToConsole(metric: WebVitalMetric): void {\n  const emoji = metric.rating === 'good' ? '' : metric.rating === 'needs-improvement' ? '' : '';\n  const color = metric.rating === 'good' ? 'color: green' : metric.rating === 'needs-improvement' ? 'color: orange' : 'color: red';\n  \n  console.log(\n    `%c[PERF] ${emoji} ${metric.name}: ${metric.value.toFixed(2)}${metric.name === 'CLS' ? '' : 'ms'} (${metric.rating})`,\n    color\n  );\n}\n\n// [PERF] Report metric to Sentry\nfunction reportToSentry(metric: WebVitalMetric): void {\n  // Only report if Sentry is available\n  if (typeof window !== 'undefined' && (window as any).Sentry) {\n    const Sentry = (window as any).Sentry;\n    \n    // Add breadcrumb for context\n    Sentry.addBreadcrumb({\n      category: 'web-vital',\n      message: `${metric.name}: ${metric.value.toFixed(2)}`,\n      level: metric.rating === 'poor' ? 'warning' : 'info',\n      data: {\n        rating: metric.rating,\n        value: metric.value,\n        delta: metric.delta,\n        navigationType: metric.navigationType,\n      },\n    });\n\n    // For poor metrics, create a measurement\n    if (metric.rating === 'poor') {\n      Sentry.setMeasurement(metric.name, metric.value, metric.name === 'CLS' ? '' : 'millisecond');\n    }\n  }\n}\n\n// [PERF] Handle incoming web vital metric\nfunction handleMetric(metric: { name: string; value: number; delta: number; id: string; navigationType?: string }): void {\n  const name = metric.name as MetricName;\n  const rating = getRating(name, metric.value);\n  \n  const webVitalMetric: WebVitalMetric = {\n    name,\n    value: metric.value,\n    rating,\n    delta: metric.delta,\n    id: metric.id,\n    navigationType: metric.navigationType || 'unknown',\n  };\n\n  // Always log in development\n  if (import.meta.env.DEV) {\n    logToConsole(webVitalMetric);\n    return;\n  }\n\n  // In production, check sample rate\n  if (shouldSample()) {\n    reportToSentry(webVitalMetric);\n  }\n}\n\n/**\n * [PERF] Initialize Web Vitals reporting\n * \n * Call this function once in main.tsx after the app mounts.\n * Uses dynamic import to keep the web-vitals library out of the main bundle.\n */\nexport async function initWebVitals(): Promise<void> {\n  // [PERF] Guard: only initialize in browser environment\n  if (typeof window === 'undefined') return;\n\n  try {\n    // [PERF] Dynamic import to avoid bundle bloat\n    const { onFCP, onLCP, onCLS, onINP, onTTFB } = await import('web-vitals');\n\n    // [PERF] Register handlers for each metric\n    onFCP(handleMetric);\n    onLCP(handleMetric);\n    onCLS(handleMetric);\n    onINP(handleMetric);\n    onTTFB(handleMetric);\n\n    if (import.meta.env.DEV) {\n      console.log('[PERF] Web Vitals monitoring initialized');\n    }\n  } catch (err) {\n    // [PERF] Silently fail - don't break the app for metrics\n    if (import.meta.env.DEV) {\n      console.warn('[PERF] Failed to initialize Web Vitals:', err);\n    }\n  }\n}\n\n/**\n * [PERF] Manually report a custom performance mark\n * \n * Useful for tracking specific interactions like:\n * - Route transitions\n * - Wallet updates\n * - Modal open/close\n */\nexport function reportCustomMark(name: string, startMark?: string): void {\n  if (typeof window === 'undefined' || typeof performance === 'undefined') return;\n\n  try {\n    if (startMark) {\n      // [PERF] Measure from a previous mark\n      performance.measure(name, startMark);\n      const entries = performance.getEntriesByName(name, 'measure');\n      const latest = entries[entries.length - 1];\n      \n      if (latest && import.meta.env.DEV) {\n        console.log(`[PERF]  ${name}: ${latest.duration.toFixed(2)}ms`);\n      }\n    } else {\n      // [PERF] Just create a mark for later measurement\n      performance.mark(name);\n    }\n  } catch (err) {\n    // Silently fail\n  }\n}\n\nexport default initWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport { BrowserRouter } from 'react-router-dom'\nimport App from './App.tsx'\nimport LandingRouter from './landing/LandingRouter'\nimport ErrorBoundary from './components/ErrorBoundary.tsx'\nimport { NetworkStatusProvider } from './providers/NetworkStatusProvider'\nimport { SupabaseProvider } from './providers/SupabaseProvider'\nimport { AuthSessionProvider } from './providers/AuthSessionProvider'\nimport { ErrorHandlingProvider } from './components/ErrorHandlingProvider'\nimport { Web3Provider } from './providers/Web3Provider'\nimport './index.css'\nimport { APP_VERSION, BUILD_TIMESTAMP } from './lib/version.ts'\n// [PERF] Web Vitals monitoring\nimport { initWebVitals } from './lib/vitals'\nimport { useMaintenanceStore } from './store/maintenanceStore'\n\n// Centralized version management\nconsole.log(` Fan Club Z ${APP_VERSION} - CONSOLIDATED ARCHITECTURE - SINGLE SOURCE OF TRUTH`)\n\n// CRITICAL: Disable browser's native scroll restoration to prevent conflicts with our manual scroll management\n// This is essential for React SPA navigation to work correctly\nif ('scrollRestoration' in history) {\n  history.scrollRestoration = 'manual';\n}\n\n// Global fetch wrapper: detect maintenance-mode 503 responses and show UX\nif (typeof window !== 'undefined' && typeof window.fetch === 'function') {\n  const originalFetch = window.fetch.bind(window);\n  window.fetch = (async (...args: Parameters<typeof fetch>) => {\n    const res = await originalFetch(...args);\n\n    try {\n      // Clear maintenance when API comes back\n      if (res.ok && useMaintenanceStore.getState().active) {\n        useMaintenanceStore.getState().clear();\n      }\n\n      if (res.status === 503) {\n        const ct = res.headers.get('content-type') || '';\n        if (ct.includes('application/json')) {\n          const cloned = res.clone();\n          const data = await cloned.json().catch(() => null);\n          if (data?.maintenance) {\n            useMaintenanceStore\n              .getState()\n              .setMaintenance(String(data?.message || 'The platform is currently under maintenance. Please check back soon.'));\n          }\n        }\n      }\n    } catch {\n      // Never block fetch() if maintenance detection fails\n    }\n\n    return res;\n  }) as any;\n}\n\nconst isLandingBuild = import.meta.env.VITE_BUILD_TARGET === 'landing';\nconst RootComponent = isLandingBuild ? LandingRouter : App;\n\n// Note: Global error handlers are now managed by Web3Provider for WalletConnect errors\n// This provides coordinated error handling with automatic session recovery\n\n// CRITICAL: Global handler for dynamic module loading errors (stale Vercel chunks)\n// These occur when Vercel deploys new code but the browser has cached old chunk references\nwindow.addEventListener('error', (event) => {\n  const isModuleLoadError = \n    event.message?.includes('Failed to fetch dynamically imported module') ||\n    event.message?.includes('Failed to load module script') ||\n    event.message?.includes('Loading chunk') ||\n    event.filename?.includes('assets/') && event.message?.includes('MIME type');\n  \n  if (isModuleLoadError) {\n    console.warn(' [GLOBAL] Module loading error detected - triggering hard reload');\n    event.preventDefault();\n    // Clear caches and reload\n    if ('caches' in window) {\n      caches.keys().then(names => names.forEach(name => caches.delete(name)));\n    }\n    window.location.reload();\n  }\n});\n\nwindow.addEventListener('unhandledrejection', (event) => {\n  const reason = event.reason?.message || String(event.reason);\n  const isModuleLoadError = \n    reason.includes('Failed to fetch dynamically imported module') ||\n    reason.includes('Failed to load module script') ||\n    reason.includes('Loading chunk');\n  \n  if (isModuleLoadError) {\n    console.warn(' [GLOBAL] Unhandled module loading rejection - triggering hard reload');\n    event.preventDefault();\n    if ('caches' in window) {\n      caches.keys().then(names => names.forEach(name => caches.delete(name)));\n    }\n    window.location.reload();\n  }\n});\n\n// Conditionally wrap Web3Provider - only needed for app build, not landing/admin\nconst AppContent = isLandingBuild ? (\n  <React.StrictMode>\n    <ErrorBoundary\n      onError={(error, errorInfo) => {\n        if (import.meta.env.DEV) {\n          console.error('React Error Boundary triggered:', error, errorInfo);\n        }\n        // You can add error reporting service here (e.g., Sentry)\n      }}\n    >\n      <ErrorHandlingProvider>\n        <NetworkStatusProvider>\n          <SupabaseProvider>\n            <AuthSessionProvider>\n              <BrowserRouter>\n                <RootComponent />\n              </BrowserRouter>\n            </AuthSessionProvider>\n          </SupabaseProvider>\n        </NetworkStatusProvider>\n      </ErrorHandlingProvider>\n    </ErrorBoundary>\n  </React.StrictMode>\n) : (\n  <React.StrictMode>\n    <Web3Provider>\n      <ErrorBoundary\n        onError={(error, errorInfo) => {\n          if (import.meta.env.DEV) {\n            console.error('React Error Boundary triggered:', error, errorInfo);\n          }\n          // You can add error reporting service here (e.g., Sentry)\n        }}\n      >\n        <ErrorHandlingProvider>\n          <NetworkStatusProvider>\n            <SupabaseProvider>\n              <AuthSessionProvider>\n                <BrowserRouter>\n                  <RootComponent />\n                </BrowserRouter>\n              </AuthSessionProvider>\n            </SupabaseProvider>\n          </NetworkStatusProvider>\n        </ErrorHandlingProvider>\n      </ErrorBoundary>\n    </Web3Provider>\n  </React.StrictMode>\n);\n\nReactDOM.createRoot(document.getElementById('root')!).render(AppContent);\n\nconsole.log(` Fan Club Z ${APP_VERSION} - Application started successfully`);\nconsole.log(' Build timestamp:', BUILD_TIMESTAMP);\n\n// [PERF] Initialize Web Vitals monitoring after app mounts\ninitWebVitals();\n"],"file":"assets/index-78beacc5.js"}