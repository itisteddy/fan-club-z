import{j as e}from"./ui-6244b3df.js";import{r as i,R as se}from"./vendor-499a370b.js";import{f as F,p as ae,u as h,b as re,q as N,l as T,U as le,o as ie,X as ce,D as b,T as ne}from"./index-6112b649.js";import{U as de}from"./UserAvatar-b4225c28.js";import{A as O}from"./AppHeader-78d14113.js";import{d as oe,e as xe,b as o,c as z}from"./format-ae98e2f4.js";import{b as me}from"./useActivityFeed-5b825cb0.js";import{A as p}from"./activity-3ea54dab.js";import{P as ge}from"./pen-line-d6794a46.js";import"./utils-17ec81d9.js";import"./utils-a40dfe8b.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=F("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=F("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ee=({onNavigateBack:be,userId:f})=>{const{user:v}=ae(),{user:V,isAuthenticated:q}=h(),{getUserPredictionEntries:D,getUserCreatedPredictions:I,fetchUserPredictionEntries:w,fetchUserCreatedPredictions:k}=re(),[H,C]=i.useState(!0),[W,A]=i.useState(!1),[Y,g]=i.useState(!1),[pe,G]=i.useState(!1),[P,S]=i.useState(""),[U,E]=i.useState(""),[_,B]=i.useState(""),r=v||V,c=!!v||q,X=!f||f===r?.id,a=r;i.useEffect(()=>{c&&r?.id?C(!1):c||C(!1)},[c,r?.id]),i.useEffect(()=>{c&&r?.id&&(w(r.id),k(r.id))},[c,r?.id,w,k]);const M=f??r?.id??"",{items:x,loading:R}=me(M,{limit:50,autoLoad:!!M}),n=D(r?.id||"")||[],$=I(r?.id||"")||[],d=n.filter(t=>t?.status==="won"||t?.status==="lost"),u=n.filter(t=>t?.status==="won"),J=n.reduce((t,s)=>t+(s?.amount||0),0),K=u.reduce((t,s)=>t+(s?.actual_payout||0),0),Q=d.length>0?Math.round(u.length/d.length*100):0,y=K-J,j=x.slice(0,5),Z=R&&x.length===0,L=t=>{switch(t.type){case"entry.create":case"bet_placed":return{iconBg:"bg-blue-100",icon:e.jsx(N,{className:"w-4 h-4 text-blue-600"}),title:t.predictionTitle?`Bet on ${t.predictionTitle}`:"Bet placed",subtitle:t.data?.option_label?`Option: ${t.data.option_label}`:"",amount:t.data?.amount?o(Number(t.data.amount),{compact:!0}):null,badge:"placed",badgeColor:"text-blue-600"};case"prediction.created":return{iconBg:"bg-purple-100",icon:e.jsx(ne,{className:"w-4 h-4 text-purple-600"}),title:t.predictionTitle?`Created ${t.predictionTitle}`:"Created a prediction",subtitle:t.data?.category?`Category: ${t.data.category}`:"",amount:null,badge:"created",badgeColor:"text-purple-600"};case"wallet.unlock":return{iconBg:"bg-emerald-100",icon:e.jsx(b,{className:"w-4 h-4 text-emerald-600"}),title:"Escrow funds released",subtitle:t.data?.prediction_title?t.data.prediction_title:"",amount:t.data?.amount?o(Number(t.data.amount),{compact:!0}):null,badge:"wallet",badgeColor:"text-emerald-600"};case"wallet.payout":return{iconBg:"bg-emerald-100",icon:e.jsx(b,{className:"w-4 h-4 text-emerald-700"}),title:"Settlement payout received",subtitle:t.data?.prediction_title?t.data.prediction_title:"",amount:t.data?.amount?o(Number(t.data.amount),{compact:!0}):null,badge:"payout",badgeColor:"text-emerald-700"};case"wallet.platform_fee":return{iconBg:"bg-slate-100",icon:e.jsx(b,{className:"w-4 h-4 text-slate-600"}),title:"Platform fee credited",subtitle:t.data?.prediction_title?t.data.prediction_title:"",amount:t.data?.amount?o(Number(t.data.amount),{compact:!0}):null,badge:"platform",badgeColor:"text-slate-600"};case"wallet.creator_fee":return{iconBg:"bg-amber-100",icon:e.jsx(b,{className:"w-4 h-4 text-amber-600"}),title:"Creator earnings received",subtitle:t.data?.prediction_title?t.data.prediction_title:"",amount:t.data?.amount?o(Number(t.data.amount),{compact:!0}):null,badge:"creator",badgeColor:"text-amber-600"};default:return{iconBg:"bg-gray-100",icon:e.jsx(p,{className:"w-4 h-4 text-gray-500"}),title:"Activity",subtitle:"",amount:null,badge:t.type,badgeColor:"text-gray-500"}}};if(!c)return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:[e.jsx(O,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(p,{className:"w-4 h-4 text-gray-300"}),e.jsx("div",{className:"text-xs text-gray-400 font-medium tracking-wide",children:"Predictions"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-300 font-mono truncate",children:"--"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(N,{className:"w-4 h-4 text-gray-300"}),e.jsx("div",{className:"text-xs text-gray-400 font-medium tracking-wide",children:"Win Rate"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-300 font-mono truncate",children:"--"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-gray-300"}),e.jsx("div",{className:"text-xs text-gray-400 font-medium tracking-wide",children:"Rank"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-300 font-mono truncate",children:"--"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Overview"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view profile"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Customize your handle, avatar, and track your prediction performance."}),e.jsx("button",{onClick:async()=>{try{await ie({intent:"edit_profile"})}catch(t){console.error("Auth gate error:",t)}},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Recent Activity"}),e.jsx("div",{className:"text-center py-6 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Your prediction activity will appear here"})})]})]})})]});const ee=se.useMemo(()=>{const t=new Set;for(const s of n)s?.prediction_id&&t.add(s.prediction_id);return t.size},[n])+$.length,m=d.length>0?u.length/d.length*100:0,te=Math.max(1,Math.ceil((100-Q)/10));return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:[e.jsx(O,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsx("div",{className:"space-y-4",children:H?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[...Array(3)].map((t,s)=>e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2 w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-12 mt-1"})]},s))}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 mb-2"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-40"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(p,{className:"w-4 h-4 text-blue-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Predictions"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-900 font-mono truncate",children:oe(ee)}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.length," bets, ",$.length," created"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(N,{className:`w-4 h-4 ${m>=70?"text-emerald-500":m>=50?"text-yellow-500":"text-red-500"}`}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Win Rate"})]}),e.jsx("div",{className:`text-lg font-bold font-mono truncate ${m>=70?"text-emerald-600":m>=50?"text-yellow-600":"text-red-600"}`,children:xe(m/100)}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[u.length,"/",d.length," won"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-purple-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Rank"})]}),e.jsxs("div",{className:"text-lg font-bold text-gray-900 font-mono truncate",children:["#",te]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:y>=0?"profitable":"improving"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Overview"}),X&&e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{S(a?.firstName||""),E(a?.lastName||""),B(a?.bio||""),g(!0)},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Edit profile",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>G(t=>!t),className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"More",children:e.jsx(ue,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(de,{email:a?.email,username:a?.firstName||a?.email?.split("@")[0],avatarUrl:a?.avatar,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a?.firstName&&a?.lastName?`${a.firstName} ${a.lastName}`:a?.email?.split("@")[0]||"User"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["@",a?.email?.split("@")[0]||"user"]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1 text-emerald-600",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),n.filter(t=>t.status==="active").length," active bets"]}),e.jsxs("span",{className:"text-gray-500",children:[d.length," completed"]}),e.jsxs("span",{className:"text-gray-500",children:[o(Math.abs(y),{compact:!0})," ",y>=0?"profit":"loss"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recent Activity"}),j.length>0&&e.jsx("button",{onClick:()=>A(!0),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"View All"})]}),Z?e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((t,s)=>e.jsxs("div",{className:"animate-pulse flex items-center justify-between py-2 px-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32 mb-1"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-24"})]})]}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12"})]},s))}):j.length>0?e.jsx("div",{className:"space-y-3",children:j.map((t,s)=>{const l=L(t);return e.jsxs("div",{className:"flex items-center justify-between py-2 hover:bg-gray-50 rounded-lg px-2 -mx-2 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l.iconBg}`,children:l.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:l.title}),l.subtitle&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:l.subtitle}),e.jsx("p",{className:"text-[11px] text-gray-400",children:t.timestamp?z(t.timestamp):"Recently"})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[l.amount&&e.jsx("div",{className:"text-sm font-semibold font-mono text-gray-700",children:l.amount}),e.jsx("div",{className:`text-xs font-medium ${l.badgeColor}`,children:l.badge})]})]},s)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(p,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-sm text-gray-900 font-medium mb-1",children:"No recent activity"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4 max-w-sm mx-auto",children:"Your prediction activity and results will appear here."}),e.jsx("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors text-sm",children:"Explore Predictions"})]})]})]})})}),c&&e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 mt-4 mb-[calc(5rem+env(safe-area-inset-bottom))]",children:e.jsx("button",{onClick:async()=>{try{await h.getState().logout()}catch(t){console.error("Logout failed",t)}},className:"w-full text-sm px-4 py-3 rounded-2xl border border-black/[0.06] bg-white text-gray-900 hover:bg-gray-50 flex items-center justify-center shadow-sm",children:"Sign out"})}),Y&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Edit Profile"}),e.jsx("button",{onClick:()=>g(!1),className:"p-1.5 rounded-lg hover:bg-gray-100","aria-label":"Close",children:e.jsx(ce,{className:"w-4 h-4 text-gray-600"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"First name"}),e.jsx("input",{value:P,onChange:t=>S(t.target.value),className:"w-full border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Last name"}),e.jsx("input",{value:U,onChange:t=>E(t.target.value),className:"w-full border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Bio"}),e.jsx("textarea",{value:_,onChange:t=>B(t.target.value),rows:3,className:"w-full border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-2",children:"Profile photo"}),e.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-2 border border-gray-200 rounded-lg text-sm text-gray-700 hover:bg-gray-50 cursor-pointer",children:[e.jsx(he,{className:"w-4 h-4 text-gray-500"}),"Upload image",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async t=>{const s=t.target.files?.[0];if(s)try{await h.getState().uploadAvatar(s)}catch(l){console.error("Avatar upload failed",l)}}})]})]})]}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>g(!1),className:"px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{await h.getState().updateProfile({firstName:P,lastName:U,bio:_}),g(!1)}catch(t){console.error("Update failed",t)}},className:"px-3 py-2 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700",children:"Save changes"})]})]})}),W&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-end md:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"All Activity"}),e.jsx("button",{onClick:()=>A(!1),className:"text-xs text-gray-500 hover:text-gray-700",children:"Close"})]}),e.jsx("div",{className:"overflow-y-auto divide-y divide-gray-100 max-h-[calc(80vh-3.5rem)] sm:max-h-[calc(80vh-3rem)] pr-1",children:R&&x.length===0?e.jsx("div",{className:"p-6 text-sm text-gray-500",children:"Loading activityâ€¦"}):x.length===0?e.jsx("div",{className:"p-6 text-sm text-gray-500",children:"No activity yet."}):x.map(t=>{const s=L(t);return e.jsxs("div",{className:"flex items-center justify-between gap-4 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center ${s.iconBg}`,children:s.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.title}),s.subtitle&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.subtitle}),e.jsx("p",{className:"text-[11px] text-gray-400",children:t.timestamp?z(t.timestamp):"Recently"})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0 min-w-[80px]",children:[s.amount&&e.jsx("div",{className:"text-sm font-mono font-medium text-gray-700",children:s.amount}),e.jsx("div",{className:`text-xs font-medium ${s.badgeColor}`,children:s.badge})]})]},t.id)})})]})})]})};export{Ee as default};
