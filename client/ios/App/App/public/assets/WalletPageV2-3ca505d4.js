import{j as e}from"./ui-c369d1f3.js";import{r as s,R as jt}from"./vendor-c36eaa8e.js";import{m as tt,p as Nt,o as kt,t as Ct,j as ve}from"./wagmi-c444efa6.js";import{b as St}from"./utils-617af415.js";import{b as H,c as je}from"./format-14414da9.js";import{a4 as _t,I as At,a as Dt,c as It,j as Et,u as Rt,z as f,Q as Tt,h as O,o as Wt,aj as Oe,K as V,ah as Ne,P as Lt,X as ke,H as Ft,ad as Ve,ac as Ge,af as Ce,a2 as Je,J as ne,ak as re,D as z,x as Ye}from"./index-78beacc5.js";import{A as Xe}from"./AppHeader-5f619f9e.js";import{f as Se,t as _e}from"./txFormat-714ffd43.js";import{u as Ut}from"./useClaimableClaims-8ac6c19f.js";import{u as $t}from"./useMerkleClaim-2ef83797.js";import{D as zt}from"./DepositUSDCModal-4620608e.js";import{u as Ze,W as Pt,c as Kt}from"./WithdrawUSDCModal-1d812251.js";import{u as Qt,F as qt,a as Bt,A as Mt}from"./useAutoNetworkSwitch-7bfb655b.js";import{u as Ht}from"./useUnifiedBalance-69bdcc40.js";import{u as Ot}from"./useEscrowBalance-5c6e362b.js";import{u as Vt,a as Gt,B as Jt}from"./useFiatWallet-4b2d48ae.js";import{A as Ae}from"./arrow-up-right-87b90fb4.js";import"./useNotifications-29ac0910.js";import"./useWalletConnectSession-1627a74c.js";import"./utils-ae6b997d.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=_t("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Yt=12e3;function Xt(){try{const r=localStorage.getItem("wagmi.store");if(r){const n=JSON.parse(r),p=n?.state?.connections,o=n?.state?.current;if(o&&p?.value?.length>0){const b=p.value.find(u=>Array.isArray(u)&&u[0]===o);if(b&&b[1]?.accounts?.length>0){const u=b[1].accounts[0],c=b[1]?.connector?.id||o;return{hasPersisted:!0,lastAddress:u,connectorId:c}}for(const u of p.value)if(Array.isArray(u)&&u[1]?.accounts?.length>0)return{hasPersisted:!0,lastAddress:u[1].accounts[0],connectorId:u[1]?.connector?.id||u[0]}}}}catch{}return{hasPersisted:!1,lastAddress:void 0,connectorId:void 0}}function et(){return typeof window>"u"?{hasPersisted:!1,lastAddress:void 0,connectorId:void 0}:Xt()}function Zt(){const{address:r,isConnected:n,isConnecting:p,isReconnecting:o,status:b,chainId:u}=tt(),{reconnect:c,isPending:S}=Nt(),d=b,{hasPersisted:_,lastAddress:G,connectorId:De}=et(),[A,K]=s.useState(()=>!n&&_||!1),i=s.useRef(null),h=s.useRef(!1),w=s.useRef(void 0);s.useEffect(()=>{r&&(w.current=r)},[r]);const y=p||o||S||d==="reconnecting"||d==="connecting",Q=s.useCallback(()=>{if(!n&&!y&&_&&!h.current){h.current=!0;try{c()}catch{}}},[n,y,_,c]);s.useEffect(()=>{if(n&&(h.current=!1),!n&&!y&&_){A||K(!0),i.current&&clearTimeout(i.current);const L=setTimeout(()=>{Q()},500);return i.current=setTimeout(()=>{const{hasPersisted:ie}=et();ie&&!n&&(h.current||Q()),K(!1),i.current=null},Yt),()=>{clearTimeout(L)}}return(n||y)&&(A&&K(!1),i.current&&(clearTimeout(i.current),i.current=null)),()=>{i.current&&clearTimeout(i.current)}},[n,y,_,A,Q]);const J=n||y||A,q=r||(y||A?w.current||G:void 0);return{isEffectivelyConnected:J,isTransitioning:y||A,address:q,chainId:u,status:b,rawIsConnected:n,hadPreviousConnection:_}}function es(r,n){if(Object.is(r,n))return!0;if(typeof r!="object"||r===null||typeof n!="object"||n===null)return!1;if(r instanceof Map&&n instanceof Map){if(r.size!==n.size)return!1;for(const[o,b]of r)if(!Object.is(b,n.get(o)))return!1;return!0}if(r instanceof Set&&n instanceof Set){if(r.size!==n.size)return!1;for(const o of r)if(!n.has(o))return!1;return!0}const p=Object.keys(r);if(p.length!==Object.keys(n).length)return!1;for(const o of p)if(!Object.prototype.hasOwnProperty.call(n,o)||!Object.is(r[o],n[o]))return!1;return!0}const{useRef:ts}=jt;function ss(r){const n=ts();return p=>{const o=r(p);return es(n.current,o)?n.current:n.current=o}}function as(r){return{deposit:"Deposit",withdraw:"Withdrawal",lock:"Locked for bet",unlock:"Unlocked",win:"Win payout",transaction:"Transaction",transfer:"Transfer",fee:"Fee"}[r.toLowerCase()]||r}const ks=({onNavigateBack:r})=>{const{user:n}=At(),{user:p,isAuthenticated:o}=Dt(ss(t=>({user:t.user,isAuthenticated:t.isAuthenticated}))),[b,u]=s.useState(!0);Qt();const c=n||p,S=!!n||o,d=St();tt();const{isEffectivelyConnected:_,isTransitioning:G,address:De,chainId:A,status:K}=Zt(),i=De,h=_,w=A,y=K,{disconnect:Q}=kt(),{switchChain:J}=Ct(),{sessionHealthy:q,triggerRecovery:L}=It(),ie=Et(),le=Rt(),st=`${le.pathname}${le.search}${le.hash}`;s.useEffect(()=>{},[h,i,y]);const[Ie,ce]=s.useState(!1),[Ee,oe]=s.useState(!1),[at,de]=s.useState(!1),[Re,me]=s.useState(!1),[Te,xe]=s.useState(!1),[We,Y]=s.useState(null),[Le,Fe]=s.useState(!1),[nt,rt]=s.useState(0),[it,Ue]=s.useState(0),{claim:ue,isClaiming:he}=$t(),[N,fe]=s.useState(null),[x,X]=s.useState(null),[pe,$e]=s.useState(!1),lt=q&&!pe,k=Kt({isConnected:h,address:i,chainId:w,expectedChainId:ve.id,sessionHealthy:lt,status:y,isTransitioning:G}),E=pe?"session_unhealthy":k.code,{wallet:F,available:D,locked:B,total:M,isLoading:R,error:ct,refetch:ge}=Ht(),[ot,be]=s.useState(!1);s.useEffect(()=>{if(!S){be(!1);return}if(!R){be(!1);return}const t=setTimeout(()=>be(!0),15e3);return()=>clearTimeout(t)},[S,R]);const{availableUSD:dt}=Ot(),[I,mt]=s.useState({wallet:F??0,available:D??0,reserved:B??0,total:M??0});s.useEffect(()=>{k.code==="ready"&&mt(t=>{const a={wallet:typeof F=="number"?F:t.wallet,available:typeof D=="number"?D:t.available,reserved:typeof B=="number"?B:t.reserved,total:typeof M=="number"?M:t.total};return a.wallet===t.wallet&&a.available===t.available&&a.reserved===t.reserved&&a.total===t.total?t:a})},[k.code,F,D,B,M]);const ze=Ze(c?.id,20),Pe=Ze(c?.id,1e3),Z=ze.data,xt=ze.isLoading,T=Pe.data,ut=Pe.isLoading,{data:m}=Ut(i,100),[ht,ye]=s.useState(!1),{data:ft}=Vt(),{data:pt}=Gt(c?.id),Ke=ft?.enabled||!1,v=pt?.summary||null,g=s.useCallback(()=>{window.dispatchEvent(new CustomEvent("fcz:wallet:connect"))},[]);s.useEffect(()=>{function t(a){if(!a||!a.detail)return;const{txHash:l,kind:j,predictionId:C}=a.detail||{};l&&fe({hash:String(l),kind:String(j||"tx"),predictionId:C})}return window.addEventListener("fcz:tx",t),()=>window.removeEventListener("fcz:tx",t)},[]),s.useEffect(()=>{const t=()=>{(!h||!i)&&$e(!0)};return window.addEventListener("fcz:wallet:reconnect-required",t),()=>window.removeEventListener("fcz:wallet:reconnect-required",t)},[h,i]),s.useEffect(()=>{h&&i&&w===ve.id&&q&&$e(!1)},[h,i,w,q]),s.useEffect(()=>{try{for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t)||"";if(!a.startsWith("fcz:lastTx:"))continue;const l=localStorage.getItem(a)||"";if(!l||sessionStorage.getItem(`fcz:tx:dismissed:${l}`)==="true")continue;const j=a.split(":"),C=j[2]||"tx",vt=j[3];fe({hash:l,kind:C,predictionId:vt});break}}catch{}},[]);const U=s.useCallback(()=>{try{J({chainId:ve.id}),f.success("Check your wallet to confirm the network switch.")}catch{f.error("Please switch to Base Sepolia in your wallet."),g()}},[g,J]),$=s.useCallback(()=>{L(),g()},[g,L]);s.useMemo(()=>{const t=[],a="inline-flex items-center rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50 transition-colors";return E==="reconnecting"?null:(E==="disconnected"&&t.push(e.jsxs("button",{onClick:g,className:"inline-flex items-center gap-2 rounded-lg bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-emerald-700 transition-colors",children:[e.jsx(O,{className:"w-4 h-4"})," Connect wallet"]},"connect")),E==="wrong_network"&&t.push(e.jsxs("button",{onClick:U,className:a,children:[e.jsx(Mt,{className:"w-4 h-4"})," Switch network"]},"switch")),E==="session_unhealthy"&&t.push(e.jsxs("button",{onClick:$,className:"inline-flex items-center gap-2 rounded-lg bg-amber-500 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-600 transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"})," Reconnect wallet"]},"reconnect")),t.length?e.jsx("div",{className:"flex flex-wrap gap-2",children:t}):null)},[$,U,g,E]);const ee=s.useCallback(()=>{switch(k.code){case"ready":return!0;case"reconnecting":return f("Wallet is reconnecting, please wait..."),!1;case"disconnected":return f.error("Connect your wallet to continue."),g(),!1;case"wrong_network":return f.error("Switch to Base Sepolia to continue."),U(),!1;case"session_unhealthy":return f.error("Wallet session expired. Please reconnect."),$(),!1;default:return!1}},[k.code,g,$,U]),Qe=s.useCallback(()=>{ee()&&ce(!0)},[ee]),qe=s.useCallback(()=>{ee()&&oe(!0)},[ee]),gt=s.useMemo(()=>{const t=e.jsx("button",{disabled:!0,className:"h-11 rounded-xl border-2 border-gray-300 text-gray-400 font-semibold cursor-not-allowed",children:"Withdraw"});switch(E){case"reconnecting":return e.jsxs(e.Fragment,{children:[e.jsxs("button",{disabled:!0,className:"h-11 rounded-xl bg-gray-200 text-gray-500 font-semibold cursor-wait flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),"Reconnecting…"]}),t]});case"disconnected":return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:g,className:"h-11 rounded-xl bg-emerald-600 text-white font-semibold hover:bg-emerald-700 transition-colors",children:"Connect Wallet"}),t]});case"wrong_network":return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:U,className:"h-11 rounded-xl bg-amber-500 text-white font-semibold hover:bg-amber-600 transition-colors",children:"Switch Network"}),e.jsx("button",{disabled:!0,className:"h-11 rounded-xl border-2 border-gray-300 text-gray-400 font-semibold cursor-not-allowed",children:"+ Deposit"})]});case"session_unhealthy":return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:$,className:"h-11 rounded-xl bg-amber-500 text-white font-semibold hover:bg-amber-600 transition-colors",children:"Reconnect Wallet"}),t]});default:return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Qe,className:"h-11 rounded-xl bg-emerald-600 text-white font-semibold hover:bg-emerald-700 transition-colors",children:"+ Deposit"}),e.jsx("button",{onClick:qe,className:"h-11 rounded-xl border-2 border-gray-300 text-gray-700 font-semibold hover:border-gray-400 transition-colors disabled:opacity-50",disabled:!D||D===0,children:"Withdraw"})]})}},[E,$,U,Qe,qe,g,D]),W=s.useCallback(()=>{d.removeQueries({queryKey:["readContract"]}),setTimeout(()=>{ge()},500)},[ge,d]);s.useEffect(()=>(window.addEventListener("fcz:balance:refresh",W),()=>window.removeEventListener("fcz:balance:refresh",W)),[W]);const te=(t,a)=>typeof t=="number"?t:a,we=k.code==="ready"?te(F,I.wallet):I.wallet,Be=k.code==="ready"?te(D,I.available):I.available,se=k.code==="ready"?te(B,I.reserved):I.reserved,bt=k.code==="ready"?te(M,I.total):I.total,Me=s.useRef({address:null,chainId:null});s.useEffect(()=>{if(!h||!i||typeof w!="number")return;const t=Me.current;t.address===i&&t.chainId===w||(Me.current={address:i,chainId:w},d.invalidateQueries({queryKey:["wallet"]}),d.invalidateQueries({queryKey:["escrow-balance"]}),d.invalidateQueries({queryKey:["onchain-activity"]}),d.invalidateQueries({queryKey:["readContract"]}),c?.id&&d.invalidateQueries({queryKey:Tt.walletActivity(c.id)}))},[h,i,w,d,c?.id]),s.useEffect(()=>{S&&c?.id?u(!1):S||u(!1)},[S,c?.id]);const ae=t=>{const a=(t||"").toLowerCase(),l={deposit:"Deposit",withdraw:"Withdrawal",lock:"Funds locked",release:"Funds released",unlock:"Funds released",entry:"Stake placed",bet_placed:"Stake placed",claim:"Claimed",payout:"Settlement payout",win:"Won prediction",loss:"Lost prediction",creator_fee:"Creator fee",platform_fee:"Platform fee",settlement:"Settlement posted",bet_refund:"Bet refunded"};return l[a]?l[a]:as(a)},yt=s.useCallback(t=>{if(fe(null),!!t)try{sessionStorage.setItem(`fcz:tx:dismissed:${t}`,"true");for(let a=0;a<localStorage.length;a++){const l=localStorage.key(a)||"";l.startsWith("fcz:lastTx:")&&localStorage.getItem(l)===t&&localStorage.removeItem(l)}}catch{}},[]);if(!S)return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:[e.jsx(Xe,{title:"Wallet"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(O,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view wallet"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Track your balance, deposits, and transaction history."}),e.jsx("button",{onClick:async()=>{try{await Wt({intent:"view_wallet"})}catch{}},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Recent Activity"}),e.jsx("div",{className:"text-center py-6 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Your transaction history will appear here"})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 text-center",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"New to crypto wallets?"}),e.jsxs("a",{href:"https://fanclubz.app/docs/funding-guide",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-sm font-medium text-emerald-600 hover:text-emerald-700 transition-colors",children:[e.jsx(Oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Learn how to fund your wallet"})]})]})]})]})})]});const He=s.useCallback(async t=>{try{if(Y(t.predictionId),await ue({predictionId:t.predictionId,amountUnits:BigInt(t.amountUnits),proof:t.proof})){await d.invalidateQueries({queryKey:["wallet","claimable"]});try{window.dispatchEvent(new CustomEvent("fcz:balance:refresh"))}catch{}return!0}return!1}catch(a){if(String(a?.message||"").toLowerCase().includes("already claimed")){await d.invalidateQueries({queryKey:["wallet","claimable"]});try{window.dispatchEvent(new CustomEvent("fcz:balance:refresh"))}catch{}return!0}return!1}finally{Y(null)}},[ue,d]),wt=s.useCallback(async()=>{if(!m||m.length===0)return;Fe(!0),rt(m.length),Ue(0);let t=0;for(const a of m)await He(a)&&(t++,Ue(t));Fe(!1),t===m.length?f.success(`Successfully claimed all ${t} ${V("winnings").toLowerCase()}!`):t>0?f.success(`Successfully claimed ${t} of ${m.length} ${V("winnings").toLowerCase()}`):f.error("No claims were processed")},[m,He]);return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:[e.jsx(Xe,{title:"Wallet"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsx("div",{className:"space-y-4",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[...Array(2)].map((t,a)=>e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2 w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"})]},a))}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-4"}),e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mx-auto mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 mx-auto mb-4"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"flex-1 h-12 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"flex-1 h-12 bg-gray-200 rounded-lg"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(O,{className:"w-4 h-4 text-blue-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Wallet"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-900 font-mono truncate",children:R?"...":H(we??0,{compact:!0})}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"USDC on Base"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-emerald-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Escrow"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-900 font-mono truncate",children:R?"...":H(bt??0,{compact:!0})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-2",children:[e.jsxs("span",{className:"text-emerald-600 font-medium",children:[H(Be??0,{compact:!0})," free"]}),se>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"·"}),e.jsxs("span",{className:"text-amber-600 font-medium",children:[H(se,{compact:!0})," locked"]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border border-blue-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-xs font-medium text-blue-600 bg-blue-100 px-2 py-1 rounded-full whitespace-nowrap",children:"Base Sepolia"}),h&&i&&e.jsxs("span",{className:"inline-flex items-center rounded-md bg-gray-100 px-2 py-1 text-xs font-mono text-gray-700 truncate max-w-[100px]",children:[i.slice(0,4),"…",i.slice(-3)]})]}),G?e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-lg border border-gray-200 bg-gray-50 px-3 py-1 text-xs font-medium text-gray-500",children:[e.jsx("span",{className:"w-2 h-2 border border-gray-400 border-t-transparent rounded-full animate-spin"}),"Reconnecting..."]}):h&&i?e.jsxs("button",{type:"button",onClick:()=>{Q(),f.success("Wallet disconnected")},className:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-1 text-xs font-medium text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"Disconnect"]}):e.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center gap-2 rounded-lg border border-emerald-300 bg-emerald-50 px-3 py-1 text-xs font-medium text-emerald-700 hover:bg-emerald-100 transition-colors",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"Connect Wallet"]})]}),!!m&&m.length>0&&e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-sm text-emerald-900",children:["You have ",m.length," claim",m.length>1?"s":""," pending"]}),e.jsx("button",{type:"button",className:"text-xs font-semibold text-emerald-700 hover:text-emerald-800 underline",onClick:()=>de(!0),children:"View & claim"})]})})}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600 whitespace-nowrap",children:["Wallet USDC ",e.jsx("span",{className:"ml-1 text-[10px] px-1 py-0.5 rounded bg-gray-100",children:"ERC20"})]}),e.jsx("span",{className:"font-mono font-medium tabular-nums whitespace-nowrap",children:we!==void 0?`${we.toFixed(2)}`:R?"Loading...":ct?"Error":"$0.00"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-700 flex items-center gap-2 whitespace-nowrap",children:[e.jsx("span",{className:"inline-block h-1.5 w-3 rounded bg-green-500"}),"Available"]}),e.jsx("span",{className:"font-mono font-semibold text-green-600 tabular-nums whitespace-nowrap",children:R?"Loading...":`${(Be??0).toFixed(2)}`})]}),se>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-700 flex items-center gap-2 whitespace-nowrap",children:[e.jsx("span",{className:"inline-block h-1.5 w-3 rounded bg-amber-500"}),"In active ",V("bets")]}),e.jsx("span",{className:"font-mono font-medium text-amber-600 tabular-nums whitespace-nowrap",children:R?"Loading...":`${(se??0).toFixed(2)}`})]})]}),pe&&e.jsx("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 text-amber-800 text-xs p-3",children:"Wallet session expired. Please reconnect your wallet before making deposits, withdrawals, or bets."}),ot&&e.jsxs("div",{className:"mt-3 rounded-xl border border-rose-200 bg-rose-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-rose-900",children:"Wallet is taking too long to load"}),e.jsx("div",{className:"mt-1 text-xs text-rose-800",children:"This can happen if your wallet session is stale or your network is unstable."}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{try{ge(),f("Refreshing balances…")}catch{}},className:"inline-flex items-center gap-2 rounded-lg bg-white px-3 py-1.5 text-xs font-semibold text-rose-900 border border-rose-200 hover:bg-rose-100 transition-colors",children:"Refresh"}),e.jsx("button",{type:"button",onClick:()=>{L(),g()},className:"inline-flex items-center gap-2 rounded-lg bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-rose-700 transition-colors",children:"Reconnect wallet"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mt-6",children:gt}),Z?.items&&Z.items.length>0?e.jsxs("div",{className:"mt-6 pt-4 border-t border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:"Recent Activity"}),(Z.items.length>=20||T?.items&&T.items.length>20)&&e.jsx("button",{onClick:()=>ye(!0),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"View All"})]}),e.jsx("div",{className:"space-y-2",children:Z.items.slice(0,20).map(t=>{const l={deposit:Ne,withdraw:Ae,lock:Je,release:P,unlock:P,entry:ne,bet_placed:ne,claim:re,payout:z,win:Ye,loss:Ce,creator_fee:z,platform_fee:z,settlement:re,bet_refund:P}[t.kind]||O,j=(()=>t.kind==="entry"&&t.meta?.option_label?`on ${t.meta.option_label}`:t.kind==="payout"&&t.meta?.prediction_title?`for ${t.meta.prediction_title}`:t.kind==="claim"&&t.meta?.prediction_title?`from ${t.meta.prediction_title}`:t.kind==="win"&&t.meta?.prediction_title||t.kind==="loss"&&t.meta?.prediction_title||t.kind==="creator_fee"&&t.meta?.prediction_title||t.kind==="settlement"&&t.meta?.prediction_title?t.meta.prediction_title:"")();return e.jsxs("div",{className:"flex items-center justify-between text-sm gap-2 hover:bg-gray-50 rounded-lg p-2 -mx-2 cursor-pointer transition-colors",onClick:()=>X(t),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[l&&e.jsx(l,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-gray-700 text-xs font-medium truncate",children:ae(t.kind)}),j&&e.jsx("span",{className:"text-[11px] text-gray-500 truncate",children:j})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:"text-[11px] text-gray-500 whitespace-nowrap",children:t.createdAt?je(t.createdAt):""}),(()=>{const C=Se({amount:t.amountUSD,kind:t.kind,compact:!1,currency:t?.meta?.currency||"USD"});return e.jsx("span",{className:`font-mono text-xs font-medium whitespace-nowrap ${_e(C.tone)}`,children:C.display})})()]})]},t.id)})})]}):xt?null:e.jsx("div",{className:"mt-6 pt-4 border-t border-blue-100",children:e.jsxs("div",{className:"text-center py-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"No transactions yet"}),e.jsxs("a",{href:"https://fanclubz.app/docs/funding-guide",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-xs font-medium text-emerald-600 hover:text-emerald-700 transition-colors",children:[e.jsx(Oe,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Learn how to fund your wallet"})]})]})})]}),Ke&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl border border-green-100 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-green-600 bg-green-100 px-2 py-1 rounded-full",children:"NGN Fiat"}),e.jsx(Jt,{className:"w-4 h-4 text-green-600"})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Balance"}),e.jsxs("span",{className:"font-mono font-semibold text-gray-900",children:["₦",v?v.totalNgn.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-1.5 w-3 rounded bg-green-500"}),"Available"]}),e.jsxs("span",{className:"font-mono font-semibold text-green-600",children:["₦",v?v.availableNgn.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]})]}),v&&v.lockedNgn>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-1.5 w-3 rounded bg-amber-500"}),"In active ",V("bets")]}),e.jsxs("span",{className:"font-mono font-medium text-amber-600",children:["₦",v.lockedNgn.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("button",{onClick:()=>me(!0),className:"h-11 rounded-xl bg-green-600 text-white font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Deposit"]}),e.jsxs("button",{onClick:()=>xe(!0),disabled:!v||v.availableNgn<200,className:"h-11 rounded-xl border-2 border-gray-300 text-gray-700 font-semibold hover:border-gray-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),"Withdraw"]})]})]})]})})}),c?.id&&e.jsxs(e.Fragment,{children:[Ie&&e.jsx(zt,{open:Ie,onClose:()=>ce(!1),onSuccess:()=>{ce(!1),W()},availableUSDC:F,userId:c.id}),Ee&&e.jsx(Pt,{open:Ee,onClose:()=>oe(!1),onSuccess:()=>{oe(!1),W()},availableUSDC:dt,userId:c.id})]}),c?.id&&Ke&&e.jsxs(e.Fragment,{children:[Re&&e.jsx(qt,{open:Re,onClose:()=>me(!1),userId:c.id,userEmail:c.email,onSuccess:()=>{me(!1),W(),d.invalidateQueries({queryKey:["fiat"]})}}),Te&&e.jsx(Bt,{open:Te,onClose:()=>xe(!1),userId:c.id,fiatSummary:v,onSuccess:()=>{xe(!1),W(),d.invalidateQueries({queryKey:["fiat"]})}})]}),x&&e.jsxs("div",{className:"fixed inset-0 z-modal flex items-end md:items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>X(null)}),e.jsxs("div",{className:"relative w-full md:max-w-md bg-white rounded-t-3xl md:rounded-2xl shadow-2xl p-6 z-[1] mb-[calc(72px+env(safe-area-inset-bottom,0px))] pb-[calc(16px+env(safe-area-inset-bottom,0px))] max-h-[85vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Activity"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ae(x.kind)})]}),e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Close details",onClick:()=>X(null),children:e.jsx(ke,{className:"w-4 h-4 text-gray-600"})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 mb-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Amount"}),(()=>{const t=Se({amount:x.amountUSD,kind:x.kind,compact:!1,currency:x?.meta?.currency||"USD"});return e.jsx("p",{className:`text-2xl font-semibold ${_e(t.tone)}`,children:t.display})})(),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-3",children:[e.jsx(Ft,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:x.createdAt?je(x.createdAt):"Just now"})]})]}),x.meta?.prediction_title&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Prediction"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:x.meta.prediction_title}),x.meta.option_label&&e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Position: ",x.meta.option_label]})]}),x.txHash?e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Transaction hash"}),e.jsxs("span",{className:"font-mono text-xs text-gray-900 truncate max-w-[140px]",children:[x.txHash.slice(0,10),"…",x.txHash.slice(-6)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-xl py-2 hover:bg-gray-50",onClick:async()=>{try{await navigator.clipboard.writeText(x.txHash||""),f.success("Copied transaction hash")}catch{f.error("Unable to copy hash")}},children:[e.jsx(Ve,{className:"w-4 h-4"}),"Copy"]}),e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-xl py-2 hover:bg-gray-50",onClick:()=>{const t=`https://sepolia.basescan.org/tx/${x.txHash}`;window.open(t,"_blank")},children:[e.jsx(Ge,{className:"w-4 h-4"}),"View"]})]})]}):e.jsx("div",{className:"border border-dashed border-gray-200 rounded-2xl p-4 text-sm text-gray-600 bg-gray-50",children:"This entry was recorded off-chain, so a transaction hash isn’t available."})]})]}),N&&e.jsx("div",{className:"fixed left-1/2 -translate-x-1/2 bottom-[calc(88px+env(safe-area-inset-bottom,0px))] z-modal",children:e.jsxs("div",{className:"mx-auto flex items-center gap-3 rounded-2xl bg-white shadow-lg border border-black/[0.06] px-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[11px] text-gray-600",children:N.kind==="claim"?"Claim":N.kind==="settlement"?"Settlement":ae(N.kind)}),e.jsxs("span",{className:"font-mono text-[11px] text-gray-500",children:[N.hash.slice(0,10),"…",N.hash.slice(-6)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"p-1.5 rounded-lg hover:bg-gray-100","aria-label":"View transaction",title:"View transaction",onClick:()=>{const t=`https://sepolia.basescan.org/tx/${N.hash}`;window.open(t,"_blank")},children:e.jsx(Ge,{className:"w-4 h-4 text-gray-700"})}),e.jsx("button",{className:"p-1.5 rounded-lg hover:bg-gray-100","aria-label":"Copy hash",title:"Copy hash",onClick:async()=>{try{await navigator.clipboard.writeText(N.hash),f.success("Copied transaction hash")}catch{}},children:e.jsx(Ve,{className:"w-4 h-4 text-gray-700"})}),e.jsx("button",{className:"p-1.5 rounded-lg hover:bg-gray-100","aria-label":"Dismiss",title:"Dismiss",onClick:()=>yt(N.hash),children:e.jsx(ke,{className:"w-4 h-4 text-gray-700"})})]})]})}),at&&e.jsxs("div",{className:"fixed inset-0 z-modal flex items-end md:items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>de(!1)}),e.jsxs("div",{className:"relative w-full md:max-w-lg bg-white rounded-t-2xl md:rounded-2xl shadow-xl p-4 pb-[calc(16px+env(safe-area-inset-bottom,0px))] mb-[calc(72px+env(safe-area-inset-bottom,0px))] max-h-[80vh] md:max-h-[75vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white/90 backdrop-blur px-4 pt-2 pb-3 -mx-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:["Your claimable ",V("winnings").toLowerCase()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Array.isArray(m)&&m.length>1&&e.jsx("button",{disabled:Le||he,className:"h-9 px-3 rounded-lg bg-emerald-100 text-emerald-800 text-sm font-semibold hover:bg-emerald-200 disabled:opacity-50",onClick:wt,children:Le?`Claiming ${it}/${nt}…`:`Claim all (${m.length})`}),e.jsx("button",{className:"p-1.5 rounded-lg hover:bg-gray-100","aria-label":"Dismiss",title:"Dismiss",onClick:()=>de(!1),children:e.jsx(ke,{className:"w-4 h-4 text-gray-700"})})]})]}),!m||m.length===0?e.jsx("div",{className:"text-sm text-gray-600 py-6 text-center",children:"No claimable items."}):e.jsx("div",{className:"space-y-3",children:m.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-xl",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:t.title||"Settled prediction"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Claim ",H(t.amountUSD,{compact:!1})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{className:"h-9 px-3 rounded-lg border text-sm text-gray-700 hover:bg-gray-50",onClick:()=>ie(`/predictions/${t.predictionId}`,{state:{from:st}}),children:"View"}),e.jsx("button",{className:"h-9 px-3 rounded-lg bg-emerald-600 text-white text-sm font-semibold hover:bg-emerald-700 disabled:opacity-50",disabled:he&&We!==t.predictionId,onClick:async()=>{try{Y(t.predictionId),await ue({predictionId:t.predictionId,amountUnits:BigInt(t.amountUnits),proof:t.proof})&&(await d.invalidateQueries({queryKey:["wallet","claimable"]}),window.dispatchEvent(new CustomEvent("fcz:balance:refresh")))}finally{Y(null)}},children:he&&We===t.predictionId?"Claiming…":"Claim"})]})]},`${t.predictionId}:${t.amountUnits}`))})]})]}),ht&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-end md:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"All Transactions"}),e.jsx("button",{onClick:()=>ye(!1),className:"text-xs text-gray-500 hover:text-gray-700",children:"Close"})]}),e.jsx("div",{className:"overflow-y-auto divide-y divide-gray-100 max-h-[calc(80vh-3.5rem)] sm:max-h-[calc(80vh-3rem)] pr-1",children:ut&&(!T?.items||T.items.length===0)?e.jsx("div",{className:"p-6 text-sm text-gray-500",children:"Loading transactions…"}):!T?.items||T.items.length===0?e.jsx("div",{className:"p-6 text-sm text-gray-500",children:"No transactions yet."}):T.items.map(t=>{const l={deposit:Ne,withdraw:Ae,lock:Je,release:P,unlock:P,entry:ne,bet_placed:ne,claim:re,payout:z,win:Ye,loss:Ce,creator_fee:z,platform_fee:z,settlement:re,bet_refund:P}[t.kind]||O,j=(()=>t.kind==="entry"&&t.meta?.option_label?`on ${t.meta.option_label}`:t.kind==="payout"&&t.meta?.prediction_title?`for ${t.meta.prediction_title}`:t.kind==="claim"&&t.meta?.prediction_title?`from ${t.meta.prediction_title}`:t.kind==="win"&&t.meta?.prediction_title||t.kind==="loss"&&t.meta?.prediction_title||t.kind==="creator_fee"&&t.meta?.prediction_title||t.kind==="settlement"&&t.meta?.prediction_title?t.meta.prediction_title:"")();return e.jsxs("div",{className:"flex items-center justify-between gap-4 px-4 py-3 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>{X(t),ye(!1)},children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center bg-gray-100 flex-shrink-0",children:l&&e.jsx(l,{className:"w-4 h-4 text-gray-500"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:ae(t.kind)}),j&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:j}),e.jsx("p",{className:"text-[11px] text-gray-400",children:t.createdAt?je(t.createdAt):"Recently"})]})]}),e.jsx("div",{className:"text-right flex-shrink-0 min-w-[80px]",children:(()=>{const C=Se({amount:t.amountUSD,kind:t.kind,compact:!1,currency:t?.meta?.currency||"USD"});return e.jsx("div",{className:`text-sm font-mono font-medium ${_e(C.tone)}`,children:C.display})})()})]},t.id)})})]})})]})};export{ks as default};
