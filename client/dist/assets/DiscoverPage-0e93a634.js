import{L as K,u as Y,a as Q,X as W,Z as X,z as S,b as G,S as J,c as q,_ as ee,n as F,d as te,T as se}from"./index-e6c4dacf.js";import{j as e,A as L,m as k}from"./ui-78f6af00.js";import{r as i,R as O}from"./vendor-2237fdcd.js";import{u as z}from"./predictionStore-920a9683.js";import{u as ae}from"./useMedia-d4e07280.js";import{f as le,a as re}from"./format-2bd12d32.js";import{I as ie,B as U}from"./input-f162e615.js";import{c as D}from"./utils-5dccc152.js";import{c as oe}from"./utils-228faac7.js";import{A as ne}from"./AppHeader-06d26831.js";import{f as ce,a as A}from"./format-42e48058.js";import"./index-29a94594.js";function de({prediction:t}){const{media:l}=ae(t.id,{id:t.id,title:t.title,description:t.description??"",category:t.category}),s=t.endsAt?le(Math.max(0,(new Date(t.endsAt).getTime()-Date.now())/1e3)):null;return e.jsx(K,{to:`/prediction/${t.id}`,className:"block rounded-2xl border border-black/5 bg-white hover:shadow-sm focus-visible:ring-2 focus-visible:ring-indigo-500 transition",children:e.jsxs("div",{className:"flex items-stretch gap-3 p-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.category&&e.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-0.5",children:t.category}),s&&e.jsxs("span",{className:"rounded-full bg-gray-100 px-2 py-0.5",children:["ends in ",s]})]}),e.jsx("h3",{className:"mt-1 line-clamp-2 text-[15px] font-semibold text-gray-900",children:t.title}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-gray-500",children:[typeof t.pool=="number"&&e.jsxs("span",{children:[re(t.pool,{currency:"USD"})," pool"]}),typeof t.players=="number"&&e.jsxs("span",{children:[t.players," players"]}),t.options?.length?e.jsx("div",{className:"flex items-center gap-1",children:t.options.slice(0,2).map(a=>e.jsxs("span",{className:"rounded-md border border-gray-200 px-1.5 py-0.5 text-[11px] font-medium text-gray-700",children:[a.label,a.odds?e.jsxs("span",{className:"ml-1 text-gray-500",children:[a.odds.toFixed(2),"x"]}):null]},a.label))}):null]})]}),e.jsx("div",{className:"h-[72px] w-[96px] shrink-0 overflow-hidden rounded-xl bg-gray-100",children:e.jsx("img",{src:l.url,alt:l.alt||t.title,className:"h-full w-full object-cover",loading:"lazy"})})]})})}function me(){return e.jsx("div",{className:"rounded-2xl border border-black/5 bg-white p-3",children:e.jsxs("div",{className:"flex items-stretch gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded-full animate-pulse"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded animate-pulse mb-1"}),e.jsx("div",{className:"h-4 w-3/4 bg-gray-200 rounded animate-pulse mb-2"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-3 w-16 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-12 bg-gray-200 rounded animate-pulse"})]})]}),e.jsx("div",{className:"h-[72px] w-[96px] bg-gray-200 rounded-xl animate-pulse"})]})})}const R=i.forwardRef(({className:t,...l},s)=>e.jsx("div",{ref:s,className:D("rounded-xl border bg-card text-card-foreground shadow-sm",t),...l}));R.displayName="Card";const xe=i.forwardRef(({className:t,...l},s)=>e.jsx("div",{ref:s,className:D("flex flex-col space-y-1.5 p-6",t),...l}));xe.displayName="CardHeader";const ue=i.forwardRef(({className:t,...l},s)=>e.jsx("h3",{ref:s,className:D("font-semibold leading-none tracking-tight",t),...l}));ue.displayName="CardTitle";const ge=i.forwardRef(({className:t,...l},s)=>e.jsx("p",{ref:s,className:D("text-sm text-muted-foreground",t),...l}));ge.displayName="CardDescription";const I=i.forwardRef(({className:t,...l},s)=>e.jsx("div",{ref:s,className:D("p-6 pt-0",t),...l}));I.displayName="CardContent";const he=i.forwardRef(({className:t,...l},s)=>e.jsx("div",{ref:s,className:D("flex items-center p-6 pt-0",t),...l}));he.displayName="CardFooter";const w=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),pe=(t,l)=>t*l,H=(...t)=>t.filter(Boolean).join(" "),fe=t=>{const l=t.entry_deadline||t.entryDeadline;if(!l)return"Time remaining unknown";const s=Math.max(0,new Date(l).getTime()-Date.now()),a=Math.floor(s/(1e3*60*60));return s<=0?"Ended":a>=24?`${Math.floor(a/24)}d left`:`${a}h left`},ye=({prediction:t,isOpen:l,onClose:s})=>{if(!t||!l)return null;const[a,n]=i.useState(""),[c,d]=i.useState(""),[g,C]=i.useState(!1),{user:h}=Y(),{getBalance:m,lockFunds:p}=Q(),{placePrediction:f}=z(),y=m("USD")||0,o=parseFloat(c)||0,x=t?.options?.find(u=>u.id===a),N=x?.current_odds||(x?.total_staked?t?.pool_total/x.total_staked:2),b=x?pe(o,N):0,E=[5,10,25,50,100,250],T=async()=>{if(!a){S.error("Please select a prediction option (Yes or No)");return}if(!o){S.error("Please enter an amount to stake");return}if(o<t.stake_min){S.error(`Minimum stake is ${w(t.stake_min)}. Please increase your amount.`);return}if(t.stake_max&&o>t.stake_max){S.error(`Maximum stake is ${w(t.stake_max)}. Please reduce your amount.`);return}if(o>y){S.error(`Insufficient balance. You have ${w(y)} available, but tried to stake ${w(o)}.`);return}if(!h?.id){S.error("You must be logged in to place predictions");return}C(!0);try{await p(o,"USD"),await f(t.id,a,o,h.id),S.success(`Prediction placed successfully! You staked ${w(o)} on ${x?.label}.`),s(),d(""),n("")}catch(u){const v=u?.message||"Unknown error occurred";S.error(`Failed to place prediction: ${v}. Please try again.`)}finally{C(!1)}};return e.jsx(L,{mode:"wait",initial:!1,children:l&&e.jsxs(e.Fragment,{children:[e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:s,style:{zIndex:8e3}},"prediction-modal-backdrop"),e.jsx("div",{className:"fixed inset-0 flex items-end justify-center p-4 pb-20",style:{zIndex:8500,pointerEvents:"none"},children:e.jsxs(k.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"w-full max-w-md bg-white rounded-t-2xl shadow-2xl flex flex-col max-h-[75vh]",style:{pointerEvents:"auto"},onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Place Prediction"}),e.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close modal",children:e.jsx(W,{size:20})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base",children:t.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[w(t.pool_total||0)," Pool"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[t.participant_count||0," Players"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:fe(t)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Select your prediction:"}),e.jsx("div",{className:"space-y-2",children:(t.options||[]).map(u=>{const v=u.total_staked||0,$=t.pool_total||1,_=$>0?Math.min(v/$*100,100):50,M=u.current_odds||(v>0?$/v:2);return e.jsx(R,{className:H("cursor-pointer transition-all border-2",a===u.id?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"),onClick:()=>n(u.id),children:e.jsx(I,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:u.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[_.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-teal-600",children:[M.toFixed(2),"x"]})})]})})},u.id||Math.random())})})]}),e.jsx(L,{mode:"wait",children:a&&e.jsxs(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stake amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{type:"number",placeholder:"0.00",value:c,onChange:u=>d(u.target.value),className:"pl-8 pr-4 h-12 text-lg font-medium",min:t.stake_min,max:t.stake_max||y}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"$"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["Balance: ",w(y)]}),e.jsx("button",{onClick:()=>d(y.toString()),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Max"})]})]}),e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:E.map(u=>e.jsxs(U,{variant:"outline",size:"sm",onClick:()=>d(u.toString()),disabled:u>y,className:"text-sm h-10",children:["$",u]},u))})}),o>0&&e.jsx(R,{className:"bg-teal-50 border-teal-200",children:e.jsx(I,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Potential return"}),e.jsx("div",{className:"text-lg font-bold text-teal-600",children:w(b)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Profit"}),e.jsx("div",{className:H("font-semibold",b>o?"text-teal-600":"text-red-600"),children:w(b-o)})]})]})})})]},`amount-input-${a}`)})]}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-200 bg-white",children:e.jsx(U,{onClick:T,disabled:!a||!o||g||o>y,className:"w-full h-12 bg-teal-500 hover:bg-teal-600 disabled:bg-gray-400 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg flex items-center justify-center",children:g?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Placing..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{size:16}),e.jsxs("span",{children:["Place Prediction (",w(o),")"]})]})})})]},"prediction-modal-content")})]})})},ve=({hasNext:t,loading:l,onLoadMore:s,threshold:a=200,disabled:n=!1,container:c=null})=>{const d=i.useRef(!1),g=i.useCallback(()=>{if(n||l||!t||d.current)return;let h,m,p;c?(h=c.scrollTop,m=c.scrollHeight,p=c.clientHeight):(h=window.pageYOffset||document.documentElement.scrollTop,m=document.documentElement.scrollHeight,p=window.innerHeight||document.documentElement.clientHeight);const f=m-(h+p);f<=a&&(console.log("ðŸ”„ Infinite scroll triggered:",{distanceFromBottom:f,threshold:a,hasNext:t,loading:l,container:c?"container":"window"}),d.current=!0,s(),setTimeout(()=>{d.current=!1},1e3))},[n,l,t,a,s,c]);return i.useEffect(()=>{if(n)return;let h;const m=()=>{clearTimeout(h),h=setTimeout(g,100)},p=c||window,f="scroll",y="touchmove";return p.addEventListener(f,m,{passive:!0}),c||window.addEventListener(y,m,{passive:!0}),()=>{p.removeEventListener(f,m),c||window.removeEventListener(y,m),clearTimeout(h)}},[g,n,c]),{triggerLoadMore:i.useCallback(()=>{!n&&!l&&t&&!d.current&&(console.log("ðŸ”„ Manual infinite scroll trigger"),d.current=!0,s(),setTimeout(()=>{d.current=!1},1e3))},[n,l,t,s])}},be=oe((t,l)=>({positions:{},saveScrollPosition:(s,a)=>{t(n=>({positions:{...n.positions,[s]:{path:s,scrollY:a,timestamp:Date.now()}}}))},getScrollPosition:s=>{const a=l().positions[s];return a&&Date.now()-a.timestamp<10*60*1e3?a.scrollY:null},clearOldPositions:()=>{const s=Date.now(),a=10*60*1e3;t(n=>({positions:Object.fromEntries(Object.entries(n.positions).filter(([,c])=>s-c.timestamp<a))}))}})),je=(t,l={})=>{const[s]=G(),{saveScrollPosition:a,getScrollPosition:n}=be(),c=i.useRef(""),{saveOnUnmount:d=!0,restoreOnMount:g=!0,preserveFor:C=10,threshold:h=50}=l,m=i.useCallback(()=>t?.current?t.current:document.querySelector("[data-scroll-container]")||document.documentElement,[t]),p=i.useCallback(()=>{const o=m(),x=o===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:o.scrollTop;x>h&&(console.log(`ðŸ’¾ Saving scroll position for ${s}: ${x}px`),a(s,x))},[s,h,a,m]),f=i.useCallback(()=>{const o=m(),x=n(s);return x!==null&&x>0?(console.log(`ðŸ”„ Restoring scroll position for ${s}: ${x}px`),setTimeout(()=>{o===document.documentElement?window.scrollTo({top:x,behavior:"smooth"}):o.scrollTo({top:x,behavior:"smooth"})},100),!0):!1},[s,n,m]),y=i.useCallback(o=>{const x=m(),N=x===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:x.scrollTop,b=o||s;N>h&&(console.log(`ðŸ’¾ Manually saving scroll for ${b}: ${N}px`),a(b,N))},[s,h,a,m]);return i.useEffect(()=>{let o;return g&&(o=setTimeout(()=>{f()},50)),()=>{o&&clearTimeout(o),d&&p()}},[g,d,f,p]),i.useEffect(()=>{c.current&&c.current!==s&&console.log(`ðŸ”„ Location changed from ${c.current} to ${s}`),c.current=s},[s]),{saveScroll:y,restoreScroll:f,saveCurrentScroll:p}},V=O.memo(function({selectedCategory:l,onSelect:s}){const a=[{id:"all",label:"All",icon:"ðŸŒŸ"},{id:"sports",label:"Sports",icon:"âš½"},{id:"pop_culture",label:"Pop Culture",icon:"ðŸŽ¬"},{id:"custom",label:"Custom",icon:"âœ¨"},{id:"politics",label:"Politics",icon:"ðŸ—³ï¸"},{id:"crypto",label:"Crypto",icon:"â‚¿"},{id:"tech",label:"Tech",icon:"ðŸ’»"},{id:"finance",label:"Finance",icon:"ðŸ“ˆ"}];return e.jsx("div",{className:"category-filters bg-white border-b border-gray-100 px-4 py-3","data-tour-id":"category-filters",children:e.jsx("div",{className:"category-filters-container overflow-x-auto -mx-2 px-2",children:e.jsx("div",{className:"category-filters-flex flex gap-2 pb-1",children:a.map(n=>e.jsx(k.button,{onClick:()=>s(n.id),className:`
                category-pill flex-shrink-0 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium
                transition-all duration-200 whitespace-nowrap
                ${l===n.id?"active bg-purple-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
              `,whileTap:{scale:.96},children:e.jsx("span",{children:n.label})},n.id))})})})});V.displayName="CategoryFilters";const B=O.memo(function({stats:l,searchQuery:s,onSearchChange:a}){return e.jsxs("div",{className:"px-4 pt-4 pb-4 bg-white",children:[e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"LIVE MARKETS"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",title:`Total volume: ${(l?.totalVolume||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,children:ce(l?.totalVolume)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Volume"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",title:`${(l?.activePredictions||0).toLocaleString()} active predictions`,children:A(l?.activePredictions)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Live"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",title:`${(l?.totalUsers||0).toLocaleString()} total players`,children:A(l?.totalUsers)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Players"})]})]})]}),e.jsxs("div",{className:"relative","data-tour-id":"search-bar",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search predictions...",value:s,onChange:n=>a(n.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-500 focus:bg-white focus:ring-2 focus:ring-emerald-500 focus:outline-none transition-all"})]})]})});B.displayName="DiscoverHeaderContent";const Ne=O.memo(function({onNavigateToProfile:l,onNavigateToPrediction:s}){Y(),q();const{predictions:a,loading:n,loadingMore:c,pagination:d,filters:g,refreshPredictions:C,loadMorePredictions:h,setFilters:m}=z(),[p,f]=i.useState(null),[y,o]=i.useState(!1),x=i.useRef(null),{saveScroll:N}=je(x,{saveOnUnmount:!0,restoreOnMount:!0,preserveFor:15,threshold:100}),[b,E]=i.useState({totalVolume:"0",activePredictions:0,totalUsers:"0",rawVolume:0,rawUsers:0}),T=i.useCallback(async()=>{try{const{getApiUrl:r}=await ee(()=>import("./index-e6c4dacf.js").then(j=>j.H),["assets/index-e6c4dacf.js","assets/ui-78f6af00.js","assets/vendor-2237fdcd.js","assets/utils-228faac7.js","assets/index-7c822fcf.css"]),P=await fetch(`${r()}/api/v2/predictions/stats/platform`);if(P.ok){const j=await P.json();j.success&&(E(j.data),console.log("âœ… Platform stats fetched:",j.data))}else console.error("Failed to fetch platform stats:",P.status)}catch(r){console.error("Error fetching platform stats:",r)}},[]);ve({hasNext:d.hasNext,loading:c,onLoadMore:()=>{console.log("ðŸ”„ Infinite scroll triggered in DiscoverPage:",{hasNext:d.hasNext,loading:c,currentPage:d.page,total:d.total}),h()},threshold:300,container:x.current}),i.useEffect(()=>{C(),T()},[C,T]);const u=i.useMemo(()=>({totalVolume:b.totalVolume,activePredictions:b.activePredictions,totalUsers:b.totalUsers}),[b]),v=i.useMemo(()=>!a||!Array.isArray(a)?(console.log("ðŸ” DiscoverPage Debug - No valid predictions array:",a),[]):(console.log(`ðŸ” DiscoverPage Debug - Displaying ${a.length} predictions`),a.filter(r=>!r||!r.id||!r.title?(console.warn("âš ï¸ DiscoverPage: Invalid prediction object:",r),!1):!0)),[a]);i.useCallback(r=>{f(r),o(!0)},[]);const $=i.useCallback(r=>{N("/discover"),s?s(r):window.location.href=`/prediction/${r}`},[s,N]);i.useCallback(r=>{F.success("Prediction liked!")},[]),i.useCallback(r=>{N("/discover"),$(r)},[$,N]),i.useCallback(r=>{const P=`Check out this prediction: ${r.title}`,j=`${window.location.origin}/prediction/${r.id}`;navigator.share?navigator.share({title:r.title,text:P,url:j}).catch(console.error):navigator.clipboard.writeText(`${P}
${j}`).then(()=>F.success("Link copied to clipboard!")).catch(()=>F.error("Failed to copy link"))},[]);const _=i.useCallback(r=>{console.log("ðŸ” Search query changed:",r),m({search:r})},[m]),M=i.useCallback(r=>{console.log("ðŸ“‚ Category changed:",r),m({category:r})},[m]),Z=i.useCallback(()=>{o(!1),f(null)},[]);return n&&(!a||a.length===0)?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-100",children:[e.jsx("div",{className:"h-11"}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 loading-skeleton"})]}),e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full loading-skeleton"})]}),e.jsxs("div",{className:"bg-gray-200 rounded-2xl p-4 mb-4 loading-skeleton",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-20 mb-3 loading-skeleton"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-16 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-12 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-14 mx-auto loading-skeleton"})]})]})]}),e.jsx("div",{className:"h-12 bg-gray-200 rounded-xl loading-skeleton"})]})]}),e.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[1,2,3,4,5,6].map(r=>e.jsx("div",{className:"h-8 bg-gray-200 rounded-full w-20 flex-shrink-0 loading-skeleton"},r))})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"px-4 mb-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 loading-skeleton"})]}),e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(r=>e.jsx(me,{},r))})]})]}):e.jsxs("div",{ref:x,className:"discover-page content-with-bottom-nav","data-scroll-container":!0,style:{position:"relative",zIndex:1,overflowY:"auto",height:"100vh"},children:[e.jsx(ne,{title:"Discover"}),e.jsx(B,{stats:u,searchQuery:g.search,onSearchChange:_}),e.jsx("div",{className:"category-filters-wrapper",style:{position:"relative",zIndex:45},children:e.jsx(V,{selectedCategory:g.category,onSelect:M})}),e.jsxs("div",{className:"prediction-cards-container",children:[e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-1","data-tour-id":"discover-list",children:[g.category==="all"?"All Predictions":`${g.category} Predictions`,g.search&&` - "${g.search}"`]}),d.total>0&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",v.length," of ",d.total," predictions",d.hasNext&&" â€¢ Scroll for more"]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(L,{mode:"wait",children:v.length>0?e.jsxs(e.Fragment,{children:[v.map((r,P)=>!r||!r.id?(console.warn("âš ï¸ DiscoverPage: Skipping invalid prediction at index",P),null):e.jsx(de,{prediction:{id:r.id,title:r.title,category:r.category,endsAt:r.entry_deadline,pool:r.pool_total,players:r.participant_count,options:r.options?.slice(0,2).map(j=>({label:j.label,odds:j.current_odds})),description:r.description}},`${r.id}-${P}`)),c&&e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center py-8",children:[e.jsx(te,{className:"w-6 h-6 animate-spin text-purple-500 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading more predictions..."})]}),d.hasNext&&!c&&e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-6",children:[e.jsxs("button",{onClick:()=>{console.log("ðŸ”„ Manual load more triggered"),h()},className:"bg-purple-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-600 transition-colors",children:["Load More (",d.total-v.length," remaining)"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Page ",d.page," â€¢ ",v.length,"/",d.total]})]}),!d.hasNext&&!c&&v.length>10&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"ðŸŽ‰ You've seen all predictions!"})})]}):e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"text-center py-12 px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(se,{size:24,className:"text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No predictions found"}),e.jsx("p",{className:"text-gray-600",children:g.search?`No predictions match "${g.search}"`:n?"Loading predictions...":"Try adjusting your filters or check back later"}),!n&&!g.search&&e.jsx("button",{onClick:()=>C(!0),className:"mt-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"Refresh Predictions"})]})})})]}),e.jsx(ye,{prediction:p,isOpen:y,onClose:Z})]})});Ne.displayName="DiscoverPage";export{Ne as default};
