import{j as e,A as H,m as o}from"./ui-c369d1f3.js";import{r as l}from"./vendor-c36eaa8e.js";import{a4 as E,a as F,au as G,av as q,M as d,ao as b,x as f,K as P,J as A,e as O,aw as W,T as Y}from"./index-78beacc5.js";import{U as S}from"./UserAvatar-92d363fe.js";import{O as $,A as J}from"./OGBadge-a4548af7.js";import{A as K}from"./AppHeader-5f619f9e.js";import{h as Q,g as V,a as X}from"./format-14414da9.js";import{G as g}from"./gift-cbf334a5.js";import"./wagmi-c444efa6.js";import"./utils-617af415.js";import"./index-cca8fa81.js";import"./utils-ae6b997d.js";import"./useNotifications-29ac0910.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=E("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=E("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),he=()=>{const{user:y}=F(),D=l.useMemo(()=>G(),[]),[s,L]=l.useState("predictions"),[w,j]=l.useState([]),[v,N]=l.useState([]),[M,x]=l.useState(!0),[k,p]=l.useState(null),[ee,z]=l.useState(!1),h=l.useRef(null),R=async a=>{try{x(!0),p(null);const r=O(),t=await fetch(`${r}/api/v2/users/leaderboard?type=${a==="winrate"?"accuracy":a}&limit=50`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to fetch leaderboard: ${t.status}`);const i=await t.json();if(i.error)throw new Error(i.message||"Failed to fetch leaderboard");const n=(i.data||[]).map((c,m)=>({...c,rank:m+1}));j(n)}catch(r){p(r instanceof Error?r.message:"Failed to load leaderboard"),j([])}finally{x(!1)}},T=async()=>{try{x(!0),p(null);const a=await W(50,"all");N(a)}catch(a){p(a instanceof Error?a.message:"Failed to load referral leaderboard"),N([])}finally{x(!1)}};l.useEffect(()=>{s==="referrals"?T():R(s);const a=u().find(r=>r.id===s);a&&q.announce(`Switched to ${a.label} leaderboard`)},[s]),l.useEffect(()=>{const a=new IntersectionObserver(([r])=>{r&&z(r.intersectionRatio<1)},{threshold:[1]});return h.current&&a.observe(h.current),()=>{h.current&&a.unobserve(h.current)}},[]);const C=a=>{switch(a){case 1:return{icon:Z,emoji:"ðŸ†",color:"text-yellow-600 bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",textColor:"text-yellow-700"};case 2:return{icon:U,emoji:"ðŸ¥ˆ",color:"text-gray-600 bg-gradient-to-br from-gray-50 to-gray-100 border-gray-200",textColor:"text-gray-700"};case 3:return{icon:J,emoji:"ðŸ¥‰",color:"text-amber-600 bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",textColor:"text-amber-700"};default:return{icon:f,emoji:`#${a}`,color:"text-gray-500 bg-gray-50 border-gray-100",textColor:"text-gray-600"}}},I=(a,r)=>{switch(r){case"predictions":return{primary:X(a.predictions_count),color:a.predictions_count>10?"text-blue-600":"text-gray-600"};case"profit":const t=a.total_profit||0;return{primary:V(t),color:t>0?"text-emerald-600":t<0?"text-red-600":"text-gray-600"};case"winrate":const i=a.win_rate||0;return{primary:Q(i/100),color:i>70?"text-emerald-600":i>50?"text-blue-600":"text-gray-600"}}},u=()=>{const a=[{id:"predictions",label:"Creators",icon:A,description:"Most predictions created"},{id:"profit",label:"Winners",icon:Y,description:"Highest profits earned"}];return D&&a.push({id:"referrals",label:"Referrals",icon:g,description:"Most active referrals"}),a},_=u(),B=(a,r)=>{const t=r+1,i=C(t),n=y?.id===a.userId,c=t<=3,m=i.icon;return e.jsx(o.div,{className:d("bg-white rounded-2xl p-4 transition-all duration-200","hover:shadow-md hover:scale-[1.01] border",n?"bg-emerald-50 border-emerald-200 shadow-sm":c?"bg-gradient-to-r from-emerald-50 to-teal-50 border-emerald-200 shadow-sm":"bg-white border-gray-100"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},whileHover:{scale:1.01},role:"listitem","aria-label":`${a.fullName||a.username}, rank ${t}, ${a.activeReferrals} active referrals`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[e.jsx("div",{className:d("w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold border-2",i.color),children:c?e.jsx(m,{className:"w-5 h-5"}):e.jsx("span",{className:"text-xs",children:t})}),e.jsx(S,{email:a.username,username:a.username,avatarUrl:a.avatarUrl,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:a.fullName||a.username}),e.jsx($,{tier:a.ogBadge,size:"sm"}),n&&e.jsx(o.span,{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:25},children:"You"})]}),e.jsxs("p",{className:"text-sm text-gray-600 truncate",children:["@",a.username]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold font-mono text-emerald-600",children:a.activeReferrals}),e.jsx("div",{className:"text-xs text-gray-500",children:"active referrals"})]})]})},a.userId)};return e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Leaderboard"}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex space-x-4 py-3 overflow-x-auto scrollbar-hide",children:_.map((a,r)=>{const t=a.icon;return e.jsxs("button",{onClick:()=>L(a.id),className:d("px-3 py-1 rounded-lg text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1",s===a.id?"bg-emerald-100 text-emerald-700":"text-gray-600 hover:text-gray-900"),children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:a.label}),e.jsx("span",{className:"sm:hidden",children:a.id==="predictions"?"Creators":a.id==="profit"?"Winners":"Referrals"})]},a.id)})})})}),e.jsx("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:e.jsx("div",{className:"px-4 py-6",children:e.jsx("div",{role:"tabpanel",id:`tabpanel-${s}`,"aria-labelledby":`tab-${s}`,children:e.jsx(H,{mode:"wait",children:M?e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-4",children:[...Array(5)].map((a,r)=>e.jsxs("div",{className:"bg-white rounded-2xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full animate-pulse"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 animate-pulse"})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-16 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20 animate-pulse"})]})]},r))},"loading"):k?e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(b,{icon:e.jsx(f,{className:"w-8 h-8"}),title:"Unable to load leaderboard",description:k,primaryAction:e.jsxs(o.button,{onClick:()=>s==="referrals"?T():R(s),className:"px-6 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 transition-colors flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(f,{className:"w-4 h-4"}),"Try Again"]})})},"error"):s==="referrals"?v.length>0?e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-3",role:"list","aria-label":"Top Referrers leaderboard",children:v.map((a,r)=>B(a,r))},"referral-data"):e.jsx(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:e.jsx(b,{icon:e.jsx(g,{className:"w-8 h-8"}),title:"No referrals yet",description:"Be the first to invite friends! Share your referral link and climb the leaderboard.",primaryAction:e.jsxs(o.button,{onClick:()=>window.location.href="/profile",className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(g,{className:"w-4 h-4"}),"Get Referral Link"]})})},"referral-empty"):w.length>0?e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-3",role:"list","aria-label":`${u().find(a=>a.id===s)?.label} leaderboard`,children:w.map((a,r)=>{const t=C(a.rank||0),i=I(a,s),n=y?.id===a.id,c=(a.rank||0)<=3,m=t.icon;return e.jsx(o.div,{className:d("bg-white rounded-2xl p-4 transition-all duration-200","hover:shadow-md hover:scale-[1.01] border",n?"bg-emerald-50 border-emerald-200 shadow-sm":c?"bg-gradient-to-r from-yellow-50 to-orange-50 border-yellow-200 shadow-sm":"bg-white border-gray-100"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},whileHover:{scale:1.01},role:"listitem","aria-label":`${a.full_name||a.username}, rank ${a.rank}, ${i.primary} ${s==="predictions"?"predictions":s==="profit"?"profit":"win rate"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[e.jsx("div",{className:d("w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold border-2",t.color),children:c?e.jsx(m,{className:"w-5 h-5"}):e.jsx("span",{className:"text-xs",children:a.rank})}),e.jsx(S,{email:a.username,username:a.username,avatarUrl:a.avatar_url,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:a.full_name||a.username}),e.jsx($,{tier:a.og_badge,size:"sm"}),n&&e.jsx(o.span,{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:25},children:"You"})]}),e.jsxs("p",{className:"text-sm text-gray-600 truncate",children:["@",a.username]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:d("text-lg font-bold font-mono",i.color),children:i.primary})})]})},a.id)})},"data"):e.jsx(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:e.jsx(b,{icon:e.jsx(f,{className:"w-8 h-8"}),title:"No leaders yet",description:`Be the first to appear on the leaderboard by creating predictions and ${P("betting")}!`,primaryAction:e.jsxs(o.button,{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(A,{className:"w-4 h-4"}),"Start Predicting"]})})},"empty")})})})})]})};export{he as default};
