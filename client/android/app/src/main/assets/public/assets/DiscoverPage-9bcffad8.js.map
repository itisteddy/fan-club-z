{"version":3,"mappings":"kpCA2BwB,SAAAA,GAAiB,CAAE,WAAAC,GAAmC,CAE5E,GAAI,CAACA,EACI,YAGT,MAAMC,EAAWC,KACXC,EAAW,GAAGF,EAAS,QAAQ,GAAGA,EAAS,MAAM,GAAGA,EAAS,IAAI,GAEjEG,EAAkB,CACtBJ,EAAW,SACXA,EAAW,SAAS,UAAY,OAChCA,EAAW,SAAS,WAAa,QACjC,OAAQK,GAA2B,EAAQA,CAAM,EAE7CC,EAAqB,CACzBN,EAAW,SAAS,YAAc,mBAAqB,QACvD,OAAQK,GAA2B,EAAQA,CAAM,EAE7CE,EAAW,CACf,GAAIP,EAAW,GACf,MAAOA,EAAW,MAClB,YAAaA,EAAW,aAAe,GACvC,SAAUA,EAAW,SACrB,QAASA,EAAW,SAAS,IAAKQ,IAAY,CAC5C,MAAOA,GAAQ,OAASA,GAAQ,OAASA,GAAQ,MAAQ,IACzD,EACF,SAAUJ,EACV,WAAYE,EACZ,KAAMF,EACN,SAAU,CACR,QAASJ,EAAW,SAAS,WAAaA,EAAW,SAAS,UAAY,KAC1E,UAAWA,EAAW,SAAW,GAAGA,EAAW,QAAQ,aAAe,KACtE,SAAUM,CACZ,EACA,WAAY,CACV,KAAM,OAAON,EAAW,MAAS,SAAWA,EAAW,KAAO,KAC9D,QAAS,OAAOA,EAAW,SAAY,SAAWA,EAAW,QAAU,IACzE,GAGI,CAAE,MAAAS,CAAM,EAAIC,GAASV,EAAW,GAAIO,CAAQ,EAE5C,CAACI,EAAaC,CAAc,EAAIC,WAAS,EAAK,EAEpDC,YAAU,IAAM,CACdF,EAAe,EAAK,GACnB,CAACH,EAAM,GAAG,CAAC,EAGd,MAAMM,EAASf,EAAW,OACtBgB,GAAoB,KAAK,IAAI,EAAG,IAAI,KAAKhB,EAAW,MAAM,EAAE,QAAQ,EAAI,KAAK,IAAK,EAAC,EACnF,KAGF,OAAAiB,EAAA,IAACC,GAAA,CACC,GAAI,eAAelB,EAAW,EAAE,GAChC,MAAO,CAAE,KAAMG,CAAS,EACxB,UAAU,iIAEV,SAAAgB,EAAA,KAAC,MAAI,WAAU,+BAEb,UAACA,OAAA,OAAI,UAAU,iBACb,UAACA,OAAA,OAAI,UAAU,gDACX,WAAM,KACA,MAAAC,EAAgBC,GAAiBrB,CAAU,EACjD,OAAOoB,EACJH,MAAA,QAAK,UAAU,mDAAoD,WAAc,EAChF,OACH,EACFF,GAAUI,EAAA,KAAC,OAAK,WAAU,uCAAuC,qBAASJ,CAAA,EAAO,GACtF,EAEGE,EAAA,UAAG,UAAU,4DACX,WAAW,MAChB,EAEGjB,EAAW,SACTiB,EAAA,IAAAK,GAAA,CAAc,QAAStB,EAAW,QAAS,UAAU,iBAAiB,EAGzEmB,OAAC,MAAI,WAAU,+DACZ,iBAAOnB,EAAW,MAAS,UAC1BmB,OAAC,OAAK,eAAEI,GAAkBvB,EAAW,IAAI,EAAE,SAAK,EAEjD,OAAOA,EAAW,SAAY,iBAAa,OAAM,WAAWA,EAAA,QAAQ,YAAQ,EAC5EA,EAAW,SAAS,OAClBiB,MAAA,OAAI,UAAU,0BACZ,SAAAjB,EAAW,QAAQ,MAAM,EAAG,CAAC,EAAE,IAAI,CAACwB,EAAGC,IAAU,CAC1C,MAAAC,EAAcF,EAAE,OAASA,EAAE,OAASA,EAAE,MAAQ,UAAUC,EAAQ,CAAC,GAErE,OAAAN,EAAA,KAAC,QAED,UAAU,wFAET,UAAAO,EACAF,EAAE,KACAL,OAAA,QAAK,UAAU,qBAAsB,UAAEK,EAAA,KAAK,QAAQ,CAAC,EAAE,KAAC,EACvD,OANC,GAAGE,CAAW,IAAID,CAAK,GAO5B,CAEH,EACP,EACM,MACR,GACF,QAGG,MAAI,WAAU,6EACZ,SAAAhB,EAAM,IAEFU,OAAAQ,EAAA,qBAAChB,GACAM,MAAC,MAAI,WAAU,4CAA6C,GAE9DA,EAAA,IAAC,OACC,IAAKR,EAAM,IACX,IAAKA,EAAM,KAAOT,EAAW,MAC7B,UAAU,6DACV,QAAQ,OACR,OAAQ,IAAMY,EAAe,EAAI,EACjC,QAAS,IAAMA,EAAe,EAAK,EACnC,MAAO,CAAE,QAASD,EAAc,EAAI,EAAG,WAAY,oBAAqB,EAC1E,EACF,GAEAM,MAAC,MAAI,WAAU,2EAA4E,GAE/F,GACF,GAGN,CAEO,SAASW,IAA2B,CACzC,aACG,MAAI,WAAU,iDACb,SAACT,EAAA,YAAI,UAAU,2BACb,UAACA,OAAA,OAAI,UAAU,iBACb,UAACA,OAAA,OAAI,UAAU,+BACb,UAACF,MAAA,OAAI,UAAU,iDAAkD,GACjEA,MAAC,MAAI,WAAU,iDAAkD,IACrE,EACEA,MAAC,MAAI,WAAU,mDAAoD,GACnEA,MAAC,MAAI,WAAU,kDAAmD,GAClEE,OAAC,MAAI,WAAU,0BACb,UAACF,MAAA,OAAI,UAAU,4CAA6C,GAC5DA,MAAC,MAAI,WAAU,4CAA6C,IAC9D,GACF,EACAA,MAAC,MAAI,WAAU,wDAAyD,GAC1E,EACF,EAEJ,CC/KA,MAAMY,GAAOC,EAAM,WACjB,CAAC,CAAE,UAAAC,EAAW,GAAGC,GAASC,IACxBhB,EAAA,IAAC,OACC,IAAAgB,EACA,UAAWC,EACT,2DACAH,CACF,EACC,GAAGC,CAAA,CACN,CAEJ,EACAH,GAAK,YAAc,OAEnB,MAAMM,GAAaL,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BhB,EAAA,IAAC,OACC,IAAAgB,EACA,UAAWC,EAAG,gCAAiCH,CAAS,EACvD,GAAGC,CAAA,CACN,CACD,EACDG,GAAW,YAAc,aAEzB,MAAMC,GAAYN,EAGhB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BhB,EAAA,IAAC,MACC,IAAAgB,EACA,UAAWC,EAAG,4CAA6CH,CAAS,EACnE,GAAGC,CAAA,CACN,CACD,EACDI,GAAU,YAAc,YAExB,MAAMC,GAAkBP,EAGtB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BhB,EAAA,IAAC,KACC,IAAAgB,EACA,UAAWC,EAAG,gCAAiCH,CAAS,EACvD,GAAGC,CAAA,CACN,CACD,EACDK,GAAgB,YAAc,kBAE9B,MAAMC,GAAcR,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAS,EAAAC,UACzB,MAAI,KAAAA,EAAU,UAAWC,EAAG,WAAYH,CAAS,EAAI,GAAGC,CAAO,EACjE,EACDM,GAAY,YAAc,cAE1B,MAAMC,GAAaT,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BhB,EAAA,IAAC,OACC,IAAAgB,EACA,UAAWC,EAAG,6BAA8BH,CAAS,EACpD,GAAGC,CAAA,CACN,CACD,EACDO,GAAW,YAAc,aCxCzB,MAAMC,EAAiB,CAACC,EAAgBC,EAA0B,QACzD,IAAI,KAAK,aAAaA,IAAa,MAAQ,QAAU,QAAS,CACnE,MAAO,WACP,SAAAA,EACA,sBAAuB,EACvB,sBAAuBA,IAAa,MAAQ,EAAI,EACjD,EAAE,OAAOD,CAAM,EAGZE,GAA2B,CAACF,EAAgBG,IACzCH,EAASG,EAGLC,GAA4D,CAAC,CACxE,WAAA7C,EACA,OAAA8C,EACA,QAAAC,CACF,IAAM,CAEA,IAAC/C,GAAc,CAAC8C,EAAe,YAEnC,KAAM,CAACE,EAAkBC,CAAmB,EAAIpC,WAAiB,EAAE,EAC7D,CAAC4B,EAAQS,CAAS,EAAIrC,WAAiB,EAAE,EACzC,CAACsC,EAAWC,CAAY,EAAIvC,WAAS,EAAK,EAC1C,CAACwC,EAAkBC,CAAmB,EAAIzC,WAAS,EAAK,EAExD,CAAE,KAAA0C,GAASC,KACX,CAAE,gBAAAC,EAAiB,oBAAAC,CAAoB,EAAIC,GAAmB,EAC9DC,EAAcC,KACd,CAAE,QAAAC,EAAS,QAAAC,EAAS,YAAAC,GAAgBC,GAAW,EAC/C,CAAE,eAAAC,GAAmBC,KACrBC,EAAqBN,GAAS,eAAiB,KAC/C,CAAE,OAAQO,EAAY,UAAWC,EAAiB,QAASC,GAAoBC,KAC/E,CAAE,KAAAC,EAAM,QAAAC,EAAS,cAAAC,EAAe,cAAAC,EAAe,eAAAC,CAAA,EAAmBC,KAGlE,CAAE,KAAMC,CAAe,EAAIC,GAAkB,EAC7C,CAAE,KAAMC,EAAU,QAASC,GAAgBC,GAAe5B,GAAM,EAAE,EAGxEzC,YAAU,IAAM,CACViE,GAAgB,UAAY,QAC9BF,EAAeE,EAAe,OAAO,CAEtC,GAACA,GAAgB,QAASF,CAAc,CAAC,EAEtC,MAAAO,EAAaR,GAAiBH,IAAS,OACvCY,EAAaV,GAAiBF,IAAS,OAMvCa,EAAe,CAACD,GAAc,CAACD,EAE/B,CAACG,GAAaC,CAAc,EAAI3E,WAAwE,IAAI,EAC5G,CAAC4E,GAAaC,CAAc,EAAI7E,WAAS,EAAK,EAC9C,CAAC8E,GAAWC,CAAY,EAAI/E,WAAwB,IAAI,EAExDgF,EAAmBC,cAAY,SAAY,CAC/C,GAAKvC,GAAM,GACP,IACFmC,EAAe,EAAI,EACnBE,EAAa,IAAI,EACX,MAAAG,EAAO,MAAM,MAAM,GAAGC,IAAW,mCAAmCzC,EAAK,EAAE,EAAE,EAC7E0C,EAAO,MAAMF,EAAK,KAAO,QAAM,IAAM,IAAI,EAC/C,GAAI,CAACA,EAAK,GAAI,MAAM,IAAI,MAAME,GAAM,SAAW,6BAA6B,EAC7DT,EAAAS,GAAM,SAAW,IAAI,QAC7BC,EAAQ,CACFN,EAAAM,GAAG,SAAW,6BAA6B,EACxDV,EAAe,IAAI,SACnB,CACAE,EAAe,EAAK,CACtB,GACC,CAACnC,GAAM,EAAE,CAAC,EAEP4C,GAAaL,cAAY,SAAY,CACzC,GAAKvC,GAAM,GACP,IACFmC,EAAe,EAAI,EACnBE,EAAa,IAAI,EACjB,MAAMG,EAAO,MAAM,MAAM,GAAGC,GAAA,CAAW,0BAA2B,CAChE,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,UAAU,CAAE,OAAQzC,EAAK,GAAI,EACzC,EACK0C,EAAO,MAAMF,EAAK,KAAO,QAAM,IAAM,IAAI,EAC/C,GAAI,CAACA,EAAK,GAAI,MAAM,IAAI,MAAME,GAAM,SAAW,4BAA4B,EAC5DT,EAAAS,GAAM,SAAW,IAAI,EAChCA,GAAM,gBACRG,GAAY,4BAA4B7C,EAAK,EAAE,GAAI,OAAO0C,EAAK,cAAc,CAAC,EAE5EA,GAAM,eACRI,EAAM,MAAM,yDAAyD,EAErEA,EAAM,QAAQ,qBAAqB,QAE9BH,EAAQ,CACFN,EAAAM,GAAG,SAAW,4BAA4B,SACvD,CACAR,EAAe,EAAK,CACtB,GACC,CAACnC,GAAM,EAAE,CAAC,EAEbzC,YAAU,IAAM,CACVuE,GACGQ,EAAiB,CACxB,EACC,CAACR,EAAYQ,CAAgB,CAAC,EAE3B,MAAAS,EAAY,WAAW7D,CAAM,GAAK,EAClC8D,EAAiBvG,GAAY,SAAS,KAAUwB,KAAE,KAAOwB,CAAgB,EACzEwD,GAAqBD,GAAgB,eAAiBA,GAAgB,aAAgBvG,GAAY,WAAauG,EAAe,aAAgB,GAC9IE,EAAkBF,EAAiB5D,GAAyB2D,EAAWE,EAAkB,EAAI,EAC7FE,EAAgBnB,IAAa,WAAa,EAC1CoB,EAAgB1B,GAAU,SAAS,cAAgB,EAGnD2B,EAAiBxB,EAAauB,EAAiBrB,EAAehB,EAAkBoC,EAChFG,EAAiCzB,EAAa,MAAQ,MACtD0B,GAAexB,GAAgBgB,EAAYhC,EAC3CyC,GAAsBT,EAAYM,EAElCI,GAA0BlB,cAAY,IAAM,CAChD,GAAI,CAACR,EAAqB,SACtB,IACgB,OAAA2B,GAAA,CAChB,QAAAnD,EACA,QAAAC,EACA,gBAAiBmD,GAAY,GAC7B,YAAAlD,EACA,eAAAE,CAAA,CACD,EACM,SACAiD,EAAK,CACZ,MAAMC,EAAUD,aAAeE,GAAmBF,EAAI,QAAU,oEAChEd,SAAM,MAAMe,CAAO,EACZ,EACT,GACC,CAACtD,EAASC,EAASC,EAAasB,EAAcpB,CAAc,CAAC,EAK1DoD,GAAelC,EADG,CAAC,IAAK,IAAM,KAAM,IAAM,IAAO,IAAK,EADpC,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,GAAG,EAI1CmC,GAAe,SAAY,CAC/B,GAAI,CAACvE,EAAkB,CACrBqD,EAAM,MAAM,+CAA+C,EAC3D,MACF,CAEA,GAAI,CAACC,EAAW,CACdD,EAAM,MAAM,iCAAiC,EAC7C,MACF,CAGA,GAAKjB,GAaH,GAAIkB,EAAY,IAAS,CACvBD,EAAM,MAAM,oBAAoB7D,EAAe,IAAS,KAAK,CAAC,gCAAgC,EAC9F,MACF,MAhBe,CACX,GAAA8D,EAAYtG,EAAW,UAAW,CACpCqG,EAAM,MAAM,oBAAoB7D,EAAexC,EAAW,SAAS,CAAC,gCAAgC,EACpG,MACF,CAEA,GAAIA,EAAW,WAAasG,EAAYtG,EAAW,UAAW,CAC5DqG,EAAM,MAAM,oBAAoB7D,EAAexC,EAAW,SAAS,CAAC,8BAA8B,EAClG,MACF,EAUE,IAACuD,GAAM,GAAI,CACb8C,EAAM,MAAM,4CAA4C,EACxD,MACF,CAEA,GAAIS,GAAc,CACVT,EAAA,MAAM,yCAAyC7D,EAAe8B,CAAe,CAAC,wBAAwB9B,EAAe8D,CAAS,CAAC,GAAG,EACxIhD,EAAoB,EAAI,EACxB,MACF,CAEI,GAAA+B,GAAciB,EAAYI,EAAe,CACrCL,EAAA,MAAM,kCAAkC7D,EAAekE,CAAa,CAAC,kCAAkClE,EAAe8D,CAAS,CAAC,GAAG,EACzI,MACF,CAEI,GAAAlB,GAAckB,EAAYK,EAAe,CACrCN,EAAA,MAAM,uCAAuC7D,EAAemE,EAAe,KAAK,CAAC,kCAAkCnE,EAAe8D,EAAW,KAAK,CAAC,GAAG,EAC5J,MACF,CAGI,KAAAhB,GAAgB,CAAC0B,MAIrB,CAAA5D,EAAa,EAAI,EACb,IACEgC,GAEI,MAAA1B,EACJ1D,EAAW,GACXgD,EACAsD,EACA/C,EAAK,IAED8C,EAAA,QAAQ,8CAA8C7D,EAAe8D,EAAW,KAAK,CAAC,OAAOC,GAAgB,KAAK,GAAG,IAErH,MAAA9C,EACJzD,EAAW,GACXgD,EACAsD,EACA/C,EAAK,GACL+B,EAAgBxB,GAAW,OAAa,QAEpCuC,EAAA,QAAQ,8CAA8C7D,EAAe8D,CAAS,CAAC,OAAOC,GAAgB,KAAK,GAAG,GAG9GxD,IACRG,EAAU,EAAE,EACZD,EAAoB,EAAE,EAGHuE,GAAA5D,EAAa,CAAE,OAAQL,EAAK,GAAI,aAAcvD,EAAW,GAAI,EAChF,MAAM,QAAQ,IAAI,CAChB4D,EAAY,kBAAkB,CAAE,SAAU6D,GAAG,cAAclE,EAAK,GAAIa,CAAkB,EAAG,EACzFR,EAAY,kBAAkB,CAAE,SAAU6D,GAAG,eAAelE,EAAK,EAAE,EAAG,EACtEK,EAAY,kBAAkB,CAAE,SAAU,CAAC,cAAc,EAAG,EAC5DA,EAAY,kBAAkB,CAAE,SAAU,CAAC,MAAM,EAAG,EACrD,EACD,MAAMW,EAAgB,EAClBc,GACF,MAAMQ,EAAiB,EAErBT,GACF,MAAMF,EAAY,EAEpB,OAAO,cAAc,IAAI,YAAY,qBAAqB,CAAC,QACpDwC,EAAY,CACb,MAAAC,EAAeD,GAAO,SAAW,yBACjCrB,EAAA,MAAM,+BAA+BsB,CAAY,qBAAqB,SAC5E,CACAvE,EAAa,EAAK,CACpB,IAGF,aACGwE,GAAgB,MAAK,OAAO,QAAS,GACnC,YAGGzG,OAAAQ,EAAA,oBAAAV,EAAA,IAAC4G,EAAO,IAAP,CAEC,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACnB,WAAY,CAAE,SAAU,EAAI,EAC5B,UAAU,wDACV,QAAS9E,EACT,MAAO,CAAE,OAAQ,GAAK,GAPlB,2BAQN,EAGA9B,EAAA,IAAC,OACC,UAAU,wDACV,MAAO,CAAE,OAAQ,KAAM,cAAe,MAAO,EAE7C,SAAAE,EAAA,KAAC0G,EAAO,IAAP,CAEC,QAAS,CAAE,EAAG,OAAQ,QAAS,CAAE,EACjC,QAAS,CAAE,EAAG,EAAG,QAAS,CAAE,EAC5B,KAAM,CAAE,EAAG,OAAQ,QAAS,CAAE,EAC9B,WAAY,CAAE,KAAM,SAAU,QAAS,GAAI,UAAW,GAAI,EAC1D,UAAU,+EACV,MAAO,CAAE,cAAe,MAAO,EAC/B,QAAU3B,GAAMA,EAAE,gBAAgB,EAGlC,UAAAjF,MAAC,OAAI,UAAU,6CACb,SAACE,EAAA,YAAI,UAAU,oCACb,UAACF,EAAA,UAAG,UAAU,sCAAsC,SAAgB,qBACpEA,EAAA,IAAC,UACC,QAAS8B,EACT,UAAU,qDACV,aAAW,cAEX,SAAA9B,MAAC6G,GAAE,MAAM,EAAI,GACf,GACF,CACF,GAGA3G,OAAC,MAAI,WAAU,uCACX,WAAAwD,GAAiBC,IACjBzD,EAAA,KAAC,MAAI,WAAU,yDACb,UAAAF,EAAA,IAAC,UACC,QAAS,IAAMyD,EAAQ,QAAQ,EAC/B,UAAW,gEACTY,EAAe,mCAAqC,mCACtD,GACD,yBAED,EACCX,GACC1D,EAAA,IAAC,UACC,QAAS,IAAMyD,EAAQ,MAAM,EAC7B,UAAW,gEACTW,EAAa,mCAAqC,mCACpD,GACD,wBAED,EAEDT,GACC3D,EAAA,IAAC,UACC,QAAS,IAAMyD,EAAQ,MAAM,EAC7B,UAAW,gEACTU,EAAa,mCAAqC,mCACpD,GACD,sBAED,GAEJ,EAIFjE,OAAC,MAAI,WAAU,YACb,UAAAF,EAAA,IAAC,KAAG,WAAU,wCAAyC,SAAAjB,EAAW,MAAM,EACxEmB,OAAC,MAAI,WAAU,gDACb,UAAAA,OAAC,OAAM,WAAeqB,EAAAxC,EAAW,YAAc,CAAC,EAAE,SAAK,EACvDiB,MAAC,QAAK,SAAC,aACN,OAAM,WAAAjB,EAAW,mBAAqB,EAAE,YAAQ,EACjDiB,MAAC,QAAK,SAAC,MACTA,MAAC,QACG,UAAM,KACN,MAAM8G,EAAYC,GAAoBhI,EAAW,gBAAkBA,EAAW,eAAiB,EAAE,EACjG,OAAK+H,EACEA,IAAc,QAAU,SAAW,WAAWA,CAAS,GADvC,OAG3B,GACA,GACF,EAECzC,GACCnE,EAAA,KAAC,MAAI,WAAU,uHACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAACF,MAAAgH,GAAA,CAAW,UAAU,SAAU,UAC/B,MACC,WAAChH,EAAA,SAAE,UAAU,gBAAgB,SAAkB,uBAC/CE,OAAC,IAAE,WAAU,kBAAkB,cAAEmD,EAAgB,QAAQ,CAAC,EAAE,SAAK,GACnE,GACF,EACAnD,EAAA,KAAC,UACC,UAAU,6FACV,QAAS,IAAM,CACT,IAACoC,GAAM,GAAI,CACb8C,EAAM,MAAM,2BAA2B,EACvC,MACF,CACKW,MAGL1D,EAAoB,EAAI,CAC1B,EAEA,UAACrC,MAAAiH,GAAA,CAAa,UAAU,SAAU,GAAE,aAEtC,GACF,EAGD7C,GACClE,EAAA,KAAC,MAAI,WAAU,0HACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAACF,MAAAgH,GAAA,CAAW,UAAU,SAAU,UAC/B,MACC,WAAChH,EAAA,SAAE,UAAU,gBAAgB,SAAc,mBAC3CE,OAAC,IAAE,WAAU,mBAAmB,cAAEuF,EAAc,QAAQ,CAAC,GAAE,GAC7D,GACF,EACAvF,EAAA,KAAC,UACC,UAAU,mHACV,QAAS,IAAM,KAAKgF,GAAW,EAC/B,SAAU,CAAC5C,GAAM,IAAMkC,GAEvB,UAACxE,MAAAiH,GAAA,CAAa,UAAU,SAAU,GAAE,eAEtC,GACF,EAGD9C,GACCjE,EAAA,KAAC,MAAI,WAAU,oHACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAACF,MAAAkH,GAAA,CAAS,UAAU,SAAU,UAC7B,MACC,WAAClH,EAAA,SAAE,UAAU,gBAAgB,SAAc,yBAC1C,IAAE,WAAU,iBAAkB,SAAeuB,EAAAmE,EAAe,KAAK,EAAE,GACtE,GACF,EACAxF,EAAA,KAAC,KACC,KAAK,UACL,UAAU,2FAEV,UAACF,MAAAiH,GAAA,CAAa,UAAU,SAAU,GAAE,eAEtC,GACF,EAGD,CAAC5C,GAAgBK,UACf,MAAI,WAAU,kFACZ,SACHA,GAAA,EAIFxE,OAAC,MAAI,WAAU,YACb,UAACF,EAAA,UAAG,UAAU,4BAA4B,SAAuB,4BACjEA,MAAC,MAAI,WAAU,YACX,UAAAjB,EAAW,SAAW,IAAI,IAAKQ,GAAW,CACpC,MAAA4H,EAAc5H,EAAO,cAAgB,EACrC6H,EAAYrI,EAAW,YAAc,EACrCsI,GAAaD,EAAY,EAAI,KAAK,IAAKD,EAAcC,EAAY,IAAM,GAAG,EAAI,GAC9EE,GAAc/H,EAAO,eAAiB4H,EAAc,EAAKC,EAAYD,EAAe,GAGxF,OAAAnH,EAAA,IAACY,GAAA,CAEC,UAAWK,EACT,yCACAc,IAAqBxC,EAAO,GACxB,6BACA,uCACN,EACA,QAAS,IAAMyC,EAAoBzC,EAAO,EAAE,EAE5C,eAAC8B,GAAY,WAAU,MACrB,SAACnB,OAAA,OAAI,UAAU,oCACb,UAACA,OAAA,OAAI,UAAU,SACb,UAAAF,EAAA,IAAC,MAAI,WAAU,4BAA6B,SAAAT,EAAO,MAAM,EACzDW,OAAC,MAAI,WAAU,wBACZ,UAAAmH,GAAW,QAAQ,CAAC,EAAE,KACzB,GACF,QACC,MAAI,WAAU,aACb,SAACnH,EAAA,YAAI,UAAU,kCACZ,UAAAoH,GAAY,QAAQ,CAAC,EAAE,KAC1B,CACF,IACF,CACF,IAvBK/H,EAAO,IAAM,KAAK,OAAO,EA0BnC,GACH,GACF,EAGCS,EAAA,IAAA2G,GAAA,CAAgB,KAAK,OACnB,SACC5E,GAAA7B,EAAA,KAAC0G,EAAO,IAAP,CAEC,QAAS,CAAE,QAAS,EAAG,OAAQ,CAAE,EACjC,QAAS,CAAE,QAAS,EAAG,OAAQ,MAAO,EACtC,KAAM,CAAE,QAAS,EAAG,OAAQ,CAAE,EAC9B,WAAY,CAAE,SAAU,EAAI,EAC5B,UAAU,YAEV,UAAA1G,OAAC,MACC,WAACA,OAAA,SAAM,UAAU,+CAA+C,0BAChDiE,EAAa,QAAU,SACvC,EACAjE,OAAC,MAAI,WAAU,WACb,UAAAF,EAAA,IAACuH,GAAA,CACC,KAAK,SACL,YAAY,OACZ,MAAO/F,EACP,SAAWyD,GAAMhD,EAAUgD,EAAE,OAAO,KAAK,EACzC,UAAU,qCACV,IAAKd,EAAa,IAAMpF,EAAW,UACnC,IAAKoF,EAAawB,EAAkB5G,EAAW,WAAa4G,CAAA,CAC9D,QACC,OAAK,WAAU,qEACb,SAAAxB,EAAa,IAAM,IACtB,GACF,EACAjE,OAAC,MAAI,WAAU,+DACb,UAAAA,OAAC,OAAK,uBAAUqB,EAAeoE,EAAgBC,CAAe,GAAE,EAChE5F,EAAA,IAAC,UACC,QAAS,IAAMiC,EAAU,KAAK,MAAM0D,CAAc,EAAE,UAAU,EAC9D,UAAU,gDACX,eAED,GACF,GACF,EAGA3F,MAAC,OACC,SAACA,MAAA,OAAI,UAAU,yBACZ,SAAAqG,GAAa,IAAKmB,GACjBxH,EAAA,IAACyH,GAAA,CAEC,QAAQ,UACR,KAAK,KACL,QAAS,IAAMxF,EAAUuF,EAAY,UAAU,EAC/C,SAAUA,EAAc7B,EACxB,UAAU,eAET,WAAa,IAAI6B,EAAY,eAAgB,IAAK,IAAIA,CAAW,IAP7DA,CAAA,CASR,EACH,CACF,GAGCnC,EAAY,GACVrF,MAAAY,GAAA,CAAK,UAAU,6BACd,SAACZ,MAAAqB,GAAA,CAAY,UAAU,MACrB,SAACnB,EAAA,YAAI,UAAU,oCACb,UAAAA,OAAC,MACC,WAACF,EAAA,WAAI,UAAU,wBAAwB,SAAgB,2BACtD,MAAI,WAAU,kCACZ,SAAeuB,EAAAiE,EAAiBI,CAAe,EAClD,GACF,EACA1F,OAAC,MAAI,WAAU,aACb,UAACF,EAAA,WAAI,UAAU,wBAAwB,SAAM,WAC7CA,MAAC,OAAI,UAAWiB,EACd,gBACAuE,EAAkBH,EAAY,gBAAkB,gBAE/C,SAAA9D,EAAeiE,EAAkBH,EAAWO,CAAe,CAC9D,IACF,EACF,EACF,GACF,IA5EG,gBAAgB7D,CAAgB,IAgF3C,GACF,EAGA/B,MAAC,MAAI,WAAU,sDACb,SAAAA,EAAA,IAACyH,GAAA,CACC,QAASnB,GACT,SAAU,CAACvE,GAAoB,CAACsD,GAAanD,GAAa4D,GAC1D,UAAU,4KAET,SACC5D,EAAAhC,OAAC,MAAI,WAAU,0BACb,UAACF,MAAA,OAAI,UAAU,8EAA+E,GAC9FA,MAAC,QAAK,SAAU,eAClB,GAEAE,OAAC,MAAI,WAAU,0BACb,UAACF,MAAA0H,GAAA,CAAI,KAAM,EAAI,UACd,OAAK,gCAAmBnG,EAAe8D,EAAWO,CAAe,EAAE,KAAC,GACvE,IAGN,IAzSI,0BA0SN,EACF,EAECxD,GAAoBE,GAAM,IACzBtC,EAAA,IAAC2H,GAAA,CACC,KAAMvF,EACN,QAAS,IAAMC,EAAoB,EAAK,EACxC,UAAW,IAAM,CACfA,EAAoB,EAAK,EACTiB,GAClB,EACA,cAAeF,EACf,OAAQd,EAAK,GACf,EAEJ,EAEJ,EAEJ,ECjmBasF,GAAoB,CAAC,CAChC,QAAAC,EACA,QAAAC,EACA,WAAAC,EACA,UAAAC,EAAY,IACZ,SAAAC,EAAW,GACX,UAAAC,EAAY,IACd,IAAgC,CACxB,MAAAC,EAAaC,SAAO,EAAK,EAEzBC,EAAexD,cAAY,IAAM,CAErC,GAAIoD,GAAYH,GAAW,CAACD,GAAWM,EAAW,QAChD,OAGE,IAAAG,EACAC,EACAC,EAEAN,GAEFI,EAAYJ,EAAU,UACtBK,EAAeL,EAAU,aACzBM,EAAeN,EAAU,eAGbI,EAAA,OAAO,aAAe,SAAS,gBAAgB,UAC3DC,EAAe,SAAS,gBAAgB,aACzBC,EAAA,OAAO,aAAe,SAAS,gBAAgB,cAGrCD,GAAgBD,EAAYE,IAG7BR,IASxBG,EAAW,QAAU,GACVJ,IAGX,WAAW,IAAM,CACfI,EAAW,QAAU,IACpB,GAAI,EACT,EACC,CAACF,EAAUH,EAASD,EAASG,EAAWD,EAAYG,CAAS,CAAC,EAEjErI,mBAAU,IAAM,CACV,GAAAoI,EAAU,OAGV,IAAAQ,EACJ,MAAMC,EAAkB,IAAM,CAC5B,aAAaD,CAAS,EACVA,EAAA,WAAWJ,EAAc,GAAG,GAGpCM,EAAgBT,GAAa,OAC7BU,EAA8B,SAC9BC,EAA6B,YAEnC,OAAAF,EAAc,iBAAiBC,EAAiBF,EAAiB,CAAE,QAAS,GAAM,EAG7ER,GACH,OAAO,iBAAiBW,EAAgBH,EAAiB,CAAE,QAAS,GAAM,EAGrE,IAAM,CACGC,EAAA,oBAAoBC,EAAiBF,CAAe,EAC7DR,GACI,2BAAoBW,EAAgBH,CAAe,EAE5D,aAAaD,CAAS,EAEvB,GAACJ,EAAcJ,EAAUC,CAAS,CAAC,EAc/B,CACL,gBAZsBrD,cAAY,IAAM,CACpC,CAACoD,GAAY,CAACH,GAAWD,GAAW,CAACM,EAAW,UAElDA,EAAW,QAAU,GACVJ,IACX,WAAW,IAAM,CACfI,EAAW,QAAU,IACpB,GAAI,IAER,CAACF,EAAUH,EAASD,EAASE,CAAU,CAAC,CAGzC,CAEJ,EC3FMe,GAAkBC,GAAM,KAAK,SAAyB,CAC1D,mBAAAC,EACA,SAAAC,EACA,WAAAC,EACA,UAAAhH,CACF,EAKG,CACD,KAAM,CAACiH,EAAeC,CAAgB,EAAIxJ,WAAS,EAAK,EAGlDyJ,EAAgBH,EAAW,MAAM,EAAG,CAAC,EACrCI,EAAiBJ,EAAW,MAAM,CAAC,EAEzC,OAAIhH,EAEAlC,EAAA,IAAC,MAAI,WAAU,+DACb,SAAAA,MAAC,MAAI,WAAU,aACZ,UAAC,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKuJ,GACvBvJ,MAAC,MAAY,WAAU,iDAAb,EAAAuJ,CAA+D,CAC1E,CACH,EACF,GAMArJ,EAAA,KAAAQ,WAAA,WAAAV,EAAA,IAAC,OACC,UAAU,+DACV,YAAU,mBACV,eAAa,mBAEb,eAAC,MAAI,WAAU,mDACb,SAACE,OAAA,OAAI,UAAU,aAEb,UAAAF,EAAA,IAAC,UACC,QAAS,IAAMiJ,EAAS,IAAI,EAC5B,MAAO,CACL,OAAQ,OACR,UAAW,OACX,QAAS,SACT,QAAS,cACT,WAAY,SACZ,eAAgB,SAChB,SAAU,OACV,WAAY,IACZ,WAAY,EACZ,aAAc,OACd,OAAQ,OACR,OAAQ,UACR,WAAY,SACZ,WAAY,EACZ,WAAY,WACZ,gBAAiBD,IAAuB,KAAO,UAAY,UAC3D,MAAOA,IAAuB,KAAO,UAAY,SACnD,EACA,aAAe/D,GAAM,CACf+D,IAAuB,OACvB/D,EAAA,cAAc,MAAM,gBAAkB,UAE5C,EACA,aAAeA,GAAM,CACf+D,IAAuB,OACvB/D,EAAA,cAAc,MAAM,gBAAkB,UAE5C,EACA,YAAU,sBACX,eAED,EAGCoE,EAAc,IAAKG,GAClBxJ,EAAA,IAAC,UAEC,QAAS,IAAMiJ,EAASO,EAAS,EAAE,EACnC,MAAO,CACL,OAAQ,OACR,UAAW,OACX,QAAS,SACT,QAAS,cACT,WAAY,SACZ,eAAgB,SAChB,SAAU,OACV,WAAY,IACZ,WAAY,EACZ,aAAc,OACd,OAAQ,OACR,OAAQ,UACR,WAAY,SACZ,WAAY,EACZ,WAAY,WACZ,gBAAiBR,IAAuBQ,EAAS,GAAK,UAAY,UAClE,MAAOR,IAAuBQ,EAAS,GAAK,UAAY,SAC1D,EACA,aAAevE,GAAM,CACf+D,IAAuBQ,EAAS,KAChCvE,EAAA,cAAc,MAAM,gBAAkB,UAE5C,EACA,aAAeA,GAAM,CACf+D,IAAuBQ,EAAS,KAChCvE,EAAA,cAAc,MAAM,gBAAkB,UAE5C,EACA,YAAU,sBAET,SAASuE,EAAA,OAjCLA,EAAS,GAmCjB,EAGAF,EAAe,OAAS,GACvBpJ,EAAA,KAAC,UACC,QAAS,IAAMkJ,EAAiB,EAAI,EACpC,MAAO,CACL,OAAQ,OACR,UAAW,OACX,QAAS,SACT,QAAS,cACT,WAAY,SACZ,eAAgB,SAChB,IAAK,MACL,SAAU,OACV,WAAY,IACZ,WAAY,EACZ,aAAc,OACd,OAAQ,OACR,OAAQ,UACR,WAAY,SACZ,WAAY,EACZ,WAAY,WACZ,gBAAiB,UACjB,MAAO,SACT,EACA,aAAenE,GAAM,CACjBA,EAAA,cAAc,MAAM,gBAAkB,SAC1C,EACA,aAAeA,GAAM,CACjBA,EAAA,cAAc,MAAM,gBAAkB,SAC1C,EACD,iBAECjF,MAACyJ,GAAY,WAAU,SAAU,IACnC,GAEJ,CACF,GACF,EAGCH,EAAe,OAAS,GACvBtJ,MAAC0J,GAAA,CAAY,KAAMP,EAAe,aAAcC,EAC9C,SAAClJ,EAAA,KAAAyJ,GAAA,CACC,UAAA3J,MAAC4J,GAAA,CAAe,UAAU,sDAAuD,GAChF1J,OAAA2J,GAAA,CAAe,UAAU,iJACxB,UAAC3J,OAAA,OAAI,UAAU,kGACb,UAAAF,EAAA,IAAC8J,GAAA,CAAa,UAAU,sCAAsC,SAAc,mBAC5E9J,MAAC+J,GAAA,CAAa,UAAU,mCACtB,SAAC/J,MAAA6G,GAAA,CAAE,UAAU,wBAAwB,CACvC,IACF,EACA3G,OAAC,MAAI,WAAU,sBACb,UAAAF,EAAA,IAAC,UACC,QAAS,IAAM,CACbiJ,EAAS,IAAI,EACbG,EAAiB,EAAK,CACxB,EACA,UAAW,2DACTJ,IAAuB,KACnB,2BACA,4CACN,GACD,eAED,EACCM,EAAe,IAAKE,GACnBxJ,EAAA,IAAC,UAEC,QAAS,IAAM,CACbiJ,EAASO,EAAS,EAAE,EACpBJ,EAAiB,EAAK,CACxB,EACA,UAAW,2DACTJ,IAAuBQ,EAAS,GAC5B,2BACA,4CACN,GAEC,SAASA,EAAA,OAXLA,EAAS,GAajB,GACH,GACF,GACF,CACF,EAEJ,GAEJ,CAAC,EAEDV,GAAgB,YAAc,kBAG9B,MAAMkB,GAAwBjB,GAAM,KAAK,SAA+B,CACtE,MAAAkB,EACA,YAAAC,EACA,eAAAC,CACF,EAIG,CAEC,OAAAnK,EAAA,IAAC,OACC,UAAU,0BACV,YAAU,kBACV,eAAa,kBAKb,gBAAC,MAAI,WAAU,WAAW,YAAU,aAAa,eAAa,aAC5D,UAAAA,MAAC,OAAI,UAAU,uEACb,eAACoK,GAAO,WAAU,wBAAwB,CAC5C,GACApK,EAAA,IAAC,SACC,KAAK,OACL,YAAY,wBACZ,MAAOkK,EACP,SAAWjF,GAAMkF,EAAelF,EAAE,OAAO,KAAK,EAC9C,UAAU,gLACZ,GACF,GAGN,CAAC,EAED+E,GAAsB,YAAc,wBAG9B,MAAAK,GAAetB,GAAM,KAAK,SAAsB,CAAE,oBAAAuB,EAAqB,uBAAAC,GAA6C,CACvGhI,GAAa,EACbiI,GAAY,EAC7B,KAAM,CAAE,WAAAtB,EAAY,UAAWuB,GAAsBC,GAAc,EAC7D,CACJ,YAAAC,EACA,QAAA7C,EACA,YAAA8C,EACA,WAAAC,EACA,QAAAC,EACA,mBAAAC,EACA,oBAAAC,EACA,WAAAC,GACEvI,GAAmB,EAEjB,CAACwI,EAAoBC,CAAqB,EAAIvL,WAA4B,IAAI,EAC9E,CAACwL,EAAuBC,CAAwB,EAAIzL,WAAS,EAAK,EAClE,CAACoJ,EAAoBsC,CAAqB,EAAI1L,WAAwB,IAAI,EAE1E,CAAC2L,EAAeC,CAAgB,EAAI5L,WAAS,CACjD,YAAa,IACb,kBAAmB,EACnB,WAAY,IACZ,UAAW,EACX,SAAU,EACX,EAGK6L,EAAqB5G,cAAY,SAAY,CAC7C,IAEF,KAAM,CAAE,UAAAE,CAAA,EAAc,MAAA2G,GAAA,IAAM,OAAO,qBAAqB,OAAAC,KAAA,wKAClDC,EAAW,MAAM,MAAM,GAAG7G,EAAW,qCAAoC,EAC/E,GAAI6G,EAAS,GAAI,CACT,MAAAC,EAAO,MAAMD,EAAS,OACxBC,EAAK,SACPL,EAAiBK,EAAK,IAAI,CAE5B,OAIY,CAEhB,CACF,EAAG,CAAE,GAGajE,GAAA,CAChB,QAASiD,EAAW,QACpB,QAASD,EACT,WAAY,IAAM,CAOII,GACtB,EACA,UAAW,IACZ,EAGDnL,YAAU,IAAM,CACKkL,IACAU,GAAA,EAClB,CAACV,EAAoBU,CAAkB,CAAC,EAGrC,MAAAxB,EAAQ6B,UAAQ,KAAO,CAC3B,YAAaP,EAAc,YAC3B,kBAAmBA,EAAc,kBACjC,WAAYA,EAAc,aACxB,CAACA,CAAa,CAAC,EAGbQ,EAAqBD,UAAQ,IAAM,CACvC,GAAI,CAAC,MAAM,QAAQnB,CAAW,EAE5B,MAAO,GAGH,MAAAqB,EAAM,KAAK,MAeV,OAdmBrB,EAAY,OAAQ5L,GAAe,CAC3D,GAAI,CAACA,GAAc,CAACA,EAAW,IAAM,CAACA,EAAW,MAExC,SAGH,MAAA8C,GAAU9C,EAAW,QAAU,UAAY,OAC3CkN,EAAalN,EAAW,eAAiB,IAAI,KAAKA,EAAW,cAAc,EAAE,UAAY,OAAO,kBAChGmN,EAAY,OAAO,SAASD,CAAU,GAAKA,GAAcD,EAE/D,OAAOnK,GAAU,CAACqK,CAAA,CACnB,CAGM,EACN,CAACvB,CAAW,CAAC,EAGM9F,EAAY,YAAC9F,GAA2B,CAC5DoM,EAAsBpM,CAAU,EAChCsM,EAAyB,EAAI,CAC/B,EAAG,EAAE,EAEC,MAAAc,EAA6BtH,cAAauH,GAAyB,CACnE7B,EACFA,EAAuB6B,CAAY,EAE5B,gBAAS,KAAO,eAAeA,CAAY,EACpD,EACC,CAAC7B,CAAsB,CAAC,EAER1F,EAAY,YAACuH,GAAyB,CACvDhH,GAAM,QAAQ,mBAAmB,CACnC,EAAG,EAAE,EAEiBP,EAAY,YAACuH,GAAyB,CAC1DD,EAA2BC,CAAY,GACtC,CAACD,CAA0B,CAAC,EAEXtH,EAAY,YAAC9F,GAA2B,CACpD,MAAAsN,EAAY,8BAA8BtN,EAAW,KAAK,GAC1DuN,EAAW,GAAG,OAAO,SAAS,MAAM,eAAevN,EAAW,EAAE,GAElE,UAAU,MACZ,UAAU,MAAM,CACd,MAAOA,EAAW,MAClB,KAAMsN,EACN,IAAKC,CACN,GAAE,MAAM,QAAQ,KAAK,EAEZ,oBAAU,UAAU,GAAGD,CAAS;AAAA,EAAKC,CAAQ,EAAE,EACtD,KAAK,IAAMlH,GAAM,QAAQ,2BAA2B,CAAC,EACrD,MAAM,IAAMA,GAAM,MAAM,qBAAqB,CAAC,CAErD,EAAG,EAAE,EAEC,MAAAmH,EAAqB1H,cAAa2H,GAAkB,CAE7CvB,EAAA,CAAE,OAAQuB,CAAA,CAAO,GAC3B,CAACvB,CAAU,CAAC,EAETwB,EAAuB5H,cAAa6H,GAA8B,CAEtEpB,EAAsBoB,CAAU,EAGnBzB,EADTyB,EACS,CAAE,SAAUA,CAAA,EAEZ,CAAE,SAAU,MAFY,CAGrC,EACC,CAACzB,CAAU,CAAC,EAET0B,EAAmB9H,cAAY,IAAM,CACzCwG,EAAyB,EAAK,EAC9BF,EAAsB,IAAI,CAC5B,EAAG,CAAE,GAGL,OAAIrD,IAAY,CAAC6C,GAAeA,EAAY,SAAW,GAEnDzK,EAAA,KAAC,MAAI,WAAU,0BAEb,UAACA,OAAA,OAAI,UAAU,oCACb,UAACF,MAAA,OAAI,UAAU,MAAO,GACtBE,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,yCACb,UAAAA,OAAC,MACC,WAACF,MAAA,OAAI,UAAU,oDAAqD,GACpEA,MAAC,MAAI,WAAU,+CAAgD,IACjE,EACAA,MAAC,MAAI,WAAU,qDAAsD,IACvE,EACAE,OAAC,MAAI,WAAU,oDACb,UAACF,MAAA,OAAI,UAAU,oDAAqD,GACpEE,OAAC,MAAI,WAAU,yBACb,UAACA,OAAA,OAAI,UAAU,cACb,UAACF,MAAA,OAAI,UAAU,+CAAgD,GAC/DA,MAAC,MAAI,WAAU,uDAAwD,IACzE,EACAE,OAAC,MAAI,WAAU,cACb,UAACF,MAAA,OAAI,UAAU,+CAAgD,GAC/DA,MAAC,MAAI,WAAU,uDAAwD,IACzE,EACAE,OAAC,MAAI,WAAU,cACb,UAACF,MAAA,OAAI,UAAU,+CAAgD,GAC/DA,MAAC,MAAI,WAAU,uDAAwD,IACzE,GACF,GACF,EACAA,MAAC,MAAI,WAAU,8CAA+C,IAChE,GACF,EAGAA,MAAC,MAAI,WAAU,8CACb,SAAAA,EAAA,IAAC,MAAI,WAAU,6BACZ,UAAC,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKuJ,GACvBvJ,EAAA,IAAC,MAAY,WAAU,kEAAb,EAAAuJ,CAAgF,CAC3F,EACH,CACF,GAGArJ,OAAC,MAAI,WAAU,OACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACF,MAAA,OAAI,UAAU,oDAAqD,GACpEA,MAAC,MAAI,WAAU,+CAAgD,IACjE,QAGC,MAAI,WAAU,YACZ,SAAC,GAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKuJ,SACnB5I,GAA8B,GAAA4I,CAAG,CACnC,EACH,GACF,CACF,IAKFrJ,EAAA,KAAC,OACC,UAAU,wCAGV,UAAAF,EAAA,IAAC4M,GAAU,OAAM,WAAW,kBAAiB,GAAC,EAG9C5M,EAAA,IAACgK,GAAA,CACC,MAAAC,EACA,YAAaa,EAAQ,OACrB,eAAgByB,CAAA,CAClB,EAGAvM,MAAC,MAAI,WAAU,2BAA2B,MAAO,CAAE,SAAU,WAAY,OAAQ,EAC/E,WAAAA,EAAA,IAAC8I,GAAA,CACC,mBAAAE,EACA,SAAUyD,EACV,WAAAvD,EACA,UAAWuB,CAAA,GAEf,EAGCzK,MAAA,OAAI,UAAU,6BAEb,eAAC,MAAI,WAAU,YACb,SAAAA,MAAC2G,IAAgB,KAAK,OACnB,SAAmBoF,EAAA,OAAS,EAExB7L,OAAAQ,EAAA,oBAAmBqL,EAAA,IAAI,CAAChN,EAAYyB,IAE/B,CAACzB,GAAc,CAACA,EAAW,GAEtB,KAIPiB,EAAA,IAAClB,GAAA,CAEC,WAAY,CACV,GAAIC,EAAW,GACf,MAAOA,EAAW,MAClB,SAAUA,EAAW,SACrB,OAAQA,EAAW,eACnB,KAAMA,EAAW,WACjB,QAASA,EAAW,kBACpB,QAASA,EAAW,SAAS,MAAM,EAAG,CAAC,EAAE,IAAY8N,IAAA,CACnD,MAAOA,EAAI,MACX,KAAMA,EAAI,cACV,EACF,YAAa9N,EAAW,WAC1B,GAbK,GAAGA,EAAW,EAAE,IAAIyB,CAAK,GAgBnC,EAGAoK,GACC1K,EAAA,KAAC0G,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAC7B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,UAAU,wCAEV,UAAC5G,MAAA8M,GAAA,CAAQ,UAAU,2CAA4C,GAC9D9M,EAAA,YAAK,UAAU,gBAAgB,SAA2B,iCAC7D,EAID6K,EAAW,SAAW,CAACD,GACtB1K,EAAA,KAAC0G,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,UAAU,mBAEV,UAAA1G,EAAA,KAAC,UACC,QAAS,IAAM,CAEO8K,GACtB,EACA,UAAU,kGACX,wBACaH,EAAW,MAAQkB,EAAmB,OAAO,eAC3D,EACA7L,OAAC,IAAE,WAAU,6BAA6B,kBAClC2K,EAAW,KAAK,MAAIkB,EAAmB,OAAO,IAAElB,EAAW,OACnE,GACF,EAID,CAACA,EAAW,SAAW,CAACD,GAAemB,EAAmB,OAAS,IAClE/L,EAAA,IAAC4G,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,UAAU,mBAEV,SAAC5G,EAAA,SAAE,UAAU,wBAAwB,SAErC,oCACF,GAEJ,EAEAE,EAAA,KAAC0G,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAC7B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,KAAM,CAAE,QAAS,EAAG,EAAG,GAAI,EAC3B,UAAU,yBAEV,UAAC5G,MAAA,OAAI,UAAU,mFACb,SAAAA,EAAA,IAAC+M,IAAW,KAAM,GAAI,UAAU,gBAAgB,CAClD,GACC/M,EAAA,UAAG,UAAU,2CAA2C,SAAoB,yBAC5EA,EAAA,SAAE,UAAU,gBACV,SAAQ8K,EAAA,OACL,yBAAyBA,EAAQ,MAAM,IACvChD,EACE,yBACA,iDAER,EACC,CAACA,GAAW,CAACgD,EAAQ,QACpB9K,EAAA,IAAC,UACC,QAAS,IAAM+K,EAAmB,EAAI,EACtC,UAAU,2FACX,+BAED,IAIR,EACF,GACF,EAGA/K,EAAA,IAAC4B,GAAA,CACC,WAAYsJ,EACZ,OAAQE,EACR,QAASuB,CAAA,CACX,IAGN,CAAC,EAEDtC,GAAa,YAAc","names":["PredictionCardV3","prediction","location","useLocation","fromPath","derivedKeywords","value","identityAttributes","metadata","option","media","useMedia","imageLoaded","setImageLoaded","useState","useEffect","endsIn","formatDurationShort","jsx","Link","jsxs","categoryLabel","getCategoryLabel","CreatorByline","formatNumberShort","o","index","optionLabel","Fragment","PredictionCardV3Skeleton","Card","React.forwardRef","className","props","ref","cn","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","formatCurrency","amount","currency","calculatePotentialPayout","odds","PlacePredictionModal","isOpen","onClose","selectedOptionId","setSelectedOptionId","setAmount","isLoading","setIsLoading","showDepositModal","setShowDepositModal","user","useAuthStore","placePrediction","placeFiatPrediction","usePredictionStore","queryClient","useQueryClient","address","chainId","isConnected","useAccount","sessionHealthy","useWeb3Recovery","walletAddressLower","walletUSDC","escrowAvailable","refetchBalances","useUnifiedBalance","mode","setMode","isDemoEnabled","isFiatEnabled","setFiatEnabled","useFundingModeStore","paystackStatus","usePaystackStatus","fiatData","refetchFiat","useFiatSummary","isFiatMode","isDemoMode","isCryptoMode","demoSummary","setDemoSummary","demoLoading","setDemoLoading","demoError","setDemoError","fetchDemoSummary","useCallback","resp","getApiUrl","json","e","faucetDemo","setCooldown","toast","numAmount","selectedOption","selectedOptionOdds","potentialPayout","demoAvailable","fiatAvailable","displayBalance","displayCurrency","needsDeposit","insufficientBalance","ensureCryptoWalletReady","ensureWalletReady","baseSepolia","err","message","WalletStateError","quickAmounts","handleSubmit","invalidateAfterBet","QK","error","errorMessage","AnimatePresence","motion","X","timeLabel","formatTimeRemaining","WalletIcon","ArrowUpRight","Banknote","totalStaked","poolTotal","percentage","currentOdds","Input","quickAmount","Button","Zap","DepositUSDCModal","useInfiniteScroll","hasNext","loading","onLoadMore","threshold","disabled","container","loadingRef","useRef","handleScroll","scrollTop","scrollHeight","clientHeight","timeoutId","throttledScroll","scrollElement","scrollEventName","touchEventName","CategoryFilters","React","selectedCategoryId","onSelect","categories","showMoreSheet","setShowMoreSheet","topCategories","moreCategories","i","category","ChevronDown","Dialog.Root","Dialog.Portal","Dialog.Overlay","Dialog.Content","Dialog.Title","Dialog.Close","DiscoverHeaderContent","stats","searchQuery","onSearchChange","Search","DiscoverPage","onNavigateToProfile","onNavigateToPrediction","useNavigate","categoriesLoading","useCategories","predictions","loadingMore","pagination","filters","refreshPredictions","loadMorePredictions","setFilters","selectedPrediction","setSelectedPrediction","isPredictionModalOpen","setIsPredictionModalOpen","setSelectedCategoryId","platformStats","setPlatformStats","fetchPlatformStats","__vitePreload","n","response","data","useMemo","displayPredictions","now","deadlineMs","isExpired","handleNavigateToPrediction","predictionId","shareText","shareUrl","handleSearchChange","query","handleCategorySelect","categoryId","handleModalClose","AppHeader","opt","Loader2","TrendingUp"],"sources":["../../src/components/predictions/PredictionCardV3.tsx","../../src/components/ui/card.tsx","../../src/components/predictions/PlacePredictionModal.tsx","../../src/hooks/useInfiniteScroll.ts","../../src/pages/DiscoverPage.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport { useMedia } from '../../hooks/useMedia';\nimport { formatNumberShort, formatDurationShort } from '@/lib/format';\nimport CreatorByline from './CreatorByline';\nimport { getCategoryLabel } from '@/lib/categoryUi';\n\ntype PredictionCardProps = {\n  prediction: {\n  id: string;\n  title: string;\n    category?: string;\n    endsAt?: string;       // ISO\n    pool?: number;         // total pool in base units\n    players?: number;      // participants\n    options?: Array<{ label?: string; title?: string; text?: string; odds?: number }>;\n    description?: string | null;\n    creator?: {\n      id?: string;\n      username?: string | null;\n      full_name?: string | null;\n      avatar_url?: string | null;\n      is_verified?: boolean | null;\n    };\n  };\n};\n\nexport default function PredictionCardV3({ prediction }: PredictionCardProps) {\n  // Add null check to prevent errors when prediction is undefined\n  if (!prediction) {\n    return null;\n  }\n\n  const location = useLocation();\n  const fromPath = `${location.pathname}${location.search}${location.hash}`;\n\n  const derivedKeywords = [\n    prediction.category,\n    prediction.creator?.username ?? undefined,\n    prediction.creator?.full_name ?? undefined,\n  ].filter((value): value is string => Boolean(value));\n\n  const identityAttributes = [\n    prediction.creator?.is_verified ? 'verified creator' : undefined,\n  ].filter((value): value is string => Boolean(value));\n\n  const metadata = {\n    id: prediction.id,\n    title: prediction.title,\n    description: prediction.description ?? '',\n    category: prediction.category,\n    options: prediction.options?.map((option) => ({\n      label: option?.label ?? option?.title ?? option?.text ?? '',\n    })),\n    keywords: derivedKeywords,\n    attributes: identityAttributes,\n    tags: derivedKeywords,\n    identity: {\n      creator: prediction.creator?.full_name || prediction.creator?.username || null,\n      community: prediction.category ? `${prediction.category} community` : null,\n      personas: identityAttributes,\n    },\n    popularity: {\n      pool: typeof prediction.pool === 'number' ? prediction.pool : null,\n      players: typeof prediction.players === 'number' ? prediction.players : null,\n    },\n  };\n\n  const { media } = useMedia(prediction.id, metadata);\n\n  const [imageLoaded, setImageLoaded] = useState(false);\n\n  useEffect(() => {\n    setImageLoaded(false);\n  }, [media.url]);\n\n  // formatDurationShort expects milliseconds; provide ms to avoid truncation to minutes\n  const endsIn = prediction.endsAt\n    ? formatDurationShort(Math.max(0, new Date(prediction.endsAt).getTime() - Date.now()))\n    : null;\n\n  return (\n    <Link\n      to={`/prediction/${prediction.id}`}\n      state={{ from: fromPath }}\n      className=\"block rounded-2xl border border-black/5 bg-white hover:shadow-sm focus-visible:ring-2 focus-visible:ring-indigo-500 transition\"\n    >\n      <div className=\"flex items-stretch gap-3 p-3\">\n        {/* Left: text */}\n        <div className=\"min-w-0 flex-1\">\n          <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n            {(() => {\n              const categoryLabel = getCategoryLabel(prediction);\n              return categoryLabel ? (\n                <span className=\"rounded-full bg-gray-100 px-2 py-0.5 font-medium\">{categoryLabel}</span>\n              ) : null;\n            })()}\n            {endsIn && <span className=\"rounded-full bg-gray-100 px-2 py-0.5\">ends in {endsIn}</span>}\n        </div>\n\n          <h3 className=\"mt-1 line-clamp-2 text-[15px] font-semibold text-gray-900\">\n            {prediction.title}\n        </h3>\n\n          {prediction.creator && (\n            <CreatorByline creator={prediction.creator} className=\"mt-1.5 text-xs\" />\n          )}\n\n          <div className=\"mt-2 flex flex-wrap items-center gap-3 text-xs text-gray-500\">\n            {typeof prediction.pool === 'number' && (\n              <span>${formatNumberShort(prediction.pool)} pool</span>\n            )}\n            {typeof prediction.players === 'number' && <span>{prediction.players} players</span>}\n            {prediction.options?.length ? (\n              <div className=\"flex items-center gap-1\">\n                {prediction.options.slice(0, 2).map((o, index) => {\n                  const optionLabel = o.label ?? o.title ?? o.text ?? `Option ${index + 1}`;\n                  return (\n                    <span\n                    key={`${optionLabel}-${index}`}\n                    className=\"rounded-md border border-gray-200 px-1.5 py-0.5 text-[11px] font-medium text-gray-700\"\n                  >\n                    {optionLabel}\n                    {o.odds ? (\n                      <span className=\"ml-1 text-gray-500\">{o.odds.toFixed(2)}x</span>\n                    ) : null}\n                    </span>\n                  );\n                })}\n          </div>\n            ) : null}\n        </div>\n      </div>\n\n        {/* Right: thumbnail (fixed) */}\n        <div className=\"relative h-[72px] w-[96px] shrink-0 overflow-hidden rounded-xl bg-gray-100\">\n          {media.url ? (\n            <>\n              {!imageLoaded && (\n                <div className=\"absolute inset-0 animate-pulse bg-gray-200\" />\n              )}\n              <img\n                src={media.url}\n                alt={media.alt || prediction.title}\n                className=\"h-full w-full object-cover transition-opacity duration-300\"\n                loading=\"lazy\"\n                onLoad={() => setImageLoaded(true)}\n                onError={() => setImageLoaded(false)}\n                style={{ opacity: imageLoaded ? 1 : 0, transition: 'opacity 200ms ease' }}\n              />\n            </>\n          ) : (\n            <div className=\"absolute inset-0 bg-gradient-to-br from-gray-200 via-gray-100 to-gray-300\" />\n          )}\n        </div>\n      </div>\n    </Link>\n  );\n}\n\nexport function PredictionCardV3Skeleton() {\n  return (\n    <div className=\"rounded-2xl border border-black/5 bg-white p-3\">\n      <div className=\"flex items-stretch gap-3\">\n        <div className=\"min-w-0 flex-1\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <div className=\"h-4 w-12 bg-gray-200 rounded-full animate-pulse\" />\n            <div className=\"h-4 w-16 bg-gray-200 rounded-full animate-pulse\" />\n        </div>\n          <div className=\"h-4 w-full bg-gray-200 rounded animate-pulse mb-1\" />\n          <div className=\"h-4 w-3/4 bg-gray-200 rounded animate-pulse mb-2\" />\n          <div className=\"flex items-center gap-3\">\n            <div className=\"h-3 w-16 bg-gray-200 rounded animate-pulse\" />\n            <div className=\"h-3 w-12 bg-gray-200 rounded animate-pulse\" />\n          </div>\n        </div>\n        <div className=\"h-[72px] w-[96px] bg-gray-200 rounded-xl animate-pulse\" />\n      </div>\n    </div>\n  );\n}","import * as React from 'react';\nimport { cn } from '../../lib/utils';\n\nexport interface CardProps extends React.HTMLAttributes<HTMLDivElement> {}\n\nconst Card = React.forwardRef<HTMLDivElement, CardProps>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      className={cn(\n        'rounded-xl border bg-card text-card-foreground shadow-sm',\n        className\n      )}\n      {...props}\n    />\n  )\n);\nCard.displayName = 'Card';\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn('flex flex-col space-y-1.5 p-6', className)}\n    {...props}\n  />\n));\nCardHeader.displayName = 'CardHeader';\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn('font-semibold leading-none tracking-tight', className)}\n    {...props}\n  />\n));\nCardTitle.displayName = 'CardTitle';\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn('text-sm text-muted-foreground', className)}\n    {...props}\n  />\n));\nCardDescription.displayName = 'CardDescription';\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />\n));\nCardContent.displayName = 'CardContent';\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn('flex items-center p-6 pt-0', className)}\n    {...props}\n  />\n));\nCardFooter.displayName = 'CardFooter';\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Zap, X, Wallet as WalletIcon, ArrowUpRight, Banknote } from 'lucide-react';\nimport { Button } from '../ui/button';\nimport { Input } from '../ui/input';\nimport { Card, CardContent } from '../ui/card';\nimport { Prediction } from '../../store/predictionStore';\nimport { usePredictionStore } from '../../store/predictionStore';\nimport { useAuthStore } from '../../store/authStore';\nimport toast from 'react-hot-toast';\nimport { formatTimeRemaining } from '@/lib/utils';\nimport { useUnifiedBalance } from '@/hooks/useUnifiedBalance';\nimport DepositUSDCModal from '@/components/wallet/DepositUSDCModal';\nimport { useAccount } from 'wagmi';\nimport { baseSepolia } from 'wagmi/chains';\nimport { useQueryClient } from '@tanstack/react-query';\nimport { QK } from '@/lib/queryKeys';\nimport { invalidateAfterBet } from '@/utils/queryInvalidation';\nimport { cn } from '@/lib/utils';\nimport { ensureWalletReady, WalletStateError } from '@/services/onchainTransactionService';\nimport { useWeb3Recovery } from '@/providers/Web3Provider';\nimport { useFundingModeStore, FundingMode } from '@/store/fundingModeStore';\nimport { getApiUrl } from '@/config';\nimport { setCooldown } from '@/lib/cooldowns';\nimport { usePaystackStatus, useFiatSummary } from '@/hooks/useFiatWallet';\n\ninterface PlacePredictionModalProps {\n  prediction: Prediction | null;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\n// Utility functions\nconst formatCurrency = (amount: number, currency: 'USD' | 'NGN' = 'USD') => {\n  return new Intl.NumberFormat(currency === 'NGN' ? 'en-NG' : 'en-US', {\n    style: 'currency',\n    currency,\n    minimumFractionDigits: 0,\n    maximumFractionDigits: currency === 'NGN' ? 0 : 2,\n  }).format(amount);\n};\n\nconst calculatePotentialPayout = (amount: number, odds: number) => {\n  return amount * odds;\n};\n\nexport const PlacePredictionModal: React.FC<PlacePredictionModalProps> = ({\n  prediction,\n  isOpen,\n  onClose,\n}) => {\n  // Early return if no prediction\n  if (!prediction || !isOpen) return null;\n  \n  const [selectedOptionId, setSelectedOptionId] = useState<string>('');\n  const [amount, setAmount] = useState<string>('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showDepositModal, setShowDepositModal] = useState(false);\n  \n  const { user } = useAuthStore();\n  const { placePrediction, placeFiatPrediction } = usePredictionStore();\n  const queryClient = useQueryClient();\n  const { address, chainId, isConnected } = useAccount();\n  const { sessionHealthy } = useWeb3Recovery();\n  const walletAddressLower = address?.toLowerCase() ?? null;\n  const { wallet: walletUSDC, available: escrowAvailable, refetch: refetchBalances } = useUnifiedBalance();\n  const { mode, setMode, isDemoEnabled, isFiatEnabled, setFiatEnabled } = useFundingModeStore();\n  \n  // Fiat-related hooks\n  const { data: paystackStatus } = usePaystackStatus();\n  const { data: fiatData, refetch: refetchFiat } = useFiatSummary(user?.id);\n  \n  // Update fiat enabled state from API\n  useEffect(() => {\n    if (paystackStatus?.enabled !== undefined) {\n      setFiatEnabled(paystackStatus.enabled);\n    }\n  }, [paystackStatus?.enabled, setFiatEnabled]);\n  \n  const isFiatMode = isFiatEnabled && mode === 'fiat';\n  const isDemoMode = isDemoEnabled && mode === 'demo';\n\n  const BASE_BETS_ENABLED =\n    import.meta.env.VITE_FCZ_BASE_BETS === '1' ||\n    import.meta.env.ENABLE_BASE_BETS === '1' ||\n    import.meta.env.VITE_FCZ_BASE_ENABLE === '1';\n  const isCryptoMode = !isDemoMode && !isFiatMode;\n\n  const [demoSummary, setDemoSummary] = useState<null | { available: number; reserved: number; total: number }>(null);\n  const [demoLoading, setDemoLoading] = useState(false);\n  const [demoError, setDemoError] = useState<string | null>(null);\n\n  const fetchDemoSummary = useCallback(async () => {\n    if (!user?.id) return;\n    try {\n      setDemoLoading(true);\n      setDemoError(null);\n      const resp = await fetch(`${getApiUrl()}/api/demo-wallet/summary?userId=${user.id}`);\n      const json = await resp.json().catch(() => null);\n      if (!resp.ok) throw new Error(json?.message || 'Failed to load demo credits');\n      setDemoSummary(json?.summary ?? null);\n    } catch (e: any) {\n      setDemoError(e?.message || 'Failed to load demo credits');\n      setDemoSummary(null);\n    } finally {\n      setDemoLoading(false);\n    }\n  }, [user?.id]);\n\n  const faucetDemo = useCallback(async () => {\n    if (!user?.id) return;\n    try {\n      setDemoLoading(true);\n      setDemoError(null);\n      const resp = await fetch(`${getApiUrl()}/api/demo-wallet/faucet`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId: user.id }),\n      });\n      const json = await resp.json().catch(() => null);\n      if (!resp.ok) throw new Error(json?.message || 'Failed to get demo credits');\n      setDemoSummary(json?.summary ?? null);\n      if (json?.nextEligibleAt) {\n        setCooldown(`fcz_demo_credits_next_at:${user.id}`, String(json.nextEligibleAt));\n      }\n      if (json?.alreadyGranted) {\n        toast.error('Demo credits not yet available. Please try again later.');\n      } else {\n        toast.success('Demo credits added.');\n      }\n    } catch (e: any) {\n      setDemoError(e?.message || 'Failed to get demo credits');\n    } finally {\n      setDemoLoading(false);\n    }\n  }, [user?.id]);\n\n  useEffect(() => {\n    if (isDemoMode) {\n      void fetchDemoSummary();\n    }\n  }, [isDemoMode, fetchDemoSummary]);\n\n  const numAmount = parseFloat(amount) || 0;\n  const selectedOption = prediction?.options?.find(o => o.id === selectedOptionId);\n  const selectedOptionOdds = selectedOption?.current_odds || (selectedOption?.total_staked ? (prediction?.pool_total / selectedOption.total_staked) : 2.0);\n  const potentialPayout = selectedOption ? calculatePotentialPayout(numAmount, selectedOptionOdds) : 0;\n  const demoAvailable = demoSummary?.available ?? 0;\n  const fiatAvailable = fiatData?.summary?.availableNgn ?? 0;\n  \n  // Display balance depends on mode\n  const displayBalance = isFiatMode ? fiatAvailable : (isCryptoMode ? escrowAvailable : demoAvailable);\n  const displayCurrency: 'USD' | 'NGN' = isFiatMode ? 'NGN' : 'USD';\n  const needsDeposit = isCryptoMode && numAmount > escrowAvailable;\n  const insufficientBalance = numAmount > displayBalance;\n\n  const ensureCryptoWalletReady = useCallback(() => {\n    if (!isCryptoMode) return true;\n    try {\n      ensureWalletReady({\n        address,\n        chainId,\n        expectedChainId: baseSepolia.id,\n        isConnected,\n        sessionHealthy,\n      });\n      return true;\n    } catch (err) {\n      const message = err instanceof WalletStateError ? err.message : 'Wallet is not ready. Please reconnect and switch to Base Sepolia.';\n      toast.error(message);\n      return false;\n    }\n  }, [address, chainId, isConnected, isCryptoMode, sessionHealthy]);\n\n  // Different quick amounts for fiat (NGN) vs USD\n  const quickAmountsUsd = [5, 10, 25, 50, 100, 250];\n  const quickAmountsNgn = [500, 1000, 2500, 5000, 10000, 25000];\n  const quickAmounts = isFiatMode ? quickAmountsNgn : quickAmountsUsd;\n\n  const handleSubmit = async () => {\n    if (!selectedOptionId) {\n      toast.error('Please select a prediction option (Yes or No)');\n      return;\n    }\n\n    if (!numAmount) {\n      toast.error('Please enter an amount to stake');\n      return;\n    }\n\n    // For fiat, we may have different min/max rules (skip USD-based checks)\n    if (!isFiatMode) {\n      if (numAmount < prediction.stake_min) {\n        toast.error(`Minimum stake is ${formatCurrency(prediction.stake_min)}. Please increase your amount.`);\n        return;\n      }\n\n      if (prediction.stake_max && numAmount > prediction.stake_max) {\n        toast.error(`Maximum stake is ${formatCurrency(prediction.stake_max)}. Please reduce your amount.`);\n        return;\n      }\n    } else {\n      // Fiat minimum check (e.g., NGN 100)\n      const fiatMin = 100;\n      if (numAmount < fiatMin) {\n        toast.error(`Minimum stake is ${formatCurrency(fiatMin, 'NGN')}. Please increase your amount.`);\n        return;\n      }\n    }\n\n    if (!user?.id) {\n      toast.error('You must be logged in to place predictions');\n      return;\n    }\n\n    if (needsDeposit) {\n      toast.error(`Insufficient escrow balance. You have ${formatCurrency(escrowAvailable)}, but tried to stake ${formatCurrency(numAmount)}.`);\n      setShowDepositModal(true);\n      return;\n    }\n\n    if (isDemoMode && numAmount > demoAvailable) {\n      toast.error(`Insufficient balance. You have ${formatCurrency(demoAvailable)} available, but tried to stake ${formatCurrency(numAmount)}.`);\n      return;\n    }\n\n    if (isFiatMode && numAmount > fiatAvailable) {\n      toast.error(`Insufficient fiat balance. You have ${formatCurrency(fiatAvailable, 'NGN')} available, but tried to stake ${formatCurrency(numAmount, 'NGN')}.`);\n      return;\n    }\n\n    // Only check crypto wallet for crypto mode\n    if (isCryptoMode && !ensureCryptoWalletReady()) {\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      if (isFiatMode) {\n        // Use the fiat-specific stake flow\n        await placeFiatPrediction(\n          prediction.id,\n          selectedOptionId,\n          numAmount, // This is in NGN\n          user.id\n        );\n        toast.success(`Prediction placed successfully! You staked ${formatCurrency(numAmount, 'NGN')} on ${selectedOption?.label}.`);\n      } else {\n        await placePrediction(\n          prediction.id,\n          selectedOptionId,\n          numAmount,\n          user.id,\n          isCryptoMode ? (address ?? undefined) : undefined\n        );\n        toast.success(`Prediction placed successfully! You staked ${formatCurrency(numAmount)} on ${selectedOption?.label}.`);\n      }\n      \n      onClose();\n      setAmount('');\n      setSelectedOptionId('');\n\n      // Invalidate queries & refresh balances\n      invalidateAfterBet(queryClient, { userId: user.id, predictionId: prediction.id });\n      await Promise.all([\n        queryClient.invalidateQueries({ queryKey: QK.walletSummary(user.id, walletAddressLower) }),\n        queryClient.invalidateQueries({ queryKey: QK.walletActivity(user.id) }),\n        queryClient.invalidateQueries({ queryKey: ['readContract'] }),\n        queryClient.invalidateQueries({ queryKey: ['fiat'] }),\n      ]);\n      await refetchBalances();\n      if (isDemoMode) {\n        await fetchDemoSummary();\n      }\n      if (isFiatMode) {\n        await refetchFiat();\n      }\n      window.dispatchEvent(new CustomEvent('fcz:balance:refresh'));\n    } catch (error: any) {\n      const errorMessage = error?.message || 'Unknown error occurred';\n      toast.error(`Failed to place prediction: ${errorMessage}. Please try again.`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <AnimatePresence mode=\"wait\" initial={false}>\n      {isOpen && (\n        <>\n          {/* Backdrop */}\n          <motion.div\n            key=\"prediction-modal-backdrop\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.2 }}\n            className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm\"\n            onClick={onClose}\n            style={{ zIndex: 8000 }}\n          />\n          \n          {/* Modal Content - Mobile optimized positioning with safe area */}\n          <div \n            className=\"fixed inset-0 flex items-end justify-center p-4 pb-20\"\n            style={{ zIndex: 8500, pointerEvents: 'none' }}\n          >\n            <motion.div\n              key=\"prediction-modal-content\"\n              initial={{ y: '100%', opacity: 0 }}\n              animate={{ y: 0, opacity: 1 }}\n              exit={{ y: '100%', opacity: 0 }}\n              transition={{ type: 'spring', damping: 30, stiffness: 300 }}\n              className=\"w-full max-w-md bg-white rounded-t-2xl shadow-2xl flex flex-col max-h-[75vh]\"\n              style={{ pointerEvents: 'auto' }}\n              onClick={(e) => e.stopPropagation()}\n            >\n              {/* Header */}\n              <div className=\"flex-shrink-0 p-4 border-b border-gray-200\">\n                <div className=\"flex items-center justify-between\">\n                  <h2 className=\"text-lg font-semibold text-gray-900\">Place Prediction</h2>\n                  <button\n                    onClick={onClose}\n                    className=\"p-2 rounded-lg hover:bg-gray-100 transition-colors\"\n                    aria-label=\"Close modal\"\n                  >\n                    <X size={20} />\n                  </button>\n                </div>\n              </div>\n\n              {/* Scrollable Body */}\n              <div className=\"flex-1 overflow-y-auto p-4 space-y-6\">\n                {(isDemoEnabled || isFiatEnabled) && (\n                  <div className=\"inline-flex rounded-lg bg-gray-100 p-1 flex-wrap gap-1\">\n                    <button\n                      onClick={() => setMode('crypto')}\n                      className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n                        isCryptoMode ? 'bg-white text-gray-900 shadow-sm' : 'text-gray-600 hover:text-gray-900'\n                      }`}\n                    >\n                      Crypto (USDC)\n                    </button>\n                    {isDemoEnabled && (\n                      <button\n                        onClick={() => setMode('demo')}\n                        className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n                          isDemoMode ? 'bg-white text-gray-900 shadow-sm' : 'text-gray-600 hover:text-gray-900'\n                        }`}\n                      >\n                        Demo Credits\n                      </button>\n                    )}\n                    {isFiatEnabled && (\n                      <button\n                        onClick={() => setMode('fiat')}\n                        className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n                          isFiatMode ? 'bg-white text-gray-900 shadow-sm' : 'text-gray-600 hover:text-gray-900'\n                        }`}\n                      >\n                        Fiat (NGN)\n                      </button>\n                    )}\n                  </div>\n                )}\n\n                {/* Prediction Info */}\n                <div className=\"space-y-2\">\n                  <h3 className=\"font-semibold text-gray-900 text-base\">{prediction.title}</h3>\n                  <div className=\"flex items-center gap-4 text-sm text-gray-500\">\n                    <span>{formatCurrency(prediction.pool_total || 0)} Pool</span>\n                    <span></span>\n                    <span>{prediction.participant_count || 0} Players</span>\n                    <span></span>\n                  <span>\n                    {(() => {\n                      const timeLabel = formatTimeRemaining(prediction.entry_deadline || prediction.entryDeadline || '');\n                      if (!timeLabel) return '';\n                      return timeLabel === 'Ended' ? 'Closed' : `Ends in ${timeLabel}`;\n                    })()}\n                  </span>\n                  </div>\n                </div>\n\n                {isCryptoMode && (\n                  <div className=\"flex items-center justify-between bg-purple-50 border border-purple-100 rounded-xl px-3 py-2 text-xs text-purple-900\">\n                    <div className=\"flex items-center gap-2\">\n                      <WalletIcon className=\"w-4 h-4\" />\n                      <div>\n                        <p className=\"font-semibold\">Available to stake</p>\n                        <p className=\"text-purple-700\">${escrowAvailable.toFixed(2)} USDC</p>\n                      </div>\n                    </div>\n                    <button\n                      className=\"inline-flex items-center gap-1 text-xs font-semibold text-purple-800 hover:text-purple-900\"\n                      onClick={() => {\n                        if (!user?.id) {\n                          toast.error('Sign in to deposit funds.');\n                          return;\n                        }\n                        if (!ensureCryptoWalletReady()) {\n                          return;\n                        }\n                        setShowDepositModal(true);\n                      }}\n                    >\n                      <ArrowUpRight className=\"w-3 h-3\" />\n                      Add funds\n                    </button>\n                  </div>\n                )}\n                \n                {isDemoMode && (\n                  <div className=\"flex items-center justify-between bg-emerald-50 border border-emerald-100 rounded-xl px-3 py-2 text-xs text-emerald-900\">\n                    <div className=\"flex items-center gap-2\">\n                      <WalletIcon className=\"w-4 h-4\" />\n                      <div>\n                        <p className=\"font-semibold\">Demo available</p>\n                        <p className=\"text-emerald-700\">${demoAvailable.toFixed(2)}</p>\n                      </div>\n                    </div>\n                    <button\n                      className=\"inline-flex items-center gap-1 text-xs font-semibold text-emerald-800 hover:text-emerald-900 disabled:opacity-60\"\n                      onClick={() => void faucetDemo()}\n                      disabled={!user?.id || demoLoading}\n                    >\n                      <ArrowUpRight className=\"w-3 h-3\" />\n                      Get credits\n                    </button>\n                  </div>\n                )}\n                \n                {isFiatMode && (\n                  <div className=\"flex items-center justify-between bg-amber-50 border border-amber-100 rounded-xl px-3 py-2 text-xs text-amber-900\">\n                    <div className=\"flex items-center gap-2\">\n                      <Banknote className=\"w-4 h-4\" />\n                      <div>\n                        <p className=\"font-semibold\">Fiat available</p>\n                        <p className=\"text-amber-700\">{formatCurrency(fiatAvailable, 'NGN')}</p>\n                      </div>\n                    </div>\n                    <a\n                      href=\"/wallet\"\n                      className=\"inline-flex items-center gap-1 text-xs font-semibold text-amber-800 hover:text-amber-900\"\n                    >\n                      <ArrowUpRight className=\"w-3 h-3\" />\n                      Deposit NGN\n                    </a>\n                  </div>\n                )}\n\n                {!isCryptoMode && demoError && (\n                  <div className=\"text-xs text-amber-700 bg-amber-50 border border-amber-200 rounded-xl px-3 py-2\">\n                    {demoError}\n                  </div>\n                )}\n\n                {/* Options */}\n                <div className=\"space-y-3\">\n                  <h4 className=\"font-medium text-gray-900\">Select your prediction:</h4>\n                  <div className=\"space-y-2\">\n                    {(prediction.options || []).map((option) => {\n                      const totalStaked = option.total_staked || 0;\n                      const poolTotal = prediction.pool_total || 1;\n                      const percentage = poolTotal > 0 ? Math.min((totalStaked / poolTotal * 100), 100) : 50;\n                      const currentOdds = option.current_odds || (totalStaked > 0 ? (poolTotal / totalStaked) : 2.0);\n                      \n                      return (\n                        <Card\n                          key={option.id || Math.random()}\n                          className={cn(\n                            \"cursor-pointer transition-all border-2\",\n                            selectedOptionId === option.id \n                              ? \"border-teal-500 bg-teal-50\" \n                              : \"border-gray-200 hover:border-gray-300\"\n                          )}\n                          onClick={() => setSelectedOptionId(option.id)}\n                        >\n                          <CardContent className=\"p-3\">\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex-1\">\n                                <div className=\"font-medium text-gray-900\">{option.label}</div>\n                                <div className=\"text-sm text-gray-500\">\n                                  {percentage.toFixed(1)}%\n                                </div>\n                              </div>\n                              <div className=\"text-right\">\n                                <div className=\"text-lg font-bold text-teal-600\">\n                                  {currentOdds.toFixed(2)}x\n                                </div>\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      );\n                    })}\n                  </div>\n                </div>\n\n                {/* Amount Input - Fixed positioning */}\n                <AnimatePresence mode=\"wait\">\n                  {selectedOptionId && (\n                    <motion.div\n                      key={`amount-input-${selectedOptionId}`}\n                      initial={{ opacity: 0, height: 0 }}\n                      animate={{ opacity: 1, height: 'auto' }}\n                      exit={{ opacity: 0, height: 0 }}\n                      transition={{ duration: 0.2 }}\n                      className=\"space-y-4\"\n                    >\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Stake amount {isFiatMode ? '(NGN)' : '(USD)'}\n                        </label>\n                        <div className=\"relative\">\n                          <Input\n                            type=\"number\"\n                            placeholder=\"0.00\"\n                            value={amount}\n                            onChange={(e) => setAmount(e.target.value)}\n                            className=\"pl-8 pr-4 h-12 text-lg font-medium\"\n                            min={isFiatMode ? 100 : prediction.stake_min}\n                            max={isFiatMode ? displayBalance : (prediction.stake_max || displayBalance)}\n                          />\n                          <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium\">\n                            {isFiatMode ? '' : '$'}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center justify-between text-xs text-gray-500 mt-2\">\n                          <span>Balance: {formatCurrency(displayBalance, displayCurrency)}</span>\n                          <button\n                            onClick={() => setAmount(Math.floor(displayBalance).toString())}\n                            className=\"text-blue-600 hover:text-blue-700 font-medium\"\n                          >\n                            Max\n                          </button>\n                        </div>\n                      </div>\n\n                      {/* Quick amounts */}\n                      <div>\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {quickAmounts.map((quickAmount) => (\n                            <Button\n                              key={quickAmount}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => setAmount(quickAmount.toString())}\n                              disabled={quickAmount > displayBalance}\n                              className=\"text-sm h-10\"\n                            >\n                              {isFiatMode ? `${quickAmount.toLocaleString()}` : `$${quickAmount}`}\n                            </Button>\n                          ))}\n                        </div>\n                      </div>\n\n                      {/* Potential payout */}\n                      {numAmount > 0 && (\n                        <Card className=\"bg-teal-50 border-teal-200\">\n                          <CardContent className=\"p-3\">\n                            <div className=\"flex items-center justify-between\">\n                              <div>\n                                <div className=\"text-sm text-gray-500\">Potential return</div>\n                                <div className=\"text-lg font-bold text-teal-600\">\n                                  {formatCurrency(potentialPayout, displayCurrency)}\n                                </div>\n                              </div>\n                              <div className=\"text-right\">\n                                <div className=\"text-sm text-gray-500\">Profit</div>\n                                <div className={cn(\n                                  \"font-semibold\",\n                                  potentialPayout > numAmount ? \"text-teal-600\" : \"text-red-600\"\n                                )}>\n                                  {formatCurrency(potentialPayout - numAmount, displayCurrency)}\n                                </div>\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      )}\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n\n              {/* Footer - Fixed positioning above mobile navigation */}\n              <div className=\"flex-shrink-0 p-4 border-t border-gray-200 bg-white\">\n                <Button\n                  onClick={handleSubmit}\n                  disabled={!selectedOptionId || !numAmount || isLoading || insufficientBalance}\n                  className=\"w-full h-12 bg-teal-500 hover:bg-teal-600 disabled:bg-gray-400 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg flex items-center justify-center\"\n                >\n                  {isLoading ? (\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                      <span>Placing...</span>\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center gap-2\">\n                      <Zap size={16} />\n                      <span>Place Prediction ({formatCurrency(numAmount, displayCurrency)})</span>\n                    </div>\n                  )}\n                </Button>\n              </div>\n            </motion.div>\n          </div>\n\n          {showDepositModal && user?.id && (\n            <DepositUSDCModal\n              open={showDepositModal}\n              onClose={() => setShowDepositModal(false)}\n              onSuccess={() => {\n                setShowDepositModal(false);\n                refetchBalances();\n              }}\n              availableUSDC={walletUSDC}\n              userId={user.id}\n            />\n          )}\n        </>\n      )}\n    </AnimatePresence>\n  );\n};","/**\n * Custom hook for infinite scroll functionality\n * Handles scroll detection and loading more content\n */\n\nimport { useEffect, useCallback, useRef } from 'react';\n\ninterface UseInfiniteScrollOptions {\n  hasNext: boolean;\n  loading: boolean;\n  onLoadMore: () => void;\n  threshold?: number; // Distance from bottom to trigger load (default: 200px)\n  disabled?: boolean;\n  container?: HTMLElement | null; // Container element for scrolling (if null, uses window)\n}\n\nexport const useInfiniteScroll = ({\n  hasNext,\n  loading,\n  onLoadMore,\n  threshold = 200,\n  disabled = false,\n  container = null\n}: UseInfiniteScrollOptions) => {\n  const loadingRef = useRef(false);\n\n  const handleScroll = useCallback(() => {\n    // Skip if disabled, already loading, no more content, or throttled\n    if (disabled || loading || !hasNext || loadingRef.current) {\n      return;\n    }\n\n    let scrollTop: number;\n    let scrollHeight: number;\n    let clientHeight: number;\n\n    if (container) {\n      // Container-based scrolling\n      scrollTop = container.scrollTop;\n      scrollHeight = container.scrollHeight;\n      clientHeight = container.clientHeight;\n    } else {\n      // Window-based scrolling\n      scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n      scrollHeight = document.documentElement.scrollHeight;\n      clientHeight = window.innerHeight || document.documentElement.clientHeight;\n    }\n\n    const distanceFromBottom = scrollHeight - (scrollTop + clientHeight);\n\n    // Load more when user is within threshold distance from bottom\n    if (distanceFromBottom <= threshold) {\n      console.log(' Infinite scroll triggered:', {\n        distanceFromBottom,\n        threshold,\n        hasNext,\n        loading,\n        container: container ? 'container' : 'window'\n      });\n\n      loadingRef.current = true;\n      onLoadMore();\n\n      // Reset throttle after 1 second\n      setTimeout(() => {\n        loadingRef.current = false;\n      }, 1000);\n    }\n  }, [disabled, loading, hasNext, threshold, onLoadMore, container]);\n\n  useEffect(() => {\n    if (disabled) return;\n\n    // Throttled scroll handler\n    let timeoutId: NodeJS.Timeout;\n    const throttledScroll = () => {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(handleScroll, 100);\n    };\n\n    const scrollElement = container || window;\n    const scrollEventName = container ? 'scroll' : 'scroll';\n    const touchEventName = container ? 'touchmove' : 'touchmove';\n\n    scrollElement.addEventListener(scrollEventName, throttledScroll, { passive: true });\n    \n    // Only add touchmove to window, not container to avoid conflicts\n    if (!container) {\n      window.addEventListener(touchEventName, throttledScroll, { passive: true });\n    }\n\n    return () => {\n      scrollElement.removeEventListener(scrollEventName, throttledScroll);\n      if (!container) {\n        window.removeEventListener(touchEventName, throttledScroll);\n      }\n      clearTimeout(timeoutId);\n    };\n  }, [handleScroll, disabled, container]);\n\n  // Manual trigger function for testing\n  const triggerLoadMore = useCallback(() => {\n    if (!disabled && !loading && hasNext && !loadingRef.current) {\n      console.log(' Manual infinite scroll trigger');\n      loadingRef.current = true;\n      onLoadMore();\n      setTimeout(() => {\n        loadingRef.current = false;\n      }, 1000);\n    }\n  }, [disabled, loading, hasNext, onLoadMore]);\n\n  return {\n    triggerLoadMore\n  };\n};\n","import React, { useState, useCallback, useMemo, useEffect } from 'react';\nimport { usePredictionStore, Prediction } from '../store/predictionStore';\nimport { toast } from 'react-hot-toast';\nimport PredictionCard from '../components/PredictionCard';\nimport PredictionCardV3, { PredictionCardV3Skeleton } from '../components/predictions/PredictionCardV3';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { TrendingUp, Search, Loader2, Bell, ChevronDown, X } from 'lucide-react';\nimport { useAuthStore } from '../store/authStore';\nimport PredictionCardSkeleton from '../components/PredictionCardSkeleton';\nimport { PlacePredictionModal } from '../components/predictions/PlacePredictionModal';\nimport { useInfiniteScroll } from '../hooks/useInfiniteScroll';\nimport Logo from '../components/common/Logo';\nimport AppHeader from '../components/layout/AppHeader';\nimport { formatUSDCompact, formatNumberShort } from '@/lib/format';\nimport { useNavigate } from 'react-router-dom';\nimport { useCategories, Category } from '../hooks/useCategories';\nimport * as Dialog from '@radix-ui/react-dialog';\n\ninterface DiscoverPageProps {\n  onNavigateToProfile?: () => void;\n  onNavigateToPrediction?: (predictionId: string) => void;\n}\n\n// Enhanced Category Filter Component - uses API categories\nconst CategoryFilters = React.memo(function CategoryFilters({ \n  selectedCategoryId, \n  onSelect,\n  categories,\n  isLoading\n}: {\n  selectedCategoryId: string | null;\n  onSelect: (categoryId: string | null) => void;\n  categories: Category[];\n  isLoading: boolean;\n}) {\n  const [showMoreSheet, setShowMoreSheet] = useState(false);\n  \n  // Show top 8 categories as chips, rest in \"More\" sheet\n  const topCategories = categories.slice(0, 8);\n  const moreCategories = categories.slice(8);\n\n  if (isLoading) {\n    return (\n      <div className=\"category-filters bg-white border-b border-gray-100 px-4 py-3\">\n        <div className=\"flex gap-2\">\n          {[1, 2, 3, 4, 5, 6].map((i) => (\n            <div key={i} className=\"h-7 w-20 bg-gray-200 rounded-full animate-pulse\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div\n        className=\"category-filters bg-white border-b border-gray-100 px-4 py-3\"\n        data-tour=\"category-filters\"\n        data-tour-id=\"category-filters\"\n      >\n        <div className=\"overflow-x-auto overflow-y-hidden scrollbar-hide\">\n          <div className=\"flex gap-2\">\n            {/* \"All\" chip */}\n            <button\n              onClick={() => onSelect(null)}\n              style={{\n                height: '28px',\n                minHeight: '28px',\n                padding: '0 12px',\n                display: 'inline-flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                fontSize: '13px',\n                fontWeight: 500,\n                lineHeight: 1,\n                borderRadius: '14px',\n                border: 'none',\n                cursor: 'pointer',\n                whiteSpace: 'nowrap',\n                flexShrink: 0,\n                transition: 'all 0.2s',\n                backgroundColor: selectedCategoryId === null ? '#7B2FF7' : '#f1f5f9',\n                color: selectedCategoryId === null ? '#ffffff' : '#475569',\n              }}\n              onMouseEnter={(e) => {\n                if (selectedCategoryId !== null) {\n                  e.currentTarget.style.backgroundColor = '#e2e8f0';\n                }\n              }}\n              onMouseLeave={(e) => {\n                if (selectedCategoryId !== null) {\n                  e.currentTarget.style.backgroundColor = '#f1f5f9';\n                }\n              }}\n              data-tour=\"category-chips-item\"\n            >\n              All\n            </button>\n\n            {/* Top categories as chips */}\n            {topCategories.map((category) => (\n              <button\n                key={category.id}\n                onClick={() => onSelect(category.id)}\n                style={{\n                  height: '28px',\n                  minHeight: '28px',\n                  padding: '0 12px',\n                  display: 'inline-flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '13px',\n                  fontWeight: 500,\n                  lineHeight: 1,\n                  borderRadius: '14px',\n                  border: 'none',\n                  cursor: 'pointer',\n                  whiteSpace: 'nowrap',\n                  flexShrink: 0,\n                  transition: 'all 0.2s',\n                  backgroundColor: selectedCategoryId === category.id ? '#7B2FF7' : '#f1f5f9',\n                  color: selectedCategoryId === category.id ? '#ffffff' : '#475569',\n                }}\n                onMouseEnter={(e) => {\n                  if (selectedCategoryId !== category.id) {\n                    e.currentTarget.style.backgroundColor = '#e2e8f0';\n                  }\n                }}\n                onMouseLeave={(e) => {\n                  if (selectedCategoryId !== category.id) {\n                    e.currentTarget.style.backgroundColor = '#f1f5f9';\n                  }\n                }}\n                data-tour=\"category-chips-item\"\n              >\n                {category.label}\n              </button>\n            ))}\n\n            {/* \"More\" button if there are additional categories */}\n            {moreCategories.length > 0 && (\n              <button\n                onClick={() => setShowMoreSheet(true)}\n                style={{\n                  height: '28px',\n                  minHeight: '28px',\n                  padding: '0 12px',\n                  display: 'inline-flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: '4px',\n                  fontSize: '13px',\n                  fontWeight: 500,\n                  lineHeight: 1,\n                  borderRadius: '14px',\n                  border: 'none',\n                  cursor: 'pointer',\n                  whiteSpace: 'nowrap',\n                  flexShrink: 0,\n                  transition: 'all 0.2s',\n                  backgroundColor: '#f1f5f9',\n                  color: '#475569',\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.backgroundColor = '#e2e8f0';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.backgroundColor = '#f1f5f9';\n                }}\n              >\n                More\n                <ChevronDown className=\"w-3 h-3\" />\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* More categories sheet */}\n      {moreCategories.length > 0 && (\n        <Dialog.Root open={showMoreSheet} onOpenChange={setShowMoreSheet}>\n          <Dialog.Portal>\n            <Dialog.Overlay className=\"fixed inset-0 bg-black/40 backdrop-blur-sm z-[12000]\" />\n            <Dialog.Content className=\"fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl z-[12001] max-h-[calc(100vh-5rem-env(safe-area-inset-bottom))] overflow-y-auto\">\n              <div className=\"sticky top-0 bg-white border-b border-gray-200 px-4 py-4 flex items-center justify-between z-10\">\n                <Dialog.Title className=\"text-lg font-semibold text-gray-900\">All Categories</Dialog.Title>\n                <Dialog.Close className=\"p-2 rounded-lg hover:bg-gray-100\">\n                  <X className=\"w-5 h-5 text-gray-500\" />\n                </Dialog.Close>\n              </div>\n              <div className=\"px-4 py-4 space-y-2\">\n                <button\n                  onClick={() => {\n                    onSelect(null);\n                    setShowMoreSheet(false);\n                  }}\n                  className={`w-full text-left px-4 py-3 rounded-xl transition-colors ${\n                    selectedCategoryId === null\n                      ? 'bg-purple-600 text-white'\n                      : 'bg-gray-50 text-gray-900 hover:bg-gray-100'\n                  }`}\n                >\n                  All\n                </button>\n                {moreCategories.map((category) => (\n                  <button\n                    key={category.id}\n                    onClick={() => {\n                      onSelect(category.id);\n                      setShowMoreSheet(false);\n                    }}\n                    className={`w-full text-left px-4 py-3 rounded-xl transition-colors ${\n                      selectedCategoryId === category.id\n                        ? 'bg-purple-600 text-white'\n                        : 'bg-gray-50 text-gray-900 hover:bg-gray-100'\n                    }`}\n                  >\n                    {category.label}\n                  </button>\n                ))}\n              </div>\n            </Dialog.Content>\n          </Dialog.Portal>\n        </Dialog.Root>\n      )}\n    </>\n  );\n});\n\nCategoryFilters.displayName = 'CategoryFilters';\n\n// Enhanced Discover Header Component\nconst DiscoverHeaderContent = React.memo(function DiscoverHeaderContent({ \n  stats, \n  searchQuery, \n  onSearchChange\n}: {\n  stats: any;\n  searchQuery: string;\n  onSearchChange: (query: string) => void;\n}) {\n  return (\n    <div\n      className=\"px-4 pt-4 pb-4 bg-white\"\n      data-tour=\"discover-header\"\n      data-tour-id=\"discover-header\"\n    >\n      {/* Live market stats removed per request */}\n\n      {/* Search bar */}\n      <div className=\"relative\" data-tour=\"search-bar\" data-tour-id=\"search-bar\">\n        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n          <Search className=\"h-5 w-5 text-gray-400\" />\n        </div>\n        <input\n          type=\"text\"\n          placeholder=\"Search predictions...\"\n          value={searchQuery}\n          onChange={(e) => onSearchChange(e.target.value)}\n          className=\"w-full pl-10 pr-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-500 focus:bg-white focus:ring-2 focus:ring-emerald-500 focus:outline-none transition-all\"\n        />\n      </div>\n    </div>\n  );\n});\n\nDiscoverHeaderContent.displayName = 'DiscoverHeaderContent';\n\n// Main DiscoverPage Component\nconst DiscoverPage = React.memo(function DiscoverPage({ onNavigateToProfile, onNavigateToPrediction }: DiscoverPageProps) {\n  const { user } = useAuthStore();\n  const navigate = useNavigate();\n  const { categories, isLoading: categoriesLoading } = useCategories();\n  const { \n    predictions, \n    loading, \n    loadingMore, \n    pagination, \n    filters,\n    refreshPredictions,\n    loadMorePredictions,\n    setFilters \n  } = usePredictionStore();\n  \n  const [selectedPrediction, setSelectedPrediction] = useState<Prediction | null>(null);\n  const [isPredictionModalOpen, setIsPredictionModalOpen] = useState(false);\n  const [selectedCategoryId, setSelectedCategoryId] = useState<string | null>(null);\n\n  const [platformStats, setPlatformStats] = useState({\n    totalVolume: '0',\n    activePredictions: 0,\n    totalUsers: '0',\n    rawVolume: 0,\n    rawUsers: 0\n  });\n\n  // Fetch platform stats\n  const fetchPlatformStats = useCallback(async () => {\n    try {\n      // Use the same environment API URL logic as the rest of the app\n      const { getApiUrl } = await import('@/utils/environment');\n      const response = await fetch(`${getApiUrl()}/api/v2/predictions/stats/platform`);\n      if (response.ok) {\n        const data = await response.json();\n        if (data.success) {\n          setPlatformStats(data.data);\n          console.log(' Platform stats fetched:', data.data);\n        }\n      } else {\n        console.error('Failed to fetch platform stats:', response.status);\n      }\n    } catch (error) {\n      console.error('Error fetching platform stats:', error);\n    }\n  }, []);\n\n  // Setup infinite scroll using window scroll (no custom container)\n  useInfiniteScroll({\n    hasNext: pagination.hasNext,\n    loading: loadingMore,\n    onLoadMore: () => {\n      console.log(' Infinite scroll triggered in DiscoverPage:', {\n        hasNext: pagination.hasNext,\n        loading: loadingMore,\n        currentPage: pagination.page,\n        total: pagination.total\n      });\n      loadMorePredictions();\n    },\n    threshold: 300\n  });\n\n  // Initialize data on mount\n  useEffect(() => {\n    refreshPredictions();\n    fetchPlatformStats();\n  }, [refreshPredictions, fetchPlatformStats]);\n\n  // Calculate stats\n  const stats = useMemo(() => ({\n    totalVolume: platformStats.totalVolume,\n    activePredictions: platformStats.activePredictions,\n    totalUsers: platformStats.totalUsers\n  }), [platformStats]);\n\n  // Backend now handles filtering - no additional filtering needed\n  const displayPredictions = useMemo(() => {\n    if (!Array.isArray(predictions)) {\n      // Silently return empty array - excessive logging removed\n      return [];\n    }\n\n    const now = Date.now();\n    const activePredictions = predictions.filter((prediction) => {\n      if (!prediction || !prediction.id || !prediction.title) {\n        // Silently filter invalid predictions - excessive logging removed\n        return false;\n      }\n\n      const isOpen = (prediction.status ?? 'open') === 'open';\n      const deadlineMs = prediction.entry_deadline ? new Date(prediction.entry_deadline).getTime() : Number.POSITIVE_INFINITY;\n      const isExpired = Number.isFinite(deadlineMs) && deadlineMs <= now;\n\n      return isOpen && !isExpired;\n    });\n\n    // Excessive logging removed - only log errors if needed\n    return activePredictions;\n  }, [predictions]);\n\n  // Event handlers\n  const handlePredict = useCallback((prediction: Prediction) => {\n    setSelectedPrediction(prediction);\n    setIsPredictionModalOpen(true);\n  }, []);\n\n  const handleNavigateToPrediction = useCallback((predictionId: string) => {\n    if (onNavigateToPrediction) {\n      onNavigateToPrediction(predictionId);\n    } else {\n      window.location.href = `/prediction/${predictionId}`;\n    }\n  }, [onNavigateToPrediction]);\n\n  const handleLike = useCallback((predictionId: string) => {\n    toast.success('Prediction liked!');\n  }, []);\n\n  const handleComment = useCallback((predictionId: string) => {\n    handleNavigateToPrediction(predictionId);\n  }, [handleNavigateToPrediction]);\n\n  const handleShare = useCallback((prediction: Prediction) => {\n    const shareText = `Check out this prediction: ${prediction.title}`;\n    const shareUrl = `${window.location.origin}/prediction/${prediction.id}`;\n    \n    if (navigator.share) {\n      navigator.share({\n        title: prediction.title,\n        text: shareText,\n        url: shareUrl\n      }).catch(console.error);\n    } else {\n      navigator.clipboard.writeText(`${shareText}\\n${shareUrl}`)\n        .then(() => toast.success('Link copied to clipboard!'))\n        .catch(() => toast.error('Failed to copy link'));\n    }\n  }, []);\n\n  const handleSearchChange = useCallback((query: string) => {\n    console.log(' Search query changed:', query);\n    setFilters({ search: query });\n  }, [setFilters]);\n\n  const handleCategorySelect = useCallback((categoryId: string | null) => {\n    console.log(' Category changed:', categoryId);\n    setSelectedCategoryId(categoryId);\n    // Send categoryId (UUID) to server - server handles both UUID and slug\n    if (categoryId) {\n      setFilters({ category: categoryId }); // Send UUID, server will handle it\n    } else {\n      setFilters({ category: 'all' });\n    }\n  }, [setFilters]);\n\n  const handleModalClose = useCallback(() => {\n    setIsPredictionModalOpen(false);\n    setSelectedPrediction(null);\n  }, []);\n\n  // Show optimized loading state\n  if (loading && (!predictions || predictions.length === 0)) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        {/* Header skeleton */}\n        <div className=\"bg-white border-b border-gray-100\">\n          <div className=\"h-11\" />\n          <div className=\"px-4 pb-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div>\n                <div className=\"h-8 bg-gray-200 rounded w-24 mb-2 loading-skeleton\"></div>\n                <div className=\"h-4 bg-gray-200 rounded w-32 loading-skeleton\"></div>\n              </div>\n              <div className=\"w-10 h-10 bg-gray-200 rounded-full loading-skeleton\"></div>\n            </div>\n            <div className=\"bg-gray-200 rounded-2xl p-4 mb-4 loading-skeleton\">\n              <div className=\"h-4 bg-gray-300 rounded w-20 mb-3 loading-skeleton\"></div>\n              <div className=\"grid grid-cols-3 gap-4\">\n                <div className=\"text-center\">\n                  <div className=\"h-6 bg-gray-300 rounded mb-1 loading-skeleton\"></div>\n                  <div className=\"h-3 bg-gray-300 rounded w-16 mx-auto loading-skeleton\"></div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"h-6 bg-gray-300 rounded mb-1 loading-skeleton\"></div>\n                  <div className=\"h-3 bg-gray-300 rounded w-12 mx-auto loading-skeleton\"></div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"h-6 bg-gray-300 rounded mb-1 loading-skeleton\"></div>\n                  <div className=\"h-3 bg-gray-300 rounded w-14 mx-auto loading-skeleton\"></div>\n                </div>\n              </div>\n            </div>\n            <div className=\"h-12 bg-gray-200 rounded-xl loading-skeleton\"></div>\n          </div>\n        </div>\n\n        {/* Category filters skeleton */}\n        <div className=\"px-4 py-3 bg-white border-b border-gray-100\">\n          <div className=\"flex gap-2 overflow-x-auto\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <div key={i} className=\"h-8 bg-gray-200 rounded-full w-20 flex-shrink-0 loading-skeleton\"></div>\n            ))}\n          </div>\n        </div>\n\n        {/* Content skeleton */}\n        <div className=\"py-4\">\n          <div className=\"px-4 mb-6\">\n            <div className=\"h-8 bg-gray-200 rounded w-32 mb-2 loading-skeleton\"></div>\n            <div className=\"h-4 bg-gray-200 rounded w-24 loading-skeleton\"></div>\n          </div>\n          \n          {/* Prediction card skeletons */}\n          <div className=\"space-y-2\">\n            {[1, 2, 3, 4, 5].map((i) => (\n              <PredictionCardV3Skeleton key={i} />\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      className=\"discover-page content-with-bottom-nav\"\n    >\n      {/* Unified Header - Minimal (no logo, no descriptive text) */}\n      <AppHeader title=\"Discover\" showNotifications />\n      \n      {/* Header Content */}\n      <DiscoverHeaderContent \n        stats={stats} \n        searchQuery={filters.search}\n        onSearchChange={handleSearchChange}\n      />\n\n      {/* Category filters with explicit positioning */}\n      <div className=\"category-filters-wrapper\" style={{ position: 'relative', zIndex: 45 }}>\n        <CategoryFilters \n          selectedCategoryId={selectedCategoryId}\n          onSelect={handleCategorySelect}\n          categories={categories}\n          isLoading={categoriesLoading}\n        />\n      </div>\n\n      {/* Content with proper spacing */}\n      <div className=\"prediction-cards-container\">\n        {/* Predictions Grid with infinite scroll */}\n        <div className=\"space-y-2\">\n          <AnimatePresence mode=\"wait\">\n            {displayPredictions.length > 0 ? (\n              <>\n                {displayPredictions.map((prediction, index) => {\n                  // Additional safety check before rendering\n                  if (!prediction || !prediction.id) {\n                    console.warn(' DiscoverPage: Skipping invalid prediction at index', index);\n                    return null;\n                  }\n                  \n                  return (\n                    <PredictionCardV3\n                      key={`${prediction.id}-${index}`}\n                      prediction={{\n                        id: prediction.id,\n                        title: prediction.title,\n                        category: prediction.category,\n                        endsAt: prediction.entry_deadline,\n                        pool: prediction.pool_total,\n                        players: prediction.participant_count,\n                        options: prediction.options?.slice(0, 2).map(opt => ({\n                          label: opt.label,\n                          odds: opt.current_odds\n                        })),\n                        description: prediction.description\n                      }}\n                    />\n                  );\n                })}\n                \n                {/* Loading more indicator */}\n                {loadingMore && (\n                  <motion.div\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    className=\"flex items-center justify-center py-8\"\n                  >\n                    <Loader2 className=\"w-6 h-6 animate-spin text-purple-500 mr-3\" />\n                    <span className=\"text-gray-600\">Loading more predictions...</span>\n                  </motion.div>\n                )}\n                \n                {/* Debug info and manual load more button */}\n                {pagination.hasNext && !loadingMore && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    className=\"text-center py-6\"\n                  >\n                    <button\n                      onClick={() => {\n                        console.log(' Manual load more triggered');\n                        loadMorePredictions();\n                      }}\n                      className=\"bg-purple-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-600 transition-colors\"\n                    >\n                      Load More ({pagination.total - displayPredictions.length} remaining)\n                    </button>\n                    <p className=\"text-xs text-gray-500 mt-2\">\n                      Page {pagination.page}  {displayPredictions.length}/{pagination.total}\n                    </p>\n                  </motion.div>\n                )}\n                \n                {/* End of list indicator */}\n                {!pagination.hasNext && !loadingMore && displayPredictions.length > 10 && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    className=\"text-center py-8\"\n                  >\n                    <p className=\"text-gray-500 text-sm\">\n                       You've seen all predictions!\n                    </p>\n                  </motion.div>\n                )}\n              </>\n            ) : (\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -20 }}\n                className=\"text-center py-12 px-4\"\n              >\n                <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                  <TrendingUp size={24} className=\"text-gray-400\" />\n                </div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">No predictions found</h3>\n                <p className=\"text-gray-600\">\n                  {filters.search \n                    ? `No predictions match \"${filters.search}\"`\n                    : loading \n                      ? 'Loading predictions...'\n                      : 'Try adjusting your filters or check back later'\n                  }\n                </p>\n                {!loading && !filters.search && (\n                  <button\n                    onClick={() => refreshPredictions(true)}\n                    className=\"mt-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors\"\n                  >\n                    Refresh Predictions\n                  </button>\n                )}\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n      </div>\n\n      {/* Prediction Modal */}\n      <PlacePredictionModal\n        prediction={selectedPrediction}\n        isOpen={isPredictionModalOpen}\n        onClose={handleModalClose}\n      />\n    </div>\n  );\n});\n\nDiscoverPage.displayName = 'DiscoverPage';\n\nexport default DiscoverPage;\n"],"file":"assets/DiscoverPage-9bcffad8.js"}