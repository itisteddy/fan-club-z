import{L as X,u as Y,a as G,b as z,X as J,Z as K,z as S,c as q,S as ee,d as se,_ as te,n as I,e as ae,T as le}from"./index-6112b649.js";import{j as e,A as M,m as P}from"./ui-6244b3df.js";import{r,R}from"./vendor-499a370b.js";import{u as re,C as oe}from"./CreatorByline-a08ae8e5.js";import{f as ne,a as ie}from"./format-ae98e2f4.js";import{I as ce,B as U}from"./input-89d34c09.js";import{c as _,f as de}from"./utils-a40dfe8b.js";import{c as me}from"./utils-17ec81d9.js";import{A as ue}from"./AppHeader-78d14113.js";function xe({prediction:s}){if(!s)return null;const{media:o}=re(s.id,{id:s.id,title:s.title,description:s.description??"",category:s.category}),t=s.endsAt?ne(Math.max(0,new Date(s.endsAt).getTime()-Date.now())):null;return e.jsx(X,{to:`/prediction/${s.id}`,className:"block rounded-2xl border border-black/5 bg-white hover:shadow-sm focus-visible:ring-2 focus-visible:ring-indigo-500 transition",children:e.jsxs("div",{className:"flex items-stretch gap-3 p-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.category&&e.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-0.5",children:s.category}),t&&e.jsxs("span",{className:"rounded-full bg-gray-100 px-2 py-0.5",children:["ends in ",t]})]}),e.jsx("h3",{className:"mt-1 line-clamp-2 text-[15px] font-semibold text-gray-900",children:s.title}),s.creator&&e.jsx(oe,{creator:s.creator,className:"mt-1.5 text-xs"}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-gray-500",children:[typeof s.pool=="number"&&e.jsxs("span",{children:[ie(s.pool,{currency:"USD"})," pool"]}),typeof s.players=="number"&&e.jsxs("span",{children:[s.players," players"]}),s.options?.length?e.jsx("div",{className:"flex items-center gap-1",children:s.options.slice(0,2).map(a=>e.jsxs("span",{className:"rounded-md border border-gray-200 px-1.5 py-0.5 text-[11px] font-medium text-gray-700",children:[a.label,a.odds?e.jsxs("span",{className:"ml-1 text-gray-500",children:[a.odds.toFixed(2),"x"]}):null]},a.label))}):null]})]}),e.jsx("div",{className:"h-[72px] w-[96px] shrink-0 overflow-hidden rounded-xl bg-gray-100",children:e.jsx("img",{src:o.url,alt:o.alt||s.title,className:"h-full w-full object-cover transition-opacity duration-300",loading:"lazy",onLoad:a=>{a.target.style.opacity="1"},style:{opacity:.95}})})]})})}function ge(){return e.jsx("div",{className:"rounded-2xl border border-black/5 bg-white p-3",children:e.jsxs("div",{className:"flex items-stretch gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded-full animate-pulse"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded animate-pulse mb-1"}),e.jsx("div",{className:"h-4 w-3/4 bg-gray-200 rounded animate-pulse mb-2"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-3 w-16 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-12 bg-gray-200 rounded animate-pulse"})]})]}),e.jsx("div",{className:"h-[72px] w-[96px] bg-gray-200 rounded-xl animate-pulse"})]})})}const O=r.forwardRef(({className:s,...o},t)=>e.jsx("div",{ref:t,className:_("rounded-xl border bg-card text-card-foreground shadow-sm",s),...o}));O.displayName="Card";const he=r.forwardRef(({className:s,...o},t)=>e.jsx("div",{ref:t,className:_("flex flex-col space-y-1.5 p-6",s),...o}));he.displayName="CardHeader";const pe=r.forwardRef(({className:s,...o},t)=>e.jsx("h3",{ref:t,className:_("font-semibold leading-none tracking-tight",s),...o}));pe.displayName="CardTitle";const fe=r.forwardRef(({className:s,...o},t)=>e.jsx("p",{ref:t,className:_("text-sm text-muted-foreground",s),...o}));fe.displayName="CardDescription";const L=r.forwardRef(({className:s,...o},t)=>e.jsx("div",{ref:t,className:_("p-6 pt-0",s),...o}));L.displayName="CardContent";const ye=r.forwardRef(({className:s,...o},t)=>e.jsx("div",{ref:t,className:_("flex items-center p-6 pt-0",s),...o}));ye.displayName="CardFooter";const k=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),be=(s,o)=>s*o,H=(...s)=>s.filter(Boolean).join(" "),ve=({prediction:s,isOpen:o,onClose:t})=>{if(!s||!o)return null;const[a,i]=r.useState(""),[c,d]=r.useState(""),[p,C]=r.useState(!1),{user:h}=Y(),{getBalance:u,lockFunds:f}=G(),{placePrediction:y}=z(),b=u("USD")||0,n=parseFloat(c)||0,x=s?.options?.find(m=>m.id===a),w=x?.current_odds||(x?.total_staked?s?.pool_total/x.total_staked:2),N=x?be(n,w):0,D=[5,10,25,50,100,250],$=async()=>{if(!a){S.error("Please select a prediction option (Yes or No)");return}if(!n){S.error("Please enter an amount to stake");return}if(n<s.stake_min){S.error(`Minimum stake is ${k(s.stake_min)}. Please increase your amount.`);return}if(s.stake_max&&n>s.stake_max){S.error(`Maximum stake is ${k(s.stake_max)}. Please reduce your amount.`);return}if(n>b){S.error(`Insufficient balance. You have ${k(b)} available, but tried to stake ${k(n)}.`);return}if(!h?.id){S.error("You must be logged in to place predictions");return}C(!0);try{await f(n,"USD"),await y(s.id,a,n,h.id),S.success(`Prediction placed successfully! You staked ${k(n)} on ${x?.label}.`),t(),d(""),i("")}catch(m){const v=m?.message||"Unknown error occurred";S.error(`Failed to place prediction: ${v}. Please try again.`)}finally{C(!1)}};return e.jsx(M,{mode:"wait",initial:!1,children:o&&e.jsxs(e.Fragment,{children:[e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:t,style:{zIndex:8e3}},"prediction-modal-backdrop"),e.jsx("div",{className:"fixed inset-0 flex items-end justify-center p-4 pb-20",style:{zIndex:8500,pointerEvents:"none"},children:e.jsxs(P.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"w-full max-w-md bg-white rounded-t-2xl shadow-2xl flex flex-col max-h-[75vh]",style:{pointerEvents:"auto"},onClick:m=>m.stopPropagation(),children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Place Prediction"}),e.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close modal",children:e.jsx(J,{size:20})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base",children:s.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[k(s.pool_total||0)," Pool"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsxs("span",{children:[s.participant_count||0," Players"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:(()=>{const m=de(s.entry_deadline||s.entryDeadline||"");return m?m==="Ended"?"Closed":`Ends in ${m}`:""})()})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Select your prediction:"}),e.jsx("div",{className:"space-y-2",children:(s.options||[]).map(m=>{const v=m.total_staked||0,T=s.pool_total||1,E=T>0?Math.min(v/T*100,100):50,F=m.current_odds||(v>0?T/v:2);return e.jsx(O,{className:H("cursor-pointer transition-all border-2",a===m.id?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"),onClick:()=>i(m.id),children:e.jsx(L,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:m.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[E.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-teal-600",children:[F.toFixed(2),"x"]})})]})})},m.id||Math.random())})})]}),e.jsx(M,{mode:"wait",children:a&&e.jsxs(P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stake amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{type:"number",placeholder:"0.00",value:c,onChange:m=>d(m.target.value),className:"pl-8 pr-4 h-12 text-lg font-medium",min:s.stake_min,max:s.stake_max||b}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"$"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["Balance: ",k(b)]}),e.jsx("button",{onClick:()=>d(b.toString()),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Max"})]})]}),e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:D.map(m=>e.jsxs(U,{variant:"outline",size:"sm",onClick:()=>d(m.toString()),disabled:m>b,className:"text-sm h-10",children:["$",m]},m))})}),n>0&&e.jsx(O,{className:"bg-teal-50 border-teal-200",children:e.jsx(L,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Potential return"}),e.jsx("div",{className:"text-lg font-bold text-teal-600",children:k(N)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Profit"}),e.jsx("div",{className:H("font-semibold",N>n?"text-teal-600":"text-red-600"),children:k(N-n)})]})]})})})]},`amount-input-${a}`)})]}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-200 bg-white",children:e.jsx(U,{onClick:$,disabled:!a||!n||p||n>b,className:"w-full h-12 bg-teal-500 hover:bg-teal-600 disabled:bg-gray-400 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg flex items-center justify-center",children:p?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Placing..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{size:16}),e.jsxs("span",{children:["Place Prediction (",k(n),")"]})]})})})]},"prediction-modal-content")})]})})},je=({hasNext:s,loading:o,onLoadMore:t,threshold:a=200,disabled:i=!1,container:c=null})=>{const d=r.useRef(!1),p=r.useCallback(()=>{if(i||o||!s||d.current)return;let h,u,f;c?(h=c.scrollTop,u=c.scrollHeight,f=c.clientHeight):(h=window.pageYOffset||document.documentElement.scrollTop,u=document.documentElement.scrollHeight,f=window.innerHeight||document.documentElement.clientHeight);const y=u-(h+f);y<=a&&(console.log("üîÑ Infinite scroll triggered:",{distanceFromBottom:y,threshold:a,hasNext:s,loading:o,container:c?"container":"window"}),d.current=!0,t(),setTimeout(()=>{d.current=!1},1e3))},[i,o,s,a,t,c]);return r.useEffect(()=>{if(i)return;let h;const u=()=>{clearTimeout(h),h=setTimeout(p,100)},f=c||window,y="scroll",b="touchmove";return f.addEventListener(y,u,{passive:!0}),c||window.addEventListener(b,u,{passive:!0}),()=>{f.removeEventListener(y,u),c||window.removeEventListener(b,u),clearTimeout(h)}},[p,i,c]),{triggerLoadMore:r.useCallback(()=>{!i&&!o&&s&&!d.current&&(console.log("üîÑ Manual infinite scroll trigger"),d.current=!0,t(),setTimeout(()=>{d.current=!1},1e3))},[i,o,s,t])}},Ne=me((s,o)=>({positions:{},saveScrollPosition:(t,a)=>{s(i=>({positions:{...i.positions,[t]:{path:t,scrollY:a,timestamp:Date.now()}}}))},getScrollPosition:t=>{const a=o().positions[t];return a&&Date.now()-a.timestamp<10*60*1e3?a.scrollY:null},clearOldPositions:()=>{const t=Date.now(),a=10*60*1e3;s(i=>({positions:Object.fromEntries(Object.entries(i.positions).filter(([,c])=>t-c.timestamp<a))}))}})),we=(s,o={})=>{const[t]=q(),{saveScrollPosition:a,getScrollPosition:i}=Ne(),c=r.useRef(""),{saveOnUnmount:d=!0,restoreOnMount:p=!0,preserveFor:C=10,threshold:h=50}=o,u=r.useCallback(()=>s?.current?s.current:document.querySelector("[data-scroll-container]")||document.documentElement,[s]),f=r.useCallback(()=>{const n=u(),x=n===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:n.scrollTop;x>h&&(console.log(`üíæ Saving scroll position for ${t}: ${x}px`),a(t,x))},[t,h,a,u]),y=r.useCallback(()=>{const n=u(),x=i(t);return x!==null&&x>0?(console.log(`üîÑ Restoring scroll position for ${t}: ${x}px`),setTimeout(()=>{n===document.documentElement?window.scrollTo({top:x,behavior:"smooth"}):n.scrollTo({top:x,behavior:"smooth"})},100),!0):!1},[t,i,u]),b=r.useCallback(n=>{const x=u(),w=x===document.documentElement?window.pageYOffset||document.documentElement.scrollTop:x.scrollTop,N=n||t;w>h&&(console.log(`üíæ Manually saving scroll for ${N}: ${w}px`),a(N,w))},[t,h,a,u]);return r.useEffect(()=>{let n;return p&&(n=setTimeout(()=>{y()},50)),()=>{n&&clearTimeout(n),d&&f()}},[p,d,y,f]),r.useEffect(()=>{c.current&&c.current!==t&&console.log(`üîÑ Location changed from ${c.current} to ${t}`),c.current=t},[t]),{saveScroll:b,restoreScroll:y,saveCurrentScroll:f}},B=R.memo(function({selectedCategory:o,onSelect:t}){const a=[{id:"all",label:"All"},{id:"sports",label:"Sports"},{id:"pop_culture",label:"Pop Culture"},{id:"custom",label:"Custom"},{id:"politics",label:"Politics"},{id:"crypto",label:"Crypto"},{id:"tech",label:"Tech"},{id:"finance",label:"Finance"}];return e.jsx("div",{className:"category-filters bg-white border-b border-gray-100 px-4 py-3",children:e.jsx("div",{className:"overflow-x-auto -mx-2 px-2",children:e.jsx("div",{className:"flex gap-2 pb-1","data-tour":"category-chips",children:a.map(i=>e.jsx(P.button,{onClick:()=>t(i.id),className:"flex-shrink-0 inline-flex items-center px-3 h-[25px] rounded-full text-sm font-medium transition-all duration-200 whitespace-nowrap "+(o===i.id?"bg-purple-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"),whileTap:{scale:.96},"data-tour":"category-chips-item",children:i.label},i.id))})})})});B.displayName="CategoryFilters";const V=R.memo(function({stats:o,searchQuery:t,onSearchChange:a}){return e.jsx("div",{className:"px-4 pt-4 pb-4 bg-white","data-tour":"discover-header",children:e.jsxs("div",{className:"relative","data-tour-id":"search-bar",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ee,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search predictions...",value:t,onChange:i=>a(i.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-500 focus:bg-white focus:ring-2 focus:ring-emerald-500 focus:outline-none transition-all"})]})})});V.displayName="DiscoverHeaderContent";const ke=R.memo(function({onNavigateToProfile:o,onNavigateToPrediction:t}){Y(),se();const{predictions:a,loading:i,loadingMore:c,pagination:d,filters:p,refreshPredictions:C,loadMorePredictions:h,setFilters:u}=z(),[f,y]=r.useState(null),[b,n]=r.useState(!1),x=r.useRef(null),{saveScroll:w}=we(x,{saveOnUnmount:!0,restoreOnMount:!0,preserveFor:15,threshold:100}),[N,D]=r.useState({totalVolume:"0",activePredictions:0,totalUsers:"0",rawVolume:0,rawUsers:0}),$=r.useCallback(async()=>{try{const{getApiUrl:l}=await te(()=>import("./index-6112b649.js").then(g=>g.bO),["assets/index-6112b649.js","assets/ui-6244b3df.js","assets/vendor-499a370b.js","assets/utils-17ec81d9.js","assets/index-40a820b6.css"]),j=await fetch(`${l()}/api/v2/predictions/stats/platform`);if(j.ok){const g=await j.json();g.success&&(D(g.data),console.log("‚úÖ Platform stats fetched:",g.data))}else console.error("Failed to fetch platform stats:",j.status)}catch(l){console.error("Error fetching platform stats:",l)}},[]);je({hasNext:d.hasNext,loading:c,onLoadMore:()=>{console.log("üîÑ Infinite scroll triggered in DiscoverPage:",{hasNext:d.hasNext,loading:c,currentPage:d.page,total:d.total}),h()},threshold:300,container:x.current}),r.useEffect(()=>{C(),$()},[C,$]);const m=r.useMemo(()=>({totalVolume:N.totalVolume,activePredictions:N.activePredictions,totalUsers:N.totalUsers}),[N]),v=r.useMemo(()=>{if(!Array.isArray(a))return console.log("üîç DiscoverPage Debug - No valid predictions array:",a),[];const l=Date.now(),j=a.filter(g=>{if(!g||!g.id||!g.title)return console.warn("‚ö†Ô∏è DiscoverPage: Invalid prediction object:",g),!1;const Q=(g.status??"open")==="open",A=g.entry_deadline?new Date(g.entry_deadline).getTime():Number.POSITIVE_INFINITY,W=Number.isFinite(A)&&A<=l;return Q&&!W});return console.log(`üîç DiscoverPage Debug - Displaying ${j.length} active predictions (raw: ${a.length})`),j},[a]);r.useCallback(l=>{y(l),n(!0)},[]);const T=r.useCallback(l=>{w("/discover"),t?t(l):window.location.href=`/prediction/${l}`},[t,w]);r.useCallback(l=>{I.success("Prediction liked!")},[]),r.useCallback(l=>{w("/discover"),T(l)},[T,w]),r.useCallback(l=>{const j=`Check out this prediction: ${l.title}`,g=`${window.location.origin}/prediction/${l.id}`;navigator.share?navigator.share({title:l.title,text:j,url:g}).catch(console.error):navigator.clipboard.writeText(`${j}
${g}`).then(()=>I.success("Link copied to clipboard!")).catch(()=>I.error("Failed to copy link"))},[]);const E=r.useCallback(l=>{console.log("üîç Search query changed:",l),u({search:l})},[u]),F=r.useCallback(l=>{console.log("üìÇ Category changed:",l),u({category:l})},[u]),Z=r.useCallback(()=>{n(!1),y(null)},[]);return i&&(!a||a.length===0)?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-100",children:[e.jsx("div",{className:"h-11"}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 loading-skeleton"})]}),e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full loading-skeleton"})]}),e.jsxs("div",{className:"bg-gray-200 rounded-2xl p-4 mb-4 loading-skeleton",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-20 mb-3 loading-skeleton"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-16 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-12 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-14 mx-auto loading-skeleton"})]})]})]}),e.jsx("div",{className:"h-12 bg-gray-200 rounded-xl loading-skeleton"})]})]}),e.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[1,2,3,4,5,6].map(l=>e.jsx("div",{className:"h-8 bg-gray-200 rounded-full w-20 flex-shrink-0 loading-skeleton"},l))})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"px-4 mb-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 loading-skeleton"})]}),e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(l=>e.jsx(ge,{},l))})]})]}):e.jsxs("div",{ref:x,className:"discover-page content-with-bottom-nav","data-scroll-container":!0,style:{position:"relative",zIndex:1,overflowY:"auto",height:"100vh"},children:[e.jsx(ue,{title:"Discover"}),e.jsx(V,{stats:m,searchQuery:p.search,onSearchChange:E}),e.jsx("div",{className:"category-filters-wrapper",style:{position:"relative",zIndex:45},children:e.jsx(B,{selectedCategory:p.category,onSelect:F})}),e.jsxs("div",{className:"prediction-cards-container",children:[e.jsxs(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-1","data-tour-id":"discover-list",children:[(()=>({all:"All Predictions",sports:"Sports Predictions",pop_culture:"Pop Culture Predictions",custom:"Custom Predictions",politics:"Politics Predictions",crypto:"Crypto Predictions",tech:"Tech Predictions",finance:"Finance Predictions"})[p.category]||"All Predictions")(),p.search&&` - "${p.search}"`]}),d.total>0&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",v.length," of ",d.total," predictions",d.hasNext&&" ‚Ä¢ Scroll for more"]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(M,{mode:"wait",children:v.length>0?e.jsxs(e.Fragment,{children:[v.map((l,j)=>!l||!l.id?(console.warn("‚ö†Ô∏è DiscoverPage: Skipping invalid prediction at index",j),null):e.jsx(xe,{prediction:{id:l.id,title:l.title,category:l.category,endsAt:l.entry_deadline,pool:l.pool_total,players:l.participant_count,options:l.options?.slice(0,2).map(g=>({label:g.label,odds:g.current_odds})),description:l.description}},`${l.id}-${j}`)),c&&e.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center py-8",children:[e.jsx(ae,{className:"w-6 h-6 animate-spin text-purple-500 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading more predictions..."})]}),d.hasNext&&!c&&e.jsxs(P.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-6",children:[e.jsxs("button",{onClick:()=>{console.log("üîÑ Manual load more triggered"),h()},className:"bg-purple-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-600 transition-colors",children:["Load More (",d.total-v.length," remaining)"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Page ",d.page," ‚Ä¢ ",v.length,"/",d.total]})]}),!d.hasNext&&!c&&v.length>10&&e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"üéâ You've seen all predictions!"})})]}):e.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"text-center py-12 px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{size:24,className:"text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No predictions found"}),e.jsx("p",{className:"text-gray-600",children:p.search?`No predictions match "${p.search}"`:i?"Loading predictions...":"Try adjusting your filters or check back later"}),!i&&!p.search&&e.jsx("button",{onClick:()=>C(!0),className:"mt-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"Refresh Predictions"})]})})})]}),e.jsx(ve,{prediction:f,isOpen:b,onClose:Z})]})});ke.displayName="DiscoverPage";export{ke as default};
