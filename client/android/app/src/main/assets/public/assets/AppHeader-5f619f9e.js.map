{"version":3,"file":"AppHeader-5f619f9e.js","sources":["../../src/components/notifications/NotificationBell.tsx","../../src/components/layout/AppHeader.tsx"],"sourcesContent":["import React from 'react';\nimport { Bell } from 'lucide-react';\nimport { useNotifications } from '../../hooks/useNotifications';\nimport { useNavigate } from 'react-router-dom';\n\ninterface NotificationBellProps {\n  className?: string;\n}\n\n/**\n * Notification bell component with unread badge\n * Shows unread count and navigates to notifications page on click\n */\nexport const NotificationBell: React.FC<NotificationBellProps> = ({ className = '' }) => {\n  const navigate = useNavigate();\n  const { unreadCount, refreshUnreadCount, syncReminders } = useNotifications({ \n    autoRefresh: true,\n    refreshInterval: 30000, // Refresh every 30 seconds\n  });\n\n  // Refresh on mount and window focus, sync reminders\n  React.useEffect(() => {\n    refreshUnreadCount();\n    // Sync reminders on mount (debounced - at most once per 5 minutes)\n    const lastSyncKey = 'fcz:reminders:last_sync';\n    const lastSync = localStorage.getItem(lastSyncKey);\n    const now = Date.now();\n    const fiveMinutes = 5 * 60 * 1000;\n    \n    if (!lastSync || (now - parseInt(lastSync, 10)) > fiveMinutes) {\n      syncReminders().then(() => {\n        localStorage.setItem(lastSyncKey, String(now));\n      }).catch(() => {});\n    }\n    \n    const handleFocus = () => {\n      refreshUnreadCount();\n      // Sync reminders on focus (debounced)\n      const lastSyncOnFocus = localStorage.getItem(lastSyncKey);\n      if (!lastSyncOnFocus || (now - parseInt(lastSyncOnFocus, 10)) > fiveMinutes) {\n        syncReminders().then(() => {\n          localStorage.setItem(lastSyncKey, String(Date.now()));\n        }).catch(() => {});\n      }\n    };\n    \n    window.addEventListener('focus', handleFocus);\n    return () => window.removeEventListener('focus', handleFocus);\n  }, [refreshUnreadCount, syncReminders]);\n\n  const handleClick = () => {\n    navigate('/notifications');\n  };\n\n  const displayCount = unreadCount > 99 ? '9+' : unreadCount;\n\n  return (\n    <button\n      onClick={handleClick}\n      className={`relative p-2 rounded-full hover:bg-gray-100 transition-colors ${className}`}\n      aria-label={`Notifications${unreadCount > 0 ? ` (${unreadCount} unread)` : ''}`}\n    >\n      <Bell \n        className={`w-6 h-6 text-gray-600 transition-transform ${\n          unreadCount > 0 ? 'animate-pulse' : ''\n        }`} \n      />\n      {unreadCount > 0 && (\n        <div className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center font-medium px-1\">\n          {displayCount}\n        </div>\n      )}\n    </button>\n  );\n};\n\nexport default NotificationBell;\n","import React from 'react';\nimport { cn } from '../../utils/cn';\nimport { useAuthSession } from '@/providers/AuthSessionProvider';\nimport NotificationBell from '@/components/notifications/NotificationBell';\n\ntype AppHeaderProps = {\n  title?: string;                // e.g., \"Discover\", \"My Bets\", \"Wallet\"\n  subtitle?: string;             // optional short helper\n  left?: React.ReactNode;        // usually Back button or nothing on root tabs\n  right?: React.ReactNode;       // icon CTAs (Share, â€¦) or empty\n  action?: React.ReactNode;      // alias for right (back-compat)\n  sticky?: boolean;              // default true\n  showNotifications?: boolean;   // default false - only explicitly enabled on Discover/Profile\n};\n\nexport function AppHeader({ title, subtitle, left, right, action, sticky = true, showNotifications = false }: AppHeaderProps) {\n  const { user } = useAuthSession();\n  const trailing = right ?? action ?? null;\n  return (\n    <header className={cn(\n      \"w-full z-20 bg-white/80 backdrop-blur supports-[backdrop-filter]:bg-white/60\",\n      sticky && \"sticky top-0\"\n    )}>\n      <div className=\"safe-px mx-auto max-w-screen-md\">\n        <div className=\"h-12 flex items-center justify-between gap-2 px-4\">\n          <div className=\"min-w-[40px] flex items-center\">{left ?? null}</div>\n          <div className=\"flex-1 text-center\">\n            {title && <h1 className=\"text-base font-semibold leading-none truncate\">{title}</h1>}\n            {subtitle && <p className=\"text-xs text-gray-500 truncate\">{subtitle}</p>}\n          </div>\n          <div className=\"min-w-[40px] flex items-center justify-end gap-1\">\n            {showNotifications && user ? <NotificationBell /> : null}\n            {trailing}\n          </div>\n        </div>\n      </div>\n      <div className=\"border-b border-gray-200\" />\n    </header>\n  );\n}\n\nexport default AppHeader;\n"],"names":["NotificationBell","className","navigate","useNavigate","unreadCount","refreshUnreadCount","syncReminders","useNotifications","React","lastSyncKey","lastSync","now","fiveMinutes","handleFocus","lastSyncOnFocus","handleClick","displayCount","jsxs","jsx","Bell","AppHeader","title","subtitle","left","right","action","sticky","showNotifications","user","useAuthSession","trailing","cn"],"mappings":"+LAaO,MAAMA,EAAoD,CAAC,CAAE,UAAAC,EAAY,MAAS,CACvF,MAAMC,EAAWC,IACX,CAAE,YAAAC,EAAa,mBAAAC,EAAoB,cAAAC,CAAA,EAAkBC,EAAiB,CAC1E,YAAa,GACb,gBAAiB,GAAA,CAClB,EAGDC,EAAM,UAAU,IAAM,CACDH,IAEnB,MAAMI,EAAc,0BACdC,EAAW,aAAa,QAAQD,CAAW,EAC3CE,EAAM,KAAK,MACXC,EAAc,EAAI,GAAK,KAEzB,CAACF,GAAaC,EAAM,SAASD,EAAU,EAAE,EAAKE,IAClCN,EAAA,EAAE,KAAK,IAAM,CACzB,aAAa,QAAQG,EAAa,OAAOE,CAAG,CAAC,CAAA,CAC9C,EAAE,MAAM,IAAM,CAAA,CAAE,EAGnB,MAAME,EAAc,IAAM,CACLR,IAEb,MAAAS,EAAkB,aAAa,QAAQL,CAAW,GACpD,CAACK,GAAoBH,EAAM,SAASG,EAAiB,EAAE,EAAKF,IAChDN,EAAA,EAAE,KAAK,IAAM,CACzB,aAAa,QAAQG,EAAa,OAAO,KAAK,IAAK,CAAA,CAAC,CAAA,CACrD,EAAE,MAAM,IAAM,CAAA,CAAE,CACnB,EAGK,cAAA,iBAAiB,QAASI,CAAW,EACrC,IAAM,OAAO,oBAAoB,QAASA,CAAW,CAAA,EAC3D,CAACR,EAAoBC,CAAa,CAAC,EAEtC,MAAMS,EAAc,IAAM,CACxBb,EAAS,gBAAgB,CAAA,EAGrBc,EAAeZ,EAAc,GAAK,KAAOA,EAG7C,OAAAa,EAAA,KAAC,SAAA,CACC,QAASF,EACT,UAAW,iEAAiEd,CAAS,GACrF,aAAY,gBAAgBG,EAAc,EAAI,KAAKA,CAAW,WAAa,EAAE,GAE7E,SAAA,CAAAc,EAAA,IAACC,EAAA,CACC,UAAW,8CACTf,EAAc,EAAI,gBAAkB,EACtC,EAAA,CACF,EACCA,EAAc,GACbc,EAAAA,IAAC,MAAI,CAAA,UAAU,8IACZ,SACHF,EAAA,CAAA,CAAA,CAAA,CAIR,EC3DgB,SAAAI,EAAU,CAAE,MAAAC,EAAO,SAAAC,EAAU,KAAAC,EAAM,MAAAC,EAAO,OAAAC,EAAQ,OAAAC,EAAS,GAAM,kBAAAC,EAAoB,EAAA,EAAyB,CACtH,KAAA,CAAE,KAAAC,GAASC,IACXC,EAAWN,GAASC,GAAU,KAElC,OAAAR,OAAC,UAAO,UAAWc,EACjB,+EACAL,GAAU,cAEV,EAAA,SAAA,CAAAR,EAAAA,IAAC,OAAI,UAAU,kCACb,SAACD,EAAA,KAAA,MAAA,CAAI,UAAU,oDACb,SAAA,CAAAC,EAAA,IAAC,MAAI,CAAA,UAAU,iCAAkC,SAAAK,GAAQ,KAAK,EAC9DN,EAAAA,KAAC,MAAI,CAAA,UAAU,qBACZ,SAAA,CAAAI,GAAUH,EAAA,IAAA,KAAA,CAAG,UAAU,gDAAiD,SAAMG,EAAA,EAC9EC,GAAYJ,EAAA,IAAC,IAAE,CAAA,UAAU,iCAAkC,SAASI,EAAA,CAAA,EACvE,EACAL,EAAAA,KAAC,MAAI,CAAA,UAAU,mDACZ,SAAA,CAAqBU,GAAAC,EAAQV,EAAAA,IAAAlB,EAAA,CAAA,CAAiB,EAAK,KACnD8B,CAAA,EACH,CAAA,CAAA,CACF,CACF,CAAA,EACAZ,EAAAA,IAAC,MAAI,CAAA,UAAU,0BAA2B,CAAA,CAC5C,CAAA,CAAA,CAEJ"}