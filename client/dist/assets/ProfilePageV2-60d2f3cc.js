import{j as e}from"./ui-78f6af00.js";import{r as p}from"./vendor-2237fdcd.js";import{i as M,u as O,j as u,g as N,U as v,o as y,T as W}from"./index-2f27d801.js";import{u as q}from"./predictionStore-5480ffc0.js";import{U as z}from"./UserAvatar-fb600359.js";import{A as w}from"./AppHeader-577aa711.js";import{b as F,c as V,d as k}from"./format-b64c6894.js";import{A as o}from"./activity-3fca4d23.js";import{P as Y}from"./pen-line-0e38ef2a.js";import"./utils-228faac7.js";import"./index-51e43f4f.js";import"./utils-15af1a25.js";const re=({onNavigateBack:B,userId:b})=>{const{user:f}=M(),{user:P,isAuthenticated:A}=O(),{getUserPredictionEntries:U,getUserCreatedPredictions:E}=q(),[R,j]=p.useState(!0),l=f||P,d=!!f||A,S=!b||b===l?.id,t=l;p.useEffect(()=>{d&&l?.id?j(!1):d||j(!1)},[d,l?.id]);const r=U(l?.id||"")||[],m=E(l?.id||"")||[],i=r.filter(s=>s?.status==="won"||s?.status==="lost"),x=r.filter(s=>s?.status==="won"),$=r.reduce((s,a)=>s+(a?.amount||0),0),C=x.reduce((s,a)=>s+(a?.actual_payout||0),0),_=i.length>0?Math.round(x.length/i.length*100):0,h=C-$,g=[...r,...m].sort((s,a)=>new Date(a.created_at||0).getTime()-new Date(s.created_at||0).getTime()).slice(0,5);if(!d)return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:[e.jsx(w,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(o,{className:"w-4 h-4 text-gray-300"}),e.jsx("div",{className:"text-xs text-gray-400 font-medium tracking-wide",children:"Predictions"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-300 font-mono truncate",children:"--"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-gray-300"}),e.jsx("div",{className:"text-xs text-gray-400 font-medium tracking-wide",children:"Win Rate"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-300 font-mono truncate",children:"--"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(N,{className:"w-4 h-4 text-gray-300"}),e.jsx("div",{className:"text-xs text-gray-400 font-medium tracking-wide",children:"Rank"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-300 font-mono truncate",children:"--"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Overview"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(v,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view profile"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Customize your handle, avatar, and track your prediction performance."}),e.jsx("button",{onClick:async()=>{try{await y({intent:"edit_profile"})}catch(s){console.error("Auth gate error:",s)}},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors",children:"Sign In"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Recent Activity"}),e.jsx("div",{className:"text-center py-6 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Your prediction activity will appear here"})})]})]})})]});const T=r.length+m.length,c=i.length>0?x.length/i.length*100:0,L=Math.max(1,Math.ceil((100-_)/10));return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-[calc(5rem+env(safe-area-inset-bottom))]",children:[e.jsx(w,{title:"Profile"}),e.jsx("div",{className:"mx-auto w-full max-w-[720px] lg:max-w-[960px] px-4 py-4",children:e.jsx("div",{className:"space-y-4",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] animate-pulse",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2 w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-12 mt-1"})]},a))}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 mb-2"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-40"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(o,{className:"w-4 h-4 text-blue-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Predictions"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-900 font-mono truncate",children:F(T)}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[r.length," bets, ",m.length," created"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(u,{className:`w-4 h-4 ${c>=70?"text-emerald-500":c>=50?"text-yellow-500":"text-red-500"}`}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Win Rate"})]}),e.jsx("div",{className:`text-lg font-bold font-mono truncate ${c>=70?"text-emerald-600":c>=50?"text-yellow-600":"text-red-600"}`,children:V(c)}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[x.length,"/",i.length," won"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4 min-h-[88px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(N,{className:"w-4 h-4 text-purple-500"}),e.jsx("div",{className:"text-xs text-gray-600 font-medium tracking-wide",children:"Rank"})]}),e.jsxs("div",{className:"text-lg font-bold text-gray-900 font-mono truncate",children:["#",L]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:h>=0?"profitable":"improving"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Overview"}),S&&e.jsx("button",{onClick:async()=>{try{await y({intent:"edit_profile"})}catch(s){console.error("Edit profile error:",s)}},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(z,{email:t?.email,username:t?.firstName||t?.email?.split("@")[0],avatarUrl:t?.avatar,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t?.firstName&&t?.lastName?`${t.firstName} ${t.lastName}`:t?.email?.split("@")[0]||"User"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["@",t?.email?.split("@")[0]||"user"]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1 text-emerald-600",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),r.filter(s=>s.status==="active").length," active bets"]}),e.jsxs("span",{className:"text-gray-500",children:[i.length," completed"]}),e.jsxs("span",{className:"text-gray-500",children:[k(Math.abs(h),{compact:!0})," ",h>=0?"profit":"loss"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-black/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recent Activity"}),g.length>0&&e.jsx("button",{className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"View All"})]}),g.length>0?e.jsx("div",{className:"space-y-3",children:g.map((s,a)=>{const n="status"in s,D="question"in s;return e.jsxs("div",{className:"flex items-center justify-between py-2 hover:bg-gray-50 rounded-lg px-2 -mx-2 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n?s.status==="won"?"bg-emerald-100":s.status==="lost"?"bg-red-100":"bg-blue-100":"bg-purple-100"}`,children:n?s.status==="won"?e.jsx(W,{className:"w-4 h-4 text-emerald-600"}):s.status==="lost"?e.jsx(o,{className:"w-4 h-4 text-red-600"}):e.jsx(u,{className:"w-4 h-4 text-blue-600"}):e.jsx(v,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:D?String(s.question):n?`${s.status==="won"?"Won":s.status==="lost"?"Lost":"Placed"} Prediction`:"Prediction Activity"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at||0).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[n&&s.amount&&e.jsx("div",{className:`text-sm font-semibold font-mono ${s.status==="won"?"text-emerald-600":s.status==="lost"?"text-red-600":"text-gray-600"}`,children:k(s.amount,{compact:!0})}),e.jsx("div",{className:`text-xs font-medium ${n?s.status==="won"?"text-emerald-600":s.status==="lost"?"text-red-600":"text-blue-600":"text-purple-600"}`,children:n?s.status:"created"})]})]},a)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(o,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-sm text-gray-900 font-medium mb-1",children:"No recent activity"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4 max-w-sm mx-auto",children:"Your prediction activity and results will appear here."}),e.jsx("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition-colors text-sm",children:"Explore Predictions"})]})]})]})})})]})};export{re as default};
