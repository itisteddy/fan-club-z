var Cn=Object.defineProperty;var Pn=(i,t,s)=>t in i?Cn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var se=(i,t,s)=>(Pn(i,typeof t!="symbol"?t+"":t,s),s);import{j as e,m as A,A as je,S as En}from"./ui-3aed50c9.js";import{a as Tn,r as p,b as An,c as In,d as ge,R as he}from"./vendor-3a7118c2.js";import{s as $n,c as st,f as Rn}from"./utils-4cbd1938.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();var Ls={},kr=Tn;Ls.createRoot=kr.createRoot,Ls.hydrateRoot=kr.hydrateRoot;function zn(i,t){if(i instanceof RegExp)return{keys:!1,pattern:i};var s,r,n,a,o=[],l="",d=i.split("/");for(d[0]||d.shift();n=d.shift();)s=n[0],s==="*"?(o.push(s),l+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):s===":"?(r=n.indexOf("?",1),a=n.indexOf(".",1),o.push(n.substring(1,~r?r:~a?a:n.length)),l+=~r&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(l+=(~r?"?":"")+"\\"+n.substring(a))):l+="/"+n;return{keys:o,pattern:new RegExp("^"+l+(t?"(?=$|/)":"/?$"),"i")}}const Ln=An["useInsertionEffect"],On=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Dn=On?p.useLayoutEffect:p.useEffect,Un=Ln||Dn,ci=i=>{const t=p.useRef([i,(...s)=>t[0](...s)]).current;return Un(()=>{t[0]=i}),t[1]},Mn="popstate",ir="pushState",nr="replaceState",Fn="hashchange",Nr=[Mn,ir,nr,Fn],Bn=i=>{for(const t of Nr)addEventListener(t,i);return()=>{for(const t of Nr)removeEventListener(t,i)}},di=(i,t)=>$n.useSyncExternalStore(Bn,i,t),Wn=()=>location.search,Hn=({ssrSearch:i=""}={})=>di(Wn,()=>i),_r=()=>location.pathname,qn=({ssrPath:i}={})=>di(_r,i?()=>i:_r),Vn=(i,{replace:t=!1,state:s=null}={})=>history[t?nr:ir](s,"",i),Gn=(i={})=>[qn(i),Vn],Sr=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Sr]>"u"){for(const i of[ir,nr]){const t=history[i];history[i]=function(){const s=t.apply(this,arguments),r=new Event(i);return r.arguments=arguments,dispatchEvent(r),s}}Object.defineProperty(window,Sr,{value:!0})}const Jn=(i,t)=>t.toLowerCase().indexOf(i.toLowerCase())?"~"+t:t.slice(i.length)||"/",ui=(i="")=>i==="/"?"":i,Kn=(i,t)=>i[0]==="~"?i.slice(1):ui(t)+i,Yn=(i="",t)=>Jn(Cr(ui(i)),Cr(t)),Cr=i=>{try{return decodeURI(i)}catch{return i}},hi={hook:Gn,searchHook:Hn,parser:zn,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:i=>i},pi=p.createContext(hi),Dt=()=>p.useContext(pi),mi={},fi=p.createContext(mi),Zn=()=>p.useContext(fi),as=i=>{const[t,s]=i.hook(i);return[Yn(i.base,t),ci((r,n)=>s(Kn(r,i.base),n))]},oe=()=>as(Dt()),gi=(i,t,s,r)=>{const{pattern:n,keys:a}=t instanceof RegExp?{keys:!1,pattern:t}:i(t||"*",r),o=n.exec(s)||[],[l,...d]=o;return l!==void 0?[!0,(()=>{const c=a!==!1?Object.fromEntries(a.map((h,m)=>[h,d[m]])):o.groups;let u={...d};return c&&Object.assign(u,c),u})(),...r?[l]:[]]:[!1,null]},xi=({children:i,...t})=>{const s=Dt(),r=t.hook?hi:s;let n=r;const[a,o]=t.ssrPath?.split("?")??[];o&&(t.ssrSearch=o,t.ssrPath=a),t.hrefs=t.hrefs??t.hook?.hrefs;let l=p.useRef({}),d=l.current,c=d;for(let u in r){const h=u==="base"?r[u]+(t[u]||""):t[u]||r[u];d===c&&h!==c[u]&&(l.current=c={...c}),c[u]=h,(h!==r[u]||h!==n[u])&&(n=c)}return p.createElement(pi.Provider,{value:n,children:i})},Pr=({children:i,component:t},s)=>t?p.createElement(t,{params:s}):typeof i=="function"?i(s):i,Xn=i=>{let t=p.useRef(mi);const s=t.current;return t.current=Object.keys(i).length!==Object.keys(s).length||Object.entries(i).some(([r,n])=>n!==s[r])?i:s},be=({path:i,nest:t,match:s,...r})=>{const n=Dt(),[a]=as(n),[o,l,d]=s??gi(n.parser,i,a,t),c=Xn({...Zn(),...l});if(!o)return null;const u=d?p.createElement(xi,{base:d},Pr(r,c)):Pr(r,c);return p.createElement(fi.Provider,{value:c,children:u})};p.forwardRef((i,t)=>{const s=Dt(),[r,n]=as(s),{to:a="",href:o=a,onClick:l,asChild:d,children:c,className:u,replace:h,state:m,...f}=i,y=ci(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(l?.(g),g.defaultPrevented||(g.preventDefault(),n(o,i)))}),x=s.hrefs(o[0]==="~"?o.slice(1):s.base+o,s);return d&&p.isValidElement(c)?p.cloneElement(c,{onClick:y,href:x}):p.createElement("a",{...f,onClick:y,href:x,className:u?.call?u(r===o):u,children:c,ref:t})});const bi=i=>Array.isArray(i)?i.flatMap(t=>bi(t&&t.type===p.Fragment?t.props.children:t)):[i],Er=({children:i,location:t})=>{const s=Dt(),[r]=as(s);for(const n of bi(i)){let a=0;if(p.isValidElement(n)&&(a=gi(s.parser,n.props.path,t||r,n.props.nest))[0])return p.cloneElement(n,{match:a})}return null},Qn="modulepreload",ea=function(i){return"/"+i},Tr={},Ut=function(t,s,r){if(!s||s.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(s.map(a=>{if(a=ea(a),a in Tr)return;Tr[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===a&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Qn,o||(c.as="script",c.crossOrigin=""),c.href=a,document.head.appendChild(c),o)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})},ta=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...s)=>Ut(()=>Promise.resolve().then(()=>xt),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)};class ar extends Error{constructor(t,s="FunctionsError",r){super(t),this.name=s,this.context=r}}class sa extends ar{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ar extends ar{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ir extends ar{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Os;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Os||(Os={}));var ra=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};class ia{constructor(t,{headers:s={},customFetch:r,region:n=Os.Any}={}){this.url=t,this.headers=s,this.region=n,this.fetch=ta(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,s={}){var r;return ra(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:o}=s;let l={},{region:d}=s;d||(d=this.region);const c=new URL(`${this.url}/${t}`);d&&d!=="any"&&(l["x-region"]=d,c.searchParams.set("forceFunctionRegion",d));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:u}).catch(x=>{throw new sa(x)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new Ar(h);if(!h.ok)throw new Ir(h);let f=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),y;return f==="application/json"?y=yield h.json():f==="application/octet-stream"?y=yield h.blob():f==="text/event-stream"?y=h:f==="multipart/form-data"?y=yield h.formData():y=yield h.text(),{data:y,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof Ir||n instanceof Ar?n.context:void 0}}})}}var me={},or={},os={},Mt={},ls={},cs={},na=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},mt=na();const aa=mt.fetch,yi=mt.fetch.bind(mt),vi=mt.Headers,oa=mt.Request,la=mt.Response,xt=Object.freeze(Object.defineProperty({__proto__:null,Headers:vi,Request:oa,Response:la,default:yi,fetch:aa},Symbol.toStringTag,{value:"Module"})),ca=In(xt);var ds={};Object.defineProperty(ds,"__esModule",{value:!0});let da=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};ds.default=da;var wi=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(cs,"__esModule",{value:!0});const ua=wi(ca),ha=wi(ds);let pa=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=ua.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=Object.assign({},this.headers),this.headers[t]=s,this}then(t,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,d;let c=null,u=null,h=null,m=a.status,f=a.statusText;if(a.ok){if(this.method!=="HEAD"){const j=await a.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=j:u=JSON.parse(j))}const x=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");x&&g&&g.length>1&&(h=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const x=await a.text();try{c=JSON.parse(x),Array.isArray(c)&&a.status===404&&(u=[],c=null,m=200,f="OK")}catch{a.status===404&&x===""?(m=204,f="No Content"):c={message:x}}if(c&&this.isMaybeSingle&&(!((d=c?.details)===null||d===void 0)&&d.includes("0 rows"))&&(c=null,m=200,f="OK"),c&&this.shouldThrowOnError)throw new ha.default(c)}return{error:c,data:u,count:h,status:m,statusText:f}});return this.shouldThrowOnError||(n=n.catch(a=>{var o,l,d;return{error:{message:`${(o=a?.name)!==null&&o!==void 0?o:"FetchError"}: ${a?.message}`,details:`${(l=a?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(d=a?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,s)}returns(){return this}overrideTypes(){return this}};cs.default=pa;var ma=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ls,"__esModule",{value:!0});const fa=ma(cs);let ga=class extends fa.default{select(t){let s=!1;const r=(t??"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:s=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${s?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:s,referencedTable:r=s}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,s,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${s-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:s=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:o="text"}={}){var l;const d=[t?"analyze":null,s?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${d};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ls.default=ga;var xa=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Mt,"__esModule",{value:!0});const ba=xa(ls);let ya=class extends ba.default{eq(t,s){return this.url.searchParams.append(t,`eq.${s}`),this}neq(t,s){return this.url.searchParams.append(t,`neq.${s}`),this}gt(t,s){return this.url.searchParams.append(t,`gt.${s}`),this}gte(t,s){return this.url.searchParams.append(t,`gte.${s}`),this}lt(t,s){return this.url.searchParams.append(t,`lt.${s}`),this}lte(t,s){return this.url.searchParams.append(t,`lte.${s}`),this}like(t,s){return this.url.searchParams.append(t,`like.${s}`),this}likeAllOf(t,s){return this.url.searchParams.append(t,`like(all).{${s.join(",")}}`),this}likeAnyOf(t,s){return this.url.searchParams.append(t,`like(any).{${s.join(",")}}`),this}ilike(t,s){return this.url.searchParams.append(t,`ilike.${s}`),this}ilikeAllOf(t,s){return this.url.searchParams.append(t,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(t,s){return this.url.searchParams.append(t,`ilike(any).{${s.join(",")}}`),this}is(t,s){return this.url.searchParams.append(t,`is.${s}`),this}in(t,s){const r=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cs.{${s.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(s)}`),this}containedBy(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cd.{${s.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(s)}`),this}rangeGt(t,s){return this.url.searchParams.append(t,`sr.${s}`),this}rangeGte(t,s){return this.url.searchParams.append(t,`nxl.${s}`),this}rangeLt(t,s){return this.url.searchParams.append(t,`sl.${s}`),this}rangeLte(t,s){return this.url.searchParams.append(t,`nxr.${s}`),this}rangeAdjacent(t,s){return this.url.searchParams.append(t,`adj.${s}`),this}overlaps(t,s){return typeof s=="string"?this.url.searchParams.append(t,`ov.${s}`):this.url.searchParams.append(t,`ov.{${s.join(",")}}`),this}textSearch(t,s,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${a}fts${o}.${s}`),this}match(t){return Object.entries(t).forEach(([s,r])=>{this.url.searchParams.append(s,`eq.${r}`)}),this}not(t,s,r){return this.url.searchParams.append(t,`not.${s}.${r}`),this}or(t,{foreignTable:s,referencedTable:r=s}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,s,r){return this.url.searchParams.append(t,`${s}.${r}`),this}};Mt.default=ya;var va=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(os,"__esModule",{value:!0});const _t=va(Mt);let wa=class{constructor(t,{headers:s={},schema:r,fetch:n}){this.url=t,this.headers=s,this.schema=r,this.fetch=n}select(t,{head:s=!1,count:r}={}){const n=s?"HEAD":"GET";let a=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new _t.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:s,defaultToNull:r=!0}={}){const n="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const o=t.reduce((l,d)=>l.concat(Object.keys(d)),[]);if(o.length>0){const l=[...new Set(o)].map(d=>`"${d}"`);this.url.searchParams.set("columns",l.join(","))}}return new _t.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:s,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const d=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(d.length>0){const c=[...new Set(d)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new _t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:s}={}){const r="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),s&&n.push(`count=${s}`),this.headers.Prefer=n.join(","),new _t.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const s="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new _t.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};os.default=wa;var us={},hs={};Object.defineProperty(hs,"__esModule",{value:!0});hs.version=void 0;hs.version="0.0.0-automated";Object.defineProperty(us,"__esModule",{value:!0});us.DEFAULT_HEADERS=void 0;const ja=hs;us.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ja.version}`};var ji=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(or,"__esModule",{value:!0});const ka=ji(os),Na=ji(Mt),_a=us;let Sa=class ki{constructor(t,{headers:s={},schema:r,fetch:n}={}){this.url=t,this.headers=Object.assign(Object.assign({},_a.DEFAULT_HEADERS),s),this.schemaName=r,this.fetch=n}from(t){const s=new URL(`${this.url}/${t}`);return new ka.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new ki(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:r=!1,get:n=!1,count:a}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let d;r||n?(o=r?"HEAD":"GET",Object.entries(s).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",d=s);const c=Object.assign({},this.headers);return a&&(c.Prefer=`count=${a}`),new Na.default({method:o,url:l,headers:c,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};or.default=Sa;var bt=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(me,"__esModule",{value:!0});me.PostgrestError=me.PostgrestBuilder=me.PostgrestTransformBuilder=me.PostgrestFilterBuilder=me.PostgrestQueryBuilder=me.PostgrestClient=void 0;const Ni=bt(or);me.PostgrestClient=Ni.default;const _i=bt(os);me.PostgrestQueryBuilder=_i.default;const Si=bt(Mt);me.PostgrestFilterBuilder=Si.default;const Ci=bt(ls);me.PostgrestTransformBuilder=Ci.default;const Pi=bt(cs);me.PostgrestBuilder=Pi.default;const Ei=bt(ds);me.PostgrestError=Ei.default;var Ca=me.default={PostgrestClient:Ni.default,PostgrestQueryBuilder:_i.default,PostgrestFilterBuilder:Si.default,PostgrestTransformBuilder:Ci.default,PostgrestBuilder:Pi.default,PostgrestError:Ei.default};const{PostgrestClient:Pa,PostgrestQueryBuilder:Nu,PostgrestFilterBuilder:_u,PostgrestTransformBuilder:Su,PostgrestBuilder:Cu,PostgrestError:Pu}=Ca;class Ea{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const s=parseInt(process.versions.node.split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let s=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(s+=`

Suggested solution: ${t.workaround}`),new Error(s)}static createWebSocket(t,s){const r=this.getWebSocketConstructor();return new r(t,s)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Ta="2.15.1",Aa=`realtime-js/${Ta}`,Ia="1.0.0",Ds=1e4,$a=1e3,Ra=100;var Tt;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Tt||(Tt={}));var ie;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(ie||(ie={}));var ve;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(ve||(ve={}));var Us;(function(i){i.websocket="websocket"})(Us||(Us={}));var Ze;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ze||(Ze={}));class za{constructor(){this.HEADER_LENGTH=1}decode(t,s){return t.constructor===ArrayBuffer?s(this._binaryDecode(t)):s(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const s=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,s,r)}_decodeBroadcast(t,s,r){const n=s.getUint8(1),a=s.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+n));o=o+n;const d=r.decode(t.slice(o,o+a));o=o+a;const c=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:d,payload:c}}}class Ti{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Z;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(Z||(Z={}));const $r=(i,t,s={})=>{var r;const n=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((a,o)=>(a[o]=La(o,i,t,n),a),{})},La=(i,t,s,r)=>{const n=t.find(l=>l.name===i),a=n?.type,o=s[i];return a&&!r.includes(a)?Ai(a,o):Ms(o)},Ai=(i,t)=>{if(i.charAt(0)==="_"){const s=i.slice(1,i.length);return Ma(t,s)}switch(i){case Z.bool:return Oa(t);case Z.float4:case Z.float8:case Z.int2:case Z.int4:case Z.int8:case Z.numeric:case Z.oid:return Da(t);case Z.json:case Z.jsonb:return Ua(t);case Z.timestamp:return Fa(t);case Z.abstime:case Z.date:case Z.daterange:case Z.int4range:case Z.int8range:case Z.money:case Z.reltime:case Z.text:case Z.time:case Z.timestamptz:case Z.timetz:case Z.tsrange:case Z.tstzrange:return Ms(t);default:return Ms(t)}},Ms=i=>i,Oa=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Da=i=>{if(typeof i=="string"){const t=parseFloat(i);if(!Number.isNaN(t))return t}return i},Ua=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(t){return console.log(`JSON parse error: ${t}`),i}return i},Ma=(i,t)=>{if(typeof i!="string")return i;const s=i.length-1,r=i[s];if(i[0]==="{"&&r==="}"){let a;const o=i.slice(1,s);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Ai(t,l))}return i},Fa=i=>typeof i=="string"?i.replace(" ","T"):i,Ii=i=>{let t=i;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class vs{constructor(t,s,r={},n=Ds){this.channel=t,this.event=s,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var r;return this._hasReceived(t)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Rr;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Rr||(Rr={}));class At{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=At.syncState(this.state,n,a,o),this.pendingDiffs.forEach(d=>{this.state=At.syncDiff(this.state,d,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},n=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=At.syncDiff(this.state,n,a,o),l())}),this.onJoin((n,a,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:o})}),this.onLeave((n,a,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,r,n){const a=this.cloneDeep(t),o=this.transformState(s),l={},d={};return this.map(a,(c,u)=>{o[c]||(d[c]=u)}),this.map(o,(c,u)=>{const h=a[c];if(h){const m=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),y=u.filter(g=>f.indexOf(g.presence_ref)<0),x=h.filter(g=>m.indexOf(g.presence_ref)<0);y.length>0&&(l[c]=y),x.length>0&&(d[c]=x)}else l[c]=u}),this.syncDiff(a,{joins:l,leaves:d},r,n)}static syncDiff(t,s,r,n){const{joins:a,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,(l,d)=>{var c;const u=(c=t[l])!==null&&c!==void 0?c:[];if(t[l]=this.cloneDeep(d),u.length>0){const h=t[l].map(f=>f.presence_ref),m=u.filter(f=>h.indexOf(f.presence_ref)<0);t[l].unshift(...m)}r(l,u,d)}),this.map(o,(l,d)=>{let c=t[l];if(!c)return;const u=d.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[l]=c,n(l,c,d),c.length===0&&delete t[l]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(r=>s(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,r)=>{const n=t[r];return"metas"in n?s[r]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):s[r]=n,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zr;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(zr||(zr={}));var It;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(It||(It={}));var Ae;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Ae||(Ae={}));class lr{constructor(t,s={config:{}},r){this.topic=t,this.params=s,this.socket=r,this.bindings={},this.state=ie.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new vs(this,ve.join,this.params,this.timeout),this.rejoinTimer=new Ti(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ie.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ie.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ve.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new At(this),this.broadcastEndpointURL=Ii(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,s=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==ie.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,d=(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&n!==void 0?n:[],c=!!this.bindings[It.PRESENCE]&&this.bindings[It.PRESENCE].length>0,u={},h={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>t?.(Ae.CHANNEL_ERROR,m)),this._onClose(()=>t?.(Ae.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){t?.(Ae.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,x=(f=y?.length)!==null&&f!==void 0?f:0,g=[];for(let j=0;j<x;j++){const v=y[j],{filter:{event:w,schema:C,table:z,filter:S}}=v,$=m&&m[j];if($&&$.event===w&&$.schema===C&&$.table===z&&$.filter===S)g.push(Object.assign(Object.assign({},v),{id:$.id}));else{this.unsubscribe(),this.state=ie.errored,t?.(Ae.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Ae.SUBSCRIBED);return}}).receive("error",m=>{this.state=ie.errored,t?.(Ae.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t?.(Ae.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,r){return this.state===ie.joined&&t===It.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,s,r)}async send(t,s={}){var r,n;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,d;const c=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ie.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ve.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new vs(this,ve.leave,{},t),r.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ie.closed,this.bindings={}}async _fetchWithTimeout(t,s,r){const n=new AbortController,a=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(a),o}_push(t,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new vs(this,t,s,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Ra){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(t,s,r){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,r){var n,a;const o=t.toLocaleLowerCase(),{close:l,error:d,leave:c,join:u}=ve;if(r&&[l,d,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,s,r);if(s&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var y,x,g;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((g=(x=f.filter)===null||x===void 0?void 0:x.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(m,r)):(a=this.bindings[o])===null||a===void 0||a.filter(f=>{var y,x,g,j,v,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const C=f.id,z=(y=f.filter)===null||y===void 0?void 0:y.event;return C&&((x=s.ids)===null||x===void 0?void 0:x.includes(C))&&(z==="*"||z?.toLocaleLowerCase()===((g=s.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const C=(v=(j=f?.filter)===null||j===void 0?void 0:j.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return C==="*"||C===((w=s?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:x,table:g,commit_timestamp:j,type:v,errors:w}=y;m=Object.assign(Object.assign({},{schema:x,table:g,commit_timestamp:j,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(y))}f.callback(m,r)})}_isClosed(){return this.state===ie.closed}_isJoined(){return this.state===ie.joined}_isJoining(){return this.state===ie.joining}_isLeaving(){return this.state===ie.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,r){const n=t.toLocaleLowerCase(),a={type:n,filter:s,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(t,s){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&lr.isEqual(n.filter,s))})),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const r in t)if(t[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ve.close,{},t)}_onError(t){this._on(ve.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ie.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=$r(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=$r(t.columns,t.old_record)),s}}const Lr=()=>{},Vt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ba=[1e3,2e3,5e3,1e4],Wa=1e4,Ha=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class qa{constructor(t,s){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ds,this.transport=null,this.heartbeatIntervalMs=Vt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Lr,this.ref=0,this.reconnectTimer=null,this.logger=Lr,this.conn=null,this.sendBuffer=[],this.serializer=new za,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let a;return n?a=n:typeof fetch>"u"?a=(...o)=>Ut(()=>Promise.resolve().then(()=>xt),void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((r=s?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${t}/${Us.websocket}`,this.httpEndpoint=Ii(t),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ea.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const s=t.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ia}))}disconnect(t,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},t?this.conn.close(t,s??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,r){this.logger(t,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Tt.connecting:return Ze.Connecting;case Tt.open:return Ze.Open;case Tt.closing:return Ze.Closing;default:return Ze.Closed}}isConnected(){return this.connectionState()===Ze.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,s={config:{}}){const r=`realtime:${t}`,n=this.getChannels().find(a=>a.topic===r);if(n)return n;{const a=new lr(`realtime:${t}`,s,this);return this.channels.push(a),a}}push(t){const{topic:s,event:r,payload:n,ref:a}=t,o=()=>{this.encode(t,l=>{var d;(d=this.conn)===null||d===void 0||d.send(l)})};this.log("push",`${s} ${r} (${a})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close($a,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Vt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,s=>{s.topic==="phoenix"&&s.event==="phx_reply"&&this.heartbeatCallback(s.payload.status==="ok"?"ok":"error"),s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:n,payload:a,ref:o}=s,l=o?`(${o})`:"",d=a.status||"";this.log("receive",`${d} ${r} ${n} ${l}`.trim(),a),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(n,a,o)),this._triggerStateCallbacks("message",s)})}_clearTimer(t){var s;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var s;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ve.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const r=t.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${t}${r}${n}`}_workerObjectUrl(t){let s;if(t)s=t;else{const r=new Blob([Ha],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}_setConnectionState(t,s=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(t=null){let s;t?s=t:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(r=>{const n={access_token:s,version:Aa};s&&r.updateJoinPayload(n),r.joinedOnce&&r._isJoined()&&r._push(ve.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${t}`,s)})}_triggerStateCallbacks(t,s){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(s)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Ti(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var s,r,n,a,o,l,d,c;if(this.transport=(s=t?.transport)!==null&&s!==void 0?s:null,this.timeout=(r=t?.timeout)!==null&&r!==void 0?r:Ds,this.heartbeatIntervalMs=(n=t?.heartbeatIntervalMs)!==null&&n!==void 0?n:Vt.HEARTBEAT_INTERVAL,this.worker=(a=t?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t?.reconnectAfterMs)!==null&&l!==void 0?l:u=>Ba[u-1]||Wa,this.encode=(d=t?.encode)!==null&&d!==void 0?d:(u,h)=>h(JSON.stringify(u)),this.decode=(c=t?.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class cr extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ne(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class Va extends cr{constructor(t,s,r){super(t),this.name="StorageApiError",this.status=s,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Fs extends cr{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}var Ga=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};const $i=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...s)=>Ut(()=>Promise.resolve().then(()=>xt),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},Ja=()=>Ga(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ut(()=>Promise.resolve().then(()=>xt),void 0)).Response:Response}),Bs=i=>{if(Array.isArray(i))return i.map(s=>Bs(s));if(typeof i=="function"||i!==Object(i))return i;const t={};return Object.entries(i).forEach(([s,r])=>{const n=s.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[n]=Bs(r)}),t},Ka=i=>{if(typeof i!="object"||i===null)return!1;const t=Object.getPrototypeOf(i);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)};var rt=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};const ws=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ya=(i,t,s)=>rt(void 0,void 0,void 0,function*(){const r=yield Ja();i instanceof r&&!s?.noResolveJson?i.json().then(n=>{const a=i.status||500,o=n?.statusCode||a+"";t(new Va(ws(n),a,o))}).catch(n=>{t(new Fs(ws(n),n))}):t(new Fs(ws(i),i))}),Za=(i,t,s,r)=>{const n={method:i,headers:t?.headers||{}};return i==="GET"||!r?n:(Ka(r)?(n.headers=Object.assign({"Content-Type":"application/json"},t?.headers),n.body=JSON.stringify(r)):n.body=r,t?.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),s))};function Ft(i,t,s,r,n,a){return rt(this,void 0,void 0,function*(){return new Promise((o,l)=>{i(s,Za(t,r,n,a)).then(d=>{if(!d.ok)throw d;return r?.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>Ya(d,l,r))})})}function es(i,t,s,r){return rt(this,void 0,void 0,function*(){return Ft(i,"GET",t,s,r)})}function _e(i,t,s,r,n){return rt(this,void 0,void 0,function*(){return Ft(i,"POST",t,r,n,s)})}function Ws(i,t,s,r,n){return rt(this,void 0,void 0,function*(){return Ft(i,"PUT",t,r,n,s)})}function Xa(i,t,s,r){return rt(this,void 0,void 0,function*(){return Ft(i,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function Ri(i,t,s,r,n){return rt(this,void 0,void 0,function*(){return Ft(i,"DELETE",t,r,n,s)})}var ue=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};const Qa={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Or={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class eo{constructor(t,s={},r,n){this.url=t,this.headers=s,this.bucketId=r,this.fetch=$i(n)}uploadOrUpdate(t,s,r,n){return ue(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Or),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,d&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),n?.headers&&(l=Object.assign(Object.assign({},l),n.headers));const c=this._removeEmptyFolders(s),u=this._getFinalPath(c),h=yield(t=="PUT"?Ws:_e)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(ne(a))return{data:null,error:a};throw a}})}upload(t,s,r){return ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,r)})}uploadToSignedUrl(t,s,r,n){return ue(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",s);try{let d;const c=Object.assign({upsert:Or.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",c.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",c.cacheControl)):(d=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield Ws(this.fetch,l.toString(),d,{headers:u});return{data:{path:a,fullPath:h.Key},error:null}}catch(d){if(ne(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,s){return ue(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const n=Object.assign({},this.headers);s?.upsert&&(n["x-upsert"]="true");const a=yield _e(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new cr("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}update(t,s,r){return ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,r)})}move(t,s,r){return ue(this,void 0,void 0,function*(){try{return{data:yield _e(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(ne(n))return{data:null,error:n};throw n}})}copy(t,s,r){return ue(this,void 0,void 0,function*(){try{return{data:{path:(yield _e(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(ne(n))return{data:null,error:n};throw n}})}createSignedUrl(t,s,r){return ue(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),a=yield _e(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(n){if(ne(n))return{data:null,error:n};throw n}})}createSignedUrls(t,s,r){return ue(this,void 0,void 0,function*(){try{const n=yield _e(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(n){if(ne(n))return{data:null,error:n};throw n}})}download(t,s){return ue(this,void 0,void 0,function*(){const n=typeof s?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(s?.transform||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield es(this.fetch,`${this.url}/${n}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ne(l))return{data:null,error:l};throw l}})}info(t){return ue(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const r=yield es(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Bs(r),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}exists(t){return ue(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield Xa(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ne(r)&&r instanceof Fs){const n=r.originalError;if([400,404].includes(n?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,s){const r=this._getFinalPath(t),n=[],a=s?.download?`download=${s.download===!0?"":s.download}`:"";a!==""&&n.push(a);const l=typeof s?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(s?.transform||{});d!==""&&n.push(d);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}list(t,s,r){return ue(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Qa),s),{prefix:t||""});return{data:yield _e(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(ne(n))return{data:null,error:n};throw n}})}listV2(t,s){return ue(this,void 0,void 0,function*(){try{const r=Object.assign({},t);return{data:yield _e(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const to="2.11.0",so={"X-Client-Info":`storage-js/${to}`};var it=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};class ro{constructor(t,s={},r,n){const a=new URL(t);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},so),s),this.fetch=$i(r)}listBuckets(){return it(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}getBucket(t){return it(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}createBucket(t,s={public:!1}){return it(this,void 0,void 0,function*(){try{return{data:yield _e(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}updateBucket(t,s){return it(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}emptyBucket(t){return it(this,void 0,void 0,function*(){try{return{data:yield _e(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}deleteBucket(t){return it(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}}class io extends ro{constructor(t,s={},r,n){super(t,s,r,n)}from(t){return new eo(this.url,this.headers,t,this.fetch)}}const no="2.55.0";let Et="";typeof Deno<"u"?Et="deno":typeof document<"u"?Et="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Et="react-native":Et="node";const ao={"X-Client-Info":`supabase-js-${Et}/${no}`},oo={headers:ao},lo={schema:"public"},co={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uo={};var ho=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};const po=i=>{let t;return i?t=i:typeof fetch>"u"?t=yi:t=fetch,(...s)=>t(...s)},mo=()=>typeof Headers>"u"?vi:Headers,fo=(i,t,s)=>{const r=po(s),n=mo();return(a,o)=>ho(void 0,void 0,void 0,function*(){var l;const d=(l=yield t())!==null&&l!==void 0?l:i;let c=new n(o?.headers);return c.has("apikey")||c.set("apikey",i),c.has("Authorization")||c.set("Authorization",`Bearer ${d}`),r(a,Object.assign(Object.assign({},o),{headers:c}))})};var go=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};function xo(i){return i.endsWith("/")?i:i+"/"}function bo(i,t){var s,r;const{db:n,auth:a,realtime:o,global:l}=i,{db:d,auth:c,realtime:u,global:h}=t,m={db:Object.assign(Object.assign({},d),n),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(s=h?.headers)!==null&&s!==void 0?s:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>go(this,void 0,void 0,function*(){return""})};return i.accessToken?m.accessToken=i.accessToken:delete m.accessToken,m}const zi="2.71.1",dt=30*1e3,Hs=3,js=Hs*dt,yo="http://localhost:9999",vo="supabase.auth.token",wo={"X-Client-Info":`gotrue-js/${zi}`},qs="X-Supabase-Api-Version",Li={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jo=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ko=10*60*1e3;class dr extends Error{constructor(t,s,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function M(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class No extends dr{constructor(t,s,r){super(t,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function _o(i){return M(i)&&i.name==="AuthApiError"}class Oi extends dr{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class qe extends dr{constructor(t,s,r,n){super(t,r,n),this.name=s,this.status=r}}class Me extends qe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function So(i){return M(i)&&i.name==="AuthSessionMissingError"}class Gt extends qe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jt extends qe{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Kt extends qe{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Co(i){return M(i)&&i.name==="AuthImplicitGrantRedirectError"}class Dr extends qe{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vs extends qe{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function ks(i){return M(i)&&i.name==="AuthRetryableFetchError"}class Ur extends qe{constructor(t,s,r){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class Gs extends qe{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mr=` 	
\r=`.split(""),Po=(()=>{const i=new Array(128);for(let t=0;t<i.length;t+=1)i[t]=-1;for(let t=0;t<Mr.length;t+=1)i[Mr[t].charCodeAt(0)]=-2;for(let t=0;t<ts.length;t+=1)i[ts[t].charCodeAt(0)]=t;return i})();function Fr(i,t,s){if(i!==null)for(t.queue=t.queue<<8|i,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;s(ts[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;s(ts[r]),t.queuedBits-=6}}function Di(i,t,s){const r=Po[i];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Br(i){const t=[],s=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=o=>{Ao(o,r,s)};for(let o=0;o<i.length;o+=1)Di(i.charCodeAt(o),n,a);return t.join("")}function Eo(i,t){if(i<=127){t(i);return}else if(i<=2047){t(192|i>>6),t(128|i&63);return}else if(i<=65535){t(224|i>>12),t(128|i>>6&63),t(128|i&63);return}else if(i<=1114111){t(240|i>>18),t(128|i>>12&63),t(128|i>>6&63),t(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function To(i,t){for(let s=0;s<i.length;s+=1){let r=i.charCodeAt(s);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(i.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}Eo(r,t)}}function Ao(i,t,s){if(t.utf8seq===0){if(i<=127){s(i);return}for(let r=1;r<6;r+=1)if(!(i>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=i&31;else if(t.utf8seq===3)t.codepoint=i&15;else if(t.utf8seq===4)t.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|i&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function Io(i){const t=[],s={queue:0,queuedBits:0},r=n=>{t.push(n)};for(let n=0;n<i.length;n+=1)Di(i.charCodeAt(n),s,r);return new Uint8Array(t)}function $o(i){const t=[];return To(i,s=>t.push(s)),new Uint8Array(t)}function Ro(i){const t=[],s={queue:0,queuedBits:0},r=n=>{t.push(n)};return i.forEach(n=>Fr(n,s,r)),Fr(null,s,r),t.join("")}function zo(i){return Math.round(Date.now()/1e3)+i}function Lo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=Math.random()*16|0;return(i=="x"?t:t&3|8).toString(16)})}const ye=()=>typeof window<"u"&&typeof document<"u",Je={tested:!1,writable:!1},Ui=()=>{if(!ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Je.tested)return Je.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Je.tested=!0,Je.writable=!0}catch{Je.tested=!0,Je.writable=!1}return Je.writable};function Oo(i){const t={},s=new URL(i);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,a)=>{t[a]=n})}catch{}return s.searchParams.forEach((r,n)=>{t[n]=r}),t}const Mi=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...s)=>Ut(()=>Promise.resolve().then(()=>xt),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},Do=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",ut=async(i,t,s)=>{await i.setItem(t,JSON.stringify(s))},Ke=async(i,t)=>{const s=await i.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Oe=async(i,t)=>{await i.removeItem(t)};class ps{constructor(){this.promise=new ps.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}ps.promiseConstructor=Promise;function Ns(i){const t=i.split(".");if(t.length!==3)throw new Gs("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!jo.test(t[r]))throw new Gs("JWT not in base64url format");return{header:JSON.parse(Br(t[0])),payload:JSON.parse(Br(t[1])),signature:Io(t[2]),raw:{header:t[0],payload:t[1]}}}async function Uo(i){return await new Promise(t=>{setTimeout(()=>t(null),i)})}function Mo(i,t){return new Promise((r,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await i(a);if(!t(a,null,o)){r(o);return}}catch(o){if(!t(a,o)){n(o);return}}})()})}function Fo(i){return("0"+i.toString(16)).substr(-2)}function Bo(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let n="";for(let a=0;a<56;a++)n+=s.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(t),Array.from(t,Fo).join("")}async function Wo(i){const s=new TextEncoder().encode(i),r=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(r);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Ho(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const s=await Wo(i);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function nt(i,t,s=!1){const r=Bo();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await ut(i,`${t}-code-verifier`,n);const a=await Ho(r);return[a,r===a?"plain":"s256"]}const qo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Vo(i){const t=i.headers.get(qs);if(!t||!t.match(qo))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Go(i){if(!i)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(i<=t)throw new Error("JWT has expired")}function Jo(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ko=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function at(i){if(!Ko.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _s(){const i={};return new Proxy(i,{get:(t,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Wr(i){return JSON.parse(JSON.stringify(i))}var Yo=globalThis&&globalThis.__rest||function(i,t){var s={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(s[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(s[r[n]]=i[r[n]]);return s};const Ye=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Zo=[502,503,504];async function Hr(i){var t;if(!Do(i))throw new Vs(Ye(i),0);if(Zo.includes(i.status))throw new Vs(Ye(i),i.status);let s;try{s=await i.json()}catch(a){throw new Oi(Ye(a),a)}let r;const n=Vo(i);if(n&&n.getTime()>=Li["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new Ur(Ye(s),i.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Me}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Ur(Ye(s),i.status,s.weak_password.reasons);throw new No(Ye(s),i.status||500,r)}const Xo=(i,t,s,r)=>{const n={method:i,headers:t?.headers||{}};return i==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))};async function q(i,t,s,r){var n;const a=Object.assign({},r?.headers);a[qs]||(a[qs]=Li["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(n=r?.query)!==null&&n!==void 0?n:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await Qo(i,t,s+l,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(d):{data:Object.assign({},d),error:null}}async function Qo(i,t,s,r,n,a){const o=Xo(t,r,n,a);let l;try{l=await i(s,Object.assign({},o))}catch(d){throw console.error(d),new Vs(Ye(d),0)}if(l.ok||await Hr(l),r?.noResolveJson)return l;try{return await l.json()}catch(d){await Hr(d)}}function Te(i){var t;let s=null;rl(i)&&(s=Object.assign({},i),i.expires_at||(s.expires_at=zo(i.expires_in)));const r=(t=i.user)!==null&&t!==void 0?t:i;return{data:{session:s,user:r},error:null}}function qr(i){const t=Te(i);return!t.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(t.data.weak_password=i.weak_password),t}function Fe(i){var t;return{data:{user:(t=i.user)!==null&&t!==void 0?t:i},error:null}}function el(i){return{data:i,error:null}}function tl(i){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:a}=i,o=Yo(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:a},d=Object.assign({},o);return{data:{properties:l,user:d},error:null}}function sl(i){return i}function rl(i){return i.access_token&&i.refresh_token&&i.expires_in}const Ss=["global","local","others"];var il=globalThis&&globalThis.__rest||function(i,t){var s={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(s[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(s[r[n]]=i[r[n]]);return s};class nl{constructor({url:t="",headers:s={},fetch:r}){this.url=t,this.headers=s,this.fetch=Mi(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,s=Ss[0]){if(Ss.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ss.join(", ")}`);try{return await q(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(M(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,s={}){try{return await q(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Fe})}catch(r){if(M(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:s}=t,r=il(t,["options"]),n=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(n.new_email=r?.newEmail,delete n.newEmail),await q(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:tl,redirectTo:s?.redirectTo})}catch(s){if(M(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await q(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Fe})}catch(s){if(M(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,r,n,a,o,l,d;try{const c={nextPage:null,lastPage:0,total:0},u=await q(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=t?.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(a=(n=t?.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:sl});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(d=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&d!==void 0?d:[];return f.length>0&&(f.forEach(y=>{const x=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(y.split(";")[1].split("=")[1]);c[`${g}Page`]=x}),c.total=parseInt(m)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(M(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){at(t);try{return await q(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Fe})}catch(s){if(M(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){at(t);try{return await q(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:Fe})}catch(r){if(M(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,s=!1){at(t);try{return await q(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:Fe})}catch(r){if(M(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){at(t.userId);try{const{data:s,error:r}=await q(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:r}}catch(s){if(M(s))return{data:null,error:s};throw s}}async _deleteFactor(t){at(t.userId),at(t.id);try{return{data:await q(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(M(s))return{data:null,error:s};throw s}}}function Vr(i={}){return{getItem:t=>i[t]||null,setItem:(t,s)=>{i[t]=s},removeItem:t=>{delete i[t]}}}function al(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ot={debug:!!(globalThis&&Ui()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Fi extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ol extends Fi{}async function ll(i,t,s){ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),ot.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,n.name);try{return await s()}finally{ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,n.name)}}else{if(t===0)throw ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new ol(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(ot.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}al();const cl={url:yo,storageKey:vo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wo,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Gr(i,t,s){return await s()}const lt={};class Rt{constructor(t){var s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Rt.nextInstanceID,Rt.nextInstanceID+=1,this.instanceID>0&&ye()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},cl),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new nl({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Mi(n.fetch),this.lock=n.lock||Gr,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ye()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=ll:this.lock=Gr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Ui()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Vr(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Vr(this.memoryStorage)),ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,s;return(s=(t=lt[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(t){lt[this.storageKey]=Object.assign(Object.assign({},lt[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,s;return(s=(t=lt[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){lt[this.storageKey]=Object.assign(Object.assign({},lt[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${zi}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const s=Oo(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce"),ye()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:a}=await this._getSessionFromURL(s,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Co(a)){const d=(t=a.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return M(s)?{error:s}:{error:new Oi("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,r,n;try{const a=await q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=t?.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=t?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Te}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const d=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(a){if(M(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var s,r,n;try{let a;if("email"in t){const{email:u,password:h,options:m}=t;let f=null,y=null;this.flowType==="pkce"&&([f,y]=await nt(this.storage,this.storageKey)),a=await q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:u,password:h,data:(s=m?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:f,code_challenge_method:y},xform:Te})}else if("phone"in t){const{phone:u,password:h,options:m}=t;a=await q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=m?.data)!==null&&r!==void 0?r:{},channel:(n=m?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Te})}else throw new Jt("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const d=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(a){if(M(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let s;if("email"in t){const{email:a,password:o,options:l}=t;s=await q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:qr})}else if("phone"in t){const{phone:a,password:o,options:l}=t;s=await q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:qr})}else throw new Jt("You must provide either an email or phone number and a password");const{data:r,error:n}=s;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Gt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(t){var s,r,n,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;if(s==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(t){var s,r,n,a,o,l,d,c,u,h,m,f;let y,x;if("message"in t)y=t.message,x=t.signature;else{const{chain:g,wallet:j,statement:v,options:w}=t;let C;if(ye())if(typeof j=="object")C=j;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))C=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=j}const z=new URL((s=w?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in C&&C.signIn){const S=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:z.host,uri:z.href}),v?{statement:v}:null));let $;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")$=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)$=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in $&&"signature"in $&&(typeof $.signedMessage=="string"||$.signedMessage instanceof Uint8Array)&&$.signature instanceof Uint8Array)y=typeof $.signedMessage=="string"?$.signedMessage:new TextDecoder().decode($.signedMessage),x=$.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${z.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${z.href}`,`Issued At: ${(n=(r=w?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=w?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map($=>`- ${$}`)]:[]].join(`
`);const S=await C.signMessage(new TextEncoder().encode(y),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=S}}try{const{data:g,error:j}=await q(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Ro(x)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Te});if(j)throw j;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Gt}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:j})}catch(g){if(M(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(t){const s=await Ke(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(s??"").split("/");try{const{data:a,error:o}=await q(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Te});if(await Oe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Gt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:o})}catch(a){if(M(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:s,provider:r,token:n,access_token:a,nonce:o}=t,l=await q(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Te}),{data:d,error:c}=l;return c?{data:{user:null,session:null},error:c}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Gt}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:c})}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(t){var s,r,n,a,o;try{if("email"in t){const{email:l,options:d}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await nt(this.storage,this.storageKey));const{error:h}=await q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=d?.data)!==null&&s!==void 0?s:{},create_user:(r=d?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:d}=t,{data:c,error:u}=await q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(o=d?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Jt("You must provide either an email or phone number.")}catch(l){if(M(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var s,r;try{let n,a;"options"in t&&(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo,a=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await q(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Te});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,c=o.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var s,r,n;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await nt(this.storage,this.storageKey)),await q(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=t?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:el})}catch(a){if(M(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:r}=t;if(r)throw r;if(!s)throw new Me;const{error:n}=await q(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(M(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:r,type:n,options:a}=t,{error:o}=await q(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:n,options:a}=t,{data:o,error:l}=await q(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:l}}throw new Jt("You must provide either an email or phone number and a type")}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await Ke(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<js:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const o=await Ke(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=_s()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(d,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,c,u))})}return{data:{session:t},error:null}}const{session:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Fe}):await this._useSession(async s=>{var r,n,a;const{data:o,error:l}=s;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Me}:await q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Fe})})}catch(s){if(M(s))return So(s)&&(await this._removeSession(),await Oe(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async r=>{const{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new Me;const o=n.session;let l=null,d=null;this.flowType==="pkce"&&t.email!=null&&([l,d]=await nt(this.storage,this.storageKey));const{data:c,error:u}=await q(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:d}),jwt:o.access_token,xform:Fe});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(M(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Me;const s=Date.now()/1e3;let r=s,n=!0,a=null;const{payload:o}=Ns(t.access_token);if(o.exp&&(r=o.exp,n=r<=s),n){const{session:l,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:d}=await this._getUser(t.access_token);if(d)throw d;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(s){if(M(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var r;if(!t){const{data:o,error:l}=s;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!t?.refresh_token)throw new Me;const{session:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(t,s){try{if(!ye())throw new Kt("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Kt(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Dr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Kt("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Dr("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:o,expires_in:l,expires_at:d,token_type:c}=t;if(!a||!l||!o||!c)throw new Kt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;d&&(m=parseInt(d));const f=m-u;f*1e3<=dt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const y=m-h;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,u);const{data:x,error:g}=await this._getUser(a);if(g)throw g;const j={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:m,refresh_token:o,token_type:c,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:t.type},error:null}}catch(r){if(M(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await Ke(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:n,error:a}=s;if(a)return{error:a};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(_o(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Oe(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const s=Lo(),r={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async s=>{var r,n;try{const{data:{session:a},error:o}=s;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,s={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await nt(this.storage,this.storageKey,!0));try{return await q(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(a){if(M(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(s){if(M(s))return{data:null,error:s};throw s}}async linkIdentity(t){var s;try{const{data:r,error:n}=await this._useSession(async a=>{var o,l,d,c,u;const{data:h,error:m}=a;if(m)throw m;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await q(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return ye()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:t.provider,url:r?.url},error:null}}catch(r){if(M(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async s=>{var r,n;const{data:a,error:o}=s;if(o)throw o;return await q(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(M(s))return{data:null,error:s};throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await Mo(async n=>(n>0&&await Uo(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await q(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Te})),(n,a)=>{const o=200*Math.pow(2,n);return a&&ks(a)&&Date.now()+o-r<dt})}catch(r){if(this._debug(s,"error",r),M(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",r),ye()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,s;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Ke(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Ke(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await ut(this.userStorage,this.storageKey+"-user",o)),n.user=(t=o?.user)!==null&&t!==void 0?t:_s()}else if(n&&!n.user&&!n.user){const o=await Ke(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await Oe(this.storage,this.storageKey+"-user"),await ut(this.storage,this.storageKey,n)):n.user=_s()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<js;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${js}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),ks(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(n.access_token);!l&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var s,r;if(!t)throw new Me;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ps;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Me;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),M(a)){const o={session:null,error:a};return ks(a)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,s,r=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:s});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,s)}catch(d){a.push(d)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const s=Object.assign({},t),r=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&s.user&&await ut(this.userStorage,this.storageKey+"-user",{user:s.user});const n=Object.assign({},s);delete n.user;const a=Wr(n);await ut(this.storage,this.storageKey,a)}else{const n=Wr(s);await ut(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Oe(this.storage,this.storageKey),await Oe(this.storage,this.storageKey+"-code-verifier"),await Oe(this.storage,this.storageKey+"-user"),this.userStorage&&await Oe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ye()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),dt);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-t)/dt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${dt}ms, refresh threshold is ${Hs} ticks`),n<=Hs&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Fi)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ye()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,r){const n=[`provider=${encodeURIComponent(s)}`];if(r?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await nt(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);n.push(a.toString())}return r?.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var r;const{data:n,error:a}=s;return a?{data:null,error:a}:await q(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=n?.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(M(s))return{data:null,error:s};throw s}}async _enroll(t){try{return await this._useSession(async s=>{var r,n;const{data:a,error:o}=s;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:d,error:c}=await q(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((n=d?.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(s){if(M(s))return{data:null,error:s};throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:a}=s;if(a)return{data:null,error:a};const{data:o,error:l}=await q(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=n?.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(s){if(M(s))return{data:null,error:s};throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:a}=s;return a?{data:null,error:a}:await q(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=n?.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(M(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(t){const{data:s,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const r=t?.factors||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var s,r;const{data:{session:n},error:a}=t;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ns(n.access_token);let l=null;o.aal&&(l=o.aal);let d=l;((r=(s=n.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:d,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,s={keys:[]}){let r=s.keys.find(l=>l.kid===t);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(l=>l.kid===t),r&&this.jwks_cached_at+ko>n)return r;const{data:a,error:o}=await q(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,r=a.keys.find(l=>l.kid===t),!r)?null:r}async getClaims(t,s={}){try{let r=t;if(!r){const{data:f,error:y}=await this.getSession();if(y||!f.session)return{data:null,error:y};r=f.session.access_token}const{header:n,payload:a,signature:o,raw:{header:l,payload:d}}=Ns(r);s?.allowExpired||Go(a.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!c){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:a,header:n,signature:o},error:null}}const u=Jo(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,$o(`${l}.${d}`)))throw new Gs("Invalid JWT signature");return{data:{claims:a,header:n,signature:o},error:null}}catch(r){if(M(r))return{data:null,error:r};throw r}}}Rt.nextInstanceID=0;const dl=Rt;class ul extends dl{constructor(t){super(t)}}var hl=globalThis&&globalThis.__awaiter||function(i,t,s,r){function n(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function d(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):n(u.value).then(l,d)}c((r=r.apply(i,t||[])).next())})};class pl{constructor(t,s,r){var n,a,o;if(this.supabaseUrl=t,this.supabaseKey=s,!t)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const l=xo(t),d=new URL(l);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const c=`sb-${d.hostname.split(".")[0]}-auth-token`,u={db:lo,realtime:uo,auth:Object.assign(Object.assign({},co),{storageKey:c}),global:oo},h=bo(r??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=fo(s,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Pa(new URL("rest/v1",d).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new io(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new ia(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},r={}){return this.rest.rpc(t,s,r)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,s;return hl(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:n,storageKey:a,flowType:o,lock:l,debug:d},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ul({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:a,autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:n,flowType:o,lock:l,debug:d,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new qa(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r?.access_token)})}_handleTokenChanged(t,s,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ml=(i,t,s)=>new pl(i,t,s);function fl(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const t=i.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}fl()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const gl="https://ihtnsyhknvltgrksffun.supabase.co",xl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlodG5zeWhrbnZsdGdya3NmZnVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM2NzA2MzYsImV4cCI6MjA2OTI0NjYzNn0.ZmoZ5cGVHfhDwTvkmaw9LSVHm_awoyMOTyQKewr7rYo";console.log("🔧 Supabase Config Check:");console.log("URL:","✅ Present");console.log("Anon Key:","✅ Present");const J=ml(gl,xl,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},db:{schema:"public"},global:{headers:{"X-Client-Info":"fanclubz-web@1.0.0"}}}),Cs={signUp:async(i,t,s={})=>{try{const{data:r,error:n}=await J.auth.signUp({email:i,password:t,options:{data:s,emailRedirectTo:"https://app.fanclubz.app/auth/callback"}});return n&&console.error("Auth signUp error:",n),{data:r,error:n}}catch(r){return console.error("Auth signUp exception:",r),{data:null,error:{message:r.message||"An unexpected error occurred"}}}},signIn:async(i,t)=>{try{const{data:s,error:r}=await J.auth.signInWithPassword({email:i,password:t});return r&&console.error("Auth signIn error:",r),{data:s,error:r}}catch(s){return console.error("Auth signIn exception:",s),{data:null,error:{message:s.message||"An unexpected error occurred"}}}},signOut:async()=>{try{const{error:i}=await J.auth.signOut();return i&&console.error("Auth signOut error:",i),{error:i}}catch(i){return console.error("Auth signOut exception:",i),{error:{message:i.message||"An unexpected error occurred"}}}},getCurrentUser:async()=>{try{const{data:{user:i},error:t}=await J.auth.getUser();return t&&console.error("Auth getCurrentUser error:",t),{user:i,error:t}}catch(i){return console.error("Auth getCurrentUser exception:",i),{user:null,error:{message:i.message||"An unexpected error occurred"}}}},onAuthStateChange:i=>J.auth.onAuthStateChange(i)},ms=st()((i,t)=>({balances:[{currency:"USD",available:1e3,reserved:0,total:1e3}],transactions:[],isLoading:!1,error:null,get balance(){return t().balances.find(n=>n.currency==="USD")?.available||0},get totalBalance(){return t().balances.find(n=>n.currency==="USD")?.total||0},get reservedBalance(){return t().balances.find(n=>n.currency==="USD")?.reserved||0},initializeWallet:async()=>{console.log("🔄 Initializing wallet..."),i({isLoading:!0,error:null});try{const s=t();if(s.balances.length>0&&s.balances[0].total>0){console.log("✅ Wallet already initialized with demo balance"),i({isLoading:!1});return}const{data:{user:r}}=await J.auth.getUser();if(!r){console.log("⚠️ No authenticated user found, using demo balance"),i({balances:[{currency:"USD",available:1e3,reserved:0,total:1e3}],isLoading:!1});return}console.log("👤 Fetching wallet for user:",r.id);const{data:n,error:a}=await J.from("wallets").select("*").eq("user_id",r.id);if(a&&a.code!=="PGRST116"){console.error("❌ Error fetching wallet data:",a),i({balances:[{currency:"USD",available:1e3,reserved:0,total:1e3}],isLoading:!1});return}const o=n?.map(u=>({currency:u.currency,available:Number(u.available_balance)||0,reserved:Number(u.reserved_balance)||0,total:Number(u.available_balance||0)+Number(u.reserved_balance||0)}))||[{currency:"USD",available:1e3,reserved:0,total:1e3}];(o.length===0||o[0].total===0)&&(o[0]={currency:"USD",available:1e3,reserved:0,total:1e3});const{data:l,error:d}=await J.from("wallet_transactions").select("*").eq("user_id",r.id).order("created_at",{ascending:!1}).limit(50);d&&console.error("❌ Error fetching transaction history:",d);const c=(l||[]).map(u=>({id:u.id,type:u.type,amount:Number(u.amount),description:u.description,date:new Date(u.created_at),status:u.status,reference:u.reference,currency:u.currency,fee:u.fee?Number(u.fee):void 0,fromUser:u.from_user,toUser:u.to_user,predictionId:u.prediction_id}));i({balances:o,transactions:c,isLoading:!1,error:null}),console.log("✅ Wallet initialized successfully"),console.log("💰 Balance:",o[0]?.available||0),console.log("📊 Transactions:",c.length)}catch(s){console.error("❌ Error initializing wallet:",s),i({balances:[{currency:"USD",available:1e3,reserved:0,total:1e3}],isLoading:!1,error:null})}},refreshWalletData:async()=>{await t().initializeWallet()},lockFunds:async(s,r="USD")=>{try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const a=t().balances.find(d=>d.currency===r);if(!a||a.available<s)throw new Error("Insufficient funds");const o=a.available-s,l=a.reserved+s;i(d=>({balances:d.balances.map(c=>c.currency===r?{...c,available:o,reserved:l,total:o+l}:c),error:null})),console.log("✅ Funds locked successfully:",s,r);try{const{data:{user:d}}=await J.auth.getUser();d&&await J.from("wallets").upsert({user_id:d.id,currency:r,available_balance:o,reserved_balance:l,updated_at:new Date().toISOString()},{onConflict:"user_id,currency"})}catch{console.log("⚠️ Could not update database, using local state only")}}catch(n){const a=n instanceof Error?n.message:"Failed to lock funds";throw i({error:a}),n}},addFunds:async(s,r="USD",n="Bank Transfer")=>{i({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const o=t().balances.find(u=>u.currency===r),l=(o?.available||0)+s,d=l+(o?.reserved||0),c={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"deposit",amount:s,description:`${n} Deposit`,date:new Date,status:"completed",reference:`DEP_${Date.now()}`,currency:r,fee:0};return i(u=>({balances:u.balances.map(h=>h.currency===r?{...h,available:l,total:d}:h),transactions:[c,...u.transactions],isLoading:!1,error:null})),console.log("✅ Funds added successfully:",s,r),c}catch(a){const o=a instanceof Error?a.message:"Failed to add funds";throw i({isLoading:!1,error:o}),a}},withdraw:async(s,r="USD",n="Bank Account")=>{i({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const o=t().balances.find(u=>u.currency===r);if(!o||o.available<s)throw new Error("Insufficient funds");const l=o.available-s,d=l+o.reserved,c={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"withdraw",amount:s,description:`Withdrawal to ${n}`,date:new Date,status:"completed",reference:`WTH_${Date.now()}`,currency:r,fee:0};return i(u=>({balances:u.balances.map(h=>h.currency===r?{...h,available:l,total:d}:h),transactions:[c,...u.transactions],isLoading:!1,error:null})),console.log("✅ Withdrawal successful:",s,r),c}catch(a){const o=a instanceof Error?a.message:"Failed to withdraw funds";throw i({isLoading:!1,error:o}),a}},makePrediction:async(s,r,n,a="USD")=>{i({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const l=t().balances.find(m=>m.currency===a);if(!l||l.available<s)throw new Error("Insufficient funds");const d=l.available-s,c=l.reserved+s,u=d+c,h={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"prediction",amount:s,description:r,date:new Date,status:"completed",reference:`PRED_${Date.now()}`,currency:a,fee:0,predictionId:n};return i(m=>({balances:m.balances.map(f=>f.currency===a?{...f,available:d,reserved:c,total:u}:f),transactions:[h,...m.transactions],isLoading:!1,error:null})),console.log("✅ Prediction made successfully:",s,a),h}catch(o){const l=o instanceof Error?o.message:"Failed to make prediction";throw i({isLoading:!1,error:l}),o}},recordWin:async(s,r,n,a="USD")=>{i({isLoading:!0,error:null});try{const l=t().balances.find(m=>m.currency===a),d=(l?.available||0)+s,c=Math.max(0,(l?.reserved||0)-s),u=d+c,h={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"win",amount:s,description:r,date:new Date,status:"completed",reference:`WIN_${Date.now()}`,currency:a,fee:0,predictionId:n};return i(m=>({balances:m.balances.map(f=>f.currency===a?{...f,available:d,reserved:c,total:u}:f),transactions:[h,...m.transactions],isLoading:!1,error:null})),console.log("✅ Win recorded successfully:",s,a),h}catch(o){const l=o instanceof Error?o.message:"Failed to record win";throw i({isLoading:!1,error:l}),o}},recordLoss:async(s,r,n,a="USD")=>{i({isLoading:!0,error:null});try{const l=t().balances.find(h=>h.currency===a),d=Math.max(0,(l?.reserved||0)-s),c=(l?.available||0)+d,u={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"loss",amount:s,description:r,date:new Date,status:"completed",reference:`LOSS_${Date.now()}`,currency:a,fee:0,predictionId:n};return i(h=>({balances:h.balances.map(m=>m.currency===a?{...m,reserved:d,total:c}:m),transactions:[u,...h.transactions],isLoading:!1,error:null})),console.log("✅ Loss recorded successfully:",s,a),u}catch(o){const l=o instanceof Error?o.message:"Failed to record loss";throw i({isLoading:!1,error:l}),o}},transferFunds:async(s,r,n,a="USD")=>{i({isLoading:!0,error:null});try{if(isNaN(s)||s<=0)throw new Error("Please enter a valid amount");const l=t().balances.find(h=>h.currency===a);if(!l||l.available<s)throw new Error("Insufficient funds");const d=l.available-s,c=d+l.reserved,u={id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"transfer_out",amount:s,description:n||`Transfer to ${r}`,date:new Date,status:"completed",reference:`TRF_${Date.now()}`,currency:a,fee:0,toUser:r};return i(h=>({balances:h.balances.map(m=>m.currency===a?{...m,available:d,total:c}:m),transactions:[u,...h.transactions],isLoading:!1,error:null})),console.log("✅ Transfer successful:",s,a),u}catch(o){const l=o instanceof Error?o.message:"Failed to transfer funds";throw i({isLoading:!1,error:l}),o}},getBalance:(s="USD")=>t().balances.find(a=>a.currency===s)?.available||0,getTransactionHistory:s=>{let n=[...t().transactions];return s?.type&&(n=n.filter(a=>a.type===s.type)),s?.currency&&(n=n.filter(a=>a.currency===s.currency)),s?.limit&&(n=n.slice(0,s.limit)),n},clearError:()=>{i({error:null})}})),Js=new Map,Yt=i=>{const t=Js.get(i);return t?Object.fromEntries(Object.entries(t.stores).map(([s,r])=>[s,r.getState()])):{}},bl=(i,t,s)=>{if(i===void 0)return{type:"untracked",connection:t.connect(s)};const r=Js.get(s.name);if(r)return{type:"tracked",store:i,...r};const n={connection:t.connect(s),stores:{}};return Js.set(s.name,n),{type:"tracked",store:i,...n}},yl=(i,t={})=>(s,r,n)=>{const{enabled:a,anonymousActionType:o,store:l,...d}=t;let c;try{c=(a??!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!c)return i(s,r,n);const{connection:u,...h}=bl(l,c,d);let m=!0;n.setState=(x,g,j)=>{const v=s(x,g);if(!m)return v;const w=j===void 0?{type:o||"anonymous"}:typeof j=="string"?{type:j}:j;return l===void 0?(u?.send(w,r()),v):(u?.send({...w,type:`${l}/${w.type}`},{...Yt(d.name),[l]:n.getState()}),v)};const f=(...x)=>{const g=m;m=!1,s(...x),m=g},y=i(n.setState,r,n);if(h.type==="untracked"?u?.init(y):(h.stores[h.store]=n,u?.init(Object.fromEntries(Object.entries(h.stores).map(([x,g])=>[x,x===h.store?y:g.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let x=!1;const g=n.dispatch;n.dispatch=(...j)=>{g(...j)}}return u.subscribe(x=>{var g;switch(x.type){case"ACTION":if(typeof x.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Ps(x.payload,j=>{if(j.type==="__setState"){if(l===void 0){f(j.state);return}Object.keys(j.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const v=j.state[l];if(v==null)return;JSON.stringify(n.getState())!==JSON.stringify(v)&&f(v);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(j)});case"DISPATCH":switch(x.payload.type){case"RESET":return f(y),l===void 0?u?.init(n.getState()):u?.init(Yt(d.name));case"COMMIT":if(l===void 0){u?.init(n.getState());return}return u?.init(Yt(d.name));case"ROLLBACK":return Ps(x.state,j=>{if(l===void 0){f(j),u?.init(n.getState());return}f(j[l]),u?.init(Yt(d.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Ps(x.state,j=>{if(l===void 0){f(j);return}JSON.stringify(n.getState())!==JSON.stringify(j[l])&&f(j[l])});case"IMPORT_STATE":{const{nextLiftedState:j}=x.payload,v=(g=j.computedStates.slice(-1)[0])==null?void 0:g.state;if(!v)return;f(l===void 0?v:v[l]),u?.send(null,j);return}case"PAUSE_RECORDING":return m=!m}return}}),y},vl=yl,Ps=(i,t)=>{let s;try{s=JSON.parse(i)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}s!==void 0&&t(s)};function Bi(i,t){let s;try{s=i()}catch{return}return{getItem:n=>{var a;const o=d=>d===null?null:JSON.parse(d,t?.reviver),l=(a=s.getItem(n))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(n,a)=>s.setItem(n,JSON.stringify(a,t?.replacer)),removeItem:n=>s.removeItem(n)}}const zt=i=>t=>{try{const s=i(t);return s instanceof Promise?s:{then(r){return zt(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return zt(r)(s)}}}},wl=(i,t)=>(s,r,n)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:g=>g,version:0,merge:(g,j)=>({...j,...g}),...t},o=!1;const l=new Set,d=new Set;let c;try{c=a.getStorage()}catch{}if(!c)return i((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...g)},r,n);const u=zt(a.serialize),h=()=>{const g=a.partialize({...r()});let j;const v=u({state:g,version:a.version}).then(w=>c.setItem(a.name,w)).catch(w=>{j=w});if(j)throw j;return v},m=n.setState;n.setState=(g,j)=>{m(g,j),h()};const f=i((...g)=>{s(...g),h()},r,n);let y;const x=()=>{var g;if(!c)return;o=!1,l.forEach(v=>v(r()));const j=((g=a.onRehydrateStorage)==null?void 0:g.call(a,r()))||void 0;return zt(c.getItem.bind(c))(a.name).then(v=>{if(v)return a.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==a.version){if(a.migrate)return a.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var w;return y=a.merge(v,(w=r())!=null?w:f),s(y,!0),h()}).then(()=>{j?.(y,void 0),o=!0,d.forEach(v=>v(y))}).catch(v=>{j?.(void 0,v)})};return n.persist={setOptions:g=>{a={...a,...g},g.getStorage&&(c=g.getStorage())},clearStorage:()=>{c?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:g=>(l.add(g),()=>{l.delete(g)}),onFinishHydration:g=>(d.add(g),()=>{d.delete(g)})},x(),y||f},jl=(i,t)=>(s,r,n)=>{let a={storage:Bi(()=>localStorage),partialize:x=>x,version:0,merge:(x,g)=>({...g,...x}),...t},o=!1;const l=new Set,d=new Set;let c=a.storage;if(!c)return i((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...x)},r,n);const u=()=>{const x=a.partialize({...r()});return c.setItem(a.name,{state:x,version:a.version})},h=n.setState;n.setState=(x,g)=>{h(x,g),u()};const m=i((...x)=>{s(...x),u()},r,n);n.getInitialState=()=>m;let f;const y=()=>{var x,g;if(!c)return;o=!1,l.forEach(v=>{var w;return v((w=r())!=null?w:m)});const j=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(x=r())!=null?x:m))||void 0;return zt(c.getItem.bind(c))(a.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==a.version){if(a.migrate)return[!0,a.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var w;const[C,z]=v;if(f=a.merge(z,(w=r())!=null?w:m),s(f,!0),C)return u()}).then(()=>{j?.(f,void 0),f=r(),o=!0,d.forEach(v=>v(f))}).catch(v=>{j?.(void 0,v)})};return n.persist={setOptions:x=>{a={...a,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(d.add(x),()=>{d.delete(x)})},a.skipHydration||y(),f||m},kl=(i,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?wl(i,t):jl(i,t),Wi=kl,ur=st()(Wi((i,t)=>({notifications:[],unreadCount:0,toasts:[],settings:{predictionOutcomes:!0,comments:!0,marketClosing:!0,payouts:!0,pushNotifications:!0,emailNotifications:!1,frequency:"immediate"},addNotification:s=>{const r={...s,id:crypto.randomUUID(),createdAt:new Date().toISOString(),read:!1};i(n=>({notifications:[r,...n.notifications],unreadCount:n.unreadCount+1})),["prediction_outcome","payout"].includes(r.type)&&t().addToast({type:"success",title:r.title,message:r.message,duration:5e3}),t().settings.pushNotifications&&t().sendPushNotification(r)},markAsRead:s=>{i(r=>({notifications:r.notifications.map(n=>n.id===s?{...n,read:!0}:n),unreadCount:Math.max(0,r.unreadCount-1)}))},markAllAsRead:()=>{i(s=>({notifications:s.notifications.map(r=>({...r,read:!0})),unreadCount:0}))},deleteNotification:s=>{i(r=>{const n=r.notifications.find(o=>o.id===s),a=n&&!n.read;return{notifications:r.notifications.filter(o=>o.id!==s),unreadCount:a?Math.max(0,r.unreadCount-1):r.unreadCount}})},clearAllNotifications:()=>{i({notifications:[],unreadCount:0})},updateSettings:s=>{i(r=>({settings:{...r.settings,...s}}))},addToast:s=>{const r={...s,id:crypto.randomUUID()};i(n=>({toasts:[...n.toasts,r]}))},removeToast:s=>{i(r=>({toasts:r.toasts.filter(n=>n.id!==s)}))},clearToasts:()=>{i({toasts:[]})},requestPermission:async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.warn("This browser does not support notifications"),!1),subscribeToPush:async()=>{if(!await t().requestPermission())throw new Error("Notification permission denied");console.log("Push notifications subscribed"),i(r=>({settings:{...r.settings,pushNotifications:!0}}))},unsubscribeFromPush:async()=>{console.log("Push notifications unsubscribed"),i(s=>({settings:{...s.settings,pushNotifications:!1}}))},sendPushNotification:s=>{if(!("Notification"in window)||Notification.permission!=="granted")return;const r=new Notification(s.title,{body:s.message,icon:"/icon-192x192.png",badge:"/icon-badge.png",tag:s.id,renotify:!1});r.onclick=()=>{window.focus(),r.close(),s.data?.predictionId&&(window.location.href=`/predictions/${s.data.predictionId}`)},setTimeout(()=>{r.close()},5e3)}}),{name:"fanclubz-notifications",partialize:i=>({notifications:i.notifications,settings:i.settings})})),ct=(i,t)=>{ur.getState().addToast({type:"success",title:t||"Success",message:i,duration:3e3})},St=(i,t)=>{ur.getState().addToast({type:"error",title:t||"Error",message:i,duration:5e3})},ht=i=>{if(!i)return null;const t=i.user_metadata||{},s=i.app_metadata||{};let r="",n="",a="";if(t.full_name){const o=t.full_name.split(" ");r=o[0]||"",n=o.slice(1).join(" ")||""}else r=t.firstName||t.first_name||t.given_name||"User",n=t.lastName||t.last_name||t.family_name||"";return t.avatar_url?a=t.avatar_url:t.picture?a=t.picture:t.photo&&(a=t.photo),{id:i.id,email:i.email||"",firstName:r,lastName:n,phone:i.phone,avatar:a,provider:s.provider||"email",bio:t.bio,totalEarnings:t.totalEarnings||0,totalInvested:t.totalInvested||0,winRate:t.winRate||0,activePredictions:t.activePredictions||0,totalPredictions:t.totalPredictions||0,rank:t.rank||0,level:t.level||"New Predictor",createdAt:i.created_at||new Date().toISOString()}};let Jr=!1,Es=!1,Kr="",Yr=0;const le=st()(Wi((i,t)=>({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!1,lastAuthCheck:0,initializeAuth:async()=>{const s=t(),r=Date.now();if(Es){console.log("🔄 Auth initialization already in progress, waiting...");return}if(s.initialized&&r-s.lastAuthCheck<3e4){console.log("🔄 Auth recently checked, skipping initialization");return}if(s.isAuthenticated&&s.user&&s.token&&r-s.lastAuthCheck<3e5){s.initialized||console.log("✅ Using cached auth state for:",s.user.firstName),i({loading:!1,initialized:!0,lastAuthCheck:r});return}if(s.loading){console.log("🔄 Auth check already in progress...");return}Es=!0,i({loading:!0,lastAuthCheck:r});try{console.log("🔐 Initializing authentication...");const{data:{session:n},error:a}=await J.auth.getSession();if(a){console.log("⚠️ Session check error:",a.message),i({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:r});return}if(n?.user){const o=ht(n.user);s.initialized||console.log("✅ Found active session for:",o?.firstName),i({isAuthenticated:!0,user:o,token:n.access_token,loading:!1,initialized:!0,lastAuthCheck:r})}else s.initialized||console.log("ℹ️ No active session found"),i({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:r})}catch(n){console.error("❌ Auth initialization error:",n.message),i({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:r})}finally{Es=!1}},login:async(s,r)=>{i({loading:!0});try{console.log("🔑 Logging in user:",s);const{data:n,error:a}=await Cs.signIn(s,r);if(a){console.error("❌ Login error:",a.message);let o="Login failed. Please check your credentials.";throw a.message.includes("Invalid login credentials")?o="Invalid email or password. Please try again.":a.message.includes("Email not confirmed")&&(o="Please check your email and click the confirmation link."),i({loading:!1}),St(o),new Error(o)}if(n.user&&n.session){const o=ht(n.user);console.log("✅ Login successful for:",o?.firstName),i({isAuthenticated:!0,user:o,token:n.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),ct(`Welcome back, ${o?.firstName}!`)}}catch(n){throw console.error("❌ Login exception:",n.message),i({loading:!1}),n}},register:async(s,r,n,a)=>{i({loading:!0});try{if(console.log("📝 Registering user:",s),r.length<6)throw new Error("Password must be at least 6 characters long");const o={data:{firstName:n,lastName:a,first_name:n,last_name:a,full_name:`${n} ${a}`}},{data:l,error:d}=await Cs.signUp(s,r,o);if(d){console.error("❌ Registration error:",d.message);let c="Registration failed. Please try again.";throw d.message.includes("User already registered")?c="An account with this email already exists. Please sign in instead.":d.message.includes("Password should be at least")&&(c="Password must be at least 6 characters long."),i({loading:!1}),St(c),new Error(c)}if(l.user){const c=ht(l.user);console.log("✅ Registration successful for:",c?.firstName),l.session?(i({isAuthenticated:!0,user:c,token:l.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),ct(`Welcome to Fan Club Z, ${c?.firstName}!`)):(i({isAuthenticated:!0,user:c,token:null,loading:!1,initialized:!0,lastAuthCheck:Date.now()}),ct(`Welcome to Fan Club Z, ${c?.firstName}! Please check your email to verify your account.`))}}catch(o){throw console.error("❌ Registration exception:",o.message),i({loading:!1}),o}},loginWithOAuth:async s=>{i({loading:!0});try{console.log(`🔑 Starting ${s} OAuth login...`);const r=window.location.origin,n=`${r}/auth/callback`;console.log("🔗 Current origin:",r),console.log("🔗 OAuth redirect URL:",n);const{data:a,error:o}=await J.auth.signInWithOAuth({provider:s,options:{redirectTo:n,queryParams:{access_type:"offline",prompt:"consent"}}});if(o)throw console.error(`❌ ${s} OAuth error:`,o.message),i({loading:!1}),St(`${s} sign-in failed. Please try again.`),new Error(o.message);console.log(`✅ ${s} OAuth initiated, redirecting...`)}catch(r){throw console.error(`❌ ${s} OAuth exception:`,r.message),i({loading:!1}),r}},handleOAuthCallback:async()=>{try{console.log("🔄 Handling OAuth callback...");const{data:s,error:r}=await J.auth.getSession();if(r)throw console.error("❌ OAuth callback error:",r.message),St("Authentication failed. Please try again."),new Error(r.message);if(s.session?.user){const n=ht(s.session.user);console.log("✅ OAuth authentication successful for:",n?.firstName),i({isAuthenticated:!0,user:n,token:s.session.access_token,loading:!1,initialized:!0,lastAuthCheck:Date.now()});const a=n?.provider?.charAt(0).toUpperCase()+n?.provider?.slice(1);return ct(`Welcome ${n?.firstName}! Signed in with ${a}.`),n}else throw new Error("No user session found after OAuth callback")}catch(s){throw console.error("❌ OAuth callback exception:",s.message),i({loading:!1}),s}},logout:async()=>{i({loading:!0});try{console.log("🚪 Logging out...");const{error:s}=await Cs.signOut();s&&console.error("❌ Logout error:",s.message),i({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:0}),ct("Signed out successfully")}catch(s){console.error("❌ Logout exception:",s.message),i({isAuthenticated:!1,user:null,token:null,loading:!1,initialized:!0,lastAuthCheck:0})}},updateProfile:async s=>{i({loading:!0});try{const r=t().user;if(!r)throw new Error("No user logged in");console.log("📝 Updating profile...");const{data:n,error:a}=await J.auth.updateUser({data:{firstName:s.firstName||r.firstName,lastName:s.lastName||r.lastName,bio:s.bio!==void 0?s.bio:r.bio}});if(a)throw new Error(a.message);if(n.user){const o=ht(n.user);i({user:o,loading:!1,lastAuthCheck:Date.now()}),ct("Profile updated successfully!")}}catch(r){throw console.error("❌ Profile update error:",r.message),i({loading:!1}),St(r.message||"Failed to update profile"),r}}}),{name:"fanclubz-auth-storage",storage:Bi(()=>localStorage),partialize:i=>({isAuthenticated:i.isAuthenticated,user:i.user,token:i.token,initialized:i.initialized,lastAuthCheck:i.lastAuthCheck}),version:5}));typeof window<"u"&&!Jr&&(Jr=!0,console.log("🔧 Setting up auth state listener..."),J.auth.onAuthStateChange((i,t)=>{const s=Date.now();if(!(Kr===i&&s-Yr<1e3)){if(Kr=i,Yr=s,console.log("🔄 Auth state change:",i),i==="SIGNED_OUT")console.log("🔓 User signed out"),le.setState({isAuthenticated:!1,user:null,token:null,lastAuthCheck:0});else if(i==="TOKEN_REFRESHED"&&t?.user){console.log("🔄 Token refreshed");const r=ht(t.user);le.setState({user:r,token:t.access_token,lastAuthCheck:s})}}}));const hr=st((i,t)=>({likedPredictions:new Set,likeCounts:{},loading:!1,error:null,initializeLikes:async()=>{try{const{data:{user:s}}=await J.auth.getUser();if(!s){console.log("❌ No authenticated user, skipping like initialization");return}console.log("🔄 Initializing like store for user:",s.id);const{data:r,error:n}=await J.from("prediction_likes").select("prediction_id").eq("user_id",s.id);n&&console.error("❌ Error fetching user likes:",n);const{data:a,error:o}=await J.from("predictions").select("id, likes_count");o&&console.error("❌ Error fetching like counts:",o);const l=new Set(r?.map(c=>c.prediction_id)||[]),d=Object.fromEntries(a?.map(c=>[c.id,c.likes_count||0])||[]);i({likedPredictions:l,likeCounts:d,error:null}),console.log("✅ Like store initialized successfully:",{likedCount:l.size,totalPredictions:Object.keys(d).length,userLikes:Array.from(l)})}catch(s){console.error("❌ Error initializing likes:",s),i({error:"Failed to load likes"})}},refreshLikeCounts:async()=>{try{const{data:s,error:r}=await J.from("predictions").select("id, likes_count");if(r){console.error("Error refreshing like counts:",r);return}const n=Object.fromEntries(s?.map(a=>[a.id,a.likes_count||0])||[]);i({likeCounts:n}),console.log("✅ Like counts refreshed:",Object.keys(n).length,"predictions")}catch(s){console.error("Error refreshing like counts:",s)}},toggleLike:async s=>{const{likedPredictions:r,likeCounts:n}=t(),a=r.has(s),o=n[s]||0,l=new Set(r),d={...n};a?(l.delete(s),d[s]=Math.max(0,o-1)):(l.add(s),d[s]=o+1),i({likedPredictions:l,likeCounts:d,loading:!0});try{const{data:{user:c}}=await J.auth.getUser();if(!c)throw new Error("User not authenticated");if(a){const{error:u}=await J.from("prediction_likes").delete().eq("prediction_id",s).eq("user_id",c.id);if(u)throw u;const{error:h}=await J.from("predictions").update({likes_count:Math.max(0,o-1),updated_at:new Date().toISOString()}).eq("id",s);h&&console.error("Error updating prediction likes count:",h)}else{const{error:u}=await J.from("prediction_likes").insert({prediction_id:s,user_id:c.id,created_at:new Date().toISOString()});if(u&&!u.message.includes("duplicate"))throw u;const{error:h}=await J.from("predictions").update({likes_count:o+1,updated_at:new Date().toISOString()}).eq("id",s);h&&console.error("Error updating prediction likes count:",h)}await t().refreshLikeCounts(),i({loading:!1,error:null}),console.log("✅ Like toggled successfully:",{predictionId:s,wasLiked:!a})}catch(c){throw console.error("Error toggling like:",c),i({likedPredictions:r,likeCounts:n,loading:!1,error:"Failed to update like"}),c}},checkIfLiked:s=>t().likedPredictions.has(s),getLikeCount:s=>{const n=t().likeCounts[s];return n!==void 0?n:0},clearError:()=>{i({error:null})},debugLikeState:s=>{const r=t();console.log(`🔍 Debug like state for prediction ${s}:`,{isLiked:r.likedPredictions.has(s),likeCount:r.likeCounts[s]||0,allLikedPredictions:Array.from(r.likedPredictions),allLikeCounts:r.likeCounts,loading:r.loading,error:r.error})}})),Ts="https://fan-club-z.onrender.com",pr=st()(vl((i,t)=>({commentsByPrediction:{},commentCounts:{},loading:{},errors:{},submitting:{},initialized:!1,initialize:()=>{t().initialized||(console.log("🔧 Initializing unified comment store"),i({initialized:!0}))},initializeCommentCounts:s=>{console.log("🔧 Initializing comment counts:",s),i(r=>({commentCounts:{...r.commentCounts,...s}}))},updateCommentCount:(s,r)=>{if(!s?.trim()){console.warn("⚠️ Cannot update comment count: invalid predictionId");return}console.log(`📊 Updating comment count for ${s}: ${r}`),i(n=>({commentCounts:{...n.commentCounts,[s]:r}}))},getCommentCount:s=>{if(!s?.trim())return 0;const r=t(),n=r.commentsByPrediction[s];return n&&Array.isArray(n)?n.length:r.commentCounts[s]!==void 0?r.commentCounts[s]:0},getComments:s=>s?.trim()?t().commentsByPrediction[s]||[]:[],clearError:s=>{s?.trim()&&i(r=>({errors:{...r.errors,[s]:null}}))},fetchComments:async s=>{if(!s?.trim()){console.warn("⚠️ Cannot fetch comments: invalid predictionId");return}console.log(`🔍 Fetching comments for prediction ${s}`),i(r=>({loading:{...r.loading,[s]:!0},errors:{...r.errors,[s]:null}}));try{const r=await fetch(`${Ts}/api/v2/social/predictions/${s}/comments`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`API responded with ${r.status}`);const a=(await r.json()).comments||[];console.log(`✅ Loaded ${a.length} comments for prediction ${s}`),i(o=>({commentsByPrediction:{...o.commentsByPrediction,[s]:a},commentCounts:{...o.commentCounts,[s]:a.length},loading:{...o.loading,[s]:!1}}))}catch(r){console.error("❌ Failed to fetch comments:",r),i(n=>({commentsByPrediction:{...n.commentsByPrediction,[s]:[]},commentCounts:{...n.commentCounts,[s]:0},loading:{...n.loading,[s]:!1},errors:{...n.errors,[s]:"Failed to load comments. Please try again later."}}))}},addComment:async(s,r,n)=>{if(!s?.trim())throw new Error("Cannot add comment: invalid predictionId");if(!r?.trim())throw new Error("Comment content cannot be empty");console.log(`💬 Adding comment to prediction ${s}`),i(a=>({submitting:{...a.submitting,[s]:!0},errors:{...a.errors,[s]:null}}));try{const a=await fetch(`${Ts}/api/v2/social/predictions/${s}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:r.trim(),parent_comment_id:n||null})});if(!a.ok)throw new Error(`API responded with ${a.status}`);const o=await a.json();i(l=>{const d=l.commentsByPrediction[s]||[];let c,u;return n?(c=d.map(h=>h.id===n?{...h,replies:[o,...h.replies||[]],replies_count:(h.replies_count||0)+1}:h),u=l.commentCounts[s]||0):(c=[o,...d],u=(l.commentCounts[s]||0)+1),{commentsByPrediction:{...l.commentsByPrediction,[s]:c},commentCounts:{...l.commentCounts,[s]:u},submitting:{...l.submitting,[s]:!1}}}),console.log(`✅ Added comment to prediction ${s}`)}catch(a){throw console.error("❌ Failed to add comment:",a),i(o=>({submitting:{...o.submitting,[s]:!1},errors:{...o.errors,[s]:"Failed to post comment. Please try again."}})),a}},toggleCommentLike:async(s,r)=>{if(!s?.trim()||!r?.trim()){console.warn("⚠️ Cannot toggle comment like: invalid parameters");return}try{i(a=>{const o=a.commentsByPrediction[r]||[],l=d=>d.id===s?{...d,is_liked:!d.is_liked,likes_count:d.is_liked?Math.max(0,d.likes_count-1):d.likes_count+1}:d.replies?{...d,replies:d.replies.map(l)}:d;return{commentsByPrediction:{...a.commentsByPrediction,[r]:o.map(l)}}}),(await fetch(`${Ts}/api/v2/social/comments/${s}/like`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?console.log("✅ Like synced with server"):console.warn("❌ Failed to sync like with server, but UI updated optimistically")}catch(n){console.error("❌ Failed to toggle like:",n)}}}),{name:"unified-comment-store",partialize:i=>({commentCounts:i.commentCounts,initialized:i.initialized})})),mr=i=>{const t=pr(),s=i?.trim()||"";return s?{comments:t.getComments(s),commentCount:t.getCommentCount(s),isLoading:t.loading[s]||!1,error:t.errors[s]||null,isSubmitting:t.submitting[s]||!1,fetchComments:()=>t.fetchComments(s),addComment:(r,n)=>t.addComment(s,r,n),toggleCommentLike:r=>t.toggleCommentLike(r,s),clearError:()=>t.clearError(s)}:{comments:[],commentCount:0,isLoading:!1,error:null,isSubmitting:!1,fetchComments:()=>Promise.resolve(),addComment:()=>Promise.resolve(),toggleCommentLike:()=>Promise.resolve(),clearError:()=>{}}};let Nl={data:""},_l=i=>typeof window=="object"?((i?i.querySelector("#_goober"):window._goober)||Object.assign((i||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:i||Nl,Sl=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Cl=/\/\*[^]*?\*\/|  +/g,Zr=/\n+/g,Be=(i,t)=>{let s="",r="",n="";for(let a in i){let o=i[a];a[0]=="@"?a[1]=="i"?s=a+" "+o+";":r+=a[1]=="f"?Be(o,a):a+"{"+Be(o,a[1]=="k"?"":t)+"}":typeof o=="object"?r+=Be(o,t?t.replace(/([^,])+/g,l=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,l):l?l+" "+d:d)):a):o!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Be.p?Be.p(a,o):a+":"+o+";")}return s+(t&&n?t+"{"+n+"}":n)+r},Pe={},Hi=i=>{if(typeof i=="object"){let t="";for(let s in i)t+=s+Hi(i[s]);return t}return i},Pl=(i,t,s,r,n)=>{let a=Hi(i),o=Pe[a]||(Pe[a]=(d=>{let c=0,u=11;for(;c<d.length;)u=101*u+d.charCodeAt(c++)>>>0;return"go"+u})(a));if(!Pe[o]){let d=a!==i?i:(c=>{let u,h,m=[{}];for(;u=Sl.exec(c.replace(Cl,""));)u[4]?m.shift():u[3]?(h=u[3].replace(Zr," ").trim(),m.unshift(m[0][h]=m[0][h]||{})):m[0][u[1]]=u[2].replace(Zr," ").trim();return m[0]})(i);Pe[o]=Be(n?{["@keyframes "+o]:d}:d,s?"":"."+o)}let l=s&&Pe.g?Pe.g:null;return s&&(Pe.g=Pe[o]),((d,c,u,h)=>{h?c.data=c.data.replace(h,d):c.data.indexOf(d)===-1&&(c.data=u?d+c.data:c.data+d)})(Pe[o],t,r,l),o},El=(i,t,s)=>i.reduce((r,n,a)=>{let o=t[a];if(o&&o.call){let l=o(s),d=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=d?"."+d:l&&typeof l=="object"?l.props?"":Be(l,""):l===!1?"":l}return r+n+(o??"")},"");function fs(i){let t=this||{},s=i.call?i(t.p):i;return Pl(s.unshift?s.raw?El(s,[].slice.call(arguments,1),t.p):s.reduce((r,n)=>Object.assign(r,n&&n.call?n(t.p):n),{}):s,_l(t.target),t.g,t.o,t.k)}let qi,Ks,Ys;fs.bind({g:1});let Ie=fs.bind({k:1});function Tl(i,t,s,r){Be.p=t,qi=i,Ks=s,Ys=r}function Ve(i,t){let s=this||{};return function(){let r=arguments;function n(a,o){let l=Object.assign({},a),d=l.className||n.className;s.p=Object.assign({theme:Ks&&Ks()},l),s.o=/ *go\d+/.test(d),l.className=fs.apply(s,r)+(d?" "+d:""),t&&(l.ref=o);let c=i;return i[0]&&(c=l.as||i,delete l.as),Ys&&c[0]&&Ys(l),qi(c,l)}return t?t(n):n}}var Al=i=>typeof i=="function",ss=(i,t)=>Al(i)?i(t):i,Il=(()=>{let i=0;return()=>(++i).toString()})(),Vi=(()=>{let i;return()=>{if(i===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");i=!t||t.matches}return i}})(),$l=20,fr="default",Gi=(i,t)=>{let{toastLimit:s}=i.settings;switch(t.type){case 0:return{...i,toasts:[t.toast,...i.toasts].slice(0,s)};case 1:return{...i,toasts:i.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:r}=t;return Gi(i,{type:i.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...i,toasts:i.toasts.map(o=>o.id===n||n===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...i,toasts:[]}:{...i,toasts:i.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...i,pausedAt:t.time};case 6:let a=t.time-(i.pausedAt||0);return{...i,pausedAt:void 0,toasts:i.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},Qt=[],Ji={toasts:[],pausedAt:void 0,settings:{toastLimit:$l}},Se={},Ki=(i,t=fr)=>{Se[t]=Gi(Se[t]||Ji,i),Qt.forEach(([s,r])=>{s===t&&r(Se[t])})},Yi=i=>Object.keys(Se).forEach(t=>Ki(i,t)),Rl=i=>Object.keys(Se).find(t=>Se[t].toasts.some(s=>s.id===i)),gs=(i=fr)=>t=>{Ki(t,i)},zl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ll=(i={},t=fr)=>{let[s,r]=p.useState(Se[t]||Ji),n=p.useRef(Se[t]);p.useEffect(()=>(n.current!==Se[t]&&r(Se[t]),Qt.push([t,r]),()=>{let o=Qt.findIndex(([l])=>l===t);o>-1&&Qt.splice(o,1)}),[t]);let a=s.toasts.map(o=>{var l,d,c;return{...i,...i[o.type],...o,removeDelay:o.removeDelay||((l=i[o.type])==null?void 0:l.removeDelay)||i?.removeDelay,duration:o.duration||((d=i[o.type])==null?void 0:d.duration)||i?.duration||zl[o.type],style:{...i.style,...(c=i[o.type])==null?void 0:c.style,...o.style}}});return{...s,toasts:a}},Ol=(i,t="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:i,pauseDuration:0,...s,id:s?.id||Il()}),Bt=i=>(t,s)=>{let r=Ol(t,i,s);return gs(r.toasterId||Rl(r.id))({type:2,toast:r}),r.id},ee=(i,t)=>Bt("blank")(i,t);ee.error=Bt("error");ee.success=Bt("success");ee.loading=Bt("loading");ee.custom=Bt("custom");ee.dismiss=(i,t)=>{let s={type:3,toastId:i};t?gs(t)(s):Yi(s)};ee.dismissAll=i=>ee.dismiss(void 0,i);ee.remove=(i,t)=>{let s={type:4,toastId:i};t?gs(t)(s):Yi(s)};ee.removeAll=i=>ee.remove(void 0,i);ee.promise=(i,t,s)=>{let r=ee.loading(t.loading,{...s,...s?.loading});return typeof i=="function"&&(i=i()),i.then(n=>{let a=t.success?ss(t.success,n):void 0;return a?ee.success(a,{id:r,...s,...s?.success}):ee.dismiss(r),n}).catch(n=>{let a=t.error?ss(t.error,n):void 0;a?ee.error(a,{id:r,...s,...s?.error}):ee.dismiss(r)}),i};var Dl=1e3,Ul=(i,t="default")=>{let{toasts:s,pausedAt:r}=Ll(i,t),n=p.useRef(new Map).current,a=p.useCallback((h,m=Dl)=>{if(n.has(h))return;let f=setTimeout(()=>{n.delete(h),o({type:4,toastId:h})},m);n.set(h,f)},[]);p.useEffect(()=>{if(r)return;let h=Date.now(),m=s.map(f=>{if(f.duration===1/0)return;let y=(f.duration||0)+f.pauseDuration-(h-f.createdAt);if(y<0){f.visible&&ee.dismiss(f.id);return}return setTimeout(()=>ee.dismiss(f.id,t),y)});return()=>{m.forEach(f=>f&&clearTimeout(f))}},[s,r,t]);let o=p.useCallback(gs(t),[t]),l=p.useCallback(()=>{o({type:5,time:Date.now()})},[o]),d=p.useCallback((h,m)=>{o({type:1,toast:{id:h,height:m}})},[o]),c=p.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=p.useCallback((h,m)=>{let{reverseOrder:f=!1,gutter:y=8,defaultPosition:x}=m||{},g=s.filter(w=>(w.position||x)===(h.position||x)&&w.height),j=g.findIndex(w=>w.id===h.id),v=g.filter((w,C)=>C<j&&w.visible).length;return g.filter(w=>w.visible).slice(...f?[v+1]:[0,v]).reduce((w,C)=>w+(C.height||0)+y,0)},[s]);return p.useEffect(()=>{s.forEach(h=>{if(h.dismissed)a(h.id,h.removeDelay);else{let m=n.get(h.id);m&&(clearTimeout(m),n.delete(h.id))}})},[s,a]),{toasts:s,handlers:{updateHeight:d,startPause:l,endPause:c,calculateOffset:u}}},Ml=Ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Fl=Ie`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Bl=Ie`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Wl=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ml} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Fl} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${i=>i.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Bl} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Hl=Ie`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ql=Ve("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${i=>i.secondary||"#e0e0e0"};
  border-right-color: ${i=>i.primary||"#616161"};
  animation: ${Hl} 1s linear infinite;
`,Vl=Ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Gl=Ie`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Jl=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Vl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Gl} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${i=>i.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Kl=Ve("div")`
  position: absolute;
`,Yl=Ve("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Zl=Ie`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Xl=Ve("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Zl} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Ql=({toast:i})=>{let{icon:t,type:s,iconTheme:r}=i;return t!==void 0?typeof t=="string"?p.createElement(Xl,null,t):t:s==="blank"?null:p.createElement(Yl,null,p.createElement(ql,{...r}),s!=="loading"&&p.createElement(Kl,null,s==="error"?p.createElement(Wl,{...r}):p.createElement(Jl,{...r})))},ec=i=>`
0% {transform: translate3d(0,${i*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,tc=i=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${i*-150}%,-1px) scale(.6); opacity:0;}
`,sc="0%{opacity:0;} 100%{opacity:1;}",rc="0%{opacity:1;} 100%{opacity:0;}",ic=Ve("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,nc=Ve("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ac=(i,t)=>{let s=i.includes("top")?1:-1,[r,n]=Vi()?[sc,rc]:[ec(s),tc(s)];return{animation:t?`${Ie(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ie(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},oc=p.memo(({toast:i,position:t,style:s,children:r})=>{let n=i.height?ac(i.position||t||"top-center",i.visible):{opacity:0},a=p.createElement(Ql,{toast:i}),o=p.createElement(nc,{...i.ariaProps},ss(i.message,i));return p.createElement(ic,{className:i.className,style:{...n,...s,...i.style}},typeof r=="function"?r({icon:a,message:o}):p.createElement(p.Fragment,null,a,o))});Tl(p.createElement);var lc=({id:i,className:t,style:s,onHeightUpdate:r,children:n})=>{let a=p.useCallback(o=>{if(o){let l=()=>{let d=o.getBoundingClientRect().height;r(i,d)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[i,r]);return p.createElement("div",{ref:a,className:t,style:s},n)},cc=(i,t)=>{let s=i.includes("top"),r=s?{top:0}:{bottom:0},n=i.includes("center")?{justifyContent:"center"}:i.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Vi()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(s?1:-1)}px)`,...r,...n}},dc=fs`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Zt=16,uc=({reverseOrder:i,position:t="top-center",toastOptions:s,gutter:r,children:n,toasterId:a,containerStyle:o,containerClassName:l})=>{let{toasts:d,handlers:c}=Ul(s,a);return p.createElement("div",{"data-rht-toaster":a||"",style:{position:"fixed",zIndex:9999,top:Zt,left:Zt,right:Zt,bottom:Zt,pointerEvents:"none",...o},className:l,onMouseEnter:c.startPause,onMouseLeave:c.endPause},d.map(u=>{let h=u.position||t,m=c.calculateOffset(u,{reverseOrder:i,gutter:r,defaultPosition:t}),f=cc(h,m);return p.createElement(lc,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?dc:"",style:f},u.type==="custom"?ss(u.message,u):n?n(u):p.createElement(oc,{toast:u,position:h}))}))},G=ee;let Xt=null;const We=(i={})=>{const{behavior:t="smooth",delay:s=0}=i;Xt&&window.clearTimeout(Xt),Xt=window.setTimeout(()=>{try{requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:t}),document.documentElement.scrollTop>0&&(document.documentElement.scrollTop=0),document.body.scrollTop>0&&(document.body.scrollTop=0)})}catch{window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0}Xt=null},s)},hc=({type:i,message:t,duration:s=5e3,onClose:r,show:n=!0})=>{const[a,o]=p.useState(n);if(p.useEffect(()=>{o(n)},[n]),p.useEffect(()=>{if(a&&s>0){const c=setTimeout(()=>{o(!1),r?.()},s);return()=>clearTimeout(c)}},[a,s,r]),!a)return null;const l=()=>{switch(i){case"success":return e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},d=()=>{const c={position:"fixed",top:"20px",right:"20px",zIndex:9999,padding:"16px 20px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.15)",display:"flex",alignItems:"center",gap:"12px",maxWidth:"400px",minWidth:"300px",animation:"slideIn 0.3s ease-out",border:"1px solid",backdropFilter:"blur(10px)",fontSize:"14px",fontWeight:"600",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'};switch(i){case"success":return{...c,backgroundColor:"rgba(16, 185, 129, 0.95)",color:"white",borderColor:"rgba(16, 185, 129, 0.3)"};case"error":return{...c,backgroundColor:"rgba(239, 68, 68, 0.95)",color:"white",borderColor:"rgba(239, 68, 68, 0.3)"};case"warning":return{...c,backgroundColor:"rgba(245, 158, 11, 0.95)",color:"white",borderColor:"rgba(245, 158, 11, 0.3)"};case"info":return{...c,backgroundColor:"rgba(59, 130, 246, 0.95)",color:"white",borderColor:"rgba(59, 130, 246, 0.3)"}}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
          
          @keyframes slideOut {
            from {
              transform: translateX(0);
              opacity: 1;
            }
            to {
              transform: translateX(100%);
              opacity: 0;
            }
          }
        `}),e.jsxs("div",{style:d(),children:[e.jsx("div",{style:{flexShrink:0},children:l()}),e.jsx("div",{style:{flex:1},children:t})]})]})},Zi=()=>{const{notifications:i,removeNotification:t}=ur();return e.jsx(e.Fragment,{children:i.map((s,r)=>e.jsx(hc,{type:s.type,message:s.message,duration:s.duration,onClose:()=>t(s.id),show:!0},s.id))})};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),D=(i,t)=>{const s=p.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:d,...c},u)=>p.createElement("svg",{ref:u,...pc,width:n,height:n,stroke:r,strokeWidth:o?Number(a)*24/Number(n):a,className:["lucide",`lucide-${mc(i)}`,l].join(" "),...c},[...t.map(([h,m])=>p.createElement(h,m)),...Array.isArray(d)?d:[d]]));return s.displayName=`${i}`,s};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=D("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=D("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=D("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=D("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=D("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=D("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=D("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=D("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=D("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=D("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=D("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=D("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=D("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=D("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=D("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=D("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=D("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=D("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=D("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=D("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=D("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=D("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=D("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=D("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=D("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=D("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=D("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=D("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=D("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=D("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=D("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=D("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ec=D("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=D("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=D("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=D("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=D("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=D("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=D("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tc=D("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=D("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=D("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=D("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=D("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=D("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=D("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=D("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=D("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=D("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=D("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=D("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Xe=class Xe{constructor(){se(this,"deferredPrompt",null);se(this,"isInstalled",!1);this.init()}static getInstance(){return Xe.instance||(Xe.instance=new Xe),Xe.instance}init(){this.registerServiceWorker(),this.checkInstallStatus(),this.setupInstallPrompt()}async registerServiceWorker(){if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered successfully:",t),t.addEventListener("updatefound",()=>{const s=t.installing;s&&s.addEventListener("statechange",()=>{s.state==="installed"&&navigator.serviceWorker.controller&&this.showUpdateAvailable()})})}catch(t){console.error("Service Worker registration failed:",t)}}checkInstallStatus(){this.isInstalled=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),this.deferredPrompt=t,window.dispatchEvent(new CustomEvent("pwa-installable",{detail:{canInstall:!0}}))}),window.addEventListener("appinstalled",()=>{this.isInstalled=!0,this.deferredPrompt=null,this.trackInstallation(),window.dispatchEvent(new CustomEvent("pwa-installed"))})}async promptInstall(){if(!this.deferredPrompt)return!1;try{await this.deferredPrompt.prompt();const t=await this.deferredPrompt.userChoice;return this.deferredPrompt=null,t.outcome==="accepted"}catch(t){return console.error("Install prompt failed:",t),!1}}canInstall(){return!!this.deferredPrompt&&!this.isInstalled}isAppInstalled(){return this.isInstalled}isIOSDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}isAndroidDevice(){return/Android/.test(navigator.userAgent)}showUpdateAvailable(){const t=new CustomEvent("pwa-update-available",{detail:{message:"A new version of Fan Club Z is available. Refresh to update.",action:()=>window.location.reload()}});window.dispatchEvent(t)}trackInstallation(){typeof gtag<"u"&&gtag("event","pwa_install",{event_category:"engagement",event_label:"app_install"})}async requestNotificationPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?!1:await Notification.requestPermission()==="granted":!1}async subscribeToPushNotifications(){try{const t=await navigator.serviceWorker.ready,s=await t.pushManager.getSubscription();if(s)return s;const r=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array({}.VITE_VAPID_PUBLIC_KEY||"")});return await this.sendSubscriptionToServer(r),r}catch(t){return console.error("Push subscription failed:",t),null}}urlBase64ToUint8Array(t){const s="=".repeat((4-t.length%4)%4),r=(t+s).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(r),a=new Uint8Array(n.length);for(let o=0;o<n.length;++o)a[o]=n.charCodeAt(o);return a}async sendSubscriptionToServer(t){try{await fetch("/api/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(s){console.error("Failed to send subscription to server:",s)}}};se(Xe,"instance");let Xs=Xe;const fe=Xs.getInstance(),zc=()=>{const[i,t]=p.useState(!1),[s,r]=p.useState(!1);p.useEffect(()=>{const l=()=>{if(fe.isAppInstalled()){t(!1);return}const u=fe.isIOSDevice(),h=localStorage.getItem(u?"ios-install-dismissed":"pwa-banner-dismissed"),m=h?parseInt(h):0,f=(Date.now()-m)/(24*60*60*1e3),x=!h||f>(u?3:1),g=sessionStorage.getItem("pwa-banner-session-dismissed");x&&!g&&(u?setTimeout(()=>t(!0),5e3):r(fe.canInstall()))},d=()=>{r(!0),localStorage.getItem("pwa-banner-dismissed")||t(!0)},c=()=>{t(!1),r(!1)};return window.addEventListener("pwa-installable",d),window.addEventListener("pwa-installed",c),l(),()=>{window.removeEventListener("pwa-installable",d),window.removeEventListener("pwa-installed",c)}},[]);const n=async()=>{fe.isIOSDevice()?(window.dispatchEvent(new CustomEvent("show-ios-install")),t(!1)):(await fe.promptInstall()||localStorage.setItem("pwa-banner-dismissed",Date.now().toString()),t(!1))},a=()=>{t(!1);const l=fe.isIOSDevice()?"ios-install-dismissed":"pwa-banner-dismissed";localStorage.setItem(l,Date.now().toString()),sessionStorage.setItem("pwa-banner-session-dismissed","true")};if(!i)return null;const o=fe.isIOSDevice();return e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg animate-in slide-in-from-top duration-300",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-white/20 p-2 rounded-lg backdrop-blur-sm",children:e.jsx(nn,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm",children:o?"Add to Home Screen":"Install Fan Club Z"}),e.jsx("p",{className:"text-xs text-green-100",children:o?"Get quick access and offline features":"Faster loading • Offline access • Notifications"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:n,className:"bg-white text-green-600 px-3 py-1.5 rounded-md text-sm font-medium hover:bg-green-50 active:bg-green-100 transition-colors flex items-center space-x-1 shadow-sm",children:[e.jsx(rs,{className:"w-4 h-4"}),e.jsx("span",{children:o?"How To":"Install"})]}),e.jsx("button",{onClick:a,className:"text-green-100 hover:text-white transition-colors p-1 rounded","aria-label":"Dismiss install banner",children:e.jsx(ze,{className:"w-5 h-5"})})]})]})})},Lc=({isOpen:i,onClose:t})=>i?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex flex-col ios-install-modal",onClick:t,style:{zIndex:1e4},children:e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 pb-24",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200 flex flex-col max-h-[calc(100vh-8rem)]",onClick:s=>s.stopPropagation(),style:{zIndex:10001},children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-4 text-center text-white relative rounded-t-2xl flex-shrink-0",children:[e.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-white/80 hover:text-white transition-colors p-1 rounded-full hover:bg-white/20","aria-label":"Close modal",children:e.jsx(ze,{className:"w-5 h-5"})}),e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-white/20 rounded-full mb-3",children:e.jsx(nn,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-lg font-bold mb-1",children:"Install Fan Club Z"}),e.jsx("p",{className:"text-green-100 text-sm",children:"Get the full app experience with offline access and notifications"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"1"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:"Tap the Share button"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Zs,{className:"w-4 h-4"}),e.jsx("span",{children:"Usually found at the bottom of Safari"})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"2"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:'Select "Add to Home Screen"'}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Ot,{className:"w-4 h-4"}),e.jsx("span",{children:"Scroll down in the share menu to find this option"})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"3"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2 text-base",children:'Tap "Add" to confirm'}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fan Club Z will appear on your home screen like a native app"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3 text-base",children:"Why install?"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[e.jsx("li",{children:"• Faster loading and smoother experience"}),e.jsx("li",{children:"• Works offline for viewing your predictions"}),e.jsx("li",{children:"• Push notifications for important updates"}),e.jsx("li",{children:"• Easy access from your home screen"})]})]}),e.jsx("div",{className:"h-4"})]})}),e.jsx("div",{className:"border-t border-gray-100 p-4 flex-shrink-0 rounded-b-2xl",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors text-base",children:"Maybe Later"}),e.jsx("button",{onClick:()=>{t(),localStorage.setItem("ios-install-dismissed",Date.now().toString())},className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-base",children:"Got It!"})]})})]})})}):null,Oc=({onInstall:i,onDismiss:t})=>{const[s,r]=p.useState(!1);p.useEffect(()=>{const o=setTimeout(()=>r(!0),100);return()=>clearTimeout(o)},[]);const n=()=>{r(!1),setTimeout(i,300)},a=()=>{r(!1),setTimeout(t,300)};return e.jsx("div",{className:`
      fixed inset-x-4 top-20 max-w-sm mx-auto transition-all duration-300 ease-out pwa-install-prompt
      ${s?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-4"}
    `,style:{zIndex:1e4},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(rs,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Install Fan Club Z"}),e.jsx("p",{className:"text-xs text-green-100",children:"Get the full app experience"})]})]}),e.jsx("button",{onClick:a,className:"text-green-100 hover:text-white transition-colors p-1 rounded",children:e.jsx(ze,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ln,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Faster Performance"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Lightning-fast loading and smooth animations"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Xi,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Get notified about prediction results and updates"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(xr,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Offline Access"}),e.jsx("p",{className:"text-xs text-gray-600",children:"View your predictions even without internet"})]})]})]}),e.jsxs("div",{className:"p-4 pt-0 flex space-x-2",children:[e.jsx("button",{onClick:a,className:"flex-1 py-2.5 px-4 text-gray-700 bg-gray-100 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors",children:"Maybe Later"}),e.jsxs("button",{onClick:n,className:"flex-1 py-2.5 px-4 bg-green-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors flex items-center justify-center space-x-1",children:[e.jsx(rs,{className:"w-4 h-4"}),e.jsx("span",{children:"Install"})]})]})]})})},Dc=()=>{const[i,t]=p.useState(!1),[s,r]=p.useState(0);p.useEffect(()=>{let l=0;const d=["click","scroll","touchstart","keydown"],c=()=>{l++,r(l),l>=5&&!localStorage.getItem("install-prompt-shown")&&n()};return d.forEach(u=>{document.addEventListener(u,c,{passive:!0})}),()=>{d.forEach(u=>{document.removeEventListener(u,c)})}},[]);const n=()=>{if(fe.isAppInstalled())return;const l=localStorage.getItem("install-prompt-dismissed"),d=l?parseInt(l):0,c=24*60*60*1e3;if(!l||Date.now()-d>c){const u=Date.now()-parseInt(localStorage.getItem("session-start")||"0"),h=localStorage.getItem("has-created-prediction"),m=localStorage.getItem("has-placed-prediction");u>3e4&&(h||m)&&(t(!0),localStorage.setItem("install-prompt-shown","true"))}},a=async()=>{fe.isIOSDevice()?window.dispatchEvent(new CustomEvent("show-ios-install")):await fe.promptInstall()||localStorage.setItem("install-prompt-dismissed",Date.now().toString()),t(!1)},o=()=>{t(!1),localStorage.setItem("install-prompt-dismissed",Date.now().toString())};return i?e.jsx(Oc,{onInstall:a,onDismiss:o}):null},Uc=({isVisible:i,onUpdate:t,onDismiss:s})=>{const[r,n]=p.useState(!1),a=()=>{n(!0),setTimeout(s,300)},o=()=>{n(!0),setTimeout(t,200)};return!i&&!r?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`
        fixed inset-0 bg-black/10 backdrop-blur-sm transition-opacity duration-300 update-notification
        ${i&&!r?"opacity-100":"opacity-0"}
      `,style:{zIndex:1e4}}),e.jsx("div",{className:`
        fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 update-notification
        w-[calc(100vw-32px)] max-w-sm max-h-[90vh] overflow-y-auto
        transition-all duration-300 ease-out
        ${i&&!r?"opacity-100 scale-100":"opacity-0 scale-95"}
      `,style:{zIndex:10001},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-4 text-white relative",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:e.jsx(gt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-bold text-base flex items-center space-x-2",children:[e.jsx("span",{children:"Update Available!"}),e.jsx(xr,{className:"w-4 h-4"})]}),e.jsx("p",{className:"text-sm text-green-100",children:"New features and improvements ready"})]})]}),e.jsx("button",{onClick:a,className:"absolute top-3 right-3 text-green-100 hover:text-white transition-colors p-1 rounded-full hover:bg-white/10","aria-label":"Dismiss update notification",children:e.jsx(ze,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:["🚀 ",e.jsx("strong",{children:"What's New:"})]}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 ml-2",children:[e.jsx("li",{children:"• Improved performance and stability"}),e.jsx("li",{children:"• Enhanced user interface"}),e.jsx("li",{children:"• Bug fixes and optimizations"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:o,className:"flex-[2] bg-green-600 text-white py-3 px-4 rounded-xl font-semibold text-sm hover:bg-green-700 active:bg-green-800 transition-colors flex items-center justify-center space-x-2 shadow-lg",children:[e.jsx(gt,{className:"w-4 h-4"}),e.jsx("span",{children:"Update Now"})]}),e.jsx("button",{onClick:a,className:"flex-1 py-3 px-4 text-gray-600 hover:text-gray-800 transition-colors text-sm font-medium hover:bg-gray-50 rounded-xl border border-gray-200",children:"Later"})]})]})]})})]})},Mc=()=>{const[i,t]=p.useState(!1),[s,r]=p.useState(!1);p.useEffect(()=>{localStorage.getItem("session-start")||localStorage.setItem("session-start",Date.now().toString());const o=()=>{t(!0)},l=m=>{r(!0)},d=()=>{setTimeout(async()=>{const m=localStorage.getItem("user-has-interacted"),f=localStorage.getItem("notification-permission-requested");if(m&&!f){const y=await fe.requestNotificationPermission();localStorage.setItem("notification-permission-requested","true"),y&&await fe.subscribeToPushNotifications()}},15e3)};window.addEventListener("show-ios-install",o),window.addEventListener("pwa-update-available",l);const c=()=>{localStorage.setItem("user-has-interacted","true"),d()},u=["click","scroll","touchstart"];return u.forEach(m=>{document.addEventListener(m,c,{once:!0,passive:!0})}),(()=>{const m=parseInt(localStorage.getItem("visit-count")||"0")+1;localStorage.setItem("visit-count",m.toString()),localStorage.setItem("last-visit",Date.now().toString()),m>1&&localStorage.setItem("is-returning-user","true")})(),()=>{window.removeEventListener("show-ios-install",o),window.removeEventListener("pwa-update-available",l),u.forEach(m=>{document.removeEventListener(m,c)})}},[]);const n=()=>{typeof gtag<"u"&&gtag("event","pwa_update_accepted",{event_category:"engagement",event_label:"app_update"}),window.location.reload()},a=()=>{r(!1),typeof gtag<"u"&&gtag("event","pwa_update_dismissed",{event_category:"engagement",event_label:"app_update"})};return e.jsxs(e.Fragment,{children:[e.jsx(zc,{}),e.jsx(Dc,{}),e.jsx(Lc,{isOpen:i,onClose:()=>t(!1)}),e.jsx(Uc,{isVisible:s,onUpdate:n,onDismiss:a})]})};let Fc=class extends p.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("PageWrapper Error Boundary caught an error:",t,s)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:this.state.error?.message||"An unexpected error occurred while loading this page."}),e.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:void 0}),this.props.onRetry()},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Try Again"})]})}):this.props.children}};const Bc=({title:i="Loading..."})=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:i})]})}),Re=({children:i,title:t="Loading...",fallback:s})=>{const[r,n]=he.useState(0),a=()=>{n(o=>o+1)};return e.jsx(Fc,{onRetry:a,children:e.jsx(p.Suspense,{fallback:s||e.jsx(Bc,{title:t}),children:e.jsx("div",{children:i},r)})})},Wc={version:"2.0.55",name:"Fan Club Z",description:"Social Prediction Platform",api:{url:"https://fan-club-z.onrender.com",timeout:15e3,retries:3},frontend:{url:{}.VITE_FRONTEND_URL||"https://app.fanclubz.app"},features:{realTimeUpdates:!0,socialEngagement:!0,walletIntegration:!0,settlementSystem:!0,clubSystem:!0},limits:{maxStakeAmount:1e4,minStakeAmount:1,maxDescriptionLength:500,maxCommentLength:280},ui:{theme:{primaryColor:"#22c55e",brandColors:{green:{50:"#f0fdf4",500:"#22c55e",600:"#16a34a",700:"#15803d"}}},animations:{duration:{fast:200,normal:300,slow:500}}}},pe=()=>Wc.api.url,ei={predictions:[],trendingPredictions:[],userPredictions:[],createdPredictions:[],completedPredictions:[],userPredictionEntries:[],userCreatedPredictions:[],loading:!1,error:null,initialized:!1,lastFetchTime:0,platformStats:null,statsLoading:!1},yt=st((i,t)=>({...ei,fetchPredictions:async()=>{const s=Date.now(),{lastFetchTime:r,predictions:n}=t();if(s-r<3e4&&n.length>0){console.log("📋 Using cached predictions");return}i({loading:!0,error:null});try{console.log("📡 Fetching predictions from API...");const a=await fetch(`${pe()}/api/v2/predictions`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!a.ok)throw new Error(`API Error: ${a.status} ${a.statusText}`);const l=(await a.json()).data||[];console.log("✅ Predictions fetched successfully:",l.length),i({predictions:l,loading:!1,error:null,initialized:!0,lastFetchTime:s})}catch(a){console.error("❌ Error fetching predictions:",a),i({loading:!1,error:a instanceof Error?a.message:"Failed to fetch predictions"})}},refreshPredictions:async(s=!1)=>{const{lastFetchTime:r}=t(),n=Date.now();if(!s&&n-r<1e4){console.log("📋 Using cached predictions (refresh)");return}i({lastFetchTime:0});try{await t().fetchPredictions(),console.log("🔄 Predictions refreshed successfully")}catch(a){throw console.error("❌ Error refreshing predictions:",a),a}},fetchTrendingPredictions:async()=>{i({loading:!0});try{const s=await fetch(`${pe()}/api/v2/predictions/trending`);if(!s.ok)throw new Error(`Failed to fetch trending predictions: ${s.statusText}`);const n=(await s.json()).data||[];i({trendingPredictions:n,loading:!1,error:null}),console.log("✅ Trending predictions fetched:",n.length)}catch(s){console.error("❌ Error fetching trending predictions:",s),i({loading:!1,error:s instanceof Error?s.message:"Failed to fetch trending predictions"})}},fetchUserPredictions:async s=>{i({loading:!0});try{const r=await fetch(`${pe()}/api/v2/predictions/user/${s}`);if(!r.ok)throw new Error(`Failed to fetch user predictions: ${r.statusText}`);const a=(await r.json()).data||[];i({userPredictions:a,loading:!1,error:null})}catch(r){console.error("❌ Error fetching user predictions:",r),i({loading:!1,error:r instanceof Error?r.message:"Failed to fetch user predictions"})}},fetchCreatedPredictions:async s=>{i({loading:!0});try{const r=await fetch(`${pe()}/api/v2/predictions/created/${s}`);if(!r.ok)throw new Error(`Failed to fetch created predictions: ${r.statusText}`);const a=(await r.json()).data||[];i({createdPredictions:a,loading:!1,error:null})}catch(r){console.error("❌ Error fetching created predictions:",r),i({loading:!1,error:r instanceof Error?r.message:"Failed to fetch created predictions"})}},createPrediction:async s=>{i({loading:!0,error:null});try{const r=await fetch(`${pe()}/api/v2/predictions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw new Error(`Failed to create prediction: ${r.statusText}`);const n=await r.json();if(!n.data)throw new Error("Invalid response: no prediction data returned");const a=n.data;if(!a||!a.id)throw new Error("Invalid prediction data: missing required fields");i(o=>({predictions:[a,...o.predictions],loading:!1,error:null})),i(o=>({userCreatedPredictions:[a,...o.userCreatedPredictions]}));try{const{user:o}=le.getState();o?.id&&setTimeout(()=>{t().fetchUserCreatedPredictions(o.id)},1e3)}catch(o){console.warn("⚠️ Failed to refresh user created predictions:",o)}return console.log("✅ Prediction created successfully:",a.id),a}catch(r){throw console.error("❌ Error creating prediction:",r),i({loading:!1,error:r instanceof Error?r.message:"Failed to create prediction"}),r}},placePrediction:async(s,r,n,a)=>{i({loading:!0,error:null});try{const o=await fetch(`${pe()}/api/v2/predictions/${s}/entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({option_id:r,amount:n,user_id:a})});if(!o.ok)throw new Error(`Failed to place prediction: ${o.statusText}`);const l=await o.json();i(d=>({predictions:d.predictions.map(c=>c.id===s?{...c,pool_total:l.prediction?.pool_total||c.pool_total,participant_count:l.prediction?.participant_count||c.participant_count,user_entry:l.entry}:c),loading:!1,error:null})),console.log("✅ Prediction placed successfully")}catch(o){throw console.error("❌ Error placing prediction:",o),i({loading:!1,error:o instanceof Error?o.message:"Failed to place prediction"}),o}},fetchPlatformStats:async()=>{i({statsLoading:!0});try{console.log("📊 Fetching platform stats...");const s=await fetch(`${pe()}/api/v2/predictions/stats/platform`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!s.ok)throw new Error(`Stats API Error: ${s.status} ${s.statusText}`);const r=await s.json();if(r.success&&r.data)i({platformStats:r.data,statsLoading:!1}),console.log("✅ Platform stats fetched:",r.data);else throw new Error("Invalid stats response format")}catch(s){console.error("❌ Error fetching platform stats:",s);const{predictions:r}=t(),n={totalVolume:r.reduce((a,o)=>a+(o.pool_total||0),0).toFixed(2),activePredictions:r.filter(a=>a.status==="open").length,totalUsers:r.length>0?"5":"0",rawVolume:r.reduce((a,o)=>a+(o.pool_total||0),0),rawUsers:r.length>0?5:0};i({platformStats:n,statsLoading:!1}),console.log("📊 Using fallback stats:",n)}},getActivityForPrediction:s=>[],getParticipantsForPrediction:s=>[],clearError:()=>{i({error:null})},fetchUserPredictionEntries:async s=>{try{console.log("📋 Fetching user prediction entries for:",s);const r=await fetch(`${pe()}/api/v2/prediction-entries/user/${s}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to fetch user prediction entries: ${r.statusText}`);const a=(await r.json()).data||[];i({userPredictionEntries:a}),console.log("✅ User prediction entries fetched:",a.length)}catch(r){console.error("❌ Error fetching user prediction entries:",r)}},fetchUserCreatedPredictions:async s=>{try{console.log("📋 Fetching user created predictions for:",s);const r=await fetch(`${pe()}/api/v2/predictions/created/${s}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to fetch user created predictions: ${r.statusText}`);const a=(await r.json()).data||[];i({userCreatedPredictions:a}),console.log("✅ User created predictions fetched:",a.length)}catch(r){console.error("❌ Error fetching user created predictions:",r)}},getUserPredictionEntries:s=>{const{userPredictionEntries:r}=t();return r.filter(n=>n.user_id===s)},getUserCreatedPredictions:s=>{const{userCreatedPredictions:r}=t();return r.filter(n=>n.creator_id===s)},updatePrediction:async(s,r)=>{try{console.log("🔄 Updating prediction:",s,r);const n=await fetch(`${pe()}/api/v2/predictions/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)});if(!n.ok)throw new Error(`Failed to update prediction: ${n.statusText}`);const o=(await n.json()).data;i(l=>({predictions:l.predictions.map(d=>d.id===s?{...d,...o}:d),userCreatedPredictions:l.userCreatedPredictions.map(d=>d.id===s?{...d,...o}:d)})),console.log("✅ Prediction updated successfully")}catch(n){throw console.error("❌ Error updating prediction:",n),n}},deletePrediction:async s=>{try{console.log("🗑️ Deleting prediction:",s);const r=await fetch(`${pe()}/api/v2/predictions/${s}`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to delete prediction: ${r.statusText}`);i(n=>({predictions:n.predictions.filter(a=>a.id!==s),userCreatedPredictions:n.userCreatedPredictions.filter(a=>a.id!==s),trendingPredictions:n.trendingPredictions.filter(a=>a.id!==s)})),console.log("✅ Prediction deleted successfully")}catch(r){throw console.error("❌ Error deleting prediction:",r),r}},closePrediction:async s=>{try{console.log("🔒 Closing prediction:",s);const r=await fetch(`${pe()}/api/v2/predictions/${s}/close`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to close prediction: ${r.statusText}`);const a=(await r.json()).data;i(o=>({predictions:o.predictions.map(l=>l.id===s?{...l,status:"closed",...a}:l),userCreatedPredictions:o.userCreatedPredictions.map(l=>l.id===s?{...l,status:"closed",...a}:l)})),console.log("✅ Prediction closed successfully")}catch(r){throw console.error("❌ Error closing prediction:",r),r}},fetchPredictionActivity:async s=>{try{console.log("📋 Fetching prediction activity:",s);const r=await fetch(`${pe()}/api/v2/predictions/${s}/activity`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return r.ok?(await r.json()).data||[]:(console.warn(`Activity endpoint not available: ${r.statusText}`),[])}catch(r){return console.warn("Activity endpoint not implemented yet:",r),[]}},fetchPredictionParticipants:async s=>{try{console.log("📋 Fetching prediction participants:",s);const r=await fetch(`${pe()}/api/v2/predictions/${s}/participants`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return r.ok?(await r.json()).data||[]:(console.warn(`Participants endpoint not available: ${r.statusText}`),[])}catch(r){return console.warn("Participants endpoint not implemented yet:",r),[]}},reset:()=>{i(ei)}})),ns=({username:i,userId:t,displayName:s,className:r="",showAt:n=!0,onClick:a})=>{const[,o]=oe(),l=c=>{if(c.stopPropagation(),console.log("👤 TappableUsername clicked:",{username:i,userId:t,displayName:s}),a)a();else if(t&&t.trim()!=="")console.log("🔗 Navigating to profile with userId:",t),o(`/profile/${t}`);else if(i&&i.trim()!==""){const u=i.replace("@","").trim();console.log("🔗 Navigating to profile with username:",u),o(`/profile/${u}`)}else{console.warn("⚠️ No valid userId or username provided for profile navigation");return}},d=s||(n?`@${i.replace("@","")}`:i.replace("@",""));return e.jsx(A.button,{className:`inline-flex items-center font-medium text-blue-600 hover:text-blue-700 hover:underline transition-all cursor-pointer rounded-md px-1 py-0.5 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 ${r}`,whileHover:{scale:1.02},whileTap:{scale:.98},onClick:l,type:"button","aria-label":`View profile for ${d}`,children:d})},ti=({children:i,onClose:t,error:s})=>s?e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9000]",children:e.jsx("div",{className:"bg-white rounded-lg p-6 max-w-sm mx-4",children:e.jsxs("div",{className:"text-red-600 text-center",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"⚠️ Error"}),e.jsx("p",{className:"text-sm",children:s}),e.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Close"})]})})}):e.jsx(e.Fragment,{children:i}),Is=({prediction:i,isOpen:t,onClose:s})=>{const{user:r}=le(),[n,a]=p.useState(""),[o,l]=p.useState(!1);p.useEffect(()=>{l(!0)},[]);const d=i&&i.id&&i.id.trim()!=="",c=t&&d&&o,{comments:u,commentCount:h,isLoading:m,error:f,isSubmitting:y,fetchComments:x,addComment:g,toggleCommentLike:j,clearError:v}=mr(c?i.id:"");p.useEffect(()=>{c&&x()},[c,x]),p.useEffect(()=>{t||(a(""),d&&v())},[t,v,d]);const w=async()=>{if(!(!d||!n.trim()||!r))try{await g(n.trim()),a(""),G.success("Comment added successfully!")}catch(S){console.error("Failed to add comment:",S),G.error(S.message||"Failed to add comment")}},C=async S=>{if(d)try{await j(S)}catch($){console.error("Failed to toggle comment like:",$),G.error("Failed to update like")}},z=S=>{try{const $=new Date,U=new Date(S),k=Math.floor(($.getTime()-U.getTime())/1e3);return k<60?"Just now":k<3600?`${Math.floor(k/60)}m ago`:k<86400?`${Math.floor(k/3600)}h ago`:`${Math.floor(k/86400)}d ago`}catch{return"Recently"}};return o?t&&!d?e.jsx(ti,{onClose:s,error:"Unable to load comments. Invalid prediction data."}):!t||!i?null:e.jsx(je,{children:e.jsx(ti,{onClose:s,children:e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center sm:items-center sm:p-4 z-[9000]",children:e.jsxs(A.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},onClick:S=>S.stopPropagation(),className:"bg-white w-full max-w-lg rounded-t-3xl sm:rounded-3xl overflow-hidden flex flex-col max-h-[90vh] sm:max-h-[80vh]",style:{zIndex:9001},children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{size:20,className:"text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Comments"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[h," ",h===1?"comment":"comments"]})]})]}),e.jsx("button",{onClick:s,className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:e.jsx(ze,{size:18})})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:i.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:i.description||"No description available"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:m&&u.length===0?e.jsx("div",{className:"p-4 text-center",children:e.jsx("div",{className:"animate-pulse space-y-3",children:[...Array(3)].map((S,$)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]},$))})}):f?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ce,{size:48,className:"text-red-300 mx-auto mb-3"}),e.jsx("p",{className:"text-red-600 font-medium",children:"Failed to load comments"}),e.jsx("p",{className:"text-sm text-red-400 mb-4",children:f}),e.jsx("button",{onClick:()=>x(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Try Again"})]}):u.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ce,{size:48,className:"text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No comments yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Be the first to share your thoughts!"})]}):e.jsx("div",{className:"p-4 space-y-4",children:u.map(S=>e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-green-500 flex items-center justify-center text-white text-sm font-semibold flex-shrink-0",children:S.user?.username?.[0]?.toUpperCase()||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ns,{username:S.user?.username||"Anonymous",userId:S.user?.id||"anonymous",className:"font-semibold text-gray-900 text-sm hover:text-blue-600",showAt:!1}),e.jsx("span",{className:"text-xs text-gray-500",children:z(S.created_at)})]}),e.jsx("p",{className:"text-gray-800 text-sm leading-relaxed",children:S.content})]}),e.jsx("div",{className:"flex items-center gap-4 mt-2 ml-4",children:e.jsxs("button",{onClick:()=>C(S.id),className:`flex items-center gap-1 text-xs transition-colors ${S.is_liked?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[e.jsx(tt,{size:14,fill:S.is_liked?"currentColor":"none"}),S.likes_count>0&&e.jsx("span",{children:S.likes_count})]})})]})]},S.id))})}),r?e.jsx("div",{className:"p-4 border-t border-gray-100 bg-white sticky bottom-0",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-green-500 flex items-center justify-center text-white text-sm font-semibold flex-shrink-0",children:r.firstName?.[0]?.toUpperCase()||r.username?.[0]?.toUpperCase()||r.email?.[0]?.toUpperCase()||"U"}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:S=>a(S.target.value),onKeyPress:S=>{S.key==="Enter"&&!S.shiftKey&&(S.preventDefault(),w())},placeholder:"Write a comment...",className:"flex-1 px-4 py-2 bg-gray-100 rounded-full focus:ring-2 focus:ring-green-500 focus:bg-white focus:outline-none transition-all text-sm",disabled:y}),e.jsx("button",{onClick:w,disabled:!n.trim()||y,className:"w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:e.jsx(Ec,{size:14})})]})]})}):e.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50 text-center",children:e.jsx("p",{className:"text-gray-600 text-sm",children:"Please log in to join the conversation"})})]})})})}):null};class cn extends p.Component{constructor(s){super(s);se(this,"maxRetries",3);se(this,"handleRetry",()=>{this.state.retryCount<this.maxRetries&&this.setState(s=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:s.retryCount+1}))});se(this,"handleReload",()=>{window.location.reload()});se(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,retryCount:0}}static getDerivedStateFromError(s){return{hasError:!0,error:s,retryCount:0}}componentDidCatch(s,r){console.error("ErrorBoundary caught an error:",s,r),this.setState({error:s,errorInfo:r}),this.props.onError&&this.props.onError(s,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-center",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(gc,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"We're sorry, but something unexpected happened. Please try again."})]}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[this.state.retryCount<this.maxRetries&&e.jsxs("button",{onClick:this.handleRetry,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:[e.jsx(gt,{className:"w-4 h-4 mr-2"}),"Try Again (",this.maxRetries-this.state.retryCount," left)"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:[e.jsx(tn,{className:"w-4 h-4 mr-2"}),"Go Home"]}),e.jsxs("button",{onClick:this.handleReload,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:[e.jsx(gt,{className:"w-4 h-4 mr-2"}),"Reload Page"]})]}),this.state.retryCount>=this.maxRetries&&e.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"If the problem persists, please contact support."})]})}):this.props.children}}const dn=({error:i})=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-red-200 p-4 m-2",children:e.jsxs("div",{className:"text-red-600 text-sm",children:["⚠️ Error loading prediction",i&&e.jsx("div",{className:"text-xs mt-1 text-gray-500",children:i})]})}),Hc=({prediction:i,entry:t,variant:s="default",onLike:r,onComment:n,onShare:a,onPredict:o,className:l=""})=>{if(!i||!i.id)return console.warn("⚠️ PredictionCard: Invalid prediction data received:",i),e.jsx(dn,{error:"Invalid prediction data"});const[,d]=oe(),[c,u]=p.useState(!1),[h,m]=p.useState(!1),[f,y]=p.useState(!1);p.useEffect(()=>{u(!0)},[]);const x=()=>{try{const{toggleLike:P,checkIfLiked:W,getLikeCount:K}=hr();return{toggleLike:P,checkIfLiked:W,getLikeCount:K}}catch(P){return console.warn("Error accessing like store:",P),{toggleLike:async()=>{},checkIfLiked:()=>!1,getLikeCount:()=>0}}},g=()=>{try{const{getCommentCount:P}=pr();return{getCommentCount:P}}catch(P){return console.warn("Error accessing comment store:",P),{getCommentCount:()=>0}}},{toggleLike:j,checkIfLiked:v,getLikeCount:w}=x(),{getCommentCount:C}=g();if(!c)return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]});const z=v(i.id)||!1,S=w(i.id),$=S??(i.likes_count||i.likes||0),U=C(i.id)||i.comments_count||i.comments||0,k=i.entry_deadline||i.entryDeadline,V=k?Math.max(0,new Date(k).getTime()-Date.now()):0,T=Math.floor(V/(1e3*60*60)),_=T<24&&T>0,O=i.participant_count||i.entries?.length||0,b=i.options?.reduce((P,W)=>{const K=W.total_staked||W.totalStaked||0;return P+K},0)||i.pool_total||i.poolTotal||0,N=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),F=async()=>{if(!f){console.log("❤️ Like clicked:",i.id,"- Before:",{isLiked:z,likeCount:$});try{y(!0),await j(i.id),r&&r()}catch(P){console.error("❌ Error toggling like:",P),G.error("Failed to update like")}finally{y(!1)}}},Y=()=>{m(!0),n&&n()},R=async()=>{try{const P={title:i.title,text:`Check out this prediction: ${i.title}`,url:`${window.location.origin}/prediction/${i.id}`};if(navigator.share&&navigator.canShare&&navigator.canShare(P))await navigator.share(P);else if(navigator.clipboard)await navigator.clipboard.writeText(P.url),G.success("Link copied to clipboard!");else{const W=document.createElement("textarea");W.value=P.url,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),G.success("Link copied to clipboard!")}a&&a()}catch(P){console.error("Error sharing:",P),G.error("Failed to share")}},I=P=>{const W=P.target;W.closest("button")||W.closest("a")||W.closest(".interactive")||d(`/prediction/${i.id}`)},E=()=>V<=0?"Ended":T>=24?`${Math.floor(T/24)}d left`:`${T}h left`;if(s==="compact")return e.jsxs(e.Fragment,{children:[e.jsxs(A.div,{className:`bg-white rounded-xl shadow-sm border border-gray-100 p-4 cursor-pointer ${l}`,whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},onClick:I,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-purple-400 to-purple-600 flex items-center justify-center text-white text-sm font-bold",children:i.creator?.username?.slice(0,2).toUpperCase()||"FC"}),e.jsxs("div",{children:[e.jsx(ns,{username:i.creator?.username||i.creator?.full_name||"Anonymous",userId:i.creator?.id||"anonymous",className:"font-medium text-gray-900 text-sm hover:text-blue-600",showAt:!0}),e.jsx("div",{className:"text-xs text-gray-500",children:E()})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.category==="sports"?"bg-red-100 text-red-700":i.category==="pop_culture"?"bg-purple-100 text-purple-700":i.category==="crypto"?"bg-yellow-100 text-yellow-700":i.category==="politics"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:i.category?.replace("_"," ")||"General"})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 cursor-pointer",onClick:()=>o&&o(),children:i.title}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 cursor-pointer",onClick:()=>o&&o(),children:[e.jsx("span",{className:"font-medium",children:N(b)}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[i.options?.length||2," options"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:P=>{P.stopPropagation(),F()},className:`flex items-center gap-1 ${z?"text-red-500":"text-gray-400"} hover:text-red-500 transition-colors`,children:[e.jsx(tt,{className:`w-4 h-4 ${z?"fill-current":""}`}),e.jsx("span",{className:"text-gray-600",children:$})]}),e.jsxs("button",{onClick:P=>{P.stopPropagation(),Y()},className:"flex items-center gap-1 text-gray-400 hover:text-blue-500 transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-gray-600",children:U})]})]})]})]}),e.jsx(Is,{prediction:i,isOpen:h,onClose:()=>m(!1)})]});if(s==="user-entry"){const P=!!t,W=t?.option_id,K=t?.potential_payout||0,te=t?.actual_payout||0,ce=t?.status||i.status;return e.jsxs(e.Fragment,{children:[e.jsxs(A.div,{className:`bg-white rounded-xl shadow-sm border-l-4 ${ce==="won"?"border-green-500":ce==="lost"?"border-red-500":ce==="settled"?"border-gray-500":"border-blue-500"} p-4 cursor-pointer ${l}`,whileHover:{scale:1.01,y:-2},onClick:I,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base line-clamp-1",children:i.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ce==="won"?"bg-green-100 text-green-700":ce==="lost"?"bg-red-100 text-red-700":ce==="settled"?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"}`,children:ce?.toUpperCase()}),e.jsx(He,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:E()})]})]})}),P&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Your Position"}),e.jsx("div",{className:"font-semibold text-gray-900",children:i.options?.find(jt=>jt.id===W)?.label||"Option selected"}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Stake: ",N(t?.amount||0)," •",ce==="won"?` Won: ${N(te)}`:ce==="lost"?" Lost":` Potential: ${N(K)}`]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:F,disabled:f,className:`flex items-center gap-1 ${z?"text-red-500":"text-gray-500"} hover:text-red-500 transition-colors`,children:[e.jsx(tt,{className:`w-4 h-4 ${z?"fill-current":""}`}),e.jsx("span",{className:"text-sm",children:$})]}),e.jsxs("button",{onClick:Y,className:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:U})]}),e.jsxs("button",{onClick:R,className:"flex items-center gap-1 text-gray-500 hover:text-green-500 transition-colors",children:[e.jsx(Zs,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Share"})]})]}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 text-sm font-medium transition-colors",children:"View Details"})]})]}),e.jsx(Is,{prediction:i,isOpen:h,onClose:()=>m(!1)})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(A.div,{className:`bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden cursor-pointer ${l}`,whileHover:{scale:1.01,y:-2},initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:I,transition:{duration:.3},children:[e.jsxs("div",{className:"p-4 pb-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-purple-400 to-purple-600 flex items-center justify-center text-white font-bold",children:i.creator?.username?.slice(0,2).toUpperCase()||"FC"}),e.jsxs("div",{children:[e.jsx(ns,{username:i.creator?.username||i.creator?.full_name||"Anonymous",userId:i.creator?.id||"anonymous",className:"font-medium text-gray-900 hover:text-blue-600",showAt:!0}),e.jsx("div",{className:"text-sm text-gray-500",children:i.created_at?new Date(i.created_at).toLocaleDateString():"Recently"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${i.category==="sports"?"bg-red-100 text-red-700":i.category==="pop_culture"?"bg-purple-100 text-purple-700":i.category==="crypto"?"bg-yellow-100 text-yellow-700":i.category==="politics"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:i.category?.replace("_"," ")||"General"}),_&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:"Closing Soon"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2 leading-tight",children:i.title}),i.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:i.description})]}),e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Options"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[i.options?.length||2," choices"]})]}),e.jsxs("div",{className:"space-y-2",children:[(i.options||[]).slice(0,3).map((P,W)=>{const K=P.total_staked||P.totalStaked||0,te=b>0?K/b*100:100/(i.options?.length||2),ce=K>0?b/K:2;return e.jsx(A.button,{className:"w-full p-3 rounded-lg border-2 border-gray-200 bg-white hover:border-green-300 hover:bg-green-50 transition-all group",whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>o&&o(),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium text-gray-900 group-hover:text-green-700",children:P.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[te.toFixed(0),"% • ",N(K)]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[ce.toFixed(1),"x"]})})]})},P.id)}),(i.options?.length||0)>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",(i.options?.length||0)-3," more options available"]})]})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:N(b)}),e.jsx("span",{className:"text-gray-500",children:"pool"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx($t,{className:"w-4 h-4"}),e.jsx("span",{children:O})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(He,{className:"w-4 h-4"}),e.jsx("span",{className:_?"text-amber-600 font-medium":"",children:E()})]})]}),O>5&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Trending"})]})]})}),e.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs(A.button,{onClick:F,disabled:f,className:`flex items-center gap-2 ${z?"text-red-500":"text-gray-600"} hover:text-red-500 transition-colors`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(tt,{className:`w-5 h-5 ${z?"fill-current":""}`}),e.jsx("span",{className:"text-sm font-medium",children:$})]}),e.jsxs(A.button,{onClick:Y,className:"flex items-center gap-2 text-gray-600 hover:text-blue-500 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Ce,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:U})]}),e.jsxs(A.button,{onClick:R,className:"flex items-center gap-2 text-gray-600 hover:text-green-500 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Zs,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Share"})]})]}),e.jsx(A.button,{onClick:o,className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-2 rounded-lg font-medium shadow-sm",whileHover:{scale:1.02,boxShadow:"0 8px 25px rgba(16, 185, 129, 0.25)"},whileTap:{scale:.98},children:"Predict Now"})]})})]}),e.jsx(Is,{prediction:i,isOpen:h,onClose:()=>m(!1)})]})},qc=i=>e.jsx(cn,{fallback:e.jsx(dn,{}),children:e.jsx(Hc,{...i})}),Vc=()=>e.jsxs("div",{className:"bg-white rounded-2xl p-4 mx-4 mb-3 shadow-sm border border-gray-100 animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-1"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]}),e.jsx("div",{className:"ml-3 flex-shrink-0",children:e.jsx("div",{className:"w-16 h-6 bg-gray-200 rounded-full"})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-3 border-2 border-gray-200 rounded-xl",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-12 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-8"})]}),e.jsxs("div",{className:"p-3 border-2 border-gray-200 rounded-xl",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-12 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-8"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-sm mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-10"})]}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-6"})]}),e.jsx("div",{className:"w-20 h-8 bg-gray-200 rounded-lg"})]})]});function un(i){var t,s,r="";if(typeof i=="string"||typeof i=="number")r+=i;else if(typeof i=="object")if(Array.isArray(i)){var n=i.length;for(t=0;t<n;t++)i[t]&&(s=un(i[t]))&&(r&&(r+=" "),r+=s)}else for(s in i)i[s]&&(r&&(r+=" "),r+=s);return r}function hn(){for(var i,t,s=0,r="",n=arguments.length;s<n;s++)(i=arguments[s])&&(t=un(i))&&(r&&(r+=" "),r+=t);return r}const si=i=>typeof i=="boolean"?`${i}`:i===0?"0":i,ri=hn,Gc=(i,t)=>s=>{var r;if(t?.variants==null)return ri(i,s?.class,s?.className);const{variants:n,defaultVariants:a}=t,o=Object.keys(n).map(c=>{const u=s?.[c],h=a?.[c];if(u===null)return null;const m=si(u)||si(h);return n[c][m]}),l=s&&Object.entries(s).reduce((c,u)=>{let[h,m]=u;return m===void 0||(c[h]=m),c},{}),d=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:m,...f}=u;return Object.entries(f).every(y=>{let[x,g]=y;return Array.isArray(g)?g.includes({...a,...l}[x]):{...a,...l}[x]===g})?[...c,h,m]:c},[]);return ri(i,o,d,s?.class,s?.className)},br="-",Jc=i=>{const t=Yc(i),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=i;return{getClassGroupId:o=>{const l=o.split(br);return l[0]===""&&l.length!==1&&l.shift(),pn(l,t)||Kc(o)},getConflictingClassGroupIds:(o,l)=>{const d=s[o]||[];return l&&r[o]?[...d,...r[o]]:d}}},pn=(i,t)=>{if(i.length===0)return t.classGroupId;const s=i[0],r=t.nextPart.get(s),n=r?pn(i.slice(1),r):void 0;if(n)return n;if(t.validators.length===0)return;const a=i.join(br);return t.validators.find(({validator:o})=>o(a))?.classGroupId},ii=/^\[(.+)\]$/,Kc=i=>{if(ii.test(i)){const t=ii.exec(i)[1],s=t?.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},Yc=i=>{const{theme:t,prefix:s}=i,r={nextPart:new Map,validators:[]};return Xc(Object.entries(i.classGroups),s).forEach(([a,o])=>{Qs(o,r,a,t)}),r},Qs=(i,t,s,r)=>{i.forEach(n=>{if(typeof n=="string"){const a=n===""?t:ni(t,n);a.classGroupId=s;return}if(typeof n=="function"){if(Zc(n)){Qs(n(r),t,s,r);return}t.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(([a,o])=>{Qs(o,ni(t,a),s,r)})})},ni=(i,t)=>{let s=i;return t.split(br).forEach(r=>{s.nextPart.has(r)||s.nextPart.set(r,{nextPart:new Map,validators:[]}),s=s.nextPart.get(r)}),s},Zc=i=>i.isThemeGetter,Xc=(i,t)=>t?i.map(([s,r])=>{const n=r.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,l])=>[t+o,l])):a);return[s,n]}):i,Qc=i=>{if(i<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,r=new Map;const n=(a,o)=>{s.set(a,o),t++,t>i&&(t=0,r=s,s=new Map)};return{get(a){let o=s.get(a);if(o!==void 0)return o;if((o=r.get(a))!==void 0)return n(a,o),o},set(a,o){s.has(a)?s.set(a,o):n(a,o)}}},mn="!",ed=i=>{const{separator:t,experimentalParseClassName:s}=i,r=t.length===1,n=t[0],a=t.length,o=l=>{const d=[];let c=0,u=0,h;for(let g=0;g<l.length;g++){let j=l[g];if(c===0){if(j===n&&(r||l.slice(g,g+a)===t)){d.push(l.slice(u,g)),u=g+a;continue}if(j==="/"){h=g;continue}}j==="["?c++:j==="]"&&c--}const m=d.length===0?l:l.substring(u),f=m.startsWith(mn),y=f?m.substring(1):m,x=h&&h>u?h-u:void 0;return{modifiers:d,hasImportantModifier:f,baseClassName:y,maybePostfixModifierPosition:x}};return s?l=>s({className:l,parseClassName:o}):o},td=i=>{if(i.length<=1)return i;const t=[];let s=[];return i.forEach(r=>{r[0]==="["?(t.push(...s.sort(),r),s=[]):s.push(r)}),t.push(...s.sort()),t},sd=i=>({cache:Qc(i.cacheSize),parseClassName:ed(i),...Jc(i)}),rd=/\s+/,id=(i,t)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:n}=t,a=[],o=i.trim().split(rd);let l="";for(let d=o.length-1;d>=0;d-=1){const c=o[d],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:f}=s(c);let y=!!f,x=r(y?m.substring(0,f):m);if(!x){if(!y){l=c+(l.length>0?" "+l:l);continue}if(x=r(m),!x){l=c+(l.length>0?" "+l:l);continue}y=!1}const g=td(u).join(":"),j=h?g+mn:g,v=j+x;if(a.includes(v))continue;a.push(v);const w=n(x,y);for(let C=0;C<w.length;++C){const z=w[C];a.push(j+z)}l=c+(l.length>0?" "+l:l)}return l};function nd(){let i=0,t,s,r="";for(;i<arguments.length;)(t=arguments[i++])&&(s=fn(t))&&(r&&(r+=" "),r+=s);return r}const fn=i=>{if(typeof i=="string")return i;let t,s="";for(let r=0;r<i.length;r++)i[r]&&(t=fn(i[r]))&&(s&&(s+=" "),s+=t);return s};function ad(i,...t){let s,r,n,a=o;function o(d){const c=t.reduce((u,h)=>h(u),i());return s=sd(c),r=s.cache.get,n=s.cache.set,a=l,l(d)}function l(d){const c=r(d);if(c)return c;const u=id(d,s);return n(d,u),u}return function(){return a(nd.apply(null,arguments))}}const X=i=>{const t=s=>s[i]||[];return t.isThemeGetter=!0,t},gn=/^\[(?:([a-z-]+):)?(.+)\]$/i,od=/^\d+\/\d+$/,ld=new Set(["px","full","screen"]),cd=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,dd=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ud=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,hd=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,pd=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ee=i=>pt(i)||ld.has(i)||od.test(i),De=i=>vt(i,"length",wd),pt=i=>!!i&&!Number.isNaN(Number(i)),$s=i=>vt(i,"number",pt),Ct=i=>!!i&&Number.isInteger(Number(i)),md=i=>i.endsWith("%")&&pt(i.slice(0,-1)),B=i=>gn.test(i),Ue=i=>cd.test(i),fd=new Set(["length","size","percentage"]),gd=i=>vt(i,fd,xn),xd=i=>vt(i,"position",xn),bd=new Set(["image","url"]),yd=i=>vt(i,bd,kd),vd=i=>vt(i,"",jd),Pt=()=>!0,vt=(i,t,s)=>{const r=gn.exec(i);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):s(r[2]):!1},wd=i=>dd.test(i)&&!ud.test(i),xn=()=>!1,jd=i=>hd.test(i),kd=i=>pd.test(i),Nd=()=>{const i=X("colors"),t=X("spacing"),s=X("blur"),r=X("brightness"),n=X("borderColor"),a=X("borderRadius"),o=X("borderSpacing"),l=X("borderWidth"),d=X("contrast"),c=X("grayscale"),u=X("hueRotate"),h=X("invert"),m=X("gap"),f=X("gradientColorStops"),y=X("gradientColorStopPositions"),x=X("inset"),g=X("margin"),j=X("opacity"),v=X("padding"),w=X("saturate"),C=X("scale"),z=X("sepia"),S=X("skew"),$=X("space"),U=X("translate"),k=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto",B,t],_=()=>[B,t],O=()=>["",Ee,De],b=()=>["auto",pt,B],N=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],F=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>["start","end","center","between","around","evenly","stretch"],I=()=>["","0",B],E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>[pt,B];return{cacheSize:500,separator:":",theme:{colors:[Pt],spacing:[Ee,De],blur:["none","",Ue,B],brightness:P(),borderColor:[i],borderRadius:["none","","full",Ue,B],borderSpacing:_(),borderWidth:O(),contrast:P(),grayscale:I(),hueRotate:P(),invert:I(),gap:_(),gradientColorStops:[i],gradientColorStopPositions:[md,De],inset:T(),margin:T(),opacity:P(),padding:_(),saturate:P(),scale:P(),sepia:I(),skew:P(),space:_(),translate:_()},classGroups:{aspect:[{aspect:["auto","square","video",B]}],container:["container"],columns:[{columns:[Ue]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...N(),B]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ct,B]}],basis:[{basis:T()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",B]}],grow:[{grow:I()}],shrink:[{shrink:I()}],order:[{order:["first","last","none",Ct,B]}],"grid-cols":[{"grid-cols":[Pt]}],"col-start-end":[{col:["auto",{span:["full",Ct,B]},B]}],"col-start":[{"col-start":b()}],"col-end":[{"col-end":b()}],"grid-rows":[{"grid-rows":[Pt]}],"row-start-end":[{row:["auto",{span:[Ct,B]},B]}],"row-start":[{"row-start":b()}],"row-end":[{"row-end":b()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",B]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",B]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...R()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...R(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...R(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[$]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[$]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",B,t]}],"min-w":[{"min-w":[B,t,"min","max","fit"]}],"max-w":[{"max-w":[B,t,"none","full","min","max","fit","prose",{screen:[Ue]},Ue]}],h:[{h:[B,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[B,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[B,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[B,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ue,De]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",$s]}],"font-family":[{font:[Pt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",B]}],"line-clamp":[{"line-clamp":["none",pt,$s]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ee,B]}],"list-image":[{"list-image":["none",B]}],"list-style-type":[{list:["none","disc","decimal",B]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[i]}],"placeholder-opacity":[{"placeholder-opacity":[j]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[i]}],"text-opacity":[{"text-opacity":[j]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...F(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ee,De]}],"underline-offset":[{"underline-offset":["auto",Ee,B]}],"text-decoration-color":[{decoration:[i]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:_()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",B]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",B]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[j]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...N(),xd]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gd]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},yd]}],"bg-color":[{bg:[i]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[j]}],"border-style":[{border:[...F(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[j]}],"divide-style":[{divide:F()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...F()]}],"outline-offset":[{"outline-offset":[Ee,B]}],"outline-w":[{outline:[Ee,De]}],"outline-color":[{outline:[i]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[i]}],"ring-opacity":[{"ring-opacity":[j]}],"ring-offset-w":[{"ring-offset":[Ee,De]}],"ring-offset-color":[{"ring-offset":[i]}],shadow:[{shadow:["","inner","none",Ue,vd]}],"shadow-color":[{shadow:[Pt]}],opacity:[{opacity:[j]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Ue,B]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[z]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[j]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",B]}],duration:[{duration:P()}],ease:[{ease:["linear","in","out","in-out",B]}],delay:[{delay:P()}],animate:[{animate:["none","spin","ping","pulse","bounce",B]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Ct,B]}],"translate-x":[{"translate-x":[U]}],"translate-y":[{"translate-y":[U]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",B]}],accent:[{accent:["auto",i]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",B]}],"caret-color":[{caret:[i]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":_()}],"scroll-mx":[{"scroll-mx":_()}],"scroll-my":[{"scroll-my":_()}],"scroll-ms":[{"scroll-ms":_()}],"scroll-me":[{"scroll-me":_()}],"scroll-mt":[{"scroll-mt":_()}],"scroll-mr":[{"scroll-mr":_()}],"scroll-mb":[{"scroll-mb":_()}],"scroll-ml":[{"scroll-ml":_()}],"scroll-p":[{"scroll-p":_()}],"scroll-px":[{"scroll-px":_()}],"scroll-py":[{"scroll-py":_()}],"scroll-ps":[{"scroll-ps":_()}],"scroll-pe":[{"scroll-pe":_()}],"scroll-pt":[{"scroll-pt":_()}],"scroll-pr":[{"scroll-pr":_()}],"scroll-pb":[{"scroll-pb":_()}],"scroll-pl":[{"scroll-pl":_()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",B]}],fill:[{fill:[i,"none"]}],"stroke-w":[{stroke:[Ee,De,$s]}],stroke:[{stroke:[i,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},_d=ad(Nd);function Ge(...i){return _d(hn(i))}const Sd=i=>{const t=new Date(i),s=new Date,r=t.getTime()-s.getTime();if(r<=0)return"Ended";const n=Math.floor(r/6e4),a=Math.floor(r/36e5),o=Math.floor(r/864e5),l=Math.floor(o/365);if(a>999)if(l>0){const d=o%365;return d>0?`${l}y ${d}d left`:`${l}y left`}else return`${o}d left`;return o>0?`${o}d ${a%24}h left`:a>0?`${a}h left`:n>0?`${n}m left`:"Ending soon"},Cd=Gc("inline-flex items-center justify-center rounded-lg text-sm font-semibold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground shadow-sm",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-3",sm:"h-9 px-4 py-2 text-xs",lg:"h-14 px-8 py-4",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),er=p.forwardRef(({className:i,variant:t,size:s,asChild:r=!1,...n},a)=>{const o=r?En:"button";return e.jsx(o,{className:Ge(Cd({variant:t,size:s,className:i})),ref:a,...n})});er.displayName="Button";const bn=p.forwardRef(({className:i,type:t,...s},r)=>e.jsx("input",{type:t,className:Ge("flex h-12 w-full rounded-lg border border-input bg-background px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i),ref:r,...s}));bn.displayName="Input";const tr=p.forwardRef(({className:i,...t},s)=>e.jsx("div",{ref:s,className:Ge("rounded-xl border bg-card text-card-foreground shadow-sm",i),...t}));tr.displayName="Card";const Pd=p.forwardRef(({className:i,...t},s)=>e.jsx("div",{ref:s,className:Ge("flex flex-col space-y-1.5 p-6",i),...t}));Pd.displayName="CardHeader";const Ed=p.forwardRef(({className:i,...t},s)=>e.jsx("h3",{ref:s,className:Ge("font-semibold leading-none tracking-tight",i),...t}));Ed.displayName="CardTitle";const Td=p.forwardRef(({className:i,...t},s)=>e.jsx("p",{ref:s,className:Ge("text-sm text-muted-foreground",i),...t}));Td.displayName="CardDescription";const sr=p.forwardRef(({className:i,...t},s)=>e.jsx("div",{ref:s,className:Ge("p-6 pt-0",i),...t}));sr.displayName="CardContent";const Ad=p.forwardRef(({className:i,...t},s)=>e.jsx("div",{ref:s,className:Ge("flex items-center p-6 pt-0",i),...t}));Ad.displayName="CardFooter";const Ne=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),Id=(i,t)=>i*t,ai=(...i)=>i.filter(Boolean).join(" "),$d=i=>{const t=i.entry_deadline||i.entryDeadline;if(!t)return"Time remaining unknown";const s=Math.max(0,new Date(t).getTime()-Date.now()),r=Math.floor(s/(1e3*60*60));return s<=0?"Ended":r>=24?`${Math.floor(r/24)}d left`:`${r}h left`},Rd=({prediction:i,isOpen:t,onClose:s})=>{if(!i||!t)return null;const[r,n]=p.useState(""),[a,o]=p.useState(""),[l,d]=p.useState(!1),{user:c}=le(),{getBalance:u,lockFunds:h}=ms(),{placePrediction:m}=yt(),f=u("USD")||0,y=parseFloat(a)||0,x=i?.options?.find(C=>C.id===r),g=x?.current_odds||(x?.total_staked?i?.pool_total/x.total_staked:2),j=x?Id(y,g):0,v=[5,10,25,50,100,250],w=async()=>{if(!r){G.error("Please select a prediction option (Yes or No)");return}if(!y){G.error("Please enter an amount to stake");return}if(y<i.stake_min){G.error(`Minimum stake is ${Ne(i.stake_min)}. Please increase your amount.`);return}if(i.stake_max&&y>i.stake_max){G.error(`Maximum stake is ${Ne(i.stake_max)}. Please reduce your amount.`);return}if(y>f){G.error(`Insufficient balance. You have ${Ne(f)} available, but tried to stake ${Ne(y)}.`);return}if(!c?.id){G.error("You must be logged in to place predictions");return}d(!0);try{await h(y,"USD"),await m(i.id,r,y,c.id),G.success(`Prediction placed successfully! You staked ${Ne(y)} on ${x?.label}.`),s(),o(""),n("")}catch(C){const z=C?.message||"Unknown error occurred";G.error(`Failed to place prediction: ${z}. Please try again.`)}finally{d(!1)}};return e.jsx(je,{mode:"wait",initial:!1,children:t&&e.jsxs(e.Fragment,{children:[e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:s,style:{zIndex:8e3}},"prediction-modal-backdrop"),e.jsx("div",{className:"fixed inset-0 flex items-end justify-center p-4 pb-20",style:{zIndex:8500,pointerEvents:"none"},children:e.jsxs(A.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"w-full max-w-md bg-white rounded-t-2xl shadow-2xl flex flex-col max-h-[75vh]",style:{pointerEvents:"auto"},onClick:C=>C.stopPropagation(),children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Place Prediction"}),e.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close modal",children:e.jsx(ze,{size:20})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base",children:i.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[Ne(i.pool_total||0)," Pool"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[i.participant_count||0," Players"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:$d(i)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Select your prediction:"}),e.jsx("div",{className:"space-y-2",children:(i.options||[]).map(C=>{const z=C.total_staked||0,S=i.pool_total||1,$=S>0?Math.min(z/S*100,100):50,U=C.current_odds||(z>0?S/z:2);return e.jsx(tr,{className:ai("cursor-pointer transition-all border-2",r===C.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"),onClick:()=>n(C.id),children:e.jsx(sr,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:C.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[$.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[U.toFixed(2),"x"]})})]})})},C.id||Math.random())})})]}),e.jsx(je,{mode:"wait",children:r&&e.jsxs(A.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stake amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(bn,{type:"number",placeholder:"0.00",value:a,onChange:C=>o(C.target.value),className:"pl-8 pr-4 h-12 text-lg font-medium",min:i.stake_min,max:i.stake_max||f}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"$"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["Balance: ",Ne(f)]}),e.jsx("button",{onClick:()=>o(f.toString()),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Max"})]})]}),e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:v.map(C=>e.jsxs(er,{variant:"outline",size:"sm",onClick:()=>o(C.toString()),disabled:C>f,className:"text-sm h-10",children:["$",C]},C))})}),y>0&&e.jsx(tr,{className:"bg-green-50 border-green-200",children:e.jsx(sr,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Potential return"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:Ne(j)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Profit"}),e.jsx("div",{className:ai("font-semibold",j>y?"text-green-600":"text-red-600"),children:Ne(j-y)})]})]})})})]},`amount-input-${r}`)})]}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-200 bg-white",children:e.jsx(er,{onClick:w,disabled:!r||!y||l||y>f,className:"w-full h-12 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg flex items-center justify-center",children:l?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Placing..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ln,{size:16}),e.jsxs("span",{children:["Place Prediction (",Ne(y),")"]})]})})})]},"prediction-modal-content")})]})})},yn=he.memo(function({selectedCategory:t,onSelect:s}){const r=[{id:"all",label:"All",icon:"🌟"},{id:"sports",label:"Sports",icon:"⚽"},{id:"pop_culture",label:"Pop Culture",icon:"🎬"},{id:"custom",label:"Custom",icon:"✨"},{id:"politics",label:"Politics",icon:"🗳️"},{id:"crypto",label:"Crypto",icon:"₿"},{id:"tech",label:"Tech",icon:"💻"},{id:"finance",label:"Finance",icon:"📈"}];return e.jsx("div",{className:"category-filters bg-white border-b border-gray-100 px-4 py-3",children:e.jsx("div",{className:"category-filters-container overflow-x-auto -mx-2 px-2",children:e.jsx("div",{className:"category-filters-flex flex gap-2 pb-1",children:r.map(n=>e.jsxs(A.button,{onClick:()=>s(n.id),className:`
                category-pill flex-shrink-0 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium
                transition-all duration-200 whitespace-nowrap
                ${t===n.id?"active bg-green-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
              `,whileTap:{scale:.96},children:[e.jsx("span",{className:"text-xs",children:n.icon}),e.jsx("span",{children:n.label})]},n.id))})})})});yn.displayName="CategoryFilters";const vn=he.memo(function({user:t,stats:s,searchQuery:r,onSearchChange:n,onNavigateToProfile:a}){return e.jsxs("div",{className:"bg-white border-b border-gray-100 sticky top-0 z-50",children:[e.jsx("div",{className:"h-11"}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Discover"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Find your next winning prediction"})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-gradient-to-r from-green-400 to-green-500 flex items-center justify-center text-white font-semibold shadow-lg",children:t?.email?.[0]?.toUpperCase()||"U"})]}),e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"LIVE MARKETS"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["$",s?.totalVolume||"0"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Volume"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:s?.activePredictions||"0"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Live"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:s?.totalUsers||"0"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Players"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Pc,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search predictions...",value:r,onChange:o=>n(o.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-500 focus:bg-white focus:ring-2 focus:ring-green-500 focus:outline-none transition-all"})]})]})]})});vn.displayName="MobileHeader";const wn=he.memo(function({onNavigateToProfile:t,onNavigateToPrediction:s}){const{user:r}=le(),{predictions:n,loading:a,refreshPredictions:o}=yt(),[l,d]=p.useState(""),[c,u]=p.useState("all"),[h,m]=p.useState(null),[f,y]=p.useState(!1),[x,g]=p.useState({totalVolume:"0",activePredictions:0,totalUsers:"0",rawVolume:0,rawUsers:0}),j=p.useCallback(async()=>{try{const O=await fetch("https://fan-club-z.onrender.com/api/v2/predictions/stats/platform");if(O.ok){const b=await O.json();b.success&&(g(b.data),console.log("✅ Platform stats fetched:",b.data))}else console.error("Failed to fetch platform stats:",O.status)}catch(_){console.error("Error fetching platform stats:",_)}},[]);p.useEffect(()=>{o(),j()},[o,j]);const v=p.useMemo(()=>({totalVolume:x.totalVolume,activePredictions:x.activePredictions,totalUsers:x.totalUsers}),[x]),w=p.useMemo(()=>!n||!Array.isArray(n)?(console.log("🔍 DiscoverPage Debug - No valid predictions array:",n),[]):(console.log("🔍 DiscoverPage Debug - Raw predictions:",n.length,"predictions"),n.filter(_=>{if(!_||!_.id||!_.title)return console.warn("⚠️ DiscoverPage: Invalid prediction object:",_),!1;if(c!=="all"&&_.category!==c)return!1;if(l.trim()){const O=(_.title||"").toLowerCase(),b=(_.description||"").toLowerCase(),N=l.toLowerCase();if(!O.includes(N)&&!b.includes(N))return!1}return!0})),[n,c,l]),C=p.useCallback(_=>{m(_),y(!0)},[]),z=p.useCallback(_=>{s?s(_):window.location.href=`/prediction/${_}`},[s]),S=p.useCallback(_=>{ee.success("Prediction liked!")},[]),$=p.useCallback(_=>{z(_)},[z]),U=p.useCallback(_=>{const O=`Check out this prediction: ${_.title}`,b=`${window.location.origin}/prediction/${_.id}`;navigator.share?navigator.share({title:_.title,text:O,url:b}).catch(console.error):navigator.clipboard.writeText(`${O}
${b}`).then(()=>ee.success("Link copied to clipboard!")).catch(()=>ee.error("Failed to copy link"))},[]),k=p.useCallback(_=>{d(_)},[]),V=p.useCallback(_=>{u(_)},[]),T=p.useCallback(()=>{y(!1),m(null)},[]);return a&&(!n||n.length===0)?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-100",children:[e.jsx("div",{className:"h-11"}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 loading-skeleton"})]}),e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full loading-skeleton"})]}),e.jsxs("div",{className:"bg-gray-200 rounded-2xl p-4 mb-4 loading-skeleton",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-20 mb-3 loading-skeleton"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-16 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-12 mx-auto loading-skeleton"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 loading-skeleton"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-14 mx-auto loading-skeleton"})]})]})]}),e.jsx("div",{className:"h-12 bg-gray-200 rounded-xl loading-skeleton"})]})]}),e.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[1,2,3,4,5,6].map(_=>e.jsx("div",{className:"h-8 bg-gray-200 rounded-full w-20 flex-shrink-0 loading-skeleton"},_))})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"px-4 mb-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 loading-skeleton"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 loading-skeleton"})]}),e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(_=>e.jsx(Vc,{},_))})]})]}):e.jsxs("div",{className:"discover-page content-with-bottom-nav",style:{position:"relative",zIndex:1},children:[e.jsx("div",{className:"discover-header",children:e.jsx("div",{className:"header-content",children:e.jsx(vn,{user:r,stats:v,searchQuery:l,onSearchChange:k,onNavigateToProfile:t||(()=>{})})})}),e.jsx("div",{className:"category-filters-wrapper",style:{position:"relative",zIndex:45},children:e.jsx(yn,{selectedCategory:c,onSelect:V})}),e.jsxs("div",{className:"prediction-cards-container",children:[e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:[c==="all"?"All Predictions":`${c} Predictions`,l&&` - "${l}"`]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[w.length," predictions available"]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(je,{mode:"wait",children:w.length>0?w.map((_,O)=>!_||!_.id?(console.warn("⚠️ DiscoverPage: Skipping invalid prediction at index",O),null):e.jsx(qc,{prediction:_,variant:"compact",onPredict:()=>C(_),onLike:()=>S(_.id),onComment:()=>$(_.id),onShare:()=>U(_)},`${_.id}-${O}`)):e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"text-center py-12 px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($e,{size:24,className:"text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No predictions found"}),e.jsx("p",{className:"text-gray-600",children:l?`No predictions match "${l}"`:a?"Loading predictions...":"Try adjusting your filters or check back later"}),!a&&!l&&e.jsx("button",{onClick:()=>o(!0),className:"mt-4 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Refresh Predictions"})]})})})]}),e.jsx(Rd,{prediction:h,isOpen:f,onClose:T})]})});wn.displayName="DiscoverPage";const wt=st((i,t)=>({approvedSources:[],settlementConfigs:{},settlements:{},playerAcceptances:{},disputes:{},auditTimeline:{},loading:!1,error:null,selectedSource:null,settlementModalOpen:!1,disputeModalOpen:!1,fetchApprovedSources:async s=>{i({loading:!0,error:null});try{let r=J.from("approved_sources").select("*").eq("status","approved").order("name");s&&(r=r.eq("category",s));const{data:n,error:a}=await r;if(a)throw a;i({approvedSources:n||[]})}catch(r){console.error("Error fetching approved sources:",r),i({error:"Failed to fetch approved sources"})}finally{i({loading:!1})}},createSettlementConfig:async(s,r)=>{i({loading:!0,error:null});try{const{data:n,error:a}=await J.from("settlement_configs").insert({prediction_id:s,method:r.method||"manual",primary_source_id:r.primary_source_id,backup_source_id:r.backup_source_id,rule_text:r.rule_text||"",timezone:r.timezone||"Africa/Lagos",contingencies:r.contingencies||{},risk_flags:r.risk_flags||[],badges:r.badges||[]}).select().single();if(a)throw a;i(o=>({settlementConfigs:{...o.settlementConfigs,[s]:n}}))}catch(n){console.error("Error creating settlement config:",n),i({error:"Failed to create settlement configuration"})}finally{i({loading:!1})}},fetchSettlement:async s=>{i({loading:!0,error:null});try{const{data:r,error:n}=await J.from("settlements").select("*").eq("prediction_id",s).single();if(n&&n.code!=="PGRST116")throw n;r&&i(a=>({settlements:{...a.settlements,[s]:r}}))}catch(r){console.error("Error fetching settlement:",r),i({error:"Failed to fetch settlement data"})}finally{i({loading:!1})}},updateSettlementState:async(s,r,n,a)=>{i({loading:!0,error:null});try{const{data:o,error:l}=await J.rpc("update_settlement_state",{prediction_uuid:s,new_state:r,outcome_val:n,proof_data:a||{}});if(l)throw l;await t().fetchSettlement(s)}catch(o){console.error("Error updating settlement state:",o),i({error:"Failed to update settlement state"})}finally{i({loading:!1})}},acceptOutcome:async s=>{i({loading:!0,error:null});try{const{data:{user:r}}=await J.auth.getUser();if(!r)throw new Error("User not authenticated");const{error:n}=await J.rpc("record_player_acceptance",{prediction_uuid:s,user_uuid:r.id,action_val:"accepted"});if(n)throw n;await t().fetchPlayerAcceptances(s)}catch(r){console.error("Error accepting outcome:",r),i({error:"Failed to accept outcome"})}finally{i({loading:!1})}},createDispute:async(s,r,n)=>{i({loading:!0,error:null});try{const{data:{user:a}}=await J.auth.getUser();if(!a)throw new Error("User not authenticated");const{error:o}=await J.rpc("create_dispute",{prediction_uuid:s,user_uuid:a.id,reason_val:r,evidence_data:n||[]});if(o)throw o;await t().fetchDisputes(s)}catch(a){console.error("Error creating dispute:",a),i({error:"Failed to create dispute"})}finally{i({loading:!1})}},fetchPlayerAcceptances:async s=>{try{const{data:r,error:n}=await J.from("player_acceptances").select("*").eq("prediction_id",s).order("timestamp",{ascending:!1});if(n)throw n;i(a=>({playerAcceptances:{...a.playerAcceptances,[s]:r||[]}}))}catch(r){console.error("Error fetching player acceptances:",r)}},fetchDisputes:async s=>{try{const{data:r,error:n}=await J.from("disputes").select("*").eq("prediction_id",s).order("opened_at",{ascending:!1});if(n)throw n;i(a=>({disputes:{...a.disputes,[s]:r||[]}}))}catch(r){console.error("Error fetching disputes:",r)}},fetchAuditTimeline:async s=>{try{const{data:r,error:n}=await J.from("audit_timeline").select("*").eq("prediction_id",s).order("timestamp",{ascending:!1});if(n)throw n;i(a=>({auditTimeline:{...a.auditTimeline,[s]:r||[]}}))}catch(r){console.error("Error fetching audit timeline:",r)}},setSelectedSource:s=>i({selectedSource:s}),setSettlementModalOpen:s=>i({settlementModalOpen:s}),setDisputeModalOpen:s=>i({disputeModalOpen:s}),clearError:()=>i({error:null})})),zd=({onNavigateBack:i})=>{const[t,s]=p.useState(1),[r,n]=p.useState(!1),[a,o]=p.useState(!1),{createPrediction:l}=yt(),[,d]=oe();p.useEffect(()=>{We({delay:200})},[]);const[c,u]=p.useState(""),[h,m]=p.useState(""),[f,y]=p.useState(""),[x,g]=p.useState("binary"),[j,v]=p.useState([{id:"1",label:"Yes"},{id:"2",label:"No"}]),[w,C]=p.useState(""),[z,S]=p.useState("1"),[$,U]=p.useState("1000"),[k,V]=p.useState("manual"),[T,_]=p.useState(!1),[O,b]=p.useState(null),[N,F]=p.useState(null),[Y,R]=p.useState(""),[I,E]=p.useState("Africa/Lagos"),[P,W]=p.useState({postponed:"auto_void",source_down:"use_backup"}),K=[{id:"sports",label:"Sports",icon:"⚽",gradient:"from-orange-500 to-red-500"},{id:"politics",label:"Politics",icon:"🏛️",gradient:"from-blue-500 to-indigo-500"},{id:"entertainment",label:"Entertainment",icon:"🎬",gradient:"from-purple-500 to-pink-500"},{id:"crypto",label:"Crypto",icon:"₿",gradient:"from-yellow-500 to-orange-500"},{id:"tech",label:"Technology",icon:"💻",gradient:"from-green-500 to-teal-500"},{id:"custom",label:"Custom",icon:"⚡",gradient:"from-gray-500 to-gray-600"}],te=[{id:"binary",label:"Yes/No",description:"Simple binary outcome prediction",icon:"🎯"},{id:"multiple",label:"Multiple Choice",description:"Multiple possible outcomes",icon:"🎲"}],ce=p.useCallback(()=>{const L=(j.length+1).toString();v(re=>[...re,{id:L,label:""}])},[j.length]),jt=p.useCallback(L=>{v(re=>re.filter(xe=>xe.id!==L))},[]),kt=p.useCallback((L,re)=>{v(xe=>xe.map(ae=>ae.id===L?{...ae,label:re}:ae))},[]),ke=p.useCallback(L=>{switch(L){case 1:return!!(c.trim()&&f);case 2:return!!(x&&j.every(re=>re.label.trim()));case 3:return!!(w&&z);case 4:return!0;default:return!0}},[c,f,x,j,w,z]),bs=p.useCallback(()=>{ke(t)&&t<4&&(s(t+1),We({delay:150}))},[t,ke]),Ht=p.useCallback(()=>{t>1?(s(t-1),We({delay:150})):i&&i()},[t,i]),ys=p.useCallback(async()=>{if(!ke(4)){G.error("Please fill in all required fields");return}n(!0);try{if(!c.trim())throw new Error("Title is required");if(!f)throw new Error("Category is required");if(!w)throw new Error("Entry deadline is required");const L=new Date(w);if(L<=new Date)throw new Error("Entry deadline must be in the future");const re={title:c.trim(),description:h.trim()||void 0,category:f,type:x,options:j.filter(ae=>ae.label.trim()).map(ae=>({id:ae.id,label:ae.label.trim(),totalStaked:0,currentOdds:2})),entryDeadline:L,stakeMin:Math.max(1,parseFloat(z)||100),stakeMax:$?Math.max(parseFloat(z)||100,parseFloat($)):void 0,settlementMethod:k,isPrivate:T};if(re.options.length<2)throw new Error("At least 2 prediction options are required");console.log("Creating prediction with data:",re);const xe=await l(re);if(console.log("Prediction created successfully!",xe),k==="auto"&&xe)try{const{createSettlementConfig:ae}=wt.getState();await ae(xe.id,{method:"web",primary_source_id:O?.id,backup_source_id:N?.id,rule_text:Y||`Check if ${c} by ${w}`,timezone:I,contingencies:P}),console.log("Settlement configuration created successfully!")}catch(ae){console.error("Failed to create settlement configuration:",ae)}G.success("🎉 Prediction created successfully!"),o(!0),setTimeout(()=>{s(1),u(""),m(""),y(""),g("binary"),v([{id:"1",label:"Yes"},{id:"2",label:"No"}]),C(""),S("100"),U("10000"),V("manual"),_(!1),o(!1),n(!1),i&&(i(),setTimeout(()=>{d("/predictions")},100))},2e3)}catch(L){console.error("Failed to create prediction:",L);const re=L instanceof Error?L.message:"Failed to create prediction. Please try again.";G.error(re),n(!1)}},[ke,c,f,w,h,x,j,z,$,k,T,l,i,d]);return a?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-green-100 flex items-center justify-center px-6",children:e.jsxs(A.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white rounded-3xl p-8 text-center shadow-2xl border border-green-200",children:[e.jsx(A.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200,damping:10},className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Qr,{size:32,className:"text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Prediction Created!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Your prediction has been successfully created and is now live."}),e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Redirecting to My Predictions..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 pb-20 create-prediction-page",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-600 via-green-700 to-teal-600"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 via-transparent to-purple-600/10"}),e.jsx("div",{className:"absolute top-0 right-1/3 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 left-1/3 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),e.jsxs("div",{className:"relative z-10 px-6 pt-14 pb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(A.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:Ht,className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white",children:e.jsx(Wt,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Create Prediction"}),e.jsxs("p",{className:"text-green-100",children:["Step ",t," of 4"]})]})]}),e.jsx("div",{className:"bg-white/20 rounded-full h-2 mb-6",children:e.jsx(A.div,{initial:{width:0},animate:{width:`${t/4*100}%`},transition:{duration:.5},className:"h-full bg-white rounded-full"})})]})]}),e.jsx("div",{className:"px-6 -mt-4 pb-8 relative z-20",children:e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/90 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-2xl p-6",children:[e.jsxs(je,{mode:"wait",initial:!1,children:[t===1&&e.jsxs(A.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl flex items-center justify-center",children:e.jsx(xr,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Basic Information"}),e.jsx("p",{className:"text-gray-600",children:"Tell us about your prediction"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"input-container",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Prediction Title *"}),e.jsx("input",{type:"text",value:c,onChange:L=>u(L.target.value),placeholder:"Will Bitcoin reach $100,000 by end of 2024?",className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-green-500 focus:outline-none transition-all duration-200 text-gray-900 placeholder-gray-500"})]}),e.jsxs("div",{className:"textarea-container",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{value:h,onChange:L=>m(L.target.value),placeholder:"Provide additional context and rules for your prediction...",rows:4,className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-green-500 focus:outline-none transition-all duration-200 text-gray-900 placeholder-gray-500 resize-none"})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Category *"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:K.map(L=>e.jsxs(A.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>y(L.id),className:`motion-button pill-category px-4 py-2.5 rounded-full text-sm font-semibold transition-all flex items-center gap-2 min-h-[40px] ${f===L.id?`bg-gradient-to-r ${L.gradient} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"}`,children:[e.jsx("span",{className:"text-base",children:L.icon}),e.jsx("span",{children:L.label})]},L.id))})]})]})]},"step1"),t===2&&e.jsxs(A.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center",children:e.jsx(is,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Prediction Setup"}),e.jsx("p",{className:"text-gray-600",children:"Configure your prediction options"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Prediction Type *"}),e.jsx("div",{className:"space-y-3",children:te.map(L=>e.jsx(A.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>{g(L.id),L.id==="binary"?v([{id:"1",label:"Yes"},{id:"2",label:"No"}]):L.id==="multiple"&&v([{id:"1",label:""},{id:"2",label:""},{id:"3",label:""}])},className:`motion-button w-full p-4 rounded-2xl border-2 text-left transition-all duration-200 ${x===L.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-2xl",children:L.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:L.label}),e.jsx("p",{className:"text-sm text-gray-600",children:L.description})]})]})},L.id))})]}),(x==="binary"||x==="multiple")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Prediction Options *"}),e.jsxs("div",{className:"space-y-3",children:[j.map((L,re)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"input-container flex-1",children:e.jsx("input",{type:"text",value:L.label,onChange:xe=>kt(L.id,xe.target.value),placeholder:`Option ${re+1}`,className:"w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all duration-200"})}),x==="multiple"&&j.length>2&&e.jsx(A.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>jt(L.id),className:"motion-button w-10 h-10 bg-red-100 text-red-600 rounded-xl flex items-center justify-center hover:bg-red-200 transition-colors",children:e.jsx(ze,{size:18})})]},L.id)),x==="multiple"&&j.length<6&&e.jsxs(A.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:ce,className:"motion-button w-full p-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-600 hover:border-blue-400 hover:text-blue-600 transition-all duration-200 flex items-center justify-center gap-2",children:[e.jsx(Ot,{size:18}),e.jsx("span",{children:"Add Option"})]})]})]})]})]},"step2"),t===3&&e.jsxs(A.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center",children:e.jsx(ft,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Settings & Launch"}),e.jsx("p",{className:"text-gray-600",children:"Final configuration details"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"input-container",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Entry Deadline *"}),e.jsx("input",{type:"datetime-local",value:w,onChange:L=>C(L.target.value),min:new Date().toISOString().slice(0,16),className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-green-500 focus:outline-none transition-all duration-200"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"input-container",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Minimum Stake ($)"}),e.jsx("input",{type:"number",value:z,onChange:L=>S(L.target.value),placeholder:"100",min:"1",className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-green-500 focus:outline-none transition-all duration-200"})]}),e.jsxs("div",{className:"input-container",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Maximum Stake ($)"}),e.jsx("input",{type:"number",value:$,onChange:L=>U(L.target.value),placeholder:"100000",min:z||"1",className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-green-500 focus:outline-none transition-all duration-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Settlement Method"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(A.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>V("manual"),className:`w-full p-4 rounded-2xl border-2 text-left transition-all duration-200 ${k==="manual"?"border-green-500 bg-green-50":"border-gray-200 bg-white hover:border-green-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx($t,{size:16,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Manual Settlement"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You resolve the prediction manually"})]})]})}),e.jsx(A.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>V("auto"),className:`w-full p-4 rounded-2xl border-2 text-left transition-all duration-200 ${k==="auto"?"border-green-500 bg-green-50":"border-gray-200 bg-white hover:border-green-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(is,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Automatic Settlement"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Resolved automatically when possible"})]})]})})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Private Prediction"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Only people with link can participate"})]}),e.jsx(A.button,{whileTap:{scale:.95},onClick:()=>_(!T),className:`relative w-12 h-6 rounded-full transition-all duration-200 ${T?"bg-green-500":"bg-gray-300"}`,children:e.jsx(A.div,{animate:{x:T?24:2},transition:{type:"spring",stiffness:500,damping:30},className:"absolute top-1 w-4 h-4 bg-white rounded-full shadow"})})]})})]})]},"step3"),t===4&&e.jsxs(A.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center",children:e.jsx(Qr,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Preview & Confirm"}),e.jsx("p",{className:"text-gray-600",children:"Review your prediction before publishing"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Prediction Preview"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Title"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:c})]}),h&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-700",children:h})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Category"}),e.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:K.find(L=>L.id===f)?.label||f})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Options"}),e.jsx("div",{className:"space-y-2",children:j.map((L,re)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Option ",re+1,":"]}),e.jsx("span",{className:"font-semibold text-gray-900",children:L.label})]},L.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Stake Limits"}),e.jsxs("p",{className:"text-gray-900",children:["$",z," - $",$]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Deadline"}),e.jsx("p",{className:"text-gray-900",children:new Date(w).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Settlement"}),e.jsx("p",{className:"text-gray-900 capitalize",children:k})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Privacy"}),e.jsx("p",{className:"text-gray-900",children:T?"Private":"Public"})]})]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Lt,{size:20,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800",children:"Ready to Publish"}),e.jsx("p",{className:"text-sm text-green-700",children:'Your prediction looks good! Click "Create Prediction" to publish it.'})]})]})})]})]},"step4")]}),e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[e.jsx(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Ht,className:"px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-all duration-200",children:t===1?"Cancel":"Back"}),t<4?e.jsx(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:bs,disabled:!ke(t),className:`px-8 py-3 font-semibold rounded-xl shadow-lg transition-all duration-200 ${ke(t)?"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-green-500/25 hover:shadow-xl hover:shadow-green-500/30":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:t===3?"Preview":"Continue"}):e.jsx(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ys,disabled:!ke(4)||r,className:`px-8 py-3 font-semibold rounded-xl shadow-lg transition-all duration-200 flex items-center gap-2 ${ke(4)&&!r?"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-green-500/25 hover:shadow-xl hover:shadow-green-500/30":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):"Create Prediction"})]})]})})]})};let Ld=0;const Od=()=>{const[i,t]=p.useState([]),s=p.useCallback(a=>{const o=(++Ld).toString(),l={id:o,duration:5e3,...a};return t(d=>[...d,l]),setTimeout(()=>{t(d=>d.filter(c=>c.id!==o))},l.duration),o},[]),r=p.useCallback(a=>{t(o=>o.filter(l=>l.id!==a))},[]),n=p.useCallback(()=>{t([])},[]);return{toast:s,dismiss:r,dismissAll:n,toasts:i}},Dd=({isOpen:i,onClose:t,prediction:s})=>{const[r,n]=p.useState("overview"),[a,o]=p.useState(!0),[l,d]=p.useState(!0),[c,u]=p.useState(!0),[h,m]=p.useState([]),[f,y]=p.useState([]),[x,g]=p.useState(!1),[j,v]=p.useState(!1),{updatePrediction:w,deletePrediction:C,closePrediction:z,fetchPredictionActivity:S,fetchPredictionParticipants:$}=yt(),{toast:U}=Od(),k=[{id:"overview",label:"Overview",icon:Xr},{id:"settings",label:"Settings",icon:is},{id:"participants",label:"Participants",icon:$t}];p.useEffect(()=>{i&&s.id&&V()},[i,s.id]);const V=async()=>{g(!0);try{const[E,P]=await Promise.all([S(String(s.id)),$(String(s.id))]);m(E),y(P)}catch(E){console.error("Failed to load prediction data:",E),U({title:"Error",description:"Failed to load prediction data. Using cached information.",variant:"destructive"})}finally{g(!1)}},T=()=>{t()},_=async()=>{try{const E=prompt("Enter new title:",s.title);E&&E!==s.title&&(g(!0),await w(String(s.id),{title:E}),U({title:"Success",description:"Prediction updated successfully!",variant:"default"}),t())}catch(E){console.error("Failed to update prediction:",E),U({title:"Error",description:E instanceof Error?E.message:"Failed to update prediction",variant:"destructive"})}finally{g(!1)}},O=async()=>{if(window.confirm("Are you sure you want to delete this prediction? This action cannot be undone."))try{g(!0),await C(String(s.id)),U({title:"Success",description:"Prediction deleted successfully!",variant:"default"}),t()}catch(E){console.error("Failed to delete prediction:",E),U({title:"Error",description:E instanceof Error?E.message:"Failed to delete prediction",variant:"destructive"})}finally{g(!1)}},b=async()=>{if(window.confirm("Are you sure you want to close this prediction early? No new participants will be able to join."))try{g(!0),await z(String(s.id)),U({title:"Success",description:"Prediction closed successfully!",variant:"default"}),t()}catch(E){console.error("Failed to close prediction:",E),U({title:"Error",description:E instanceof Error?E.message:"Failed to close prediction",variant:"destructive"})}finally{g(!1)}},N=()=>{const E=`${window.location.origin}/predictions/${s.id}`;navigator.clipboard.writeText(E),U({title:"Link Copied",description:"Prediction link copied to clipboard!",variant:"default"})},F=async()=>{try{v(!0),await w(String(s.id),{is_private:!l}),U({title:"Settings Saved",description:"Your prediction settings have been updated.",variant:"default"})}catch(E){console.error("Failed to save settings:",E),U({title:"Error",description:"Failed to save settings. Please try again.",variant:"destructive"})}finally{v(!1)}},Y=()=>{const E=s.pool_total||s.totalPool||0,P=s.participant_count||s.participants||0,W=s.creator_fee_percentage||s.yourCut||3.5,K=E*W/100;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ft,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Total Pool"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",E.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["Your cut: ",W,"%"]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($t,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Participants"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:P}),e.jsx("div",{className:"text-sm text-green-600",children:"Active predictors"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(He,{className:"w-5 h-5 text-amber-600"}),e.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Time Remaining"})]}),e.jsx("div",{className:"text-xl font-bold text-amber-900",children:s.timeRemaining}),e.jsx("div",{className:"text-sm text-amber-600",children:"Until prediction closes"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xr,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Your Earnings"})]}),e.jsxs("div",{className:"text-xl font-bold text-purple-900",children:["$",K.toLocaleString()]}),e.jsx("div",{className:"text-sm text-purple-600",children:"Current projected"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Recent Activity"}),e.jsx("div",{className:"space-y-3",children:x?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading activity..."})]}):h.length>0?h.map(te=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${te.type==="participant_joined"||te.type==="multiple_participants"?"bg-blue-100":"bg-green-100"}`,children:te.type==="participant_joined"||te.type==="multiple_participants"?e.jsx($t,{className:"w-4 h-4 text-blue-600"}):e.jsx(ft,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:te.description}),e.jsx("p",{className:"text-xs text-gray-500",children:te.timeAgo})]})]}),te.amount&&e.jsxs("span",{className:"text-sm text-green-600 font-medium",children:["+$",te.amount.toLocaleString()]})]},te.id)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"})})})]})]})},R=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Prediction Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Auto-close prediction"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Automatically close when time expires"})]}),e.jsx("div",{className:`relative inline-block w-10 h-6 cursor-pointer transition-colors duration-200 rounded-full ${c?"bg-green-500":"bg-gray-300"}`,onClick:()=>u(!c),children:e.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow transition-transform duration-200 ${c?"transform translate-x-4":"transform translate-x-0"} mt-1 ml-1`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Email notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Get notified of new participants"})]}),e.jsx("div",{className:`relative inline-block w-10 h-6 cursor-pointer transition-colors duration-200 rounded-full ${a?"bg-green-500":"bg-gray-300"}`,onClick:()=>o(!a),children:e.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow transition-transform duration-200 ${a?"transform translate-x-4":"transform translate-x-0"} mt-1 ml-1`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Public visibility"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Show in public prediction feeds"})]}),e.jsx("div",{className:`relative inline-block w-10 h-6 cursor-pointer transition-colors duration-200 rounded-full ${l?"bg-green-500":"bg-gray-300"}`,onClick:()=>d(!l),children:e.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow transition-transform duration-200 ${l?"transform translate-x-4":"transform translate-x-0"} mt-1 ml-1`})})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsx(A.button,{onClick:F,disabled:j,className:"w-full flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",whileHover:{scale:1.01},whileTap:{scale:.99},children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"w-4 h-4"}),"Save Settings"]})})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Advanced Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(A.button,{onClick:_,disabled:x,className:"w-full flex items-center justify-between p-3 text-left hover:bg-gray-50 rounded-lg transition-colors disabled:opacity-50",whileHover:{scale:1.01},whileTap:{scale:.99},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sn,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Edit prediction"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Modify title, description, or settings"})]})]})}),e.jsx(A.button,{onClick:b,disabled:x||s.status!=="open",className:"w-full flex items-center justify-between p-3 text-left hover:bg-gray-50 rounded-lg transition-colors disabled:opacity-50",whileHover:{scale:1.01},whileTap:{scale:.99},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{className:"w-5 h-5 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Close early"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Stop accepting new participants"})]})]})}),e.jsx(A.button,{onClick:O,disabled:x,className:"w-full flex items-center justify-between p-3 text-left hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",whileHover:{scale:1.01},whileTap:{scale:.99},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(an,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-900",children:"Delete prediction"}),e.jsx("p",{className:"text-sm text-red-600",children:"Permanently remove this prediction"})]})]})})]})]})]}),I=()=>{const E=s.participant_count||s.participants||0,P=s.pool_total||s.totalPool||0;return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Participants Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:E}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Participants"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",P.toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Pool"})]})]}),e.jsx("div",{className:"space-y-3",children:x?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading participants..."})]}):f.length>0?f.map((W,K)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-semibold ${K===0?"bg-blue-100 text-blue-600":K===1?"bg-green-100 text-green-600":K===2?"bg-purple-100 text-purple-600":K===3?"bg-orange-100 text-orange-600":"bg-gray-100 text-gray-600"}`,children:String.fromCharCode(65+K)}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["@",W.username]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Joined ",W.timeAgo]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["$",W.amount.toLocaleString()]}),e.jsx("p",{className:`text-sm ${W.option==="Yes"?"text-green-600":"text-red-600"}`,children:W.option})]})]},W.id)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No participants yet"})})})]})})};return e.jsx(je,{children:i&&e.jsxs(e.Fragment,{children:[e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T,className:"fixed inset-0 bg-black/50 z-50"}),e.jsx(A.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 truncate",children:"Manage Prediction"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",children:s.title})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(A.button,{onClick:N,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(rn,{className:"w-5 h-5"})}),e.jsx(A.button,{onClick:T,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(ze,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex border-b border-gray-200",children:k.map(E=>{const P=E.icon;return e.jsxs("button",{onClick:()=>n(E.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${r===E.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:E.label})]},E.id)})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[r==="overview"&&e.jsx(Y,{}),r==="settings"&&e.jsx(R,{}),r==="participants"&&e.jsx(I,{})]})]})})]})})},Ud=({onNavigateToDiscover:i})=>{const[,t]=oe(),{predictions:s,getUserCreatedPredictions:r,fetchUserCreatedPredictions:n,fetchUserPredictionEntries:a,getUserPredictionEntries:o,loading:l}=yt(),{user:d,isAuthenticated:c}=le(),u=b=>{if(!b)return"2d 14h";const N=new Date().getTime(),Y=new Date(b).getTime()-N;if(Y<=0)return"Ended";const R=Math.floor(Y/(1e3*60*60*24)),I=Math.floor(Y%(1e3*60*60*24)/(1e3*60*60));return R>0?`${R}d ${I}h`:`${I}h`},h=b=>{if(!b||!b.options)return 68;const N=b.options.reduce((Y,R)=>Y+(R.total_staked||0),0);if(N===0)return 68;const F=Math.max(...b.options.map(Y=>Y.total_staked||0));return Math.round(F/N*100)};p.useEffect(()=>{We({behavior:"instant"})},[]),p.useEffect(()=>{if(d?.id&&c){const b=setTimeout(()=>{n(d.id),a(d.id)},100);return()=>clearTimeout(b)}},[d?.id,c,n,a]);const[m,f]=p.useState("Active"),[y,x]=p.useState(!1),[g,j]=p.useState(null),w=(()=>{if(!c||!d)return{active:0,created:0,completed:0};const b=r(d.id),N=o(d.id),F=N.filter(R=>R.status==="active"),Y=N.filter(R=>R.status==="won"||R.status==="lost");return{active:F.length,created:b.length,completed:Y.length}})(),C=[{id:"Active",label:"Active",icon:$e,count:w.active},{id:"Created",label:"Created",icon:As,count:w.created},{id:"Completed",label:"Completed",icon:Lt,count:w.completed}],z=()=>{if(!c||!d)return{Active:[],Created:[],Completed:[]};const b=o(d.id),N=r(d.id),F=b.filter(I=>I.status==="active").map(I=>{const E=s.find(K=>K.id===I.prediction_id);if(!E)return null;const P=E.options?.find(K=>K.id===I.option_id),W=u(E.entry_deadline);return{id:I.id,title:E.title,category:E.category,position:P?.label||"Unknown",stake:I.amount,potentialReturn:I.potential_payout||0,odds:I.potential_payout?`${(I.potential_payout/I.amount).toFixed(2)}x`:"1.00x",timeRemaining:W,status:"active",participants:E.participant_count||0,confidence:h(E)}}).filter(Boolean),Y=N.map(I=>{const E=u(I.entry_deadline);return{id:I.id,title:I.title,category:I.category,totalPool:I.pool_total||0,participants:I.participant_count||0,timeRemaining:E,status:I.status,yourCut:I.creator_fee_percentage||3.5,description:I.description,pool_total:I.pool_total,participant_count:I.participant_count,creator_fee_percentage:I.creator_fee_percentage,entry_deadline:I.entry_deadline}}),R=b.filter(I=>I.status==="won"||I.status==="lost").map(I=>{const E=s.find(K=>K.id===I.prediction_id);if(!E)return null;const P=E.options?.find(K=>K.id===I.option_id),W=(I.actual_payout||0)-I.amount;return{id:I.id,title:E.title,category:E.category,position:P?.label||"Unknown",stake:I.amount,actualReturn:I.actual_payout||0,profit:W,status:I.status,participants:E.participant_count||0,settledAt:new Date(I.updated_at).toLocaleDateString()}}).filter(Boolean);return{Active:F,Created:Y,Completed:R}},$=p.useMemo(()=>{try{return z()}catch(b){return console.error("Error getting user predictions:",b),{Active:[],Created:[],Completed:[]}}},[d?.id,c,s,m])[m]||[],U=b=>{switch(b){case"active":return"bg-emerald-50 text-emerald-700 border-emerald-200";case"winning":return"bg-green-50 text-green-700 border-green-200";case"losing":return"bg-red-50 text-red-700 border-red-200";case"open":return"bg-blue-50 text-blue-700 border-blue-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}},k=b=>({custom:"bg-orange-100 text-orange-700",sports:"bg-blue-100 text-blue-700",esports:"bg-purple-100 text-purple-700",pop_culture:"bg-pink-100 text-pink-700",politics:"bg-red-100 text-red-700",celebrity_gossip:"bg-green-100 text-green-700"})[b]||"bg-gray-100 text-gray-700";if(!c)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6 pt-12 pb-6",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"My Predictions"})})}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(As,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Sign in to view your predictions"}),e.jsx("p",{className:"text-gray-600 text-center mb-8 max-w-sm",children:"Create an account or sign in to track your predictions, manage your portfolio, and engage with the community."}),e.jsxs(A.button,{className:"bg-emerald-500 hover:bg-emerald-600 text-white px-8 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2",onClick:()=>{i&&i()},whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Ot,{className:"w-5 h-5"}),"Explore Predictions"]})]})]});const V=({tab:b})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[e.jsxs("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:[b==="Active"&&e.jsx($e,{className:"w-10 h-10 text-gray-400"}),b==="Created"&&e.jsx(As,{className:"w-10 h-10 text-gray-400"}),b==="Completed"&&e.jsx(Lt,{className:"w-10 h-10 text-gray-400"})]}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:["No ",b.toLowerCase()," predictions"]}),e.jsxs("p",{className:"text-gray-600 text-center mb-8 max-w-sm",children:[b==="Active"&&"You haven't made any predictions yet. Start by exploring trending topics!",b==="Created"&&"You haven't created any predictions yet. Share your insights with the community!",b==="Completed"&&"Your prediction history will appear here once you complete some predictions."]}),e.jsxs(A.button,{className:"bg-emerald-500 hover:bg-emerald-600 text-white px-8 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2",onClick:()=>{b==="Created"?(t("/create"),We({behavior:"instant"})):i&&i()},whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Ot,{className:"w-5 h-5"}),b==="Created"?"Create Prediction":"Explore Predictions"]})]}),T=({prediction:b})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-4 hover:shadow-md transition-all duration-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${k(b.category)}`,children:b.category.replace("_"," ")}),e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium border ${U(b.status)}`,children:"Active"})]}),e.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:b.title})]})}),e.jsxs("div",{className:"bg-emerald-50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-emerald-800",children:"Your Position"}),e.jsx("span",{className:"text-lg font-bold text-emerald-700",children:b.position})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"Staked"}),e.jsxs("p",{className:"font-semibold text-emerald-900",children:["$",b.stake.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"Potential"}),e.jsxs("p",{className:"font-semibold text-emerald-900",children:["$",b.potentialReturn.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"Odds"}),e.jsx("p",{className:"font-semibold text-emerald-900",children:b.odds})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Market Confidence"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[b.confidence,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:`${b.confidence}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:[b.participants," participants"]}),e.jsxs("span",{className:"font-medium text-amber-600",children:[b.timeRemaining," left"]})]})]}),_=({prediction:b})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-4 hover:shadow-md transition-all duration-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${k(b.category)}`,children:b.category.replace("_"," ")}),e.jsx("span",{className:"px-2 py-1 rounded-lg text-xs font-medium border bg-blue-50 text-blue-700 border-blue-200",children:b.status==="open"?"Open":b.status})]}),e.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:b.title})]})}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Total Pool"}),e.jsxs("p",{className:"font-semibold text-blue-900",children:["$",b.totalPool.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Participants"}),e.jsx("p",{className:"font-semibold text-blue-900",children:b.participants})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Your Cut"}),e.jsxs("p",{className:"font-semibold text-blue-900",children:[b.yourCut,"%"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Closes in ",b.timeRemaining]}),e.jsxs(A.button,{onClick:()=>{j(b),x(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium text-sm flex items-center gap-1 hover:bg-blue-700 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:["Manage ",e.jsx(xc,{className:"w-4 h-4"})]})]})]}),O=({prediction:b})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-4 hover:shadow-md transition-all duration-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${k(b.category)}`,children:b.category.replace("_"," ")}),e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium border ${b.status==="won"?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:b.status==="won"?"Won":"Lost"})]}),e.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:b.title})]})}),e.jsxs("div",{className:`rounded-xl p-4 mb-4 ${b.status==="won"?"bg-green-50":"bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`text-sm font-medium ${b.status==="won"?"text-green-800":"text-red-800"}`,children:["Your Position: ",b.position]}),e.jsxs("span",{className:`text-lg font-bold ${b.status==="won"?"text-green-700":"text-red-700"}`,children:[b.profit>=0?"+":"","$",Math.abs(b.profit).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-xs mb-1 ${b.status==="won"?"text-green-600":"text-red-600"}`,children:"Staked"}),e.jsxs("p",{className:`font-semibold ${b.status==="won"?"text-green-900":"text-red-900"}`,children:["$",b.stake.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs mb-1 ${b.status==="won"?"text-green-600":"text-red-600"}`,children:"Returned"}),e.jsxs("p",{className:`font-semibold ${b.status==="won"?"text-green-900":"text-red-900"}`,children:["$",b.actualReturn.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs mb-1 ${b.status==="won"?"text-green-600":"text-red-600"}`,children:"Profit/Loss"}),e.jsxs("p",{className:`font-semibold ${b.status==="won"?"text-green-900":"text-red-900"}`,children:[b.profit>=0?"+":"","$",Math.abs(b.profit).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:[b.participants," participants"]}),e.jsxs("span",{children:["Settled ",b.settledAt]})]})]});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"px-6 pt-12 pb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"My Predictions"}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-xl",children:C.map(b=>{const N=b.icon;return e.jsxs("button",{onClick:()=>f(b.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ${m===b.id?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:b.label}),b.count>0&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${m===b.id?"bg-emerald-100 text-emerald-700":"bg-gray-200 text-gray-600"}`,children:b.count})]},b.id)})})]})}),e.jsx("div",{className:"px-6 py-6",children:l?e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading predictions..."})]}):$.length>0?e.jsxs("div",{className:"space-y-4",children:[m==="Active"&&$.map((b,N)=>!b||typeof b.id>"u"?(console.warn("Invalid prediction object:",b),null):e.jsx(T,{prediction:b},`active-${b.id}-${N}`)),m==="Created"&&$.map((b,N)=>!b||typeof b.id>"u"?(console.warn("Invalid prediction object:",b),null):e.jsx(_,{prediction:b},`created-${b.id}-${N}`)),m==="Completed"&&$.map((b,N)=>!b||typeof b.id>"u"?(console.warn("Invalid prediction object:",b),null):e.jsx(O,{prediction:b},`completed-${b.id}-${N}`))]}):e.jsx(V,{tab:m})}),g&&e.jsx(Dd,{isOpen:y,onClose:()=>{x(!1),j(null)},prediction:{id:g.id,title:g.title,category:g.category,totalPool:g.totalPool||g.pool_total||0,participants:g.participants||g.participant_count||0,timeRemaining:g.timeRemaining||"0h",yourCut:g.yourCut||g.creator_fee_percentage||3.5,status:g.status||"open",description:g.description,pool_total:g.pool_total||g.totalPool,participant_count:g.participant_count||g.participants,creator_fee_percentage:g.creator_fee_percentage||g.yourCut,entry_deadline:g.entry_deadline}})]})};class Md{constructor(t){se(this,"options");se(this,"element");se(this,"startY",0);se(this,"currentY",0);se(this,"pullDistance",0);se(this,"isRefreshing",!1);se(this,"isPulling",!1);se(this,"rafId",null);se(this,"indicatorElement",null);se(this,"disabled",!1);this.options={threshold:80,element:document.body,disabled:!1,...t},this.element=this.options.element,this.disabled=this.options.disabled,this.init()}init(){this.createIndicator(),this.bindEvents()}createIndicator(){this.indicatorElement=document.createElement("div"),this.indicatorElement.className="pull-to-refresh-indicator",this.indicatorElement.innerHTML=`
      <div class="pull-to-refresh-content">
        <div class="pull-to-refresh-icon">
          <svg class="pull-to-refresh-arrow" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12l7-7 7 7"/>
          </svg>
          <svg class="pull-to-refresh-spinner" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-6.219-8.56"/>
          </svg>
        </div>
        <span class="pull-to-refresh-text">Pull to refresh</span>
      </div>
    `;const t=document.createElement("style");t.textContent=`
      .pull-to-refresh-indicator {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 80px;
        background: linear-gradient(135deg, #10b981, #059669);
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-80px);
        transition: transform 0.2s ease;
        z-index: 9999;
        color: white;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .pull-to-refresh-indicator.visible {
        transform: translateY(0);
      }
      
      .pull-to-refresh-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      
      .pull-to-refresh-icon {
        position: relative;
        width: 24px;
        height: 24px;
      }
      
      .pull-to-refresh-arrow,
      .pull-to-refresh-spinner {
        position: absolute;
        top: 0;
        left: 0;
        transition: opacity 0.2s ease, transform 0.2s ease;
      }
      
      .pull-to-refresh-arrow {
        opacity: 1;
        transform: rotate(180deg);
      }
      
      .pull-to-refresh-spinner {
        opacity: 0;
        animation: spin 1s linear infinite;
      }
      
      .pull-to-refresh-indicator.refreshing .pull-to-refresh-arrow {
        opacity: 0;
      }
      
      .pull-to-refresh-indicator.refreshing .pull-to-refresh-spinner {
        opacity: 1;
      }
      
      .pull-to-refresh-indicator.ready .pull-to-refresh-arrow {
        transform: rotate(0deg);
      }
      
      .pull-to-refresh-text {
        font-size: 14px;
        font-weight: 500;
      }
      
      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
    `,document.head.querySelector("#pull-to-refresh-styles")||(t.id="pull-to-refresh-styles",document.head.appendChild(t)),document.body.appendChild(this.indicatorElement)}bindEvents(){this.element.addEventListener("touchstart",this.onTouchStart.bind(this),{passive:!0}),this.element.addEventListener("touchmove",this.onTouchMove.bind(this),{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd.bind(this))}unbindEvents(){this.element.removeEventListener("touchstart",this.onTouchStart.bind(this)),this.element.removeEventListener("touchmove",this.onTouchMove.bind(this)),this.element.removeEventListener("touchend",this.onTouchEnd.bind(this))}findScrollableParent(t){let s=t.parentElement;for(;s;){const n=window.getComputedStyle(s).overflowY;if(n==="auto"||n==="scroll"||s.scrollHeight>s.clientHeight)return s;s=s.parentElement}return null}onTouchStart(t){if(this.disabled||this.isRefreshing||window.scrollY>5)return;const s=t.target,r=this.findScrollableParent(s);r&&r.scrollTop>5||(this.startY=t.touches[0].clientY,this.isPulling=!1)}onTouchMove(t){if(this.disabled||this.isRefreshing)return;this.currentY=t.touches[0].clientY,this.pullDistance=Math.max(0,this.currentY-this.startY);const s=window.scrollY<=5,r=t.target,n=this.findScrollableParent(r),a=!n||n.scrollTop<=5;this.pullDistance>50&&s&&a&&(t.preventDefault(),this.isPulling=!0,this.updateIndicator())}onTouchEnd(){this.disabled||this.isRefreshing||!this.isPulling||(this.pullDistance>=this.options.threshold?this.refresh():this.resetIndicator(),this.isPulling=!1,this.pullDistance=0)}updateIndicator(){if(!this.indicatorElement)return;const t=Math.min(1,this.pullDistance/this.options.threshold),s=Math.min(0,t*80-80);this.indicatorElement.style.transform=`translateY(${s}px)`,this.pullDistance>=this.options.threshold?(this.indicatorElement.classList.add("ready"),this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Release to refresh"):(this.indicatorElement.classList.remove("ready"),this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Pull to refresh")}async refresh(){if(this.indicatorElement){this.isRefreshing=!0,this.indicatorElement.classList.add("refreshing","visible"),this.indicatorElement.style.transform="translateY(0)",this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Refreshing...";try{await this.options.onRefresh()}catch(t){console.error("Pull to refresh error:",t)}await new Promise(t=>setTimeout(t,1e3)),this.resetIndicator()}}resetIndicator(){this.indicatorElement&&(this.isRefreshing=!1,this.indicatorElement.classList.remove("refreshing","ready","visible"),this.indicatorElement.style.transform="translateY(-80px)",this.indicatorElement.querySelector(".pull-to-refresh-text").textContent="Pull to refresh")}setDisabled(t){this.disabled=t}destroy(){this.unbindEvents(),this.indicatorElement&&this.indicatorElement.remove(),this.rafId&&cancelAnimationFrame(this.rafId)}}const Fd=(i,t={})=>{const s=he.useRef(null);return he.useEffect(()=>(s.current=new Md({...t,onRefresh:i}),()=>{s.current?.destroy()}),[i]),{setDisabled:r=>s.current?.setDisabled(r),destroy:()=>s.current?.destroy()}},Bd="2.0.55",Qe=class Qe{constructor(){se(this,"currentVersion");this.currentVersion=Bd}static getInstance(){return Qe.instance||(Qe.instance=new Qe),Qe.instance}getVersion(){return this.currentVersion}incrementPatch(){const[t,s,r]=this.currentVersion.split(".").map(Number);return this.currentVersion=`${t}.${s}.${r+1}`,this.currentVersion}incrementMinor(){const[t,s]=this.currentVersion.split(".").map(Number);return this.currentVersion=`${t}.${s+1}.0`,this.currentVersion}incrementMajor(){const[t]=this.currentVersion.split(".").map(Number);return this.currentVersion=`${t+1}.0.0`,this.currentVersion}setVersion(t){this.currentVersion=t}getVersionInfo(){return{version:this.currentVersion,buildTime:new Date().toISOString(),cacheBuster:`v${this.currentVersion}-${new Date().toISOString().split("T")[0]}-auto`,environment:"production",isProduction:!0}}};se(Qe,"instance");let rr=Qe;const Wd=rr.getInstance(),xs=Wd.getVersion(),Hd=new Date().toISOString();`${xs}${new Date().toISOString().split("T")[0]}`;const qd=({onBack:i})=>{le();const[t,s]=p.useState({twoFactorEnabled:!1,emailNotifications:!0,pushNotifications:!0,marketingEmails:!1,publicProfile:!0,showEarnings:!1}),[r,n]=p.useState(!1),[a,o]=p.useState(""),[l,d]=p.useState(!1);p.useState(!1),p.useState({currentPassword:"",newPassword:"",confirmPassword:""});const[c,u]=p.useState({lastPasswordChange:"3 months ago",loginSessions:1,suspiciousActivity:0}),h=async()=>{a.toLowerCase()==="delete my account"?(d(!0),setTimeout(()=>{alert("Account deletion request submitted. You will receive a confirmation email."),n(!1),o(""),d(!1)},2e3)):alert('Please type "delete my account" to confirm.')},m=async f=>{d(!0),setTimeout(()=>{s({...t,[f]:!t[f]}),d(!1);const y=document.createElement("div");y.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 12px 16px;
        border-radius: 8px;
        z-index: 10000;
        font-size: 14px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      `,y.textContent="Setting updated successfully!",document.body.appendChild(y),setTimeout(()=>{document.body.removeChild(y)},3e3)},500)};return e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx(Wt,{size:24,style:{color:"#374151"}})}),e.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Account Settings"})]})}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Profile Visibility"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Public Profile"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Allow others to see your profile"})]}),e.jsx("button",{onClick:()=>m("publicProfile"),disabled:l,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.publicProfile?"#10b981":"#e5e7eb",position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s",opacity:l?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.publicProfile?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Show Earnings"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Display your earnings on profile"})]}),e.jsx("button",{onClick:()=>m("showEarnings"),disabled:l,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.showEarnings?"#10b981":"#e5e7eb",position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s",opacity:l?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.showEarnings?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Security Status"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Last Password Change"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:c.lastPasswordChange})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Active Sessions"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:c.loginSessions})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Suspicious Activity"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:c.suspiciousActivity>0?"#dc2626":"#10b981"},children:c.suspiciousActivity===0?"None detected":`${c.suspiciousActivity} incidents`})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Account Security"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Two-Factor Authentication"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Add extra security to your account"})]}),e.jsx("button",{onClick:()=>m("twoFactorEnabled"),disabled:l,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.twoFactorEnabled?"#10b981":"#e5e7eb",position:"relative",cursor:l?"not-allowed":"pointer",transition:"background 0.2s",opacity:l?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.twoFactorEnabled?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Danger Zone"}),e.jsx("div",{style:{marginBottom:"12px"},children:e.jsx("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 12px 0"},children:"Once you delete your account, there is no going back. Please be certain."})}),r?e.jsxs("div",{style:{border:"2px solid #ef4444",borderRadius:"8px",padding:"16px"},children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#dc2626",margin:"0 0 12px 0"},children:"⚠️ Confirm Account Deletion"}),e.jsx("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 16px 0"},children:"This action cannot be undone. This will permanently delete your account and all associated data."}),e.jsxs("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 16px 0"},children:["Type ",e.jsx("strong",{children:'"delete my account"'})," to confirm:"]}),e.jsx("input",{type:"text",value:a,onChange:f=>o(f.target.value),placeholder:"Type: delete my account",style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",marginBottom:"16px",boxSizing:"border-box"}}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>{n(!1),o("")},style:{flex:1,padding:"10px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Cancel"}),e.jsx("button",{onClick:h,disabled:l||a.toLowerCase()!=="delete my account",style:{flex:1,padding:"10px",background:a.toLowerCase()==="delete my account"?"#dc2626":"#9ca3af",color:"white",border:"none",borderRadius:"6px",cursor:a.toLowerCase()==="delete my account"&&!l?"pointer":"not-allowed",fontWeight:"500"},children:l?"Processing...":"Delete Account"})]})]}):e.jsx("button",{style:{width:"100%",padding:"12px",background:"rgba(239, 68, 68, 0.1)",color:"#dc2626",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",cursor:"pointer",fontWeight:"500"},onClick:()=>n(!0),children:"Delete Account"})]})]})]})},Vd=({onBack:i})=>{const[t,s]=p.useState({pushEnabled:!0,emailEnabled:!0,predictionUpdates:!0,winLossAlerts:!0,clubActivity:!0,socialInteractions:!1,marketingEmails:!1,weeklyDigest:!0}),[r,n]=p.useState(!1),[a,o]=p.useState("default");he.useEffect(()=>{"Notification"in window&&o(Notification.permission)},[]);const l=async()=>{if("Notification"in window){const u=await Notification.requestPermission();o(u),d(u==="granted"?"Notifications enabled successfully!":"You can enable notifications in your browser settings later.")}},d=u=>{const h=document.createElement("div");h.style.cssText=`
      position: fixed;
      top: 20px;
      right: 20px;
      background: #10b981;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      z-index: 10000;
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    `,h.textContent=u,document.body.appendChild(h),setTimeout(()=>{document.body.contains(h)&&document.body.removeChild(h)},3e3)},c=async u=>{u==="pushEnabled"&&!t.pushEnabled&&a!=="granted"&&(await l(),a!=="granted")||(n(!0),setTimeout(()=>{s({...t,[u]:!t[u]}),n(!1),d("Notification setting updated!")},500))};return e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx(Wt,{size:24,style:{color:"#374151"}})}),e.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Notifications"})]})}),e.jsxs("div",{style:{padding:"24px"},children:[a!=="granted"&&e.jsx("div",{style:{background:"rgba(255, 176, 32, 0.1)",border:"1px solid rgba(255, 176, 32, 0.3)",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"24px",height:"24px",background:"#ffb020",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"14px",fontWeight:"bold"},children:"!"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#b45309",margin:"0 0 4px 0"},children:"Enable Browser Notifications"}),e.jsx("p",{style:{fontSize:"12px",color:"#b45309",margin:0},children:a==="denied"?"Notifications are blocked. You can enable them in your browser settings.":"Click to enable push notifications for real-time updates."})]}),a==="default"&&e.jsx("button",{onClick:l,style:{padding:"6px 12px",background:"#ffb020",color:"white",border:"none",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer"},children:"Enable"})]})}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"General"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Push Notifications"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Receive notifications on your device"})]}),e.jsx("button",{onClick:()=>c("pushEnabled"),disabled:r,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.pushEnabled?"#10b981":"#e5e7eb",position:"relative",cursor:r?"not-allowed":"pointer",opacity:r?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.pushEnabled?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Email Notifications"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Receive notifications via email"})]}),e.jsx("button",{onClick:()=>c("emailEnabled"),disabled:r,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.emailEnabled?"#10b981":"#e5e7eb",position:"relative",cursor:r?"not-allowed":"pointer",opacity:r?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.emailEnabled?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Prediction Alerts"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Win/Loss Alerts"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Get notified when predictions resolve"})]}),e.jsx("button",{onClick:()=>c("winLossAlerts"),disabled:r,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.winLossAlerts?"#10b981":"#e5e7eb",position:"relative",cursor:r?"not-allowed":"pointer",opacity:r?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.winLossAlerts?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"14px"},children:"Club Activity"}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Activity from clubs you've joined"})]}),e.jsx("button",{onClick:()=>c("clubActivity"),disabled:r,style:{width:"44px",height:"24px",borderRadius:"12px",border:"none",background:t.clubActivity?"#10b981":"#e5e7eb",position:"relative",cursor:r?"not-allowed":"pointer",opacity:r?.6:1},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:t.clubActivity?"22px":"2px",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"}})})]})]})]})]})]})},Gd=({onBack:i})=>{const[t,s]=p.useState(!1),[r,n]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,o]=p.useState(!1),[l,d]=p.useState({lastPasswordChange:"3 months ago",loginSessions:1,suspiciousActivity:0}),c=async()=>{if(r.newPassword!==r.confirmPassword){alert("New passwords do not match!");return}if(r.newPassword.length<8){alert("Password must be at least 8 characters long!");return}o(!0),setTimeout(()=>{alert("Password changed successfully!"),n({currentPassword:"",newPassword:"",confirmPassword:""}),s(!1),o(!1),d({...l,lastPasswordChange:"Just now"})},2e3)};return e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx(Wt,{size:24,style:{color:"#374151"}})}),e.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Security & Privacy"})]})}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Password & Authentication"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>s(!t),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(wc,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Change Password"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]}),t&&e.jsxs("div",{style:{marginTop:"16px",padding:"16px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[e.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px",margin:"0 0 12px 0"},children:"Change Password"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsx("input",{type:"password",placeholder:"Current Password",value:r.currentPassword,onChange:u=>n({...r,currentPassword:u.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"}}),e.jsx("input",{type:"password",placeholder:"New Password (min 8 characters)",value:r.newPassword,onChange:u=>n({...r,newPassword:u.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"}}),e.jsx("input",{type:"password",placeholder:"Confirm New Password",value:r.confirmPassword,onChange:u=>n({...r,confirmPassword:u.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"}}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:[e.jsx("button",{onClick:()=>{s(!1),n({currentPassword:"",newPassword:"",confirmPassword:""})},style:{flex:1,padding:"8px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"14px"},children:"Cancel"}),e.jsx("button",{onClick:c,disabled:a||!r.currentPassword||!r.newPassword||!r.confirmPassword,style:{flex:1,padding:"8px",background:a||!r.currentPassword||!r.newPassword||!r.confirmPassword?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:a||!r.currentPassword||!r.newPassword||!r.confirmPassword?"not-allowed":"pointer",fontWeight:"500",fontSize:"14px"},children:a?"Updating...":"Update Password"})]})]})]}),e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Two-factor authentication setup will be available in the next update!"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(gr,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Two-Factor Authentication"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Privacy Controls"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Privacy settings will be available soon"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(on,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Profile Privacy"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]}),e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Data management features coming soon"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(Qi,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Data & Privacy"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Login Activity"}),e.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},children:"Recent login activity and device management"}),e.jsxs("div",{style:{padding:"12px",background:"#f9fafb",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"500",fontSize:"14px"},children:"Current Device"}),e.jsx("span",{style:{fontSize:"12px",color:"#10b981"},children:"Active Now"})]}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"MacBook Pro • Chrome • Gainesville, GA"})]})]})]})]})},Jd=({onBack:i})=>e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsx("div",{style:{padding:"20px 24px",background:"white",borderBottom:"1px solid #e5e7eb"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx(Wt,{size:24,style:{color:"#374151"}})}),e.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",margin:0},children:"Help & Support"})]})}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Get Help"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("https://help.fanclubz.com/faq","_blank")||alert("FAQ section will open in a new window"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(en,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Frequently Asked Questions"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]}),e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("mailto:support@fanclubz.com"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(kc,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Contact Support"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]}),e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>alert("Live chat will be available 24/7 starting next week!"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(Ce,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Live Chat"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"Resources"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/terms","_blank")||alert("Terms of Service will open in a new window"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(Qi,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Terms of Service"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]}),e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/privacy","_blank")||alert("Privacy Policy will open in a new window"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(gr,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Privacy Policy"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]}),e.jsxs("button",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"12px",background:"none",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/community-guidelines","_blank")||alert("Community Guidelines will open in a new window"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(tt,{size:20,style:{color:"#6b7280"}}),e.jsx("span",{style:{fontWeight:"500"},children:"Community Guidelines"})]}),e.jsx(we,{size:16,style:{color:"#9ca3af"}})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",margin:"0 0 16px 0"},children:"App Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"App Version"}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"500"},children:["v",xs]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Build Number"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"2024.07.30"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Last Updated"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"July 30, 2025"})]})]})]})]})]}),jn=({onNavigateBack:i,userId:t})=>{const{user:s,updateProfile:r,logout:n}=le(),[a,o]=p.useState("overview"),[l,d]=p.useState(!1),[c,u]=p.useState(!1),[h,m]=p.useState(null),[f,y]=p.useState(!1),[x,g]=p.useState({firstName:s?.firstName||"",lastName:s?.lastName||"",email:s?.email||"",bio:s?.bio||""});he.useEffect(()=>{try{if(!t||typeof t!="string"||t.trim()===""){console.log("No valid userId provided, viewing own profile"),u(!1),m(s);return}const k=t!==s?.id;u(k),k?(console.log("Viewing other user profile:",t),j(t)):(console.log("Viewing own profile"),m(s))}catch(k){console.error("Error in profile useEffect:",k),u(!1),m(s)}},[t,s]);const j=async k=>{y(!0);try{console.log("🔍 Fetching profile for user ID:",k);const T=await fetch(`https://fan-club-z.onrender.com/api/v2/users/${k}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const _=await T.json();if(_.error)throw new Error(_.message||"Failed to fetch user profile");const O=_.data,b={id:O.id,firstName:O.full_name?.split(" ")[0]||O.username,lastName:O.full_name?.split(" ").slice(1).join(" ")||"",email:O.email,bio:O.bio||"No bio available",avatar:O.avatar_url,totalEarnings:O.stats?.totalEarnings||0,totalInvested:O.stats?.totalInvested||0,winRate:O.stats?.winRate||0,activePredictions:O.stats?.predictionsCreated||0,totalPredictions:O.stats?.predictionsParticipated||0,rank:0,level:O.reputation_score>1e3?"Advanced Predictor":O.reputation_score>500?"Intermediate Predictor":"New Predictor",createdAt:O.created_at,username:O.username,isVerified:O.is_verified};console.log("✅ User profile fetched successfully:",b),m(b)}catch(V){console.error("❌ Error fetching user profile:",V),m({id:k,firstName:"Unknown",lastName:"User",email:"",bio:"Profile not available",avatar:null,totalEarnings:0,totalInvested:0,winRate:0,activePredictions:0,totalPredictions:0,rank:0,level:"Unknown",createdAt:new Date().toISOString(),username:"unknown_user",isVerified:!1})}finally{y(!1)}};he.useEffect(()=>{We({behavior:"instant"})},[]);const v=he.useCallback(async()=>{console.log("Pull to refresh triggered on Profile page"),await new Promise(k=>setTimeout(k,500))},[]);Fd(v,{threshold:60,disabled:!1});const w=he.useMemo(()=>{const k=h||s;return k?{totalEarnings:k.totalEarnings||0,totalInvested:k.totalInvested||0,winRate:k.winRate||0,activePredictions:k.activePredictions||0,totalPredictions:k.totalPredictions||0,rank:k.rank||0,joinedDate:k.createdAt?new Date(k.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"Recently",level:k.level||"New Predictor"}:{totalEarnings:0,totalInvested:0,winRate:0,activePredictions:0,totalPredictions:0,rank:0,joinedDate:"Recently",level:"New Predictor"}},[h,s]),C=he.useMemo(()=>[{id:"account",label:"Account Settings",icon:is,description:"Manage your account preferences",action:()=>o("account")},{id:"notifications",label:"Notifications",icon:Xi,description:"Control your notification settings",action:()=>o("notifications")},{id:"security",label:"Security & Privacy",icon:gr,description:"Manage security settings",action:()=>o("security")},{id:"help",label:"Help & Support",icon:en,description:"Get help and contact support",action:()=>o("help")}],[o]),z=he.useMemo(()=>[{id:1,title:"First Prediction",icon:"🎯",unlocked:!0},{id:2,title:"Winning Streak",icon:"🔥",unlocked:!0},{id:3,title:"Top Predictor",icon:"👑",unlocked:!1},{id:4,title:"Community Leader",icon:"⭐",unlocked:!1}],[]),S=()=>{r({...s,firstName:x.firstName,lastName:x.lastName,email:x.email,bio:x.bio}),d(!1)},$=()=>{g({firstName:s?.firstName||"",lastName:s?.lastName||"",email:s?.email||"",bio:s?.bio||""}),d(!1)},U=()=>{const k=()=>{n(),i&&i()},V=document.createElement("div");V.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    `,V.innerHTML=`
      <div style="
        background: white;
        border-radius: 16px;
        padding: 24px;
        max-width: 320px;
        width: 90%;
        text-align: center;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      ">
        <div style="
          width: 48px;
          height: 48px;
          background: #fef3c7;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 16px;
        ">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
            <path d="M9 12l2 2 4-4"/>
            <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
          </svg>
        </div>
        <h3 style="
          font-size: 18px;
          font-weight: 700;
          color: #111827;
          margin: 0 0 8px 0;
        ">Sign Out</h3>
        <p style="
          font-size: 14px;
          color: #6b7280;
          margin: 0 0 24px 0;
          line-height: 1.5;
        ">Are you sure you want to sign out of your account?</p>
        <div style="
          display: flex;
          gap: 12px;
          justify-content: center;
        ">
          <button onclick="this.closest('[style*='position: fixed']').remove()" style="
            padding: 10px 20px;
            background: #f3f4f6;
            color: #374151;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
          " onmouseover="this.style.backgroundColor='#e5e7eb'" onmouseout="this.style.backgroundColor='#f3f4f6'">
            Cancel
          </button>
          <button onclick="window.confirmLogout()" style="
            padding: 10px 20px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
          " onmouseover="this.style.backgroundColor='#dc2626'" onmouseout="this.style.backgroundColor='#ef4444'">
            Sign Out
          </button>
        </div>
      </div>
    `,window.confirmLogout=()=>{V.remove(),k()},document.body.appendChild(V)};return c&&o("overview"),!c&&a==="account"?e.jsx(qd,{onBack:()=>o("overview")}):!c&&a==="notifications"?e.jsx(Vd,{onBack:()=>o("overview")}):!c&&a==="security"?e.jsx(Gd,{onBack:()=>o("overview")}):!c&&a==="help"?e.jsx(Jd,{onBack:()=>o("overview")}):c&&f?e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",minHeight:"300px"},children:[e.jsx("div",{style:{height:"44px"}}),e.jsx("div",{style:{padding:"20px 16px",position:"relative",zIndex:10},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"40px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[i&&e.jsx("button",{onClick:i,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:e.jsx(et,{size:20,style:{color:"white"}})}),e.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0},children:"Profile"})]})})})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"3px solid #10b981",borderTop:"3px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}}),e.jsx("p",{style:{color:"#6b7280",fontSize:"16px"},children:"Loading profile..."})]})})]}):c&&!f&&!h?e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",minHeight:"300px"},children:[e.jsx("div",{style:{height:"44px"}}),e.jsx("div",{style:{padding:"20px 16px",position:"relative",zIndex:10},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"40px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[i&&e.jsx("button",{onClick:i,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:e.jsx(et,{size:20,style:{color:"white"}})}),e.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0},children:"Profile"})]})})})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:"48px",height:"48px",background:"#fef3c7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",margin:"0 0 8px 0"},children:"Profile Not Found"}),e.jsx("p",{style:{color:"#6b7280",fontSize:"16px",margin:"0 0 24px 0"},children:"The user profile you're looking for doesn't exist or is not available."}),i&&e.jsx("button",{onClick:i,style:{background:"#10b981",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"Go Back"})]})})]}):e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",minHeight:"300px"},children:[e.jsx("div",{style:{position:"absolute",top:"20px",right:"20px",width:"100px",height:"100px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",filter:"blur(20px)"}}),e.jsx("div",{style:{position:"absolute",bottom:"20px",left:"30px",width:"80px",height:"80px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",filter:"blur(15px)"}}),e.jsx("div",{style:{height:"44px"}}),e.jsx("div",{style:{padding:"20px 16px",position:"relative",zIndex:10},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"40px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[i&&e.jsx("button",{onClick:i,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:e.jsx(et,{size:20,style:{color:"white"}})}),e.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0},children:c?"User Profile":"Profile"})]}),!c&&e.jsx("button",{onClick:()=>d(!l),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"12px",padding:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:l?e.jsx(ze,{size:20,style:{color:"white"}}):e.jsx(sn,{size:20,style:{color:"white"}})})]})}),e.jsx("div",{style:{margin:"16px",background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",minHeight:"180px"},children:e.jsx(je,{mode:"wait",children:!c&&l?e.jsxs(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",marginBottom:"16px"},children:[e.jsxs("div",{style:{position:"relative",flexShrink:0},children:[e.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"4px solid white"},children:e.jsx("span",{style:{color:"white",fontSize:"28px",fontWeight:"700"},children:(x.firstName?.charAt(0)||x.email?.charAt(0)||"U").toUpperCase()})}),e.jsx("button",{style:{position:"absolute",bottom:"0",right:"0",width:"28px",height:"28px",background:"#10b981",border:"2px solid white",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.jsx(bc,{size:12,style:{color:"white"}})})]}),e.jsxs("div",{style:{flex:1,minWidth:0,paddingTop:"4px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px"},children:[e.jsx("input",{type:"text",placeholder:"First Name",value:x.firstName,onChange:k=>g({...x,firstName:k.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",fontWeight:"600",outline:"none",transition:"border-color 0.2s",boxSizing:"border-box"},onFocus:k=>k.target.style.borderColor="#10b981",onBlur:k=>k.target.style.borderColor="#e5e7eb"}),e.jsx("input",{type:"text",placeholder:"Last Name",value:x.lastName,onChange:k=>g({...x,lastName:k.target.value}),style:{width:"100%",padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",fontWeight:"600",outline:"none",transition:"border-color 0.2s",boxSizing:"border-box"},onFocus:k=>k.target.style.borderColor="#10b981",onBlur:k=>k.target.style.borderColor="#e5e7eb"})]}),e.jsx("input",{type:"email",placeholder:"Email",value:x.email,onChange:k=>g({...x,email:k.target.value}),style:{width:"100%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"13px",marginBottom:"6px",outline:"none",boxSizing:"border-box",transition:"border-color 0.2s"},onFocus:k=>k.target.style.borderColor="#10b981",onBlur:k=>k.target.style.borderColor="#e5e7eb"}),e.jsx("textarea",{placeholder:"Bio (optional)",value:x.bio,onChange:k=>g({...x,bio:k.target.value}),style:{width:"100%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"13px",resize:"none",height:"50px",outline:"none",boxSizing:"border-box",transition:"border-color 0.2s"},onFocus:k=>k.target.style.borderColor="#10b981",onBlur:k=>k.target.style.borderColor="#e5e7eb"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end",marginTop:"16px"},children:[e.jsx("button",{onClick:$,style:{padding:"8px 16px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px",transition:"background-color 0.2s"},onMouseEnter:k=>k.currentTarget.style.backgroundColor="#e5e7eb",onMouseLeave:k=>k.currentTarget.style.backgroundColor="#f3f4f6",children:"Cancel"}),e.jsxs("button",{onClick:S,style:{padding:"8px 16px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",gap:"4px",transition:"background-color 0.2s"},onMouseEnter:k=>k.currentTarget.style.backgroundColor="#059669",onMouseLeave:k=>k.currentTarget.style.backgroundColor="#10b981",children:[e.jsx(Cc,{size:16}),"Save"]})]})]},"editing"):e.jsxs(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",marginBottom:"16px"},children:[e.jsx("div",{style:{position:"relative",flexShrink:0},children:e.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"4px solid white"},children:e.jsx("span",{style:{color:"white",fontSize:"28px",fontWeight:"700"},children:(h?.firstName?.charAt(0)||h?.email?.charAt(0)||"U").toUpperCase()})})}),e.jsxs("div",{style:{flex:1,minWidth:0,paddingTop:"4px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#111827",marginBottom:"4px",margin:0,lineHeight:"1.2"},children:h?.firstName&&h?.lastName?`${h.firstName} ${h.lastName}`:h?.email?.split("@")[0]||"User"}),e.jsx("p",{style:{color:"#6b7280",fontSize:"14px",marginBottom:"4px",margin:"4px 0",lineHeight:"1.3"},children:c?"":h?.email||"No email provided"}),h?.bio&&e.jsx("p",{style:{color:"#6b7280",fontSize:"13px",margin:"4px 0",lineHeight:"1.3"},children:h.bio}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"6px"},children:[e.jsx(Tc,{size:14,style:{color:"#fbbf24"}}),e.jsxs("span",{style:{fontSize:"12px",color:"#6b7280",fontWeight:"500"},children:["Rank #",w.rank," • ",w.level]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginTop:"12px"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"6px"},children:[e.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#111827"},children:w.totalPredictions}),e.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Predictions"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"6px"},children:[e.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#10b981"},children:[w.winRate,"%"]}),e.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Win Rate"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"6px"},children:[e.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#111827"},children:["$",(w.totalEarnings-w.totalInvested).toLocaleString()]}),e.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Net Profit"})]})]})]},"viewing")})})]}),e.jsxs("div",{style:{padding:"0 24px 100px 24px"},children:[e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Performance Overview"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(16, 185, 129, 0.1)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(ft,{size:20,style:{color:"#10b981"}})}),e.jsxs("div",{style:{minWidth:0},children:[e.jsxs("div",{style:{fontSize:"16px",fontWeight:"700",color:"#111827"},children:["$",w.totalEarnings.toLocaleString()]}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Total Earnings"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(59, 130, 246, 0.1)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx($e,{size:20,style:{color:"#3b82f6"}})}),e.jsxs("div",{style:{minWidth:0},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#111827"},children:w.activePredictions}),e.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Active"})]})]})]})]}),e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Achievements"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:z.map(k=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",borderRadius:"8px",backgroundColor:k.unlocked?"rgba(16, 185, 129, 0.05)":"#f9fafb",opacity:k.unlocked?1:.6},children:[e.jsx("div",{style:{fontSize:"20px",flexShrink:0},children:k.icon}),e.jsx("div",{style:{flex:1,minWidth:0},children:e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#111827"},children:k.title})}),k.unlocked&&e.jsx("div",{style:{flexShrink:0},children:e.jsx(Ic,{size:16,style:{color:"#10b981"}})})]},k.id))})]}),!c&&e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Settings"}),e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:C.map((k,V)=>{const T=k.icon;return e.jsxs("button",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px 12px",background:"none",border:"none",borderRadius:"8px",cursor:"pointer",textAlign:"left",width:"100%",transition:"background-color 0.2s",borderBottom:V<C.length-1?"1px solid #f3f4f6":"none"},onMouseEnter:_=>{_.currentTarget.style.backgroundColor="#f9fafb"},onMouseLeave:_=>{_.currentTarget.style.backgroundColor="transparent"},onClick:k.action,children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(107, 114, 128, 0.1)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(T,{size:20,style:{color:"#6b7280"}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#111827"},children:k.label}),e.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginTop:"2px"},children:k.description})]}),e.jsx(we,{size:20,style:{color:"#9ca3af",flexShrink:0}})]},k.id)})})]}),e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",marginBottom:"16px",margin:"0 0 16px 0"},children:"Account Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Email"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:s?.email||"Not provided"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Member Since"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:w.joinedDate})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Account Status"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#10b981"},children:"Active"})]})]})]}),e.jsxs(A.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"16px",background:"rgba(239, 68, 68, 0.1)",color:"#dc2626",border:"none",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginBottom:"20px",transition:"background-color 0.2s"},onClick:U,onMouseEnter:k=>k.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.15)",onMouseLeave:k=>k.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(jc,{size:20}),e.jsx("span",{children:"Sign Out"})]})]})]})},Kd=({onNavigateBack:i})=>{const[t,s]=p.useState("overview"),[r,n]=p.useState(!1),[a,o]=p.useState(!1),[l,d]=p.useState(null),[c,u]=p.useState(""),{getBalance:h,getTransactionHistory:m,addFunds:f,resetDemoBalance:y,isDemoMode:x}=ms();le();const[,g]=oe();p.useEffect(()=>{We({delay:200})},[]);const j=h("USD")||0,v=m({currency:"USD"})||[],w=[10,25,50,100],C=async T=>{if(T<=0){G.error("Please enter a valid amount");return}n(!0);try{await f(T,"USD","Demo funds added"),G.success(`Successfully added $${T.toLocaleString()} to your wallet!`),d(null),u("")}catch{G.error("Failed to add funds. Please try again.")}finally{n(!1)}},z=async()=>{o(!0);try{await y(),G.success("Demo balance reset successfully!")}catch{G.error("Failed to reset demo balance. Please try again.")}finally{o(!1)}},S=()=>{i?i():g("/")},$=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(T),U=T=>T.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=T=>{switch(T){case"deposit":return e.jsx(rs,{size:16,className:"text-green-500"});case"withdrawal":return e.jsx($c,{size:16,className:"text-red-500"});case"prediction":return e.jsx($e,{size:16,className:"text-blue-500"});case"win":return e.jsx(Lt,{size:16,className:"text-green-500"});default:return e.jsx(ft,{size:16,className:"text-gray-500"})}},V=T=>{switch(T){case"deposit":case"win":return"text-green-600";case"withdrawal":case"prediction":return"text-red-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 wallet-page",children:[e.jsxs("div",{className:"bg-white border-b border-gray-100",children:[e.jsx("div",{className:"h-11"}),e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:S,className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:e.jsx(et,{size:20,className:"text-gray-700"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Wallet"}),x&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Demo Mode"})]}),e.jsx("div",{className:"w-10"})," "]})})]}),x&&e.jsx(A.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mx-4 mt-4 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fc,{size:20,className:"text-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-sm",children:"Demo Funds"}),e.jsx("p",{className:"text-blue-100 text-xs",children:"This is a demo wallet. All transactions are simulated."})]})]})}),e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mx-4 mt-4 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-green-100 uppercase tracking-wide",children:"Available Balance"}),e.jsx("div",{className:"text-3xl font-bold mt-1",children:$(j)})]}),e.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:e.jsx(ft,{size:24,className:"text-white"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(25),className:"flex-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg py-2 px-3 text-sm font-medium transition-all",children:"Add Funds"}),x&&e.jsx("button",{onClick:z,disabled:a,className:"flex-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg py-2 px-3 text-sm font-medium transition-all disabled:opacity-50",children:a?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(gt,{size:14,className:"animate-spin"}),"Resetting..."]}):"Reset Demo"})]})]}),e.jsx("div",{className:"mx-4 mt-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-1 flex",children:[e.jsx("button",{onClick:()=>s("overview"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${t==="overview"?"bg-green-500 text-white":"text-gray-600 hover:text-gray-900"}`,children:"Overview"}),e.jsx("button",{onClick:()=>s("transactions"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${t==="transactions"?"bg-green-500 text-white":"text-gray-600 hover:text-gray-900"}`,children:"Transactions"})]})}),e.jsx("div",{className:"mx-4 mt-4",children:e.jsx(je,{mode:"wait",children:t==="overview"?e.jsxs(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($e,{size:16,className:"text-green-500"}),e.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Total Won"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:$(v.filter(T=>T.type==="win").reduce((T,_)=>T+_.amount,0))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ac,{size:16,className:"text-red-500"}),e.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Total Lost"})]}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:$(Math.abs(v.filter(T=>T.type==="prediction").reduce((T,_)=>T+_.amount,0)))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Activity"})}),e.jsx("div",{className:"p-4",children:v.slice(0,3).length>0?e.jsx("div",{className:"space-y-3",children:v.slice(0,3).map((T,_)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:k(T.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.description}),e.jsx("div",{className:"text-xs text-gray-500",children:U(T.date)})]}),e.jsxs("div",{className:`text-sm font-semibold ${V(T.type)}`,children:[T.amount>0?"+":"",$(T.amount)]})]},_))}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(He,{size:24,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No transactions yet"})]})})]})]},"overview"):e.jsx(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"All Transactions"})}),e.jsx("div",{className:"divide-y divide-gray-100",children:v.length>0?v.map((T,_)=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:k(T.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.description}),e.jsx("div",{className:"text-xs text-gray-500",children:U(T.date)})]}),e.jsxs("div",{className:`text-sm font-semibold ${V(T.type)}`,children:[T.amount>0?"+":"",$(T.amount)]})]})},_)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(He,{size:32,className:"text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No transactions yet"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Start making predictions to see your activity"})]})})]})},"transactions")})}),e.jsx(je,{children:l!==null&&e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>d(null),children:e.jsxs(A.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl w-full max-w-sm p-6",onClick:T=>T.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Add Demo Funds"}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:w.map(T=>e.jsxs("button",{onClick:()=>u(T.toString()),className:`py-3 px-4 rounded-lg border-2 text-sm font-medium transition-all ${c===T.toString()?"border-green-500 bg-green-50 text-green-700":"border-gray-200 text-gray-700 hover:border-gray-300"}`,children:["$",T]},T))}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",placeholder:"0",value:c,onChange:T=>u(T.target.value),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"1",max:"10000"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>d(null),className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>C(parseFloat(c)||0),disabled:!c||parseFloat(c)<=0||r,className:`flex-1 py-3 rounded-lg font-medium transition-colors ${!c||parseFloat(c)<=0||r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:r?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(gt,{size:16,className:"animate-spin"}),"Adding..."]}):"Add Funds"})]})]})})})]})},Yd=()=>{const{login:i,register:t,loginWithOAuth:s,loading:r}=le(),[n,a]=p.useState(""),[o,l]=p.useState(""),[d,c]=p.useState(""),[u,h]=p.useState(""),[m,f]=p.useState(""),[y,x]=p.useState(!1),[g,j]=p.useState(!1),[v,w]=p.useState(!0),[C,z]=p.useState(!1),[S,$]=p.useState({}),[U,k]=p.useState(null);p.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]);const V=R=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(R))return!1;const E=R.split("@"),P=E[0],W=E[1];if(P.length<1||P.length>64||W.length<3||W.length>255)return!1;const K=W.split(".");return K.length<2?!1:K.every(te=>te.length>0&&te.length<=63)},T=()=>{const R={};return n?V(n)||(R.email="Please enter a valid email address (e.g., user@example.com)"):R.email="Email is required",o?o.length<6&&(R.password="Password must be at least 6 characters"):R.password="Password is required",v||(d.trim()||(R.firstName="First name is required"),u.trim()||(R.lastName="Last name is required"),m?o!==m&&(R.confirmPassword="Passwords do not match"):R.confirmPassword="Please confirm your password"),$(R),Object.keys(R).length===0},_=async R=>{if(R.preventDefault(),!(!T()||r)){$({}),k(null);try{v?await i(n,o):await t(n,o,d,u)}catch(I){console.error("Auth error:",I);let E="Authentication failed. Please try again.";if(I.message){const P=I.message.toLowerCase();P.includes("invalid")&&P.includes("credentials")?E="Invalid email or password. Please check your credentials and try again.":P.includes("user already registered")||P.includes("already exists")?(E="An account with this email already exists. Please try signing in instead.",setTimeout(()=>w(!0),2e3)):P.includes("email not confirmed")?E="Please check your email and confirm your account before signing in.":P.includes("too many requests")||P.includes("rate limit")?E="Too many attempts. Please wait a moment and try again.":P.includes("user not found")?(E="No account found with this email. Please register first.",v&&setTimeout(()=>w(!1),2e3)):E="Something went wrong. Please try again or contact support if the issue continues."}k(E)}}},O=async(R,I,E,P)=>{try{a(R),l(I),E&&c(E),P&&h(P),f(I),k(null),v?await i(R,I):await t(R,I,E||"Test",P||"User")}catch(W){console.error("Test auth error:",W),k(W.message||"Test authentication failed")}},b=async R=>{try{k(null),await s(R)}catch(I){console.error(`${R} auth error:`,I),k(`${R} sign-in failed. Please try again.`)}},N=()=>{w(!v),$({}),k(null),a(""),l(""),c(""),h(""),f(""),window.scrollTo({top:0,behavior:"smooth"})},F=()=>x(!y),Y=()=>j(!g);return e.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 30%, #ecfdf5 70%, #f0fdfa 100%)",display:"flex",alignItems:"flex-start",justifyContent:"center",padding:"8px",position:"relative",overflow:"auto"},children:[{}.VITE_DEBUG==="true"&&e.jsxs("div",{children:[e.jsx("div",{style:{position:"fixed",top:"10px",left:"10px",zIndex:1001},children:e.jsx("button",{onClick:()=>z(!C),style:{padding:"8px 12px",background:"#374151",color:"white",border:"none",borderRadius:"6px",fontSize:"12px",cursor:"pointer"},children:"🧪 Test Mode"})}),C&&e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"rgba(0, 0, 0, 0.9)",color:"white",padding:"16px",borderRadius:"8px",fontSize:"12px",zIndex:1e3,maxWidth:"280px"},children:[e.jsx("div",{style:{marginBottom:"12px",fontWeight:"bold",color:"#00ff88"},children:"🚀 FIXED AUTHENTICATION"}),e.jsx("div",{style:{marginBottom:"8px",fontSize:"10px",color:"#ccc"},children:"✅ Business domains now supported:"}),e.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>O("userten@fcz.app","test123","User","Ten"),children:v?"🔑 Login userten@fcz.app":"📝 Register userten@fcz.app"}),e.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>O("demo@example.com","demo123","Demo","User"),children:v?"🔑 Login demo@example.com":"📝 Register demo@example.com"}),e.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>O("user@gmail.com","test123","Test","Person"),children:v?"🔑 Login user@gmail.com":"📝 Register user@gmail.com"}),e.jsx("div",{style:{margin:"12px 0 8px 0",fontSize:"10px",color:"#00ff88"},children:"✅ ALL email formats now work!"}),e.jsx("button",{style:{margin:"4px 0",padding:"6px 12px",background:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",width:"100%"},onClick:()=>z(!1),children:"❌ Close"})]})]}),e.jsx("style",{children:`
          @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
          }
          
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
          
          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
          }
          
          @media (max-width: 768px) {
            .auth-card {
              padding: 16px !important;
              margin: 8px !important;
              max-width: calc(100% - 16px) !important;
              width: calc(100% - 16px) !important;
              min-height: calc(100vh - 16px) !important;
              border-radius: 16px !important;
            }
            
            .auth-card h1 {
              font-size: 28px !important;
            }
            
            .auth-card p {
              font-size: 14px !important;
            }
          }
          
          .auth-error {
            animation: shake 0.5s ease-in-out;
          }
        `}),e.jsx("div",{style:{position:"absolute",top:"-160px",right:"-160px",width:"320px",height:"320px",background:"radial-gradient(circle, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 50%, transparent 100%)",borderRadius:"50%",filter:"blur(40px)",animation:"float 8s ease-in-out infinite"}}),e.jsx("div",{style:{position:"absolute",bottom:"-160px",left:"-160px",width:"320px",height:"320px",background:"radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.03) 50%, transparent 100%)",borderRadius:"50%",filter:"blur(40px)",animation:"float 10s ease-in-out infinite reverse"}}),e.jsxs("div",{className:"auth-card",style:{width:"100%",maxWidth:"100%",minHeight:"calc(100vh - 16px)",backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:"24px",padding:"32px",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",position:"relative",zIndex:10,margin:"8px",marginTop:"8px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[e.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"20px",margin:"0 auto 16px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 12px 24px rgba(16, 185, 129, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},children:e.jsx("span",{style:{fontSize:"32px",fontWeight:"bold",color:"white",textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:"Z"})}),e.jsx("h1",{style:{fontSize:"32px",fontWeight:"bold",color:"#111827",marginBottom:"8px",margin:"0 0 8px 0",background:"linear-gradient(135deg, #111827 0%, #374151 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",lineHeight:"1.2"},children:v?"Welcome Back":"Join Fan Club Z"}),e.jsx("p",{style:{fontSize:"16px",color:"#6b7280",margin:"0",lineHeight:"1.5"},children:v?"Sign in to continue your prediction journey":"Create your account and start making predictions"})]}),U&&e.jsxs("div",{className:"auth-error",style:{marginBottom:"20px",padding:"16px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",color:"#dc2626",fontSize:"14px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",style:{flexShrink:0,marginTop:"2px"},children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:v?"Sign In Failed":"Registration Failed"}),e.jsx("div",{style:{lineHeight:"1.4"},children:U}),U.includes("valid email")&&e.jsx("div",{style:{marginTop:"8px",fontSize:"12px",color:"#7c2d12",background:"rgba(34, 197, 94, 0.1)",padding:"8px",borderRadius:"6px"},children:"✅ Business domains like @fcz.app, @company.com are now fully supported!"})]})]}),e.jsxs("form",{onSubmit:_,style:{marginBottom:"20px",flex:1},children:[!v&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"18px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"First Name"}),e.jsx("input",{type:"text",value:d,onChange:R=>c(R.target.value),placeholder:"Enter first name",style:{width:"100%",padding:"14px 16px",border:`2px solid ${S.firstName?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:r,required:!v}),S.firstName&&e.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),S.firstName]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Last Name"}),e.jsx("input",{type:"text",value:u,onChange:R=>h(R.target.value),placeholder:"Enter last name",style:{width:"100%",padding:"14px 16px",border:`2px solid ${S.lastName?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:r,required:!v}),S.lastName&&e.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),S.lastName]})]})]}),e.jsxs("div",{style:{marginBottom:"18px",position:"relative"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Email Address"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"email",value:n,onChange:R=>a(R.target.value),placeholder:"Enter your email address",style:{width:"100%",padding:"14px 16px",paddingRight:"52px",border:`2px solid ${S.email?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:r,required:!0}),e.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),S.email&&e.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),S.email]})]}),e.jsxs("div",{style:{marginBottom:"18px",position:"relative"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:y?"text":"password",value:o,onChange:R=>l(R.target.value),placeholder:"Enter your password",style:{width:"100%",padding:"14px 16px",paddingRight:"52px",border:`2px solid ${S.password?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:r,required:!0}),e.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s"},onClick:F,children:y?e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):e.jsxs("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),S.password&&e.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),S.password]})]}),!v&&e.jsxs("div",{style:{marginBottom:"18px",position:"relative"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Confirm Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:g?"text":"password",value:m,onChange:R=>f(R.target.value),placeholder:"Confirm your password",style:{width:"100%",padding:"14px 16px",paddingRight:"52px",border:`2px solid ${S.confirmPassword?"#ef4444":"#e5e7eb"}`,borderRadius:"12px",fontSize:"16px",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxSizing:"border-box",backgroundColor:"#ffffff",fontFamily:"inherit",minHeight:"52px"},disabled:r,required:!v}),e.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s"},onClick:Y,children:g?e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):e.jsxs("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),S.confirmPassword&&e.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#ef4444",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("svg",{width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),S.confirmPassword]})]}),v&&e.jsx("div",{style:{textAlign:"right",marginBottom:"20px"},children:e.jsx("a",{href:"#",onClick:R=>{R.preventDefault(),alert("Password reset functionality will be available soon!")},style:{color:"#10b981",textDecoration:"none",fontSize:"14px",fontWeight:"500",padding:"4px 8px",borderRadius:"6px",transition:"all 0.2s"},children:"Forgot your password?"})}),e.jsx("button",{type:"submit",disabled:r,style:{width:"100%",height:"56px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"16px",fontWeight:"600",cursor:r?"not-allowed":"pointer",opacity:r?"0.8":"1",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 8px 16px rgba(16, 185, 129, 0.3)",position:"relative",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),v?"Signing in...":"Creating account..."]}):v?"Sign In":"Create Account"})]}),e.jsxs("div",{style:{position:"relative",textAlign:"center",margin:"24px 0",fontSize:"14px",color:"#6b7280"},children:[e.jsx("div",{style:{position:"absolute",top:"50%",left:"0",right:"0",height:"1px",backgroundColor:"#e5e7eb"}}),e.jsxs("span",{style:{backgroundColor:"white",padding:"0 16px",position:"relative",zIndex:1},children:["Or ",v?"continue":"sign up"," with Google"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"24px"},children:e.jsxs("button",{type:"button",onClick:()=>b("google"),disabled:r,style:{width:"100%",height:"52px",backgroundColor:"white",border:"1.5px solid #e5e7eb",borderRadius:"14px",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",fontSize:"15px",fontWeight:"500",color:"#374151",cursor:r?"not-allowed":"pointer",opacity:r?"0.7":"1",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[r?e.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #10b981",borderRadius:"50%",animation:"spin 1s linear infinite"}}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]})}),e.jsx("div",{style:{textAlign:"center",paddingTop:"20px",paddingBottom:"16px",borderTop:"1px solid #f3f4f6"},children:e.jsxs("p",{style:{color:"#6b7280",fontSize:"15px",margin:"0"},children:[v?"Don't have an account?":"Already have an account?"," ",e.jsx("a",{href:"#",onClick:R=>{R.preventDefault(),N()},style:{color:"#10b981",textDecoration:"none",fontWeight:"600",padding:"8px 12px",borderRadius:"6px",transition:"all 0.2s",display:"inline-block",marginTop:"8px"},children:v?"Create one now":"Sign in"})]})})]}),e.jsx(Zi,{})]})},Zd=()=>{const{handleOAuthCallback:i,isAuthenticated:t,loading:s}=le(),[,r]=oe(),[n,a]=p.useState(!1),[o,l]=p.useState(null);return p.useEffect(()=>{let d=!0;const u=setTimeout(async()=>{if(!n)try{console.log("🔄 Processing OAuth callback..."),a(!0),await i(),setTimeout(()=>{d&&(console.log("✅ OAuth callback processed, redirecting to app..."),r("/"))},1e3)}catch(h){console.error("❌ OAuth callback processing failed:",h),d&&(l(h.message||"Authentication failed"),setTimeout(()=>{window.location.href="/auth?error=oauth_failed"},3e3))}},100);return()=>{d=!1,clearTimeout(u)}},[i,n,r]),p.useEffect(()=>{t&&!s&&(console.log("✅ User already authenticated, redirecting..."),r("/"))},[t,s,r]),o?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 30%, #ecfdf5 70%, #f0fdfa 100%)"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15)",textAlign:"center",maxWidth:"400px",width:"90%",border:"1px solid #fee2e2"},children:[e.jsx("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",borderRadius:"50%",margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"24",height:"24",fill:"white",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})}),e.jsx("h2",{style:{margin:"0 0 12px 0",color:"#111827",fontSize:"24px",fontWeight:"bold"},children:"Authentication Failed"}),e.jsx("p",{style:{margin:"0 0 24px 0",color:"#6b7280",fontSize:"16px"},children:o}),e.jsx("p",{style:{margin:"0",color:"#9ca3af",fontSize:"14px"},children:"Redirecting to login page in a few seconds..."})]})}):e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 30%, #ecfdf5 70%, #f0fdfa 100%)"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15)",textAlign:"center",maxWidth:"400px",width:"90%"},children:[e.jsx("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"50%",margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center",animation:"spin 2s linear infinite"},children:e.jsx("span",{style:{fontSize:"24px",color:"white"},children:"Z"})}),e.jsx("h2",{style:{margin:"0 0 12px 0",color:"#111827",fontSize:"24px",fontWeight:"bold"},children:"Completing Sign In..."}),e.jsx("p",{style:{margin:"0 0 24px 0",color:"#6b7280",fontSize:"16px"},children:"Please wait while we finish setting up your account."}),e.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"4px"},children:[0,1,2].map(d=>e.jsx("div",{style:{width:"8px",height:"8px",background:"#10b981",borderRadius:"50%",animation:`bounce 1.4s ease-in-out ${d*.16}s infinite both`}},d))}),e.jsxs("div",{style:{marginTop:"20px",fontSize:"12px",color:"#9ca3af"},children:["Processed: ",n?"Yes":"No"," | Authenticated: ",t?"Yes":"No"," | Loading: ",s?"Yes":"No"]})]}),e.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
          
          @keyframes bounce {
            0%, 80%, 100% {
              transform: scale(0);
            }
            40% {
              transform: scale(1);
            }
          }
        `})]})},Rs=({id:i,value:t,onValueChange:s,placeholder:r,rows:n=3,maxLength:a=500,autoFocus:o=!1,className:l="",disabled:d=!1})=>{const c=p.useCallback(u=>{s(u.target.value)},[s]);return e.jsx("textarea",{id:i,value:t,onChange:c,className:`w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors ${l}`,rows:n,placeholder:r,maxLength:a,disabled:d,autoFocus:o,spellCheck:!1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",style:{minHeight:`${n*1.5}rem`,fontFamily:"inherit"}})},Xd=({predictionId:i})=>{const{user:t}=le(),{comments:s,commentCount:r,isLoading:n,error:a,isSubmitting:o,fetchComments:l,addComment:d,toggleCommentLike:c,clearError:u}=mr(i),[h,m]=p.useState(""),[f,y]=p.useState({}),[x,g]=p.useState({}),[j,v]=p.useState(null),[w,C]=p.useState(null);p.useEffect(()=>{i&&s.length===0&&!n&&l()},[i,s.length,n,l]);const z=p.useCallback(async b=>{const N=b?f[b]||"":h;if(N.trim()){if(!t){console.error("User not authenticated");return}try{await d(N.trim(),b),b?(y(F=>({...F,[b]:""})),v(null)):m("")}catch(F){console.error("Failed to add comment:",F)}}},[t,h,f,d]),S=p.useCallback(async b=>{if(t)try{await c(b)}catch(N){console.error("Failed to toggle like:",N)}},[t,c]),$=p.useCallback((b,N)=>{y(F=>({...F,[b]:N}))},[]),U=p.useCallback((b,N)=>{g(F=>({...F,[b]:N}))},[]),k=p.useCallback((b,N)=>{C(b),g(F=>({...F,[b]:N}))},[]),V=p.useCallback(b=>{C(null),g(N=>{const F={...N};return delete F[b],F})},[]),T=p.useCallback(b=>{v(b),y(N=>({...N,[b]:""}))},[]),_=p.useCallback(b=>{v(null),y(N=>{const F={...N};return delete F[b],F})},[]),O=he.memo(function b({comment:N,isReply:F=!1}){const[Y,R]=p.useState(!1),I=w===N.id,E=j===N.id;return e.jsx("div",{className:`comment-item ${F?"ml-8 pl-4 border-l-2 border-gray-100":""} py-4`,children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:N.user?.avatar_url?e.jsx("img",{src:N.user.avatar_url,alt:N.user.username,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-green-600 font-semibold text-sm",children:N.user?.username?.charAt(0)?.toUpperCase()||N.username?.charAt(0)?.toUpperCase()||"U"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900",children:N.user?.username||N.username||"Anonymous"}),(N.user?.is_verified||N.is_verified)&&e.jsx("span",{className:"text-blue-500 text-xs",children:"✓"}),e.jsx("span",{className:"text-xs text-gray-500",children:Rn(new Date(N.created_at),{addSuffix:!0})}),N.is_edited&&e.jsx("span",{className:"text-xs text-gray-400",children:"(edited)"})]}),e.jsx("div",{className:"mb-2",children:I?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Rs,{id:`edit-textarea-${N.id}`,value:x[N.id]||N.content,onValueChange:P=>U(N.id,P),placeholder:"Edit your comment...",rows:2,maxLength:500,autoFocus:!0}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[(x[N.id]||"").length,"/500"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{C(null)},disabled:!(x[N.id]||"").trim(),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"}),e.jsx("button",{onClick:()=>V(N.id),className:"px-3 py-1 bg-gray-300 text-gray-700 text-xs rounded hover:bg-gray-400",children:"Cancel"})]})]})]}):e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap leading-relaxed",children:N.content})}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[e.jsxs("button",{onClick:()=>S(N.id),className:`flex items-center space-x-1 hover:text-red-500 transition-colors ${N.is_liked?"text-red-500":"text-gray-500"}`,children:[e.jsx(tt,{size:14,className:N.is_liked?"fill-current":""}),e.jsx("span",{children:N.likes_count||0})]}),!F&&e.jsxs("button",{onClick:()=>E?_(N.id):T(N.id),className:"flex items-center space-x-1 text-gray-500 hover:text-blue-500 transition-colors",children:[e.jsx(Sc,{size:14}),e.jsx("span",{children:E?"Cancel":"Reply"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>R(!Y),className:"text-gray-400 hover:text-gray-600 transition-colors p-1",children:e.jsx(Nc,{size:14})}),Y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>R(!1)}),e.jsx("div",{className:"absolute right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-20 min-w-[120px]",children:N.is_own?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{k(N.id,N.content),R(!1)},className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(_c,{size:14,className:"mr-2"}),"Edit"]}),e.jsxs("button",{onClick:()=>{R(!1)},className:"flex items-center w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(an,{size:14,className:"mr-2"}),"Delete"]})]}):e.jsxs("button",{onClick:()=>{R(!1)},className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(vc,{size:14,className:"mr-2"}),"Report"]})})]})]})]}),E&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Rs,{id:`reply-textarea-${N.id}`,value:f[N.id]||"",onValueChange:P=>$(N.id,P),placeholder:`Reply to ${N.user?.username||N.username}...`,rows:2,maxLength:500,autoFocus:!0}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[(f[N.id]||"").length,"/500"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>z(N.id),disabled:!(f[N.id]||"").trim()||o,className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Replying...":"Reply"}),e.jsx("button",{onClick:()=>_(N.id),className:"px-3 py-1 bg-gray-300 text-gray-700 text-xs rounded hover:bg-gray-400",children:"Cancel"})]})]})]}),N.replies&&N.replies.length>0&&e.jsx("div",{className:"mt-3",children:N.replies.map(P=>e.jsx(b,{comment:P,isReply:!0},P.id))})]})]})})});return e.jsxs("div",{className:"comment-system bg-white",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(Ce,{size:20,className:"mr-2"}),"Comments (",r,")"]})}),a&&e.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-red-800 text-sm",children:a}),e.jsx("button",{onClick:u,className:"text-red-600 hover:text-red-800 text-sm",children:"Dismiss"})]})}),t&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.username,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-green-600 font-semibold text-sm",children:t.firstName?.[0]?.toUpperCase()||t.username?.charAt(0)?.toUpperCase()||t.email?.[0]?.toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(Rs,{id:"main-textarea",value:h,onValueChange:m,placeholder:"Share your thoughts...",rows:3,maxLength:500}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[h.length,"/500"]}),e.jsx("button",{onClick:()=>z(),disabled:!h.trim()||o,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium",children:o?"Posting...":"Comment"})]})]})]})}),!t&&e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("p",{className:"text-gray-600 text-center",children:["Please ",e.jsx("span",{className:"text-green-600 font-medium",children:"sign in"})," to join the conversation"]})}),n&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-green-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading comments..."})]}),!n&&e.jsx("div",{className:"divide-y divide-gray-100",children:s.map(b=>e.jsx(O,{comment:b},b.id))}),!n&&s.length===0&&!a&&e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Ce,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h4",{className:"text-lg font-medium mb-2",children:"No comments yet"}),e.jsx("p",{children:"Be the first to share your thoughts!"})]})]})},Qd=({predictionId:i,settlementData:t,userHasEntry:s=!1,className:r=""})=>{const{acceptOutcome:n,setDisputeModalOpen:a,loading:o}=wt(),[l,d]=p.useState(""),[c,u]=p.useState(!1);p.useEffect(()=>{if(!t.settled_at||t.state!=="settled")return;const f=()=>{const x=new Date(t.settled_at),g=new Date(x.getTime()+t.acceptance_window_hours*60*60*1e3),j=new Date,v=g.getTime()-j.getTime();if(v<=0){u(!0),d("Expired");return}const w=Math.floor(v/(1e3*60*60)),C=Math.floor(v%(1e3*60*60)/(1e3*60));d(`${w.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")} remaining`)};f();const y=setInterval(f,6e4);return()=>clearInterval(y)},[t.settled_at,t.acceptance_window_hours]);const h=async()=>{try{await n(i)}catch(f){console.error("Failed to accept outcome:",f)}},m=()=>{a(!0)};return t.state!=="settled"||!s||c?null:e.jsx("div",{className:`
      fixed bottom-0 left-0 right-0 z-50
      bg-white border-t border-gray-200 
      p-4 pb-safe-area-inset-bottom
      ${r}
    `,children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-600",children:["Review proof and Accept or Dispute within"," ",e.jsx("span",{className:"font-semibold text-amber-600",children:l})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No action → auto-accept"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:h,disabled:o,className:`flex-1 bg-green-600 hover:bg-green-700 disabled:bg-green-400
                       text-white font-semibold py-3 px-4 rounded-lg
                       transition-colors duration-200
                       flex items-center justify-center gap-2`,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Accepting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-lg",children:"✓"}),e.jsx("span",{children:"Accept"})]})}),e.jsx("button",{onClick:m,disabled:o,className:`px-6 py-3 text-gray-700 hover:text-gray-900 
                       font-medium border border-gray-300 hover:border-gray-400
                       rounded-lg transition-colors duration-200`,children:"Dispute"})]})]})})},eu=({events:i,className:t=""})=>{const s=(l,d)=>{switch(l.toLowerCase()){case"locked":return"🔒";case"source_fetched":return"📥";case"settled":return"✅";case"disputed":return"⚠️";case"voided":return"❌";case"accepted":return"👍";default:return d==="system"?"⚙️":"👤"}},r=l=>{switch(l.toLowerCase()){case"settled":return"text-green-600";case"disputed":return"text-red-600";case"voided":return"text-red-600";case"locked":return"text-amber-600";case"source_fetched":return"text-blue-600";case"accepted":return"text-green-600";default:return"text-gray-600"}},n=(l,d)=>{switch(l){case"system":return"System";case"oracle":return"Oracle";case"admin":return`Admin ${d?`(${d.slice(0,8)})`:""}`;case"user":return`User ${d?`(${d.slice(0,8)})`:""}`;default:return l}},a=l=>l.split("_").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" "),o=l=>new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return!i||i.length===0?e.jsx("div",{className:`text-center py-8 text-gray-500 ${t}`,children:e.jsx("p",{className:"text-sm",children:"No audit events available"})}):e.jsxs("div",{className:`space-y-4 ${t}`,children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Audit Timeline"}),e.jsx("div",{className:"space-y-3",children:i.map((l,d)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                w-8 h-8 rounded-full border-2 border-white 
                flex items-center justify-center text-xs
                ${r(l.event)} bg-gray-50
              `,children:s(l.event,l.actor_type)}),d<i.length-1&&e.jsx("div",{className:"w-0.5 bg-gray-200 h-6 mt-2"})]}),e.jsxs("div",{className:"flex-1 min-w-0 pb-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:`text-sm font-medium ${r(l.event)}`,children:a(l.event)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",n(l.actor_type,l.actor_id)]})]}),e.jsx("time",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:o(l.timestamp)})]}),l.data&&Object.keys(l.data).length>0&&e.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded text-xs",children:e.jsx("pre",{className:"text-gray-700 whitespace-pre-wrap",children:JSON.stringify(l.data,null,2)})})]})]},l.id))})]})},tu=({dispute:i,className:t=""})=>{const s=a=>{switch(a){case"open":return"bg-amber-100 text-amber-800 border-amber-200";case"under_review":return"bg-blue-100 text-blue-800 border-blue-200";case"upheld":return"bg-red-100 text-red-800 border-red-200";case"overturned":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},r=a=>{switch(a){case"wrong_source":return"Wrong Source Used";case"timing":return"Timing Issue";case"source_updated":return"Source Was Updated";case"other":return"Other";default:return a}},n=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${t}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-red-500 text-sm",children:"⚠️"}),e.jsxs("span",{className:"font-semibold text-gray-900 text-sm",children:["Dispute #",i.id.slice(0,8)]})]}),e.jsx("div",{className:`
          px-2 py-1 rounded-full text-xs font-medium border
          ${s(i.state)}
        `,children:i.state.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Reason:"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:r(i.reason)})]}),i.evidence&&i.evidence.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Evidence:"}),e.jsx("div",{className:"mt-1 space-y-1",children:i.evidence.map((a,o)=>e.jsx("div",{className:"text-sm",children:a.type==="link"?e.jsx("a",{href:a.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:a.value}):e.jsx("span",{className:"text-gray-700",children:a.value})},o))})]}),i.resolution_note&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded border",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Resolution:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:i.resolution_note})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("div",{children:["Created: ",n(i.created_at)]}),i.updated_at&&i.updated_at!==i.created_at&&e.jsxs("div",{children:["Updated: ",n(i.updated_at)]})]})]})},su=({predictionId:i,isOpen:t,onClose:s})=>{const{createDispute:r,loading:n}=wt(),[a,o]=p.useState("wrong_source"),[l,d]=p.useState(""),[c,u]=p.useState(""),h=[{value:"wrong_source",label:"Wrong Source Used",desc:"The settlement used an incorrect or unreliable source"},{value:"timing",label:"Timing Issue",desc:"Settlement occurred at wrong time or before event completion"},{value:"source_updated",label:"Source Was Updated",desc:"The source corrected or updated the information after settlement"},{value:"other",label:"Other",desc:"Other reason (please specify below)"}],m=async f=>{f.preventDefault();const y=l.split(`
`).filter(x=>x.trim()).map(x=>({type:"link",value:x.trim()}));a==="other"&&c.trim()&&y.push({type:"link",value:`Custom reason: ${c}`});try{await r(i,a,y),s(),o("wrong_source"),d(""),u("")}catch(x){console.error("Failed to create dispute:",x)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Dispute Settlement"}),e.jsxs("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Please provide a reason for your dispute and any supporting evidence."})]}),e.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Reason for dispute"}),e.jsx("div",{className:"space-y-2",children:h.map(f=>e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"reason",value:f.value,checked:a===f.value,onChange:y=>o(y.target.value),className:"mt-1 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.label}),e.jsx("div",{className:"text-xs text-gray-500",children:f.desc})]})]},f.value))})]}),a==="other"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customReason",className:"block text-sm font-medium text-gray-700 mb-1",children:"Please specify"}),e.jsx("textarea",{id:"customReason",value:c,onChange:f=>u(f.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe the issue in detail...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"evidence",className:"block text-sm font-medium text-gray-700 mb-1",children:"Supporting evidence (optional)"}),e.jsx("textarea",{id:"evidence",value:l,onChange:f=>d(f.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Paste URLs to supporting evidence, one per line..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Include links to news articles, official sources, or other relevant evidence."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:bg-red-400",disabled:n,children:n?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):"Submit Dispute"})]})]}),e.jsx("div",{className:"px-6 pb-6",children:e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-3",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," We've received your dispute. A reviewer will follow up within 24 hours. Fraudulent disputes may result in account restrictions."]})})})]})}):null},ru=({proof:i,className:t=""})=>{const s=async()=>{try{await navigator.clipboard.writeText(i.content_hash)}catch(a){console.error("Failed to copy hash:",a)}},r=()=>{window.open(i.source_url,"_blank","noopener,noreferrer")},n=a=>new Date(a).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"});return e.jsx("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${t}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-16 h-12 bg-gray-100 rounded border flex items-center justify-center flex-shrink-0",children:i.screenshot_url?e.jsx("img",{src:i.screenshot_url,alt:"Settlement proof",className:"w-full h-full object-cover rounded",loading:"lazy"}):e.jsx("span",{className:"text-gray-400 text-xs",children:"📄"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 truncate",children:"Settlement Proof"}),e.jsx("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:n(i.fetched_at)})]}),i.parser_note&&e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:i.parser_note}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:r,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Open source ↗"}),e.jsx("button",{onClick:s,className:"text-xs text-gray-600 hover:text-gray-800 font-medium",title:`Hash: ${i.content_hash}`,children:"Copy hash"})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 font-mono truncate",children:[i.content_hash.slice(0,16),"...",i.content_hash.slice(-8)]})]})]})})},iu=({method:i,badges:t=[],className:s=""})=>{const r=()=>t.includes("Oracle")?{text:"Oracle",icon:"🔮",bgColor:"bg-purple-100",textColor:"text-purple-700",borderColor:"border-purple-200"}:t.includes("Auto-Settled")?{text:"Auto-Settled",icon:"⚡",bgColor:"bg-green-100",textColor:"text-green-700",borderColor:"border-green-200"}:t.includes("Manual-Checked")?{text:"Manual-Checked",icon:"✓",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"}:i==="auto"?{text:"Auto-Settlement",icon:"⚡",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}:{text:"Manual Settlement",icon:"👤",bgColor:"bg-amber-100",textColor:"text-amber-700",borderColor:"border-amber-200"},{text:n,icon:a,bgColor:o,textColor:l,borderColor:d}=r();return e.jsxs("div",{className:`
      inline-flex items-center gap-1.5 px-2.5 py-1 
      ${o} ${l} ${d}
      border rounded-full text-xs font-medium
      ${s}
    `,children:[e.jsx("span",{className:"text-xs",children:a}),e.jsx("span",{children:n})]})},nu=({predictionId:i,state:t,userHasEntry:s=!1,className:r=""})=>{const{settlements:n,fetchSettlement:a}=wt(),[o,l]=p.useState(null);p.useEffect(()=>{a(i)},[i,a]),p.useEffect(()=>{n[i]&&l(n[i])},[n,i]);const c=(()=>{switch(t){case"settling":return{title:"Settlement in Progress",description:"We're fetching the official result...",icon:"⏳",bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"};case"settled":return{title:"Settlement Complete",description:"Official outcome has been determined",icon:"✅",bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200"};case"voided":return{title:"Event Voided",description:"Event postponed/cancelled—stakes returned",icon:"❌",bgColor:"bg-red-50",textColor:"text-red-700",borderColor:"border-red-200"};case"disputed":return{title:"Under Dispute",description:"Settlement is being reviewed",icon:"⚠️",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"};case"resolved":return{title:"Dispute Resolved",description:"Final outcome confirmed after review",icon:"🔍",bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"};default:return null}})();return c?e.jsx("div",{className:`
      ${c.bgColor} ${c.borderColor} ${c.textColor}
      border rounded-lg p-4 ${r}
    `,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:c.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",children:c.title}),e.jsx("p",{className:"text-sm opacity-90",children:c.description}),t==="settling"&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-xs",children:"Estimated time: ~10 minutes"})]}),e.jsx("p",{className:"text-xs mt-2 opacity-75",children:"We'll notify you when the outcome is available."})]}),t==="settled"&&o?.outcome&&e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-white rounded-full text-sm font-semibold",children:[e.jsx("span",{children:"Outcome:"}),e.jsx("span",{className:o.outcome==="YES"?"text-green-600":"text-red-600",children:o.outcome})]})}),t==="voided"&&e.jsx("div",{className:"mt-3",children:e.jsx("p",{className:"text-xs opacity-75",children:"All participants will receive their original stake back."})})]})]})}):null},au=({predictionId:i,settlement:t,isOpen:s,onClose:r})=>{const{settlementConfigs:n,fetchSettlement:a}=wt(),[o,l]=p.useState(t||null);p.useEffect(()=>{s&&i&&!t&&a(i)},[s,i,t,a]),p.useEffect(()=>{i&&n[i]?l(n[i]):t&&l(t)},[n,i,t]);const d=async()=>{if(o)try{await navigator.clipboard.writeText(o.rule_text)}catch(u){console.error("Failed to copy rule:",u)}},c=(u,h)=>{const m={postponed:"If event is postponed",source_down:"If source is unavailable"},f={auto_void:"Automatically void and return stakes",extend_lock:"Extend the lock time",keep_open:"Keep prediction open",use_backup:"Use backup source",pause_and_escalate:"Pause and escalate to admin"};return`${m[u]||u}: ${f[h]||h}`};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"How This Settles"}),e.jsxs("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"This market will be settled using official sources."})]}),e.jsx("div",{className:"p-6 space-y-6",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Settlement Rule"}),e.jsx("button",{onClick:d,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Copy rule"})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:o.rule_text})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Sources"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.primary_source.name}),e.jsx("div",{className:"text-xs text-gray-600",children:o.primary_source.url})]}),e.jsx("span",{className:"text-xs bg-green-600 text-white px-2 py-1 rounded-full font-semibold",children:"PRIMARY"})]}),o.backup_source&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.backup_source.name}),e.jsx("div",{className:"text-xs text-gray-600",children:o.backup_source.url})]}),e.jsx("span",{className:"text-xs bg-amber-600 text-white px-2 py-1 rounded-full font-semibold",children:"BACKUP"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 mb-1",children:"Settlement Method"}),e.jsx("p",{className:"text-sm text-gray-900 capitalize",children:o.method.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 mb-1",children:"Timezone"}),e.jsx("p",{className:"text-sm text-gray-900",children:o.timezone})]})]}),o.contingencies&&Object.keys(o.contingencies).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Contingency Rules"}),e.jsx("div",{className:"space-y-2",children:Object.entries(o.contingencies).map(([u,h])=>e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded border",children:c(u,h)},u))})]}),o.badges&&o.badges.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Quality Indicators"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.badges.map((u,h)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:u.replace("-"," ")},h))})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading settlement information..."})]})}),e.jsx("div",{className:"px-6 pb-6",children:e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-3",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," We settle using public, official sources—no rumors. All settlements are auditable and transparent."]})})})]})}):null},oi=({timezone:i,timestamp:t,className:s=""})=>{const[r,n]=p.useState(!1),a=new Date(t),o=(d,c)=>{if(c==="UTC"||r)return d.toISOString().replace("T"," ").slice(0,19)+" UTC";try{return new Intl.DateTimeFormat("en-US",{timeZone:c,year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"}).format(d)}catch{return d.toISOString().replace("T"," ").slice(0,19)+" UTC"}},l=()=>{n(!r)};return e.jsx("div",{className:`inline-flex items-center ${s}`,children:e.jsxs("button",{onClick:l,className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium 
                   text-gray-700 bg-gray-100 hover:bg-gray-200 
                   border border-gray-200 rounded transition-colors`,children:[e.jsx("span",{className:"text-[10px]",children:"🕐"}),e.jsx("span",{children:o(a,i)}),e.jsx("span",{className:"text-[10px] text-gray-500",children:r?"→ Local":"→ UTC"})]})})},ou=({predictionId:i,onNavigateBack:t})=>{const[,s]=oe(),[r,n]=p.useState(null),[a,o]=p.useState(""),[l,d]=p.useState(!1),[c,u]=p.useState(null),[h,m]=p.useState(!0),[f,y]=p.useState(!1),[x,g]=p.useState(!1),[j,v]=p.useState(!1),[w,C]=p.useState(!1),z=p.useRef(null),S=p.useRef(null),{predictions:$,fetchPredictions:U,placePrediction:k}=yt(),{isAuthenticated:V,user:T}=le(),{getBalance:_}=ms(),{checkIfLiked:O,getLikeCount:b,toggleLike:N}=hr(),{settlements:F,disputes:Y,auditTimeline:R,fetchSettlement:I,fetchDisputes:E,fetchAuditTimeline:P,disputeModalOpen:W,setDisputeModalOpen:K}=wt(),te=()=>{if(i)return i;const Q=window.location.pathname.match(/\/prediction\/([^\/]+)/);return Q?Q[1]:null},ce=te(),{commentCount:jt}=mr(ce||"");p.useEffect(()=>{(async()=>{const Q=te();if(!Q){console.log("❌ No prediction ID found"),s("/discover");return}console.log("🔍 Loading prediction with ID:",Q),m(!0);try{let de=$.find(Nt=>Nt.id===Q);if(de){console.log("✅ Found prediction in store:",de.title),u(de),["locked","settling","settled","voided","disputed","resolved"].includes(de.status)&&(await I(Q),await E(Q),await P(Q)),m(!1);return}$.length===0?(console.log("📡 Fetching predictions from server..."),await U(),de=$.find(Nt=>Nt.id===Q),de?(console.log("✅ Found prediction after fetch:",de.title),u(de),["locked","settling","settled","voided","disputed","resolved"].includes(de.status)&&(await I(Q),await E(Q),await P(Q))):(console.log("❌ Prediction not found after fetch"),u(null))):(console.log("❌ Prediction not found in available predictions"),u(null))}catch(de){console.error("❌ Error loading prediction:",de),u(null)}finally{m(!1)}})()},[i,$,U,s,I,E,P]);const kt=()=>{if(console.log("🔙 Navigating back"),t)t();else try{window.history.length>1?window.history.back():s("/discover")}catch(H){console.error("Navigation error:",H),s("/discover")}},ke=H=>{console.log("🎯 Option selected:",H),n(H)},bs=H=>{const Q=H.target.value;(Q===""||/^\d+(\.\d{0,2})?$/.test(Q))&&o(Q)},Ht=async()=>{if(!V){G.error("Please sign in to place a prediction");return}if(!r){G.error("Please select an option");return}const H=parseFloat(a);if(!H||H<c.stake_min){G.error(`Minimum stake is $${c.stake_min}`);return}if(c.stake_max&&H>c.stake_max){G.error(`Maximum stake is $${c.stake_max}`);return}const Q=_("USD");if(H>Q){G.error("Insufficient wallet balance");return}d(!0);try{console.log("🎲 Placing prediction:",{predictionId:c.id,optionId:r,amount:H}),await k({predictionId:c.id,optionId:r,amount:H,userId:T?.id||""}),G.success("Prediction placed successfully!"),o(""),n(null),setTimeout(()=>{U()},1e3)}catch(de){console.error("❌ Failed to place prediction:",de);const Nt=de instanceof Error?de.message:"Failed to place prediction";G.error(Nt)}finally{d(!1)}},ys=()=>{const H=`${window.location.origin}/prediction/${c?.id}`,Q=`${c?.title}

Make your prediction on Fan Club Z!`;navigator.share?navigator.share({title:c?.title,text:Q,url:H}).catch(console.error):navigator.clipboard.writeText(`${Q}
${H}`).then(()=>G.success("Link copied to clipboard!")).catch(()=>G.error("Failed to copy link"))},L=async()=>{if(!V){G.error("Please sign in to like this prediction");return}try{await N(c.id),G.success(O(c.id)?"Liked prediction!":"Removed like")}catch{G.error("Failed to update like")}},re=()=>{console.log("💬 Toggling comments from:",f,"to:",!f);const H=!f;y(H),H?setTimeout(()=>{z.current&&z.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},300):S.current&&S.current.scrollIntoView({behavior:"smooth",block:"center"})},xe=()=>c?.creator?{id:c.creator.id||c.creator_id,username:c.creator.username||c.creator.full_name||"creator",displayName:c.creator.full_name||c.creator.username,avatar_url:c.creator.avatar_url}:c?.creator_id?{id:c.creator_id,username:"creator",displayName:"Creator"}:{id:"unknown",username:"Fan Club Z",displayName:"Fan Club Z"},ae=c?.user_entry||c?.entries?.some(H=>H.user_id===T?.id),Le=F[c?.id],yr=Y[c?.id]||[],vr=R[c?.id]||[];if(h)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsx("div",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("button",{onClick:kt,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(et,{size:20}),e.jsx("span",{className:"font-medium",children:"Back"})]})})})}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-green-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading prediction..."})]})})]});if(!c)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsx("div",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("button",{onClick:kt,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(et,{size:20}),e.jsx("span",{className:"font-medium",children:"Back"})]})})})}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Prediction Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The prediction you're looking for doesn't exist or has been removed."}),e.jsx("button",{onClick:()=>s("/discover"),className:"bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Browse Predictions"})]})})]});const wr=c.options?.find(H=>H.id===r),jr=wr&&a?parseFloat(a)*wr.current_odds:0,Sn=c.status==="open"&&new Date(c.entry_deadline)>new Date,qt=xe();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:kt,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(et,{size:20}),e.jsx("span",{className:"font-medium",children:"Back"})]}),e.jsx("button",{onClick:ys,className:"p-2 text-gray-600 hover:text-gray-900 transition-colors rounded-lg hover:bg-gray-100",children:e.jsx(rn,{size:20})})]})})}),e.jsxs("div",{className:"px-4 py-6 max-w-2xl mx-auto pb-24",children:[e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:qt.username?.charAt(0)?.toUpperCase()||"FC"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ns,{username:qt.username,userId:qt.id,displayName:qt.displayName,className:"font-semibold text-gray-900 text-lg hover:text-green-600 transition-colors",showAt:!1})}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(c.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),c.settlement?.method&&e.jsx(iu,{method:c.settlement.method,badges:c.settlement.badges})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4 leading-tight",children:c.title}),c.description&&e.jsx("p",{className:"text-gray-600 mb-6 leading-relaxed text-base",children:c.description}),c.settlement&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Settlement Rule:"}),e.jsx("button",{onClick:()=>g(!0),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View full rule"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:c.settlement.rule_text})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-xl",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",(c.pool_total||0).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Pool"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.participant_count||0}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Participants"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:c.options?.length||0}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Options"})]})]}),c.status==="open"&&e.jsxs("div",{className:"flex items-center gap-3 text-orange-600 bg-orange-50 px-4 py-3 rounded-xl",children:[e.jsx(He,{size:20}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[Sd(c.entry_deadline)," remaining"]}),e.jsx("div",{className:"text-sm text-orange-500",children:e.jsx(oi,{timezone:c.settlement?.timezone||"UTC",timestamp:c.entry_deadline})})]})]}),c.lock_time&&c.status!=="open"&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-600 bg-gray-50 px-4 py-3 rounded-xl",children:[e.jsx(He,{size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Locked at"}),e.jsx("div",{className:"text-sm",children:e.jsx(oi,{timezone:c.settlement?.timezone||"UTC",timestamp:c.lock_time})})]})]})]}),["settling","settled","voided","disputed","resolved"].includes(c.status)&&e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"mb-6",children:e.jsx(nu,{predictionId:c.id,state:c.status,userHasEntry:ae})}),c.status==="settled"&&Le?.proof&&e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Settlement Proof"}),e.jsx("button",{onClick:()=>v(!j),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:j?"Hide details":"Show details"})]}),e.jsx(ru,{proof:Le.proof}),j&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Technical Details"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Content Hash:"})," ",Le.proof.content_hash]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Fetched At:"})," ",new Date(Le.proof.fetched_at).toLocaleString()]}),Le.proof.parser_note&&e.jsxs("div",{children:[e.jsx("strong",{children:"Parser Note:"})," ",Le.proof.parser_note]})]})]})]})}),yr.length>0&&e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"mb-6",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Disputes"}),e.jsx("div",{className:"space-y-4",children:yr.map(H=>e.jsx(tu,{dispute:H},H.id))})]})}),vr.length>0&&e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-6",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Audit Timeline"}),e.jsx("button",{onClick:()=>C(!w),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:w?"Hide timeline":"Show timeline"})]}),w&&e.jsx(eu,{events:vr})]})}),Sn&&e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Place Your Prediction"}),e.jsx("div",{className:"space-y-3 mb-6",children:c.options?.map((H,Q)=>e.jsx(A.button,{onClick:()=>ke(H.id),className:`w-full p-4 rounded-xl border-2 transition-all ${r===H.id?"border-green-500 bg-green-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,whileHover:{scale:1.01},whileTap:{scale:.99},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 text-lg mb-1",children:H.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[c.pool_total>0?`${(H.total_staked/c.pool_total*100).toFixed(1)}% of pool`:"0% of pool"," • $",(H.total_staked||0).toLocaleString()," staked"]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(H.current_odds||1).toFixed(2),"x"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"odds"})]})]})},H.id))}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Stake Amount (USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-lg",children:"$"}),e.jsx("input",{type:"text",value:a,onChange:bs,placeholder:"0.00",className:"w-full pl-10 pr-4 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition-colors text-lg"})]}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500 mt-2",children:[e.jsxs("span",{children:["Min: $",c.stake_min]}),e.jsxs("span",{children:["Max: $",c.stake_max||"No limit"]})]})]}),e.jsx(je,{children:r&&a&&e.jsxs(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-green-50 border-2 border-green-200 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-green-800 font-semibold",children:"Potential Payout:"}),e.jsxs("span",{className:"text-green-800 font-bold text-xl",children:["$",jr.toFixed(2)]})]}),e.jsxs("div",{className:"text-green-700 text-sm",children:["Profit: $",Math.max(0,jr-parseFloat(a)).toFixed(2)]})]})}),e.jsx(A.button,{onClick:Ht,disabled:!r||!a||l,className:`w-full py-4 rounded-xl font-semibold text-white transition-all text-lg ${r&&a&&!l?"bg-green-500 hover:bg-green-600 active:bg-green-700 shadow-lg":"bg-gray-300 cursor-not-allowed"}`,whileHover:r&&a&&!l?{scale:1.02}:{},whileTap:r&&a&&!l?{scale:.98}:{},children:l?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Placing Prediction..."]}):"Place Prediction"})]}),e.jsxs(A.div,{ref:S,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Community Engagement"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs(A.button,{onClick:L,className:`flex items-center gap-2 transition-colors ${O(c.id)?"text-red-500":"text-gray-600 hover:text-red-500"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(tt,{size:20,fill:O(c.id)?"currentColor":"none"}),e.jsxs("span",{className:"font-medium",children:[b(c.id)," likes"]})]}),e.jsxs(A.button,{onClick:re,className:`flex items-center gap-2 transition-colors ${f?"text-blue-500":"text-gray-600 hover:text-blue-500"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Ce,{size:20}),e.jsxs("span",{className:"font-medium",children:[jt," comments"]}),e.jsx(yc,{size:16,className:`transition-transform ml-1 ${f?"rotate-180":""}`})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx($e,{size:20}),e.jsxs("span",{className:"font-medium",children:[c.participant_count||0," participants"]})]})]})]}),e.jsx(je,{children:f&&e.jsxs(A.div,{ref:z,initial:{opacity:0,y:-20,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:-20,height:0},transition:{duration:.4,ease:"easeInOut"},className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-6",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Comments"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Join the conversation about this prediction"})]}),e.jsx("div",{className:"min-h-[300px] max-h-[600px] overflow-y-auto",children:e.jsx(Xd,{predictionId:c?.id||""})})]})})]})]}),e.jsx(au,{predictionId:c?.id,settlement:c?.settlement,isOpen:x,onClose:()=>g(!1)}),e.jsx(su,{predictionId:c?.id||"",isOpen:W,onClose:()=>K(!1)}),c.status==="settled"&&ae&&Le&&e.jsx(Qd,{predictionId:c.id,settlementData:Le,userHasEntry:ae})]})},lu=({activeTab:i="discover",onTabChange:t,showFAB:s=!1,onFABClick:r})=>{const n=[{id:"discover",label:"Discover",icon:tn},{id:"bets",label:"My Bets",icon:$e},{id:"wallet",label:"Wallet",icon:Rc},{id:"profile",label:"Profile",icon:on}],a=o=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"}),t&&t(o)};return e.jsx("div",{style:{position:"fixed",bottom:"0",left:"0",right:"0",zIndex:"1000",backgroundColor:"white",borderTop:"1px solid #e5e7eb",paddingBottom:"max(env(safe-area-inset-bottom), 0.5rem)",paddingTop:"0.5rem",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.1)"},children:e.jsxs("nav",{style:{padding:"0 1rem",position:"relative"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around",maxWidth:"400px",margin:"0 auto",position:"relative"},children:n.map(o=>{const l=o.icon,d=i===o.id;return e.jsxs(A.button,{onClick:()=>a(o.id),whileHover:{scale:1.05},whileTap:{scale:.95},style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"8px 4px",minWidth:"0",flex:"1",position:"relative",background:"none",border:"none",cursor:"pointer",borderRadius:"12px",transition:"all 0.2s ease"},onMouseEnter:c=>{d||(c.currentTarget.style.backgroundColor="#f9fafb")},onMouseLeave:c=>{d||(c.currentTarget.style.backgroundColor="transparent")},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"6px",marginTop:"2px",width:"24px",height:"24px"},children:[e.jsx("div",{style:{transition:"all 0.2s ease",color:d?"#22c55e":"#6b7280",transform:d?"scale(1.1)":"scale(1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(l,{size:20})}),d&&e.jsx(A.div,{layoutId:"activeTab",style:{position:"absolute",top:"-6px",left:"50%",transform:"translateX(-50%)",width:"4px",height:"4px",backgroundColor:"#22c55e",borderRadius:"50%",boxShadow:"0 0 6px rgba(34, 197, 94, 0.6)"},initial:!1,transition:{type:"spring",stiffness:400,damping:30}})]}),e.jsx("span",{style:{fontSize:"11px",fontWeight:d?"600":"500",transition:"all 0.2s ease",color:d?"#22c55e":"#6b7280",textAlign:"center",lineHeight:"1.2"},children:o.label})]},o.id)})}),s&&e.jsx(A.button,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:r,style:{position:"fixed",bottom:"calc(80px + env(safe-area-inset-bottom, 0px))",right:"16px",width:"56px",height:"56px",borderRadius:"50%",background:"linear-gradient(135deg, #22c55e, #16a34a)",border:"none",boxShadow:"0 8px 24px rgba(34, 197, 94, 0.4)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:e.jsx(Ot,{size:24,style:{color:"white"}})})]})})},kn=({message:i="Loading..."})=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:i})]})}),Nn=p.memo(({children:i})=>{const{isAuthenticated:t,loading:s,initialized:r,initializeAuth:n}=le();return p.useEffect(()=>{!r&&!s&&n()},[r,s,n]),!r||s&&!t?e.jsx(kn,{message:"Authenticating..."}):t?e.jsx(e.Fragment,{children:i}):e.jsx(Yd,{})});Nn.displayName="AuthGuard";const _n=p.memo(({children:i})=>{const[t,s]=oe(),r=p.useCallback(()=>{const l=t.toLowerCase();return l==="/"||l==="/discover"?"discover":l==="/bets"||l==="/predictions"?"bets":l==="/profile"?"profile":l==="/wallet"?"wallet":"discover"},[t]),n=p.useCallback(l=>{if(r()!==l){switch(l){case"discover":s("/");break;case"bets":s("/predictions");break;case"profile":s("/profile");break;case"wallet":s("/wallet");break;default:s("/")}setTimeout(()=>{We()},50)}},[s,r]),a=p.useCallback(()=>{s("/create")},[s]),o=r()==="discover";return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("main",{className:"flex-1 pb-20",children:e.jsx(p.Suspense,{fallback:e.jsx(kn,{message:"Loading page..."}),children:i})}),e.jsx(lu,{activeTab:r(),onTabChange:n,showFAB:o,onFABClick:a}),e.jsx(Zi,{}),e.jsx(Mc,{}),e.jsx(uc,{position:"top-center",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})});_n.displayName="MainLayout";const zs=()=>{const[,i]=oe(),t=p.useCallback(()=>{i("/profile")},[i]),s=p.useCallback(r=>{i(`/prediction/${r}`)},[i]);return e.jsx(Re,{title:"Discover",children:e.jsx(wn,{onNavigateToProfile:t,onNavigateToPrediction:s})})},li=()=>{const[,i]=oe(),t=p.useCallback(()=>{i("/")},[i]);return e.jsx(Re,{title:"My Predictions",children:e.jsx(Ud,{onNavigateToDiscover:t})})},cu=()=>{const[,i]=oe(),t=p.useCallback(()=>{i("/")},[i]);return e.jsx(Re,{title:"Create Prediction",children:e.jsx(zd,{onNavigateBack:t})})},du=()=>{const[,i]=oe(),[t]=oe(),s=p.useCallback(()=>{i("/")},[i]),r=t.split("/profile/")[1];return e.jsx(Re,{title:"Profile",children:e.jsx(jn,{onNavigateBack:s,userId:r})})},uu=()=>{const[,i]=oe(),t=p.useCallback(()=>{i("/")},[i]);return e.jsx(Re,{title:"My Profile",children:e.jsx(jn,{onNavigateBack:t})})},hu=()=>{const[,i]=oe(),t=p.useCallback(()=>{i("/")},[i]);return e.jsx(Re,{title:"Wallet",children:e.jsx(Kd,{onNavigateBack:t})})},pu=({params:i})=>{const[,t]=oe(),s=p.useCallback(()=>{t("/")},[t]);return i?.id?e.jsx(Re,{title:"Prediction Details",children:e.jsx(ou,{predictionId:i.id,onNavigateBack:s})}):e.jsx(Re,{title:"Error",children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Prediction Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The prediction you're looking for doesn't exist."}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:"Go Back"})]})})})};function mu(){const{initializeWallet:i}=ms(),{initializeAuth:t,isAuthenticated:s,loading:r,initialized:n}=le(),{initializeLikes:a}=hr(),{initialize:o}=pr();return p.useEffect(()=>{if(!n&&!r)try{console.log("App: Initializing auth..."),t()}catch(l){console.error("Auth initialization failed:",l)}},[t,n,r]),p.useEffect(()=>{if(s&&!r&&n)try{console.log("App: Initializing wallet and social features..."),i(),a(),o(),console.log("✅ All stores initialized successfully")}catch(l){console.error("Store initialization failed:",l)}},[s,r,n,i,a,o]),e.jsx(xi,{children:e.jsxs(Er,{children:[e.jsx(be,{path:"/auth/callback",children:e.jsx(Re,{title:"Authentication",children:e.jsx(Zd,{})})}),e.jsx(Nn,{children:e.jsx(_n,{children:e.jsxs(Er,{children:[e.jsx(be,{path:"/",component:zs}),e.jsx(be,{path:"/discover",component:zs}),e.jsx(be,{path:"/predictions",component:li}),e.jsx(be,{path:"/bets",component:li}),e.jsx(be,{path:"/create",component:cu}),e.jsx(be,{path:"/profile",component:uu}),e.jsx(be,{path:"/profile/:userId",component:du}),e.jsx(be,{path:"/wallet",component:hu}),e.jsx(be,{path:"/prediction/:id",component:pu}),e.jsx(be,{component:zs})]})})})]})})}console.log(`🚀 Fan Club Z ${xs} - CONSOLIDATED ARCHITECTURE - SINGLE SOURCE OF TRUTH`);window.addEventListener("unhandledrejection",i=>{console.error("Unhandled promise rejection:",i.reason)});window.addEventListener("error",i=>{console.error("Global error:",i.error)});Ls.createRoot(document.getElementById("root")).render(e.jsx(he.StrictMode,{children:e.jsx(cn,{onError:(i,t)=>{console.error("React Error Boundary triggered:",i,t)},children:e.jsx(mu,{})})}));console.log(`✅ Fan Club Z ${xs} - Application started successfully`);console.log("🚀 Build timestamp:",Hd);
