services:
  # Frontend - Static Site
  - type: web
    name: fanclubz-frontend
    env: static
    buildCommand: cd client && pnpm install --frozen-lockfile && pnpm build
    staticPublishPath: ./client/dist
    headers:
      - path: /*
        name: X-Frame-Options
        value: SAMEORIGIN
      - path: /*
        name: X-Content-Type-Options  
        value: nosniff
      - path: /assets/*
        name: Cache-Control
        value: public, immutable, max-age=31536000
    routes:
      - type: rewrite
        source: /api/*
        destination: https://fan-club-z.onrender.com/*
      - type: rewrite
        source: /*
        destination: /index.html
    envVars:
      - key: VITE_API_BASE
        value: /api
      - key: VITE_IMAGES_FEATURE_FLAG
        value: "false"
      - key: VITE_IMAGES_PROVIDER
        value: none
      - key: NODE_VERSION
        value: "20"
        
  # Backend API (reference - may already exist)
  - type: web
    name: fanclubz-api
    env: node
    buildCommand: cd server && pnpm install --frozen-lockfile && pnpm build
    startCommand: cd server && pnpm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "10000"
      # Add your database and auth environment variables here
      # These should be set in Render dashboard, not in this file
      - key: CORS_ORIGIN
        value: https://fanclubz-frontend.onrender.com