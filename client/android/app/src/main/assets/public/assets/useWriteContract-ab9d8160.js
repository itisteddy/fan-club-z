import{N as X,O as Z,V as tt,Y as nt,$ as et,B as rt,a0 as k,a1 as ot,a2 as ct,a3 as at,a4 as st,j as it,a5 as ut,a6 as dt,a7 as ft,a8 as lt,K as I}from"./index-6112b649.js";import{r as E}from"./vendor-499a370b.js";import{g as ht,A as W,a as wt,b as Ct,c as A,d as yt,f as pt,e as mt,p as gt,h as vt,i as Et,j as T,k as St,l as It,m as bt}from"./public-3a03d500.js";import{u as G}from"./utils-17ec81d9.js";function At({chain:t,currentChainId:n}){if(!t)throw new X;if(n!==t.id)throw new Z({chain:t,currentChainId:n})}function Rt(t,{docsPath:n,...e}){const r=(()=>{const o=ht(t,e);return o instanceof tt?t:o})();return new nt(r,{docsPath:n,...e})}const N=new et(128);async function Ot(t,n){const{account:e=t.account,chain:r=t.chain,accessList:o,authorizationList:a,blobs:c,data:s,gas:u,gasPrice:f,maxFeePerBlobGas:i,maxFeePerGas:l,maxPriorityFeePerGas:C,nonce:d,type:h,value:y,...F}=n;if(typeof e>"u")throw new W({docsPath:"/docs/actions/wallet/sendTransaction"});const w=e?k(e):null;try{wt(n);const p=await(async()=>{if(n.to)return n.to;if(n.to!==null&&a&&a.length>0)return await Ct({authorization:a[0]}).catch(()=>{throw new rt("`to` is required. Could not infer from `authorizationList`.")})})();if(w?.type==="json-rpc"||w===null){let v;r!==null&&(v=await A(t,yt,"getChainId")({}),At({currentChainId:v,chain:r}));const b=t.chain?.formatters?.transactionRequest?.format,z=(b||pt)({...mt(F,{format:b}),accessList:o,account:w,authorizationList:a,blobs:c,chainId:v,data:s,gas:u,gasPrice:f,maxFeePerBlobGas:i,maxFeePerGas:l,maxPriorityFeePerGas:C,nonce:d,to:p,type:h,value:y},"sendTransaction"),D=N.get(t.uid),Q=D?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:Q,params:[z]},{retryCount:0})}catch(L){if(D===!1)throw L;const m=L;if(m.name==="InvalidInputRpcError"||m.name==="InvalidParamsRpcError"||m.name==="MethodNotFoundRpcError"||m.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[z]},{retryCount:0}).then(P=>(N.set(t.uid,!0),P)).catch(P=>{const j=P;throw j.name==="MethodNotFoundRpcError"||j.name==="MethodNotSupportedRpcError"?(N.set(t.uid,!1),m):j});throw m}}if(w?.type==="local"){const v=await A(t,gt,"prepareTransactionRequest")({account:w,accessList:o,authorizationList:a,blobs:c,chain:r,data:s,gas:u,gasPrice:f,maxFeePerBlobGas:i,maxFeePerGas:l,maxPriorityFeePerGas:C,nonce:d,nonceManager:w.nonceManager,parameters:[...vt,"sidecars"],type:h,value:y,...F,to:p}),b=r?.serializers?.transaction,_=await w.signTransaction(v,{serializer:b});return await A(t,Et,"sendRawTransaction")({serializedTransaction:_})}throw w?.type==="smart"?new T({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new T({docsPath:"/docs/actions/wallet/sendTransaction",type:w?.type})}catch(p){throw p instanceof T?p:Rt(p,{...n,account:w,chain:n.chain||void 0})}}async function R(t,n){return R.internal(t,Ot,"sendTransaction",n)}(function(t){async function n(e,r,o,a){const{abi:c,account:s=e.account,address:u,args:f,dataSuffix:i,functionName:l,...C}=a;if(typeof s>"u")throw new W({docsPath:"/docs/contract/writeContract"});const d=s?k(s):null,h=St({abi:c,args:f,functionName:l});try{return await A(e,r,o)({data:`${h}${i?i.replace("0x",""):""}`,to:u,account:d,...C})}catch(y){throw It(y,{abi:c,address:u,args:f,docsPath:"/docs/contract/writeContract",functionName:l,sender:d?.address})}}t.internal=n})(R||(R={}));function Pt(t,n,e){const r=t[n.name];if(typeof r=="function")return r;const o=t[e];return typeof o=="function"?o:a=>n(t,a)}function jt(t,n={}){const{key:e="custom",methods:r,name:o="Custom Provider",retryDelay:a}=n;return({retryCount:c})=>ot({key:e,methods:r,name:o,request:t.request.bind(t),retryCount:n.retryCount??c,retryDelay:a,type:"custom"})}async function Tt(t,n={}){const{assertChainId:e=!0}=n;let r;if(n.connector){const{connector:i}=n;if(t.state.status==="reconnecting"&&!i.getAccounts&&!i.getChainId)throw new ct({connector:i});const[l,C]=await Promise.all([i.getAccounts().catch(d=>{if(n.account===null)return[];throw d}),i.getChainId()]);r={accounts:l,chainId:C,connector:i}}else r=t.state.connections.get(t.state.current);if(!r)throw new at;const o=n.chainId??r.chainId,a=await r.connector.getChainId();if(e&&a!==o)throw new st({connectionChainId:o,connectorChainId:a});const c=r.connector;if(c.getClient)return c.getClient({chainId:o});const s=k(n.account??r.accounts[0]);if(s&&(s.address=it(s.address)),n.account&&!r.accounts.some(i=>i.toLowerCase()===s.address.toLowerCase()))throw new ut({address:s.address,connector:c});const u=t.chains.find(i=>i.id===o),f=await r.connector.getProvider({chainId:o});return dt({account:s,chain:u,name:"Connector Client",transport:i=>jt(f)({...i,retryCount:0})})}function U(t){const n=t.state.current,e=t.state.connections.get(n),r=e?.accounts,o=r?.[0],a=t.chains.find(s=>s.id===e?.chainId),c=t.state.status;switch(c){case"connected":return{address:o,addresses:r,chain:a,chainId:e?.chainId,connector:e?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:c};case"reconnecting":return{address:o,addresses:r,chain:a,chainId:e?.chainId,connector:e?.connector,isConnected:!!o,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:c};case"connecting":return{address:o,addresses:r,chain:a,chainId:e?.chainId,connector:e?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:c};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:c}}}function S(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;let e,r;if(Array.isArray(t)&&Array.isArray(n)){if(e=t.length,e!==n.length)return!1;for(r=e;r--!==0;)if(!S(t[r],n[r]))return!1;return!0}if(typeof t.valueOf=="function"&&t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString)return t.toString()===n.toString();const o=Object.keys(t);if(e=o.length,e!==Object.keys(n).length)return!1;for(r=e;r--!==0;)if(!Object.hasOwn(n,o[r]))return!1;for(r=e;r--!==0;){const a=o[r];if(a&&!S(t[a],n[a]))return!1}return!0}return t!==t&&n!==n}let x=[];function V(t){const n=t.chains;return S(x,n)?x:(x=n,n)}function Nt(t,n={}){try{return t.getClient(n)}catch{return}}function $(t,n={}){return Nt(t,n)?.extend(bt)}async function xt(t,n){const{addEthereumChainParameter:e,chainId:r}=n,o=t.state.connections.get(n.connector?.uid??t.state.current);if(o){const c=o.connector;if(!c.switchChain)throw new ft({connector:c});return await c.switchChain({addEthereumChainParameter:e,chainId:r})}const a=t.chains.find(c=>c.id===r);if(!a)throw new lt;return t.setState(c=>({...c,chainId:r})),a}function Mt(t,n){const{onChange:e}=n;return t.subscribe(()=>U(t),e,{equalityFn(r,o){const{connector:a,...c}=r,{connector:s,...u}=o;return S(c,u)&&a?.id===s?.id&&a?.uid===s?.uid}})}function qt(t,n){const{onChange:e}=n;return t.subscribe(()=>$(t),e,{equalityFn(r,o){return r?.uid===o?.uid}})}async function $t(t,n){const{account:e,chainId:r,connector:o,...a}=n;let c;return typeof e=="object"&&e?.type==="local"?c=t.getClient({chainId:r}):c=await Tt(t,{account:e??void 0,assertChainId:!1,chainId:r,connector:o}),await Pt(c,R,"writeContract")({...a,...e?{account:e}:{},chain:r?{id:r}:null})}function kt(t,n){const{onChange:e}=n;return t._internal.chains.subscribe((r,o)=>{e(r,o)})}var K={exports:{}},B={},Y={exports:{}},H={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=E;function Ft(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var _t=typeof Object.is=="function"?Object.is:Ft,zt=g.useState,Dt=g.useEffect,Lt=g.useLayoutEffect,Vt=g.useDebugValue;function Wt(t,n){var e=n(),r=zt({inst:{value:e,getSnapshot:n}}),o=r[0].inst,a=r[1];return Lt(function(){o.value=e,o.getSnapshot=n,M(o)&&a({inst:o})},[t,e,n]),Dt(function(){return M(o)&&a({inst:o}),t(function(){M(o)&&a({inst:o})})},[t]),Vt(e),e}function M(t){var n=t.getSnapshot;t=t.value;try{var e=n();return!_t(t,e)}catch{return!0}}function Gt(t,n){return n()}var Ut=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Gt:Wt;H.useSyncExternalStore=g.useSyncExternalStore!==void 0?g.useSyncExternalStore:Ut;Y.exports=H;var Kt=Y.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O=E,Bt=Kt;function Yt(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Ht=typeof Object.is=="function"?Object.is:Yt,Jt=Bt.useSyncExternalStore,Qt=O.useRef,Xt=O.useEffect,Zt=O.useMemo,tn=O.useDebugValue;B.useSyncExternalStoreWithSelector=function(t,n,e,r,o){var a=Qt(null);if(a.current===null){var c={hasValue:!1,value:null};a.current=c}else c=a.current;a=Zt(function(){function u(d){if(!f){if(f=!0,i=d,d=r(d),o!==void 0&&c.hasValue){var h=c.value;if(o(h,d))return l=h}return l=d}if(h=l,Ht(i,d))return h;var y=r(d);return o!==void 0&&o(h,y)?(i=d,h):(i=d,l=y)}var f=!1,i,l,C=e===void 0?null:e;return[function(){return u(n())},C===null?void 0:function(){return u(C())}]},[n,e,r,o]);var s=Jt(t,a[0],a[1]);return Xt(function(){c.hasValue=!0,c.value=s},[s]),tn(s),s};K.exports=B;var J=K.exports;const q=t=>typeof t=="object"&&!Array.isArray(t);function nn(t,n,e=n,r=S){const o=E.useRef([]),a=J.useSyncExternalStoreWithSelector(t,n,e,c=>c,(c,s)=>{if(q(c)&&q(s)&&o.current.length){for(const u of o.current)if(!r(c[u],s[u]))return!1;return!0}return r(c,s)});return E.useMemo(()=>{if(q(a)){const c={...a};let s={};for(const[u,f]of Object.entries(c))s={...s,[u]:{configurable:!1,enumerable:!0,get:()=>(o.current.includes(u)||o.current.push(u),f)}};return Object.defineProperties(c,s),c}return a},[a])}function dn(t={}){const n=I(t);return nn(e=>Mt(n,{onChange:e}),()=>U(n))}function en(t){return{mutationFn(n){return xt(t,n)},mutationKey:["switchChain"]}}function rn(t){return{mutationFn(n){return $t(t,n)},mutationKey:["writeContract"]}}function on(t={}){const n=I(t);return E.useSyncExternalStore(e=>kt(n,{onChange:e}),()=>V(n),()=>V(n))}function fn(t={}){const n=I(t);return J.useSyncExternalStoreWithSelector(e=>qt(n,{onChange:e}),()=>$(n,t),()=>$(n,t),e=>e,(e,r)=>e?.uid===r?.uid)}function ln(t={}){const{mutation:n}=t,e=I(t),r=en(e),{mutate:o,mutateAsync:a,...c}=G({...n,...r});return{...c,chains:on({config:e}),switchChain:o,switchChainAsync:a}}function hn(t={}){const{mutation:n}=t,e=I(t),r=rn(e),{mutate:o,mutateAsync:a,...c}=G({...n,...r});return{...c,writeContract:o,writeContractAsync:a}}export{fn as a,ln as b,hn as c,S as d,Pt as g,dn as u};
